var hI=Object.defineProperty;var gI=(t,e,r)=>e in t?hI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var mI=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Ya=(t,e,r)=>gI(t,typeof e!="symbol"?e+"":e,r);var O0e=mI((ige,Cx)=>{function iF(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Tx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function U1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var oF={exports:{}},$1={},lF={exports:{}},hr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fg=Symbol.for("react.element"),pI=Symbol.for("react.portal"),xI=Symbol.for("react.fragment"),yI=Symbol.for("react.strict_mode"),vI=Symbol.for("react.profiler"),wI=Symbol.for("react.provider"),_I=Symbol.for("react.context"),SI=Symbol.for("react.forward_ref"),bI=Symbol.for("react.suspense"),kI=Symbol.for("react.memo"),CI=Symbol.for("react.lazy"),q3=Symbol.iterator;function TI(t){return t===null||typeof t!="object"?null:(t=q3&&t[q3]||t["@@iterator"],typeof t=="function"?t:null)}var cF={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uF=Object.assign,dF={};function Wf(t,e,r){this.props=t,this.context=e,this.refs=dF,this.updater=r||cF}Wf.prototype.isReactComponent={};Wf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function fF(){}fF.prototype=Wf.prototype;function $b(t,e,r){this.props=t,this.context=e,this.refs=dF,this.updater=r||cF}var zb=$b.prototype=new fF;zb.constructor=$b;uF(zb,Wf.prototype);zb.isPureReactComponent=!0;var Z3=Array.isArray,hF=Object.prototype.hasOwnProperty,Wb={current:null},gF={key:!0,ref:!0,__self:!0,__source:!0};function mF(t,e,r){var n,s={},a=null,i=null;if(e!=null)for(n in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(a=""+e.key),e)hF.call(e,n)&&!gF.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Fg,type:t,key:a,ref:i,props:s,_owner:Wb.current}}function EI(t,e){return{$$typeof:Fg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Vb(t){return typeof t=="object"&&t!==null&&t.$$typeof===Fg}function NI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var eE=/\/+/g;function Bw(t,e){return typeof t=="object"&&t!==null&&t.key!=null?NI(""+t.key):e.toString(36)}function tx(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Fg:case pI:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+Bw(i,0):n,Z3(s)?(r="",t!=null&&(r=t.replace(eE,"$&/")+"/"),tx(s,e,r,"",function(u){return u})):s!=null&&(Vb(s)&&(s=EI(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(eE,"$&/")+"/")+t)),e.push(s)),1;if(i=0,n=n===""?".":n+":",Z3(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+Bw(a,o);i+=tx(a,e,r,l,s)}else if(l=TI(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+Bw(a,o++),i+=tx(a,e,r,l,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function op(t,e,r){if(t==null)return t;var n=[],s=0;return tx(t,n,"","",function(a){return e.call(r,a,s++)}),n}function AI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var aa={current:null},rx={transition:null},FI={ReactCurrentDispatcher:aa,ReactCurrentBatchConfig:rx,ReactCurrentOwner:Wb};function pF(){throw Error("act(...) is not supported in production builds of React.")}hr.Children={map:op,forEach:function(t,e,r){op(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return op(t,function(){e++}),e},toArray:function(t){return op(t,function(e){return e})||[]},only:function(t){if(!Vb(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};hr.Component=Wf;hr.Fragment=xI;hr.Profiler=vI;hr.PureComponent=$b;hr.StrictMode=yI;hr.Suspense=bI;hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FI;hr.act=pF;hr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=uF({},t.props),s=t.key,a=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,i=Wb.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)hF.call(e,l)&&!gF.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Fg,type:t.type,key:s,ref:a,props:n,_owner:i}};hr.createContext=function(t){return t={$$typeof:_I,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:wI,_context:t},t.Consumer=t};hr.createElement=mF;hr.createFactory=function(t){var e=mF.bind(null,t);return e.type=t,e};hr.createRef=function(){return{current:null}};hr.forwardRef=function(t){return{$$typeof:SI,render:t}};hr.isValidElement=Vb;hr.lazy=function(t){return{$$typeof:CI,_payload:{_status:-1,_result:t},_init:AI}};hr.memo=function(t,e){return{$$typeof:kI,type:t,compare:e===void 0?null:e}};hr.startTransition=function(t){var e=rx.transition;rx.transition={};try{t()}finally{rx.transition=e}};hr.unstable_act=pF;hr.useCallback=function(t,e){return aa.current.useCallback(t,e)};hr.useContext=function(t){return aa.current.useContext(t)};hr.useDebugValue=function(){};hr.useDeferredValue=function(t){return aa.current.useDeferredValue(t)};hr.useEffect=function(t,e){return aa.current.useEffect(t,e)};hr.useId=function(){return aa.current.useId()};hr.useImperativeHandle=function(t,e,r){return aa.current.useImperativeHandle(t,e,r)};hr.useInsertionEffect=function(t,e){return aa.current.useInsertionEffect(t,e)};hr.useLayoutEffect=function(t,e){return aa.current.useLayoutEffect(t,e)};hr.useMemo=function(t,e){return aa.current.useMemo(t,e)};hr.useReducer=function(t,e,r){return aa.current.useReducer(t,e,r)};hr.useRef=function(t){return aa.current.useRef(t)};hr.useState=function(t){return aa.current.useState(t)};hr.useSyncExternalStore=function(t,e,r){return aa.current.useSyncExternalStore(t,e,r)};hr.useTransition=function(){return aa.current.useTransition()};hr.version="18.3.1";lF.exports=hr;var k=lF.exports;const ls=U1(k),jI=iF({__proto__:null,default:ls},[k]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PI=k,DI=Symbol.for("react.element"),RI=Symbol.for("react.fragment"),OI=Object.prototype.hasOwnProperty,MI=PI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,LI={key:!0,ref:!0,__self:!0,__source:!0};function xF(t,e,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)OI.call(e,n)&&!LI.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:DI,type:t,key:a,ref:i,props:s,_owner:MI.current}}$1.Fragment=RI;$1.jsx=xF;$1.jsxs=xF;oF.exports=$1;var c=oF.exports,v_={},yF={exports:{}},Ia={},vF={exports:{}},wF={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,L){var Z=U.length;U.push(L);e:for(;0<Z;){var ne=Z-1>>>1,z=U[ne];if(0<s(z,L))U[ne]=L,U[Z]=z,Z=ne;else break e}}function r(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var L=U[0],Z=U.pop();if(Z!==L){U[0]=Z;e:for(var ne=0,z=U.length,Y=z>>>1;ne<Y;){var J=2*(ne+1)-1,te=U[J],de=J+1,ee=U[de];if(0>s(te,Z))de<z&&0>s(ee,te)?(U[ne]=ee,U[de]=Z,ne=de):(U[ne]=te,U[J]=Z,ne=J);else if(de<z&&0>s(ee,Z))U[ne]=ee,U[de]=Z,ne=de;else break e}}return L}function s(U,L){var Z=U.sortIndex-L.sortIndex;return Z!==0?Z:U.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],u=[],d=1,h=null,m=3,x=!1,p=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(U){for(var L=r(u);L!==null;){if(L.callback===null)n(u);else if(L.startTime<=U)n(u),L.sortIndex=L.expirationTime,e(l,L);else break;L=r(u)}}function b(U){if(v=!1,y(U),!p)if(r(l)!==null)p=!0,V(E);else{var L=r(u);L!==null&&K(b,L.startTime-U)}}function E(U,L){p=!1,v&&(v=!1,S(T),T=-1),x=!0;var Z=m;try{for(y(L),h=r(l);h!==null&&(!(h.expirationTime>L)||U&&!R());){var ne=h.callback;if(typeof ne=="function"){h.callback=null,m=h.priorityLevel;var z=ne(h.expirationTime<=L);L=t.unstable_now(),typeof z=="function"?h.callback=z:h===r(l)&&n(l),y(L)}else n(l);h=r(l)}if(h!==null)var Y=!0;else{var J=r(u);J!==null&&K(b,J.startTime-L),Y=!1}return Y}finally{h=null,m=Z,x=!1}}var N=!1,F=null,T=-1,P=5,D=-1;function R(){return!(t.unstable_now()-D<P)}function I(){if(F!==null){var U=t.unstable_now();D=U;var L=!0;try{L=F(!0,U)}finally{L?W():(N=!1,F=null)}}else N=!1}var W;if(typeof w=="function")W=function(){w(I)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,q=le.port2;le.port1.onmessage=I,W=function(){q.postMessage(null)}}else W=function(){_(I,0)};function V(U){F=U,N||(N=!0,W())}function K(U,L){T=_(function(){U(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){p||x||(p=!0,V(E))},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(U){switch(m){case 1:case 2:case 3:var L=3;break;default:L=m}var Z=m;m=L;try{return U()}finally{m=Z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,L){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var Z=m;m=U;try{return L()}finally{m=Z}},t.unstable_scheduleCallback=function(U,L,Z){var ne=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ne+Z:ne):Z=ne,U){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=Z+z,U={id:d++,callback:L,priorityLevel:U,startTime:Z,expirationTime:z,sortIndex:-1},Z>ne?(U.sortIndex=Z,e(u,U),r(l)===null&&U===r(u)&&(v?(S(T),T=-1):v=!0,K(b,Z-ne))):(U.sortIndex=z,e(l,U),p||x||(p=!0,V(E))),U},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(U){var L=m;return function(){var Z=m;m=L;try{return U.apply(this,arguments)}finally{m=Z}}}})(wF);vF.exports=wF;var i0=vF.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var II=k,Oa=i0;function lt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _F=new Set,R0={};function zu(t,e){wf(t,e),wf(t+"Capture",e)}function wf(t,e){for(R0[t]=e,t=0;t<e.length;t++)_F.add(e[t])}var rl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),w_=Object.prototype.hasOwnProperty,BI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,tE={},rE={};function UI(t){return w_.call(rE,t)?!0:w_.call(tE,t)?!1:BI.test(t)?rE[t]=!0:(tE[t]=!0,!1)}function $I(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zI(t,e,r,n){if(e===null||typeof e>"u"||$I(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ia(t,e,r,n,s,a,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=i}var Ts={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ts[t]=new ia(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ts[e]=new ia(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ts[t]=new ia(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ts[t]=new ia(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ts[t]=new ia(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ts[t]=new ia(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ts[t]=new ia(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ts[t]=new ia(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ts[t]=new ia(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gb=/[\-:]([a-z])/g;function Hb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gb,Hb);Ts[e]=new ia(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gb,Hb);Ts[e]=new ia(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gb,Hb);Ts[e]=new ia(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ts[t]=new ia(t,1,!1,t.toLowerCase(),null,!1,!1)});Ts.xlinkHref=new ia("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ts[t]=new ia(t,1,!1,t.toLowerCase(),null,!0,!0)});function Kb(t,e,r,n){var s=Ts.hasOwnProperty(e)?Ts[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zI(e,r,s,n)&&(r=null),n||s===null?UI(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var dl=II.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lp=Symbol.for("react.element"),Md=Symbol.for("react.portal"),Ld=Symbol.for("react.fragment"),Xb=Symbol.for("react.strict_mode"),__=Symbol.for("react.profiler"),SF=Symbol.for("react.provider"),bF=Symbol.for("react.context"),Yb=Symbol.for("react.forward_ref"),S_=Symbol.for("react.suspense"),b_=Symbol.for("react.suspense_list"),Jb=Symbol.for("react.memo"),Rl=Symbol.for("react.lazy"),kF=Symbol.for("react.offscreen"),nE=Symbol.iterator;function Ph(t){return t===null||typeof t!="object"?null:(t=nE&&t[nE]||t["@@iterator"],typeof t=="function"?t:null)}var fn=Object.assign,Uw;function Jh(t){if(Uw===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Uw=e&&e[1]||""}return`
`+Uw+t}var $w=!1;function zw(t,e){if(!t||$w)return"";$w=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=o);break}}}finally{$w=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Jh(t):""}function WI(t){switch(t.tag){case 5:return Jh(t.type);case 16:return Jh("Lazy");case 13:return Jh("Suspense");case 19:return Jh("SuspenseList");case 0:case 2:case 15:return t=zw(t.type,!1),t;case 11:return t=zw(t.type.render,!1),t;case 1:return t=zw(t.type,!0),t;default:return""}}function k_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ld:return"Fragment";case Md:return"Portal";case __:return"Profiler";case Xb:return"StrictMode";case S_:return"Suspense";case b_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case bF:return(t.displayName||"Context")+".Consumer";case SF:return(t._context.displayName||"Context")+".Provider";case Yb:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Jb:return e=t.displayName||null,e!==null?e:k_(t.type)||"Memo";case Rl:e=t._payload,t=t._init;try{return k_(t(e))}catch{}}return null}function VI(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return k_(e);case 8:return e===Xb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function rc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function CF(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function GI(t){var e=CF(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function cp(t){t._valueTracker||(t._valueTracker=GI(t))}function TF(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=CF(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Ex(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function C_(t,e){var r=e.checked;return fn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function sE(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=rc(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function EF(t,e){e=e.checked,e!=null&&Kb(t,"checked",e,!1)}function T_(t,e){EF(t,e);var r=rc(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?E_(t,e.type,r):e.hasOwnProperty("defaultValue")&&E_(t,e.type,rc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function aE(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function E_(t,e,r){(e!=="number"||Ex(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Qh=Array.isArray;function nf(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+rc(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function N_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(lt(91));return fn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function iE(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(lt(92));if(Qh(r)){if(1<r.length)throw Error(lt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:rc(r)}}function NF(t,e){var r=rc(e.value),n=rc(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function oE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function AF(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function A_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?AF(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var up,FF=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(up=up||document.createElement("div"),up.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=up.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function O0(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var o0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},HI=["Webkit","ms","Moz","O"];Object.keys(o0).forEach(function(t){HI.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),o0[e]=o0[t]})});function jF(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||o0.hasOwnProperty(t)&&o0[t]?(""+e).trim():e+"px"}function PF(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=jF(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var KI=fn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function F_(t,e){if(e){if(KI[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(lt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(lt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(lt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(lt(62))}}function j_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var P_=null;function Qb(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var D_=null,sf=null,af=null;function lE(t){if(t=Dg(t)){if(typeof D_!="function")throw Error(lt(280));var e=t.stateNode;e&&(e=H1(e),D_(t.stateNode,t.type,e))}}function DF(t){sf?af?af.push(t):af=[t]:sf=t}function RF(){if(sf){var t=sf,e=af;if(af=sf=null,lE(t),e)for(t=0;t<e.length;t++)lE(e[t])}}function OF(t,e){return t(e)}function MF(){}var Ww=!1;function LF(t,e,r){if(Ww)return t(e,r);Ww=!0;try{return OF(t,e,r)}finally{Ww=!1,(sf!==null||af!==null)&&(MF(),RF())}}function M0(t,e){var r=t.stateNode;if(r===null)return null;var n=H1(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(lt(231,e,typeof r));return r}var R_=!1;if(rl)try{var Dh={};Object.defineProperty(Dh,"passive",{get:function(){R_=!0}}),window.addEventListener("test",Dh,Dh),window.removeEventListener("test",Dh,Dh)}catch{R_=!1}function XI(t,e,r,n,s,a,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var l0=!1,Nx=null,Ax=!1,O_=null,YI={onError:function(t){l0=!0,Nx=t}};function JI(t,e,r,n,s,a,i,o,l){l0=!1,Nx=null,XI.apply(YI,arguments)}function QI(t,e,r,n,s,a,i,o,l){if(JI.apply(this,arguments),l0){if(l0){var u=Nx;l0=!1,Nx=null}else throw Error(lt(198));Ax||(Ax=!0,O_=u)}}function Wu(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function IF(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function cE(t){if(Wu(t)!==t)throw Error(lt(188))}function qI(t){var e=t.alternate;if(!e){if(e=Wu(t),e===null)throw Error(lt(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return cE(s),t;if(a===n)return cE(s),e;a=a.sibling}throw Error(lt(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(lt(189))}}if(r.alternate!==n)throw Error(lt(190))}if(r.tag!==3)throw Error(lt(188));return r.stateNode.current===r?t:e}function BF(t){return t=qI(t),t!==null?UF(t):null}function UF(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=UF(t);if(e!==null)return e;t=t.sibling}return null}var $F=Oa.unstable_scheduleCallback,uE=Oa.unstable_cancelCallback,ZI=Oa.unstable_shouldYield,eB=Oa.unstable_requestPaint,jn=Oa.unstable_now,tB=Oa.unstable_getCurrentPriorityLevel,qb=Oa.unstable_ImmediatePriority,zF=Oa.unstable_UserBlockingPriority,Fx=Oa.unstable_NormalPriority,rB=Oa.unstable_LowPriority,WF=Oa.unstable_IdlePriority,z1=null,mo=null;function nB(t){if(mo&&typeof mo.onCommitFiberRoot=="function")try{mo.onCommitFiberRoot(z1,t,void 0,(t.current.flags&128)===128)}catch{}}var Li=Math.clz32?Math.clz32:iB,sB=Math.log,aB=Math.LN2;function iB(t){return t>>>=0,t===0?32:31-(sB(t)/aB|0)|0}var dp=64,fp=4194304;function qh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function jx(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=qh(o):(a&=i,a!==0&&(n=qh(a)))}else i=r&~s,i!==0?n=qh(i):a!==0&&(n=qh(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Li(e),s=1<<r,n|=t[r],e&=~s;return n}function oB(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lB(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-Li(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=oB(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function M_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function VF(){var t=dp;return dp<<=1,!(dp&4194240)&&(dp=64),t}function Vw(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function jg(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Li(e),t[e]=r}function cB(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Li(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function Zb(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Li(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Rr=0;function GF(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var HF,ek,KF,XF,YF,L_=!1,hp=[],Gl=null,Hl=null,Kl=null,L0=new Map,I0=new Map,Ml=[],uB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dE(t,e){switch(t){case"focusin":case"focusout":Gl=null;break;case"dragenter":case"dragleave":Hl=null;break;case"mouseover":case"mouseout":Kl=null;break;case"pointerover":case"pointerout":L0.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":I0.delete(e.pointerId)}}function Rh(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=Dg(e),e!==null&&ek(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function dB(t,e,r,n,s){switch(e){case"focusin":return Gl=Rh(Gl,t,e,r,n,s),!0;case"dragenter":return Hl=Rh(Hl,t,e,r,n,s),!0;case"mouseover":return Kl=Rh(Kl,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return L0.set(a,Rh(L0.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,I0.set(a,Rh(I0.get(a)||null,t,e,r,n,s)),!0}return!1}function JF(t){var e=Qc(t.target);if(e!==null){var r=Wu(e);if(r!==null){if(e=r.tag,e===13){if(e=IF(r),e!==null){t.blockedOn=e,YF(t.priority,function(){KF(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function nx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=I_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);P_=n,r.target.dispatchEvent(n),P_=null}else return e=Dg(r),e!==null&&ek(e),t.blockedOn=r,!1;e.shift()}return!0}function fE(t,e,r){nx(t)&&r.delete(e)}function fB(){L_=!1,Gl!==null&&nx(Gl)&&(Gl=null),Hl!==null&&nx(Hl)&&(Hl=null),Kl!==null&&nx(Kl)&&(Kl=null),L0.forEach(fE),I0.forEach(fE)}function Oh(t,e){t.blockedOn===e&&(t.blockedOn=null,L_||(L_=!0,Oa.unstable_scheduleCallback(Oa.unstable_NormalPriority,fB)))}function B0(t){function e(s){return Oh(s,t)}if(0<hp.length){Oh(hp[0],t);for(var r=1;r<hp.length;r++){var n=hp[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Gl!==null&&Oh(Gl,t),Hl!==null&&Oh(Hl,t),Kl!==null&&Oh(Kl,t),L0.forEach(e),I0.forEach(e),r=0;r<Ml.length;r++)n=Ml[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Ml.length&&(r=Ml[0],r.blockedOn===null);)JF(r),r.blockedOn===null&&Ml.shift()}var of=dl.ReactCurrentBatchConfig,Px=!0;function hB(t,e,r,n){var s=Rr,a=of.transition;of.transition=null;try{Rr=1,tk(t,e,r,n)}finally{Rr=s,of.transition=a}}function gB(t,e,r,n){var s=Rr,a=of.transition;of.transition=null;try{Rr=4,tk(t,e,r,n)}finally{Rr=s,of.transition=a}}function tk(t,e,r,n){if(Px){var s=I_(t,e,r,n);if(s===null)e2(t,e,n,Dx,r),dE(t,n);else if(dB(s,t,e,r,n))n.stopPropagation();else if(dE(t,n),e&4&&-1<uB.indexOf(t)){for(;s!==null;){var a=Dg(s);if(a!==null&&HF(a),a=I_(t,e,r,n),a===null&&e2(t,e,n,Dx,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else e2(t,e,n,null,r)}}var Dx=null;function I_(t,e,r,n){if(Dx=null,t=Qb(n),t=Qc(t),t!==null)if(e=Wu(t),e===null)t=null;else if(r=e.tag,r===13){if(t=IF(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Dx=t,null}function QF(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tB()){case qb:return 1;case zF:return 4;case Fx:case rB:return 16;case WF:return 536870912;default:return 16}default:return 16}}var Il=null,rk=null,sx=null;function qF(){if(sx)return sx;var t,e=rk,r=e.length,n,s="value"in Il?Il.value:Il.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var i=r-t;for(n=1;n<=i&&e[r-n]===s[a-n];n++);return sx=s.slice(t,1<n?1-n:void 0)}function ax(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gp(){return!0}function hE(){return!1}function Ba(t){function e(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?gp:hE,this.isPropagationStopped=hE,this}return fn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=gp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=gp)},persist:function(){},isPersistent:gp}),e}var Vf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nk=Ba(Vf),Pg=fn({},Vf,{view:0,detail:0}),mB=Ba(Pg),Gw,Hw,Mh,W1=fn({},Pg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sk,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Mh&&(Mh&&t.type==="mousemove"?(Gw=t.screenX-Mh.screenX,Hw=t.screenY-Mh.screenY):Hw=Gw=0,Mh=t),Gw)},movementY:function(t){return"movementY"in t?t.movementY:Hw}}),gE=Ba(W1),pB=fn({},W1,{dataTransfer:0}),xB=Ba(pB),yB=fn({},Pg,{relatedTarget:0}),Kw=Ba(yB),vB=fn({},Vf,{animationName:0,elapsedTime:0,pseudoElement:0}),wB=Ba(vB),_B=fn({},Vf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),SB=Ba(_B),bB=fn({},Vf,{data:0}),mE=Ba(bB),kB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},CB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},TB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EB(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=TB[t])?!!e[t]:!1}function sk(){return EB}var NB=fn({},Pg,{key:function(t){if(t.key){var e=kB[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ax(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?CB[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sk,charCode:function(t){return t.type==="keypress"?ax(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ax(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),AB=Ba(NB),FB=fn({},W1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pE=Ba(FB),jB=fn({},Pg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sk}),PB=Ba(jB),DB=fn({},Vf,{propertyName:0,elapsedTime:0,pseudoElement:0}),RB=Ba(DB),OB=fn({},W1,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),MB=Ba(OB),LB=[9,13,27,32],ak=rl&&"CompositionEvent"in window,c0=null;rl&&"documentMode"in document&&(c0=document.documentMode);var IB=rl&&"TextEvent"in window&&!c0,ZF=rl&&(!ak||c0&&8<c0&&11>=c0),xE=" ",yE=!1;function ej(t,e){switch(t){case"keyup":return LB.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tj(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Id=!1;function BB(t,e){switch(t){case"compositionend":return tj(e);case"keypress":return e.which!==32?null:(yE=!0,xE);case"textInput":return t=e.data,t===xE&&yE?null:t;default:return null}}function UB(t,e){if(Id)return t==="compositionend"||!ak&&ej(t,e)?(t=qF(),sx=rk=Il=null,Id=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ZF&&e.locale!=="ko"?null:e.data;default:return null}}var $B={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!$B[t.type]:e==="textarea"}function rj(t,e,r,n){DF(n),e=Rx(e,"onChange"),0<e.length&&(r=new nk("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var u0=null,U0=null;function zB(t){hj(t,0)}function V1(t){var e=$d(t);if(TF(e))return t}function WB(t,e){if(t==="change")return e}var nj=!1;if(rl){var Xw;if(rl){var Yw="oninput"in document;if(!Yw){var wE=document.createElement("div");wE.setAttribute("oninput","return;"),Yw=typeof wE.oninput=="function"}Xw=Yw}else Xw=!1;nj=Xw&&(!document.documentMode||9<document.documentMode)}function _E(){u0&&(u0.detachEvent("onpropertychange",sj),U0=u0=null)}function sj(t){if(t.propertyName==="value"&&V1(U0)){var e=[];rj(e,U0,t,Qb(t)),LF(zB,e)}}function VB(t,e,r){t==="focusin"?(_E(),u0=e,U0=r,u0.attachEvent("onpropertychange",sj)):t==="focusout"&&_E()}function GB(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return V1(U0)}function HB(t,e){if(t==="click")return V1(e)}function KB(t,e){if(t==="input"||t==="change")return V1(e)}function XB(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Wi=typeof Object.is=="function"?Object.is:XB;function $0(t,e){if(Wi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!w_.call(e,s)||!Wi(t[s],e[s]))return!1}return!0}function SE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function bE(t,e){var r=SE(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=SE(r)}}function aj(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?aj(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ij(){for(var t=window,e=Ex();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Ex(t.document)}return e}function ik(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function YB(t){var e=ij(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&aj(r.ownerDocument.documentElement,r)){if(n!==null&&ik(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=bE(r,a);var i=bE(r,n);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var JB=rl&&"documentMode"in document&&11>=document.documentMode,Bd=null,B_=null,d0=null,U_=!1;function kE(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;U_||Bd==null||Bd!==Ex(n)||(n=Bd,"selectionStart"in n&&ik(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),d0&&$0(d0,n)||(d0=n,n=Rx(B_,"onSelect"),0<n.length&&(e=new nk("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Bd)))}function mp(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ud={animationend:mp("Animation","AnimationEnd"),animationiteration:mp("Animation","AnimationIteration"),animationstart:mp("Animation","AnimationStart"),transitionend:mp("Transition","TransitionEnd")},Jw={},oj={};rl&&(oj=document.createElement("div").style,"AnimationEvent"in window||(delete Ud.animationend.animation,delete Ud.animationiteration.animation,delete Ud.animationstart.animation),"TransitionEvent"in window||delete Ud.transitionend.transition);function G1(t){if(Jw[t])return Jw[t];if(!Ud[t])return t;var e=Ud[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in oj)return Jw[t]=e[r];return t}var lj=G1("animationend"),cj=G1("animationiteration"),uj=G1("animationstart"),dj=G1("transitionend"),fj=new Map,CE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gc(t,e){fj.set(t,e),zu(e,[t])}for(var Qw=0;Qw<CE.length;Qw++){var qw=CE[Qw],QB=qw.toLowerCase(),qB=qw[0].toUpperCase()+qw.slice(1);gc(QB,"on"+qB)}gc(lj,"onAnimationEnd");gc(cj,"onAnimationIteration");gc(uj,"onAnimationStart");gc("dblclick","onDoubleClick");gc("focusin","onFocus");gc("focusout","onBlur");gc(dj,"onTransitionEnd");wf("onMouseEnter",["mouseout","mouseover"]);wf("onMouseLeave",["mouseout","mouseover"]);wf("onPointerEnter",["pointerout","pointerover"]);wf("onPointerLeave",["pointerout","pointerover"]);zu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));zu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));zu("onBeforeInput",["compositionend","keypress","textInput","paste"]);zu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));zu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));zu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZB=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zh));function TE(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,QI(n,e,void 0,t),t.currentTarget=null}function hj(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;TE(s,o,u),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;TE(s,o,u),a=l}}}if(Ax)throw t=O_,Ax=!1,O_=null,t}function zr(t,e){var r=e[G_];r===void 0&&(r=e[G_]=new Set);var n=t+"__bubble";r.has(n)||(gj(e,t,2,!1),r.add(n))}function Zw(t,e,r){var n=0;e&&(n|=4),gj(r,t,n,e)}var pp="_reactListening"+Math.random().toString(36).slice(2);function z0(t){if(!t[pp]){t[pp]=!0,_F.forEach(function(r){r!=="selectionchange"&&(ZB.has(r)||Zw(r,!1,t),Zw(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[pp]||(e[pp]=!0,Zw("selectionchange",!1,e))}}function gj(t,e,r,n){switch(QF(e)){case 1:var s=hB;break;case 4:s=gB;break;default:s=tk}r=s.bind(null,e,r,t),s=void 0,!R_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function e2(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Qc(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}LF(function(){var u=a,d=Qb(r),h=[];e:{var m=fj.get(t);if(m!==void 0){var x=nk,p=t;switch(t){case"keypress":if(ax(r)===0)break e;case"keydown":case"keyup":x=AB;break;case"focusin":p="focus",x=Kw;break;case"focusout":p="blur",x=Kw;break;case"beforeblur":case"afterblur":x=Kw;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=gE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=xB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=PB;break;case lj:case cj:case uj:x=wB;break;case dj:x=RB;break;case"scroll":x=mB;break;case"wheel":x=MB;break;case"copy":case"cut":case"paste":x=SB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=pE}var v=(e&4)!==0,_=!v&&t==="scroll",S=v?m!==null?m+"Capture":null:m;v=[];for(var w=u,y;w!==null;){y=w;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,S!==null&&(b=M0(w,S),b!=null&&v.push(W0(w,b,y)))),_)break;w=w.return}0<v.length&&(m=new x(m,p,null,r,d),h.push({event:m,listeners:v}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",m&&r!==P_&&(p=r.relatedTarget||r.fromElement)&&(Qc(p)||p[nl]))break e;if((x||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,x?(p=r.relatedTarget||r.toElement,x=u,p=p?Qc(p):null,p!==null&&(_=Wu(p),p!==_||p.tag!==5&&p.tag!==6)&&(p=null)):(x=null,p=u),x!==p)){if(v=gE,b="onMouseLeave",S="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(v=pE,b="onPointerLeave",S="onPointerEnter",w="pointer"),_=x==null?m:$d(x),y=p==null?m:$d(p),m=new v(b,w+"leave",x,r,d),m.target=_,m.relatedTarget=y,b=null,Qc(d)===u&&(v=new v(S,w+"enter",p,r,d),v.target=y,v.relatedTarget=_,b=v),_=b,x&&p)t:{for(v=x,S=p,w=0,y=v;y;y=_d(y))w++;for(y=0,b=S;b;b=_d(b))y++;for(;0<w-y;)v=_d(v),w--;for(;0<y-w;)S=_d(S),y--;for(;w--;){if(v===S||S!==null&&v===S.alternate)break t;v=_d(v),S=_d(S)}v=null}else v=null;x!==null&&EE(h,m,x,v,!1),p!==null&&_!==null&&EE(h,_,p,v,!0)}}e:{if(m=u?$d(u):window,x=m.nodeName&&m.nodeName.toLowerCase(),x==="select"||x==="input"&&m.type==="file")var E=WB;else if(vE(m))if(nj)E=KB;else{E=GB;var N=VB}else(x=m.nodeName)&&x.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(E=HB);if(E&&(E=E(t,u))){rj(h,E,r,d);break e}N&&N(t,m,u),t==="focusout"&&(N=m._wrapperState)&&N.controlled&&m.type==="number"&&E_(m,"number",m.value)}switch(N=u?$d(u):window,t){case"focusin":(vE(N)||N.contentEditable==="true")&&(Bd=N,B_=u,d0=null);break;case"focusout":d0=B_=Bd=null;break;case"mousedown":U_=!0;break;case"contextmenu":case"mouseup":case"dragend":U_=!1,kE(h,r,d);break;case"selectionchange":if(JB)break;case"keydown":case"keyup":kE(h,r,d)}var F;if(ak)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Id?ej(t,r)&&(T="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(ZF&&r.locale!=="ko"&&(Id||T!=="onCompositionStart"?T==="onCompositionEnd"&&Id&&(F=qF()):(Il=d,rk="value"in Il?Il.value:Il.textContent,Id=!0)),N=Rx(u,T),0<N.length&&(T=new mE(T,t,null,r,d),h.push({event:T,listeners:N}),F?T.data=F:(F=tj(r),F!==null&&(T.data=F)))),(F=IB?BB(t,r):UB(t,r))&&(u=Rx(u,"onBeforeInput"),0<u.length&&(d=new mE("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=F))}hj(h,e)})}function W0(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Rx(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=M0(t,r),a!=null&&n.unshift(W0(t,a,s)),a=M0(t,e),a!=null&&n.push(W0(t,a,s))),t=t.return}return n}function _d(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function EE(t,e,r,n,s){for(var a=e._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,s?(l=M0(r,a),l!=null&&i.unshift(W0(r,l,o))):s||(l=M0(r,a),l!=null&&i.push(W0(r,l,o)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var eU=/\r\n?/g,tU=/\u0000|\uFFFD/g;function NE(t){return(typeof t=="string"?t:""+t).replace(eU,`
`).replace(tU,"")}function xp(t,e,r){if(e=NE(e),NE(t)!==e&&r)throw Error(lt(425))}function Ox(){}var $_=null,z_=null;function W_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var V_=typeof setTimeout=="function"?setTimeout:void 0,rU=typeof clearTimeout=="function"?clearTimeout:void 0,AE=typeof Promise=="function"?Promise:void 0,nU=typeof queueMicrotask=="function"?queueMicrotask:typeof AE<"u"?function(t){return AE.resolve(null).then(t).catch(sU)}:V_;function sU(t){setTimeout(function(){throw t})}function t2(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),B0(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);B0(e)}function Xl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function FE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Gf=Math.random().toString(36).slice(2),co="__reactFiber$"+Gf,V0="__reactProps$"+Gf,nl="__reactContainer$"+Gf,G_="__reactEvents$"+Gf,aU="__reactListeners$"+Gf,iU="__reactHandles$"+Gf;function Qc(t){var e=t[co];if(e)return e;for(var r=t.parentNode;r;){if(e=r[nl]||r[co]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=FE(t);t!==null;){if(r=t[co])return r;t=FE(t)}return e}t=r,r=t.parentNode}return null}function Dg(t){return t=t[co]||t[nl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $d(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(lt(33))}function H1(t){return t[V0]||null}var H_=[],zd=-1;function mc(t){return{current:t}}function Vr(t){0>zd||(t.current=H_[zd],H_[zd]=null,zd--)}function Ur(t,e){zd++,H_[zd]=t.current,t.current=e}var nc={},Vs=mc(nc),xa=mc(!1),yu=nc;function _f(t,e){var r=t.type.contextTypes;if(!r)return nc;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function ya(t){return t=t.childContextTypes,t!=null}function Mx(){Vr(xa),Vr(Vs)}function jE(t,e,r){if(Vs.current!==nc)throw Error(lt(168));Ur(Vs,e),Ur(xa,r)}function mj(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(lt(108,VI(t)||"Unknown",s));return fn({},r,n)}function Lx(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||nc,yu=Vs.current,Ur(Vs,t),Ur(xa,xa.current),!0}function PE(t,e,r){var n=t.stateNode;if(!n)throw Error(lt(169));r?(t=mj(t,e,yu),n.__reactInternalMemoizedMergedChildContext=t,Vr(xa),Vr(Vs),Ur(Vs,t)):Vr(xa),Ur(xa,r)}var Wo=null,K1=!1,r2=!1;function pj(t){Wo===null?Wo=[t]:Wo.push(t)}function oU(t){K1=!0,pj(t)}function pc(){if(!r2&&Wo!==null){r2=!0;var t=0,e=Rr;try{var r=Wo;for(Rr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Wo=null,K1=!1}catch(s){throw Wo!==null&&(Wo=Wo.slice(t+1)),$F(qb,pc),s}finally{Rr=e,r2=!1}}return null}var Wd=[],Vd=0,Ix=null,Bx=0,ai=[],ii=0,vu=null,Ho=1,Ko="";function Vc(t,e){Wd[Vd++]=Bx,Wd[Vd++]=Ix,Ix=t,Bx=e}function xj(t,e,r){ai[ii++]=Ho,ai[ii++]=Ko,ai[ii++]=vu,vu=t;var n=Ho;t=Ko;var s=32-Li(n)-1;n&=~(1<<s),r+=1;var a=32-Li(e)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Ho=1<<32-Li(e)+s|r<<s|n,Ko=a+t}else Ho=1<<a|r<<s|n,Ko=t}function ok(t){t.return!==null&&(Vc(t,1),xj(t,1,0))}function lk(t){for(;t===Ix;)Ix=Wd[--Vd],Wd[Vd]=null,Bx=Wd[--Vd],Wd[Vd]=null;for(;t===vu;)vu=ai[--ii],ai[ii]=null,Ko=ai[--ii],ai[ii]=null,Ho=ai[--ii],ai[ii]=null}var Ra=null,Da=null,qr=!1,Ri=null;function yj(t,e){var r=li(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function DE(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ra=t,Da=Xl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ra=t,Da=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=vu!==null?{id:Ho,overflow:Ko}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=li(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Ra=t,Da=null,!0):!1;default:return!1}}function K_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function X_(t){if(qr){var e=Da;if(e){var r=e;if(!DE(t,e)){if(K_(t))throw Error(lt(418));e=Xl(r.nextSibling);var n=Ra;e&&DE(t,e)?yj(n,r):(t.flags=t.flags&-4097|2,qr=!1,Ra=t)}}else{if(K_(t))throw Error(lt(418));t.flags=t.flags&-4097|2,qr=!1,Ra=t}}}function RE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ra=t}function yp(t){if(t!==Ra)return!1;if(!qr)return RE(t),qr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!W_(t.type,t.memoizedProps)),e&&(e=Da)){if(K_(t))throw vj(),Error(lt(418));for(;e;)yj(t,e),e=Xl(e.nextSibling)}if(RE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(lt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Da=Xl(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Da=null}}else Da=Ra?Xl(t.stateNode.nextSibling):null;return!0}function vj(){for(var t=Da;t;)t=Xl(t.nextSibling)}function Sf(){Da=Ra=null,qr=!1}function ck(t){Ri===null?Ri=[t]:Ri.push(t)}var lU=dl.ReactCurrentBatchConfig;function Lh(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(lt(309));var n=r.stateNode}if(!n)throw Error(lt(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},e._stringRef=a,e)}if(typeof t!="string")throw Error(lt(284));if(!r._owner)throw Error(lt(290,t))}return t}function vp(t,e){throw t=Object.prototype.toString.call(e),Error(lt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function OE(t){var e=t._init;return e(t._payload)}function wj(t){function e(S,w){if(t){var y=S.deletions;y===null?(S.deletions=[w],S.flags|=16):y.push(w)}}function r(S,w){if(!t)return null;for(;w!==null;)e(S,w),w=w.sibling;return null}function n(S,w){for(S=new Map;w!==null;)w.key!==null?S.set(w.key,w):S.set(w.index,w),w=w.sibling;return S}function s(S,w){return S=ql(S,w),S.index=0,S.sibling=null,S}function a(S,w,y){return S.index=y,t?(y=S.alternate,y!==null?(y=y.index,y<w?(S.flags|=2,w):y):(S.flags|=2,w)):(S.flags|=1048576,w)}function i(S){return t&&S.alternate===null&&(S.flags|=2),S}function o(S,w,y,b){return w===null||w.tag!==6?(w=c2(y,S.mode,b),w.return=S,w):(w=s(w,y),w.return=S,w)}function l(S,w,y,b){var E=y.type;return E===Ld?d(S,w,y.props.children,b,y.key):w!==null&&(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Rl&&OE(E)===w.type)?(b=s(w,y.props),b.ref=Lh(S,w,y),b.return=S,b):(b=fx(y.type,y.key,y.props,null,S.mode,b),b.ref=Lh(S,w,y),b.return=S,b)}function u(S,w,y,b){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=u2(y,S.mode,b),w.return=S,w):(w=s(w,y.children||[]),w.return=S,w)}function d(S,w,y,b,E){return w===null||w.tag!==7?(w=ou(y,S.mode,b,E),w.return=S,w):(w=s(w,y),w.return=S,w)}function h(S,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=c2(""+w,S.mode,y),w.return=S,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case lp:return y=fx(w.type,w.key,w.props,null,S.mode,y),y.ref=Lh(S,null,w),y.return=S,y;case Md:return w=u2(w,S.mode,y),w.return=S,w;case Rl:var b=w._init;return h(S,b(w._payload),y)}if(Qh(w)||Ph(w))return w=ou(w,S.mode,y,null),w.return=S,w;vp(S,w)}return null}function m(S,w,y,b){var E=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return E!==null?null:o(S,w,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case lp:return y.key===E?l(S,w,y,b):null;case Md:return y.key===E?u(S,w,y,b):null;case Rl:return E=y._init,m(S,w,E(y._payload),b)}if(Qh(y)||Ph(y))return E!==null?null:d(S,w,y,b,null);vp(S,y)}return null}function x(S,w,y,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return S=S.get(y)||null,o(w,S,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case lp:return S=S.get(b.key===null?y:b.key)||null,l(w,S,b,E);case Md:return S=S.get(b.key===null?y:b.key)||null,u(w,S,b,E);case Rl:var N=b._init;return x(S,w,y,N(b._payload),E)}if(Qh(b)||Ph(b))return S=S.get(y)||null,d(w,S,b,E,null);vp(w,b)}return null}function p(S,w,y,b){for(var E=null,N=null,F=w,T=w=0,P=null;F!==null&&T<y.length;T++){F.index>T?(P=F,F=null):P=F.sibling;var D=m(S,F,y[T],b);if(D===null){F===null&&(F=P);break}t&&F&&D.alternate===null&&e(S,F),w=a(D,w,T),N===null?E=D:N.sibling=D,N=D,F=P}if(T===y.length)return r(S,F),qr&&Vc(S,T),E;if(F===null){for(;T<y.length;T++)F=h(S,y[T],b),F!==null&&(w=a(F,w,T),N===null?E=F:N.sibling=F,N=F);return qr&&Vc(S,T),E}for(F=n(S,F);T<y.length;T++)P=x(F,S,T,y[T],b),P!==null&&(t&&P.alternate!==null&&F.delete(P.key===null?T:P.key),w=a(P,w,T),N===null?E=P:N.sibling=P,N=P);return t&&F.forEach(function(R){return e(S,R)}),qr&&Vc(S,T),E}function v(S,w,y,b){var E=Ph(y);if(typeof E!="function")throw Error(lt(150));if(y=E.call(y),y==null)throw Error(lt(151));for(var N=E=null,F=w,T=w=0,P=null,D=y.next();F!==null&&!D.done;T++,D=y.next()){F.index>T?(P=F,F=null):P=F.sibling;var R=m(S,F,D.value,b);if(R===null){F===null&&(F=P);break}t&&F&&R.alternate===null&&e(S,F),w=a(R,w,T),N===null?E=R:N.sibling=R,N=R,F=P}if(D.done)return r(S,F),qr&&Vc(S,T),E;if(F===null){for(;!D.done;T++,D=y.next())D=h(S,D.value,b),D!==null&&(w=a(D,w,T),N===null?E=D:N.sibling=D,N=D);return qr&&Vc(S,T),E}for(F=n(S,F);!D.done;T++,D=y.next())D=x(F,S,T,D.value,b),D!==null&&(t&&D.alternate!==null&&F.delete(D.key===null?T:D.key),w=a(D,w,T),N===null?E=D:N.sibling=D,N=D);return t&&F.forEach(function(I){return e(S,I)}),qr&&Vc(S,T),E}function _(S,w,y,b){if(typeof y=="object"&&y!==null&&y.type===Ld&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case lp:e:{for(var E=y.key,N=w;N!==null;){if(N.key===E){if(E=y.type,E===Ld){if(N.tag===7){r(S,N.sibling),w=s(N,y.props.children),w.return=S,S=w;break e}}else if(N.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Rl&&OE(E)===N.type){r(S,N.sibling),w=s(N,y.props),w.ref=Lh(S,N,y),w.return=S,S=w;break e}r(S,N);break}else e(S,N);N=N.sibling}y.type===Ld?(w=ou(y.props.children,S.mode,b,y.key),w.return=S,S=w):(b=fx(y.type,y.key,y.props,null,S.mode,b),b.ref=Lh(S,w,y),b.return=S,S=b)}return i(S);case Md:e:{for(N=y.key;w!==null;){if(w.key===N)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){r(S,w.sibling),w=s(w,y.children||[]),w.return=S,S=w;break e}else{r(S,w);break}else e(S,w);w=w.sibling}w=u2(y,S.mode,b),w.return=S,S=w}return i(S);case Rl:return N=y._init,_(S,w,N(y._payload),b)}if(Qh(y))return p(S,w,y,b);if(Ph(y))return v(S,w,y,b);vp(S,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(r(S,w.sibling),w=s(w,y),w.return=S,S=w):(r(S,w),w=c2(y,S.mode,b),w.return=S,S=w),i(S)):r(S,w)}return _}var bf=wj(!0),_j=wj(!1),Ux=mc(null),$x=null,Gd=null,uk=null;function dk(){uk=Gd=$x=null}function fk(t){var e=Ux.current;Vr(Ux),t._currentValue=e}function Y_(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function lf(t,e){$x=t,uk=Gd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ma=!0),t.firstContext=null)}function gi(t){var e=t._currentValue;if(uk!==t)if(t={context:t,memoizedValue:e,next:null},Gd===null){if($x===null)throw Error(lt(308));Gd=t,$x.dependencies={lanes:0,firstContext:t}}else Gd=Gd.next=t;return e}var qc=null;function hk(t){qc===null?qc=[t]:qc.push(t)}function Sj(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,hk(e)):(r.next=s.next,s.next=r),e.interleaved=r,sl(t,n)}function sl(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ol=!1;function gk(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bj(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Jo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Yl(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,vr&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,sl(t,r)}return s=n.interleaved,s===null?(e.next=e,hk(n)):(e.next=s.next,s.next=e),n.interleaved=e,sl(t,r)}function ix(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Zb(t,r)}}function ME(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function zx(t,e,r,n){var s=t.updateQueue;Ol=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?a=u:i.next=u,i=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(a!==null){var h=s.baseState;i=0,d=u=l=null,o=a;do{var m=o.lane,x=o.eventTime;if((n&m)===m){d!==null&&(d=d.next={eventTime:x,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=t,v=o;switch(m=e,x=r,v.tag){case 1:if(p=v.payload,typeof p=="function"){h=p.call(x,h,m);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=v.payload,m=typeof p=="function"?p.call(x,h,m):p,m==null)break e;h=fn({},h,m);break e;case 2:Ol=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[o]:m.push(o))}else x={eventTime:x,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=x,l=h):d=d.next=x,i|=m;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(d===null&&(l=h),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);_u|=i,t.lanes=i,t.memoizedState=h}}function LE(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(lt(191,s));s.call(n)}}}var Rg={},po=mc(Rg),G0=mc(Rg),H0=mc(Rg);function Zc(t){if(t===Rg)throw Error(lt(174));return t}function mk(t,e){switch(Ur(H0,e),Ur(G0,t),Ur(po,Rg),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:A_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=A_(e,t)}Vr(po),Ur(po,e)}function kf(){Vr(po),Vr(G0),Vr(H0)}function kj(t){Zc(H0.current);var e=Zc(po.current),r=A_(e,t.type);e!==r&&(Ur(G0,t),Ur(po,r))}function pk(t){G0.current===t&&(Vr(po),Vr(G0))}var an=mc(0);function Wx(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var n2=[];function xk(){for(var t=0;t<n2.length;t++)n2[t]._workInProgressVersionPrimary=null;n2.length=0}var ox=dl.ReactCurrentDispatcher,s2=dl.ReactCurrentBatchConfig,wu=0,dn=null,Xn=null,cs=null,Vx=!1,f0=!1,K0=0,cU=0;function Ps(){throw Error(lt(321))}function yk(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Wi(t[r],e[r]))return!1;return!0}function vk(t,e,r,n,s,a){if(wu=a,dn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ox.current=t===null||t.memoizedState===null?hU:gU,t=r(n,s),f0){a=0;do{if(f0=!1,K0=0,25<=a)throw Error(lt(301));a+=1,cs=Xn=null,e.updateQueue=null,ox.current=mU,t=r(n,s)}while(f0)}if(ox.current=Gx,e=Xn!==null&&Xn.next!==null,wu=0,cs=Xn=dn=null,Vx=!1,e)throw Error(lt(300));return t}function wk(){var t=K0!==0;return K0=0,t}function ao(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cs===null?dn.memoizedState=cs=t:cs=cs.next=t,cs}function mi(){if(Xn===null){var t=dn.alternate;t=t!==null?t.memoizedState:null}else t=Xn.next;var e=cs===null?dn.memoizedState:cs.next;if(e!==null)cs=e,Xn=t;else{if(t===null)throw Error(lt(310));Xn=t,t={memoizedState:Xn.memoizedState,baseState:Xn.baseState,baseQueue:Xn.baseQueue,queue:Xn.queue,next:null},cs===null?dn.memoizedState=cs=t:cs=cs.next=t}return cs}function X0(t,e){return typeof e=="function"?e(t):e}function a2(t){var e=mi(),r=e.queue;if(r===null)throw Error(lt(311));r.lastRenderedReducer=t;var n=Xn,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,u=a;do{var d=u.lane;if((wu&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,i=n):l=l.next=h,dn.lanes|=d,_u|=d}u=u.next}while(u!==null&&u!==a);l===null?i=n:l.next=o,Wi(n,e.memoizedState)||(ma=!0),e.memoizedState=n,e.baseState=i,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,dn.lanes|=a,_u|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function i2(t){var e=mi(),r=e.queue;if(r===null)throw Error(lt(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);Wi(a,e.memoizedState)||(ma=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function Cj(){}function Tj(t,e){var r=dn,n=mi(),s=e(),a=!Wi(n.memoizedState,s);if(a&&(n.memoizedState=s,ma=!0),n=n.queue,_k(Aj.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||cs!==null&&cs.memoizedState.tag&1){if(r.flags|=2048,Y0(9,Nj.bind(null,r,n,s,e),void 0,null),gs===null)throw Error(lt(349));wu&30||Ej(r,e,s)}return s}function Ej(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=dn.updateQueue,e===null?(e={lastEffect:null,stores:null},dn.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Nj(t,e,r,n){e.value=r,e.getSnapshot=n,Fj(e)&&jj(t)}function Aj(t,e,r){return r(function(){Fj(e)&&jj(t)})}function Fj(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Wi(t,r)}catch{return!0}}function jj(t){var e=sl(t,1);e!==null&&Ii(e,t,1,-1)}function IE(t){var e=ao();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:X0,lastRenderedState:t},e.queue=t,t=t.dispatch=fU.bind(null,dn,t),[e.memoizedState,t]}function Y0(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=dn.updateQueue,e===null?(e={lastEffect:null,stores:null},dn.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Pj(){return mi().memoizedState}function lx(t,e,r,n){var s=ao();dn.flags|=t,s.memoizedState=Y0(1|e,r,void 0,n===void 0?null:n)}function X1(t,e,r,n){var s=mi();n=n===void 0?null:n;var a=void 0;if(Xn!==null){var i=Xn.memoizedState;if(a=i.destroy,n!==null&&yk(n,i.deps)){s.memoizedState=Y0(e,r,a,n);return}}dn.flags|=t,s.memoizedState=Y0(1|e,r,a,n)}function BE(t,e){return lx(8390656,8,t,e)}function _k(t,e){return X1(2048,8,t,e)}function Dj(t,e){return X1(4,2,t,e)}function Rj(t,e){return X1(4,4,t,e)}function Oj(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Mj(t,e,r){return r=r!=null?r.concat([t]):null,X1(4,4,Oj.bind(null,e,t),r)}function Sk(){}function Lj(t,e){var r=mi();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&yk(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Ij(t,e){var r=mi();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&yk(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Bj(t,e,r){return wu&21?(Wi(r,e)||(r=VF(),dn.lanes|=r,_u|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ma=!0),t.memoizedState=r)}function uU(t,e){var r=Rr;Rr=r!==0&&4>r?r:4,t(!0);var n=s2.transition;s2.transition={};try{t(!1),e()}finally{Rr=r,s2.transition=n}}function Uj(){return mi().memoizedState}function dU(t,e,r){var n=Ql(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},$j(t))zj(e,r);else if(r=Sj(t,e,r,n),r!==null){var s=ra();Ii(r,t,n,s),Wj(r,e,n)}}function fU(t,e,r){var n=Ql(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if($j(t))zj(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var i=e.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,Wi(o,i)){var l=e.interleaved;l===null?(s.next=s,hk(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=Sj(t,e,s,n),r!==null&&(s=ra(),Ii(r,t,n,s),Wj(r,e,n))}}function $j(t){var e=t.alternate;return t===dn||e!==null&&e===dn}function zj(t,e){f0=Vx=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Wj(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Zb(t,r)}}var Gx={readContext:gi,useCallback:Ps,useContext:Ps,useEffect:Ps,useImperativeHandle:Ps,useInsertionEffect:Ps,useLayoutEffect:Ps,useMemo:Ps,useReducer:Ps,useRef:Ps,useState:Ps,useDebugValue:Ps,useDeferredValue:Ps,useTransition:Ps,useMutableSource:Ps,useSyncExternalStore:Ps,useId:Ps,unstable_isNewReconciler:!1},hU={readContext:gi,useCallback:function(t,e){return ao().memoizedState=[t,e===void 0?null:e],t},useContext:gi,useEffect:BE,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,lx(4194308,4,Oj.bind(null,e,t),r)},useLayoutEffect:function(t,e){return lx(4194308,4,t,e)},useInsertionEffect:function(t,e){return lx(4,2,t,e)},useMemo:function(t,e){var r=ao();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=ao();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=dU.bind(null,dn,t),[n.memoizedState,t]},useRef:function(t){var e=ao();return t={current:t},e.memoizedState=t},useState:IE,useDebugValue:Sk,useDeferredValue:function(t){return ao().memoizedState=t},useTransition:function(){var t=IE(!1),e=t[0];return t=uU.bind(null,t[1]),ao().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=dn,s=ao();if(qr){if(r===void 0)throw Error(lt(407));r=r()}else{if(r=e(),gs===null)throw Error(lt(349));wu&30||Ej(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,BE(Aj.bind(null,n,a,t),[t]),n.flags|=2048,Y0(9,Nj.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=ao(),e=gs.identifierPrefix;if(qr){var r=Ko,n=Ho;r=(n&~(1<<32-Li(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=K0++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=cU++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},gU={readContext:gi,useCallback:Lj,useContext:gi,useEffect:_k,useImperativeHandle:Mj,useInsertionEffect:Dj,useLayoutEffect:Rj,useMemo:Ij,useReducer:a2,useRef:Pj,useState:function(){return a2(X0)},useDebugValue:Sk,useDeferredValue:function(t){var e=mi();return Bj(e,Xn.memoizedState,t)},useTransition:function(){var t=a2(X0)[0],e=mi().memoizedState;return[t,e]},useMutableSource:Cj,useSyncExternalStore:Tj,useId:Uj,unstable_isNewReconciler:!1},mU={readContext:gi,useCallback:Lj,useContext:gi,useEffect:_k,useImperativeHandle:Mj,useInsertionEffect:Dj,useLayoutEffect:Rj,useMemo:Ij,useReducer:i2,useRef:Pj,useState:function(){return i2(X0)},useDebugValue:Sk,useDeferredValue:function(t){var e=mi();return Xn===null?e.memoizedState=t:Bj(e,Xn.memoizedState,t)},useTransition:function(){var t=i2(X0)[0],e=mi().memoizedState;return[t,e]},useMutableSource:Cj,useSyncExternalStore:Tj,useId:Uj,unstable_isNewReconciler:!1};function ji(t,e){if(t&&t.defaultProps){e=fn({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function J_(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:fn({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Y1={isMounted:function(t){return(t=t._reactInternals)?Wu(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=ra(),s=Ql(t),a=Jo(n,s);a.payload=e,r!=null&&(a.callback=r),e=Yl(t,a,s),e!==null&&(Ii(e,t,s,n),ix(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=ra(),s=Ql(t),a=Jo(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Yl(t,a,s),e!==null&&(Ii(e,t,s,n),ix(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=ra(),n=Ql(t),s=Jo(r,n);s.tag=2,e!=null&&(s.callback=e),e=Yl(t,s,n),e!==null&&(Ii(e,t,n,r),ix(e,t,n))}};function UE(t,e,r,n,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,i):e.prototype&&e.prototype.isPureReactComponent?!$0(r,n)||!$0(s,a):!0}function Vj(t,e,r){var n=!1,s=nc,a=e.contextType;return typeof a=="object"&&a!==null?a=gi(a):(s=ya(e)?yu:Vs.current,n=e.contextTypes,a=(n=n!=null)?_f(t,s):nc),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Y1,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function $E(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Y1.enqueueReplaceState(e,e.state,null)}function Q_(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},gk(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=gi(a):(a=ya(e)?yu:Vs.current,s.context=_f(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(J_(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Y1.enqueueReplaceState(s,s.state,null),zx(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Cf(t,e){try{var r="",n=e;do r+=WI(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function o2(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function q_(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var pU=typeof WeakMap=="function"?WeakMap:Map;function Gj(t,e,r){r=Jo(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Kx||(Kx=!0,lS=n),q_(t,e)},r}function Hj(t,e,r){r=Jo(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){q_(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){q_(t,e),typeof n!="function"&&(Jl===null?Jl=new Set([this]):Jl.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function zE(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new pU;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=FU.bind(null,t,e,r),e.then(t,t))}function WE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function VE(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Jo(-1,1),e.tag=2,Yl(r,e,1))),r.lanes|=1),t)}var xU=dl.ReactCurrentOwner,ma=!1;function Js(t,e,r,n){e.child=t===null?_j(e,null,r,n):bf(e,t.child,r,n)}function GE(t,e,r,n,s){r=r.render;var a=e.ref;return lf(e,s),n=vk(t,e,r,n,a,s),r=wk(),t!==null&&!ma?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,al(t,e,s)):(qr&&r&&ok(e),e.flags|=1,Js(t,e,n,s),e.child)}function HE(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!Fk(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,Kj(t,e,a,n,s)):(t=fx(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:$0,r(i,n)&&t.ref===e.ref)return al(t,e,s)}return e.flags|=1,t=ql(a,n),t.ref=e.ref,t.return=e,e.child=t}function Kj(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if($0(a,n)&&t.ref===e.ref)if(ma=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(ma=!0);else return e.lanes=t.lanes,al(t,e,s)}return Z_(t,e,r,n,s)}function Xj(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ur(Kd,Ea),Ea|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ur(Kd,Ea),Ea|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Ur(Kd,Ea),Ea|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Ur(Kd,Ea),Ea|=n;return Js(t,e,s,r),e.child}function Yj(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Z_(t,e,r,n,s){var a=ya(r)?yu:Vs.current;return a=_f(e,a),lf(e,s),r=vk(t,e,r,n,a,s),n=wk(),t!==null&&!ma?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,al(t,e,s)):(qr&&n&&ok(e),e.flags|=1,Js(t,e,r,s),e.child)}function KE(t,e,r,n,s){if(ya(r)){var a=!0;Lx(e)}else a=!1;if(lf(e,s),e.stateNode===null)cx(t,e),Vj(e,r,n),Q_(e,r,n,s),n=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var l=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=gi(u):(u=ya(r)?yu:Vs.current,u=_f(e,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==u)&&$E(e,i,n,u),Ol=!1;var m=e.memoizedState;i.state=m,zx(e,n,i,s),l=e.memoizedState,o!==n||m!==l||xa.current||Ol?(typeof d=="function"&&(J_(e,r,d,n),l=e.memoizedState),(o=Ol||UE(e,r,o,n,m,l,u))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),i.props=n,i.state=l,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{i=e.stateNode,bj(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:ji(e.type,o),i.props=u,h=e.pendingProps,m=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=gi(l):(l=ya(r)?yu:Vs.current,l=_f(e,l));var x=r.getDerivedStateFromProps;(d=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||m!==l)&&$E(e,i,n,l),Ol=!1,m=e.memoizedState,i.state=m,zx(e,n,i,s);var p=e.memoizedState;o!==h||m!==p||xa.current||Ol?(typeof x=="function"&&(J_(e,r,x,n),p=e.memoizedState),(u=Ol||UE(e,r,u,n,m,p,l)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,p,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,p,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=p),i.props=n,i.state=p,i.context=l,n=u):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),n=!1)}return eS(t,e,r,n,a,s)}function eS(t,e,r,n,s,a){Yj(t,e);var i=(e.flags&128)!==0;if(!n&&!i)return s&&PE(e,r,!1),al(t,e,a);n=e.stateNode,xU.current=e;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&i?(e.child=bf(e,t.child,null,a),e.child=bf(e,null,o,a)):Js(t,e,o,a),e.memoizedState=n.state,s&&PE(e,r,!0),e.child}function Jj(t){var e=t.stateNode;e.pendingContext?jE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&jE(t,e.context,!1),mk(t,e.containerInfo)}function XE(t,e,r,n,s){return Sf(),ck(s),e.flags|=256,Js(t,e,r,n),e.child}var tS={dehydrated:null,treeContext:null,retryLane:0};function rS(t){return{baseLanes:t,cachePool:null,transitions:null}}function Qj(t,e,r){var n=e.pendingProps,s=an.current,a=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ur(an,s&1),t===null)return X_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=n.children,t=n.fallback,a?(n=e.mode,a=e.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=q1(i,n,0,null),t=ou(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=rS(r),e.memoizedState=tS,t):bk(e,i));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return yU(t,e,i,n,o,s,r);if(a){a=n.fallback,i=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=ql(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=ql(o,a):(a=ou(a,i,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,i=t.child.memoizedState,i=i===null?rS(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~r,e.memoizedState=tS,n}return a=t.child,t=a.sibling,n=ql(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function bk(t,e){return e=q1({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wp(t,e,r,n){return n!==null&&ck(n),bf(e,t.child,null,r),t=bk(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function yU(t,e,r,n,s,a,i){if(r)return e.flags&256?(e.flags&=-257,n=o2(Error(lt(422))),wp(t,e,i,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=q1({mode:"visible",children:n.children},s,0,null),a=ou(a,s,i,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&bf(e,t.child,null,i),e.child.memoizedState=rS(i),e.memoizedState=tS,a);if(!(e.mode&1))return wp(t,e,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(lt(419)),n=o2(a,n,void 0),wp(t,e,i,n)}if(o=(i&t.childLanes)!==0,ma||o){if(n=gs,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,sl(t,s),Ii(n,t,s,-1))}return Ak(),n=o2(Error(lt(421))),wp(t,e,i,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=jU.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,Da=Xl(s.nextSibling),Ra=e,qr=!0,Ri=null,t!==null&&(ai[ii++]=Ho,ai[ii++]=Ko,ai[ii++]=vu,Ho=t.id,Ko=t.overflow,vu=e),e=bk(e,n.children),e.flags|=4096,e)}function YE(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Y_(t.return,e,r)}function l2(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function qj(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Js(t,e,n.children,r),n=an.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&YE(t,r,e);else if(t.tag===19)YE(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Ur(an,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Wx(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),l2(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Wx(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}l2(e,!0,r,null,a);break;case"together":l2(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function cx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function al(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),_u|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(lt(153));if(e.child!==null){for(t=e.child,r=ql(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ql(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function vU(t,e,r){switch(e.tag){case 3:Jj(e),Sf();break;case 5:kj(e);break;case 1:ya(e.type)&&Lx(e);break;case 4:mk(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Ur(Ux,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ur(an,an.current&1),e.flags|=128,null):r&e.child.childLanes?Qj(t,e,r):(Ur(an,an.current&1),t=al(t,e,r),t!==null?t.sibling:null);Ur(an,an.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return qj(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ur(an,an.current),n)break;return null;case 22:case 23:return e.lanes=0,Xj(t,e,r)}return al(t,e,r)}var Zj,nS,e9,t9;Zj=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};nS=function(){};e9=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Zc(po.current);var a=null;switch(r){case"input":s=C_(t,s),n=C_(t,n),a=[];break;case"select":s=fn({},s,{value:void 0}),n=fn({},n,{value:void 0}),a=[];break;case"textarea":s=N_(t,s),n=N_(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Ox)}F_(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(R0.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var l=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(R0.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&zr("scroll",t),a||o===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};t9=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ih(t,e){if(!qr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Ds(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function wU(t,e,r){var n=e.pendingProps;switch(lk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ds(e),null;case 1:return ya(e.type)&&Mx(),Ds(e),null;case 3:return n=e.stateNode,kf(),Vr(xa),Vr(Vs),xk(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(yp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ri!==null&&(dS(Ri),Ri=null))),nS(t,e),Ds(e),null;case 5:pk(e);var s=Zc(H0.current);if(r=e.type,t!==null&&e.stateNode!=null)e9(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(lt(166));return Ds(e),null}if(t=Zc(po.current),yp(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[co]=e,n[V0]=a,t=(e.mode&1)!==0,r){case"dialog":zr("cancel",n),zr("close",n);break;case"iframe":case"object":case"embed":zr("load",n);break;case"video":case"audio":for(s=0;s<Zh.length;s++)zr(Zh[s],n);break;case"source":zr("error",n);break;case"img":case"image":case"link":zr("error",n),zr("load",n);break;case"details":zr("toggle",n);break;case"input":sE(n,a),zr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},zr("invalid",n);break;case"textarea":iE(n,a),zr("invalid",n)}F_(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&xp(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&xp(n.textContent,o,t),s=["children",""+o]):R0.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&zr("scroll",n)}switch(r){case"input":cp(n),aE(n,a,!0);break;case"textarea":cp(n),oE(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Ox)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=AF(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(r,{is:n.is}):(t=i.createElement(r),r==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,r),t[co]=e,t[V0]=n,Zj(t,e,!1,!1),e.stateNode=t;e:{switch(i=j_(r,n),r){case"dialog":zr("cancel",t),zr("close",t),s=n;break;case"iframe":case"object":case"embed":zr("load",t),s=n;break;case"video":case"audio":for(s=0;s<Zh.length;s++)zr(Zh[s],t);s=n;break;case"source":zr("error",t),s=n;break;case"img":case"image":case"link":zr("error",t),zr("load",t),s=n;break;case"details":zr("toggle",t),s=n;break;case"input":sE(t,n),s=C_(t,n),zr("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=fn({},n,{value:void 0}),zr("invalid",t);break;case"textarea":iE(t,n),s=N_(t,n),zr("invalid",t);break;default:s=n}F_(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?PF(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&FF(t,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&O0(t,l):typeof l=="number"&&O0(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(R0.hasOwnProperty(a)?l!=null&&a==="onScroll"&&zr("scroll",t):l!=null&&Kb(t,a,l,i))}switch(r){case"input":cp(t),aE(t,n,!1);break;case"textarea":cp(t),oE(t);break;case"option":n.value!=null&&t.setAttribute("value",""+rc(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?nf(t,!!n.multiple,a,!1):n.defaultValue!=null&&nf(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ox)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ds(e),null;case 6:if(t&&e.stateNode!=null)t9(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(lt(166));if(r=Zc(H0.current),Zc(po.current),yp(e)){if(n=e.stateNode,r=e.memoizedProps,n[co]=e,(a=n.nodeValue!==r)&&(t=Ra,t!==null))switch(t.tag){case 3:xp(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&xp(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[co]=e,e.stateNode=n}return Ds(e),null;case 13:if(Vr(an),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(qr&&Da!==null&&e.mode&1&&!(e.flags&128))vj(),Sf(),e.flags|=98560,a=!1;else if(a=yp(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(lt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(lt(317));a[co]=e}else Sf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ds(e),a=!1}else Ri!==null&&(dS(Ri),Ri=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||an.current&1?qn===0&&(qn=3):Ak())),e.updateQueue!==null&&(e.flags|=4),Ds(e),null);case 4:return kf(),nS(t,e),t===null&&z0(e.stateNode.containerInfo),Ds(e),null;case 10:return fk(e.type._context),Ds(e),null;case 17:return ya(e.type)&&Mx(),Ds(e),null;case 19:if(Vr(an),a=e.memoizedState,a===null)return Ds(e),null;if(n=(e.flags&128)!==0,i=a.rendering,i===null)if(n)Ih(a,!1);else{if(qn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=Wx(t),i!==null){for(e.flags|=128,Ih(a,!1),n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Ur(an,an.current&1|2),e.child}t=t.sibling}a.tail!==null&&jn()>Tf&&(e.flags|=128,n=!0,Ih(a,!1),e.lanes=4194304)}else{if(!n)if(t=Wx(i),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ih(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!qr)return Ds(e),null}else 2*jn()-a.renderingStartTime>Tf&&r!==1073741824&&(e.flags|=128,n=!0,Ih(a,!1),e.lanes=4194304);a.isBackwards?(i.sibling=e.child,e.child=i):(r=a.last,r!==null?r.sibling=i:e.child=i,a.last=i)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=jn(),e.sibling=null,r=an.current,Ur(an,n?r&1|2:r&1),e):(Ds(e),null);case 22:case 23:return Nk(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Ea&1073741824&&(Ds(e),e.subtreeFlags&6&&(e.flags|=8192)):Ds(e),null;case 24:return null;case 25:return null}throw Error(lt(156,e.tag))}function _U(t,e){switch(lk(e),e.tag){case 1:return ya(e.type)&&Mx(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return kf(),Vr(xa),Vr(Vs),xk(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return pk(e),null;case 13:if(Vr(an),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(lt(340));Sf()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Vr(an),null;case 4:return kf(),null;case 10:return fk(e.type._context),null;case 22:case 23:return Nk(),null;case 24:return null;default:return null}}var _p=!1,Is=!1,SU=typeof WeakSet=="function"?WeakSet:Set,Nt=null;function Hd(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){yn(t,e,n)}else r.current=null}function sS(t,e,r){try{r()}catch(n){yn(t,e,n)}}var JE=!1;function bU(t,e){if($_=Px,t=ij(),ik(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,u=0,d=0,h=t,m=null;t:for(;;){for(var x;h!==r||s!==0&&h.nodeType!==3||(o=i+s),h!==a||n!==0&&h.nodeType!==3||(l=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(x=h.firstChild)!==null;)m=h,h=x;for(;;){if(h===t)break t;if(m===r&&++u===s&&(o=i),m===a&&++d===n&&(l=i),(x=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=x}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(z_={focusedElem:t,selectionRange:r},Px=!1,Nt=e;Nt!==null;)if(e=Nt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Nt=t;else for(;Nt!==null;){e=Nt;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var v=p.memoizedProps,_=p.memoizedState,S=e.stateNode,w=S.getSnapshotBeforeUpdate(e.elementType===e.type?v:ji(e.type,v),_);S.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(lt(163))}}catch(b){yn(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,Nt=t;break}Nt=e.return}return p=JE,JE=!1,p}function h0(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&sS(e,r,a)}s=s.next}while(s!==n)}}function J1(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function aS(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function r9(t){var e=t.alternate;e!==null&&(t.alternate=null,r9(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[co],delete e[V0],delete e[G_],delete e[aU],delete e[iU])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function n9(t){return t.tag===5||t.tag===3||t.tag===4}function QE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||n9(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function iS(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Ox));else if(n!==4&&(t=t.child,t!==null))for(iS(t,e,r),t=t.sibling;t!==null;)iS(t,e,r),t=t.sibling}function oS(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(oS(t,e,r),t=t.sibling;t!==null;)oS(t,e,r),t=t.sibling}var ys=null,Di=!1;function Al(t,e,r){for(r=r.child;r!==null;)s9(t,e,r),r=r.sibling}function s9(t,e,r){if(mo&&typeof mo.onCommitFiberUnmount=="function")try{mo.onCommitFiberUnmount(z1,r)}catch{}switch(r.tag){case 5:Is||Hd(r,e);case 6:var n=ys,s=Di;ys=null,Al(t,e,r),ys=n,Di=s,ys!==null&&(Di?(t=ys,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ys.removeChild(r.stateNode));break;case 18:ys!==null&&(Di?(t=ys,r=r.stateNode,t.nodeType===8?t2(t.parentNode,r):t.nodeType===1&&t2(t,r),B0(t)):t2(ys,r.stateNode));break;case 4:n=ys,s=Di,ys=r.stateNode.containerInfo,Di=!0,Al(t,e,r),ys=n,Di=s;break;case 0:case 11:case 14:case 15:if(!Is&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&sS(r,e,i),s=s.next}while(s!==n)}Al(t,e,r);break;case 1:if(!Is&&(Hd(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){yn(r,e,o)}Al(t,e,r);break;case 21:Al(t,e,r);break;case 22:r.mode&1?(Is=(n=Is)||r.memoizedState!==null,Al(t,e,r),Is=n):Al(t,e,r);break;default:Al(t,e,r)}}function qE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new SU),e.forEach(function(n){var s=PU.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ei(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:ys=o.stateNode,Di=!1;break e;case 3:ys=o.stateNode.containerInfo,Di=!0;break e;case 4:ys=o.stateNode.containerInfo,Di=!0;break e}o=o.return}if(ys===null)throw Error(lt(160));s9(a,i,s),ys=null,Di=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){yn(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)a9(e,t),e=e.sibling}function a9(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ei(e,t),to(t),n&4){try{h0(3,t,t.return),J1(3,t)}catch(v){yn(t,t.return,v)}try{h0(5,t,t.return)}catch(v){yn(t,t.return,v)}}break;case 1:Ei(e,t),to(t),n&512&&r!==null&&Hd(r,r.return);break;case 5:if(Ei(e,t),to(t),n&512&&r!==null&&Hd(r,r.return),t.flags&32){var s=t.stateNode;try{O0(s,"")}catch(v){yn(t,t.return,v)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=r!==null?r.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&EF(s,a),j_(o,i);var u=j_(o,a);for(i=0;i<l.length;i+=2){var d=l[i],h=l[i+1];d==="style"?PF(s,h):d==="dangerouslySetInnerHTML"?FF(s,h):d==="children"?O0(s,h):Kb(s,d,h,u)}switch(o){case"input":T_(s,a);break;case"textarea":NF(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var x=a.value;x!=null?nf(s,!!a.multiple,x,!1):m!==!!a.multiple&&(a.defaultValue!=null?nf(s,!!a.multiple,a.defaultValue,!0):nf(s,!!a.multiple,a.multiple?[]:"",!1))}s[V0]=a}catch(v){yn(t,t.return,v)}}break;case 6:if(Ei(e,t),to(t),n&4){if(t.stateNode===null)throw Error(lt(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(v){yn(t,t.return,v)}}break;case 3:if(Ei(e,t),to(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{B0(e.containerInfo)}catch(v){yn(t,t.return,v)}break;case 4:Ei(e,t),to(t);break;case 13:Ei(e,t),to(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Tk=jn())),n&4&&qE(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Is=(u=Is)||d,Ei(e,t),Is=u):Ei(e,t),to(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Nt=t,d=t.child;d!==null;){for(h=Nt=d;Nt!==null;){switch(m=Nt,x=m.child,m.tag){case 0:case 11:case 14:case 15:h0(4,m,m.return);break;case 1:Hd(m,m.return);var p=m.stateNode;if(typeof p.componentWillUnmount=="function"){n=m,r=m.return;try{e=n,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(v){yn(n,r,v)}}break;case 5:Hd(m,m.return);break;case 22:if(m.memoizedState!==null){eN(h);continue}}x!==null?(x.return=m,Nt=x):eN(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=jF("display",i))}catch(v){yn(t,t.return,v)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(v){yn(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ei(e,t),to(t),n&4&&qE(t);break;case 21:break;default:Ei(e,t),to(t)}}function to(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(n9(r)){var n=r;break e}r=r.return}throw Error(lt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(O0(s,""),n.flags&=-33);var a=QE(t);oS(t,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=QE(t);iS(t,o,i);break;default:throw Error(lt(161))}}catch(l){yn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function kU(t,e,r){Nt=t,i9(t)}function i9(t,e,r){for(var n=(t.mode&1)!==0;Nt!==null;){var s=Nt,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||_p;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Is;o=_p;var u=Is;if(_p=i,(Is=l)&&!u)for(Nt=s;Nt!==null;)i=Nt,l=i.child,i.tag===22&&i.memoizedState!==null?tN(s):l!==null?(l.return=i,Nt=l):tN(s);for(;a!==null;)Nt=a,i9(a),a=a.sibling;Nt=s,_p=o,Is=u}ZE(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Nt=a):ZE(t)}}function ZE(t){for(;Nt!==null;){var e=Nt;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Is||J1(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Is)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:ji(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&LE(e,a,n);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}LE(e,i,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&B0(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(lt(163))}Is||e.flags&512&&aS(e)}catch(m){yn(e,e.return,m)}}if(e===t){Nt=null;break}if(r=e.sibling,r!==null){r.return=e.return,Nt=r;break}Nt=e.return}}function eN(t){for(;Nt!==null;){var e=Nt;if(e===t){Nt=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Nt=r;break}Nt=e.return}}function tN(t){for(;Nt!==null;){var e=Nt;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{J1(4,e)}catch(l){yn(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){yn(e,s,l)}}var a=e.return;try{aS(e)}catch(l){yn(e,a,l)}break;case 5:var i=e.return;try{aS(e)}catch(l){yn(e,i,l)}}}catch(l){yn(e,e.return,l)}if(e===t){Nt=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Nt=o;break}Nt=e.return}}var CU=Math.ceil,Hx=dl.ReactCurrentDispatcher,kk=dl.ReactCurrentOwner,di=dl.ReactCurrentBatchConfig,vr=0,gs=null,Wn=null,ks=0,Ea=0,Kd=mc(0),qn=0,J0=null,_u=0,Q1=0,Ck=0,g0=null,ga=null,Tk=0,Tf=1/0,$o=null,Kx=!1,lS=null,Jl=null,Sp=!1,Bl=null,Xx=0,m0=0,cS=null,ux=-1,dx=0;function ra(){return vr&6?jn():ux!==-1?ux:ux=jn()}function Ql(t){return t.mode&1?vr&2&&ks!==0?ks&-ks:lU.transition!==null?(dx===0&&(dx=VF()),dx):(t=Rr,t!==0||(t=window.event,t=t===void 0?16:QF(t.type)),t):1}function Ii(t,e,r,n){if(50<m0)throw m0=0,cS=null,Error(lt(185));jg(t,r,n),(!(vr&2)||t!==gs)&&(t===gs&&(!(vr&2)&&(Q1|=r),qn===4&&Ll(t,ks)),va(t,n),r===1&&vr===0&&!(e.mode&1)&&(Tf=jn()+500,K1&&pc()))}function va(t,e){var r=t.callbackNode;lB(t,e);var n=jx(t,t===gs?ks:0);if(n===0)r!==null&&uE(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&uE(r),e===1)t.tag===0?oU(rN.bind(null,t)):pj(rN.bind(null,t)),nU(function(){!(vr&6)&&pc()}),r=null;else{switch(GF(n)){case 1:r=qb;break;case 4:r=zF;break;case 16:r=Fx;break;case 536870912:r=WF;break;default:r=Fx}r=g9(r,o9.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function o9(t,e){if(ux=-1,dx=0,vr&6)throw Error(lt(327));var r=t.callbackNode;if(cf()&&t.callbackNode!==r)return null;var n=jx(t,t===gs?ks:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Yx(t,n);else{e=n;var s=vr;vr|=2;var a=c9();(gs!==t||ks!==e)&&($o=null,Tf=jn()+500,iu(t,e));do try{NU();break}catch(o){l9(t,o)}while(!0);dk(),Hx.current=a,vr=s,Wn!==null?e=0:(gs=null,ks=0,e=qn)}if(e!==0){if(e===2&&(s=M_(t),s!==0&&(n=s,e=uS(t,s))),e===1)throw r=J0,iu(t,0),Ll(t,n),va(t,jn()),r;if(e===6)Ll(t,n);else{if(s=t.current.alternate,!(n&30)&&!TU(s)&&(e=Yx(t,n),e===2&&(a=M_(t),a!==0&&(n=a,e=uS(t,a))),e===1))throw r=J0,iu(t,0),Ll(t,n),va(t,jn()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(lt(345));case 2:Gc(t,ga,$o);break;case 3:if(Ll(t,n),(n&130023424)===n&&(e=Tk+500-jn(),10<e)){if(jx(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){ra(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=V_(Gc.bind(null,t,ga,$o),e);break}Gc(t,ga,$o);break;case 4:if(Ll(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var i=31-Li(n);a=1<<i,i=e[i],i>s&&(s=i),n&=~a}if(n=s,n=jn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*CU(n/1960))-n,10<n){t.timeoutHandle=V_(Gc.bind(null,t,ga,$o),n);break}Gc(t,ga,$o);break;case 5:Gc(t,ga,$o);break;default:throw Error(lt(329))}}}return va(t,jn()),t.callbackNode===r?o9.bind(null,t):null}function uS(t,e){var r=g0;return t.current.memoizedState.isDehydrated&&(iu(t,e).flags|=256),t=Yx(t,e),t!==2&&(e=ga,ga=r,e!==null&&dS(e)),t}function dS(t){ga===null?ga=t:ga.push.apply(ga,t)}function TU(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Wi(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ll(t,e){for(e&=~Ck,e&=~Q1,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Li(e),n=1<<r;t[r]=-1,e&=~n}}function rN(t){if(vr&6)throw Error(lt(327));cf();var e=jx(t,0);if(!(e&1))return va(t,jn()),null;var r=Yx(t,e);if(t.tag!==0&&r===2){var n=M_(t);n!==0&&(e=n,r=uS(t,n))}if(r===1)throw r=J0,iu(t,0),Ll(t,e),va(t,jn()),r;if(r===6)throw Error(lt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Gc(t,ga,$o),va(t,jn()),null}function Ek(t,e){var r=vr;vr|=1;try{return t(e)}finally{vr=r,vr===0&&(Tf=jn()+500,K1&&pc())}}function Su(t){Bl!==null&&Bl.tag===0&&!(vr&6)&&cf();var e=vr;vr|=1;var r=di.transition,n=Rr;try{if(di.transition=null,Rr=1,t)return t()}finally{Rr=n,di.transition=r,vr=e,!(vr&6)&&pc()}}function Nk(){Ea=Kd.current,Vr(Kd)}function iu(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,rU(r)),Wn!==null)for(r=Wn.return;r!==null;){var n=r;switch(lk(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Mx();break;case 3:kf(),Vr(xa),Vr(Vs),xk();break;case 5:pk(n);break;case 4:kf();break;case 13:Vr(an);break;case 19:Vr(an);break;case 10:fk(n.type._context);break;case 22:case 23:Nk()}r=r.return}if(gs=t,Wn=t=ql(t.current,null),ks=Ea=e,qn=0,J0=null,Ck=Q1=_u=0,ga=g0=null,qc!==null){for(e=0;e<qc.length;e++)if(r=qc[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}qc=null}return t}function l9(t,e){do{var r=Wn;try{if(dk(),ox.current=Gx,Vx){for(var n=dn.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Vx=!1}if(wu=0,cs=Xn=dn=null,f0=!1,K0=0,kk.current=null,r===null||r.return===null){qn=1,J0=e,Wn=null;break}e:{var a=t,i=r.return,o=r,l=e;if(e=ks,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var x=WE(i);if(x!==null){x.flags&=-257,VE(x,i,o,a,e),x.mode&1&&zE(a,u,e),e=x,l=u;var p=e.updateQueue;if(p===null){var v=new Set;v.add(l),e.updateQueue=v}else p.add(l);break e}else{if(!(e&1)){zE(a,u,e),Ak();break e}l=Error(lt(426))}}else if(qr&&o.mode&1){var _=WE(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),VE(_,i,o,a,e),ck(Cf(l,o));break e}}a=l=Cf(l,o),qn!==4&&(qn=2),g0===null?g0=[a]:g0.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var S=Gj(a,l,e);ME(a,S);break e;case 1:o=l;var w=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Jl===null||!Jl.has(y)))){a.flags|=65536,e&=-e,a.lanes|=e;var b=Hj(a,o,e);ME(a,b);break e}}a=a.return}while(a!==null)}d9(r)}catch(E){e=E,Wn===r&&r!==null&&(Wn=r=r.return);continue}break}while(!0)}function c9(){var t=Hx.current;return Hx.current=Gx,t===null?Gx:t}function Ak(){(qn===0||qn===3||qn===2)&&(qn=4),gs===null||!(_u&268435455)&&!(Q1&268435455)||Ll(gs,ks)}function Yx(t,e){var r=vr;vr|=2;var n=c9();(gs!==t||ks!==e)&&($o=null,iu(t,e));do try{EU();break}catch(s){l9(t,s)}while(!0);if(dk(),vr=r,Hx.current=n,Wn!==null)throw Error(lt(261));return gs=null,ks=0,qn}function EU(){for(;Wn!==null;)u9(Wn)}function NU(){for(;Wn!==null&&!ZI();)u9(Wn)}function u9(t){var e=h9(t.alternate,t,Ea);t.memoizedProps=t.pendingProps,e===null?d9(t):Wn=e,kk.current=null}function d9(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=_U(r,e),r!==null){r.flags&=32767,Wn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qn=6,Wn=null;return}}else if(r=wU(r,e,Ea),r!==null){Wn=r;return}if(e=e.sibling,e!==null){Wn=e;return}Wn=e=t}while(e!==null);qn===0&&(qn=5)}function Gc(t,e,r){var n=Rr,s=di.transition;try{di.transition=null,Rr=1,AU(t,e,r,n)}finally{di.transition=s,Rr=n}return null}function AU(t,e,r,n){do cf();while(Bl!==null);if(vr&6)throw Error(lt(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(lt(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(cB(t,a),t===gs&&(Wn=gs=null,ks=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Sp||(Sp=!0,g9(Fx,function(){return cf(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=di.transition,di.transition=null;var i=Rr;Rr=1;var o=vr;vr|=4,kk.current=null,bU(t,r),a9(r,t),YB(z_),Px=!!$_,z_=$_=null,t.current=r,kU(r),eB(),vr=o,Rr=i,di.transition=a}else t.current=r;if(Sp&&(Sp=!1,Bl=t,Xx=s),a=t.pendingLanes,a===0&&(Jl=null),nB(r.stateNode),va(t,jn()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Kx)throw Kx=!1,t=lS,lS=null,t;return Xx&1&&t.tag!==0&&cf(),a=t.pendingLanes,a&1?t===cS?m0++:(m0=0,cS=t):m0=0,pc(),null}function cf(){if(Bl!==null){var t=GF(Xx),e=di.transition,r=Rr;try{if(di.transition=null,Rr=16>t?16:t,Bl===null)var n=!1;else{if(t=Bl,Bl=null,Xx=0,vr&6)throw Error(lt(331));var s=vr;for(vr|=4,Nt=t.current;Nt!==null;){var a=Nt,i=a.child;if(Nt.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Nt=u;Nt!==null;){var d=Nt;switch(d.tag){case 0:case 11:case 15:h0(8,d,a)}var h=d.child;if(h!==null)h.return=d,Nt=h;else for(;Nt!==null;){d=Nt;var m=d.sibling,x=d.return;if(r9(d),d===u){Nt=null;break}if(m!==null){m.return=x,Nt=m;break}Nt=x}}}var p=a.alternate;if(p!==null){var v=p.child;if(v!==null){p.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}Nt=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Nt=i;else e:for(;Nt!==null;){if(a=Nt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:h0(9,a,a.return)}var S=a.sibling;if(S!==null){S.return=a.return,Nt=S;break e}Nt=a.return}}var w=t.current;for(Nt=w;Nt!==null;){i=Nt;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Nt=y;else e:for(i=w;Nt!==null;){if(o=Nt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:J1(9,o)}}catch(E){yn(o,o.return,E)}if(o===i){Nt=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,Nt=b;break e}Nt=o.return}}if(vr=s,pc(),mo&&typeof mo.onPostCommitFiberRoot=="function")try{mo.onPostCommitFiberRoot(z1,t)}catch{}n=!0}return n}finally{Rr=r,di.transition=e}}return!1}function nN(t,e,r){e=Cf(r,e),e=Gj(t,e,1),t=Yl(t,e,1),e=ra(),t!==null&&(jg(t,1,e),va(t,e))}function yn(t,e,r){if(t.tag===3)nN(t,t,r);else for(;e!==null;){if(e.tag===3){nN(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Jl===null||!Jl.has(n))){t=Cf(r,t),t=Hj(e,t,1),e=Yl(e,t,1),t=ra(),e!==null&&(jg(e,1,t),va(e,t));break}}e=e.return}}function FU(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=ra(),t.pingedLanes|=t.suspendedLanes&r,gs===t&&(ks&r)===r&&(qn===4||qn===3&&(ks&130023424)===ks&&500>jn()-Tk?iu(t,0):Ck|=r),va(t,e)}function f9(t,e){e===0&&(t.mode&1?(e=fp,fp<<=1,!(fp&130023424)&&(fp=4194304)):e=1);var r=ra();t=sl(t,e),t!==null&&(jg(t,e,r),va(t,r))}function jU(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),f9(t,r)}function PU(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(lt(314))}n!==null&&n.delete(e),f9(t,r)}var h9;h9=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||xa.current)ma=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ma=!1,vU(t,e,r);ma=!!(t.flags&131072)}else ma=!1,qr&&e.flags&1048576&&xj(e,Bx,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;cx(t,e),t=e.pendingProps;var s=_f(e,Vs.current);lf(e,r),s=vk(null,e,n,t,s,r);var a=wk();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ya(n)?(a=!0,Lx(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,gk(e),s.updater=Y1,e.stateNode=s,s._reactInternals=e,Q_(e,n,t,r),e=eS(null,e,n,!0,a,r)):(e.tag=0,qr&&a&&ok(e),Js(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(cx(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=RU(n),t=ji(n,t),s){case 0:e=Z_(null,e,n,t,r);break e;case 1:e=KE(null,e,n,t,r);break e;case 11:e=GE(null,e,n,t,r);break e;case 14:e=HE(null,e,n,ji(n.type,t),r);break e}throw Error(lt(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ji(n,s),Z_(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ji(n,s),KE(t,e,n,s,r);case 3:e:{if(Jj(e),t===null)throw Error(lt(387));n=e.pendingProps,a=e.memoizedState,s=a.element,bj(t,e),zx(e,n,null,r);var i=e.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=Cf(Error(lt(423)),e),e=XE(t,e,n,r,s);break e}else if(n!==s){s=Cf(Error(lt(424)),e),e=XE(t,e,n,r,s);break e}else for(Da=Xl(e.stateNode.containerInfo.firstChild),Ra=e,qr=!0,Ri=null,r=_j(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Sf(),n===s){e=al(t,e,r);break e}Js(t,e,n,r)}e=e.child}return e;case 5:return kj(e),t===null&&X_(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,W_(n,s)?i=null:a!==null&&W_(n,a)&&(e.flags|=32),Yj(t,e),Js(t,e,i,r),e.child;case 6:return t===null&&X_(e),null;case 13:return Qj(t,e,r);case 4:return mk(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=bf(e,null,n,r):Js(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ji(n,s),GE(t,e,n,s,r);case 7:return Js(t,e,e.pendingProps,r),e.child;case 8:return Js(t,e,e.pendingProps.children,r),e.child;case 12:return Js(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,i=s.value,Ur(Ux,n._currentValue),n._currentValue=i,a!==null)if(Wi(a.value,i)){if(a.children===s.children&&!xa.current){e=al(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Jo(-1,r&-r),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Y_(a.return,r,e),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===e.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(lt(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Y_(i,r,e),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Js(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,lf(e,r),s=gi(s),n=n(s),e.flags|=1,Js(t,e,n,r),e.child;case 14:return n=e.type,s=ji(n,e.pendingProps),s=ji(n.type,s),HE(t,e,n,s,r);case 15:return Kj(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ji(n,s),cx(t,e),e.tag=1,ya(n)?(t=!0,Lx(e)):t=!1,lf(e,r),Vj(e,n,s),Q_(e,n,s,r),eS(null,e,n,!0,t,r);case 19:return qj(t,e,r);case 22:return Xj(t,e,r)}throw Error(lt(156,e.tag))};function g9(t,e){return $F(t,e)}function DU(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function li(t,e,r,n){return new DU(t,e,r,n)}function Fk(t){return t=t.prototype,!(!t||!t.isReactComponent)}function RU(t){if(typeof t=="function")return Fk(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Yb)return 11;if(t===Jb)return 14}return 2}function ql(t,e){var r=t.alternate;return r===null?(r=li(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function fx(t,e,r,n,s,a){var i=2;if(n=t,typeof t=="function")Fk(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Ld:return ou(r.children,s,a,e);case Xb:i=8,s|=8;break;case __:return t=li(12,r,e,s|2),t.elementType=__,t.lanes=a,t;case S_:return t=li(13,r,e,s),t.elementType=S_,t.lanes=a,t;case b_:return t=li(19,r,e,s),t.elementType=b_,t.lanes=a,t;case kF:return q1(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case SF:i=10;break e;case bF:i=9;break e;case Yb:i=11;break e;case Jb:i=14;break e;case Rl:i=16,n=null;break e}throw Error(lt(130,t==null?t:typeof t,""))}return e=li(i,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function ou(t,e,r,n){return t=li(7,t,n,e),t.lanes=r,t}function q1(t,e,r,n){return t=li(22,t,n,e),t.elementType=kF,t.lanes=r,t.stateNode={isHidden:!1},t}function c2(t,e,r){return t=li(6,t,null,e),t.lanes=r,t}function u2(t,e,r){return e=li(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function OU(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vw(0),this.expirationTimes=Vw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vw(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function jk(t,e,r,n,s,a,i,o,l){return t=new OU(t,e,r,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=li(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},gk(a),t}function MU(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Md,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function m9(t){if(!t)return nc;t=t._reactInternals;e:{if(Wu(t)!==t||t.tag!==1)throw Error(lt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ya(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(lt(171))}if(t.tag===1){var r=t.type;if(ya(r))return mj(t,r,e)}return e}function p9(t,e,r,n,s,a,i,o,l){return t=jk(r,n,!0,t,s,a,i,o,l),t.context=m9(null),r=t.current,n=ra(),s=Ql(r),a=Jo(n,s),a.callback=e??null,Yl(r,a,s),t.current.lanes=s,jg(t,s,n),va(t,n),t}function Z1(t,e,r,n){var s=e.current,a=ra(),i=Ql(s);return r=m9(r),e.context===null?e.context=r:e.pendingContext=r,e=Jo(a,i),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Yl(s,e,i),t!==null&&(Ii(t,s,i,a),ix(t,s,i)),i}function Jx(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function sN(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Pk(t,e){sN(t,e),(t=t.alternate)&&sN(t,e)}function LU(){return null}var x9=typeof reportError=="function"?reportError:function(t){console.error(t)};function Dk(t){this._internalRoot=t}ey.prototype.render=Dk.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(lt(409));Z1(t,e,null,null)};ey.prototype.unmount=Dk.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Su(function(){Z1(null,t,null,null)}),e[nl]=null}};function ey(t){this._internalRoot=t}ey.prototype.unstable_scheduleHydration=function(t){if(t){var e=XF();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Ml.length&&e!==0&&e<Ml[r].priority;r++);Ml.splice(r,0,t),r===0&&JF(t)}};function Rk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ty(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function aN(){}function IU(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=Jx(i);a.call(u)}}var i=p9(e,n,t,0,null,!1,!1,"",aN);return t._reactRootContainer=i,t[nl]=i.current,z0(t.nodeType===8?t.parentNode:t),Su(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=Jx(l);o.call(u)}}var l=jk(t,0,!1,null,null,!1,!1,"",aN);return t._reactRootContainer=l,t[nl]=l.current,z0(t.nodeType===8?t.parentNode:t),Su(function(){Z1(e,l,r,n)}),l}function ry(t,e,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=Jx(i);o.call(l)}}Z1(e,i,t,s)}else i=IU(r,e,t,s,n);return Jx(i)}HF=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=qh(e.pendingLanes);r!==0&&(Zb(e,r|1),va(e,jn()),!(vr&6)&&(Tf=jn()+500,pc()))}break;case 13:Su(function(){var n=sl(t,1);if(n!==null){var s=ra();Ii(n,t,1,s)}}),Pk(t,1)}};ek=function(t){if(t.tag===13){var e=sl(t,134217728);if(e!==null){var r=ra();Ii(e,t,134217728,r)}Pk(t,134217728)}};KF=function(t){if(t.tag===13){var e=Ql(t),r=sl(t,e);if(r!==null){var n=ra();Ii(r,t,e,n)}Pk(t,e)}};XF=function(){return Rr};YF=function(t,e){var r=Rr;try{return Rr=t,e()}finally{Rr=r}};D_=function(t,e,r){switch(e){case"input":if(T_(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=H1(n);if(!s)throw Error(lt(90));TF(n),T_(n,s)}}}break;case"textarea":NF(t,r);break;case"select":e=r.value,e!=null&&nf(t,!!r.multiple,e,!1)}};OF=Ek;MF=Su;var BU={usingClientEntryPoint:!1,Events:[Dg,$d,H1,DF,RF,Ek]},Bh={findFiberByHostInstance:Qc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},UU={bundleType:Bh.bundleType,version:Bh.version,rendererPackageName:Bh.rendererPackageName,rendererConfig:Bh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=BF(t),t===null?null:t.stateNode},findFiberByHostInstance:Bh.findFiberByHostInstance||LU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bp.isDisabled&&bp.supportsFiber)try{z1=bp.inject(UU),mo=bp}catch{}}Ia.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BU;Ia.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rk(e))throw Error(lt(200));return MU(t,e,null,r)};Ia.createRoot=function(t,e){if(!Rk(t))throw Error(lt(299));var r=!1,n="",s=x9;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=jk(t,1,!1,null,null,r,!1,n,s),t[nl]=e.current,z0(t.nodeType===8?t.parentNode:t),new Dk(e)};Ia.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(lt(188)):(t=Object.keys(t).join(","),Error(lt(268,t)));return t=BF(e),t=t===null?null:t.stateNode,t};Ia.flushSync=function(t){return Su(t)};Ia.hydrate=function(t,e,r){if(!ty(e))throw Error(lt(200));return ry(null,t,e,!0,r)};Ia.hydrateRoot=function(t,e,r){if(!Rk(t))throw Error(lt(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=x9;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=p9(e,null,t,1,r??null,s,!1,a,i),t[nl]=e.current,z0(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new ey(e)};Ia.render=function(t,e,r){if(!ty(e))throw Error(lt(200));return ry(null,t,e,!1,r)};Ia.unmountComponentAtNode=function(t){if(!ty(t))throw Error(lt(40));return t._reactRootContainer?(Su(function(){ry(null,null,t,!1,function(){t._reactRootContainer=null,t[nl]=null})}),!0):!1};Ia.unstable_batchedUpdates=Ek;Ia.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!ty(r))throw Error(lt(200));if(t==null||t._reactInternals===void 0)throw Error(lt(38));return ry(t,e,r,!1,n)};Ia.version="18.3.1-next-f1338f8080-20240426";function y9(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(y9)}catch(t){console.error(t)}}y9(),yF.exports=Ia;var fS=yF.exports,iN=fS;v_.createRoot=iN.createRoot,v_.hydrateRoot=iN.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Q0(){return Q0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Q0.apply(this,arguments)}var Ul;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ul||(Ul={}));const oN="popstate";function $U(t){t===void 0&&(t={});function e(n,s){let{pathname:a,search:i,hash:o}=n.location;return hS("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:w9(s)}return WU(e,r,null,t)}function Gn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function v9(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function zU(){return Math.random().toString(36).substr(2,8)}function lN(t,e){return{usr:t.state,key:t.key,idx:e}}function hS(t,e,r,n){return r===void 0&&(r=null),Q0({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Hf(e):e,{state:r,key:e&&e.key||n||zU()})}function w9(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Hf(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function WU(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Ul.Pop,l=null,u=d();u==null&&(u=0,i.replaceState(Q0({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function h(){o=Ul.Pop;let _=d(),S=_==null?null:_-u;u=_,l&&l({action:o,location:v.location,delta:S})}function m(_,S){o=Ul.Push;let w=hS(v.location,_,S);u=d()+1;let y=lN(w,u),b=v.createHref(w);try{i.pushState(y,"",b)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(b)}a&&l&&l({action:o,location:v.location,delta:1})}function x(_,S){o=Ul.Replace;let w=hS(v.location,_,S);u=d();let y=lN(w,u),b=v.createHref(w);i.replaceState(y,"",b),a&&l&&l({action:o,location:v.location,delta:0})}function p(_){let S=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof _=="string"?_:w9(_);return w=w.replace(/ $/,"%20"),Gn(S,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,S)}let v={get action(){return o},get location(){return t(s,i)},listen(_){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(oN,h),l=_,()=>{s.removeEventListener(oN,h),l=null}},createHref(_){return e(s,_)},createURL:p,encodeLocation(_){let S=p(_);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:x,go(_){return i.go(_)}};return v}var cN;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(cN||(cN={}));function VU(t,e,r){return r===void 0&&(r="/"),GU(t,e,r)}function GU(t,e,r,n){let s=typeof e=="string"?Hf(e):e,a=b9(s.pathname||"/",r);if(a==null)return null;let i=_9(t);HU(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=s$(a);o=t$(i[l],u)}return o}function _9(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(Gn(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=lu([n,l.relativePath]),d=r.concat(l);a.children&&a.children.length>0&&(Gn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),_9(a.children,e,d,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:ZU(u,a.index),routesMeta:d})};return t.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of S9(a.path))s(a,i,l)}),e}function S9(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=S9(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function HU(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:e$(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const KU=/^:[\w-]+$/,XU=3,YU=2,JU=1,QU=10,qU=-2,uN=t=>t==="*";function ZU(t,e){let r=t.split("/"),n=r.length;return r.some(uN)&&(n+=qU),e&&(n+=YU),r.filter(s=>!uN(s)).reduce((s,a)=>s+(KU.test(a)?XU:a===""?JU:QU),n)}function e$(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function t$(t,e,r){let{routesMeta:n}=t,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,d=a==="/"?e:e.slice(a.length)||"/",h=r$({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),m=l.route;if(!h)return null;Object.assign(s,h.params),i.push({params:s,pathname:lu([a,h.pathname]),pathnameBase:l$(lu([a,h.pathnameBase])),route:m}),h.pathnameBase!=="/"&&(a=lu([a,h.pathnameBase]))}return i}function r$(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=n$(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:m,isOptional:x}=d;if(m==="*"){let v=o[h]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const p=o[h];return x&&!p?u[m]=void 0:u[m]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:t}}function n$(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),v9(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function s$(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return v9(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function b9(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function a$(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?Hf(t):t;return{pathname:r?r.startsWith("/")?r:i$(r,e):e,search:c$(n),hash:u$(s)}}function i$(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function d2(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function o$(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function k9(t,e){let r=o$(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function C9(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=Hf(t):(s=Q0({},t),Gn(!s.pathname||!s.pathname.includes("?"),d2("?","pathname","search",s)),Gn(!s.pathname||!s.pathname.includes("#"),d2("#","pathname","hash",s)),Gn(!s.search||!s.search.includes("#"),d2("#","search","hash",s)));let a=t===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let h=e.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),h-=1;s.pathname=m.join("/")}o=h>=0?e[h]:"/"}let l=a$(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const lu=t=>t.join("/").replace(/\/\/+/g,"/"),l$=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),c$=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,u$=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function d$(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const T9=["post","put","patch","delete"];new Set(T9);const f$=["get",...T9];new Set(f$);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function q0(){return q0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},q0.apply(this,arguments)}const Ok=k.createContext(null),h$=k.createContext(null),Og=k.createContext(null),ny=k.createContext(null),xc=k.createContext({outlet:null,matches:[],isDataRoute:!1}),E9=k.createContext(null);function Mg(){return k.useContext(ny)!=null}function sy(){return Mg()||Gn(!1),k.useContext(ny).location}function N9(t){k.useContext(Og).static||k.useLayoutEffect(t)}function Ua(){let{isDataRoute:t}=k.useContext(xc);return t?T$():g$()}function g$(){Mg()||Gn(!1);let t=k.useContext(Ok),{basename:e,future:r,navigator:n}=k.useContext(Og),{matches:s}=k.useContext(xc),{pathname:a}=sy(),i=JSON.stringify(k9(s,r.v7_relativeSplatPath)),o=k.useRef(!1);return N9(()=>{o.current=!0}),k.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=C9(u,JSON.parse(i),a,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:lu([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,a,t])}function Mk(){let{matches:t}=k.useContext(xc),e=t[t.length-1];return e?e.params:{}}function m$(t,e){return p$(t,e)}function p$(t,e,r,n){Mg()||Gn(!1);let{navigator:s}=k.useContext(Og),{matches:a}=k.useContext(xc),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=sy(),d;if(e){var h;let _=typeof e=="string"?Hf(e):e;l==="/"||(h=_.pathname)!=null&&h.startsWith(l)||Gn(!1),d=_}else d=u;let m=d.pathname||"/",x=m;if(l!=="/"){let _=l.replace(/^\//,"").split("/");x="/"+m.replace(/^\//,"").split("/").slice(_.length).join("/")}let p=VU(t,{pathname:x}),v=_$(p&&p.map(_=>Object.assign({},_,{params:Object.assign({},o,_.params),pathname:lu([l,s.encodeLocation?s.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?l:lu([l,s.encodeLocation?s.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),a,r,n);return e&&v?k.createElement(ny.Provider,{value:{location:q0({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Ul.Pop}},v):v}function x$(){let t=C$(),e=d$(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),r?k.createElement("pre",{style:s},r):null,null)}const y$=k.createElement(x$,null);class v$ extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?k.createElement(xc.Provider,{value:this.props.routeContext},k.createElement(E9.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function w$(t){let{routeContext:e,match:r,children:n}=t,s=k.useContext(Ok);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),k.createElement(xc.Provider,{value:e},n)}function _$(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);d>=0||Gn(!1),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:m,errors:x}=r,p=h.route.loader&&m[h.route.id]===void 0&&(!x||x[h.route.id]===void 0);if(h.route.lazy||p){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,h,m)=>{let x,p=!1,v=null,_=null;r&&(x=o&&h.route.id?o[h.route.id]:void 0,v=h.route.errorElement||y$,l&&(u<0&&m===0?(E$("route-fallback"),p=!0,_=null):u===m&&(p=!0,_=h.route.hydrateFallbackElement||null)));let S=e.concat(i.slice(0,m+1)),w=()=>{let y;return x?y=v:p?y=_:h.route.Component?y=k.createElement(h.route.Component,null):h.route.element?y=h.route.element:y=d,k.createElement(w$,{match:h,routeContext:{outlet:d,matches:S,isDataRoute:r!=null},children:y})};return r&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?k.createElement(v$,{location:r.location,revalidation:r.revalidation,component:v,error:x,children:w(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):w()},null)}var A9=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(A9||{}),F9=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(F9||{});function S$(t){let e=k.useContext(Ok);return e||Gn(!1),e}function b$(t){let e=k.useContext(h$);return e||Gn(!1),e}function k$(t){let e=k.useContext(xc);return e||Gn(!1),e}function j9(t){let e=k$(),r=e.matches[e.matches.length-1];return r.route.id||Gn(!1),r.route.id}function C$(){var t;let e=k.useContext(E9),r=b$(),n=j9();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function T$(){let{router:t}=S$(A9.UseNavigateStable),e=j9(F9.UseNavigateStable),r=k.useRef(!1);return N9(()=>{r.current=!0}),k.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,q0({fromRouteId:e},a)))},[t,e])}const dN={};function E$(t,e,r){dN[t]||(dN[t]=!0)}function N$(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Ef(t){let{to:e,replace:r,state:n,relative:s}=t;Mg()||Gn(!1);let{future:a,static:i}=k.useContext(Og),{matches:o}=k.useContext(xc),{pathname:l}=sy(),u=Ua(),d=C9(e,k9(o,a.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(d);return k.useEffect(()=>u(JSON.parse(h),{replace:r,state:n,relative:s}),[u,h,s,r,n]),null}function Fn(t){Gn(!1)}function A$(t){let{basename:e="/",children:r=null,location:n,navigationType:s=Ul.Pop,navigator:a,static:i=!1,future:o}=t;Mg()&&Gn(!1);let l=e.replace(/^\/*/,"/"),u=k.useMemo(()=>({basename:l,navigator:a,static:i,future:q0({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=Hf(n));let{pathname:d="/",search:h="",hash:m="",state:x=null,key:p="default"}=n,v=k.useMemo(()=>{let _=b9(d,l);return _==null?null:{location:{pathname:_,search:h,hash:m,state:x,key:p},navigationType:s}},[l,d,h,m,x,p,s]);return v==null?null:k.createElement(Og.Provider,{value:u},k.createElement(ny.Provider,{children:r,value:v}))}function Lk(t){let{children:e,location:r}=t;return m$(gS(e),r)}new Promise(()=>{});function gS(t,e){e===void 0&&(e=[]);let r=[];return k.Children.forEach(t,(n,s)=>{if(!k.isValidElement(n))return;let a=[...e,s];if(n.type===k.Fragment){r.push.apply(r,gS(n.props.children,a));return}n.type!==Fn&&Gn(!1),!n.props.index||!n.props.children||Gn(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=gS(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const F$="6";try{window.__reactRouterVersion=F$}catch{}const j$="startTransition",fN=jI[j$];function P$(t){let{basename:e,children:r,future:n,window:s}=t,a=k.useRef();a.current==null&&(a.current=$U({window:s,v5Compat:!0}));let i=a.current,[o,l]=k.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=k.useCallback(h=>{u&&fN?fN(()=>l(h)):l(h)},[l,u]);return k.useLayoutEffect(()=>i.listen(d),[i,d]),k.useEffect(()=>N$(n),[n]),k.createElement(A$,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var hN;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(hN||(hN={}));var gN;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(gN||(gN={}));const on={student_subjects:30*60*1e3,student_active_tests:10*60*1e3,student_results_table:10*60*1e3,teacher_subjects:15*60*1e3,teacher_classes:15*60*1e3,teacher_tests:10*60*1e3,teacher_results_table:10*60*1e3,admin_users:20*60*1e3,admin_teachers:20*60*1e3,admin_subjects:30*60*1e3,admin_academic_years:60*60*1e3,admin_tests:15*60*1e3,admin_results_table:null,admin_teacher_id:60*60*1e3,all_tests:20*60*1e3,subjects_dropdown:30*60*1e3,grades_classes:60*60*1e3,test_progress:2*60*1e3,anti_cheating:2*60*1e3,word_matching_test:10*60*1e3},wn=t=>{try{const e=localStorage.getItem(t);if(!e)return console.log(" Cache: No data found for key:",t),null;const{data:r,timestamp:n,ttl:s}=JSON.parse(e),a=Date.now()-n;return a>s?(console.log(" Cache: Data expired for key:",t,"age:",a,"ttl:",s),localStorage.removeItem(t),null):(console.log(" Cache: Data found for key:",t,"age:",a,"ttl:",s),r)}catch(e){return console.log(" Cache: Corrupted data for key:",t,e),localStorage.removeItem(t),null}},Zr=(t,e,r)=>{try{console.log(" Cache: Setting data for key:",t,"ttl:",r),localStorage.setItem(t,JSON.stringify({data:e,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached successfully for key:",t)}catch{console.log(" Cache: Storage full, cleaning old data for key:",t),P9();try{localStorage.setItem(t,JSON.stringify({data:e,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached after cleanup for key:",t)}catch{console.warn("Storage full, cannot cache data")}}},P9=()=>{const t=Date.now(),e=Object.keys(localStorage);e.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:o}=JSON.parse(a);t-i>o&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=t-7*24*60*60*1e3;e.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const o=localStorage.getItem(i);if(o){const{timestamp:l}=JSON.parse(o);return{key:i,timestamp:l}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,o)=>i.timestamp-o.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},Ik=t=>{Object.keys(localStorage).forEach(r=>{r.includes(t)&&localStorage.removeItem(r)})},Lg=(t,e,r)=>{const n=`test_progress_${t}_${e}_${r}`,s=`anti_cheating_${t}_${e}_${r}`;localStorage.removeItem(n),localStorage.removeItem(s),console.log(`Cleared test data for ${e}_${r}`)},D9=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:on,cleanupOldData:P9,clearTestData:Lg,clearUserData:Ik,getCachedData:wn,setCachedData:Zr},Symbol.toStringTag,{value:"Module"})),R9=k.createContext(),O9=({children:t})=>{const[e,r]=k.useState(null),[n,s]=k.useState(null),[a,i]=k.useState(localStorage.getItem("token")),[o,l]=k.useState(!1),[u,d]=k.useState(!0),[h,m]=k.useState(null);k.useEffect(()=>{console.log("[AUTH] Initializing application session..."),_()},[]),k.useEffect(()=>{if(o&&a){console.log("[AUTH] Setting up proactive token refresh...");let ne=!1;const z=setInterval(async()=>{if(o&&a&&!ne){ne=!0;try{const Y=a||localStorage.getItem("auth_token");if(Y&&x(Y))console.log("[AUTH] Token expired, attempting refresh..."),await p()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(Y)try{const te=JSON.parse(atob(Y.split(".")[1])).exp*1e3,de=Date.now(),ee=te-de;ee<5*60*1e3&&ee>0&&(console.log(`[AUTH] Token expires in ${Math.round(ee/1e3)} seconds, refreshing...`),await p()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(J){console.error("[AUTH] Error parsing token for expiration check:",J)}}catch(Y){console.error("[AUTH] Error in proactive refresh:",Y)}finally{ne=!1}}},5*60*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(z)}}},[o,a]);const x=ne=>{if(!ne)return!0;try{const z=JSON.parse(atob(ne.split(".")[1])),Y=Date.now()/1e3;return z.exp<=Y}catch(z){return console.error("[AUTH] Error decoding token:",z),!0}},p=async()=>{const ne=localStorage.getItem("refresh_token");if(!ne)return console.log("[AUTH] No refresh token found"),!1;try{const z=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:ne})});if(z.ok){const Y=await z.json();console.log("[AUTH] Token refresh successful"),localStorage.setItem("auth_token",Y.accessToken),localStorage.setItem("refresh_token",Y.refreshToken),localStorage.setItem("accessToken",Y.accessToken);try{window.tokenManager&&(window.tokenManager.setToken(Y.accessToken),Y.refreshToken&&window.tokenManager.setRefreshToken(Y.refreshToken))}catch{}return i(Y.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",z.status),!1}catch(z){return console.error("[AUTH] Token refresh error:",z),!1}},v=async(ne,z={})=>{const Y=a||localStorage.getItem("auth_token");if(!Y)throw new Error("No authentication token found");const J={"Content-Type":"application/json",Authorization:`Bearer ${Y}`,...z.headers},te=await fetch(ne,{...z,headers:J});if(te.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await p()){const ee=localStorage.getItem("auth_token");return J.Authorization=`Bearer ${ee}`,fetch(ne,{...z,headers:J})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return te},_=async()=>{try{console.log("[AUTH] Starting session initialization..."),d(!0);const ne=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),z=localStorage.getItem("user_data")||localStorage.getItem("userData"),Y=z?JSON.parse(z).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!ne,hasUser:!!z,role:Y}),ne&&Y&&z)try{const J=JSON.parse(z);if(x(ne))if(console.log("[AUTH] Token expired, attempting refresh..."),await p()){console.log("[AUTH] Token refreshed successfully");const de=localStorage.getItem("auth_token");i(de)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(ne);else i(ne);s(Y),r(J);try{if(window.tokenManager){window.tokenManager.setToken(localStorage.getItem("auth_token"));const te=localStorage.getItem("refresh_token");te&&window.tokenManager.setRefreshToken(te)}}catch{}l(!0),await y(J,Y)}catch(J){console.error("[AUTH] Error parsing stored user data:",J),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),l(!1)}}catch(ne){console.error("[AUTH] Session initialization error:",ne),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),l(!1)}finally{console.log("[AUTH] Session initialization complete"),d(!1)}},S=async ne=>{try{if(d(!0),m(null),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),m("Please wait for the logout process to complete.");return}console.log("Attempting login with:",ne.username);let z,Y;ne.username==="admin"?(z={ok:!0,json:()=>({success:!0,token:"test-token"})},Y="admin"):(z=await authService.teacherLogin(ne),Y="teacher");const J=await z.json();await w(z,Y,J)}catch(z){T(z)}finally{d(!1)}},w=async(ne,z,Y)=>{try{if(ne.ok&&Y.success&&Y.token)return i(Y.token),s(z),r(Y),l(!0),localStorage.setItem("auth_token",Y.accessToken||Y.token),localStorage.setItem("refresh_token",Y.refreshToken),localStorage.setItem("user_data",JSON.stringify(Y)),localStorage.setItem("accessToken",Y.accessToken||Y.token),await y(Y,z),!0;{const J=Y.message||ne.statusText||"Login failed";return T(new Error(J)),!1}}catch(J){return T(J),!1}},y=async(ne,z)=>{try{switch(z){case"admin":console.log("Admin login successful, role:",ne.role),console.log("Admin logged in:",ne);break;case"teacher":console.log("Teacher login successful, role:",ne.role),console.log("Teacher data:",ne.teacher),await E(ne),await F();break;case"student":console.log("Student login successful"),b(ne);break;default:console.warn("Unknown user role:",z)}}catch(Y){console.error("Post-login actions error:",Y)}},b=ne=>{r(ne),console.log("Student info populated:",ne)},E=async ne=>{r(ne),console.log("Teacher info populated:",ne)},N=async()=>{try{console.log("Initializing teacher cabinet...")}catch(ne){console.error("Error initializing teacher cabinet:",ne)}},F=async()=>{try{console.log("Checking teacher subjects...")}catch(ne){console.error("Error checking teacher subjects:",ne)}},T=ne=>{m(ne.message||"Login failed"),P()},P=()=>{m(null),d(!1)},D=k.useCallback(()=>{R()},[]),R=()=>{r(null),s(null),i(null),l(!1),m(null);const ne=(e==null?void 0:e.student_id)||(e==null?void 0:e.teacher_id)||(e==null?void 0:e.admin_id)||(e==null?void 0:e.id);ne&&Ik(ne),localStorage.removeItem("token"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&window.tokenManager.clearAuth(),setTimeout(()=>{I()},100)},I=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},W=()=>(e==null?void 0:e.id)||null,le=()=>n==="admin"?e:null,q=()=>n==="admin",V=()=>q()?e==null?void 0:e.admin_id:null,K=()=>n==="teacher"?e==null?void 0:e.username:null,U=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof S,logout:typeof D,getCurrentTeacherId:typeof W,isAdmin:typeof q,getCurrentAdmin:typeof le,getCurrentAdminId:typeof V,getCurrentTeacherUsername:typeof K})};k.useEffect(()=>(window.logout=D,window.getCurrentTeacherId=W,window.getCurrentAdmin=le,window.isAdmin=q,window.getCurrentAdminId=V,window.getCurrentTeacherUsername=K,window.checkFunctionAvailability=U,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[D]);const L=k.useCallback(ne=>{console.log("Setting user data from external auth:",ne),r(ne),s(ne.role),i(ne.token),l(!0),d(!1),m(null),localStorage.setItem("auth_token",ne.token),localStorage.setItem("user_data",JSON.stringify(ne)),localStorage.setItem("accessToken",ne.token)},[]),Z={user:e,role:n,token:a,isAuthenticated:o,isLoading:u,error:h,login:S,setUserData:L,logout:D,resetLoginForm:P,forceCompleteLogout:R,initializeApplicationSession:_,makeAuthenticatedRequest:v,populateStudentInfo:b,populateTeacherInfo:E,initializeTeacherCabinet:N,checkTeacherSubjects:F,getCurrentTeacherId:W,getCurrentAdmin:le,isAdmin:q,getCurrentAdminId:V,getCurrentTeacherUsername:K,handleLoginResponse:w,handlePostLoginActions:y,handleLoginFailure:T,resetInterfaceAfterSessionClear:I,checkFunctionAvailability:U};return c.jsx(R9.Provider,{value:Z,children:t})},Dn=()=>{const t=k.useContext(R9);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};class D${constructor(){this.baseURL="http://localhost:8888/.netlify/functions",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}getHeaders(){const e=localStorage.getItem("token");return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}}async sendRequest(e,r){try{return await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error(" Network error:",n),n}}async request(e,r={}){const n=`${this.baseURL}${e}`,s={method:"GET",headers:this.getHeaders(),timeout:this.timeout,...r};let a;for(let i=0;i<this.retryCount;i++)try{const o=new AbortController,l=setTimeout(()=>o.abort(),this.timeout),u=await fetch(n,{...s,signal:o.signal});if(clearTimeout(l),!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}catch(o){if(a=o,o.name==="AbortError")throw new Error("Request timeout");i<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${i+1}/${this.retryCount})`),await new Promise(l=>setTimeout(l,this.retryDelay*Math.pow(2,i))))}throw a}async get(e,r={}){return this.request(e,{...r,method:"GET"})}async post(e,r,n={}){return this.request(e,{...n,method:"POST",body:JSON.stringify(r)})}async put(e,r,n={}){return this.request(e,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(e,r={}){return this.request(e,{...r,method:"DELETE"})}async patch(e,r,n={}){return this.request(e,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(e,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${e}`,i={method:"POST",headers:{...localStorage.getItem("token")&&{Authorization:`Bearer ${localStorage.getItem("token")}`}},body:s,...n};try{const o=await fetch(a,i);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw o}}async downloadFile(e,r,n={}){const s=`${this.baseURL}${e}`,a={method:"GET",headers:this.getHeaders(),...n};try{const i=await fetch(s,a);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.blob(),l=window.URL.createObjectURL(o),u=document.createElement("a");u.href=l,u.download=r,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(l)}catch(i){throw i}}ensureDebugOutput(){let e=document.getElementById("debug-output");return e||(e=document.createElement("div"),e.id="debug-output",e.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",e.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(e)),e}async testDbConnection(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,message:"Database connection failed",error:e.message}}}async testStudentLogin(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testTeacherLogin(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testAdminLogin(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetSubjects(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetTeacherSubjects(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetClassResults(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetStudentSubjects(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetStudentTestResults(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testEndpoints(){const e=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of e)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(e){const r=this.ensureDebugOutput();try{let n;switch(e){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${e}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${e}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${e}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const e=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;e.innerHTML=r}}const pn=new D$,Er={async getTestInfo(t,e){console.log(`[DEBUG] getTestInfo called with testType: ${t}, testId: ${e}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${t}&test_id=${e}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(t,e){console.log(`[DEBUG] getTestQuestions called with testType: ${t}, testId: ${e}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${t}&test_id=${e}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const t="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",t);const e=await window.tokenManager.makeAuthenticatedRequest(t);if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const r=await e.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(t){throw console.error("[ERROR] Failed to get active tests:",t),t}},async getTeacherTests(){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const t="/.netlify/functions/get-teacher-active-tests";console.log("[DEBUG] Fetching teacher tests from:",t);const e=await window.tokenManager.makeAuthenticatedRequest(t);if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const r=await e.json();if(console.log("[DEBUG] Teacher tests data received:",r),r.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get teacher tests")}catch(t){throw console.error("[ERROR] Failed to get teacher tests:",t),t}},async submitTest(t,e,r,n={},s=null){var a,i,o;console.log("Submitting test:",{testType:t,testId:e});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let l;try{const E=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${t}&test_id=${e}`)).json();if(E.success)l=E.test_info;else throw new Error("Failed to get test information")}catch(b){console.error("Error getting test info:",b);const E=await this.getTestQuestions(t,e);l={test_name:`Test ${e}`,num_questions:E.length}}const u=await this.getTestQuestions(t,e);let d,h;t==="drawing"?(d=null,h=null):(d=this.calculateTestScore(u,r,t),h=l.num_questions);const m=this.transformAnswersForSubmission(r,t),x=l.teacher_id||null,p=l.subject_id||null,v=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||((a=window.tokenManager)!=null&&a.getCurrentUser?((i=window.tokenManager.getCurrentUser())==null?void 0:i.student_id)||((o=window.tokenManager.getCurrentUser())==null?void 0:o.id):null),_={test_id:e,test_name:l.test_name,test_type:t,teacher_id:x,subject_id:p,student_id:v,answers:m,score:d,maxScore:h,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0};let S;switch(t){case"multiple_choice":S="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":S="/.netlify/functions/submit-true-false-test";break;case"input":S="/.netlify/functions/submit-input-test";break;case"matching_type":S="/.netlify/functions/submit-matching-type-test";break;case"word_matching":S="/.netlify/functions/submit-word-matching-test";break;case"drawing":S="/.netlify/functions/submit-drawing-test";break;default:throw new Error(`Unsupported test type: ${t}`)}console.log("Submitting to:",S),console.log("Submission data:",_),console.log("Submission data JSON:",JSON.stringify(_,null,2));const w=await window.tokenManager.makeAuthenticatedRequest(S,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});if(!w.ok)throw new Error(`HTTP error! status: ${w.status}`);const y=await w.json();if(console.log("Test submission result:",y),y.success)return this.clearTestProgress(t,e),{success:!0,score:d,maxScore:h,result:y};throw new Error(y.error||"Failed to submit test")}catch(l){throw console.error("Error submitting test:",l),l}},async createTest(t){try{return(await pn.post("/tests/create",t)).data}catch(e){throw new Error(e.message||"Failed to create test")}},async updateTest(t,e,r){try{return(await pn.put(`/tests/${t}/${e}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(t,e){try{return(await pn.delete(`/tests/${t}/${e}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(t,e){try{return(await pn.post(`/tests/${t}/${e}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(t,e){try{return(await pn.post(`/tests/${t}/${e}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(t,e){try{return(await pn.post(`/tests/${t}/${e}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(t,e,r){try{return(await pn.delete(`/tests/${t}/${e}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(t,e){try{return(await pn.get(`/tests/${t}/${e}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(t,e,r="json"){try{return(await pn.get(`/tests/${t}/${e}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(t,e){try{return(await pn.uploadFile(`/tests/import?type=${e}`,t)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(t,e){try{return(await pn.get(`/tests/${t}/${e}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const t=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();if(console.log("[DEBUG] Student test results data received:",e),e.success)return console.log("[DEBUG] Student test results retrieved successfully"),e;throw new Error(e.error||"Failed to get student test results")}catch(t){throw console.error("[ERROR] Failed to get student test results:",t),new Error(t.message||"Failed to get student test results")}},async getClassResults(t,e,r){try{return(await pn.get(`/tests/class-results/${t}/${e}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(t,e,r){try{return(await pn.post(`/tests/${t}/${e}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(t,e){try{return(await pn.get(`/tests/${t}/${e}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(t,e){try{return(await pn.delete(`/tests/${t}/${e}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(t){try{return(await pn.post("/tests/validate",t)).data}catch(e){throw new Error(e.message||"Failed to validate test data")}},async getTestPreview(t,e){try{return(await pn.get(`/tests/${t}/${e}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},calculateTestScore(t,e,r){let n=0;if(Array.isArray(e))for(let s=0;s<t.length&&s<e.length;s++){const a=t[s],i=e[s];i&&this.isAnswerCorrect(s,i,a,r)&&n++}else return console.warn("Unexpected answer format in calculateTestScore:",typeof e),0;return n},isAnswerCorrect(t,e,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(e))===r.correct_answer;case"true_false":return e.toLowerCase()==="true"===r.correct_answer;case"input":return(r.correct_answers||[]).some(o=>e.toLowerCase().trim()===o.toLowerCase().trim());case"matching_type":return JSON.stringify(e)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(e)===JSON.stringify(r.correct_answer);case"drawing":return e&&e!=="No answer";default:return!1}},transformAnswersForSubmission(t,e){switch(e){case"multiple_choice":return t;case"true_false":return t;case"input":return t;case"matching_type":return t;case"word_matching":return t;case"drawing":return t;default:return t}},async markTestCompleted(t,e){try{console.log(`[DEBUG] markTestCompleted called with testType: ${t}, testId: ${e}`);const r=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:t,test_id:e})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[DEBUG] Mark test completed response:",n),n.success)return console.log(`Test ${t}_${e} marked as completed successfully`),{success:!0,message:n.message};throw new Error(n.error||"Failed to mark test as completed")}catch(r){throw console.error("Error marking test completed:",r),r}},clearTestProgress(t,e){try{const r=`test_progress_${t}_${e}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${t}_${e}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(t){console.log("[DEBUG] saveMultipleChoiceTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving multiple choice test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveTrueFalseTest(t){console.log("[DEBUG] saveTrueFalseTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving true/false test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveInputTest(t){console.log("[DEBUG] saveInputTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving input test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveMatchingTest(t){console.log("[DEBUG] saveMatchingTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,test_type:"matching_type",num_questions:t.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving matching test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveWordMatchingTest(t){console.log("[DEBUG] saveWordMatchingTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving word matching test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveDrawingTest(t){console.log("[DEBUG] saveDrawingTest called with:",t);try{const e={...t,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(e){return console.error("Error saving drawing test:",e),{success:!1,message:"Error saving test: "+e.message}}},async getDrawingTest(t){console.log("[DEBUG] getDrawingTest called with testId:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${t}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(e){return console.error("Error getting drawing test:",e),{success:!1,message:"Error getting test: "+e.message}}},async submitDrawingTest(t,e,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:t,answers:e,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:t,answers:e,time_taken:r,caught_cheating:(n==null?void 0:n.caught_cheating)||!1,visibility_change_times:(n==null?void 0:n.visibility_change_times)||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(t,e,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:t,score:e,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:t,score:e,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(t){console.log("[DEBUG] getWordMatchingTest called with testId:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${t}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(e){return console.error("Error getting word matching test:",e),{success:!1,message:"Error getting test: "+e.message}}},async submitWordMatchingTest(t,e,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:t,answers:e,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:t,answers:e,time_taken:r,caught_cheating:(n==null?void 0:n.caught_cheating)||!1,visibility_change_times:(n==null?void 0:n.visibility_change_times)||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(t){console.log("[DEBUG] assignTestToClasses called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(e){return console.error("Error assigning test to classes:",e),{success:!1,message:"Error assigning test: "+e.message}}},async removeClassAssignment(t){console.log("[DEBUG] removeClassAssignment called with assignmentId:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${t}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(e){return console.error("Error removing class assignment:",e),{success:!1,message:"Error removing assignment: "+e.message}}}},M9=(t,e)=>{const[r,n]=k.useState(()=>{try{const i=window.localStorage.getItem(t);return i?JSON.parse(i):e}catch(i){return console.error(`Error reading localStorage key "${t}":`,i),e}}),s=k.useCallback(i=>{try{const o=i instanceof Function?i(r):i;n(o),window.localStorage.setItem(t,JSON.stringify(o))}catch(o){console.error(`Error setting localStorage key "${t}":`,o)}},[t,r]),a=k.useCallback(()=>{try{window.localStorage.removeItem(t),n(e)}catch(i){console.error(`Error removing localStorage key "${t}":`,i)}},[t,e]);return[r,s,a]},Bk=()=>{const t=k.useCallback((l,u=null)=>{try{const d=window.localStorage.getItem(l);return d?JSON.parse(d):u}catch(d){return console.error(`Error reading localStorage key "${l}":`,d),u}},[]),e=k.useCallback((l,u)=>{try{window.localStorage.setItem(l,JSON.stringify(u))}catch(d){console.error(`Error setting localStorage key "${l}":`,d)}},[]),r=k.useCallback(l=>{try{window.localStorage.removeItem(l)}catch(u){console.error(`Error removing localStorage key "${l}":`,u)}},[]),n=k.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(l){console.error("Error clearing localStorage:",l)}},[]),s=k.useCallback(()=>{try{const l={};for(let m=0;m<window.localStorage.length;m++){const x=window.localStorage.key(m);x&&(l[x]=window.localStorage.getItem(x))}const u=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download="localStorage_backup.json",h.click(),URL.revokeObjectURL(d),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(l){console.error("Error exporting localStorage data:",l)}},[]),a=k.useCallback(()=>{try{window.localStorage.clear()}catch(l){console.error("Error clearing localStorage:",l)}},[]),i=k.useCallback(()=>{try{const l={};for(let u=0;u<window.localStorage.length;u++){const d=window.localStorage.key(u);d&&(l[d]=window.localStorage.getItem(d))}return l}catch(l){return console.error("Error exporting localStorage data:",l),{}}},[]),o=k.useCallback(l=>{try{Object.entries(l).forEach(([u,d])=>{window.localStorage.setItem(u,d)})}catch(u){console.error("Error importing localStorage data:",u)}},[]);return{getItem:t,setItem:e,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:o}},L9=k.createContext(),I9=({children:t})=>{const[e,r]=k.useState(null),[n,s]=k.useState([]),[a,i]=k.useState({}),[o,l]=k.useState({}),[u,d]=k.useState(!1),[h,m]=k.useState(null),[x,p]=k.useState([]),[v,_]=k.useState(!1),[S,w]=k.useState(null),[y,b]=k.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[E,N]=k.useState(null),[F,T]=k.useState(0),{getItem:P,setItem:D,removeItem:R}=M9();k.useEffect(()=>{let me;return u&&E&&(me=setInterval(()=>{const be=Math.floor((Date.now()-E)/1e3);T(be)},1e3)),()=>{me&&clearInterval(me)}},[u,E]);const I=async(me,be)=>{try{_(!0),w(null),console.log(`[DEBUG] loadTestForPage called with testType: ${me}, testId: ${be}`);const _e=await Er.getTestInfo(me,be);console.log("[DEBUG] Test info retrieved:",_e);const Fe=await Er.getTestQuestions(me,be);console.log("[DEBUG] Test questions retrieved:",Fe),r({..._e,testType:me,testId:be}),s(Fe),d(!0),N(Date.now()),T(0),W(me,be),console.log("[DEBUG] Test loaded successfully")}catch(_e){w(_e.message||"Failed to load test"),console.error("Error loading test:",_e)}finally{_(!1)}},W=(me,be)=>{try{const _e=`test_progress_${me}_${be}`,Fe=P(_e);Fe&&(i(Fe.answers||{}),l(Fe.progress||{}))}catch(_e){console.error("Error loading saved progress:",_e)}},le=(me,be,_e,Fe)=>{var nt,Rt;try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const Qe=`test_progress_${((Rt=(nt=window.tokenManager)==null?void 0:nt.getDecodedToken())==null?void 0:Rt.sub)||"unknown"}_${me}_${be}`,qe={...a,[_e]:Fe},yt={...o,[_e]:{answered:!0,timestamp:Date.now()}};i(qe),l(yt),D(Qe,{answers:qe,progress:yt,lastSaved:Date.now()}),console.log(`Saved progress for question ${_e}:`,Fe)}catch(ke){console.error("Error saving test progress:",ke)}},q=(me,be,_e)=>{var Fe,nt,Rt;try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const Qe=`test_progress_${((nt=(Fe=window.tokenManager)==null?void 0:Fe.getDecodedToken())==null?void 0:nt.sub)||"unknown"}_${me}_${be}`,qe=P(Qe);return((Rt=qe==null?void 0:qe.answers)==null?void 0:Rt[_e])||null}catch(ke){return console.error("Error getting test progress:",ke),null}},V=(me,be)=>{var _e,Fe;try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${me}, testId: ${be}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const nt=((Fe=(_e=window.tokenManager)==null?void 0:_e.getDecodedToken())==null?void 0:Fe.sub)||"unknown",Rt=`test_progress_${nt}_${me}_${be}`;console.log(`[DEBUG] Removing localStorage key: ${Rt}`);const ke=P(Rt)!==null;R(Rt),i({}),l({});for(let Qe=0;Qe<localStorage.length;Qe++){const qe=localStorage.key(Qe);qe&&qe.startsWith(`test_progress_${nt}_${me}_${be}_`)&&(localStorage.removeItem(qe),console.log(`[DEBUG] Cleared individual question key: ${qe}`))}console.log(ke?`[DEBUG] Progress cleared for test ${me}_${be}`:`[DEBUG] No progress found to clear for test ${me}_${be}`)}catch(nt){console.error("Error clearing test progress:",nt)}},K=async(me,be,_e="")=>{try{_(!0),w(null),console.log("Submitting test:",{testType:me,testId:be});const Fe=de(me,be);if(Object.keys(Fe).length===0){w("Please answer at least one question before submitting.");return}let nt;try{nt=await Er.getTestInfo(me,be)}catch(zt){console.error("Error getting test info:",zt);const G=await Er.getTestQuestions(me,be);nt={test_name:`Test ${be}`,num_questions:G.length}}const Rt=await Er.getTestQuestions(me,be),ke=ee(Rt,Fe,me),Qe=nt.num_questions,qe=re(Fe,me),yt={test_id:be,test_name:nt.test_name,score:ke,maxScore:Qe,answers:qe},Vt=await Er.submitTest(me,be,yt);if(Vt.success){if(m(Vt.result),ne(me,be,_e),V(me,be),_e){const zt=`student_results_table_${_e}`;console.log(" TestContext: Caching test results after submission with key:",zt),Zr(zt,Vt.result,on.student_results_table)}return _e&&Lg(_e,me,be),d(!1),Vt.results}else throw new Error(Vt.message||"Test submission failed")}catch(Fe){throw w(Fe.message||"Failed to submit test"),Fe}finally{_(!1)}},U=(me,be,_e)=>{m({testType:me,testId:be,answers:_e}),d(!1)},L=()=>{r(null),s([]),i({}),l({}),d(!1),m(null),w(null),N(null),T(0)},Z=(me,be,_e="")=>{try{const Fe=`test_completed_${_e}_${me}_${be}`;return P(Fe)===!0}catch(Fe){return console.error("Error checking test completion:",Fe),!1}},ne=(me,be,_e="")=>{try{const Fe=`test_completed_${_e}_${me}_${be}`;D(Fe,!0)}catch(Fe){console.error("Error marking test completed:",Fe)}},z=me=>Object.keys(a).length,Y=()=>{const me=z(e==null?void 0:e.testType),be=n.length;return{canSubmit:me===be,answeredCount:me,totalQuestions:be}},J=()=>{e&&V(e.testType,e.testId),L()},te=(me="")=>{try{const be=`student_results_table_${me}`;console.log(" TestContext: Clearing test results cache:",be),localStorage.removeItem(be),console.log(" TestContext: Test results cache cleared")}catch(be){console.error("Error clearing test results cache:",be)}},de=(me,be)=>({...a}),ee=(me,be,_e)=>{try{let Fe=0;return!me||!Array.isArray(me)?(console.warn("Invalid questions array for score calculation"),0):(me.forEach(nt=>{const Rt=nt.question_id||nt.id,ke=be[Rt];ke&&fe(nt,ke,_e)&&Fe++}),Fe)}catch(Fe){return console.error("Error calculating test score:",Fe),0}},ge=(me,be,_e)=>be===_e,fe=(me,be,_e)=>{try{if(!me||!be)return!1;const Fe=me.correct_answer;if(!Fe)return!1;switch(_e){case"true_false":return String(be).toLowerCase()===String(Fe).toLowerCase();case"multiple_choice":return String(be).toUpperCase()===String(Fe).toUpperCase();case"input":return String(be).trim().toLowerCase()===String(Fe).trim().toLowerCase();case"matching_type":return JSON.stringify(be)===JSON.stringify(Fe);case"word_matching":return JSON.stringify(be)===JSON.stringify(Fe);case"drawing":return be&&be!=="No answer";default:return be===Fe}}catch(Fe){return console.error("Error checking answer correctness:",Fe),!1}},ye=(me,be)=>{try{if(!me)return"No answer";switch(be){case"true_false":return me?"True":"False";case"multiple_choice":return String(me).toUpperCase();case"input":return String(me);case"matching_type":return typeof me=="object"?Object.entries(me).map(([_e,Fe])=>`${_e}  ${Fe}`).join(", "):String(me);case"word_matching":return typeof me=="object"?Object.entries(me).map(([_e,Fe])=>`${_e}  ${Fe}`).join(", "):String(me);case"drawing":return"Drawing submitted";default:return String(me)}}catch(_e){return console.error("Error formatting student answer:",_e),"Error displaying answer"}},Ce=(me,be)=>{try{if(!me)return"Not available";const _e=me.correct_answer;if(!_e)return"Not specified";switch(be){case"true_false":return _e?"True":"False";case"multiple_choice":return String(_e).toUpperCase();case"input":return String(_e);case"matching_type":return typeof _e=="object"?Object.entries(_e).map(([Fe,nt])=>`${Fe}  ${nt}`).join(", "):String(_e);case"word_matching":return typeof _e=="object"?Object.entries(_e).map(([Fe,nt])=>`${Fe}  ${nt}`).join(", "):String(_e);case"drawing":return"Drawing submitted";default:return String(_e)}}catch(_e){return console.error("Error getting correct answer:",_e),"Error displaying correct answer"}},re=(me,be)=>{try{if(!me||typeof me!="object")return{};const _e={};return Object.entries(me).forEach(([Fe,nt])=>{if(nt!=null)switch(be){case"true_false":_e[Fe]=!!nt;break;case"multiple_choice":_e[Fe]=String(nt).toUpperCase();break;case"input":_e[Fe]=String(nt).trim();break;case"matching_type":typeof nt=="object"?_e[Fe]=nt:_e[Fe]=String(nt);break;case"word_matching":typeof nt=="object"?_e[Fe]=nt:_e[Fe]=String(nt);break;case"drawing":_e[Fe]=nt;break;default:_e[Fe]=nt}}),_e}catch(_e){return console.error("Error transforming answers for submission:",_e),me||{}}},ve=k.useCallback(async(me="")=>{try{_(!0);const be=`student_active_tests_${me}`,_e=wn(be);if(_e)return p(_e),_e;const Fe=await Er.getActiveTests();return p(Fe),Zr(be,Fe,on.student_active_tests),Fe}catch(be){return w(be.message||"Failed to load active tests"),p([]),[]}finally{_(!1)}},[]),we=async()=>{try{return _(!0),await Er.getTeacherTests()}catch(me){return w(me.message||"Failed to load teacher tests"),[]}finally{_(!1)}},Oe=async me=>{try{return _(!0),await Er.createTest(me)}catch(be){throw w(be.message||"Failed to create test"),be}finally{_(!1)}},Ze=async(me,be)=>{try{return _(!0),await Er.deleteTest(me,be)}catch(_e){throw w(_e.message||"Failed to delete test"),_e}finally{_(!1)}},Re=async(me,be)=>{try{return await Er.getTestInfo(me,be)}catch(_e){throw console.error("Error getting test info:",_e),_e}},xt=async(me,be)=>{try{return await Er.getTestQuestions(me,be)}catch(_e){throw console.error("Error getting test questions:",_e),_e}},$t=async(me,be,_e)=>{try{console.log("Showing test results:",{testType:me,testId:be,studentAnswers:_e});const Fe=await Re(me,be),nt=await xt(me,be);Ue(Fe,nt,me,_e),d(!1),console.log("Test results displayed successfully")}catch(Fe){console.error("Error showing test results:",Fe),w("Failed to display test results"),m({testType:me,testId:be,answers:_e,showResults:!0,error:"Could not load detailed results"}),d(!1)}},Ae=async(me,be,_e)=>{try{_(!0);const Fe=await Re(me,be),nt=await xt(me,be);Ue(Fe,nt,me,_e)}catch(Fe){w(Fe.message||"Failed to load test results")}finally{_(!1)}},Pe=k.useCallback(async(me="")=>{var be;try{_(!0);const _e=`student_results_table_${me}`;console.log(" TestContext: Checking cache for key:",_e);const Fe=wn(_e);if(Fe)return console.log(" TestContext: Cache HIT! Using cached test results"),m(Fe),Fe;console.log(" TestContext: Cache MISS! Fetching from API");const nt=await Er.getStudentTestResults();return console.log(" TestContext: Test results loaded:",nt),console.log(" TestContext: Results data:",(nt==null?void 0:nt.results)||nt),console.log(" TestContext: Results length:",((be=nt==null?void 0:nt.results)==null?void 0:be.length)||0),m(nt),console.log(" TestContext: Caching test results with key:",_e),console.log(" TestContext: Results being cached:",nt),console.log(" TestContext: Results.results being cached:",nt.results),Zr(_e,nt,on.student_results_table),nt}catch(_e){throw console.error("Error loading test results:",_e),w(_e.message||"Failed to load test results"),_e}finally{_(!1)}},[]),Ue=(me,be,_e,Fe)=>{try{console.log("Displaying test results:",{testInfo:me,questions:be,testType:_e,studentAnswers:Fe});const nt=ee(be,Fe,_e),Rt=(me==null?void 0:me.num_questions)||(be==null?void 0:be.length)||0,ke=Rt>0?Math.round(nt/Rt*100):0,Qe=ke>=60,qe=be.map((yt,Vt)=>{const zt=yt.question_id||yt.id,G=Fe[zt],ce=fe(yt,G,_e);return{questionNumber:Vt+1,question:yt.question||yt.question_text,userAnswer:ye(G,_e),correctAnswer:Ce(yt,_e),isCorrect:ce,questionType:_e}});m({testInfo:me,questions:be,testType:_e,studentAnswers:Fe,showResults:!0,score:nt,totalQuestions:Rt,percentage:ke,passed:Qe,questionAnalysis:qe,timestamp:new Date().toISOString()}),l(yt=>({...yt,score:nt,totalQuestions:Rt,percentage:ke,passed:Qe,lastUpdated:Date.now()})),We(),console.log(`Test results displayed: ${nt}/${Rt} (${ke}%) - ${Qe?"PASSED":"FAILED"}`)}catch(nt){console.error("Error displaying test results:",nt),w("Failed to display test results")}},We=k.useCallback(()=>{try{console.log("Setting up test results page event listeners");const me=Rt=>{if(Rt.key==="Escape"&&J(),Rt.ctrlKey&&Rt.key==="p"&&(Rt.preventDefault(),window.print()),Rt.key==="Enter"&&h&&!h.passed){const ke=document.getElementById("retake-test-button");ke&&ke.click()}},be=()=>{window.print()},_e=()=>{var Rt;if(h){const ke=`Test: ${((Rt=h.testInfo)==null?void 0:Rt.test_name)||"Test"}
Score: ${h.score}/${h.totalQuestions} (${h.percentage}%)
Status: ${h.passed?"PASSED":"FAILED"}
Completed: ${new Date(h.timestamp).toLocaleString()}`;navigator.clipboard.writeText(ke).then(()=>{console.log("Results copied to clipboard")}).catch(Qe=>{console.error("Failed to copy results:",Qe)})}};document.addEventListener("keydown",me);const Fe=document.getElementById("print-results");Fe&&Fe.addEventListener("click",be);const nt=document.getElementById("copy-results");return nt&&nt.addEventListener("click",_e),()=>{document.removeEventListener("keydown",me),Fe&&Fe.removeEventListener("click",be),nt&&nt.removeEventListener("click",_e)}}catch(me){console.error("Error setting up test results page event listeners:",me)}},[J,h]),Xe=async(me,be,_e)=>{try{_(!0),w(null),console.log("Viewing test details:",{testType:me,testId:be,testName:_e}),b({isOpen:!0,testType:me,testId:be,testName:_e,questions:[],isLoading:!0});const Fe=await Er.getTestQuestions(me,be);Fe&&Fe.length>0?(b({isOpen:!0,testType:me,testId:be,testName:_e,questions:Fe,isLoading:!1}),console.log(`Test details loaded: ${Fe.length} questions`)):(w("Could not load test questions. Please try again."),b({isOpen:!0,testType:me,testId:be,testName:_e,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(Fe){console.error("Error loading test details:",Fe),w("Error loading test details. Please try again."),b({isOpen:!0,testType:me,testId:be,testName:_e,questions:[],isLoading:!1,error:Fe.message||"Failed to load test details"})}finally{_(!1)}},ut=(me,be,_e,Fe)=>{try{console.log("Showing test details modal:",{testType:me,testId:be,testName:_e,questions:Fe}),b({isOpen:!0,testType:me,testId:be,testName:_e,questions:Fe||[],isLoading:!1,error:null})}catch(nt){console.error("Error showing test details modal:",nt),w("Failed to show test details modal")}},Ct=()=>{try{console.log("Closing test details modal"),b({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(me){console.error("Error closing test details modal:",me)}},Mt=(me,be)=>{try{switch(be){case"multiple_choice":return c.jsxs("div",{className:"answer-options",children:[c.jsx("p",{children:c.jsx("strong",{children:"Options:"})}),c.jsxs("p",{children:["A) ",me.option_a||"No text"]}),c.jsxs("p",{children:["B) ",me.option_b||"No text"]}),me.option_c&&c.jsxs("p",{children:["C) ",me.option_c]}),me.option_d&&c.jsxs("p",{children:["D) ",me.option_d]}),me.option_e&&c.jsxs("p",{children:["E) ",me.option_e]}),me.option_f&&c.jsxs("p",{children:["F) ",me.option_f]}),c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",me.correct_answer||"Not specified"]})})]});case"true_false":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?"True":"False"]})})});case"input":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",me.correct_answer||"Not specified"]})})});case"matching_type":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?JSON.stringify(me.correct_answer):"Not specified"]})})});case"word_matching":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?JSON.stringify(me.correct_answer):"Not specified"]})})});default:return c.jsx("p",{children:"Unknown question type"})}}catch(_e){return console.error("Error formatting question answer display:",_e),c.jsx("p",{children:"Error displaying question"})}},At=(me,be)=>{try{console.log("Navigating to test:",{testType:me,testId:be}),r({testType:me,testId:be}),d(!0),I(me,be)}catch(_e){console.error("Error navigating to test:",_e),w("Failed to navigate to test")}},Pt=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),l({}),d(!1),m(null),w(null)}catch(me){console.error("Error hiding test sections:",me)}},it=(me,be,_e,Fe)=>{try{console.log("Displaying test on page:",{testInfo:me,questions:be,testType:_e,testId:Fe}),r({...me,testType:_e,testId:Fe}),s(be),d(!0),W(_e,Fe),Tt(_e,Fe),pt(_e,Fe)}catch(nt){console.error("Error displaying test on page:",nt),w("Failed to display test on page")}},rt=(me,be,_e)=>{try{return console.log("Rendering questions for page:",{questions:me,testType:be,testId:_e}),!me||!Array.isArray(me)?(console.warn("Invalid questions array for rendering"),[]):me.map((Fe,nt)=>{const Rt=ke=>{const Qe={...a,[Fe.question_id]:ke};i(Qe),le(be,_e,Fe.question_id,ke)};return{question:Fe,index:nt,testType:be,testId:_e,studentAnswer:a[Fe.question_id]||"",onAnswerChange:Rt}})}catch(Fe){return console.error("Error rendering questions for page:",Fe),[]}},xe=k.useCallback((me,be)=>{try{if(!me||!be){console.warn("Cannot save progress: missing testType or testId");return}const _e=`test_progress_${me}_${be}`,Fe={answers:a,progress:o,lastSaved:Date.now(),testType:me,testId:be};D(_e,Fe),console.log(`Progress saved for test ${me}_${be}:`,Fe)}catch(_e){console.error("Error saving progress for page:",_e)}},[a,o,D]),De=k.useCallback(me=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(_e=>_e==null?!1:typeof _e=="string"?_e.trim()!=="":typeof _e=="object"?Object.keys(_e).length>0:!0).length}catch(be){return console.error("Error getting answered questions count for page:",be),0}},[a]),Le=k.useCallback((me,be)=>{try{console.log("Updating progress display for page:",{testType:me,testId:be});const _e=De(me),Fe=n.length,nt=Fe>0?Math.round(_e/Fe*100):0,Rt=_e===Fe&&Fe>0;l(yt=>({...yt,answeredCount:_e,totalQuestions:Fe,percentage:nt,canSubmit:Rt,remainingQuestions:Fe-_e,lastUpdated:Date.now()}));const ke=document.getElementById("progress-bar"),Qe=document.getElementById("progress-text"),qe=document.getElementById("submit-test-button");return ke&&(ke.style.width=`${nt}%`,ke.className=ke.className.replace(/bg-\w+-\d+/,""),nt>=100?ke.classList.add("bg-green-500"):nt>=80?ke.classList.add("bg-blue-500"):nt>=60?ke.classList.add("bg-yellow-500"):nt>=40?ke.classList.add("bg-orange-500"):ke.classList.add("bg-red-500")),Qe&&(Qe.textContent=`${_e}/${Fe} questions answered (${nt}%)`),qe&&(qe.disabled=!Rt,Rt?(qe.textContent=" Submit Test",qe.classList.remove("bg-gray-400"),qe.classList.add("bg-green-600","hover:bg-green-700")):(qe.textContent=` Complete ${Fe-_e} more question${Fe-_e!==1?"s":""}`,qe.classList.remove("bg-green-600","hover:bg-green-700"),qe.classList.add("bg-gray-400"))),{answeredCount:_e,totalQuestions:Fe,percentage:nt,canSubmit:Rt}}catch(_e){return console.error("Error updating progress display for page:",_e),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,De]),pt=k.useCallback((me,be)=>{try{console.log("Setting up test page event listeners:",{testType:me,testId:be});const _e=setInterval(()=>{Object.keys(a).length>0&&(xe(me,be),console.log("Auto-saved progress for test:",me,be))},3e4),Fe=setInterval(()=>{Le(me,be)},2e3),nt=yt=>{yt.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&J(),yt.ctrlKey&&yt.key==="s"&&(yt.preventDefault(),xe(me,be),console.log("Manual save triggered")),yt.key},Rt=yt=>{Object.keys(a).length>0&&(yt.preventDefault(),yt.returnValue="Your test progress will be saved. Are you sure you want to leave?")},ke=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),xe(me,be))},Qe=()=>{console.log("Window focused - updating progress"),Le(me,be)},qe=()=>{console.log("Window blurred - saving progress"),xe(me,be)};return document.addEventListener("keydown",nt),window.addEventListener("beforeunload",Rt),document.addEventListener("visibilitychange",ke),window.addEventListener("focus",Qe),window.addEventListener("blur",qe),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${me}_${be}`]=_e,window.testIntervals[`progress_${me}_${be}`]=Fe,()=>{clearInterval(_e),clearInterval(Fe),document.removeEventListener("keydown",nt),window.removeEventListener("beforeunload",Rt),document.removeEventListener("visibilitychange",ke),window.removeEventListener("focus",Qe),window.removeEventListener("blur",qe),window.testIntervals&&(delete window.testIntervals[`autosave_${me}_${be}`],delete window.testIntervals[`progress_${me}_${be}`])}}catch(_e){console.error("Error setting up test page event listeners:",_e)}},[a,xe,Le,J]),ht=k.useCallback(()=>{try{const me=De(e==null?void 0:e.testType),be=n.length,_e=me===be&&be>0,Fe=document.getElementById("submit-test-button");return Fe&&(Fe.disabled=!_e,Fe.textContent=_e?"Submit Test":`Complete ${be-me} more questions`),{canSubmit:_e,answeredCount:me,totalQuestions:be}}catch(me){return console.error("Error updating submit button state for page:",me),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[e,n.length,De]),Tt=k.useCallback((me,be)=>{try{console.log("Setting up progress tracking for page:",{testType:me,testId:be});const _e=setInterval(()=>{Le(me,be),ht()},1e3),Fe=setInterval(()=>{Object.keys(a).length>0&&xe(me,be)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${me}_${be}`]=_e,window.testIntervals[`autosave_${me}_${be}`]=Fe,()=>{clearInterval(_e),clearInterval(Fe),window.testIntervals&&(delete window.testIntervals[`progress_${me}_${be}`],delete window.testIntervals[`autosave_${me}_${be}`])}}catch(_e){console.error("Error setting up progress tracking for page:",_e)}},[a,Le,ht,xe]),gr=k.useCallback(async(me,be)=>{const _e=document.getElementById("submit-test-button");try{const Fe=De(me),nt=n.length;if(Fe<nt){w(`Please answer all ${nt} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;_e&&(_e.disabled=!0,_e.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await K(me,be)&&(V(me,be),U(me,be,a),console.log("Test submitted successfully!"))}catch(Fe){console.error("Error submitting test from page:",Fe),w("Failed to submit test. Please try again."),_e&&(_e.disabled=!1,_e.textContent="Submit Test")}},[De,n.length,K,V,U,a]),tr=k.useCallback(()=>{try{if(!e)return null;const me=["true_false","multiple_choice","input","matching_type","word_matching"];return me.includes(e.testType)?e.testType:me.includes(e.test_type)?e.test_type:null}catch(me){return console.error("Error getting current test type:",me),null}},[e]),mr=k.useCallback((me,be)=>{try{console.log("Clearing progress tracking interval:",{testType:me,testId:be});const _e=`progress_interval_${me}_${be}`,Fe=`autosave_interval_${me}_${be}`;window.testIntervals&&(window.testIntervals[_e]&&(clearInterval(window.testIntervals[_e]),delete window.testIntervals[_e]),window.testIntervals[Fe]&&(clearInterval(window.testIntervals[Fe]),delete window.testIntervals[Fe])),console.log(`Cleared progress tracking intervals for test ${me}_${be}`)}catch(_e){console.error("Error clearing progress tracking interval:",_e)}},[]),vt={currentTest:e,testQuestions:n,studentAnswers:a,testProgress:o,isTestActive:u,testResults:h,activeTests:x,isLoading:v,error:S,testDetailsModal:y,testStartTime:E,timeElapsed:F,loadTestForPage:I,submitTest:K,navigateToTestResults:U,navigateBackToCabinet:L,clearTestDataAndReturnToCabinet:J,saveTestProgress:le,getTestProgress:q,clearTestProgress:V,loadSavedProgressForPage:W,isTestCompleted:Z,markTestCompleted:ne,markTestCompletedInUI:(me,be)=>{console.log("Marking test completed in UI:",{testType:me,testId:be}),ne(me,be)},getAnsweredQuestionsCount:z,updateSubmitButtonState:Y,updateSubmitButtonStateForPage:ht,loadStudentActiveTests:ve,loadActiveTests:ve,loadTeacherActiveTests:we,getTestInfo:Re,getTestQuestions:xt,createTest:Oe,deleteTest:Ze,showTestResults:$t,loadTestResults:Pe,loadTestResultsForPage:Ae,displayTestResultsOnPage:Ue,setupTestResultsPageEventListeners:We,clearTestResultsCache:te,viewTestDetails:Xe,showTestDetailsModal:ut,closeTestDetailsModal:Ct,getQuestionAnswerDisplay:Mt,navigateToTest:At,hideTestSections:Pt,displayTestOnPage:it,renderQuestionsForPage:rt,setupTestPageEventListeners:pt,setupProgressTrackingForPage:Tt,updateProgressDisplayForPage:Le,submitTestFromPage:gr,getAnsweredQuestionsCountForPage:De,getCurrentTestType:tr,saveProgressForPage:xe,clearProgressTrackingInterval:mr,collectTestAnswers:de,calculateTestScore:ee,isAnswerCorrect:ge,checkAnswerCorrectness:fe,formatStudentAnswerForDisplay:ye,getCorrectAnswer:Ce,transformAnswersForSubmission:re,clearAllTestData:()=>{try{console.log("Clearing all test data from localStorage...");const be=Object.keys(localStorage).filter(_e=>_e.startsWith("test_")||_e.startsWith("student_")||_e.startsWith("teacher_")||_e.startsWith("admin_")||_e.includes("progress")||_e.includes("answers")||_e.includes("completed"));return be.forEach(_e=>{console.log(`Removing localStorage key: ${_e}`),R(_e)}),r(null),s([]),i({}),l({}),d(!1),m(null),p([]),w(null),console.log(`Cleared ${be.length} test-related items from localStorage`),{success:!0,clearedCount:be.length}}catch(me){return console.error("Error clearing all test data:",me),{success:!1,error:me.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:l,setIsTestActive:d,setTestResults:m,setError:w};return c.jsx(L9.Provider,{value:vt,children:t})},ay=()=>{const t=k.useContext(L9);if(!t)throw new Error("useTest must be used within a TestProvider");return t},Br={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(e.success)return console.log("Student data loaded successfully:",e.subjects),e.subjects;throw new Error(e.error||"Failed to load student data")}catch(t){throw console.error("Error loading student data:",t),t}},getStudentSubjects(t){return console.log("getStudentSubjects called with subjects:",t),t.map(e=>({id:e.id||e.subject_id,name:e.subject,grade:e.grade,class:e.class,testResults:e.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const t=await this.getCurrentTeacherId();if(!t)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:t,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(t){throw console.error("Error loading teacher data:",t),t}},getTeacherSubjects(t){return console.log("getTeacherSubjects called with subjects:",t),t.map(e=>{let r=[];return e.classes&&Array.isArray(e.classes)&&(r=e.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:e.subject_id,name:e.subject,classes:r,assignments:e.assignments||[],description:e.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(e=>({id:e,name:e,classes:this.generateClassButtons(e)}))},generateClassButtons(t){const e=[];for(let r=1;r<=10;r++)e.push({id:`${t}_${r}`,name:`${t}/${r}`,grade:t,class:r});return e},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[e,r,n,s]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAcademicYear(),this.getAllUsers()]);return{teachers:e.status==="fulfilled"?e.value:[],subjects:r.status==="fulfilled"?r.value:[],academicYear:n.status==="fulfilled"?n.value:[],users:s.status==="fulfilled"?s.value:[],loadedAt:new Date().toISOString()}}catch(t){throw console.error("Error loading admin data:",t),t}},async saveTeacherSubjects(t){console.log("saveTeacherSubjects called with subjects:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:t})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(e){throw console.error("Error saving teacher subjects:",e),e}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(e.success)return console.log("Subjects dropdown data loaded successfully"),e.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(e.error||"Failed to load subjects dropdown")}catch(t){throw console.error("Error loading subjects dropdown:",t),t}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(e.success)return console.log("Grades and classes loaded successfully"),e.data;throw new Error(e.message||"Failed to load grades and classes")}catch(t){throw console.error("Error loading grades and classes:",t),t}},async saveSubjectClasses(t,e){console.log("saveSubjectClasses called with subjectId:",t,"classes:",e);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:t,classes:e})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(e.success)return console.log("All subjects loaded successfully"),e.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(e.error||"Failed to load all subjects")}catch(t){throw console.error("Error loading all subjects:",t),t}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(e.success)return console.log("Subjects for selection loaded successfully"),e.subjects;throw new Error(e.message||"Failed to load subjects for selection")}catch(t){throw console.error("Error loading subjects for selection:",t),t}},async getAcademicYear(){console.log("getAcademicYear called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-academic-year")).json();if(e.success)return console.log("Academic year loaded successfully"),e.academic_years.map(r=>({id:r.id,year:r.academic_year,semester:r.semester,term:r.term,start_date:r.start_date,end_date:r.end_date,is_current:r.is_current}));throw new Error(e.error||"Failed to load academic year")}catch(t){throw console.error("Error loading academic year:",t),t}},async addAcademicYear(t){console.log("addAcademicYear called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(e){throw console.error("Error adding academic year:",e),e}},async getAllUsers(){console.log("getAllUsers called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(e.success)return console.log("All users loaded successfully"),e.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(e.error||"Failed to load all users")}catch(t){throw console.error("Error loading all users:",t),t}},async getAllTeachers(){console.log("getAllTeachers called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(e.success)return console.log("All teachers loaded successfully"),e.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(e.error||"Failed to load all teachers")}catch(t){throw console.error("Error loading all teachers:",t),t}},async createUser(t){console.log("createUser called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(e){throw console.error("Error creating user:",e),e}},async updateUser(t,e){console.log("updateUser called with userId:",t,"data:",e);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(t){console.log("createTeacher called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(e){throw console.error("Error creating teacher:",e),e}},async updateTeacher(t,e){console.log("updateTeacher called with teacherId:",t,"data:",e);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(t){console.log("updateStudentInfo called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(e){throw console.error("Error updating student info:",e),e}},async changePassword(t){console.log("changePassword called");try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Password changed successfully"),r;throw new Error(r.error||"Failed to change password")}catch(e){throw console.error("Error changing password:",e),e}},async getCurrentTeacherId(){try{const t=localStorage.getItem("accessToken");if(!t)return null;const e=JSON.parse(atob(t.split(".")[1]));return e.teacher_id||e.sub||null}catch(t){return console.error("Error getting current teacher ID:",t),null}},async getCurrentAdminId(){try{const t=localStorage.getItem("accessToken");if(!t)return null;const e=JSON.parse(atob(t.split(".")[1]));return e.admin_id||e.sub||null}catch(t){return console.error("Error getting current admin ID:",t),null}}},B9=k.createContext(),U9=({children:t})=>{const[e,r]=k.useState(null),[n,s]=k.useState([]),[a,i]=k.useState([]),[o,l]=k.useState([]),[u,d]=k.useState([]),[h,m]=k.useState([]),[x,p]=k.useState([]),[v,_]=k.useState([]),[S,w]=k.useState(!1),[y,b]=k.useState(null),[E,N]=k.useState(!1),[F,T]=k.useState(!1),[P,D]=k.useState(!1),[R,I]=k.useState(null),[W,le]=k.useState(null),[q,V]=k.useState(null),K=k.useCallback(async()=>{try{w(!0),b(null);const jt=`student_subjects_${(e==null?void 0:e.student_id)||(e==null?void 0:e.id)||""}`;console.log(" UserContext: Checking cache for key:",jt);const vt=wn(jt);if(vt){console.log(" UserContext: Cache HIT! Using cached student data"),s(vt),U(vt);return}console.log(" UserContext: Cache MISS! Fetching from API");const me=await Br.getStudentData();if(me)s(me),U(me),console.log(" UserContext: Caching student data with key:",jt),Zr(jt,me,on.student_subjects);else throw new Error("No subjects data received")}catch(Je){b(Je.message||"Failed to load student data"),console.error("Error loading student data:",Je)}finally{w(!1)}},[e==null?void 0:e.student_id,e==null?void 0:e.id]),U=Je=>{console.log("Displaying student subjects:",Je),s(Je)},L=k.useCallback(async()=>{try{if(w(!0),b(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),b("No valid teacher session found");return}const jt=`teacher_subjects_${(e==null?void 0:e.teacher_id)||(e==null?void 0:e.id)||""}`,vt=wn(jt);if(vt){s(vt),vt.length===0?pt():Z(vt);return}const me=await Br.getTeacherSubjects();if(me.success)s(me.subjects),Zr(jt,me.subjects,on.teacher_subjects),me.subjects.length===0?pt():Z(me.subjects);else throw new Error(me.message||"Failed to load teacher data")}catch(Je){b(Je.message||"Failed to load teacher data"),console.error("Error loading teacher data:",Je)}finally{w(!1)}},[e==null?void 0:e.teacher_id,e==null?void 0:e.id]),Z=Je=>{console.log("Showing main cabinet with subjects:",Je),s(Je)},ne=Je=>{console.log("Displaying grade buttons:",Je),l(Je)},z=async()=>{try{if(w(!0),b(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),b("No valid admin session found");return}await Promise.all([ve(),Pe(),At(),de()])}catch(Je){b(Je.message||"Failed to load admin data"),console.error("Error loading admin data:",Je)}finally{w(!1)}},Y=Je=>{console.log(" populateStudentInfoDirectly called with:",Je);try{r(Je),console.log(" Set student profile:",Je)}catch(jt){console.error("Error populating student info:",jt)}},J=Je=>{console.log("=== populateStudentInfo called ==="),r(Je)},te=Je=>{console.log("=== populateTeacherInfo called ==="),r(Je)},de=k.useCallback(async()=>{try{w(!0);const Je="admin_users_",jt=wn(Je);if(jt){d(jt),ee(jt);return}const vt=await Br.getAllUsers();if(vt.success)d(vt.users),ee(vt.users),Zr(Je,vt.users,on.admin_users);else throw new Error(vt.message||"Failed to load users")}catch(Je){b(Je.message||"Failed to load users"),console.error("Error loading users:",Je)}finally{w(!1)}},[]),ee=Je=>{console.log("Displaying all users:",Je),d(Je)},ge=(Je,jt)=>{console.log("Displaying users table:",Je,jt),d(Je)},fe=()=>{console.log("Toggling users content")},ye=()=>{console.log("Showing add user form"),N(!0)},Ce=()=>{console.log("Hiding add user form"),N(!1)},re=Je=>{console.log("Editing user row:",Je);const jt=u.find(vt=>vt.id===Je);I(jt)},ve=k.useCallback(async()=>{try{const Je="admin_teachers_",jt=wn(Je);if(jt){m(jt),we(jt);return}const vt=await Br.getAllTeachers();if(vt.success)m(vt.teachers),we(vt.teachers),Zr(Je,vt.teachers,on.admin_teachers);else throw new Error(vt.message||"Failed to load teachers")}catch(Je){b(Je.message||"Failed to load teachers"),console.error("Error loading teachers:",Je)}},[]),we=Je=>{console.log("Displaying all teachers:",Je),m(Je)},Oe=(Je,jt)=>{console.log("Displaying teachers table:",Je,jt),m(Je)},Ze=()=>{console.log("Toggling teachers content")},Re=()=>{console.log("Showing add teacher form"),T(!0)},xt=()=>{console.log("Hiding add teacher form"),T(!1)},$t=Je=>{console.log("Editing teacher:",Je);const jt=h.find(vt=>vt.id===Je);le(jt)},Ae=Je=>{console.log("Editing teacher row:",Je);const jt=h.find(vt=>vt.id===Je);le(jt)},Pe=k.useCallback(async()=>{try{const Je="admin_subjects_",jt=wn(Je);if(jt){p(jt),Ue(jt);return}const vt=await Br.getAllSubjects();if(vt.success)p(vt.subjects),Ue(vt.subjects),Zr(Je,vt.subjects,on.admin_subjects);else throw new Error(vt.message||"Failed to load subjects")}catch(Je){b(Je.message||"Failed to load subjects"),console.error("Error loading subjects:",Je)}},[]),Ue=Je=>{console.log("Displaying all subjects:",Je),p(Je)},We=(Je,jt)=>{console.log("Displaying subjects table:",Je,jt),p(Je)},Xe=()=>{console.log("Toggling subjects content")},ut=()=>{console.log("Showing add subject form"),D(!0)},Ct=()=>{console.log("Hiding add subject form"),D(!1)},Mt=Je=>{console.log("Editing subject row:",Je);const jt=x.find(vt=>vt.id===Je);V(jt)},At=k.useCallback(async()=>{try{const Je="admin_academic_years_",jt=wn(Je);if(jt){_(jt),Pt(jt);return}const vt=await Br.getAcademicYear();if(vt.success)_(vt.academicYears),Pt(vt.academicYears),Zr(Je,vt.academicYears,on.admin_academic_years);else throw new Error(vt.message||"Failed to load academic year")}catch(Je){b(Je.message||"Failed to load academic year"),console.error("Error loading academic year:",Je)}},[]),Pt=Je=>{console.log("Displaying academic year:",Je),_(Je)},it=()=>{console.log("Showing add academic year form")},rt=()=>{console.log("Hiding add academic year form")},xe=Je=>{console.log("Handling add academic year:",Je)},De=()=>{console.log("Toggling academic year content")},Le=()=>{console.log("Showing academic year editor")},pt=()=>{console.log("Showing subject selection")},ht=()=>{console.log("Showing main cabinet")},Tt=Je=>{r(jt=>({...jt,...Je}))},gr=()=>{r(null),s([]),i([]),l([]),d([]),m([]),p([]),_([]),b(null)},tr=k.useCallback(Je=>{gr(),Je&&Ik(Je)},[]),mr={userProfile:e,userSubjects:n,userClasses:a,userGrades:o,allUsers:u,allTeachers:h,allSubjects:x,academicYears:v,isLoading:S,error:y,showUserForm:E,showTeacherForm:F,showSubjectForm:P,editingUser:R,editingTeacher:W,editingSubject:q,loadStudentData:K,displayStudentSubjects:U,populateStudentInfoDirectly:Y,populateStudentInfo:J,loadTeacherData:L,showMainCabinetWithSubjects:Z,displayGradeButtons:ne,populateTeacherInfo:te,showSubjectSelection:pt,showMainCabinet:ht,loadAdminData:z,getAllUsers:de,displayAllUsers:ee,displayUsersTable:ge,toggleUsersContent:fe,showAddUserForm:ye,hideAddUserForm:Ce,editUserRow:re,loadAllTeachers:ve,displayAllTeachers:we,displayTeachersTable:Oe,toggleTeachersContent:Ze,showAddTeacherForm:Re,hideAddTeacherForm:xt,editTeacher:$t,editTeacherRow:Ae,loadAllSubjects:Pe,displayAllSubjects:Ue,displaySubjectsTable:We,toggleSubjectsContent:Xe,showAddSubjectForm:ut,hideAddSubjectForm:Ct,editSubjectRow:Mt,loadAcademicYear:At,displayAcademicYear:Pt,showAddAcademicYearForm:it,hideAddAcademicYearForm:rt,handleAddAcademicYear:xe,toggleAcademicYearContent:De,showAcademicYearEditor:Le,updateUserProfile:Tt,clearUserData:gr,clearUserDataWithCache:tr,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:l,setAllUsers:d,setAllTeachers:m,setAllSubjects:p,setAcademicYears:_,setError:b};return c.jsx(B9.Provider,{value:mr,children:t})},iy=()=>{const t=k.useContext(B9);if(!t)throw new Error("useUser must be used within a UserProvider");return t},Uk=k.createContext({});function $k(t){const e=k.useRef(null);return e.current===null&&(e.current=t()),e.current}const zk=typeof window<"u",$9=zk?k.useLayoutEffect:k.useEffect,oy=k.createContext(null);function Wk(t,e){t.indexOf(e)===-1&&t.push(e)}function Vk(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const il=(t,e,r)=>r>e?e:r<t?t:r;let Gk=()=>{};const ol={},z9=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function W9(t){return typeof t=="object"&&t!==null}const V9=t=>/^0[^.\s]+$/u.test(t);function Hk(t){let e;return()=>(e===void 0&&(e=t()),e)}const fi=t=>t,R$=(t,e)=>r=>e(t(r)),Ig=(...t)=>t.reduce(R$),Z0=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class Kk{constructor(){this.subscriptions=[]}add(e){return Wk(this.subscriptions,e),()=>Vk(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const xo=t=>t*1e3,yo=t=>t/1e3;function G9(t,e){return e?t*(1e3/e):0}const H9=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,O$=1e-7,M$=12;function L$(t,e,r,n,s){let a,i,o=0;do i=e+(r-e)/2,a=H9(i,n,s)-t,a>0?r=i:e=i;while(Math.abs(a)>O$&&++o<M$);return i}function Bg(t,e,r,n){if(t===e&&r===n)return fi;const s=a=>L$(a,0,1,t,r);return a=>a===0||a===1?a:H9(s(a),e,n)}const K9=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,X9=t=>e=>1-t(1-e),Y9=Bg(.33,1.53,.69,.99),Xk=X9(Y9),J9=K9(Xk),Q9=t=>(t*=2)<1?.5*Xk(t):.5*(2-Math.pow(2,-10*(t-1))),Yk=t=>1-Math.sin(Math.acos(t)),q9=X9(Yk),Z9=K9(Yk),I$=Bg(.42,0,1,1),B$=Bg(0,0,.58,1),e7=Bg(.42,0,.58,1),U$=t=>Array.isArray(t)&&typeof t[0]!="number",t7=t=>Array.isArray(t)&&typeof t[0]=="number",$$={linear:fi,easeIn:I$,easeInOut:e7,easeOut:B$,circIn:Yk,circInOut:Z9,circOut:q9,backIn:Xk,backInOut:J9,backOut:Y9,anticipate:Q9},z$=t=>typeof t=="string",mN=t=>{if(t7(t)){Gk(t.length===4);const[e,r,n,s]=t;return Bg(e,r,n,s)}else if(z$(t))return $$[t];return t},kp=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function W$(t,e){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(d){i.has(d)&&(u.schedule(d),t()),d(o)}const u={schedule:(d,h=!1,m=!1)=>{const p=m&&s?r:n;return h&&i.add(d),p.has(d)||p.add(d),d},cancel:d=>{n.delete(d),i.delete(d)},process:d=>{if(o=d,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(l),r.clear(),s=!1,a&&(a=!1,u.process(d))}};return u}const V$=40;function r7(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=kp.reduce((y,b)=>(y[b]=W$(a),y),{}),{setup:o,read:l,resolveKeyframes:u,preUpdate:d,update:h,preRender:m,render:x,postRender:p}=i,v=()=>{const y=ol.useManualTiming?s.timestamp:performance.now();r=!1,ol.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(y-s.timestamp,V$),1)),s.timestamp=y,s.isProcessing=!0,o.process(s),l.process(s),u.process(s),d.process(s),h.process(s),m.process(s),x.process(s),p.process(s),s.isProcessing=!1,r&&e&&(n=!1,t(v))},_=()=>{r=!0,n=!0,s.isProcessing||t(v)};return{schedule:kp.reduce((y,b)=>{const E=i[b];return y[b]=(N,F=!1,T=!1)=>(r||_(),E.schedule(N,F,T)),y},{}),cancel:y=>{for(let b=0;b<kp.length;b++)i[kp[b]].cancel(y)},state:s,steps:i}}const{schedule:en,cancel:sc,state:vs,steps:f2}=r7(typeof requestAnimationFrame<"u"?requestAnimationFrame:fi,!0);let hx;function G$(){hx=void 0}const pa={now:()=>(hx===void 0&&pa.set(vs.isProcessing||ol.useManualTiming?vs.timestamp:performance.now()),hx),set:t=>{hx=t,queueMicrotask(G$)}},n7=t=>e=>typeof e=="string"&&e.startsWith(t),Jk=n7("--"),H$=n7("var(--"),Qk=t=>H$(t)?K$.test(t.split("/*")[0].trim()):!1,K$=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Kf={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},eg={...Kf,transform:t=>il(0,1,t)},Cp={...Kf,default:1},p0=t=>Math.round(t*1e5)/1e5,qk=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function X$(t){return t==null}const Y$=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Zk=(t,e)=>r=>!!(typeof r=="string"&&Y$.test(r)&&r.startsWith(t)||e&&!X$(r)&&Object.prototype.hasOwnProperty.call(r,e)),s7=(t,e,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(qk);return{[t]:parseFloat(s),[e]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},J$=t=>il(0,255,t),h2={...Kf,transform:t=>Math.round(J$(t))},eu={test:Zk("rgb","red"),parse:s7("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+h2.transform(t)+", "+h2.transform(e)+", "+h2.transform(r)+", "+p0(eg.transform(n))+")"};function Q$(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const mS={test:Zk("#"),parse:Q$,transform:eu.transform},Ug=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Pl=Ug("deg"),vo=Ug("%"),Gt=Ug("px"),q$=Ug("vh"),Z$=Ug("vw"),pN={...vo,parse:t=>vo.parse(t)/100,transform:t=>vo.transform(t*100)},Xd={test:Zk("hsl","hue"),parse:s7("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+vo.transform(p0(e))+", "+vo.transform(p0(r))+", "+p0(eg.transform(n))+")"},zn={test:t=>eu.test(t)||mS.test(t)||Xd.test(t),parse:t=>eu.test(t)?eu.parse(t):Xd.test(t)?Xd.parse(t):mS.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?eu.transform(t):Xd.transform(t),getAnimatableNone:t=>{const e=zn.parse(t);return e.alpha=0,zn.transform(e)}},ez=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function tz(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(qk))==null?void 0:e.length)||0)+(((r=t.match(ez))==null?void 0:r.length)||0)>0}const a7="number",i7="color",rz="var",nz="var(",xN="${}",sz=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function tg(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=e.replace(sz,l=>(zn.test(l)?(n.color.push(a),s.push(i7),r.push(zn.parse(l))):l.startsWith(nz)?(n.var.push(a),s.push(rz),r.push(l)):(n.number.push(a),s.push(a7),r.push(parseFloat(l))),++a,xN)).split(xN);return{values:r,split:o,indexes:n,types:s}}function o7(t){return tg(t).values}function l7(t){const{split:e,types:r}=tg(t),n=e.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=e[i],s[i]!==void 0){const o=r[i];o===a7?a+=p0(s[i]):o===i7?a+=zn.transform(s[i]):a+=s[i]}return a}}const az=t=>typeof t=="number"?0:zn.test(t)?zn.getAnimatableNone(t):t;function iz(t){const e=o7(t);return l7(t)(e.map(az))}const ac={test:tz,parse:o7,createTransformer:l7,getAnimatableNone:iz};function g2(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function oz({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,a=0,i=0;if(!e)s=a=i=r;else{const o=r<.5?r*(1+e):r+e-r*e,l=2*r-o;s=g2(l,o,t+1/3),a=g2(l,o,t),i=g2(l,o,t-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function Qx(t,e){return r=>r>0?e:t}const ln=(t,e,r)=>t+(e-t)*r,m2=(t,e,r)=>{const n=t*t,s=r*(e*e-n)+n;return s<0?0:Math.sqrt(s)},lz=[mS,eu,Xd],cz=t=>lz.find(e=>e.test(t));function yN(t){const e=cz(t);if(!e)return!1;let r=e.parse(t);return e===Xd&&(r=oz(r)),r}const vN=(t,e)=>{const r=yN(t),n=yN(e);if(!r||!n)return Qx(t,e);const s={...r};return a=>(s.red=m2(r.red,n.red,a),s.green=m2(r.green,n.green,a),s.blue=m2(r.blue,n.blue,a),s.alpha=ln(r.alpha,n.alpha,a),eu.transform(s))},pS=new Set(["none","hidden"]);function uz(t,e){return pS.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function dz(t,e){return r=>ln(t,e,r)}function eC(t){return typeof t=="number"?dz:typeof t=="string"?Qk(t)?Qx:zn.test(t)?vN:gz:Array.isArray(t)?c7:typeof t=="object"?zn.test(t)?vN:fz:Qx}function c7(t,e){const r=[...t],n=r.length,s=t.map((a,i)=>eC(a)(a,e[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function fz(t,e){const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=eC(t[s])(t[s],e[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function hz(t,e){const r=[],n={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],i=t.indexes[a][n[a]],o=t.values[i]??0;r[s]=o,n[a]++}return r}const gz=(t,e)=>{const r=ac.createTransformer(e),n=tg(t),s=tg(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?pS.has(t)&&!s.values.length||pS.has(e)&&!n.values.length?uz(t,e):Ig(c7(hz(n,s),s.values),r):Qx(t,e)};function u7(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?ln(t,e,r):eC(t)(t,e)}const mz=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>en.update(e,r),stop:()=>sc(e),now:()=>vs.isProcessing?vs.timestamp:pa.now()}},d7=(t,e,r=10)=>{let n="";const s=Math.max(Math.round(e/r),2);for(let a=0;a<s;a++)n+=Math.round(t(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},qx=2e4;function tC(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<qx;)e+=r,n=t.next(e);return e>=qx?1/0:e}function pz(t,e=100,r){const n=r({...t,keyframes:[0,e]}),s=Math.min(tC(n),qx);return{type:"keyframes",ease:a=>n.next(s*a).value/e,duration:yo(s)}}const xz=5;function f7(t,e,r){const n=Math.max(e-xz,0);return G9(r-t(n),e-n)}const xn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},p2=.001;function yz({duration:t=xn.duration,bounce:e=xn.bounce,velocity:r=xn.velocity,mass:n=xn.mass}){let s,a,i=1-e;i=il(xn.minDamping,xn.maxDamping,i),t=il(xn.minDuration,xn.maxDuration,yo(t)),i<1?(s=u=>{const d=u*i,h=d*t,m=d-r,x=xS(u,i),p=Math.exp(-h);return p2-m/x*p},a=u=>{const h=u*i*t,m=h*r+r,x=Math.pow(i,2)*Math.pow(u,2)*t,p=Math.exp(-h),v=xS(Math.pow(u,2),i);return(-s(u)+p2>0?-1:1)*((m-x)*p)/v}):(s=u=>{const d=Math.exp(-u*t),h=(u-r)*t+1;return-p2+d*h},a=u=>{const d=Math.exp(-u*t),h=(r-u)*(t*t);return d*h});const o=5/t,l=wz(s,a,o);if(t=xo(t),isNaN(l))return{stiffness:xn.stiffness,damping:xn.damping,duration:t};{const u=Math.pow(l,2)*n;return{stiffness:u,damping:i*2*Math.sqrt(n*u),duration:t}}}const vz=12;function wz(t,e,r){let n=r;for(let s=1;s<vz;s++)n=n-t(n)/e(n);return n}function xS(t,e){return t*Math.sqrt(1-e*e)}const _z=["duration","bounce"],Sz=["stiffness","damping","mass"];function wN(t,e){return e.some(r=>t[r]!==void 0)}function bz(t){let e={velocity:xn.velocity,stiffness:xn.stiffness,damping:xn.damping,mass:xn.mass,isResolvedFromDuration:!1,...t};if(!wN(t,Sz)&&wN(t,_z))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*il(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:xn.mass,stiffness:s,damping:a}}else{const r=yz(t);e={...e,...r,mass:xn.mass},e.isResolvedFromDuration=!0}return e}function Zx(t=xn.visualDuration,e=xn.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:l,damping:u,mass:d,duration:h,velocity:m,isResolvedFromDuration:x}=bz({...r,velocity:-yo(r.velocity||0)}),p=m||0,v=u/(2*Math.sqrt(l*d)),_=i-a,S=yo(Math.sqrt(l/d)),w=Math.abs(_)<5;n||(n=w?xn.restSpeed.granular:xn.restSpeed.default),s||(s=w?xn.restDelta.granular:xn.restDelta.default);let y;if(v<1){const E=xS(S,v);y=N=>{const F=Math.exp(-v*S*N);return i-F*((p+v*S*_)/E*Math.sin(E*N)+_*Math.cos(E*N))}}else if(v===1)y=E=>i-Math.exp(-S*E)*(_+(p+S*_)*E);else{const E=S*Math.sqrt(v*v-1);y=N=>{const F=Math.exp(-v*S*N),T=Math.min(E*N,300);return i-F*((p+v*S*_)*Math.sinh(T)+E*_*Math.cosh(T))/E}}const b={calculatedDuration:x&&h||null,next:E=>{const N=y(E);if(x)o.done=E>=h;else{let F=E===0?p:0;v<1&&(F=E===0?xo(p):f7(y,E,N));const T=Math.abs(F)<=n,P=Math.abs(i-N)<=s;o.done=T&&P}return o.value=o.done?i:N,o},toString:()=>{const E=Math.min(tC(b),qx),N=d7(F=>b.next(E*F).value,E,30);return E+"ms "+N},toTransition:()=>{}};return b}Zx.applyToOptions=t=>{const e=pz(t,100,Zx);return t.ease=e.ease,t.duration=xo(e.duration),t.type="keyframes",t};function yS({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:l,restDelta:u=.5,restSpeed:d}){const h=t[0],m={done:!1,value:h},x=T=>o!==void 0&&T<o||l!==void 0&&T>l,p=T=>o===void 0?l:l===void 0||Math.abs(o-T)<Math.abs(l-T)?o:l;let v=r*e;const _=h+v,S=i===void 0?_:i(_);S!==_&&(v=S-h);const w=T=>-v*Math.exp(-T/n),y=T=>S+w(T),b=T=>{const P=w(T),D=y(T);m.done=Math.abs(P)<=u,m.value=m.done?S:D};let E,N;const F=T=>{x(m.value)&&(E=T,N=Zx({keyframes:[m.value,p(m.value)],velocity:f7(y,T,m.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return F(0),{calculatedDuration:null,next:T=>{let P=!1;return!N&&E===void 0&&(P=!0,b(T),F(T)),E!==void 0&&T>=E?N.next(T-E):(!P&&b(T),m)}}}function kz(t,e,r){const n=[],s=r||ol.mix||u7,a=t.length-1;for(let i=0;i<a;i++){let o=s(t[i],t[i+1]);if(e){const l=Array.isArray(e)?e[i]||fi:e;o=Ig(l,o)}n.push(o)}return n}function Cz(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const a=t.length;if(Gk(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const i=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=kz(e,n,s),l=o.length,u=d=>{if(i&&d<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(d<t[h+1]);h++);const m=Z0(t[h],t[h+1],d);return o[h](m)};return r?d=>u(il(t[0],t[a-1],d)):u}function Tz(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=Z0(0,e,n);t.push(ln(r,1,s))}}function Ez(t){const e=[0];return Tz(e,t.length-1),e}function Nz(t,e){return t.map(r=>r*e)}function Az(t,e){return t.map(()=>e||e7).splice(0,t.length-1)}function x0({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=U$(n)?n.map(mN):mN(n),a={done:!1,value:e[0]},i=Nz(r&&r.length===e.length?r:Ez(e),t),o=Cz(i,e,{ease:Array.isArray(s)?s:Az(e,s)});return{calculatedDuration:t,next:l=>(a.value=o(l),a.done=l>=t,a)}}const Fz=t=>t!==null;function rC(t,{repeat:e,repeatType:r="loop"},n,s=1){const a=t.filter(Fz),o=s<0||e&&r!=="loop"&&e%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const jz={decay:yS,inertia:yS,tween:x0,keyframes:x0,spring:Zx};function h7(t){typeof t.type=="string"&&(t.type=jz[t.type])}class nC{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const Pz=t=>t/100;class sC extends nC{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,s;const{motionValue:r}=this.options;r&&r.updatedAt!==pa.now()&&this.tick(pa.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(n=this.options).onStop)==null||s.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;h7(e);const{type:r=x0,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=e;let{keyframes:o}=e;const l=r||x0;l!==x0&&typeof o[0]!="number"&&(this.mixKeyframes=Ig(Pz,u7(o[0],o[1])),o=[0,100]);const u=l({...e,keyframes:o});a==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...o].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=tC(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=u}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:d,repeat:h,repeatType:m,repeatDelay:x,type:p,onUpdate:v,finalKeyframe:_}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const S=this.currentTime-u*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?S<0:S>s;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let y=this.currentTime,b=n;if(h){const T=Math.min(this.currentTime,s)/o;let P=Math.floor(T),D=T%1;!D&&T>=1&&(D=1),D===1&&P--,P=Math.min(P,h+1),!!(P%2)&&(m==="reverse"?(D=1-D,x&&(D-=x/o)):m==="mirror"&&(b=i)),y=il(0,1,D)*o}const E=w?{done:!1,value:d[0]}:b.next(y);a&&(E.value=a(E.value));let{done:N}=E;!w&&l!==null&&(N=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const F=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&N);return F&&p!==yS&&(E.value=rC(d,this.options,_,this.speed)),v&&v(E.value),F&&this.finish(),E}then(e,r){return this.finished.then(e,r)}get duration(){return yo(this.calculatedDuration)}get time(){return yo(this.currentTime)}set time(e){var r;e=xo(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(pa.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=yo(this.currentTime))}play(){var s,a;if(this.isStopped)return;const{driver:e=mz,startTime:r}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),(a=(s=this.options).onPlay)==null||a.call(s);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(pa.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(e=this.options).onComplete)==null||r.call(e)}cancel(){var e,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(e=this.options).onCancel)==null||r.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),e.observe(this)}}function Dz(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const tu=t=>t*180/Math.PI,vS=t=>{const e=tu(Math.atan2(t[1],t[0]));return wS(e)},Rz={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:vS,rotateZ:vS,skewX:t=>tu(Math.atan(t[1])),skewY:t=>tu(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},wS=t=>(t=t%360,t<0&&(t+=360),t),_N=vS,SN=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),bN=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),Oz={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:SN,scaleY:bN,scale:t=>(SN(t)+bN(t))/2,rotateX:t=>wS(tu(Math.atan2(t[6],t[5]))),rotateY:t=>wS(tu(Math.atan2(-t[2],t[0]))),rotateZ:_N,rotate:_N,skewX:t=>tu(Math.atan(t[4])),skewY:t=>tu(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function _S(t){return t.includes("scale")?1:0}function SS(t,e){if(!t||t==="none")return _S(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=Oz,s=r;else{const o=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=Rz,s=o}if(!s)return _S(e);const a=n[e],i=s[1].split(",").map(Lz);return typeof a=="function"?a(i):i[a]}const Mz=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return SS(r,e)};function Lz(t){return parseFloat(t.trim())}const Xf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Yf=new Set(Xf),kN=t=>t===Kf||t===Gt,Iz=new Set(["x","y","z"]),Bz=Xf.filter(t=>!Iz.has(t));function Uz(t){const e=[];return Bz.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const cu={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>SS(e,"x"),y:(t,{transform:e})=>SS(e,"y")};cu.translateX=cu.x;cu.translateY=cu.y;const uu=new Set;let bS=!1,kS=!1,CS=!1;function g7(){if(kS){const t=Array.from(uu).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const s=Uz(n);s.length&&(r.set(n,s),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{var o;(o=n.getValue(a))==null||o.set(i)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}kS=!1,bS=!1,uu.forEach(t=>t.complete(CS)),uu.clear()}function m7(){uu.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(kS=!0)})}function $z(){CS=!0,m7(),g7(),CS=!1}class aC{constructor(e,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(uu.add(this),bS||(bS=!0,en.read(m7),en.resolveKeyframes(g7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:s}=this;if(e[0]===null){const a=s==null?void 0:s.get(),i=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&r){const o=n.readValue(r,i);o!=null&&(e[0]=o)}e[0]===void 0&&(e[0]=i),s&&a===void 0&&s.set(e[0])}Dz(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),uu.delete(this)}cancel(){this.state==="scheduled"&&(uu.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const zz=t=>t.startsWith("--");function Wz(t,e,r){zz(e)?t.style.setProperty(e,r):t.style[e]=r}const Vz=Hk(()=>window.ScrollTimeline!==void 0),Gz={};function Hz(t,e){const r=Hk(t);return()=>Gz[e]??r()}const p7=Hz(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),e0=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,CN={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:e0([0,.65,.55,1]),circOut:e0([.55,0,1,.45]),backIn:e0([.31,.01,.66,-.59]),backOut:e0([.33,1.53,.69,.99])};function x7(t,e){if(t)return typeof t=="function"?p7()?d7(t,e):"ease-out":t7(t)?e0(t):Array.isArray(t)?t.map(r=>x7(r,e)||CN.easeOut):CN[t]}function Kz(t,e,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:l}={},u=void 0){const d={[e]:r};l&&(d.offset=l);const h=x7(o,s);Array.isArray(h)&&(d.easing=h);const m={delay:n,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(m.pseudoElement=u),t.animate(d,m)}function y7(t){return typeof t=="function"&&"applyToOptions"in t}function Xz({type:t,...e}){return y7(t)&&p7()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class Yz extends nC{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:l}=e;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=e,Gk(typeof e.type!="string");const u=Xz(e);this.animation=Kz(r,n,s,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=rC(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):Wz(r,n,d),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return yo(Number(e))}get time(){return yo(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=xo(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&Vz()?(this.animation.timeline=e,fi):r(this)}}const v7={anticipate:Q9,backInOut:J9,circInOut:Z9};function Jz(t){return t in v7}function Qz(t){typeof t.ease=="string"&&Jz(t.ease)&&(t.ease=v7[t.ease])}const TN=10;class qz extends Yz{constructor(e){Qz(e),h7(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const o=new sC({...i,autoplay:!1}),l=xo(this.finishedTime??this.time);r.setWithVelocity(o.sample(l-TN).value,o.sample(l).value,TN),o.stop()}}const EN=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(ac.test(t)||t==="0")&&!t.startsWith("url("));function Zz(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function eW(t,e,r,n){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],i=EN(s,e),o=EN(a,e);return!i||!o?!1:Zz(t)||(r==="spring"||y7(r))&&n}function TS(t){t.duration=0,t.type}const tW=new Set(["opacity","clipPath","filter","transform"]),rW=Hk(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function nW(t){var d;const{motionValue:e,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=t;if(!(((d=e==null?void 0:e.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=e.owner.getProps();return rW()&&r&&tW.has(r)&&(r!=="transform"||!u)&&!l&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const sW=40;class aW extends nC{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:l,motionValue:u,element:d,...h}){var p;super(),this.stop=()=>{var v,_;this._animation&&(this._animation.stop(),(v=this.stopTimeline)==null||v.call(this)),(_=this.keyframeResolver)==null||_.cancel()},this.createdAt=pa.now();const m={autoplay:e,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:l,motionValue:u,element:d,...h},x=(d==null?void 0:d.KeyframeResolver)||aC;this.keyframeResolver=new x(o,(v,_,S)=>this.onKeyframesResolved(v,_,m,!S),l,u,d),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(e,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:l,isHandoff:u,onUpdate:d}=n;this.resolvedAt=pa.now(),eW(e,a,i,o)||((ol.instantAnimations||!l)&&(d==null||d(rC(e,n,r))),e[0]=e[e.length-1],TS(n),n.repeat=0);const m={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>sW?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},x=!u&&nW(m)?new qz({...m,element:m.motionValue.owner.current}):new sC(m);x.finished.then(()=>this.notifyFinished()).catch(fi),this.pendingTimeline&&(this.stopTimeline=x.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=x}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),$z()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const iW=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function oW(t){const e=iW.exec(t);if(!e)return[,];const[,r,n,s]=e;return[`--${r??n}`,s]}function w7(t,e,r=1){const[n,s]=oW(t);if(!n)return;const a=window.getComputedStyle(e).getPropertyValue(n);if(a){const i=a.trim();return z9(i)?parseFloat(i):i}return Qk(s)?w7(s,e,r+1):s}function iC(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const _7=new Set(["width","height","top","left","right","bottom",...Xf]),lW={test:t=>t==="auto",parse:t=>t},S7=t=>e=>e.test(t),b7=[Kf,Gt,vo,Pl,Z$,q$,lW],NN=t=>b7.find(S7(t));function cW(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||V9(t):!0}const uW=new Set(["brightness","contrast","saturate","opacity"]);function dW(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(qk)||[];if(!n)return t;const s=r.replace(n,"");let a=uW.has(e)?1:0;return n!==r&&(a*=100),e+"("+a+s+")"}const fW=/\b([a-z-]*)\(.*?\)/gu,ES={...ac,getAnimatableNone:t=>{const e=t.match(fW);return e?e.map(dW).join(" "):t}},AN={...Kf,transform:Math.round},hW={rotate:Pl,rotateX:Pl,rotateY:Pl,rotateZ:Pl,scale:Cp,scaleX:Cp,scaleY:Cp,scaleZ:Cp,skew:Pl,skewX:Pl,skewY:Pl,distance:Gt,translateX:Gt,translateY:Gt,translateZ:Gt,x:Gt,y:Gt,z:Gt,perspective:Gt,transformPerspective:Gt,opacity:eg,originX:pN,originY:pN,originZ:Gt},oC={borderWidth:Gt,borderTopWidth:Gt,borderRightWidth:Gt,borderBottomWidth:Gt,borderLeftWidth:Gt,borderRadius:Gt,radius:Gt,borderTopLeftRadius:Gt,borderTopRightRadius:Gt,borderBottomRightRadius:Gt,borderBottomLeftRadius:Gt,width:Gt,maxWidth:Gt,height:Gt,maxHeight:Gt,top:Gt,right:Gt,bottom:Gt,left:Gt,padding:Gt,paddingTop:Gt,paddingRight:Gt,paddingBottom:Gt,paddingLeft:Gt,margin:Gt,marginTop:Gt,marginRight:Gt,marginBottom:Gt,marginLeft:Gt,backgroundPositionX:Gt,backgroundPositionY:Gt,...hW,zIndex:AN,fillOpacity:eg,strokeOpacity:eg,numOctaves:AN},gW={...oC,color:zn,backgroundColor:zn,outlineColor:zn,fill:zn,stroke:zn,borderColor:zn,borderTopColor:zn,borderRightColor:zn,borderBottomColor:zn,borderLeftColor:zn,filter:ES,WebkitFilter:ES},k7=t=>gW[t];function C7(t,e){let r=k7(t);return r!==ES&&(r=ac),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const mW=new Set(["auto","none","0"]);function pW(t,e,r){let n=0,s;for(;n<t.length&&!s;){const a=t[n];typeof a=="string"&&!mW.has(a)&&tg(a).values.length&&(s=t[n]),n++}if(s&&r)for(const a of e)t[a]=C7(r,s)}class xW extends aC{constructor(e,r,n,s,a){super(e,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),Qk(u))){const d=w7(u,r.current);d!==void 0&&(e[l]=d),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!_7.has(n)||e.length!==2)return;const[s,a]=e,i=NN(s),o=NN(a);if(i!==o)if(kN(i)&&kN(o))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else cu[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let s=0;s<e.length;s++)(e[s]===null||cW(e[s]))&&n.push(s);n.length&&pW(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=cu[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){var o;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const s=e.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=cu[r](e.measureViewportBox(),window.getComputedStyle(e.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function yW(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;const s=(r==null?void 0:r[t])??n.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const T7=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function E7(t){return W9(t)&&"offsetHeight"in t}const FN=30,vW=t=>!isNaN(parseFloat(t));class wW{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var a;const s=pa.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=pa.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=vW(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new Kk);const n=this.events[e].add(r);return e==="change"?()=>{n(),en.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=pa.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>FN)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,FN);return G9(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,r;(e=this.dependents)==null||e.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Nf(t,e){return new wW(t,e)}const{schedule:lC}=r7(queueMicrotask,!1),Ai={x:!1,y:!1};function N7(){return Ai.x||Ai.y}function _W(t){return t==="x"||t==="y"?Ai[t]?null:(Ai[t]=!0,()=>{Ai[t]=!1}):Ai.x||Ai.y?null:(Ai.x=Ai.y=!0,()=>{Ai.x=Ai.y=!1})}function A7(t,e){const r=yW(t),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[r,s,()=>n.abort()]}function jN(t){return!(t.pointerType==="touch"||N7())}function SW(t,e,r={}){const[n,s,a]=A7(t,r),i=o=>{if(!jN(o))return;const{target:l}=o,u=e(l,o);if(typeof u!="function"||!l)return;const d=h=>{jN(h)&&(u(h),l.removeEventListener("pointerleave",d))};l.addEventListener("pointerleave",d,s)};return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const F7=(t,e)=>e?t===e?!0:F7(t,e.parentElement):!1,cC=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,bW=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function kW(t){return bW.has(t.tagName)||t.tabIndex!==-1}const gx=new WeakSet;function PN(t){return e=>{e.key==="Enter"&&t(e)}}function x2(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const CW=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=PN(()=>{if(gx.has(r))return;x2(r,"down");const s=PN(()=>{x2(r,"up")}),a=()=>x2(r,"cancel");r.addEventListener("keyup",s,e),r.addEventListener("blur",a,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function DN(t){return cC(t)&&!N7()}function TW(t,e,r={}){const[n,s,a]=A7(t,r),i=o=>{const l=o.currentTarget;if(!DN(o))return;gx.add(l);const u=e(l,o),d=(x,p)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",m),gx.has(l)&&gx.delete(l),DN(x)&&typeof u=="function"&&u(x,{success:p})},h=x=>{d(x,l===window||l===document||r.useGlobalTarget||F7(l,x.target))},m=x=>{d(x,!1)};window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",m,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),E7(o)&&(o.addEventListener("focus",u=>CW(u,s)),!kW(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function j7(t){return W9(t)&&"ownerSVGElement"in t}function EW(t){return j7(t)&&t.tagName==="svg"}const $s=t=>!!(t&&t.getVelocity),NW=[...b7,zn,ac],AW=t=>NW.find(S7(t)),uC=k.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class FW extends k.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=E7(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function jW({children:t,isPresent:e,anchorX:r,root:n}){const s=k.useId(),a=k.useRef(null),i=k.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=k.useContext(uC);return k.useInsertionEffect(()=>{const{width:l,height:u,top:d,left:h,right:m}=i.current;if(e||!a.current||!l||!u)return;const x=r==="left"?`left: ${h}`:`right: ${m}`;a.current.dataset.motionPopId=s;const p=document.createElement("style");o&&(p.nonce=o);const v=n??document.head;return v.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${u}px !important;
            ${x}px !important;
            top: ${d}px !important;
          }
        `),()=>{v.contains(p)&&v.removeChild(p)}},[e]),c.jsx(FW,{isPresent:e,childRef:a,sizeRef:i,children:k.cloneElement(t,{ref:a})})}const PW=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:o,root:l})=>{const u=$k(DW),d=k.useId();let h=!0,m=k.useMemo(()=>(h=!1,{id:d,initial:e,isPresent:r,custom:s,onExitComplete:x=>{u.set(x,!0);for(const p of u.values())if(!p)return;n&&n()},register:x=>(u.set(x,!1),()=>u.delete(x))}),[r,u,n]);return a&&h&&(m={...m}),k.useMemo(()=>{u.forEach((x,p)=>u.set(p,!1))},[r]),k.useEffect(()=>{!r&&!u.size&&n&&n()},[r]),i==="popLayout"&&(t=c.jsx(jW,{isPresent:r,anchorX:o,root:l,children:t})),c.jsx(oy.Provider,{value:m,children:t})};function DW(){return new Map}function P7(t=!0){const e=k.useContext(oy);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=e,a=k.useId();k.useEffect(()=>{if(t)return s(a)},[t]);const i=k.useCallback(()=>t&&n&&n(a),[a,n,t]);return!r&&n?[!1,i]:[!0]}const Tp=t=>t.key||"";function RN(t){const e=[];return k.Children.forEach(t,r=>{k.isValidElement(r)&&e.push(r)}),e}const ea=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:l})=>{const[u,d]=P7(i),h=k.useMemo(()=>RN(t),[t]),m=i&&!u?[]:h.map(Tp),x=k.useRef(!0),p=k.useRef(h),v=$k(()=>new Map),[_,S]=k.useState(h),[w,y]=k.useState(h);$9(()=>{x.current=!1,p.current=h;for(let N=0;N<w.length;N++){const F=Tp(w[N]);m.includes(F)?v.delete(F):v.get(F)!==!0&&v.set(F,!1)}},[w,m.length,m.join("-")]);const b=[];if(h!==_){let N=[...h];for(let F=0;F<w.length;F++){const T=w[F],P=Tp(T);m.includes(P)||(N.splice(F,0,T),b.push(T))}return a==="wait"&&b.length&&(N=b),y(RN(N)),S(h),null}const{forceRender:E}=k.useContext(Uk);return c.jsx(c.Fragment,{children:w.map(N=>{const F=Tp(N),T=i&&!u?!1:h===w||m.includes(F),P=()=>{if(v.has(F))v.set(F,!0);else return;let D=!0;v.forEach(R=>{R||(D=!1)}),D&&(E==null||E(),y(p.current),i&&(d==null||d()),n&&n())};return c.jsx(PW,{isPresent:T,initial:!x.current||r?void 0:!1,custom:e,presenceAffectsLayout:s,mode:a,root:l,onExitComplete:T?void 0:P,anchorX:o,children:N},F)})})},D7=k.createContext({strict:!1}),ON={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Af={};for(const t in ON)Af[t]={isEnabled:e=>ON[t].some(r=>!!e[r])};function RW(t){for(const e in t)Af[e]={...Af[e],...t[e]}}const OW=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function e1(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||OW.has(t)}let R7=t=>!e1(t);function MW(t){typeof t=="function"&&(R7=e=>e.startsWith("on")?!e1(e):t(e))}try{MW(require("@emotion/is-prop-valid").default)}catch{}function LW(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(R7(s)||r===!0&&e1(s)||!e&&!e1(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}const ly=k.createContext({});function cy(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function rg(t){return typeof t=="string"||Array.isArray(t)}const dC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],fC=["initial",...dC];function uy(t){return cy(t.animate)||fC.some(e=>rg(t[e]))}function O7(t){return!!(uy(t)||t.variants)}function IW(t,e){if(uy(t)){const{initial:r,animate:n}=t;return{initial:r===!1||rg(r)?r:void 0,animate:rg(n)?n:void 0}}return t.inherit!==!1?e:{}}function BW(t){const{initial:e,animate:r}=IW(t,k.useContext(ly));return k.useMemo(()=>({initial:e,animate:r}),[MN(e),MN(r)])}function MN(t){return Array.isArray(t)?t.join(" "):t}const ng={};function UW(t){for(const e in t)ng[e]=t[e],Jk(e)&&(ng[e].isCSSVariable=!0)}function M7(t,{layout:e,layoutId:r}){return Yf.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!ng[t]||t==="opacity")}const $W={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},zW=Xf.length;function WW(t,e,r){let n="",s=!0;for(let a=0;a<zW;a++){const i=Xf[a],o=t[i];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(i.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||r){const u=T7(o,oC[i]);if(!l){s=!1;const d=$W[i]||i;n+=`${d}(${u}) `}r&&(e[i]=u)}}return n=n.trim(),r?n=r(e,s?"":n):s&&(n="none"),n}function hC(t,e,r){const{style:n,vars:s,transformOrigin:a}=t;let i=!1,o=!1;for(const l in e){const u=e[l];if(Yf.has(l)){i=!0;continue}else if(Jk(l)){s[l]=u;continue}else{const d=T7(u,oC[l]);l.startsWith("origin")?(o=!0,a[l]=d):n[l]=d}}if(e.transform||(i||r?n.transform=WW(e,t.transform,r):n.transform&&(n.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:d=0}=a;n.transformOrigin=`${l} ${u} ${d}`}}const gC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function L7(t,e,r){for(const n in e)!$s(e[n])&&!M7(n,r)&&(t[n]=e[n])}function VW({transformTemplate:t},e){return k.useMemo(()=>{const r=gC();return hC(r,e,t),Object.assign({},r.vars,r.style)},[e])}function GW(t,e){const r=t.style||{},n={};return L7(n,r,t),Object.assign(n,VW(t,e)),n}function HW(t,e){const r={},n=GW(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const KW={offset:"stroke-dashoffset",array:"stroke-dasharray"},XW={offset:"strokeDashoffset",array:"strokeDasharray"};function YW(t,e,r=1,n=0,s=!0){t.pathLength=1;const a=s?KW:XW;t[a.offset]=Gt.transform(-n);const i=Gt.transform(e),o=Gt.transform(r);t[a.array]=`${i} ${o}`}function I7(t,{attrX:e,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...o},l,u,d){if(hC(t,o,u),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:m}=t;h.transform&&(m.transform=h.transform,delete h.transform),(m.transform||h.transformOrigin)&&(m.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),m.transform&&(m.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete h.transformBox),e!==void 0&&(h.x=e),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),s!==void 0&&YW(h,s,a,i,!1)}const B7=()=>({...gC(),attrs:{}}),U7=t=>typeof t=="string"&&t.toLowerCase()==="svg";function JW(t,e,r,n){const s=k.useMemo(()=>{const a=B7();return I7(a,e,U7(n),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};L7(a,t.style,t),s.style={...a,...s.style}}return s}const QW=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function mC(t){return typeof t!="string"||t.includes("-")?!1:!!(QW.indexOf(t)>-1||/[A-Z]/u.test(t))}function qW(t,e,r,{latestValues:n},s,a=!1){const o=(mC(t)?JW:HW)(e,n,s,t),l=LW(e,typeof t=="string",a),u=t!==k.Fragment?{...l,...o,ref:r}:{},{children:d}=e,h=k.useMemo(()=>$s(d)?d.get():d,[d]);return k.createElement(t,{...u,children:h})}function LN(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function pC(t,e,r,n){if(typeof e=="function"){const[s,a]=LN(n);e=e(r!==void 0?r:t.custom,s,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,a]=LN(n);e=e(r!==void 0?r:t.custom,s,a)}return e}function mx(t){return $s(t)?t.get():t}function ZW({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,s){return{latestValues:eV(r,n,s,t),renderState:e()}}function eV(t,e,r,n){const s={},a=n(t,{});for(const m in a)s[m]=mx(a[m]);let{initial:i,animate:o}=t;const l=uy(t),u=O7(t);e&&u&&!l&&t.inherit!==!1&&(i===void 0&&(i=e.initial),o===void 0&&(o=e.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const h=d?o:i;if(h&&typeof h!="boolean"&&!cy(h)){const m=Array.isArray(h)?h:[h];for(let x=0;x<m.length;x++){const p=pC(t,m[x]);if(p){const{transitionEnd:v,transition:_,...S}=p;for(const w in S){let y=S[w];if(Array.isArray(y)){const b=d?y.length-1:0;y=y[b]}y!==null&&(s[w]=y)}for(const w in v)s[w]=v[w]}}}return s}const $7=t=>(e,r)=>{const n=k.useContext(ly),s=k.useContext(oy),a=()=>ZW(t,e,n,s);return r?a():$k(a)};function xC(t,e,r){var a;const{style:n}=t,s={};for(const i in n)($s(n[i])||e.style&&$s(e.style[i])||M7(i,t)||((a=r==null?void 0:r.getValue(i))==null?void 0:a.liveStyle)!==void 0)&&(s[i]=n[i]);return s}const tV=$7({scrapeMotionValuesFromProps:xC,createRenderState:gC});function z7(t,e,r){const n=xC(t,e,r);for(const s in t)if($s(t[s])||$s(e[s])){const a=Xf.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=t[s]}return n}const rV=$7({scrapeMotionValuesFromProps:z7,createRenderState:B7}),nV=Symbol.for("motionComponentSymbol");function Yd(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function sV(t,e,r){return k.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):Yd(r)&&(r.current=n))},[e])}const yC=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),aV="framerAppearId",W7="data-"+yC(aV),V7=k.createContext({});function iV(t,e,r,n,s){var v,_;const{visualElement:a}=k.useContext(ly),i=k.useContext(D7),o=k.useContext(oy),l=k.useContext(uC).reducedMotion,u=k.useRef(null);n=n||i.renderer,!u.current&&n&&(u.current=n(t,{visualState:e,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const d=u.current,h=k.useContext(V7);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&oV(u.current,r,s,h);const m=k.useRef(!1);k.useInsertionEffect(()=>{d&&m.current&&d.update(r,o)});const x=r[W7],p=k.useRef(!!x&&!((v=window.MotionHandoffIsComplete)!=null&&v.call(window,x))&&((_=window.MotionHasOptimisedAnimation)==null?void 0:_.call(window,x)));return $9(()=>{d&&(m.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),p.current&&d.animationState&&d.animationState.animateChanges())}),k.useEffect(()=>{d&&(!p.current&&d.animationState&&d.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)==null||S.call(window,x)}),p.current=!1),d.enteringChildren=void 0)}),d}function oV(t,e,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:u,layoutCrossfade:d}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:G7(t.parent)),t.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&Yd(o),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:l,layoutRoot:u})}function G7(t){if(t)return t.options.allowProjection!==!1?t.projection:G7(t.parent)}function y2(t,{forwardMotionProps:e=!1}={},r,n){r&&RW(r);const s=mC(t)?rV:tV;function a(o,l){let u;const d={...k.useContext(uC),...o,layoutId:lV(o)},{isStatic:h}=d,m=BW(o),x=s(o,h);if(!h&&zk){cV();const p=uV(d);u=p.MeasureLayout,m.visualElement=iV(t,x,d,n,p.ProjectionNode)}return c.jsxs(ly.Provider,{value:m,children:[u&&m.visualElement?c.jsx(u,{visualElement:m.visualElement,...d}):null,qW(t,o,sV(x,m.visualElement,l),x,h,e)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const i=k.forwardRef(a);return i[nV]=t,i}function lV({layoutId:t}){const e=k.useContext(Uk).id;return e&&t!==void 0?e+"-"+t:t}function cV(t,e){k.useContext(D7).strict}function uV(t){const{drag:e,layout:r}=Af;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function dV(t,e){if(typeof Proxy>"u")return y2;const r=new Map,n=(a,i)=>y2(a,i,t,e),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,y2(i,void 0,t,e)),r.get(i))})}function H7({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function fV({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function hV(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function v2(t){return t===void 0||t===1}function NS({scale:t,scaleX:e,scaleY:r}){return!v2(t)||!v2(e)||!v2(r)}function Hc(t){return NS(t)||K7(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function K7(t){return IN(t.x)||IN(t.y)}function IN(t){return t&&t!=="0%"}function t1(t,e,r){const n=t-r,s=e*n;return r+s}function BN(t,e,r,n,s){return s!==void 0&&(t=t1(t,s,n)),t1(t,r,n)+e}function AS(t,e=0,r=1,n,s){t.min=BN(t.min,e,r,n,s),t.max=BN(t.max,e,r,n,s)}function X7(t,{x:e,y:r}){AS(t.x,e.translate,e.scale,e.originPoint),AS(t.y,r.translate,r.scale,r.originPoint)}const UN=.999999999999,$N=1.0000000000001;function gV(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:l}=a.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Qd(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(e.x*=i.x.scale,e.y*=i.y.scale,X7(t,i)),n&&Hc(a.latestValues)&&Qd(t,a.latestValues))}e.x<$N&&e.x>UN&&(e.x=1),e.y<$N&&e.y>UN&&(e.y=1)}function Jd(t,e){t.min=t.min+e,t.max=t.max+e}function zN(t,e,r,n,s=.5){const a=ln(t.min,t.max,s);AS(t,e,r,a,n)}function Qd(t,e){zN(t.x,e.x,e.scaleX,e.scale,e.originX),zN(t.y,e.y,e.scaleY,e.scale,e.originY)}function Y7(t,e){return H7(hV(t.getBoundingClientRect(),e))}function mV(t,e,r){const n=Y7(t,r),{scroll:s}=e;return s&&(Jd(n.x,s.offset.x),Jd(n.y,s.offset.y)),n}const WN=()=>({translate:0,scale:1,origin:0,originPoint:0}),qd=()=>({x:WN(),y:WN()}),VN=()=>({min:0,max:0}),Nn=()=>({x:VN(),y:VN()}),FS={current:null},J7={current:!1};function pV(){if(J7.current=!0,!!zk)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>FS.current=t.matches;t.addEventListener("change",e),e()}else FS.current=!1}const xV=new WeakMap;function yV(t,e,r){for(const n in e){const s=e[n],a=r[n];if($s(s))t.addValue(n,s);else if($s(a))t.addValue(n,Nf(s,{owner:t}));else if(a!==s)if(t.hasValue(n)){const i=t.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=t.getStaticValue(n);t.addValue(n,Nf(i!==void 0?i:s,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const GN=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class vV{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=aC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=pa.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,en.render(this.render,!1,!0))};const{latestValues:l,renderState:u}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=uy(r),this.isVariantNode=O7(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const m in h){const x=h[m];l[m]!==void 0&&$s(x)&&x.set(l[m])}}mount(e){var r;this.current=e,xV.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),J7.current||pV(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:FS.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),sc(this.notifyUpdate),sc(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const n=this.features[r];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=Yf.has(e);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[e]=i,this.props.onUpdate&&en.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Af){const r=Af[e];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Nn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<GN.length;n++){const s=GN[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=e[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=yV(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=Nf(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(z9(n)||V9(n))?n=parseFloat(n):!AW(n)&&ac.test(r)&&(n=C7(e,r)),this.setBaseTarget(e,$s(n)?n.get():n)),$s(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var a;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const i=pC(this.props,r,(a=this.presenceContext)==null?void 0:a.custom);i&&(n=i[e])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!$s(s)?s:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new Kk),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){lC.render(this.render)}}class Q7 extends vV{constructor(){super(...arguments),this.KeyframeResolver=xW}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;$s(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function q7(t,{style:e,vars:r},n,s){const a=t.style;let i;for(i in e)a[i]=e[i];s==null||s.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function wV(t){return window.getComputedStyle(t)}class _V extends Q7{constructor(){super(...arguments),this.type="html",this.renderInstance=q7}readValueFromInstance(e,r){var n;if(Yf.has(r))return(n=this.projection)!=null&&n.isProjecting?_S(r):Mz(e,r);{const s=wV(e),a=(Jk(r)?s.getPropertyValue(r):s[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(e,{transformPagePoint:r}){return Y7(e,r)}build(e,r,n){hC(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return xC(e,r,n)}}const Z7=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function SV(t,e,r,n){q7(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(Z7.has(s)?s:yC(s),e.attrs[s])}class bV extends Q7{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Nn}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(Yf.has(r)){const n=k7(r);return n&&n.default||0}return r=Z7.has(r)?r:yC(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return z7(e,r,n)}build(e,r,n){I7(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,s){SV(e,r,n,s)}mount(e){this.isSVGTag=U7(e.tagName),super.mount(e)}}const kV=(t,e)=>mC(t)?new bV(e):new _V(e,{allowProjection:t!==k.Fragment});function uf(t,e,r){const n=t.getProps();return pC(n,e,r!==void 0?r:n.custom,t)}const jS=t=>Array.isArray(t);function CV(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Nf(r))}function TV(t){return jS(t)?t[t.length-1]||0:t}function EV(t,e){const r=uf(t,e);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=TV(a[i]);CV(t,i,o)}}function NV(t){return!!($s(t)&&t.add)}function PS(t,e){const r=t.getValue("willChange");if(NV(r))return r.add(e);if(!r&&ol.WillChange){const n=new ol.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function eP(t){return t.props[W7]}const AV=t=>t!==null;function FV(t,{repeat:e,repeatType:r="loop"},n){const s=t.filter(AV),a=e&&r!=="loop"&&e%2===1?0:s.length-1;return s[a]}const jV={type:"spring",stiffness:500,damping:25,restSpeed:10},PV=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),DV={type:"keyframes",duration:.8},RV={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},OV=(t,{keyframes:e})=>e.length>2?DV:Yf.has(t)?t.startsWith("scale")?PV(e[1]):jV:RV;function MV({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:l,elapsed:u,...d}){return!!Object.keys(d).length}const vC=(t,e,r,n={},s,a)=>i=>{const o=iC(n,t)||{},l=o.delay||n.delay||0;let{elapsed:u=0}=n;u=u-xo(l);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:m=>{e.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:t,motionValue:e,element:a?void 0:s};MV(o)||Object.assign(d,OV(t,d)),d.duration&&(d.duration=xo(d.duration)),d.repeatDelay&&(d.repeatDelay=xo(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let h=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(TS(d),d.delay===0&&(h=!0)),(ol.instantAnimations||ol.skipAnimations)&&(h=!0,TS(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,h&&!a&&e.get()!==void 0){const m=FV(d.keyframes,o);if(m!==void 0){en.update(()=>{d.onUpdate(m),d.onComplete()});return}}return o.isSync?new sC(d):new aW(d)};function LV({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function tP(t,e,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:i,...o}=e;n&&(a=n);const l=[],u=s&&t.animationState&&t.animationState.getState()[s];for(const d in o){const h=t.getValue(d,t.latestValues[d]??null),m=o[d];if(m===void 0||u&&LV(u,d))continue;const x={delay:r,...iC(a||{},d)},p=h.get();if(p!==void 0&&!h.isAnimating&&!Array.isArray(m)&&m===p&&!x.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const S=eP(t);if(S){const w=window.MotionHandoffAnimation(S,d,en);w!==null&&(x.startTime=w,v=!0)}}PS(t,d),h.start(vC(d,h,m,t.shouldReduceMotion&&_7.has(d)?{type:!1}:x,t,v));const _=h.animation;_&&l.push(_)}return i&&Promise.all(l).then(()=>{en.update(()=>{i&&EV(t,i)})}),l}function rP(t,e,r,n=0,s=1){const a=Array.from(t).sort((u,d)=>u.sortNodePosition(d)).indexOf(e),i=t.size,o=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:o-a*n}function DS(t,e,r={}){var l;const n=uf(t,e,r.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(tP(t,n,r)):()=>Promise.resolve(),i=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:m}=s;return IV(t,e,u,d,h,m,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[u,d]=o==="beforeChildren"?[a,i]:[i,a];return u().then(()=>d())}else return Promise.all([a(),i(r.delay)])}function IV(t,e,r=0,n=0,s=0,a=1,i){const o=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),o.push(DS(l,e,{...i,delay:r+(typeof n=="function"?0:n)+rP(t.variantChildren,l,n,s,a)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(o)}function BV(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(a=>DS(t,a,r));n=Promise.all(s)}else if(typeof e=="string")n=DS(t,e,r);else{const s=typeof e=="function"?uf(t,e,r.custom):e;n=Promise.all(tP(t,s,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function nP(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const UV=fC.length;function sP(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?sP(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<UV;r++){const n=fC[r],s=t.props[n];(rg(s)||s===!1)&&(e[n]=s)}return e}const $V=[...dC].reverse(),zV=dC.length;function WV(t){return e=>Promise.all(e.map(({animation:r,options:n})=>BV(t,r,n)))}function VV(t){let e=WV(t),r=HN(),n=!0;const s=l=>(u,d)=>{var m;const h=uf(t,d,l==="exit"?(m=t.presenceContext)==null?void 0:m.custom:void 0);if(h){const{transition:x,transitionEnd:p,...v}=h;u={...u,...v,...p}}return u};function a(l){e=l(t)}function i(l){const{props:u}=t,d=sP(t.parent)||{},h=[],m=new Set;let x={},p=1/0;for(let _=0;_<zV;_++){const S=$V[_],w=r[S],y=u[S]!==void 0?u[S]:d[S],b=rg(y),E=S===l?w.isActive:null;E===!1&&(p=_);let N=y===d[S]&&y!==u[S]&&b;if(N&&n&&t.manuallyAnimateOnMount&&(N=!1),w.protectedKeys={...x},!w.isActive&&E===null||!y&&!w.prevProp||cy(y)||typeof y=="boolean")continue;const F=GV(w.prevProp,y);let T=F||S===l&&w.isActive&&!N&&b||_>p&&b,P=!1;const D=Array.isArray(y)?y:[y];let R=D.reduce(s(S),{});E===!1&&(R={});const{prevResolvedValues:I={}}=w,W={...I,...R},le=K=>{T=!0,m.has(K)&&(P=!0,m.delete(K)),w.needsAnimating[K]=!0;const U=t.getValue(K);U&&(U.liveStyle=!1)};for(const K in W){const U=R[K],L=I[K];if(x.hasOwnProperty(K))continue;let Z=!1;jS(U)&&jS(L)?Z=!nP(U,L):Z=U!==L,Z?U!=null?le(K):m.add(K):U!==void 0&&m.has(K)?le(K):w.protectedKeys[K]=!0}w.prevProp=y,w.prevResolvedValues=R,w.isActive&&(x={...x,...R}),n&&t.blockInitialAnimation&&(T=!1);const q=N&&F;T&&(!q||P)&&h.push(...D.map(K=>{const U={type:S};if(typeof K=="string"&&n&&!q&&t.manuallyAnimateOnMount&&t.parent){const{parent:L}=t,Z=uf(L,K);if(L.enteringChildren&&Z){const{delayChildren:ne}=Z.transition||{};U.delay=rP(L.enteringChildren,t,ne)}}return{animation:K,options:U}}))}if(m.size){const _={};if(typeof u.initial!="boolean"){const S=uf(t,Array.isArray(u.initial)?u.initial[0]:u.initial);S&&S.transition&&(_.transition=S.transition)}m.forEach(S=>{const w=t.getBaseTarget(S),y=t.getValue(S);y&&(y.liveStyle=!0),_[S]=w??null}),h.push({animation:_})}let v=!!h.length;return n&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(v=!1),n=!1,v?e(h):Promise.resolve()}function o(l,u){var h;if(r[l].isActive===u)return Promise.resolve();(h=t.variantChildren)==null||h.forEach(m=>{var x;return(x=m.animationState)==null?void 0:x.setActive(l,u)}),r[l].isActive=u;const d=i(l);for(const m in r)r[m].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=HN(),n=!0}}}function GV(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!nP(e,t):!1}function $c(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function HN(){return{animate:$c(!0),whileInView:$c(),whileHover:$c(),whileTap:$c(),whileDrag:$c(),whileFocus:$c(),exit:$c()}}class yc{constructor(e){this.isMounted=!1,this.node=e}update(){}}class HV extends yc{constructor(e){super(e),e.animationState||(e.animationState=VV(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();cy(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let KV=0;class XV extends yc{constructor(){super(...arguments),this.id=KV++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);r&&!e&&s.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const YV={animation:{Feature:HV},exit:{Feature:XV}};function sg(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function $g(t){return{point:{x:t.pageX,y:t.pageY}}}const JV=t=>e=>cC(e)&&t(e,$g(e));function y0(t,e,r,n){return sg(t,e,JV(r),n)}const aP=1e-4,QV=1-aP,qV=1+aP,iP=.01,ZV=0-iP,eG=0+iP;function ta(t){return t.max-t.min}function tG(t,e,r){return Math.abs(t-e)<=r}function KN(t,e,r,n=.5){t.origin=n,t.originPoint=ln(e.min,e.max,t.origin),t.scale=ta(r)/ta(e),t.translate=ln(r.min,r.max,t.origin)-t.originPoint,(t.scale>=QV&&t.scale<=qV||isNaN(t.scale))&&(t.scale=1),(t.translate>=ZV&&t.translate<=eG||isNaN(t.translate))&&(t.translate=0)}function v0(t,e,r,n){KN(t.x,e.x,r.x,n?n.originX:void 0),KN(t.y,e.y,r.y,n?n.originY:void 0)}function XN(t,e,r){t.min=r.min+e.min,t.max=t.min+ta(e)}function rG(t,e,r){XN(t.x,e.x,r.x),XN(t.y,e.y,r.y)}function YN(t,e,r){t.min=e.min-r.min,t.max=t.min+ta(e)}function w0(t,e,r){YN(t.x,e.x,r.x),YN(t.y,e.y,r.y)}function ri(t){return[t("x"),t("y")]}const oP=({current:t})=>t?t.ownerDocument.defaultView:null,JN=(t,e)=>Math.abs(t-e);function nG(t,e){const r=JN(t.x,e.x),n=JN(t.y,e.y);return Math.sqrt(r**2+n**2)}class lP{constructor(e,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=_2(this.lastMoveEventInfo,this.history),x=this.startEvent!==null,p=nG(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!x&&!p)return;const{point:v}=m,{timestamp:_}=vs;this.history.push({...v,timestamp:_});const{onStart:S,onMove:w}=this.handlers;x||(S&&S(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,m)},this.handlePointerMove=(m,x)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=w2(x,this.transformPagePoint),en.update(this.updatePoint,!0)},this.handlePointerUp=(m,x)=>{this.end();const{onEnd:p,onSessionEnd:v,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=_2(m.type==="pointercancel"?this.lastMoveEventInfo:w2(x,this.transformPagePoint),this.history);this.startEvent&&p&&p(m,S),v&&v(m,S)},!cC(e))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const o=$g(e),l=w2(o,this.transformPagePoint),{point:u}=l,{timestamp:d}=vs;this.history=[{...u,timestamp:d}];const{onSessionStart:h}=r;h&&h(e,_2(l,this.history)),this.removeListeners=Ig(y0(this.contextWindow,"pointermove",this.handlePointerMove),y0(this.contextWindow,"pointerup",this.handlePointerUp),y0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),sc(this.updatePoint)}}function w2(t,e){return e?{point:e(t.point)}:t}function QN(t,e){return{x:t.x-e.x,y:t.y-e.y}}function _2({point:t},e){return{point:t,delta:QN(t,cP(e)),offset:QN(t,sG(e)),velocity:aG(e,.1)}}function sG(t){return t[0]}function cP(t){return t[t.length-1]}function aG(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=cP(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>xo(e)));)r--;if(!n)return{x:0,y:0};const a=yo(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function iG(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?ln(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?ln(r,t,n.max):Math.min(t,r)),t}function qN(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function oG(t,{top:e,left:r,bottom:n,right:s}){return{x:qN(t.x,r,s),y:qN(t.y,e,n)}}function ZN(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function lG(t,e){return{x:ZN(t.x,e.x),y:ZN(t.y,e.y)}}function cG(t,e){let r=.5;const n=ta(t),s=ta(e);return s>n?r=Z0(e.min,e.max-n,t.min):n>s&&(r=Z0(t.min,t.max-s,e.min)),il(0,1,r)}function uG(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const RS=.35;function dG(t=RS){return t===!1?t=0:t===!0&&(t=RS),{x:e5(t,"left","right"),y:e5(t,"top","bottom")}}function e5(t,e,r){return{min:t5(t,e),max:t5(t,r)}}function t5(t,e){return typeof t=="number"?t:t[e]||0}const fG=new WeakMap;class hG{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Nn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=h=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor($g(h).point)},i=(h,m)=>{const{drag:x,dragPropagation:p,onDragStart:v}=this.getProps();if(x&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=_W(x),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ri(S=>{let w=this.getAxisMotionValue(S).get()||0;if(vo.test(w)){const{projection:y}=this.visualElement;if(y&&y.layout){const b=y.layout.layoutBox[S];b&&(w=ta(b)*(parseFloat(w)/100))}}this.originPoint[S]=w}),v&&en.postRender(()=>v(h,m)),PS(this.visualElement,"transform");const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},o=(h,m)=>{this.latestPointerEvent=h,this.latestPanInfo=m;const{dragPropagation:x,dragDirectionLock:p,onDirectionLock:v,onDrag:_}=this.getProps();if(!x&&!this.openDragLock)return;const{offset:S}=m;if(p&&this.currentDirection===null){this.currentDirection=gG(S),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",m.point,S),this.updateAxis("y",m.point,S),this.visualElement.render(),_&&_(h,m)},l=(h,m)=>{this.latestPointerEvent=h,this.latestPanInfo=m,this.stop(h,m),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>ri(h=>{var m;return this.getAnimationState(h)==="paused"&&((m=this.getAxisMotionValue(h).animation)==null?void 0:m.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new lP(e,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:oP(this.visualElement)})}stop(e,r){const n=e||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&en.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!Ep(e,s,this.currentDirection))return;const a=this.getAxisMotionValue(e);let i=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(i=iG(i,this.constraints[e],this.elastic[e])),a.set(i)}resolveConstraints(){var a;const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,s=this.constraints;e&&Yd(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=oG(n.layoutBox,e):this.constraints=!1,this.elastic=dG(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&ri(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=uG(n.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!Yd(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=mV(n,s.root,this.visualElement.getTransformPagePoint());let i=lG(s.layout.layoutBox,a);if(r){const o=r(fV(i));this.hasMutatedConstraints=!!o,o&&(i=H7(o))}return i}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=ri(d=>{if(!Ep(d,r,this.currentDirection))return;let h=l&&l[d]||{};i&&(h={min:0,max:0});const m=s?200:1e6,x=s?40:1e7,p={type:"inertia",velocity:n?e[d]:0,bounceStiffness:m,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...a,...h};return this.startAxisValueAnimation(d,p)});return Promise.all(u).then(o)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return PS(this.visualElement,e),n.start(vC(e,n,0,r,this.visualElement,!1))}stopAnimation(){ri(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ri(e=>{var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){ri(r=>{const{drag:n}=this.getProps();if(!Ep(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(e[r]-ln(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Yd(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ri(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const l=o.get();s[i]=cG({min:l,max:l},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ri(i=>{if(!Ep(i,e,null))return;const o=this.getAxisMotionValue(i),{min:l,max:u}=this.constraints[i];o.set(ln(l,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;fG.set(this.visualElement,this);const e=this.visualElement.current,r=y0(e,"pointerdown",l=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();Yd(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),en.read(n);const i=sg(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(ri(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=l[d].translate,h.set(h.get()+l[d].translate))}),this.visualElement.render())});return()=>{i(),r(),a(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=RS,dragMomentum:o=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function Ep(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function gG(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class mG extends yc{constructor(e){super(e),this.removeGroupControls=fi,this.removeListeners=fi,this.controls=new hG(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||fi}unmount(){this.removeGroupControls(),this.removeListeners()}}const r5=t=>(e,r)=>{t&&en.postRender(()=>t(e,r))};class pG extends yc{constructor(){super(...arguments),this.removePointerDownListener=fi}onPointerDown(e){this.session=new lP(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:oP(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:r5(e),onStart:r5(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&en.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=y0(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const px={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function n5(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Uh={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Gt.test(t))t=parseFloat(t);else return t;const r=n5(t,e.target.x),n=n5(t,e.target.y);return`${r}% ${n}%`}},xG={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=ac.parse(t);if(s.length>5)return n;const a=ac.createTransformer(t),i=typeof s[0]!="number"?1:0,o=r.x.scale*e.x,l=r.y.scale*e.y;s[0+i]/=o,s[1+i]/=l;const u=ln(o,l,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),a(s)}};let S2=!1;class yG extends k.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=e;UW(vG),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),S2&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),px.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,S2=!0,s||e.layoutDependency!==r||r===void 0||e.isPresent!==a?i.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?i.promote():i.relegate()||en.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),lC.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;S2=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function uP(t){const[e,r]=P7(),n=k.useContext(Uk);return c.jsx(yG,{...t,layoutGroup:n,switchLayoutGroup:k.useContext(V7),isPresent:e,safeToRemove:r})}const vG={borderRadius:{...Uh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Uh,borderTopRightRadius:Uh,borderBottomLeftRadius:Uh,borderBottomRightRadius:Uh,boxShadow:xG};function wG(t,e,r){const n=$s(t)?t:Nf(t);return n.start(vC("",n,e,r)),n.animation}const _G=(t,e)=>t.depth-e.depth;class SG{constructor(){this.children=[],this.isDirty=!1}add(e){Wk(this.children,e),this.isDirty=!0}remove(e){Vk(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(_G),this.isDirty=!1,this.children.forEach(e)}}function bG(t,e){const r=pa.now(),n=({timestamp:s})=>{const a=s-r;a>=e&&(sc(n),t(a-e))};return en.setup(n,!0),()=>sc(n)}const dP=["TopLeft","TopRight","BottomLeft","BottomRight"],kG=dP.length,s5=t=>typeof t=="string"?parseFloat(t):t,a5=t=>typeof t=="number"||Gt.test(t);function CG(t,e,r,n,s,a){s?(t.opacity=ln(0,r.opacity??1,TG(n)),t.opacityExit=ln(e.opacity??1,0,EG(n))):a&&(t.opacity=ln(e.opacity??1,r.opacity??1,n));for(let i=0;i<kG;i++){const o=`border${dP[i]}Radius`;let l=i5(e,o),u=i5(r,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||a5(l)===a5(u)?(t[o]=Math.max(ln(s5(l),s5(u),n),0),(vo.test(u)||vo.test(l))&&(t[o]+="%")):t[o]=u}(e.rotate||r.rotate)&&(t.rotate=ln(e.rotate||0,r.rotate||0,n))}function i5(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const TG=fP(0,.5,q9),EG=fP(.5,.95,fi);function fP(t,e,r){return n=>n<t?0:n>e?1:r(Z0(t,e,n))}function o5(t,e){t.min=e.min,t.max=e.max}function Ja(t,e){o5(t.x,e.x),o5(t.y,e.y)}function l5(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function c5(t,e,r,n,s){return t-=e,t=t1(t,1/r,n),s!==void 0&&(t=t1(t,1/s,n)),t}function NG(t,e=0,r=1,n=.5,s,a=t,i=t){if(vo.test(e)&&(e=parseFloat(e),e=ln(i.min,i.max,e/100)-i.min),typeof e!="number")return;let o=ln(a.min,a.max,n);t===a&&(o-=e),t.min=c5(t.min,e,r,o,s),t.max=c5(t.max,e,r,o,s)}function u5(t,e,[r,n,s],a,i){NG(t,e[r],e[n],e[s],e.scale,a,i)}const AG=["x","scaleX","originX"],FG=["y","scaleY","originY"];function d5(t,e,r,n){u5(t.x,e,AG,r?r.x:void 0,n?n.x:void 0),u5(t.y,e,FG,r?r.y:void 0,n?n.y:void 0)}function f5(t){return t.translate===0&&t.scale===1}function hP(t){return f5(t.x)&&f5(t.y)}function h5(t,e){return t.min===e.min&&t.max===e.max}function jG(t,e){return h5(t.x,e.x)&&h5(t.y,e.y)}function g5(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function gP(t,e){return g5(t.x,e.x)&&g5(t.y,e.y)}function m5(t){return ta(t.x)/ta(t.y)}function p5(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class PG{constructor(){this.members=[]}add(e){Wk(this.members,e),e.scheduleRender()}remove(e){if(Vk(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function DG(t,e,r){let n="";const s=t.x.translate/e.x,a=t.y.translate/e.y,i=(r==null?void 0:r.z)||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:h,rotateY:m,skewX:x,skewY:p}=r;u&&(n=`perspective(${u}px) ${n}`),d&&(n+=`rotate(${d}deg) `),h&&(n+=`rotateX(${h}deg) `),m&&(n+=`rotateY(${m}deg) `),x&&(n+=`skewX(${x}deg) `),p&&(n+=`skewY(${p}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(n+=`scale(${o}, ${l})`),n||"none"}const b2=["","X","Y","Z"],RG=1e3;let OG=0;function k2(t,e,r,n){const{latestValues:s}=e;s[t]&&(r[t]=s[t],e.setStaticValue(t,0),n&&(n[t]=0))}function mP(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=eP(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",en,!(s||a))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&mP(n)}function pP({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=e==null?void 0:e()){this.id=OG++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(IG),this.nodes.forEach(zG),this.nodes.forEach(WG),this.nodes.forEach(BG)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new SG)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new Kk),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const l=this.eventHandlers.get(i);l&&l.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=j7(i)&&!EW(i),this.instance=i;const{layoutId:o,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),t){let d,h=0;const m=()=>this.root.updateBlockedByResize=!1;en.read(()=>{h=window.innerWidth}),t(i,()=>{const x=window.innerWidth;x!==h&&(h=x,this.root.updateBlockedByResize=!0,d&&d(),d=bG(m,250),px.hasAnimatedSinceResize&&(px.hasAnimatedSinceResize=!1,this.nodes.forEach(v5)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||l)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeLayoutChanged:m,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||u.getDefaultTransition()||XG,{onLayoutAnimationStart:v,onLayoutAnimationComplete:_}=u.getProps(),S=!this.targetLayout||!gP(this.targetLayout,x),w=!h&&m;if(this.options.layoutRoot||this.resumeFrom||w||h&&(S||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...iC(p,"layout"),onPlay:v,onComplete:_};(u.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(d,w)}else h||v5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),sc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(VG),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&mP(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(x5);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(y5);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach($G),this.nodes.forEach(MG),this.nodes.forEach(LG)):this.nodes.forEach(y5),this.clearAllSnapshots();const o=pa.now();vs.delta=il(0,1e3/60,o-vs.timestamp),vs.timestamp=o,vs.isProcessing=!0,f2.update.process(vs),f2.preRender.process(vs),f2.render.process(vs),vs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,lC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(UG),this.sharedNodes.forEach(GG)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,en.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){en.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ta(this.snapshot.measuredBox.x)&&!ta(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Nn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!hP(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(o||Hc(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return i&&(l=this.removeTransform(l)),YG(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:i}=this.options;if(!i)return Nn();const o=i.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(JG))){const{scroll:d}=this.root;d&&(Jd(o.x,d.offset.x),Jd(o.y,d.offset.y))}return o}removeElementScroll(i){var l;const o=Nn();if(Ja(o,i),(l=this.scroll)!=null&&l.wasRoot)return o;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:m}=d;d!==this.root&&h&&m.layoutScroll&&(h.wasRoot&&Ja(o,i),Jd(o.x,h.offset.x),Jd(o.y,h.offset.y))}return o}applyTransform(i,o=!1){const l=Nn();Ja(l,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Qd(l,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Hc(d.latestValues)&&Qd(l,d.latestValues)}return Hc(this.latestValues)&&Qd(l,this.latestValues),l}removeTransform(i){const o=Nn();Ja(o,i);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Hc(u.latestValues))continue;NS(u.latestValues)&&u.updateSnapshot();const d=Nn(),h=u.measurePageBox();Ja(d,h),d5(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Hc(this.latestValues)&&d5(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==vs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var m;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(i||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=vs.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Nn(),this.relativeTargetOrigin=Nn(),w0(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Ja(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Nn(),this.targetWithTransforms=Nn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),rG(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ja(this.target,this.layout.layoutBox),X7(this.target,this.targetDelta)):Ja(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Nn(),this.relativeTargetOrigin=Nn(),w0(this.relativeTargetOrigin,this.target,x.target),Ja(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||NS(this.parent.latestValues)||K7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var p;const i=this.getLead(),o=!!this.resumingFrom||this!==i;let l=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===vs.timestamp&&(l=!1),l)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;Ja(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;gV(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Nn());const{target:x}=i;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(l5(this.prevProjectionDelta.x,this.projectionDelta.x),l5(this.prevProjectionDelta.y,this.projectionDelta.y)),v0(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==m||!p5(this.projectionDelta.x,this.prevProjectionDelta.x)||!p5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=qd(),this.projectionDelta=qd(),this.projectionDeltaWithTransform=qd()}setAnimationOrigin(i,o=!1){const l=this.snapshot,u=l?l.latestValues:{},d={...this.latestValues},h=qd();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=Nn(),x=l?l.source:void 0,p=this.layout?this.layout.source:void 0,v=x!==p,_=this.getStack(),S=!_||_.members.length<=1,w=!!(v&&!S&&this.options.crossfade===!0&&!this.path.some(KG));this.animationProgress=0;let y;this.mixTargetDelta=b=>{const E=b/1e3;w5(h.x,i.x,E),w5(h.y,i.y,E),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(w0(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),HG(this.relativeTarget,this.relativeTargetOrigin,m,E),y&&jG(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=Nn()),Ja(y,this.relativeTarget)),v&&(this.animationValues=d,CG(d,u,this.latestValues,E,w,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){var o,l,u;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(u=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||u.stop(),this.pendingAnimation&&(sc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=en.update(()=>{px.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Nf(0)),this.currentAnimation=wG(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),i.onUpdate&&i.onUpdate(d)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(RG),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:d}=i;if(!(!o||!l||!u)){if(this!==i&&this.layout&&u&&xP(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||Nn();const h=ta(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+h;const m=ta(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+m}Ja(o,l),Qd(o,d),v0(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new PG),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var o;const{layoutId:i}=this.options;return i?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:i}=this.options;return i?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&k2("z",i,u,this.animationValues);for(let d=0;d<b2.length;d++)k2(`rotate${b2[d]}`,i,u,this.animationValues),k2(`skew${b2[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=mx(o==null?void 0:o.pointerEvents)||"",i.transform=l?l(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=mx(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Hc(this.latestValues)&&(i.transform=l?l({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let h=DG(this.projectionDeltaWithTransform,this.treeScale,d);l&&(h=l(d,h)),i.transform=h;const{x:m,y:x}=this.projectionDelta;i.transformOrigin=`${m.origin*100}% ${x.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const p in ng){if(d[p]===void 0)continue;const{correct:v,applyTo:_,isCSSVariable:S}=ng[p],w=h==="none"?d[p]:v(d[p],u);if(_){const y=_.length;for(let b=0;b<y;b++)i[_[b]]=w}else S?this.options.visualElement.renderState.vars[p]=w:i[p]=w}this.options.layoutId&&(i.pointerEvents=u===this?mx(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var o;return(o=i.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(x5),this.root.sharedNodes.clear()}}}function MG(t){t.updateLayout()}function LG(t){var r;const e=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=t.layout,{animationType:a}=t.options,i=e.source!==t.layout.source;a==="size"?ri(h=>{const m=i?e.measuredBox[h]:e.layoutBox[h],x=ta(m);m.min=n[h].min,m.max=m.min+x}):xP(a,e.layoutBox,n)&&ri(h=>{const m=i?e.measuredBox[h]:e.layoutBox[h],x=ta(n[h]);m.max=m.min+x,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+x)});const o=qd();v0(o,n,e.layoutBox);const l=qd();i?v0(l,t.applyTransform(s,!0),e.measuredBox):v0(l,n,e.layoutBox);const u=!hP(o);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:m,layout:x}=h;if(m&&x){const p=Nn();w0(p,e.layoutBox,m.layoutBox);const v=Nn();w0(v,n,x.layoutBox),gP(p,v)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=v,t.relativeTargetOrigin=p,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function IG(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function BG(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function UG(t){t.clearSnapshot()}function x5(t){t.clearMeasurements()}function y5(t){t.isLayoutDirty=!1}function $G(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function v5(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function zG(t){t.resolveTargetDelta()}function WG(t){t.calcProjection()}function VG(t){t.resetSkewAndRotation()}function GG(t){t.removeLeadSnapshot()}function w5(t,e,r){t.translate=ln(e.translate,0,r),t.scale=ln(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function _5(t,e,r,n){t.min=ln(e.min,r.min,n),t.max=ln(e.max,r.max,n)}function HG(t,e,r,n){_5(t.x,e.x,r.x,n),_5(t.y,e.y,r.y,n)}function KG(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const XG={duration:.45,ease:[.4,0,.1,1]},S5=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),b5=S5("applewebkit/")&&!S5("chrome/")?Math.round:fi;function k5(t){t.min=b5(t.min),t.max=b5(t.max)}function YG(t){k5(t.x),k5(t.y)}function xP(t,e,r){return t==="position"||t==="preserve-aspect"&&!tG(m5(e),m5(r),.2)}function JG(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const QG=pP({attachResizeListener:(t,e)=>sg(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),C2={current:void 0},yP=pP({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!C2.current){const t=new QG({});t.mount(window),t.setOptions({layoutScroll:!0}),C2.current=t}return C2.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),qG={pan:{Feature:pG},drag:{Feature:mG,ProjectionNode:yP,MeasureLayout:uP}};function C5(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&en.postRender(()=>a(e,$g(e)))}class ZG extends yc{mount(){const{current:e}=this.node;e&&(this.unmount=SW(e,(r,n)=>(C5(this.node,n,"Start"),s=>C5(this.node,s,"End"))))}unmount(){}}class eH extends yc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ig(sg(this.node.current,"focus",()=>this.onFocus()),sg(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function T5(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&en.postRender(()=>a(e,$g(e)))}class tH extends yc{mount(){const{current:e}=this.node;e&&(this.unmount=TW(e,(r,n)=>(T5(this.node,n,"Start"),(s,{success:a})=>T5(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const OS=new WeakMap,T2=new WeakMap,rH=t=>{const e=OS.get(t.target);e&&e(t)},nH=t=>{t.forEach(rH)};function sH({root:t,...e}){const r=t||document;T2.has(r)||T2.set(r,{});const n=T2.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(nH,{root:t,...e})),n[s]}function aH(t,e,r){const n=sH(e);return OS.set(t,r),n.observe(t),()=>{OS.delete(t),n.unobserve(t)}}const iH={some:0,all:1};class oH extends yc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=e,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:iH[s]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),m=u?d:h;m&&m(l)};return aH(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(lH(e,r))&&this.startObserver()}unmount(){}}function lH({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const cH={inView:{Feature:oH},tap:{Feature:tH},focus:{Feature:eH},hover:{Feature:ZG}},uH={layout:{ProjectionNode:yP,MeasureLayout:uP}},dH={...YV,...cH,...qG,...uH},Me=dV(dH,kV),Ge=({children:t,variant:e="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const o="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",l={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},u={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg"},d=s?"opacity-50 cursor-not-allowed":"";return c.jsx(Me.button,{className:`${o} ${l[e]} ${u[r]} ${d} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:t})},dr=({size:t="md",color:e="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return c.jsx(Me.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[t]} ${s[e]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},_o=({type:t="info",message:e="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[o,l]=k.useState(!0),[u,d]=k.useState(!1),h=k.useRef(null),m=k.useRef(null);k.useEffect(()=>{if(r>0)return m.current=setTimeout(()=>{x()},r),()=>{m.current&&clearTimeout(m.current)}},[r]);const x=k.useCallback(()=>{u||(d(!0),m.current&&clearTimeout(m.current),setTimeout(()=>{l(!1),s&&s()},300))},[u,s]),p=k.useCallback(S=>{S.key==="Escape"&&x()},[x]);if(!o)return null;const v=["notification",`notification-${t}`,o?"notification-visible":"",u?"notification-exiting":"",a].filter(Boolean).join(" "),_=()=>{switch(t){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}};return c.jsx("div",{ref:h,className:v,role:"alert","aria-live":"polite",onKeyDown:p,tabIndex:-1,...i,children:c.jsxs("div",{className:"notification-content",children:[c.jsx("div",{className:"notification-icon","aria-hidden":"true",children:_()}),c.jsx("div",{className:"notification-body",children:c.jsx("div",{className:"notification-message",children:e})}),n&&c.jsx("button",{className:"notification-close",onClick:x,type:"button","aria-label":"Close notification",children:""})]})})},ka=()=>{const[t,e]=k.useState([]),r=k.useCallback((a,i="info",o={})=>{const l=Date.now()+Math.random(),u={id:l,message:a,type:i,...o};return e(d=>[...d,u]),o.duration!==0&&setTimeout(()=>{n(l)},o.duration||3e3),l},[]),n=k.useCallback(a=>{e(i=>i.filter(o=>o.id!==a))},[]),s=k.useCallback(()=>{e([])},[]);return{notifications:t,showNotification:r,removeNotification:n,clearAllNotifications:s}},E2={enhanceUserData(t,e){const r={id:t.id||t.student_id||t.teacher_id,username:t.username||t.student_id,name:t.name||t.first_name,surname:t.surname||t.last_name,nickname:t.nickname,role:e,is_active:t.is_active!==void 0?t.is_active:!0,created_at:t.created_at,updated_at:t.updated_at};switch(e){case"student":return{...r,student_id:t.student_id,grade:t.grade,class:t.class,number:t.number,subjects:t.subjects||[]};case"teacher":return{...r,teacher_id:t.teacher_id,first_name:t.first_name,last_name:t.last_name,email:t.email,phone:t.phone,subjects:t.subjects||[]};case"admin":return{...r,admin_id:t.admin_id,permissions:t.permissions||["all"]};default:return r}},async studentLogin(t){console.log("Trying student login...");try{const e=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:t.username,password:t.password})}),r=await e.json();if(e.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:e};throw new Error(r.message||"Student login failed")}catch(e){throw console.error("Student login error:",e),new Error(e.message||"Student login failed")}},async teacherLogin(t){console.log("Trying teacher login...");try{const e=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await e.json();if(e.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:e};throw new Error(r.message||"Teacher login failed")}catch(e){throw console.error("Teacher login error:",e),new Error(e.message||"Teacher login failed")}},async adminLogin(t){console.log("Trying admin login...");try{const e=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await e.json();if(e.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:e};throw new Error(r.message||"Admin login failed")}catch(e){throw console.error("Admin login error:",e),new Error(e.message||"Admin login failed")}},async login(t){const{username:e,password:r}=t;console.log("Attempting login with:",e,r);try{if(e==="admin"){const o=await this.adminLogin(t),l=await o.json();return await this.handleLoginResponse(o,"admin",l)}const n=await this.teacherLogin(t),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(t),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(t,e,r){if(t.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,e),{success:!0,data:r,role:e}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(t,e){console.log(`Handling post-login actions for role: ${e}`);try{switch(e){case"student":t.student&&(this.populateStudentInfo(t.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":t.teacher&&(this.populateTeacherInfo(t.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":t.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${e}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const t=document.getElementById("unifiedLoginForm");if(t){t.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=t.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),t.classList.remove("test-submitting","disabled"),t.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log(" Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log(" Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(t){return console.error("Logout error:",t),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log(" Interface reset to login state")}catch(t){console.error("Error resetting interface:",t),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(t){var e,r;try{return{success:!0,message:(await pn.post("/auth/change-password",{currentPassword:t.currentPassword,newPassword:t.newPassword,confirmPassword:t.confirmPassword})).data.message}}catch(n){throw new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||"Password change failed")}},async verifyToken(t){try{const e=await pn.get("/auth/verify",{headers:{Authorization:`Bearer ${t}`}});return{success:!0,valid:e.data.valid,user:e.data.user}}catch(e){return{success:!1,valid:!1,error:e.message}}},async refreshToken(t){var e,r;try{const n=await pn.post("/auth/refresh",{refreshToken:t});return{success:!0,token:n.data.token,refreshToken:n.data.refreshToken}}catch(n){throw new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||"Token refresh failed")}},async getUserProfile(){var t,e;try{return{success:!0,user:(await pn.get("/auth/profile")).data.user}}catch(r){throw new Error(((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to get user profile")}},async updateUserProfile(t){var e,r;try{return{success:!0,user:(await pn.put("/auth/profile",t)).data.user}}catch(n){throw new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||"Failed to update user profile")}},populateStudentInfo(t){console.log("=== populateStudentInfo called ==="),console.log("Student object:",t);const e=document.getElementById("studentName");if(e){const s=`${(t==null?void 0:t.name)||""} ${(t==null?void 0:t.surname)||""}`.trim();e.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=(t==null?void 0:t.grade)||"",console.log("Set student grade to:",t==null?void 0:t.grade));const n=document.getElementById("studentClass");n&&(n.textContent=(t==null?void 0:t.class)||"",console.log("Set student class to:",t==null?void 0:t.class)),console.log("Student info populated successfully")},populateTeacherInfo(t){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",t);const e=document.getElementById("teacherName");if(e){const n=`${(t==null?void 0:t.name)||""} ${(t==null?void 0:t.surname)||""}`.trim();e.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=(t==null?void 0:t.username)||"",console.log("Set teacher username to:",t==null?void 0:t.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const t=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return t&&t.sub?t.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${t.sub}`),t.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${t.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(t){return console.error("[ERROR] Error getting current teacher ID from JWT:",t),null}},getCurrentAdmin(){var r;const t=(r=window.tokenManager)==null?void 0:r.getToken();if(!t)return null;const e=window.tokenManager.decodeToken(t);if(!e||e.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:e.sub,username:e.username,role:e.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const t=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return t&&t.username?(console.log(`[DEBUG] Found teacher username from JWT: ${t.username}`),t.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(t){return console.error("[ERROR] Error getting current teacher username from JWT:",t),null}},isAdmin(){var t;try{const e=(t=window.tokenManager)==null?void 0:t.getToken();if(!e)return!1;const r=window.tokenManager.decodeToken(e);return r&&r.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const t=this.getCurrentAdmin();return t?t.id:null}catch(t){return console.error("[ERROR] Error getting admin ID:",t),null}}},fl=()=>{const[t,e]=k.useState(!1),[r,n]=k.useState(null),[s,a]=k.useState(null),i=k.useRef(null);k.useRef(new Map);const o=k.useRef(0),l=3,u=1e3,d=k.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);k.useEffect(()=>d,[d]);const h=k.useCallback(async(V,K={})=>{try{e(!0),n(null),i.current=new AbortController;const U=K.method||"POST",L={method:U,headers:{"Content-Type":"application/json",...K.headers},signal:i.current.signal,...K};U!=="GET"&&U!=="HEAD"&&(L.body=JSON.stringify(K.data||{})),console.log(`[API] Making request to: ${V}`,L);const Z=await fetch(V,L);if(!Z.ok)throw new Error(`HTTP error! status: ${Z.status}`);const ne=await Z.json();if(console.log("[API] Response received:",ne),ne.success)return a(ne),o.current=0,ne;throw new Error(ne.error||ne.message||"Request failed")}catch(U){if(U.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",U),n(U.message||"Request failed"),o.current<l){o.current++;const L=u*Math.pow(2,o.current-1);return console.log(`[API] Retrying in ${L}ms (attempt ${o.current}/${l})`),await new Promise(Z=>setTimeout(Z,L)),h(V,K)}throw U}finally{e(!1),i.current=null}},[]),m=k.useCallback(async(V,K={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(V,K)}catch(U){throw console.error("[API] Authenticated request failed:",U),U}},[]),x=k.useCallback(async(V,K)=>{try{const U=`/.netlify/functions/get-test-questions?test_type=${V}&test_id=${K}`;console.log(`[API] Getting test info for ${V}_${K}`);const Z=await(await m(U)).json();if(Z.success)return console.log("[API] Test info retrieved successfully:",Z.test_info),Z.test_info;throw new Error(Z.error||"Failed to get test info")}catch(U){throw console.error("[API] Failed to get test info:",U),U}},[m]),p=k.useCallback(async(V,K)=>{try{const U=`/.netlify/functions/get-test-questions?test_type=${V}&test_id=${K}`;console.log(`[API] Getting test questions for ${V}_${K}`);const Z=await(await m(U)).json();if(Z.success)return console.log("[API] Test questions retrieved successfully:",Z.questions),Z.questions;throw new Error(Z.error||"Failed to get test questions")}catch(U){throw console.error("[API] Failed to get test questions:",U),U}},[m]),v=k.useCallback(async()=>{try{const V="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const U=await(await m(V)).json();if(U.success)return console.log("[API] Student active tests loaded successfully:",U.tests),U.tests;throw new Error(U.error||"Failed to load student active tests")}catch(V){throw console.error("[API] Failed to load student active tests:",V),V}},[m]),_=k.useCallback(async(V,K,U)=>{try{let L;switch(V){case"true_false":L="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":L="/.netlify/functions/submit-multiple-choice-test";break;case"input":L="/.netlify/functions/submit-input-test";break;case"matching_type":L="/.netlify/functions/submit-matching-type-test";break;default:throw new Error(`Unknown test type: ${V}`)}console.log(`[API] Submitting ${V} test:`,U);const ne=await(await m(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)})).json();if(ne.success)return console.log("[API] Test submitted successfully:",ne),ne;throw new Error(ne.error||"Failed to submit test")}catch(L){throw console.error("[API] Failed to submit test:",L),L}},[m]),S=k.useCallback(async V=>{try{const K="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",V);const L=await(await m(K,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)})).json();if(L.success)return console.log("[API] Multiple choice test saved successfully:",L),L;throw new Error(L.error||"Failed to save multiple choice test")}catch(K){throw console.error("[API] Failed to save multiple choice test:",K),K}},[m]),w=k.useCallback(async V=>{try{const K="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",V);const L=await(await m(K,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)})).json();if(L.success)return console.log("[API] True/false test saved successfully:",L),L;throw new Error(L.error||"Failed to save true/false test")}catch(K){throw console.error("[API] Failed to save true/false test:",K),K}},[m]),y=k.useCallback(async V=>{try{const K="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",V);const L=await(await m(K,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)})).json();if(L.success)return console.log("[API] Input test saved successfully:",L),L;throw new Error(L.error||"Failed to save input test")}catch(K){throw console.error("[API] Failed to save input test:",K),K}},[m]),b=k.useCallback(async V=>{try{const K="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",V);const L=await(await m(K,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)})).json();if(L.success)return console.log("[API] Test assigned successfully:",L),L;throw new Error(L.error||"Failed to assign test")}catch(K){throw console.error("[API] Failed to assign test:",K),K}},[m]),E=k.useCallback(async()=>{try{const V="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const U=await(await m(V)).json();if(U.success)return console.log("[API] Teacher active tests loaded successfully:",U.tests),U.tests;throw new Error(U.error||"Failed to load teacher active tests")}catch(V){throw console.error("[API] Failed to load teacher active tests:",V),V}},[m]),N=k.useCallback(async()=>{try{const V="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const U=await(await m(V)).json();if(U.success)return console.log("[API] All users loaded successfully:",U.users),U.users;throw new Error(U.error||"Failed to get all users")}catch(V){throw console.error("[API] Failed to get all users:",V),V}},[m]),F=k.useCallback(async()=>{try{const V="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const U=await(await m(V)).json();if(U.success)return console.log("[API] All teachers loaded successfully:",U.teachers),U.teachers;throw new Error(U.error||"Failed to get all teachers")}catch(V){throw console.error("[API] Failed to get all teachers:",V),V}},[m]),T=k.useCallback(async()=>{try{const V="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const U=await(await m(V)).json();if(U.success)return console.log("[API] All subjects loaded successfully:",U.subjects),U.subjects;throw new Error(U.error||"Failed to get all subjects")}catch(V){throw console.error("[API] Failed to get all subjects:",V),V}},[m]),P=k.useCallback(()=>{n(null)},[]),D=k.useCallback(()=>{a(null)},[]),R=k.useCallback(()=>{e(!1),n(null),a(null),o.current=0,d()},[d]),I=k.useCallback(async(V,K={})=>{const L=await(await m(V,{...K,method:"GET"})).json();if(L.success)return L;throw new Error(L.error||"Request failed")},[m]),W=k.useCallback(async(V,K,U={})=>{const Z=await(await m(V,{...U,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)})).json();if(Z.success)return Z;throw new Error(Z.error||"Request failed")},[m]),le=k.useCallback(async(V,K,U={})=>{const Z=await(await m(V,{...U,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)})).json();if(Z.success)return Z;throw new Error(Z.error||"Request failed")},[m]),q=k.useCallback(async(V,K={})=>{const L=await(await m(V,{...K,method:"DELETE"})).json();if(L.success)return L;throw new Error(L.error||"Request failed")},[m]);return{loading:t,error:r,data:s,sendRequest:h,makeAuthenticatedRequest:m,get:I,post:W,put:le,delete:q,getTestInfo:x,getTestQuestions:p,loadStudentActiveTests:v,submitTest:_,saveMultipleChoiceTest:S,saveTrueFalseTest:w,saveInputTest:y,assignTestToClasses:b,loadTeacherActiveTests:E,getAllUsers:N,getAllTeachers:F,getAllSubjects:T,clearError:P,clearData:D,reset:R,cleanup:d}},fH="modulepreload",hH=function(t){return"/"+t},E5={},xx=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=hH(l),l in E5)return;E5[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":fH,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((m,x)=>{h.addEventListener("load",m),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})};var wC={exports:{}},dy={},r1={},ar={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Tx<"u"?Tx:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return t.Konva.angleDeg?s*e:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var s;return(s=t.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(s){t.glob.Konva=s}};const n=s=>{t.Konva[s.prototype.getClassName()]=s};t._registerNode=n,t.Konva._injectGlobal(t.Konva)})(ar);var mn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=ar;class r{constructor(b=[1,0,0,1,0,0]){this.dirty=!1,this.m=b&&b.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(b){b.m[0]=this.m[0],b.m[1]=this.m[1],b.m[2]=this.m[2],b.m[3]=this.m[3],b.m[4]=this.m[4],b.m[5]=this.m[5]}point(b){const E=this.m;return{x:E[0]*b.x+E[2]*b.y+E[4],y:E[1]*b.x+E[3]*b.y+E[5]}}translate(b,E){return this.m[4]+=this.m[0]*b+this.m[2]*E,this.m[5]+=this.m[1]*b+this.m[3]*E,this}scale(b,E){return this.m[0]*=b,this.m[1]*=b,this.m[2]*=E,this.m[3]*=E,this}rotate(b){const E=Math.cos(b),N=Math.sin(b),F=this.m[0]*E+this.m[2]*N,T=this.m[1]*E+this.m[3]*N,P=this.m[0]*-N+this.m[2]*E,D=this.m[1]*-N+this.m[3]*E;return this.m[0]=F,this.m[1]=T,this.m[2]=P,this.m[3]=D,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(b,E){const N=this.m[0]+this.m[2]*E,F=this.m[1]+this.m[3]*E,T=this.m[2]+this.m[0]*b,P=this.m[3]+this.m[1]*b;return this.m[0]=N,this.m[1]=F,this.m[2]=T,this.m[3]=P,this}multiply(b){const E=this.m[0]*b.m[0]+this.m[2]*b.m[1],N=this.m[1]*b.m[0]+this.m[3]*b.m[1],F=this.m[0]*b.m[2]+this.m[2]*b.m[3],T=this.m[1]*b.m[2]+this.m[3]*b.m[3],P=this.m[0]*b.m[4]+this.m[2]*b.m[5]+this.m[4],D=this.m[1]*b.m[4]+this.m[3]*b.m[5]+this.m[5];return this.m[0]=E,this.m[1]=N,this.m[2]=F,this.m[3]=T,this.m[4]=P,this.m[5]=D,this}invert(){const b=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),E=this.m[3]*b,N=-this.m[1]*b,F=-this.m[2]*b,T=this.m[0]*b,P=b*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),D=b*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=E,this.m[1]=N,this.m[2]=F,this.m[3]=T,this.m[4]=P,this.m[5]=D,this}getMatrix(){return this.m}decompose(){const b=this.m[0],E=this.m[1],N=this.m[2],F=this.m[3],T=this.m[4],P=this.m[5],D=b*F-E*N,R={x:T,y:P,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(b!=0||E!=0){const I=Math.sqrt(b*b+E*E);R.rotation=E>0?Math.acos(b/I):-Math.acos(b/I),R.scaleX=I,R.scaleY=D/I,R.skewX=(b*N+E*F)/D,R.skewY=0}else if(N!=0||F!=0){const I=Math.sqrt(N*N+F*F);R.rotation=Math.PI/2-(F>0?Math.acos(-N/I):-Math.acos(N/I)),R.scaleX=D/I,R.scaleY=I,R.skewX=0,R.skewY=(b*N+E*F)/D}return R.rotation=t.Util._getRotation(R.rotation),R}}t.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",o=Math.PI/180,l=180/Math.PI,u="#",d="",h="0",m="Konva warning: ",x="Konva error: ",p="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},_=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let S=[];const w=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(y){setTimeout(y,60)};t.Util={_isElement(y){return!!(y&&y.nodeType==1)},_isFunction(y){return!!(y&&y.constructor&&y.call&&y.apply)},_isPlainObject(y){return!!y&&y.constructor===Object},_isArray(y){return Object.prototype.toString.call(y)===n},_isNumber(y){return Object.prototype.toString.call(y)===s&&!isNaN(y)&&isFinite(y)},_isString(y){return Object.prototype.toString.call(y)===a},_isBoolean(y){return Object.prototype.toString.call(y)===i},isObject(y){return y instanceof Object},isValidSelector(y){if(typeof y!="string")return!1;const b=y[0];return b==="#"||b==="."||b===b.toUpperCase()},_sign(y){return y===0||y>0?1:-1},requestAnimFrame(y){S.push(y),S.length===1&&w(function(){const b=S;S=[],b.forEach(function(E){E()})})},createCanvasElement(){const y=document.createElement("canvas");try{y.style=y.style||{}}catch{}return y},createImageElement(){return document.createElement("img")},_isInDocument(y){for(;y=y.parentNode;)if(y==document)return!0;return!1},_urlToImage(y,b){const E=t.Util.createImageElement();E.onload=function(){b(E)},E.src=y},_rgbToHex(y,b,E){return((1<<24)+(y<<16)+(b<<8)+E).toString(16).slice(1)},_hexToRgb(y){y=y.replace(u,d);const b=parseInt(y,16);return{r:b>>16&255,g:b>>8&255,b:b&255}},getRandomColor(){let y=(Math.random()*16777215<<0).toString(16);for(;y.length<6;)y=h+y;return u+y},getRGB(y){let b;return y in v?(b=v[y],{r:b[0],g:b[1],b:b[2]}):y[0]===u?this._hexToRgb(y.substring(1)):y.substr(0,4)===p?(b=_.exec(y.replace(/ /g,"")),{r:parseInt(b[1],10),g:parseInt(b[2],10),b:parseInt(b[3],10)}):{r:0,g:0,b:0}},colorToRGBA(y){return y=y||"black",t.Util._namedColorToRBA(y)||t.Util._hex3ColorToRGBA(y)||t.Util._hex4ColorToRGBA(y)||t.Util._hex6ColorToRGBA(y)||t.Util._hex8ColorToRGBA(y)||t.Util._rgbColorToRGBA(y)||t.Util._rgbaColorToRGBA(y)||t.Util._hslColorToRGBA(y)},_namedColorToRBA(y){const b=v[y.toLowerCase()];return b?{r:b[0],g:b[1],b:b[2],a:1}:null},_rgbColorToRGBA(y){if(y.indexOf("rgb(")===0){y=y.match(/rgb\(([^)]+)\)/)[1];const b=y.split(/ *, */).map(Number);return{r:b[0],g:b[1],b:b[2],a:1}}},_rgbaColorToRGBA(y){if(y.indexOf("rgba(")===0){y=y.match(/rgba\(([^)]+)\)/)[1];const b=y.split(/ *, */).map((E,N)=>E.slice(-1)==="%"?N===3?parseInt(E)/100:parseInt(E)/100*255:Number(E));return{r:b[0],g:b[1],b:b[2],a:b[3]}}},_hex8ColorToRGBA(y){if(y[0]==="#"&&y.length===9)return{r:parseInt(y.slice(1,3),16),g:parseInt(y.slice(3,5),16),b:parseInt(y.slice(5,7),16),a:parseInt(y.slice(7,9),16)/255}},_hex6ColorToRGBA(y){if(y[0]==="#"&&y.length===7)return{r:parseInt(y.slice(1,3),16),g:parseInt(y.slice(3,5),16),b:parseInt(y.slice(5,7),16),a:1}},_hex4ColorToRGBA(y){if(y[0]==="#"&&y.length===5)return{r:parseInt(y[1]+y[1],16),g:parseInt(y[2]+y[2],16),b:parseInt(y[3]+y[3],16),a:parseInt(y[4]+y[4],16)/255}},_hex3ColorToRGBA(y){if(y[0]==="#"&&y.length===4)return{r:parseInt(y[1]+y[1],16),g:parseInt(y[2]+y[2],16),b:parseInt(y[3]+y[3],16),a:1}},_hslColorToRGBA(y){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(y)){const[b,...E]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(y),N=Number(E[0])/360,F=Number(E[1])/100,T=Number(E[2])/100;let P,D,R;if(F===0)return R=T*255,{r:Math.round(R),g:Math.round(R),b:Math.round(R),a:1};T<.5?P=T*(1+F):P=T+F-T*F;const I=2*T-P,W=[0,0,0];for(let le=0;le<3;le++)D=N+1/3*-(le-1),D<0&&D++,D>1&&D--,6*D<1?R=I+(P-I)*6*D:2*D<1?R=P:3*D<2?R=I+(P-I)*(2/3-D)*6:R=I,W[le]=R*255;return{r:Math.round(W[0]),g:Math.round(W[1]),b:Math.round(W[2]),a:1}}},haveIntersection(y,b){return!(b.x>y.x+y.width||b.x+b.width<y.x||b.y>y.y+y.height||b.y+b.height<y.y)},cloneObject(y){const b={};for(const E in y)this._isPlainObject(y[E])?b[E]=this.cloneObject(y[E]):this._isArray(y[E])?b[E]=this.cloneArray(y[E]):b[E]=y[E];return b},cloneArray(y){return y.slice(0)},degToRad(y){return y*o},radToDeg(y){return y*l},_degToRad(y){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(y)},_radToDeg(y){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(y)},_getRotation(y){return e.Konva.angleDeg?t.Util.radToDeg(y):y},_capitalize(y){return y.charAt(0).toUpperCase()+y.slice(1)},throw(y){throw new Error(x+y)},error(y){console.error(x+y)},warn(y){e.Konva.showWarnings&&console.warn(m+y)},each(y,b){for(const E in y)b(E,y[E])},_inRange(y,b,E){return b<=y&&y<E},_getProjectionToSegment(y,b,E,N,F,T){let P,D,R;const I=(y-E)*(y-E)+(b-N)*(b-N);if(I==0)P=y,D=b,R=(F-E)*(F-E)+(T-N)*(T-N);else{const W=((F-y)*(E-y)+(T-b)*(N-b))/I;W<0?(P=y,D=b,R=(y-F)*(y-F)+(b-T)*(b-T)):W>1?(P=E,D=N,R=(E-F)*(E-F)+(N-T)*(N-T)):(P=y+W*(E-y),D=b+W*(N-b),R=(P-F)*(P-F)+(D-T)*(D-T))}return[P,D,R]},_getProjectionToLine(y,b,E){const N=t.Util.cloneObject(y);let F=Number.MAX_VALUE;return b.forEach(function(T,P){if(!E&&P===b.length-1)return;const D=b[(P+1)%b.length],R=t.Util._getProjectionToSegment(T.x,T.y,D.x,D.y,y.x,y.y),I=R[0],W=R[1],le=R[2];le<F&&(N.x=I,N.y=W,F=le)}),N},_prepareArrayForTween(y,b,E){const N=[],F=[];if(y.length>b.length){const P=b;b=y,y=P}for(let P=0;P<y.length;P+=2)N.push({x:y[P],y:y[P+1]});for(let P=0;P<b.length;P+=2)F.push({x:b[P],y:b[P+1]});const T=[];return F.forEach(function(P){const D=t.Util._getProjectionToLine(P,N,E);T.push(D.x),T.push(D.y)}),T},_prepareToStringify(y){let b;y.visitedByCircularReferenceRemoval=!0;for(const E in y)if(y.hasOwnProperty(E)&&y[E]&&typeof y[E]=="object"){if(b=Object.getOwnPropertyDescriptor(y,E),y[E].visitedByCircularReferenceRemoval||t.Util._isElement(y[E]))if(b.configurable)delete y[E];else return null;else if(t.Util._prepareToStringify(y[E])===null)if(b.configurable)delete y[E];else return null}return delete y.visitedByCircularReferenceRemoval,y},_assign(y,b){for(const E in b)y[E]=b[E];return y},_getFirstPointerId(y){return y.touches?y.changedTouches[0].identifier:y.pointerId||999},releaseCanvas(...y){e.Konva.releaseCanvasOnDestroy&&y.forEach(b=>{b.width=0,b.height=0})},drawRoundedRectPath(y,b,E,N){let F=0,T=0,P=0,D=0;typeof N=="number"?F=T=P=D=Math.min(N,b/2,E/2):(F=Math.min(N[0]||0,b/2,E/2),T=Math.min(N[1]||0,b/2,E/2),D=Math.min(N[2]||0,b/2,E/2),P=Math.min(N[3]||0,b/2,E/2)),y.moveTo(F,0),y.lineTo(b-T,0),y.arc(b-T,T,T,Math.PI*3/2,0,!1),y.lineTo(b,E-D),y.arc(b-D,E-D,D,0,Math.PI/2,!1),y.lineTo(P,E),y.arc(P,E-P,P,Math.PI/2,Math.PI,!1),y.lineTo(0,F),y.arc(F,F,F,Math.PI,Math.PI*3/2,!1)}}})(mn);var rn={},Bi={},Qo={};Object.defineProperty(Qo,"__esModule",{value:!0});Qo.HitContext=Qo.SceneContext=Qo.Context=void 0;const vP=mn,gH=ar;function mH(t){const e=[],r=t.length,n=vP.Util;for(let s=0;s<r;s++){let a=t[s];n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),e.push(a)}return e}const N5=",",pH="(",xH=")",yH="([",vH="])",wH=";",_H="()",SH="=",A5=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],bH=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],kH=100;class fy{constructor(e){this.canvas=e,gH.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,r){let n=this.traceArr,s=n.length,a="",i,o,l,u;for(i=0;i<s;i++)o=n[i],l=o.method,l?(u=o.args,a+=l,e?a+=_H:vP.Util._isArray(u[0])?a+=yH+u.join(N5)+vH:(r&&(u=u.map(d=>typeof d=="number"?Math.floor(d):d)),a+=pH+u.join(N5)+xH)):(a+=o.property,e||(a+=SH+o.val)),a+=wH;return a}clearTrace(){this.traceArr=[]}_trace(e){let r=this.traceArr,n;r.push(e),n=r.length,n>=kH&&r.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const r=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(e){const r=e.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(e){const r=e.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(e){const r=e.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(e,r){this._context[e]=r}arc(e,r,n,s,a,i){this._context.arc(e,r,n,s,a,i)}arcTo(e,r,n,s,a){this._context.arcTo(e,r,n,s,a)}beginPath(){this._context.beginPath()}bezierCurveTo(e,r,n,s,a,i){this._context.bezierCurveTo(e,r,n,s,a,i)}clearRect(e,r,n,s){this._context.clearRect(e,r,n,s)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,r){const n=arguments;if(n.length===2)return this._context.createImageData(e,r);if(n.length===1)return this._context.createImageData(e)}createLinearGradient(e,r,n,s){return this._context.createLinearGradient(e,r,n,s)}createPattern(e,r){return this._context.createPattern(e,r)}createRadialGradient(e,r,n,s,a,i){return this._context.createRadialGradient(e,r,n,s,a,i)}drawImage(e,r,n,s,a,i,o,l,u){const d=arguments,h=this._context;d.length===3?h.drawImage(e,r,n):d.length===5?h.drawImage(e,r,n,s,a):d.length===9&&h.drawImage(e,r,n,s,a,i,o,l,u)}ellipse(e,r,n,s,a,i,o,l){this._context.ellipse(e,r,n,s,a,i,o,l)}isPointInPath(e,r,n,s){return n?this._context.isPointInPath(n,e,r,s):this._context.isPointInPath(e,r,s)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,r,n,s){this._context.fillRect(e,r,n,s)}strokeRect(e,r,n,s){this._context.strokeRect(e,r,n,s)}fillText(e,r,n,s){s?this._context.fillText(e,r,n,s):this._context.fillText(e,r,n)}measureText(e){return this._context.measureText(e)}getImageData(e,r,n,s){return this._context.getImageData(e,r,n,s)}lineTo(e,r){this._context.lineTo(e,r)}moveTo(e,r){this._context.moveTo(e,r)}rect(e,r,n,s){this._context.rect(e,r,n,s)}roundRect(e,r,n,s,a){this._context.roundRect(e,r,n,s,a)}putImageData(e,r,n){this._context.putImageData(e,r,n)}quadraticCurveTo(e,r,n,s){this._context.quadraticCurveTo(e,r,n,s)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,r){this._context.scale(e,r)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,r,n,s,a,i){this._context.setTransform(e,r,n,s,a,i)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,r,n,s){this._context.strokeText(e,r,n,s)}transform(e,r,n,s,a,i){this._context.transform(e,r,n,s,a,i)}translate(e,r){this._context.translate(e,r)}_enableTrace(){let e=this,r=A5.length,n=this.setAttr,s,a;const i=function(o){let l=e[o],u;e[o]=function(){return a=mH(Array.prototype.slice.call(arguments,0)),u=l.apply(e,arguments),e._trace({method:o,args:a}),u}};for(s=0;s<r;s++)i(A5[s]);e.setAttr=function(){n.apply(e,arguments);const o=arguments[0];let l=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),e._trace({property:o,val:l})}}_applyGlobalCompositeOperation(e){const r=e.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}Qo.Context=fy;bH.forEach(function(t){Object.defineProperty(fy.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class CH extends fy{constructor(e,{willReadFrequently:r=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(e){const r=e.fill();this.setAttr("fillStyle",r),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const r=e._getLinearGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fillRadialGradient(e){const r=e._getRadialGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fill(e){const r=e.fill(),n=e.getFillPriority();if(r&&n==="color"){this._fillColor(e);return}const s=e.getFillPatternImage();if(s&&n==="pattern"){this._fillPattern(e);return}const a=e.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(e);return}const i=e.getFillRadialGradientColorStops();if(i&&n==="radial-gradient"){this._fillRadialGradient(e);return}r?this._fillColor(e):s?this._fillPattern(e):a?this._fillLinearGradient(e):i&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const r=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),s=e.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(s){for(let i=0;i<s.length;i+=2)a.addColorStop(s[i],s[i+1]);this.setAttr("strokeStyle",a)}}_stroke(e){const r=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e),r&&e.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var r,n,s;const a=(r=e.getShadowRGBA())!==null&&r!==void 0?r:"black",i=(n=e.getShadowBlur())!==null&&n!==void 0?n:5,o=(s=e.getShadowOffset())!==null&&s!==void 0?s:{x:0,y:0},l=e.getAbsoluteScale(),u=this.canvas.getPixelRatio(),d=l.x*u,h=l.y*u;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",i*Math.min(Math.abs(d),Math.abs(h))),this.setAttr("shadowOffsetX",o.x*d),this.setAttr("shadowOffsetY",o.y*h)}}Qo.SceneContext=CH;class TH extends fy{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const r=e.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e);const n=e.hitStrokeWidth(),s=n==="auto"?e.strokeWidth():n;this.setAttr("lineWidth",s),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),r||this.restore()}}}Qo.HitContext=TH;Object.defineProperty(Bi,"__esModule",{value:!0});Bi.HitCanvas=Bi.SceneCanvas=Bi.Canvas=void 0;const n1=mn,wP=Qo,_P=ar;let Np;function EH(){if(Np)return Np;const t=n1.Util.createCanvasElement(),e=t.getContext("2d");return Np=function(){const r=_P.Konva._global.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return r/n}(),n1.Util.releaseCanvas(t),Np}class _C{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(e||{}).pixelRatio||_P.Konva.pixelRatio||EH();this.pixelRatio=n,this._canvas=n1.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const r=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,r){this.setWidth(e||0),this.setHeight(r||0)}toDataURL(e,r){try{return this._canvas.toDataURL(e,r)}catch{try{return this._canvas.toDataURL()}catch(s){return n1.Util.error("Unable to get data URL. "+s.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Bi.Canvas=_C;class NH extends _C{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new wP.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}Bi.SceneCanvas=NH;class AH extends _C{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new wP.HitContext(this),this.setSize(e.width,e.height)}}Bi.HitCanvas=AH;var hy={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=ar,r=mn;t.DD={get isDragging(){let n=!1;return t.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return t.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];t.DD._dragElements.forEach((a,i)=>{const{node:o}=a,l=o.getStage();l.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=l._changedPointerPositions.find(d=>d.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),s.push(o)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];t.DD._dragElements.forEach(a=>{const{node:i}=a,o=i.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof e.Konva.Stage&&a.node;u&&s.indexOf(u)===-1&&s.push(u)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){t.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&t.DD._dragElements.delete(a)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(hy);var fr={},Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.RGBComponent=FH;Kt.alphaComponent=jH;Kt.getNumberValidator=PH;Kt.getNumberOrArrayOfNumbersValidator=DH;Kt.getNumberOrAutoValidator=RH;Kt.getStringValidator=OH;Kt.getStringOrGradientValidator=MH;Kt.getFunctionValidator=LH;Kt.getNumberArrayValidator=IH;Kt.getBooleanValidator=BH;Kt.getComponentValidator=UH;const hl=ar,_n=mn;function gl(t){return _n.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||_n.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function FH(t){return t>255?255:t<0?0:Math.round(t)}function jH(t){return t>1?1:t<1e-4?1e-4:t}function PH(){if(hl.Konva.isUnminified)return function(t,e){return _n.Util._isNumber(t)||_n.Util.warn(gl(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function DH(t){if(hl.Konva.isUnminified)return function(e,r){let n=_n.Util._isNumber(e),s=_n.Util._isArray(e)&&e.length==t;return!n&&!s&&_n.Util.warn(gl(e)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function RH(){if(hl.Konva.isUnminified)return function(t,e){return _n.Util._isNumber(t)||t==="auto"||_n.Util.warn(gl(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function OH(){if(hl.Konva.isUnminified)return function(t,e){return _n.Util._isString(t)||_n.Util.warn(gl(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function MH(){if(hl.Konva.isUnminified)return function(t,e){const r=_n.Util._isString(t),n=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return r||n||_n.Util.warn(gl(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function LH(){if(hl.Konva.isUnminified)return function(t,e){return _n.Util._isFunction(t)||_n.Util.warn(gl(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function IH(){if(hl.Konva.isUnminified)return function(t,e){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&t instanceof r||(_n.Util._isArray(t)?t.forEach(function(n){_n.Util._isNumber(n)||_n.Util.warn('"'+e+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):_n.Util.warn(gl(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function BH(){if(hl.Konva.isUnminified)return function(t,e){return t===!0||t===!1||_n.Util.warn(gl(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function UH(t){if(hl.Konva.isUnminified)return function(e,r){return e==null||_n.Util.isObject(e)||_n.Util.warn(gl(e)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+t),e}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=mn,r=Kt,n="get",s="set";t.Factory={addGetterSetter(a,i,o,l,u){t.Factory.addGetter(a,i,o),t.Factory.addSetter(a,i,l,u),t.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,o){const l=n+e.Util._capitalize(i);a.prototype[l]=a.prototype[l]||function(){const u=this.attrs[i];return u===void 0?o:u}},addSetter(a,i,o,l){const u=s+e.Util._capitalize(i);a.prototype[u]||t.Factory.overWriteSetter(a,i,o,l)},overWriteSetter(a,i,o,l){const u=s+e.Util._capitalize(i);a.prototype[u]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,i)),this._setAttr(i,d),l&&l.call(this),this}},addComponentsGetterSetter(a,i,o,l,u){const d=o.length,h=e.Util._capitalize,m=n+h(i),x=s+h(i);a.prototype[m]=function(){const v={};for(let _=0;_<d;_++){const S=o[_];v[S]=this.getAttr(i+h(S))}return v};const p=(0,r.getComponentValidator)(o);a.prototype[x]=function(v){const _=this.attrs[i];l&&(v=l.call(this,v,i)),p&&p.call(this,v,i);for(const S in v)v.hasOwnProperty(S)&&this._setAttr(i+h(S),v[S]);return v||o.forEach(S=>{this._setAttr(i+h(S),void 0)}),this._fireChangeEvent(i,_,v),u&&u.call(this),this},t.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const o=e.Util._capitalize(i),l=s+o,u=n+o;a.prototype[i]=function(){return arguments.length?(this[l](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,i,o,l){e.Util.error("Adding deprecated "+i);const u=n+e.Util._capitalize(i),d=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){e.Util.error(d);const h=this.attrs[i];return h===void 0?o:h},t.Factory.addSetter(a,i,l,function(){e.Util.error(d)}),t.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){e.Util.each(i,function(o,l){const u=a.prototype[l],d=n+e.Util._capitalize(o),h=s+e.Util._capitalize(o);function m(){u.apply(this,arguments),e.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}a.prototype[o]=m,a.prototype[d]=m,a.prototype[h]=m})},afterSetFilter(){this._filterUpToDate=!1}}})(fr);Object.defineProperty(rn,"__esModule",{value:!0});rn.Node=void 0;const Sd=Bi,Qa=hy,zg=fr,Fl=ar,pr=mn,Rn=Kt,yx="absoluteOpacity",Ap="allEventListeners",Bo="absoluteTransform",F5="absoluteScale",zc="canvas",$H="Change",zH="children",WH="konva",MS="listening",VH="mouseenter",GH="mouseleave",HH="pointerenter",KH="pointerleave",XH="touchenter",YH="touchleave",j5="set",P5="Shape",vx=" ",D5="stage",Dl="transform",JH="Stage",LS="visible",QH=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(vx);let qH=1;class Xt{constructor(e){this._id=qH++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Dl||e===Bo)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,r){let n=this._cache.get(e);return(n===void 0||(e===Dl||e===Bo)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(e,n)),n}_calculate(e,r,n){if(!this._attachedDepsListeners.get(e)){const s=r.map(a=>a+"Change.konva").join(vx);this.on(s,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(zc)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Bo&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(zc)){const{scene:e,filter:r,hit:n,buffer:s}=this._cache.get(zc);pr.Util.releaseCanvas(e,r,n,s),this._cache.delete(zc)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const r=e||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let s=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),i=r.pixelRatio,o=r.x===void 0?Math.floor(n.x):r.x,l=r.y===void 0?Math.floor(n.y):r.y,u=r.offset||0,d=r.drawBorder||!1,h=r.hitCanvasPixelRatio||1;if(!s||!a){pr.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const m=Math.abs(Math.round(n.x)-o)>.5?1:0,x=Math.abs(Math.round(n.y)-l)>.5?1:0;s+=u*2+m,a+=u*2+x,o-=u,l-=u;const p=new Sd.SceneCanvas({pixelRatio:i,width:s,height:a}),v=new Sd.SceneCanvas({pixelRatio:i,width:0,height:0,willReadFrequently:!0}),_=new Sd.HitCanvas({pixelRatio:h,width:s,height:a}),S=p.getContext(),w=_.getContext(),y=new Sd.SceneCanvas({width:p.width/p.pixelRatio+Math.abs(o),height:p.height/p.pixelRatio+Math.abs(l),pixelRatio:p.pixelRatio}),b=y.getContext();return _.isCache=!0,p.isCache=!0,this._cache.delete(zc),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(p.getContext()._context.imageSmoothingEnabled=!1,v.getContext()._context.imageSmoothingEnabled=!1),S.save(),w.save(),b.save(),S.translate(-o,-l),w.translate(-o,-l),b.translate(-o,-l),y.x=o,y.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(yx),this._clearSelfAndDescendantCache(F5),this.drawScene(p,this,y),this.drawHit(_,this),this._isUnderCache=!1,S.restore(),w.restore(),d&&(S.save(),S.beginPath(),S.rect(0,0,s,a),S.closePath(),S.setAttr("strokeStyle","red"),S.setAttr("lineWidth",5),S.stroke(),S.restore()),this._cache.set(zc,{scene:p,filter:v,hit:_,buffer:y,x:o,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(zc)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,r){const n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let s=1/0,a=1/0,i=-1/0,o=-1/0;const l=this.getAbsoluteTransform(r);return n.forEach(function(u){const d=l.point(u);s===void 0&&(s=i=d.x,a=o=d.y),s=Math.min(s,d.x),a=Math.min(a,d.y),i=Math.max(i,d.x),o=Math.max(o,d.y)}),{x:s,y:a,width:i-s,height:o-a}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();e.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),s=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/s,n.height/s),e.restore()}_drawCachedHitCanvas(e){const r=this._getCanvasCache(),n=r.hit;e.save(),e.translate(r.x,r.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),r=this._getCanvasCache(),n=r.scene,s=r.filter,a=s.getContext(),i,o,l,u;if(e){if(!this._filterUpToDate){const d=n.pixelRatio;s.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(i=e.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),o=a.getImageData(0,0,s.getWidth(),s.getHeight()),l=0;l<i;l++){if(u=e[l],typeof u!="function"){pr.Util.error("Filter should be type of function, but got "+typeof u+" instead. Please check correct filters");continue}u.call(this,o),a.putImageData(o,0,0)}}catch(h){pr.Util.error("Unable to apply filter. "+h.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return s}return n}on(e,r){if(this._cache&&this._cache.delete(Ap),arguments.length===3)return this._delegate.apply(this,arguments);const n=e.split(vx);for(let s=0;s<n.length;s++){const i=n[s].split("."),o=i[0],l=i[1]||"";this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:l,handler:r})}return this}off(e,r){let n=(e||"").split(vx),s=n.length,a,i,o,l,u,d;if(this._cache&&this._cache.delete(Ap),!e)for(i in this.eventListeners)this._off(i);for(a=0;a<s;a++)if(o=n[a],l=o.split("."),u=l[0],d=l[1],u)this.eventListeners[u]&&this._off(u,d,r);else for(i in this.eventListeners)this._off(i,d,r);return this}dispatchEvent(e){const r={target:this,type:e.type,evt:e};return this.fire(e.type,r),this}addEventListener(e,r){return this.on(e,function(n){r.call(this,n.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,r,n){const s=this;this.on(e,function(a){const i=a.target.findAncestors(r,!0,s);for(let o=0;o<i.length;o++)a=pr.Util.cloneObject(a),a.currentTarget=i[o],n.call(i[o],a)})}remove(){return this.isDragging()&&this.stopDrag(),Qa.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Bo),this._clearSelfAndDescendantCache(yx),this._clearSelfAndDescendantCache(F5),this._clearSelfAndDescendantCache(D5),this._clearSelfAndDescendantCache(LS),this._clearSelfAndDescendantCache(MS)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const r="get"+pr.Util._capitalize(e);return pr.Util._isFunction(this[r])?this[r]():this.attrs[e]}getAncestors(){let e=this.getParent(),r=[];for(;e;)r.push(e),e=e.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let r,n;if(!e)return this;for(r in e)r!==zH&&(n=j5+pr.Util._capitalize(r),pr.Util._isFunction(this[n])?this[n](e[r]):this._setAttr(r,e[r]))}),this}isListening(){return this._getCache(MS,this._isListening)}_isListening(e){if(!this.listening())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(LS,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,r=!1){if(e)return this._isVisible(e)&&this._isListening(e);const n=this.getLayer();let s=!1;Qa.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(i.node.nodeType==="Stage"||i.node.getLayer()===n)&&(s=!0)});const a=!r&&!Fl.Konva.hitOnDragEnabled&&(s||Fl.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),r=this,n=0,s,a,i,o;function l(d){for(s=[],a=d.length,i=0;i<a;i++)o=d[i],n++,o.nodeType!==P5&&(s=s.concat(o.getChildren().slice())),o._id===r._id&&(i=a);s.length>0&&s[0].getDepth()<=e&&l(s)}const u=this.getStage();return r.nodeType!==JH&&u&&l(u.getChildren()),n}getDepth(){let e=0,r=this.parent;for(;r;)e++,r=r.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Dl),this._clearSelfAndDescendantCache(Bo)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const r=e.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(e){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!e&&(e=!0);const s=this.getAbsoluteTransform(e).getMatrix(),a=new pr.Transform,i=this.offset();return a.m=s.slice(),a.translate(i.x,i.y),a.getTranslation()}setAbsolutePosition(e){const{x:r,y:n,...s}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(Dl);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(e.x,e.y),e={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(s),this.setPosition({x:e.x,y:e.y}),this._clearCache(Dl),this._clearSelfAndDescendantCache(Bo),this}_setTransform(e){let r;for(r in e)this.attrs[r]=e[r]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let r=e.x,n=e.y,s=this.x(),a=this.y();return r!==void 0&&(s+=r),n!==void 0&&(a+=n),this.setPosition({x:s,y:a}),this}_eachAncestorReverse(e,r){let n=[],s=this.getParent(),a,i;if(!(r&&r._id===this._id)){for(n.unshift(this);s&&(!r||s._id!==r._id);)n.unshift(s),s=s.parent;for(a=n.length,i=0;i<a;i++)e(n[i])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return pr.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return pr.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return pr.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return pr.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return pr.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&pr.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(yx,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(e*=r.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),r,n,s,a,i;const o={attrs:{},className:this.getClassName()};for(r in e)n=e[r],i=pr.Util.isObject(n)&&!pr.Util._isPlainObject(n)&&!pr.Util._isArray(n),!i&&(s=typeof this[r]=="function"&&this[r],delete e[r],a=s?s.call(this):null,e[r]=n,a!==n&&(o.attrs[r]=n));return pr.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,r,n){const s=[];r&&this._isMatch(e)&&s.push(this);let a=this.parent;for(;a;){if(a===n)return s;a._isMatch(e)&&s.push(a),a=a.parent}return s}isAncestorOf(e){return!1}findAncestor(e,r,n){return this.findAncestors(e,r,n)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let r=e.replace(/ /g,"").split(","),n=r.length,s,a;for(s=0;s<n;s++)if(a=r[s],pr.Util.isValidSelector(a)||(pr.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),pr.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),pr.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(D5,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,r={},n){return r.target=r.target||this,n?this._fireAndBubble(e,r):this._fire(e,r),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Bo,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let r;if(e)return r=new pr.Transform,this._eachAncestorReverse(function(n){const s=n.transformsEnabled();s==="all"?r.multiply(n.getTransform()):s==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},e),r;{r=this._cache.get(Bo)||new pr.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const s=this.attrs.x||0,a=this.attrs.y||0,i=this.attrs.offsetX||0,o=this.attrs.offsetY||0;r.translate(s-i,a-o)}return r.dirty=!1,r}}getAbsoluteScale(e){let r=this;for(;r;)r._isUnderCache&&(e=r),r=r.getParent();const s=this.getAbsoluteTransform(e).decompose();return{x:s.scaleX,y:s.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Dl,this._getTransform)}_getTransform(){var e,r;const n=this._cache.get(Dl)||new pr.Transform;n.reset();const s=this.x(),a=this.y(),i=Fl.Konva.getAngle(this.rotation()),o=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,l=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,u=this.attrs.skewX||0,d=this.attrs.skewY||0,h=this.attrs.offsetX||0,m=this.attrs.offsetY||0;return(s!==0||a!==0)&&n.translate(s,a),i!==0&&n.rotate(i),(u!==0||d!==0)&&n.skew(u,d),(o!==1||l!==1)&&n.scale(o,l),(h!==0||m!==0)&&n.translate(-1*h,-1*m),n.dirty=!1,n}clone(e){let r=pr.Util.cloneObject(this.attrs),n,s,a,i,o;for(n in e)r[n]=e[n];const l=new this.constructor(r);for(n in this.eventListeners)for(s=this.eventListeners[n],a=s.length,i=0;i<a;i++)o=s[i],o.name.indexOf(WH)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(o));return l}_toKonvaCanvas(e){e=e||{};const r=this.getClientRect(),n=this.getStage(),s=e.x!==void 0?e.x:Math.floor(r.x),a=e.y!==void 0?e.y:Math.floor(r.y),i=e.pixelRatio||1,o=new Sd.SceneCanvas({width:e.width||Math.ceil(r.width)||(n?n.width():0),height:e.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:i}),l=o.getContext(),u=new Sd.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(s),height:o.height/o.pixelRatio+Math.abs(a),pixelRatio:o.pixelRatio});return e.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(s||a)&&l.translate(-1*s,-1*a),this.drawScene(o,void 0,u),l.restore(),o}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const r=e.mimeType||null,n=e.quality||null,s=this._toKonvaCanvas(e).toDataURL(r,n);return e.callback&&e.callback(s),s}toImage(e){return new Promise((r,n)=>{try{const s=e==null?void 0:e.callback;s&&delete e.callback,pr.Util._urlToImage(this.toDataURL(e),function(a){r(a),s==null||s(a)})}catch(s){n(s)}})}toBlob(e){return new Promise((r,n)=>{try{const s=e==null?void 0:e.callback;s&&delete e.callback,this.toCanvas(e).toBlob(a=>{r(a),s==null||s(a)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(s){n(s)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Fl.Konva.dragDistance}_off(e,r,n){let s=this.eventListeners[e],a,i,o;for(a=0;a<s.length;a++)if(i=s[a].name,o=s[a].handler,(i!=="konva"||r==="konva")&&(!r||i===r)&&(!n||n===o)){if(s.splice(a,1),s.length===0){delete this.eventListeners[e];break}a--}}_fireChangeEvent(e,r,n){this._fire(e+$H,{oldVal:r,newVal:n})}addName(e){if(!this.hasName(e)){const r=this.name(),n=r?r+" "+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const r=(this.name()||"").split(/\s/g),n=r.indexOf(e);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(e,r){const n=this[j5+pr.Util._capitalize(e)];return pr.Util._isFunction(n)?n.call(this,r):this._setAttr(e,r),this}_requestDraw(){if(Fl.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,r){const n=this.attrs[e];n===r&&!pr.Util.isObject(r)||(r==null?delete this.attrs[e]:this.attrs[e]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,r),this._requestDraw())}_setComponentAttr(e,r,n){let s;n!==void 0&&(s=this.attrs[e],s||(this.attrs[e]=this.getAttr(e)),this.attrs[e][r]=n,this._fireChangeEvent(e,s,n))}_fireAndBubble(e,r,n){r&&this.nodeType===P5&&(r.target=this);const s=[VH,GH,HH,KH,XH,YH];if(!(s.indexOf(e)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(e,r);const i=s.indexOf(e)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!i&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,r,n):this._fireAndBubble.call(this.parent,e,r))}}_getProtoListeners(e){var r,n,s;const a=(r=this._cache.get(Ap))!==null&&r!==void 0?r:{};let i=a==null?void 0:a[e];if(i===void 0){i=[];let o=Object.getPrototypeOf(this);for(;o;){const l=(s=(n=o.eventListeners)===null||n===void 0?void 0:n[e])!==null&&s!==void 0?s:[];i.push(...l),o=Object.getPrototypeOf(o)}a[e]=i,this._cache.set(Ap,a)}return i}_fire(e,r){r=r||{},r.currentTarget=this,r.type=e;const n=this._getProtoListeners(e);if(n)for(let a=0;a<n.length;a++)n[a].handler.call(this,r);const s=this.eventListeners[e];if(s)for(let a=0;a<s.length;a++)s[a].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const r=e?e.pointerId:void 0,n=this.getStage(),s=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||s;Qa.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-s.x,y:a.y-s.y},dragStatus:"ready",pointerId:r})}startDrag(e,r=!0){Qa.DD._dragElements.has(this._id)||this._createDragElement(e);const n=Qa.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},r)}_setDragPosition(e,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let s={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const i=a.call(this,s,e);i?s=i:pr.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==s.x||this._lastPos.y!==s.y)&&(this.setAbsolutePosition(s),this._requestDraw()),this._lastPos=s}stopDrag(e){const r=Qa.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),Qa.DD._endDragBefore(e),Qa.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Qa.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||Fl.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let s=!1;Qa.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(s=!0)}),s||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=Qa.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",s=r&&r.dragStatus==="ready";n?this.stopDrag():s&&Qa.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-e.x,y:-e.y,width:r.width()+2*e.x,height:r.height()+2*e.y};return pr.Util.haveIntersection(n,this.getClientRect())}static create(e,r){return pr.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,r)}static _createNode(e,r){let n=Xt.prototype.getClassName.call(e),s=e.children,a,i,o;r&&(e.attrs.container=r),Fl.Konva[n]||(pr.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const l=Fl.Konva[n];if(a=new l(e.attrs),s)for(i=s.length,o=0;o<i;o++)a.add(Xt._createNode(s[o]));return a}}rn.Node=Xt;Xt.prototype.nodeType="Node";Xt.prototype._attrsAffectingSize=[];Xt.prototype.eventListeners={};Xt.prototype.on.call(Xt.prototype,QH,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Dl),this._clearSelfAndDescendantCache(Bo)});Xt.prototype.on.call(Xt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(LS)});Xt.prototype.on.call(Xt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(MS)});Xt.prototype.on.call(Xt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(yx)});const Ir=zg.Factory.addGetterSetter;Ir(Xt,"zIndex");Ir(Xt,"absolutePosition");Ir(Xt,"position");Ir(Xt,"x",0,(0,Rn.getNumberValidator)());Ir(Xt,"y",0,(0,Rn.getNumberValidator)());Ir(Xt,"globalCompositeOperation","source-over",(0,Rn.getStringValidator)());Ir(Xt,"opacity",1,(0,Rn.getNumberValidator)());Ir(Xt,"name","",(0,Rn.getStringValidator)());Ir(Xt,"id","",(0,Rn.getStringValidator)());Ir(Xt,"rotation",0,(0,Rn.getNumberValidator)());zg.Factory.addComponentsGetterSetter(Xt,"scale",["x","y"]);Ir(Xt,"scaleX",1,(0,Rn.getNumberValidator)());Ir(Xt,"scaleY",1,(0,Rn.getNumberValidator)());zg.Factory.addComponentsGetterSetter(Xt,"skew",["x","y"]);Ir(Xt,"skewX",0,(0,Rn.getNumberValidator)());Ir(Xt,"skewY",0,(0,Rn.getNumberValidator)());zg.Factory.addComponentsGetterSetter(Xt,"offset",["x","y"]);Ir(Xt,"offsetX",0,(0,Rn.getNumberValidator)());Ir(Xt,"offsetY",0,(0,Rn.getNumberValidator)());Ir(Xt,"dragDistance",void 0,(0,Rn.getNumberValidator)());Ir(Xt,"width",0,(0,Rn.getNumberValidator)());Ir(Xt,"height",0,(0,Rn.getNumberValidator)());Ir(Xt,"listening",!0,(0,Rn.getBooleanValidator)());Ir(Xt,"preventDefault",!0,(0,Rn.getBooleanValidator)());Ir(Xt,"filters",void 0,function(t){return this._filterUpToDate=!1,t});Ir(Xt,"visible",!0,(0,Rn.getBooleanValidator)());Ir(Xt,"transformsEnabled","all",(0,Rn.getStringValidator)());Ir(Xt,"size");Ir(Xt,"dragBoundFunc");Ir(Xt,"draggable",!1,(0,Rn.getBooleanValidator)());zg.Factory.backCompat(Xt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Vu={};Object.defineProperty(Vu,"__esModule",{value:!0});Vu.Container=void 0;const Jf=fr,N2=rn,gy=Kt;class Gu extends N2.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){const r=this.children||[];return e?r.filter(e):r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let n=0;n<e.length;n++)this.add(e[n]);return this}const r=e[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const r=this._generalFind(e,!0);return r.length>0?r[0]:void 0}_generalFind(e,r){const n=[];return this._descendants(s=>{const a=s._isMatch(e);return a&&n.push(s),!!(a&&r)}),n}_descendants(e){let r=!1;const n=this.getChildren();for(const s of n){if(r=e(s),r)return!0;if(s.hasChildren()&&(r=s._descendants(e),r))return!0}return!1}toObject(){const e=N2.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(r=>{e.children.push(r.toObject())}),e}isAncestorOf(e){let r=e.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(e){const r=N2.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(e){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(e)&&r.push(n)}),r}_clearSelfAndDescendantCache(e){var r;super._clearSelfAndDescendantCache(e),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(e,r,n){const s=this.getLayer(),a=e||s&&s.getCanvas(),i=a&&a.getContext(),o=this._getCanvasCache(),l=o&&o.scene,u=a&&a.isCache;if(!this.isVisible()&&!u)return this;if(l){i.save();const d=this.getAbsoluteTransform(r).getMatrix();i.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(i),i.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(e,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),s=e||n&&n.hitCanvas,a=s&&s.getContext(),i=this._getCanvasCache();if(i&&i.hit){a.save();const l=this.getAbsoluteTransform(r).getMatrix();a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",s,r);return this}_drawChildren(e,r,n,s){var a;const i=r&&r.getContext(),o=this.clipWidth(),l=this.clipHeight(),u=this.clipFunc(),d=typeof o=="number"&&typeof l=="number"||u,h=n===this;if(d){i.save();const x=this.getAbsoluteTransform(n);let p=x.getMatrix();i.transform(p[0],p[1],p[2],p[3],p[4],p[5]),i.beginPath();let v;if(u)v=u.call(this,i,this);else{const _=this.clipX(),S=this.clipY();i.rect(_||0,S||0,o,l)}i.clip.apply(i,v),p=x.copy().invert().getMatrix(),i.transform(p[0],p[1],p[2],p[3],p[4],p[5])}const m=!h&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";m&&(i.save(),i._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(x){x[e](r,n,s)}),m&&i.restore(),d&&i.restore()}getClientRect(e={}){var r;const n=e.skipTransform,s=e.relativeTo;let a,i,o,l,u={x:1/0,y:1/0,width:0,height:0};const d=this;(r=this.children)===null||r===void 0||r.forEach(function(x){if(!x.visible())return;const p=x.getClientRect({relativeTo:d,skipShadow:e.skipShadow,skipStroke:e.skipStroke});p.width===0&&p.height===0||(a===void 0?(a=p.x,i=p.y,o=p.x+p.width,l=p.y+p.height):(a=Math.min(a,p.x),i=Math.min(i,p.y),o=Math.max(o,p.x+p.width),l=Math.max(l,p.y+p.height)))});const h=this.find("Shape");let m=!1;for(let x=0;x<h.length;x++)if(h[x]._isVisible(this)){m=!0;break}return m&&a!==void 0?u={x:a,y:i,width:o-a,height:l-i}:u={x:0,y:0,width:0,height:0},n?u:this._transformedRect(u,s)}}Vu.Container=Gu;Jf.Factory.addComponentsGetterSetter(Gu,"clip",["x","y","width","height"]);Jf.Factory.addGetterSetter(Gu,"clipX",void 0,(0,gy.getNumberValidator)());Jf.Factory.addGetterSetter(Gu,"clipY",void 0,(0,gy.getNumberValidator)());Jf.Factory.addGetterSetter(Gu,"clipWidth",void 0,(0,gy.getNumberValidator)());Jf.Factory.addGetterSetter(Gu,"clipHeight",void 0,(0,gy.getNumberValidator)());Jf.Factory.addGetterSetter(Gu,"clipFunc");var SP={},vc={};Object.defineProperty(vc,"__esModule",{value:!0});vc.getCapturedShape=eK;vc.createEvent=SC;vc.hasPointerCapture=tK;vc.setPointerCapture=rK;vc.releaseCapture=kP;const ZH=ar,ag=new Map,bP=ZH.Konva._global.PointerEvent!==void 0;function eK(t){return ag.get(t)}function SC(t){return{evt:t,pointerId:t.pointerId}}function tK(t,e){return ag.get(t)===e}function rK(t,e){kP(t),e.getStage()&&(ag.set(t,e),bP&&e._fire("gotpointercapture",SC(new PointerEvent("gotpointercapture"))))}function kP(t,e){const r=ag.get(t);if(!r)return;const n=r.getStage();n&&n.content,ag.delete(t),bP&&r._fire("lostpointercapture",SC(new PointerEvent("lostpointercapture")))}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=mn,r=fr,n=Vu,s=ar,a=Bi,i=hy,o=ar,l=vc,u="Stage",d="string",h="px",m="mouseout",x="mouseleave",p="mouseover",v="mouseenter",_="mousemove",S="mousedown",w="mouseup",y="pointermove",b="pointerdown",E="pointerup",N="pointercancel",F="lostpointercapture",T="pointerout",P="pointerleave",D="pointerover",R="pointerenter",I="contextmenu",W="touchstart",le="touchend",q="touchmove",V="touchcancel",K="wheel",U=5,L=[[v,"_pointerenter"],[S,"_pointerdown"],[_,"_pointermove"],[w,"_pointerup"],[x,"_pointerleave"],[W,"_pointerdown"],[q,"_pointermove"],[le,"_pointerup"],[V,"_pointercancel"],[p,"_pointerover"],[K,"_wheel"],[I,"_contextmenu"],[b,"_pointerdown"],[y,"_pointermove"],[E,"_pointerup"],[N,"_pointercancel"],[P,"_pointerleave"],[F,"_lostpointercapture"]],Z={mouse:{[T]:m,[P]:x,[D]:p,[R]:v,[y]:_,[b]:S,[E]:w,[N]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[T]:"touchout",[P]:"touchleave",[D]:"touchover",[R]:"touchenter",[y]:q,[b]:W,[E]:le,[N]:V,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[T]:T,[P]:P,[D]:D,[R]:R,[y]:y,[b]:b,[E]:E,[N]:N,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ne=de=>de.indexOf("pointer")>=0?"pointer":de.indexOf("touch")>=0?"touch":"mouse",z=de=>{const ee=ne(de);if(ee==="pointer")return s.Konva.pointerEventsEnabled&&Z.pointer;if(ee==="touch")return Z.touch;if(ee==="mouse")return Z.mouse};function Y(de={}){return(de.clipFunc||de.clipWidth||de.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),de}const J="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class te extends n.Container{constructor(ee){super(Y(ee)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Y(this.attrs)}),this._checkVisibility()}_validateAdd(ee){const ge=ee.getType()==="Layer",fe=ee.getType()==="FastLayer";ge||fe||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const ee=this.visible()?"":"none";this.content.style.display=ee}setContainer(ee){if(typeof ee===d){let ge;if(ee.charAt(0)==="."){const fe=ee.slice(1);ee=document.getElementsByClassName(fe)[0]}else ee.charAt(0)!=="#"?ge=ee:ge=ee.slice(1),ee=document.getElementById(ge);if(!ee)throw"Can not find container in document with id "+ge}return this._setAttr("container",ee),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),ee.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const ee=this.children,ge=ee.length;for(let fe=0;fe<ge;fe++)ee[fe].clear();return this}clone(ee){return ee||(ee={}),ee.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,ee)}destroy(){super.destroy();const ee=this.content;ee&&e.Util._isInDocument(ee)&&this.container().removeChild(ee);const ge=t.stages.indexOf(this);return ge>-1&&t.stages.splice(ge,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const ee=this._pointerPositions[0]||this._changedPointerPositions[0];return ee?{x:ee.x,y:ee.y}:(e.Util.warn(J),null)}_getPointerById(ee){return this._pointerPositions.find(ge=>ge.id===ee)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(ee){ee=ee||{},ee.x=ee.x||0,ee.y=ee.y||0,ee.width=ee.width||this.width(),ee.height=ee.height||this.height();const ge=new a.SceneCanvas({width:ee.width,height:ee.height,pixelRatio:ee.pixelRatio||1}),fe=ge.getContext()._context,ye=this.children;return(ee.x||ee.y)&&fe.translate(-1*ee.x,-1*ee.y),ye.forEach(function(Ce){if(!Ce.isVisible())return;const re=Ce._toKonvaCanvas(ee);fe.drawImage(re._canvas,ee.x,ee.y,re.getWidth()/re.getPixelRatio(),re.getHeight()/re.getPixelRatio())}),ge}getIntersection(ee){if(!ee)return null;const ge=this.children,fe=ge.length,ye=fe-1;for(let Ce=ye;Ce>=0;Ce--){const re=ge[Ce].getIntersection(ee);if(re)return re}return null}_resizeDOM(){const ee=this.width(),ge=this.height();this.content&&(this.content.style.width=ee+h,this.content.style.height=ge+h),this.bufferCanvas.setSize(ee,ge),this.bufferHitCanvas.setSize(ee,ge),this.children.forEach(fe=>{fe.setSize({width:ee,height:ge}),fe.draw()})}add(ee,...ge){if(arguments.length>1){for(let ye=0;ye<arguments.length;ye++)this.add(arguments[ye]);return this}super.add(ee);const fe=this.children.length;return fe>U&&e.Util.warn("The stage has "+fe+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),ee.setSize({width:this.width(),height:this.height()}),ee.draw(),s.Konva.isBrowser&&this.content.appendChild(ee.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(ee){return l.hasPointerCapture(ee,this)}setPointerCapture(ee){l.setPointerCapture(ee,this)}releaseCapture(ee){l.releaseCapture(ee,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&L.forEach(([ee,ge])=>{this.content.addEventListener(ee,fe=>{this[ge](fe)},{passive:!1})})}_pointerenter(ee){this.setPointersPositions(ee);const ge=z(ee.type);ge&&this._fire(ge.pointerenter,{evt:ee,target:this,currentTarget:this})}_pointerover(ee){this.setPointersPositions(ee);const ge=z(ee.type);ge&&this._fire(ge.pointerover,{evt:ee,target:this,currentTarget:this})}_getTargetShape(ee){let ge=this[ee+"targetShape"];return ge&&!ge.getStage()&&(ge=null),ge}_pointerleave(ee){const ge=z(ee.type),fe=ne(ee.type);if(!ge)return;this.setPointersPositions(ee);const ye=this._getTargetShape(fe),Ce=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;ye&&Ce?(ye._fireAndBubble(ge.pointerout,{evt:ee}),ye._fireAndBubble(ge.pointerleave,{evt:ee}),this._fire(ge.pointerleave,{evt:ee,target:this,currentTarget:this}),this[fe+"targetShape"]=null):Ce&&(this._fire(ge.pointerleave,{evt:ee,target:this,currentTarget:this}),this._fire(ge.pointerout,{evt:ee,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(ee){const ge=z(ee.type),fe=ne(ee.type);if(!ge)return;this.setPointersPositions(ee);let ye=!1;this._changedPointerPositions.forEach(Ce=>{const re=this.getIntersection(Ce);if(i.DD.justDragged=!1,s.Konva["_"+fe+"ListenClick"]=!0,!re||!re.isListening()){this[fe+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&re.setPointerCapture(Ce.id),this[fe+"ClickStartShape"]=re,re._fireAndBubble(ge.pointerdown,{evt:ee,pointerId:Ce.id}),ye=!0;const ve=ee.type.indexOf("touch")>=0;re.preventDefault()&&ee.cancelable&&ve&&ee.preventDefault()}),ye||this._fire(ge.pointerdown,{evt:ee,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(ee){const ge=z(ee.type),fe=ne(ee.type);if(!ge||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&ee.cancelable&&ee.preventDefault(),this.setPointersPositions(ee),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const Ce={};let re=!1;const ve=this._getTargetShape(fe);this._changedPointerPositions.forEach(we=>{const Oe=l.getCapturedShape(we.id)||this.getIntersection(we),Ze=we.id,Re={evt:ee,pointerId:Ze},xt=ve!==Oe;if(xt&&ve&&(ve._fireAndBubble(ge.pointerout,{...Re},Oe),ve._fireAndBubble(ge.pointerleave,{...Re},Oe)),Oe){if(Ce[Oe._id])return;Ce[Oe._id]=!0}Oe&&Oe.isListening()?(re=!0,xt&&(Oe._fireAndBubble(ge.pointerover,{...Re},ve),Oe._fireAndBubble(ge.pointerenter,{...Re},ve),this[fe+"targetShape"]=Oe),Oe._fireAndBubble(ge.pointermove,{...Re})):ve&&(this._fire(ge.pointerover,{evt:ee,target:this,currentTarget:this,pointerId:Ze}),this[fe+"targetShape"]=null)}),re||this._fire(ge.pointermove,{evt:ee,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(ee){const ge=z(ee.type),fe=ne(ee.type);if(!ge)return;this.setPointersPositions(ee);const ye=this[fe+"ClickStartShape"],Ce=this[fe+"ClickEndShape"],re={};let ve=!1;this._changedPointerPositions.forEach(we=>{const Oe=l.getCapturedShape(we.id)||this.getIntersection(we);if(Oe){if(Oe.releaseCapture(we.id),re[Oe._id])return;re[Oe._id]=!0}const Ze=we.id,Re={evt:ee,pointerId:Ze};let xt=!1;s.Konva["_"+fe+"InDblClickWindow"]?(xt=!0,clearTimeout(this[fe+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+fe+"InDblClickWindow"]=!0,clearTimeout(this[fe+"DblTimeout"])),this[fe+"DblTimeout"]=setTimeout(function(){s.Konva["_"+fe+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),Oe&&Oe.isListening()?(ve=!0,this[fe+"ClickEndShape"]=Oe,Oe._fireAndBubble(ge.pointerup,{...Re}),s.Konva["_"+fe+"ListenClick"]&&ye&&ye===Oe&&(Oe._fireAndBubble(ge.pointerclick,{...Re}),xt&&Ce&&Ce===Oe&&Oe._fireAndBubble(ge.pointerdblclick,{...Re}))):(this[fe+"ClickEndShape"]=null,s.Konva["_"+fe+"ListenClick"]&&this._fire(ge.pointerclick,{evt:ee,target:this,currentTarget:this,pointerId:Ze}),xt&&this._fire(ge.pointerdblclick,{evt:ee,target:this,currentTarget:this,pointerId:Ze}))}),ve||this._fire(ge.pointerup,{evt:ee,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+fe+"ListenClick"]=!1,ee.cancelable&&fe!=="touch"&&fe!=="pointer"&&ee.preventDefault()}_contextmenu(ee){this.setPointersPositions(ee);const ge=this.getIntersection(this.getPointerPosition());ge&&ge.isListening()?ge._fireAndBubble(I,{evt:ee}):this._fire(I,{evt:ee,target:this,currentTarget:this})}_wheel(ee){this.setPointersPositions(ee);const ge=this.getIntersection(this.getPointerPosition());ge&&ge.isListening()?ge._fireAndBubble(K,{evt:ee}):this._fire(K,{evt:ee,target:this,currentTarget:this})}_pointercancel(ee){this.setPointersPositions(ee);const ge=l.getCapturedShape(ee.pointerId)||this.getIntersection(this.getPointerPosition());ge&&ge._fireAndBubble(E,l.createEvent(ee)),l.releaseCapture(ee.pointerId)}_lostpointercapture(ee){l.releaseCapture(ee.pointerId)}setPointersPositions(ee){const ge=this._getContentPosition();let fe=null,ye=null;ee=ee||window.event,ee.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(ee.touches,Ce=>{this._pointerPositions.push({id:Ce.identifier,x:(Ce.clientX-ge.left)/ge.scaleX,y:(Ce.clientY-ge.top)/ge.scaleY})}),Array.prototype.forEach.call(ee.changedTouches||ee.touches,Ce=>{this._changedPointerPositions.push({id:Ce.identifier,x:(Ce.clientX-ge.left)/ge.scaleX,y:(Ce.clientY-ge.top)/ge.scaleY})})):(fe=(ee.clientX-ge.left)/ge.scaleX,ye=(ee.clientY-ge.top)/ge.scaleY,this.pointerPos={x:fe,y:ye},this._pointerPositions=[{x:fe,y:ye,id:e.Util._getFirstPointerId(ee)}],this._changedPointerPositions=[{x:fe,y:ye,id:e.Util._getFirstPointerId(ee)}])}_setPointerPosition(ee){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(ee)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const ee=this.content.getBoundingClientRect();return{top:ee.top,left:ee.left,scaleX:ee.width/this.content.clientWidth||1,scaleY:ee.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const ee=this.container();if(!ee)throw"Stage has no container. A container is required.";ee.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),ee.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(ee){ee.batchDraw()}),this}}t.Stage=te,te.prototype.nodeType=u,(0,o._registerNode)(te),r.Factory.addGetterSetter(te,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(de=>{de.batchDraw()})})})(SP);var Wg={},ts={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=ar,r=mn,n=fr,s=rn,a=Kt,i=ar,o=vc,l="hasShadow",u="shadowRGBA",d="patternImage",h="linearGradient",m="radialGradient";let x;function p(){return x||(x=r.Util.createCanvasElement().getContext("2d"),x)}t.shapes={};function v(P){const D=this.attrs.fillRule;D?P.fill(D):P.fill()}function _(P){P.stroke()}function S(P){const D=this.attrs.fillRule;D?P.fill(D):P.fill()}function w(P){P.stroke()}function y(){this._clearCache(l)}function b(){this._clearCache(u)}function E(){this._clearCache(d)}function N(){this._clearCache(h)}function F(){this._clearCache(m)}class T extends s.Node{constructor(D){super(D);let R;for(;R=r.Util.getRandomColor(),!(R&&!(R in t.shapes)););this.colorKey=R,t.shapes[R]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const R=p().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(R&&R.setTransform){const I=new r.Transform;I.translate(this.fillPatternX(),this.fillPatternY()),I.rotate(e.Konva.getAngle(this.fillPatternRotation())),I.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),I.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const W=I.getMatrix(),le=typeof DOMMatrix>"u"?{a:W[0],b:W[1],c:W[2],d:W[3],e:W[4],f:W[5]}:new DOMMatrix(W);R.setTransform(le)}return R}}_getLinearGradient(){return this._getCache(h,this.__getLinearGradient)}__getLinearGradient(){const D=this.fillLinearGradientColorStops();if(D){const R=p(),I=this.fillLinearGradientStartPoint(),W=this.fillLinearGradientEndPoint(),le=R.createLinearGradient(I.x,I.y,W.x,W.y);for(let q=0;q<D.length;q+=2)le.addColorStop(D[q],D[q+1]);return le}}_getRadialGradient(){return this._getCache(m,this.__getRadialGradient)}__getRadialGradient(){const D=this.fillRadialGradientColorStops();if(D){const R=p(),I=this.fillRadialGradientStartPoint(),W=this.fillRadialGradientEndPoint(),le=R.createRadialGradient(I.x,I.y,this.fillRadialGradientStartRadius(),W.x,W.y,this.fillRadialGradientEndRadius());for(let q=0;q<D.length;q+=2)le.addColorStop(D[q],D[q+1]);return le}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const D=r.Util.colorToRGBA(this.shadowColor());if(D)return"rgba("+D.r+","+D.g+","+D.b+","+D.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const D=this.hitStrokeWidth();return D==="auto"?this.hasStroke():this.strokeEnabled()&&!!D}intersects(D){const R=this.getStage();if(!R)return!1;const I=R.bufferHitCanvas;return I.getContext().clear(),this.drawHit(I,void 0,!0),I.context.getImageData(Math.round(D.x),Math.round(D.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(D){var R;if(!((R=this.attrs.perfectDrawEnabled)!==null&&R!==void 0?R:!0))return!1;const W=D||this.hasFill(),le=this.hasStroke(),q=this.getAbsoluteOpacity()!==1;if(W&&le&&q)return!0;const V=this.hasShadow(),K=this.shadowForStrokeEnabled();return!!(W&&le&&V&&K)}setStrokeHitEnabled(D){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),D?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const D=this.size();return{x:this._centroid?-D.width/2:0,y:this._centroid?-D.height/2:0,width:D.width,height:D.height}}getClientRect(D={}){let R=!1,I=this.getParent();for(;I;){if(I.isCached()){R=!0;break}I=I.getParent()}const W=D.skipTransform,le=D.relativeTo||R&&this.getStage()||void 0,q=this.getSelfRect(),K=!D.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,U=q.width+K,L=q.height+K,Z=!D.skipShadow&&this.hasShadow(),ne=Z?this.shadowOffsetX():0,z=Z?this.shadowOffsetY():0,Y=U+Math.abs(ne),J=L+Math.abs(z),te=Z&&this.shadowBlur()||0,de=Y+te*2,ee=J+te*2,ge={width:de,height:ee,x:-(K/2+te)+Math.min(ne,0)+q.x,y:-(K/2+te)+Math.min(z,0)+q.y};return W?ge:this._transformedRect(ge,le)}drawScene(D,R,I){const W=this.getLayer(),le=D||W.getCanvas(),q=le.getContext(),V=this._getCanvasCache(),K=this.getSceneFunc(),U=this.hasShadow();let L;const Z=R===this;if(!this.isVisible()&&!Z)return this;if(V){q.save();const ne=this.getAbsoluteTransform(R).getMatrix();return q.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]),this._drawCachedSceneCanvas(q),q.restore(),this}if(!K)return this;if(q.save(),this._useBufferCanvas()){L=this.getStage();const ne=I||L.bufferCanvas,z=ne.getContext();z.clear(),z.save(),z._applyLineJoin(this);const Y=this.getAbsoluteTransform(R).getMatrix();z.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),K.call(this,z,this),z.restore();const J=ne.pixelRatio;U&&q._applyShadow(this),q._applyOpacity(this),q._applyGlobalCompositeOperation(this),q.drawImage(ne._canvas,ne.x||0,ne.y||0,ne.width/J,ne.height/J)}else{if(q._applyLineJoin(this),!Z){const ne=this.getAbsoluteTransform(R).getMatrix();q.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]),q._applyOpacity(this),q._applyGlobalCompositeOperation(this)}U&&q._applyShadow(this),K.call(this,q,this)}return q.restore(),this}drawHit(D,R,I=!1){if(!this.shouldDrawHit(R,I))return this;const W=this.getLayer(),le=D||W.hitCanvas,q=le&&le.getContext(),V=this.hitFunc()||this.sceneFunc(),K=this._getCanvasCache(),U=K&&K.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),U){q.save();const Z=this.getAbsoluteTransform(R).getMatrix();return q.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5]),this._drawCachedHitCanvas(q),q.restore(),this}if(!V)return this;if(q.save(),q._applyLineJoin(this),!(this===R)){const Z=this.getAbsoluteTransform(R).getMatrix();q.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5])}return V.call(this,q,this),q.restore(),this}drawHitFromCache(D=0){const R=this._getCanvasCache(),I=this._getCachedSceneCanvas(),W=R.hit,le=W.getContext(),q=W.getWidth(),V=W.getHeight();le.clear(),le.drawImage(I._canvas,0,0,q,V);try{const K=le.getImageData(0,0,q,V),U=K.data,L=U.length,Z=r.Util._hexToRgb(this.colorKey);for(let ne=0;ne<L;ne+=4)U[ne+3]>D?(U[ne]=Z.r,U[ne+1]=Z.g,U[ne+2]=Z.b,U[ne+3]=255):U[ne+3]=0;le.putImageData(K,0,0)}catch(K){r.Util.error("Unable to draw hit graph from cached scene canvas. "+K.message)}return this}hasPointerCapture(D){return o.hasPointerCapture(D,this)}setPointerCapture(D){o.setPointerCapture(D,this)}releaseCapture(D){o.releaseCapture(D,this)}}t.Shape=T,T.prototype._fillFunc=v,T.prototype._strokeFunc=_,T.prototype._fillFuncHit=S,T.prototype._strokeFuncHit=w,T.prototype._centroid=!1,T.prototype.nodeType="Shape",(0,i._registerNode)(T),T.prototype.eventListeners={},T.prototype.on.call(T.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),T.prototype.on.call(T.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",b),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",E),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",N),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",F),n.Factory.addGetterSetter(T,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(T,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(T,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(T,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(T,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(T,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(T,"lineJoin"),n.Factory.addGetterSetter(T,"lineCap"),n.Factory.addGetterSetter(T,"sceneFunc"),n.Factory.addGetterSetter(T,"hitFunc"),n.Factory.addGetterSetter(T,"dash"),n.Factory.addGetterSetter(T,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(T,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(T,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(T,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternImage"),n.Factory.addGetterSetter(T,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(T,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(T,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(T,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(T,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(T,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(T,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(T,"fillEnabled",!0),n.Factory.addGetterSetter(T,"strokeEnabled",!0),n.Factory.addGetterSetter(T,"shadowEnabled",!0),n.Factory.addGetterSetter(T,"dashEnabled",!0),n.Factory.addGetterSetter(T,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(T,"fillPriority","color"),n.Factory.addComponentsGetterSetter(T,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(T,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(T,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(T,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(T,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(T,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(T,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(T,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(T,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(T,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(T,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(T,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(T,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(T,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(T,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(T,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(T,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(T,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(T,"fillPatternRotation",0),n.Factory.addGetterSetter(T,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(T,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(ts);Object.defineProperty(Wg,"__esModule",{value:!0});Wg.Layer=void 0;const Mo=mn,A2=Vu,bd=rn,bC=fr,R5=Bi,nK=Kt,sK=ts,aK=ar,iK="#",oK="beforeDraw",lK="draw",CP=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],cK=CP.length;let Qf=class extends A2.Container{constructor(e){super(e),this.canvas=new R5.SceneCanvas,this.hitCanvas=new R5.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),e<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[e+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){bd.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!bd.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(bd.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(bd.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return bd.Node.prototype.remove.call(this),e&&e.parentNode&&Mo.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:r}){return this.canvas.setSize(e,r),this.hitCanvas.setSize(e,r),this._setSmoothEnabled(),this}_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&Mo.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),bd.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Mo.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Mo.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Mo.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let s=0;s<cK;s++){const a=CP[s],i=this._getIntersection({x:e.x+a.x*r,y:e.y+a.y*r}),o=i.shape;if(o)return o;if(n=!!i.antialiased,!i.antialiased)break}if(n)r+=1;else return null}}_getIntersection(e){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(e.x*r),Math.round(e.y*r),1,1).data,s=n[3];if(s===255){const a=Mo.Util._rgbToHex(n[0],n[1],n[2]),i=sK.shapes[iK+a];return i?{shape:i}:{antialiased:!0}}else if(s>0)return{antialiased:!0};return{}}drawScene(e,r,n){const s=this.getLayer(),a=e||s&&s.getCanvas();return this._fire(oK,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),A2.Container.prototype.drawScene.call(this,a,r,n),this._fire(lK,{node:this}),this}drawHit(e,r){const n=this.getLayer(),s=e||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),A2.Container.prototype.drawHit.call(this,s,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Mo.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Mo.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Mo.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Wg.Layer=Qf;Qf.prototype.nodeType="Layer";(0,aK._registerNode)(Qf);bC.Factory.addGetterSetter(Qf,"imageSmoothingEnabled",!0);bC.Factory.addGetterSetter(Qf,"clearBeforeDraw",!0);bC.Factory.addGetterSetter(Qf,"hitGraphEnabled",!0,(0,nK.getBooleanValidator)());var my={};Object.defineProperty(my,"__esModule",{value:!0});my.FastLayer=void 0;const uK=mn,dK=Wg,fK=ar;let kC=class extends dK.Layer{constructor(e){super(e),this.listening(!1),uK.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};my.FastLayer=kC;kC.prototype.nodeType="FastLayer";(0,fK._registerNode)(kC);var qf={};Object.defineProperty(qf,"__esModule",{value:!0});qf.Group=void 0;const hK=mn,gK=Vu,mK=ar;let CC=class extends gK.Container{_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&hK.Util.throw("You may only add groups and shapes to groups.")}};qf.Group=CC;CC.prototype.nodeType="Group";(0,mK._registerNode)(CC);var Zf={};Object.defineProperty(Zf,"__esModule",{value:!0});Zf.Animation=void 0;const F2=ar,O5=mn,j2=function(){return F2.glob.performance&&F2.glob.performance.now?function(){return F2.glob.performance.now()}:function(){return new Date().getTime()}}();class uo{constructor(e,r){this.id=uo.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:j2(),frameRate:0},this.func=e,this.setLayers(r)}setLayers(e){let r=[];return e&&(r=Array.isArray(e)?e:[e]),this.layers=r,this}getLayers(){return this.layers}addLayer(e){const r=this.layers,n=r.length;for(let s=0;s<n;s++)if(r[s]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const r=uo.animations,n=r.length;for(let s=0;s<n;s++)if(r[s].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=j2(),uo._addAnimation(this),this}stop(){return uo._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const r=e.id,n=this.animations,s=n.length;for(let a=0;a<s;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const e={},r=this.animations;for(let n=0;n<r.length;n++){const s=r[n],a=s.layers,i=s.func;s._updateFrameObject(j2());const o=a.length;let l;if(i?l=i.call(s,s.frame)!==!1:l=!0,!!l)for(let u=0;u<o;u++){const d=a[u];d._id!==void 0&&(e[d._id]=d)}}for(const n in e)e.hasOwnProperty(n)&&e[n].batchDraw()}static _animationLoop(){const e=uo;e.animations.length?(e._runFrames(),O5.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,O5.Util.requestAnimFrame(this._animationLoop))}}Zf.Animation=uo;uo.animations=[];uo.animIdCounter=0;uo.animRunning=!1;var TP={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=mn,r=Zf,n=rn,s=ar,a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,o=2,l=3,u=["fill","stroke","shadowColor"];let d=0;class h{constructor(p,v,_,S,w,y,b){this.prop=p,this.propFunc=v,this.begin=S,this._pos=S,this.duration=y,this._change=0,this.prevPos=0,this.yoyo=b,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=_,this._change=w-this.begin,this.pause()}fire(p){const v=this[p];v&&v()}setTime(p){p>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():p<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=p,this.update())}getTime(){return this._time}setPosition(p){this.prevPos=this._pos,this.propFunc(p),this._pos=p}getPosition(p){return p===void 0&&(p=this._time),this.func(p,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(p){this.pause(),this._time=p,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const p=this.getTimer()-this._startTime;this.state===o?this.setTime(p):this.state===l&&this.setTime(this.duration-p)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class m{constructor(p){const v=this,_=p.node,S=_._id,w=p.easing||t.Easings.Linear,y=!!p.yoyo;let b,E;typeof p.duration>"u"?b=.3:p.duration===0?b=.001:b=p.duration,this.node=_,this._id=d++;const N=_.getLayer()||(_ instanceof s.Konva.Stage?_.getLayers():null);N||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){v.tween.onEnterFrame()},N),this.tween=new h(E,function(F){v._tweenFunc(F)},w,0,1,b*1e3,y),this._addListeners(),m.attrs[S]||(m.attrs[S]={}),m.attrs[S][this._id]||(m.attrs[S][this._id]={}),m.tweens[S]||(m.tweens[S]={});for(E in p)a[E]===void 0&&this._addAttr(E,p[E]);this.reset(),this.onFinish=p.onFinish,this.onReset=p.onReset,this.onUpdate=p.onUpdate}_addAttr(p,v){const _=this.node,S=_._id;let w,y,b,E,N;const F=m.tweens[S][p];F&&delete m.attrs[S][F][p];let T=_.getAttr(p);if(e.Util._isArray(v))if(w=[],y=Math.max(v.length,T.length),p==="points"&&v.length!==T.length&&(v.length>T.length?(E=T,T=e.Util._prepareArrayForTween(T,v,_.closed())):(b=v,v=e.Util._prepareArrayForTween(v,T,_.closed()))),p.indexOf("fill")===0)for(let P=0;P<y;P++)if(P%2===0)w.push(v[P]-T[P]);else{const D=e.Util.colorToRGBA(T[P]);N=e.Util.colorToRGBA(v[P]),T[P]=D,w.push({r:N.r-D.r,g:N.g-D.g,b:N.b-D.b,a:N.a-D.a})}else for(let P=0;P<y;P++)w.push(v[P]-T[P]);else u.indexOf(p)!==-1?(T=e.Util.colorToRGBA(T),N=e.Util.colorToRGBA(v),w={r:N.r-T.r,g:N.g-T.g,b:N.b-T.b,a:N.a-T.a}):w=v-T;m.attrs[S][this._id][p]={start:T,diff:w,end:v,trueEnd:b,trueStart:E},m.tweens[S][p]=this._id}_tweenFunc(p){const v=this.node,_=m.attrs[v._id][this._id];let S,w,y,b,E,N,F,T;for(S in _){if(w=_[S],y=w.start,b=w.diff,T=w.end,e.Util._isArray(y))if(E=[],F=Math.max(y.length,T.length),S.indexOf("fill")===0)for(N=0;N<F;N++)N%2===0?E.push((y[N]||0)+b[N]*p):E.push("rgba("+Math.round(y[N].r+b[N].r*p)+","+Math.round(y[N].g+b[N].g*p)+","+Math.round(y[N].b+b[N].b*p)+","+(y[N].a+b[N].a*p)+")");else for(N=0;N<F;N++)E.push((y[N]||0)+b[N]*p);else u.indexOf(S)!==-1?E="rgba("+Math.round(y.r+b.r*p)+","+Math.round(y.g+b.g*p)+","+Math.round(y.b+b.b*p)+","+(y.a+b.a*p)+")":E=y+b*p;v.setAttr(S,E)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const p=this.node,v=m.attrs[p._id][this._id];v.points&&v.points.trueEnd&&p.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const p=this.node,v=m.attrs[p._id][this._id];v.points&&v.points.trueStart&&p.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(p){return this.tween.seek(p*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const p=this.node._id,v=this._id,_=m.tweens[p];this.pause(),this.anim&&this.anim.stop();for(const S in _)delete m.tweens[p][S];delete m.attrs[p][v],m.tweens[p]&&(Object.keys(m.tweens[p]).length===0&&delete m.tweens[p],Object.keys(m.attrs[p]).length===0&&delete m.attrs[p])}}t.Tween=m,m.attrs={},m.tweens={},n.Node.prototype.to=function(x){const p=x.onFinish;x.node=this,x.onFinish=function(){this.destroy(),p&&p()},new m(x).play()},t.Easings={BackEaseIn(x,p,v,_){return v*(x/=_)*x*((1.70158+1)*x-1.70158)+p},BackEaseOut(x,p,v,_){return v*((x=x/_-1)*x*((1.70158+1)*x+1.70158)+1)+p},BackEaseInOut(x,p,v,_){let S=1.70158;return(x/=_/2)<1?v/2*(x*x*(((S*=1.525)+1)*x-S))+p:v/2*((x-=2)*x*(((S*=1.525)+1)*x+S)+2)+p},ElasticEaseIn(x,p,v,_,S,w){let y=0;return x===0?p:(x/=_)===1?p+v:(w||(w=_*.3),!S||S<Math.abs(v)?(S=v,y=w/4):y=w/(2*Math.PI)*Math.asin(v/S),-(S*Math.pow(2,10*(x-=1))*Math.sin((x*_-y)*(2*Math.PI)/w))+p)},ElasticEaseOut(x,p,v,_,S,w){let y=0;return x===0?p:(x/=_)===1?p+v:(w||(w=_*.3),!S||S<Math.abs(v)?(S=v,y=w/4):y=w/(2*Math.PI)*Math.asin(v/S),S*Math.pow(2,-10*x)*Math.sin((x*_-y)*(2*Math.PI)/w)+v+p)},ElasticEaseInOut(x,p,v,_,S,w){let y=0;return x===0?p:(x/=_/2)===2?p+v:(w||(w=_*(.3*1.5)),!S||S<Math.abs(v)?(S=v,y=w/4):y=w/(2*Math.PI)*Math.asin(v/S),x<1?-.5*(S*Math.pow(2,10*(x-=1))*Math.sin((x*_-y)*(2*Math.PI)/w))+p:S*Math.pow(2,-10*(x-=1))*Math.sin((x*_-y)*(2*Math.PI)/w)*.5+v+p)},BounceEaseOut(x,p,v,_){return(x/=_)<1/2.75?v*(7.5625*x*x)+p:x<2/2.75?v*(7.5625*(x-=1.5/2.75)*x+.75)+p:x<2.5/2.75?v*(7.5625*(x-=2.25/2.75)*x+.9375)+p:v*(7.5625*(x-=2.625/2.75)*x+.984375)+p},BounceEaseIn(x,p,v,_){return v-t.Easings.BounceEaseOut(_-x,0,v,_)+p},BounceEaseInOut(x,p,v,_){return x<_/2?t.Easings.BounceEaseIn(x*2,0,v,_)*.5+p:t.Easings.BounceEaseOut(x*2-_,0,v,_)*.5+v*.5+p},EaseIn(x,p,v,_){return v*(x/=_)*x+p},EaseOut(x,p,v,_){return-v*(x/=_)*(x-2)+p},EaseInOut(x,p,v,_){return(x/=_/2)<1?v/2*x*x+p:-v/2*(--x*(x-2)-1)+p},StrongEaseIn(x,p,v,_){return v*(x/=_)*x*x*x*x+p},StrongEaseOut(x,p,v,_){return v*((x=x/_-1)*x*x*x*x+1)+p},StrongEaseInOut(x,p,v,_){return(x/=_/2)<1?v/2*x*x*x*x*x+p:v/2*((x-=2)*x*x*x*x+2)+p},Linear(x,p,v,_){return v*x/_+p}}})(TP);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=ar,r=mn,n=rn,s=Vu,a=SP,i=Wg,o=my,l=qf,u=hy,d=ts,h=Zf,m=TP,x=Qo,p=Bi;t.Konva=r.Util._assign(e.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:o.FastLayer,Group:l.Group,DD:u.DD,Shape:d.Shape,shapes:d.shapes,Animation:h.Animation,Tween:m.Tween,Easings:m.Easings,Context:x.Context,Canvas:p.Canvas}),t.default=t.Konva})(r1);var py={};Object.defineProperty(py,"__esModule",{value:!0});py.Arc=void 0;const xy=fr,pK=ts,M5=ar,yy=Kt,xK=ar;let ml=class extends pK.Shape{_sceneFunc(e){const r=M5.Konva.getAngle(this.angle()),n=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,r,n),e.arc(0,0,this.innerRadius(),r,0,!n),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),s=M5.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(s,Math.PI)),i=1,o=Math.sin(Math.min(Math.max(Math.PI,s),3*Math.PI/2)),l=Math.sin(Math.min(s,Math.PI/2)),u=a*(a>0?e:r),d=i*r,h=o*(o>0?e:r),m=l*(l>0?r:e);return{x:u,y:n?-1*m:h,width:d-u,height:m-h}}};py.Arc=ml;ml.prototype._centroid=!0;ml.prototype.className="Arc";ml.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,xK._registerNode)(ml);xy.Factory.addGetterSetter(ml,"innerRadius",0,(0,yy.getNumberValidator)());xy.Factory.addGetterSetter(ml,"outerRadius",0,(0,yy.getNumberValidator)());xy.Factory.addGetterSetter(ml,"angle",0,(0,yy.getNumberValidator)());xy.Factory.addGetterSetter(ml,"clockwise",!1,(0,yy.getBooleanValidator)());var vy={},Vg={};Object.defineProperty(Vg,"__esModule",{value:!0});Vg.Line=void 0;const wy=fr,yK=ar,vK=ts,EP=Kt;function IS(t,e,r,n,s,a,i){const o=Math.sqrt(Math.pow(r-t,2)+Math.pow(n-e,2)),l=Math.sqrt(Math.pow(s-r,2)+Math.pow(a-n,2)),u=i*o/(o+l),d=i*l/(o+l),h=r-u*(s-t),m=n-u*(a-e),x=r+d*(s-t),p=n+d*(a-e);return[h,m,x,p]}function L5(t,e){const r=t.length,n=[];for(let s=2;s<r-2;s+=2){const a=IS(t[s-2],t[s-1],t[s],t[s+1],t[s+2],t[s+3],e);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(t[s]),n.push(t[s+1]),n.push(a[2]),n.push(a[3]))}return n}let wc=class extends vK.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const r=this.points(),n=r.length,s=this.tension(),a=this.closed(),i=this.bezier();if(!n)return;let o=0;if(e.beginPath(),e.moveTo(r[0],r[1]),s!==0&&n>4){const l=this.getTensionPoints(),u=l.length;for(o=a?0:4,a||e.quadraticCurveTo(l[0],l[1],l[2],l[3]);o<u-2;)e.bezierCurveTo(l[o++],l[o++],l[o++],l[o++],l[o++],l[o++]);a||e.quadraticCurveTo(l[u-2],l[u-1],r[n-2],r[n-1])}else if(i)for(o=2;o<n;)e.bezierCurveTo(r[o++],r[o++],r[o++],r[o++],r[o++],r[o++]);else for(o=2;o<n;o+=2)e.lineTo(r[o],r[o+1]);a?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():L5(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),r=e.length,n=this.tension(),s=IS(e[r-2],e[r-1],e[0],e[1],e[2],e[3],n),a=IS(e[r-4],e[r-3],e[r-2],e[r-1],e[0],e[1],n),i=L5(e,n);return[s[2],s[3]].concat(i).concat([a[0],a[1],e[r-2],e[r-1],a[2],a[3],s[0],s[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let r=e[0],n=e[0],s=e[1],a=e[1],i,o;for(let l=0;l<e.length/2;l++)i=e[l*2],o=e[l*2+1],r=Math.min(r,i),n=Math.max(n,i),s=Math.min(s,o),a=Math.max(a,o);return{x:r,y:s,width:n-r,height:a-s}}};Vg.Line=wc;wc.prototype.className="Line";wc.prototype._attrsAffectingSize=["points","bezier","tension"];(0,yK._registerNode)(wc);wy.Factory.addGetterSetter(wc,"closed",!1);wy.Factory.addGetterSetter(wc,"bezier",!1);wy.Factory.addGetterSetter(wc,"tension",0,(0,EP.getNumberValidator)());wy.Factory.addGetterSetter(wc,"points",[],(0,EP.getNumberArrayValidator)());var eh={},NP={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(i,o,l)=>{let u,d;const m=l/2;u=0;for(let x=0;x<20;x++)d=m*t.tValues[20][x]+m,u+=t.cValues[20][x]*n(i,o,d);return m*u};t.getCubicArcLength=e;const r=(i,o,l)=>{l===void 0&&(l=1);const u=i[0]-2*i[1]+i[2],d=o[0]-2*o[1]+o[2],h=2*i[1]-2*i[0],m=2*o[1]-2*o[0],x=4*(u*u+d*d),p=4*(u*h+d*m),v=h*h+m*m;if(x===0)return l*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(o[2]-o[0],2));const _=p/(2*x),S=v/x,w=l+_,y=S-_*_,b=w*w+y>0?Math.sqrt(w*w+y):0,E=_*_+y>0?Math.sqrt(_*_+y):0,N=_+Math.sqrt(_*_+y)!==0?y*Math.log(Math.abs((w+b)/(_+E))):0;return Math.sqrt(x)/2*(w*b-_*E+N)};t.getQuadraticArcLength=r;function n(i,o,l){const u=s(1,l,i),d=s(1,l,o),h=u*u+d*d;return Math.sqrt(h)}const s=(i,o,l)=>{const u=l.length-1;let d,h;if(u===0)return 0;if(i===0){h=0;for(let m=0;m<=u;m++)h+=t.binomialCoefficients[u][m]*Math.pow(1-o,u-m)*Math.pow(o,m)*l[m];return h}else{d=new Array(u);for(let m=0;m<u;m++)d[m]=u*(l[m+1]-l[m]);return s(i-1,o,d)}},a=(i,o,l)=>{let u=1,d=i/o,h=(i-l(d))/o,m=0;for(;u>.001;){const x=l(d+h),p=Math.abs(i-x)/o;if(p<u)u=p,d+=h;else{const v=l(d-h),_=Math.abs(i-v)/o;_<u?(u=_,d-=h):h/=2}if(m++,m>500)break}return d};t.t2length=a})(NP);Object.defineProperty(eh,"__esModule",{value:!0});eh.Path=void 0;const wK=fr,_K=ar,SK=ts,kd=NP;let Gg=class fa extends SK.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=fa.parsePathData(this.data()),this.pathLength=fa.getPathLength(this.dataArray)}_sceneFunc(e){const r=this.dataArray;e.beginPath();let n=!1;for(let s=0;s<r.length;s++){const a=r[s].command,i=r[s].points;switch(a){case"L":e.lineTo(i[0],i[1]);break;case"M":e.moveTo(i[0],i[1]);break;case"C":e.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"Q":e.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case"A":const o=i[0],l=i[1],u=i[2],d=i[3],h=i[4],m=i[5],x=i[6],p=i[7],v=u>d?u:d,_=u>d?1:u/d,S=u>d?d/u:1;e.translate(o,l),e.rotate(x),e.scale(_,S),e.arc(0,0,v,h,h+m,1-p),e.scale(1/_,1/S),e.rotate(-x),e.translate(-o,-l);break;case"z":n=!0,e.closePath();break}}!n&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(l){if(l.command==="A"){const u=l.points[4],d=l.points[5],h=l.points[4]+d;let m=Math.PI/180;if(Math.abs(u-h)<m&&(m=Math.abs(u-h)),d<0)for(let x=u-m;x>h;x-=m){const p=fa.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],x,0);e.push(p.x,p.y)}else for(let x=u+m;x<h;x+=m){const p=fa.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],x,0);e.push(p.x,p.y)}}else if(l.command==="C")for(let u=0;u<=1;u+=.01){const d=fa.getPointOnCubicBezier(u,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);e.push(d.x,d.y)}else e=e.concat(l.points)});let r=e[0],n=e[0],s=e[1],a=e[1],i,o;for(let l=0;l<e.length/2;l++)i=e[l*2],o=e[l*2+1],isNaN(i)||(r=Math.min(r,i),n=Math.max(n,i)),isNaN(o)||(s=Math.min(s,o),a=Math.max(a,o));return{x:r,y:s,width:n-r,height:a-s}}getLength(){return this.pathLength}getPointAtLength(e){return fa.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,r,n,s){return Math.sqrt((n-e)*(n-e)+(s-r)*(s-r))}static getPathLength(e){let r=0;for(let n=0;n<e.length;++n)r+=e[n].pathLength;return r}static getPointAtLengthOfDataArray(e,r){let n,s=0,a=r.length;if(!a)return null;for(;s<a&&e>r[s].pathLength;)e-=r[s].pathLength,++s;if(s===a)return n=r[s-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return r[s].command==="M"?(n=r[s].points.slice(0,2),{x:n[0],y:n[1]}):{x:r[s].start.x,y:r[s].start.y};const i=r[s],o=i.points;switch(i.command){case"L":return fa.getPointOnLine(e,i.start.x,i.start.y,o[0],o[1]);case"C":return fa.getPointOnCubicBezier((0,kd.t2length)(e,fa.getPathLength(r),v=>(0,kd.getCubicArcLength)([i.start.x,o[0],o[2],o[4]],[i.start.y,o[1],o[3],o[5]],v)),i.start.x,i.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return fa.getPointOnQuadraticBezier((0,kd.t2length)(e,fa.getPathLength(r),v=>(0,kd.getQuadraticArcLength)([i.start.x,o[0],o[2]],[i.start.y,o[1],o[3]],v)),i.start.x,i.start.y,o[0],o[1],o[2],o[3]);case"A":const l=o[0],u=o[1],d=o[2],h=o[3],m=o[5],x=o[6];let p=o[4];return p+=m*e/i.pathLength,fa.getPointOnEllipticalArc(l,u,d,h,p,x)}return null}static getPointOnLine(e,r,n,s,a,i,o){i=i??r,o=o??n;const l=this.getLineLength(r,n,s,a);if(l<1e-10)return{x:r,y:n};if(s===r)return{x:i,y:o+(a>n?e:-e)};const u=(a-n)/(s-r),d=Math.sqrt(e*e/(1+u*u))*(s<r?-1:1),h=u*d;if(Math.abs(o-n-u*(i-r))<1e-10)return{x:i+d,y:o+h};const m=((i-r)*(s-r)+(o-n)*(a-n))/(l*l),x=r+m*(s-r),p=n+m*(a-n),v=this.getLineLength(i,o,x,p),_=Math.sqrt(e*e-v*v),S=Math.sqrt(_*_/(1+u*u))*(s<r?-1:1),w=u*S;return{x:x+S,y:p+w}}static getPointOnCubicBezier(e,r,n,s,a,i,o,l,u){function d(_){return _*_*_}function h(_){return 3*_*_*(1-_)}function m(_){return 3*_*(1-_)*(1-_)}function x(_){return(1-_)*(1-_)*(1-_)}const p=l*d(e)+i*h(e)+s*m(e)+r*x(e),v=u*d(e)+o*h(e)+a*m(e)+n*x(e);return{x:p,y:v}}static getPointOnQuadraticBezier(e,r,n,s,a,i,o){function l(x){return x*x}function u(x){return 2*x*(1-x)}function d(x){return(1-x)*(1-x)}const h=i*l(e)+s*u(e)+r*d(e),m=o*l(e)+a*u(e)+n*d(e);return{x:h,y:m}}static getPointOnEllipticalArc(e,r,n,s,a,i){const o=Math.cos(i),l=Math.sin(i),u={x:n*Math.cos(a),y:s*Math.sin(a)};return{x:e+(u.x*o-u.y*l),y:r+(u.x*l+u.y*o)}}static parsePathData(e){if(!e)return[];let r=e;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(let h=0;h<n.length;h++)r=r.replace(new RegExp(n[h],"g"),"|"+n[h]);const s=r.split("|"),a=[],i=[];let o=0,l=0;const u=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(let h=1;h<s.length;h++){let m=s[h],x=m.charAt(0);for(m=m.slice(1),i.length=0;d=u.exec(m);)i.push(d[0]);const p=[];for(let v=0,_=i.length;v<_;v++){if(i[v]==="00"){p.push(0,0);continue}const S=parseFloat(i[v]);isNaN(S)?p.push(0):p.push(S)}for(;p.length>0&&!isNaN(p[0]);){let v="",_=[];const S=o,w=l;let y,b,E,N,F,T,P,D,R,I;switch(x){case"l":o+=p.shift(),l+=p.shift(),v="L",_.push(o,l);break;case"L":o=p.shift(),l=p.shift(),_.push(o,l);break;case"m":const W=p.shift(),le=p.shift();if(o+=W,l+=le,v="M",a.length>2&&a[a.length-1].command==="z"){for(let q=a.length-2;q>=0;q--)if(a[q].command==="M"){o=a[q].points[0]+W,l=a[q].points[1]+le;break}}_.push(o,l),x="l";break;case"M":o=p.shift(),l=p.shift(),v="M",_.push(o,l),x="L";break;case"h":o+=p.shift(),v="L",_.push(o,l);break;case"H":o=p.shift(),v="L",_.push(o,l);break;case"v":l+=p.shift(),v="L",_.push(o,l);break;case"V":l=p.shift(),v="L",_.push(o,l);break;case"C":_.push(p.shift(),p.shift(),p.shift(),p.shift()),o=p.shift(),l=p.shift(),_.push(o,l);break;case"c":_.push(o+p.shift(),l+p.shift(),o+p.shift(),l+p.shift()),o+=p.shift(),l+=p.shift(),v="C",_.push(o,l);break;case"S":b=o,E=l,y=a[a.length-1],y.command==="C"&&(b=o+(o-y.points[2]),E=l+(l-y.points[3])),_.push(b,E,p.shift(),p.shift()),o=p.shift(),l=p.shift(),v="C",_.push(o,l);break;case"s":b=o,E=l,y=a[a.length-1],y.command==="C"&&(b=o+(o-y.points[2]),E=l+(l-y.points[3])),_.push(b,E,o+p.shift(),l+p.shift()),o+=p.shift(),l+=p.shift(),v="C",_.push(o,l);break;case"Q":_.push(p.shift(),p.shift()),o=p.shift(),l=p.shift(),_.push(o,l);break;case"q":_.push(o+p.shift(),l+p.shift()),o+=p.shift(),l+=p.shift(),v="Q",_.push(o,l);break;case"T":b=o,E=l,y=a[a.length-1],y.command==="Q"&&(b=o+(o-y.points[0]),E=l+(l-y.points[1])),o=p.shift(),l=p.shift(),v="Q",_.push(b,E,o,l);break;case"t":b=o,E=l,y=a[a.length-1],y.command==="Q"&&(b=o+(o-y.points[0]),E=l+(l-y.points[1])),o+=p.shift(),l+=p.shift(),v="Q",_.push(b,E,o,l);break;case"A":N=p.shift(),F=p.shift(),T=p.shift(),P=p.shift(),D=p.shift(),R=o,I=l,o=p.shift(),l=p.shift(),v="A",_=this.convertEndpointToCenterParameterization(R,I,o,l,P,D,N,F,T);break;case"a":N=p.shift(),F=p.shift(),T=p.shift(),P=p.shift(),D=p.shift(),R=o,I=l,o+=p.shift(),l+=p.shift(),v="A",_=this.convertEndpointToCenterParameterization(R,I,o,l,P,D,N,F,T);break}a.push({command:v||x,points:_,start:{x:S,y:w},pathLength:this.calcLength(S,w,v||x,_)})}(x==="z"||x==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(e,r,n,s){let a,i,o,l;const u=fa;switch(n){case"L":return u.getLineLength(e,r,s[0],s[1]);case"C":return(0,kd.getCubicArcLength)([e,s[0],s[2],s[4]],[r,s[1],s[3],s[5]],1);case"Q":return(0,kd.getQuadraticArcLength)([e,s[0],s[2]],[r,s[1],s[3]],1);case"A":a=0;const d=s[4],h=s[5],m=s[4]+h;let x=Math.PI/180;if(Math.abs(d-m)<x&&(x=Math.abs(d-m)),i=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],d,0),h<0)for(l=d-x;l>m;l-=x)o=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),a+=u.getLineLength(i.x,i.y,o.x,o.y),i=o;else for(l=d+x;l<m;l+=x)o=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),a+=u.getLineLength(i.x,i.y,o.x,o.y),i=o;return o=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],m,0),a+=u.getLineLength(i.x,i.y,o.x,o.y),a}return 0}static convertEndpointToCenterParameterization(e,r,n,s,a,i,o,l,u){const d=u*(Math.PI/180),h=Math.cos(d)*(e-n)/2+Math.sin(d)*(r-s)/2,m=-1*Math.sin(d)*(e-n)/2+Math.cos(d)*(r-s)/2,x=h*h/(o*o)+m*m/(l*l);x>1&&(o*=Math.sqrt(x),l*=Math.sqrt(x));let p=Math.sqrt((o*o*(l*l)-o*o*(m*m)-l*l*(h*h))/(o*o*(m*m)+l*l*(h*h)));a===i&&(p*=-1),isNaN(p)&&(p=0);const v=p*o*m/l,_=p*-l*h/o,S=(e+n)/2+Math.cos(d)*v-Math.sin(d)*_,w=(r+s)/2+Math.sin(d)*v+Math.cos(d)*_,y=function(D){return Math.sqrt(D[0]*D[0]+D[1]*D[1])},b=function(D,R){return(D[0]*R[0]+D[1]*R[1])/(y(D)*y(R))},E=function(D,R){return(D[0]*R[1]<D[1]*R[0]?-1:1)*Math.acos(b(D,R))},N=E([1,0],[(h-v)/o,(m-_)/l]),F=[(h-v)/o,(m-_)/l],T=[(-1*h-v)/o,(-1*m-_)/l];let P=E(F,T);return b(F,T)<=-1&&(P=Math.PI),b(F,T)>=1&&(P=0),i===0&&P>0&&(P=P-2*Math.PI),i===1&&P<0&&(P=P+2*Math.PI),[S,w,o,l,N,P,d,i]}};eh.Path=Gg;Gg.prototype.className="Path";Gg.prototype._attrsAffectingSize=["data"];(0,_K._registerNode)(Gg);wK.Factory.addGetterSetter(Gg,"data");Object.defineProperty(vy,"__esModule",{value:!0});vy.Arrow=void 0;const _y=fr,bK=Vg,AP=Kt,kK=ar,I5=eh;let Hu=class extends bK.Line{_sceneFunc(e){super._sceneFunc(e);const r=Math.PI*2,n=this.points();let s=n;const a=this.tension()!==0&&n.length>4;a&&(s=this.getTensionPoints());const i=this.pointerLength(),o=n.length;let l,u;if(a){const m=[s[s.length-4],s[s.length-3],s[s.length-2],s[s.length-1],n[o-2],n[o-1]],x=I5.Path.calcLength(s[s.length-4],s[s.length-3],"C",m),p=I5.Path.getPointOnQuadraticBezier(Math.min(1,1-i/x),m[0],m[1],m[2],m[3],m[4],m[5]);l=n[o-2]-p.x,u=n[o-1]-p.y}else l=n[o-2]-n[o-4],u=n[o-1]-n[o-3];const d=(Math.atan2(u,l)+r)%r,h=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(n[o-2],n[o-1]),e.rotate(d),e.moveTo(0,0),e.lineTo(-i,h/2),e.lineTo(-i,-h/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(n[0],n[1]),a?(l=(s[0]+s[2])/2-n[0],u=(s[1]+s[3])/2-n[1]):(l=n[2]-n[0],u=n[3]-n[1]),e.rotate((Math.atan2(-u,-l)+r)%r),e.moveTo(0,0),e.lineTo(-i,h/2),e.lineTo(-i,-h/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),r=this.pointerWidth()/2;return{x:e.x,y:e.y-r,width:e.width,height:e.height+r*2}}};vy.Arrow=Hu;Hu.prototype.className="Arrow";(0,kK._registerNode)(Hu);_y.Factory.addGetterSetter(Hu,"pointerLength",10,(0,AP.getNumberValidator)());_y.Factory.addGetterSetter(Hu,"pointerWidth",10,(0,AP.getNumberValidator)());_y.Factory.addGetterSetter(Hu,"pointerAtBeginning",!1);_y.Factory.addGetterSetter(Hu,"pointerAtEnding",!0);var Sy={};Object.defineProperty(Sy,"__esModule",{value:!0});Sy.Circle=void 0;const CK=fr,TK=ts,EK=Kt,NK=ar;let th=class extends TK.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};Sy.Circle=th;th.prototype._centroid=!0;th.prototype.className="Circle";th.prototype._attrsAffectingSize=["radius"];(0,NK._registerNode)(th);CK.Factory.addGetterSetter(th,"radius",0,(0,EK.getNumberValidator)());var by={};Object.defineProperty(by,"__esModule",{value:!0});by.Ellipse=void 0;const TC=fr,AK=ts,FP=Kt,FK=ar;let _c=class extends AK.Shape{_sceneFunc(e){const r=this.radiusX(),n=this.radiusY();e.beginPath(),e.save(),r!==n&&e.scale(1,n/r),e.arc(0,0,r,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}};by.Ellipse=_c;_c.prototype.className="Ellipse";_c.prototype._centroid=!0;_c.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,FK._registerNode)(_c);TC.Factory.addComponentsGetterSetter(_c,"radius",["x","y"]);TC.Factory.addGetterSetter(_c,"radiusX",0,(0,FP.getNumberValidator)());TC.Factory.addGetterSetter(_c,"radiusY",0,(0,FP.getNumberValidator)());var ky={};Object.defineProperty(ky,"__esModule",{value:!0});ky.Image=void 0;const P2=mn,Ku=fr,jK=ts,PK=ar,Hg=Kt;let ko=class jP extends jK.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",r=>{this._removeImageLoad(r.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),r=this.hasShadow();return e&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const r=this.getWidth(),n=this.getHeight(),s=this.cornerRadius(),a=this.attrs.image;let i;if(a){const o=this.attrs.cropWidth,l=this.attrs.cropHeight;o&&l?i=[a,this.cropX(),this.cropY(),o,l,0,0,r,n]:i=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||s)&&(e.beginPath(),s?P2.Util.drawRoundedRectPath(e,r,n,s):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)),a&&(s&&e.clip(),e.drawImage.apply(e,i))}_hitFunc(e){const r=this.width(),n=this.height(),s=this.cornerRadius();e.beginPath(),s?P2.Util.drawRoundedRectPath(e,r,n,s):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,r;return(e=this.attrs.width)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var e,r;return(e=this.attrs.height)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(e,r,n=null){const s=P2.Util.createImageElement();s.onload=function(){const a=new jP({image:s});r(a)},s.onerror=n,s.crossOrigin="Anonymous",s.src=e}};ky.Image=ko;ko.prototype.className="Image";(0,PK._registerNode)(ko);Ku.Factory.addGetterSetter(ko,"cornerRadius",0,(0,Hg.getNumberOrArrayOfNumbersValidator)(4));Ku.Factory.addGetterSetter(ko,"image");Ku.Factory.addComponentsGetterSetter(ko,"crop",["x","y","width","height"]);Ku.Factory.addGetterSetter(ko,"cropX",0,(0,Hg.getNumberValidator)());Ku.Factory.addGetterSetter(ko,"cropY",0,(0,Hg.getNumberValidator)());Ku.Factory.addGetterSetter(ko,"cropWidth",0,(0,Hg.getNumberValidator)());Ku.Factory.addGetterSetter(ko,"cropHeight",0,(0,Hg.getNumberValidator)());var Ff={};Object.defineProperty(Ff,"__esModule",{value:!0});Ff.Tag=Ff.Label=void 0;const Cy=fr,DK=ts,RK=qf,EC=Kt,PP=ar,DP=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],OK="Change.konva",MK="none",BS="up",US="right",$S="down",zS="left",LK=DP.length;let NC=class extends RK.Group{constructor(e){super(e),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let r=this,n;const s=function(){r._sync()};for(n=0;n<LK;n++)e.on(DP[n]+OK,s)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),r=this.getTag(),n,s,a,i,o,l,u;if(e&&r){switch(n=e.width(),s=e.height(),a=r.pointerDirection(),i=r.pointerWidth(),u=r.pointerHeight(),o=0,l=0,a){case BS:o=n/2,l=-1*u;break;case US:o=n+i,l=s/2;break;case $S:o=n/2,l=s+u;break;case zS:o=-1*i,l=s/2;break}r.setAttrs({x:-1*o,y:-1*l,width:n,height:s}),e.setAttrs({x:-1*o,y:-1*l})}}};Ff.Label=NC;NC.prototype.className="Label";(0,PP._registerNode)(NC);let Xu=class extends DK.Shape{_sceneFunc(e){const r=this.width(),n=this.height(),s=this.pointerDirection(),a=this.pointerWidth(),i=this.pointerHeight(),o=this.cornerRadius();let l=0,u=0,d=0,h=0;typeof o=="number"?l=u=d=h=Math.min(o,r/2,n/2):(l=Math.min(o[0]||0,r/2,n/2),u=Math.min(o[1]||0,r/2,n/2),h=Math.min(o[2]||0,r/2,n/2),d=Math.min(o[3]||0,r/2,n/2)),e.beginPath(),e.moveTo(l,0),s===BS&&(e.lineTo((r-a)/2,0),e.lineTo(r/2,-1*i),e.lineTo((r+a)/2,0)),e.lineTo(r-u,0),e.arc(r-u,u,u,Math.PI*3/2,0,!1),s===US&&(e.lineTo(r,(n-i)/2),e.lineTo(r+a,n/2),e.lineTo(r,(n+i)/2)),e.lineTo(r,n-h),e.arc(r-h,n-h,h,0,Math.PI/2,!1),s===$S&&(e.lineTo((r+a)/2,n),e.lineTo(r/2,n+i),e.lineTo((r-a)/2,n)),e.lineTo(d,n),e.arc(d,n-d,d,Math.PI/2,Math.PI,!1),s===zS&&(e.lineTo(0,(n+i)/2),e.lineTo(-1*a,n/2),e.lineTo(0,(n-i)/2)),e.lineTo(0,l),e.arc(l,l,l,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,r=0,n=this.pointerWidth(),s=this.pointerHeight(),a=this.pointerDirection(),i=this.width(),o=this.height();return a===BS?(r-=s,o+=s):a===$S?o+=s:a===zS?(e-=n*1.5,i+=n):a===US&&(i+=n*1.5),{x:e,y:r,width:i,height:o}}};Ff.Tag=Xu;Xu.prototype.className="Tag";(0,PP._registerNode)(Xu);Cy.Factory.addGetterSetter(Xu,"pointerDirection",MK);Cy.Factory.addGetterSetter(Xu,"pointerWidth",0,(0,EC.getNumberValidator)());Cy.Factory.addGetterSetter(Xu,"pointerHeight",0,(0,EC.getNumberValidator)());Cy.Factory.addGetterSetter(Xu,"cornerRadius",0,(0,EC.getNumberOrArrayOfNumbersValidator)(4));var Kg={};Object.defineProperty(Kg,"__esModule",{value:!0});Kg.Rect=void 0;const IK=fr,BK=ts,UK=ar,$K=mn,zK=Kt;let Ty=class extends BK.Shape{_sceneFunc(e){const r=this.cornerRadius(),n=this.width(),s=this.height();e.beginPath(),r?$K.Util.drawRoundedRectPath(e,n,s,r):e.rect(0,0,n,s),e.closePath(),e.fillStrokeShape(this)}};Kg.Rect=Ty;Ty.prototype.className="Rect";(0,UK._registerNode)(Ty);IK.Factory.addGetterSetter(Ty,"cornerRadius",0,(0,zK.getNumberOrArrayOfNumbersValidator)(4));var Ey={};Object.defineProperty(Ey,"__esModule",{value:!0});Ey.RegularPolygon=void 0;const RP=fr,WK=ts,OP=Kt,VK=ar;let Yu=class extends WK.Shape{_sceneFunc(e){const r=this._getPoints();e.beginPath(),e.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)e.lineTo(r[n].x,r[n].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let s=0;s<e;s++)n.push({x:r*Math.sin(s*2*Math.PI/e),y:-1*r*Math.cos(s*2*Math.PI/e)});return n}getSelfRect(){const e=this._getPoints();let r=e[0].x,n=e[0].y,s=e[0].x,a=e[0].y;return e.forEach(i=>{r=Math.min(r,i.x),n=Math.max(n,i.x),s=Math.min(s,i.y),a=Math.max(a,i.y)}),{x:r,y:s,width:n-r,height:a-s}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};Ey.RegularPolygon=Yu;Yu.prototype.className="RegularPolygon";Yu.prototype._centroid=!0;Yu.prototype._attrsAffectingSize=["radius"];(0,VK._registerNode)(Yu);RP.Factory.addGetterSetter(Yu,"radius",0,(0,OP.getNumberValidator)());RP.Factory.addGetterSetter(Yu,"sides",0,(0,OP.getNumberValidator)());var Ny={};Object.defineProperty(Ny,"__esModule",{value:!0});Ny.Ring=void 0;const MP=fr,GK=ts,LP=Kt,HK=ar,B5=Math.PI*2;let Ju=class extends GK.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,B5,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),B5,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};Ny.Ring=Ju;Ju.prototype.className="Ring";Ju.prototype._centroid=!0;Ju.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,HK._registerNode)(Ju);MP.Factory.addGetterSetter(Ju,"innerRadius",0,(0,LP.getNumberValidator)());MP.Factory.addGetterSetter(Ju,"outerRadius",0,(0,LP.getNumberValidator)());var Ay={};Object.defineProperty(Ay,"__esModule",{value:!0});Ay.Sprite=void 0;const Qu=fr,KK=ts,XK=Zf,IP=Kt,YK=ar;let Co=class extends KK.Shape{constructor(e){super(e),this._updated=!0,this.anim=new XK.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const r=this.animation(),n=this.frameIndex(),s=n*4,a=this.animations()[r],i=this.frameOffsets(),o=a[s+0],l=a[s+1],u=a[s+2],d=a[s+3],h=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,u,d),e.closePath(),e.fillStrokeShape(this)),h)if(i){const m=i[r],x=n*2;e.drawImage(h,o,l,u,d,m[x+0],m[x+1],u,d)}else e.drawImage(h,o,l,u,d,0,0,u,d)}_hitFunc(e){const r=this.animation(),n=this.frameIndex(),s=n*4,a=this.animations()[r],i=this.frameOffsets(),o=a[s+2],l=a[s+3];if(e.beginPath(),i){const u=i[r],d=n*2;e.rect(u[d+0],u[d+1],o,l)}else e.rect(0,0,o,l);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),r=this.animation(),n=this.animations(),s=n[r],a=s.length/4;e<a-1?this.frameIndex(e+1):this.frameIndex(0)}};Ay.Sprite=Co;Co.prototype.className="Sprite";(0,YK._registerNode)(Co);Qu.Factory.addGetterSetter(Co,"animation");Qu.Factory.addGetterSetter(Co,"animations");Qu.Factory.addGetterSetter(Co,"frameOffsets");Qu.Factory.addGetterSetter(Co,"image");Qu.Factory.addGetterSetter(Co,"frameIndex",0,(0,IP.getNumberValidator)());Qu.Factory.addGetterSetter(Co,"frameRate",17,(0,IP.getNumberValidator)());Qu.Factory.backCompat(Co,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Fy={};Object.defineProperty(Fy,"__esModule",{value:!0});Fy.Star=void 0;const AC=fr,JK=ts,FC=Kt,QK=ar;let Sc=class extends JK.Shape{_sceneFunc(e){const r=this.innerRadius(),n=this.outerRadius(),s=this.numPoints();e.beginPath(),e.moveTo(0,0-n);for(let a=1;a<s*2;a++){const i=a%2===0?n:r,o=i*Math.sin(a*Math.PI/s),l=-1*i*Math.cos(a*Math.PI/s);e.lineTo(o,l)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};Fy.Star=Sc;Sc.prototype.className="Star";Sc.prototype._centroid=!0;Sc.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,QK._registerNode)(Sc);AC.Factory.addGetterSetter(Sc,"numPoints",5,(0,FC.getNumberValidator)());AC.Factory.addGetterSetter(Sc,"innerRadius",0,(0,FC.getNumberValidator)());AC.Factory.addGetterSetter(Sc,"outerRadius",0,(0,FC.getNumberValidator)());var rh={};Object.defineProperty(rh,"__esModule",{value:!0});rh.Text=void 0;rh.stringToArray=Kc;const WS=mn,Ks=fr,qK=ts,D2=ar,bc=Kt,ZK=ar;function Kc(t){return[...t].reduce((e,r,n,s)=>{if(new RegExp("\\p{Emoji}","u").test(r)){const a=s[n+1];a&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(a)?(e.push(r+a),s[n+1]=""):e.push(r)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(r+(s[n+1]||""))?e.push(r+s[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(r)?e[e.length-1]+=r:r&&e.push(r);return e},[])}const Cd="auto",eX="center",BP="inherit",$h="justify",tX="Change.konva",rX="2d",U5="-",UP="left",nX="text",sX="Text",aX="top",iX="bottom",$5="middle",$P="normal",oX="px ",Fp=" ",lX="right",z5="rtl",cX="word",uX="char",W5="none",R2="",zP=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],dX=zP.length;function fX(t){return t.split(",").map(e=>{e=e.trim();const r=e.indexOf(" ")>=0,n=e.indexOf('"')>=0||e.indexOf("'")>=0;return r&&!n&&(e=`"${e}"`),e}).join(", ")}let jp;function O2(){return jp||(jp=WS.Util.createCanvasElement().getContext(rX),jp)}function hX(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function gX(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function mX(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}let kn=class extends qK.Shape{constructor(e){super(mX(e)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<dX;r++)this.on(zP[r]+tX,this._setTextData);this._setTextData()}_sceneFunc(e){const r=this.textArr,n=r.length;if(!this.text())return;let s=this.padding(),a=this.fontSize(),i=this.lineHeight()*a,o=this.verticalAlign(),l=this.direction(),u=0,d=this.align(),h=this.getWidth(),m=this.letterSpacing(),x=this.fill(),p=this.textDecoration(),v=p.indexOf("underline")!==-1,_=p.indexOf("line-through")!==-1,S;l=l===BP?e.direction:l;let w=i/2,y=$5;if(D2.Konva._fixTextRendering){const b=this.measureSize("M");y="alphabetic",w=(b.fontBoundingBoxAscent-b.fontBoundingBoxDescent)/2+i/2}for(l===z5&&e.setAttr("direction",l),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",y),e.setAttr("textAlign",UP),o===$5?u=(this.getHeight()-n*i-s*2)/2:o===iX&&(u=this.getHeight()-n*i-s*2),e.translate(s,u+s),S=0;S<n;S++){let b=0,E=0;const N=r[S],F=N.text,T=N.width,P=N.lastInParagraph;if(e.save(),d===lX?b+=h-T-s*2:d===eX&&(b+=(h-T-s*2)/2),v){e.save(),e.beginPath();const D=D2.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),R=b,I=w+E+D;e.moveTo(R,I);const W=d===$h&&!P?h-s*2:T;e.lineTo(R+Math.round(W),I),e.lineWidth=a/15;const le=this._getLinearGradient();e.strokeStyle=le||x,e.stroke(),e.restore()}if(_){e.save(),e.beginPath();const D=D2.Konva._fixTextRendering?-Math.round(a/4):0;e.moveTo(b,w+E+D);const R=d===$h&&!P?h-s*2:T;e.lineTo(b+Math.round(R),w+E+D),e.lineWidth=a/15;const I=this._getLinearGradient();e.strokeStyle=I||x,e.stroke(),e.restore()}if(l!==z5&&(m!==0||d===$h)){const D=F.split(" ").length-1,R=Kc(F);for(let I=0;I<R.length;I++){const W=R[I];W===" "&&!P&&d===$h&&(b+=(h-s*2-T)/D),this._partialTextX=b,this._partialTextY=w+E,this._partialText=W,e.fillStrokeShape(this),b+=this.measureSize(W).width+m}}else m!==0&&e.setAttr("letterSpacing",`${m}px`),this._partialTextX=b,this._partialTextY=w+E,this._partialText=F,e.fillStrokeShape(this);e.restore(),n>1&&(w+=i)}}_hitFunc(e){const r=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}setText(e){const r=WS.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(nX,r),this}getWidth(){return this.attrs.width===Cd||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Cd||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return WS.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var r,n,s,a,i,o,l,u,d,h,m;let x=O2(),p=this.fontSize(),v;x.save(),x.font=this._getContextFont(),v=x.measureText(e),x.restore();const _=p/100;return{actualBoundingBoxAscent:(r=v.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*_,actualBoundingBoxDescent:(n=v.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(s=v.actualBoundingBoxLeft)!==null&&s!==void 0?s:-7.421875*_,actualBoundingBoxRight:(a=v.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*_,alphabeticBaseline:(i=v.alphabeticBaseline)!==null&&i!==void 0?i:0,emHeightAscent:(o=v.emHeightAscent)!==null&&o!==void 0?o:100*_,emHeightDescent:(l=v.emHeightDescent)!==null&&l!==void 0?l:-20*_,fontBoundingBoxAscent:(u=v.fontBoundingBoxAscent)!==null&&u!==void 0?u:91*_,fontBoundingBoxDescent:(d=v.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*_,hangingBaseline:(h=v.hangingBaseline)!==null&&h!==void 0?h:72.80000305175781*_,ideographicBaseline:(m=v.ideographicBaseline)!==null&&m!==void 0?m:-21*_,width:v.width,height:p}}_getContextFont(){return this.fontStyle()+Fp+this.fontVariant()+Fp+(this.fontSize()+oX)+fX(this.fontFamily())}_addTextLine(e){this.align()===$h&&(e=e.trim());const n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){const r=this.letterSpacing(),n=e.length;return O2().measureText(e).width+r*n}_setTextData(){let e=this.text().split(`
`),r=+this.fontSize(),n=0,s=this.lineHeight()*r,a=this.attrs.width,i=this.attrs.height,o=a!==Cd&&a!==void 0,l=i!==Cd&&i!==void 0,u=this.padding(),d=a-u*2,h=i-u*2,m=0,x=this.wrap(),p=x!==W5,v=x!==uX&&p,_=this.ellipsis();this.textArr=[],O2().font=this._getContextFont();const S=_?this._getTextWidth(R2):0;for(let w=0,y=e.length;w<y;++w){let b=e[w],E=this._getTextWidth(b);if(o&&E>d)for(;b.length>0;){let N=0,F=Kc(b).length,T="",P=0;for(;N<F;){const D=N+F>>>1,R=Kc(b),I=R.slice(0,D+1).join(""),W=this._getTextWidth(I);(_&&l&&m+s>h?W+S:W)<=d?(N=D+1,T=I,P=W):F=D}if(T){if(v){const I=Kc(b),W=Kc(T),le=I[W.length],q=le===Fp||le===U5;let V;if(q&&P<=d)V=W.length;else{const K=W.lastIndexOf(Fp),U=W.lastIndexOf(U5);V=Math.max(K,U)+1}V>0&&(N=V,T=I.slice(0,N).join(""),P=this._getTextWidth(T))}if(T=T.trimRight(),this._addTextLine(T),n=Math.max(n,P),m+=s,this._shouldHandleEllipsis(m)){this._tryToAddEllipsisToLastLine();break}if(b=Kc(b).slice(N).join("").trimLeft(),b.length>0&&(E=this._getTextWidth(b),E<=d)){this._addTextLine(b),m+=s,n=Math.max(n,E);break}}else break}else this._addTextLine(b),m+=s,n=Math.max(n,E),this._shouldHandleEllipsis(m)&&w<y-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&m+s>h)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(e){const r=+this.fontSize(),n=this.lineHeight()*r,s=this.attrs.height,a=s!==Cd&&s!==void 0,i=this.padding(),o=s-i*2;return!(this.wrap()!==W5)||a&&e+n>o}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,r=e!==Cd&&e!==void 0,n=this.padding(),s=e-n*2,a=this.ellipsis(),i=this.textArr[this.textArr.length-1];!i||!a||(r&&(this._getTextWidth(i.text+R2)<s||(i.text=i.text.slice(0,i.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(i.text+R2))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return e&&r?!0:super._useBufferCanvas()}};rh.Text=kn;kn.prototype._fillFunc=hX;kn.prototype._strokeFunc=gX;kn.prototype.className=sX;kn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,ZK._registerNode)(kn);Ks.Factory.overWriteSetter(kn,"width",(0,bc.getNumberOrAutoValidator)());Ks.Factory.overWriteSetter(kn,"height",(0,bc.getNumberOrAutoValidator)());Ks.Factory.addGetterSetter(kn,"direction",BP);Ks.Factory.addGetterSetter(kn,"fontFamily","Arial");Ks.Factory.addGetterSetter(kn,"fontSize",12,(0,bc.getNumberValidator)());Ks.Factory.addGetterSetter(kn,"fontStyle",$P);Ks.Factory.addGetterSetter(kn,"fontVariant",$P);Ks.Factory.addGetterSetter(kn,"padding",0,(0,bc.getNumberValidator)());Ks.Factory.addGetterSetter(kn,"align",UP);Ks.Factory.addGetterSetter(kn,"verticalAlign",aX);Ks.Factory.addGetterSetter(kn,"lineHeight",1,(0,bc.getNumberValidator)());Ks.Factory.addGetterSetter(kn,"wrap",cX);Ks.Factory.addGetterSetter(kn,"ellipsis",!1,(0,bc.getBooleanValidator)());Ks.Factory.addGetterSetter(kn,"letterSpacing",0,(0,bc.getNumberValidator)());Ks.Factory.addGetterSetter(kn,"text","",(0,bc.getStringValidator)());Ks.Factory.addGetterSetter(kn,"textDecoration","");var jy={};Object.defineProperty(jy,"__esModule",{value:!0});jy.TextPath=void 0;const M2=mn,Gi=fr,pX=ts,zh=eh,L2=rh,WP=Kt,xX=ar,yX="",VP="normal";function GP(t){t.fillText(this.partialText,0,0)}function HP(t){t.strokeText(this.partialText,0,0)}let rs=class extends pX.Shape{constructor(e){super(e),this.dummyCanvas=M2.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return zh.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const r=this.pathLength;return e-1>r?null:zh.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=zh.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const r=this.textDecoration(),n=this.fill(),s=this.fontSize(),a=this.glyphInfo;r==="underline"&&e.beginPath();for(let i=0;i<a.length;i++){e.save();const o=a[i].p0;e.translate(o.x,o.y),e.rotate(a[i].rotation),this.partialText=a[i].text,e.fillStrokeShape(this),r==="underline"&&(i===0&&e.moveTo(0,s/2+1),e.lineTo(s,s/2+1)),e.restore()}r==="underline"&&(e.strokeStyle=n,e.lineWidth=s/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;e.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const s=r[n].p1;e.lineTo(s.x,s.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return M2.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return L2.Text.prototype.setText.call(this,e)}_getContextFont(){return L2.Text.prototype._getContextFont.call(this)}_getTextSize(e){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const s=n.measureText(e);return n.restore(),{width:s.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),s=this.align(),a=this.kerningFunc(),i=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let o=0;s==="center"&&(o=Math.max(0,this.pathLength/2-i/2)),s==="right"&&(o=Math.max(0,this.pathLength-i));const l=(0,L2.stringToArray)(this.text());let u=o;for(let d=0;d<l.length;d++){const h=this._getPointAtLength(u);if(!h)return;let m=this._getTextSize(l[d]).width+n;if(l[d]===" "&&s==="justify"){const w=this.text().split(" ").length-1;m+=(this.pathLength-i)/w}const x=this._getPointAtLength(u+m);if(!x)return;const p=zh.Path.getLineLength(h.x,h.y,x.x,x.y);let v=0;if(a)try{v=a(l[d-1],l[d])*this.fontSize()}catch{v=0}h.x+=v,x.x+=v,this.textWidth+=v;const _=zh.Path.getPointOnLine(v+p/2,h.x,h.y,x.x,x.y),S=Math.atan2(x.y-h.y,x.x-h.x);this.glyphInfo.push({transposeX:_.x,transposeY:_.y,text:l[d],rotation:S,p0:h,p1:x}),u+=m}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(u){e.push(u.p0.x),e.push(u.p0.y),e.push(u.p1.x),e.push(u.p1.y)});let r=e[0]||0,n=e[0]||0,s=e[1]||0,a=e[1]||0,i,o;for(let u=0;u<e.length/2;u++)i=e[u*2],o=e[u*2+1],r=Math.min(r,i),n=Math.max(n,i),s=Math.min(s,o),a=Math.max(a,o);const l=this.fontSize();return{x:r-l/2,y:s-l/2,width:n-r+l,height:a-s+l}}destroy(){return M2.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};jy.TextPath=rs;rs.prototype._fillFunc=GP;rs.prototype._strokeFunc=HP;rs.prototype._fillFuncHit=GP;rs.prototype._strokeFuncHit=HP;rs.prototype.className="TextPath";rs.prototype._attrsAffectingSize=["text","fontSize","data"];(0,xX._registerNode)(rs);Gi.Factory.addGetterSetter(rs,"data");Gi.Factory.addGetterSetter(rs,"fontFamily","Arial");Gi.Factory.addGetterSetter(rs,"fontSize",12,(0,WP.getNumberValidator)());Gi.Factory.addGetterSetter(rs,"fontStyle",VP);Gi.Factory.addGetterSetter(rs,"align","left");Gi.Factory.addGetterSetter(rs,"letterSpacing",0,(0,WP.getNumberValidator)());Gi.Factory.addGetterSetter(rs,"textBaseline","middle");Gi.Factory.addGetterSetter(rs,"fontVariant",VP);Gi.Factory.addGetterSetter(rs,"text",yX);Gi.Factory.addGetterSetter(rs,"textDecoration","");Gi.Factory.addGetterSetter(rs,"kerningFunc",void 0);var Py={};Object.defineProperty(Py,"__esModule",{value:!0});Py.Transformer=void 0;const Or=mn,Ar=fr,V5=rn,vX=ts,wX=Kg,G5=qf,Fi=ar,kc=Kt,_X=ar,KP="tr-konva",SX=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${KP}`).join(" "),H5="nodesRect",bX=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],kX={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},CX="ontouchstart"in Fi.Konva._global;function TX(t,e,r){if(t==="rotater")return r;e+=Or.Util.degToRad(kX[t]||0);const n=(Or.Util.radToDeg(e)%360+360)%360;return Or.Util._inRange(n,315+22.5,360)||Or.Util._inRange(n,0,22.5)?"ns-resize":Or.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":Or.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":Or.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":Or.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":Or.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":Or.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":Or.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(Or.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const s1=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function EX(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function XP(t,e,r){const n=r.x+(t.x-r.x)*Math.cos(e)-(t.y-r.y)*Math.sin(e),s=r.y+(t.x-r.x)*Math.sin(e)+(t.y-r.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:n,y:s}}function NX(t,e){const r=EX(t);return XP(t,e,r)}function AX(t,e,r){let n=e;for(let s=0;s<t.length;s++){const a=Fi.Konva.getAngle(t[s]),i=Math.abs(a-e)%(Math.PI*2);Math.min(i,Math.PI*2-i)<r&&(n=a)}return n}let VS=0,xr=class extends G5.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(SX,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return Or.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return KP+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const r=e.filter(s=>s.isAncestorOf(this)?(Or.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=r,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(s=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(s._attrsAffectingSize.length){const i=s._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");s.on(i,a)}s.on(bX.map(i=>i+`.${this._getEventNamespace()}`).join(" "),a),s.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(s)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let r;e.on(`dragstart.${this._getEventNamespace()}`,n=>{r=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(n,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const s=e.getAbsolutePosition(),a=s.x-r.x,i=s.y-r.y;this.nodes().forEach(o=>{if(o===e||o.isDragging())return;const l=o.getAbsolutePosition();o.setAbsolutePosition({x:l.x+a,y:l.y+i}),o.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(H5),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(H5,this.__getNodeRect)}__getNodeShape(e,r=this.rotation(),n){const s=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=e.getAbsoluteScale(n),i=e.getAbsolutePosition(n),o=s.x*a.x-e.offsetX()*a.x,l=s.y*a.y-e.offsetY()*a.y,u=(Fi.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:i.x+o*Math.cos(u)+l*Math.sin(-u),y:i.y+l*Math.cos(u)+o*Math.sin(u),width:s.width*a.x,height:s.height*a.y,rotation:u};return XP(d,-Fi.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const r=[];this.nodes().map(u=>{const d=u.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),h=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],m=u.getAbsoluteTransform();h.forEach(function(x){const p=m.point(x);r.push(p)})});const n=new Or.Transform;n.rotate(-Fi.Konva.getAngle(this.rotation()));let s=1/0,a=1/0,i=-1/0,o=-1/0;r.forEach(function(u){const d=n.point(u);s===void 0&&(s=i=d.x,a=o=d.y),s=Math.min(s,d.x),a=Math.min(a,d.y),i=Math.max(i,d.x),o=Math.max(o,d.y)}),n.invert();const l=n.point({x:s,y:a});return{x:l.x,y:l.y,width:i-s,height:o-a,rotation:Fi.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),s1.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const r=new wX.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:CX?10:"auto"}),n=this;r.on("mousedown touchstart",function(s){n._handleMouseDown(s)}),r.on("dragstart",s=>{r.stopDrag(),s.cancelBubble=!0}),r.on("dragend",s=>{s.cancelBubble=!0}),r.on("mouseenter",()=>{const s=Fi.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),i=TX(e,s,a);r.getStage().content&&(r.getStage().content.style.cursor=i),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const e=new vX.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const s=n.getParent(),a=s.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),s.rotateEnabled()&&s.rotateLineVisible()&&r.lineTo(n.width()/2,-s.rotateAnchorOffset()*Or.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const s=this.padding();r.beginPath(),r.rect(-s,-s,n.width()+s*2,n.height()+s*2),r.fillStrokeShape(n)}});this.add(e),this._proxyDrag(e),e.on("dragstart",r=>{r.cancelBubble=!0}),e.on("dragmove",r=>{r.cancelBubble=!0}),e.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,s=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(s,2));this.sin=Math.abs(s/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const i=e.target.getAbsolutePosition(),o=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-i.x,y:o.y-i.y},VS++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:e.evt,target:l})})}_handleMouseMove(e){let r,n,s;const a=this.findOne("."+this._movingAnchorName),i=a.getStage();i.setPointersPositions(e);const o=i.getPointerPosition();let l={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const u=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(u,l,e)),a.setAbsolutePosition(l);const d=a.getAbsolutePosition();if(u.x===d.x&&u.y===d.y)return;if(this._movingAnchorName==="rotater"){const w=this._getNodeRect();r=a.x()-w.width/2,n=-a.y()+w.height/2;let y=Math.atan2(-n,r)+Math.PI/2;w.height<0&&(y-=Math.PI);const E=Fi.Konva.getAngle(this.rotation())+y,N=Fi.Konva.getAngle(this.rotationSnapTolerance()),T=AX(this.rotationSnaps(),E,N)-w.rotation,P=NX(w,T);this._fitNodesInto(P,e);return}const h=this.shiftBehavior();let m;h==="inverted"?m=this.keepRatio()&&!e.shiftKey:h==="none"?m=this.keepRatio():m=this.keepRatio()||e.shiftKey;let x=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(m){const w=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};s=Math.sqrt(Math.pow(w.x-a.x(),2)+Math.pow(w.y-a.y(),2));const y=this.findOne(".top-left").x()>w.x?-1:1,b=this.findOne(".top-left").y()>w.y?-1:1;r=s*this.cos*y,n=s*this.sin*b,this.findOne(".top-left").x(w.x-r),this.findOne(".top-left").y(w.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(m){const w=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};s=Math.sqrt(Math.pow(a.x()-w.x,2)+Math.pow(w.y-a.y(),2));const y=this.findOne(".top-right").x()<w.x?-1:1,b=this.findOne(".top-right").y()>w.y?-1:1;r=s*this.cos*y,n=s*this.sin*b,this.findOne(".top-right").x(w.x+r),this.findOne(".top-right").y(w.y-n)}var p=a.position();this.findOne(".top-left").y(p.y),this.findOne(".bottom-right").x(p.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(m){const w=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};s=Math.sqrt(Math.pow(w.x-a.x(),2)+Math.pow(a.y()-w.y,2));const y=w.x<a.x()?-1:1,b=a.y()<w.y?-1:1;r=s*this.cos*y,n=s*this.sin*b,a.x(w.x-r),a.y(w.y+n)}p=a.position(),this.findOne(".top-left").x(p.x),this.findOne(".bottom-right").y(p.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(m){const w=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};s=Math.sqrt(Math.pow(a.x()-w.x,2)+Math.pow(a.y()-w.y,2));const y=this.findOne(".bottom-right").x()<w.x?-1:1,b=this.findOne(".bottom-right").y()<w.y?-1:1;r=s*this.cos*y,n=s*this.sin*b,this.findOne(".bottom-right").x(w.x+r),this.findOne(".bottom-right").y(w.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(x=this.centeredScaling()||e.altKey,x){const w=this.findOne(".top-left"),y=this.findOne(".bottom-right"),b=w.x(),E=w.y(),N=this.getWidth()-y.x(),F=this.getHeight()-y.y();y.move({x:-b,y:-E}),w.move({x:N,y:F})}const v=this.findOne(".top-left").getAbsolutePosition();r=v.x,n=v.y;const _=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),S=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:_,height:S,rotation:Fi.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();VS--,this._fire("transformend",{evt:e,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(s=>{var a;s._fire("transformend",{evt:e,target:s}),(a=s.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,r){const n=this._getNodeRect(),s=1;if(Or.Util._inRange(e.width,-this.padding()*2-s,s)){this.update();return}if(Or.Util._inRange(e.height,-this.padding()*2-s,s)){this.update();return}const a=new Or.Transform;if(a.rotate(Fi.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const m=a.point({x:-this.padding()*2,y:0});e.x+=m.x,e.y+=m.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const m=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const m=a.point({x:0,y:-this.padding()*2});e.x+=m.x,e.y+=m.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const m=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const m=this.boundBoxFunc()(n,e);m?e=m:Or.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const i=1e7,o=new Or.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/i,n.height/i);const l=new Or.Transform,u=e.width/i,d=e.height/i;this.flipEnabled()===!1?(l.translate(e.x,e.y),l.rotate(e.rotation),l.translate(e.width<0?e.width:0,e.height<0?e.height:0),l.scale(Math.abs(u),Math.abs(d))):(l.translate(e.x,e.y),l.rotate(e.rotation),l.scale(u,d));const h=l.multiply(o.invert());this._nodes.forEach(m=>{var x;const p=m.getParent().getAbsoluteTransform(),v=m.getTransform().copy();v.translate(m.offsetX(),m.offsetY());const _=new Or.Transform;_.multiply(p.copy().invert()).multiply(h).multiply(p).multiply(v);const S=_.decompose();m.setAttrs(S),(x=m.getLayer())===null||x===void 0||x.batchDraw()}),this.rotation(Or.Util._getRotation(e.rotation)),this._nodes.forEach(m=>{this._fire("transform",{evt:r,target:m}),m._fire("transform",{evt:r,target:m})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,r){this.findOne(e).setAttrs(r)}update(){var e;const r=this._getNodeRect();this.rotation(Or.Util._getRotation(r.rotation));const n=r.width,s=r.height,a=this.enabledAnchors(),i=this.resizeEnabled(),o=this.padding(),l=this.anchorSize(),u=this.find("._anchor");u.forEach(h=>{h.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+o,offsetY:l/2+o,visible:i&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+o,visible:i&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-o,offsetY:l/2+o,visible:i&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:s/2,offsetX:l/2+o,visible:i&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:s/2,offsetX:l/2-o,visible:i&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:s,offsetX:l/2+o,offsetY:l/2-o,visible:i&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:s,offsetY:l/2-o,visible:i&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:s,offsetX:l/2-o,offsetY:l/2-o,visible:i&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*Or.Util._sign(s)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:s,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const d=this.anchorStyleFunc();d&&u.forEach(h=>{d(h)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),G5.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return V5.Node.prototype.toObject.call(this)}clone(e){return V5.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Py.Transformer=xr;xr.isTransforming=()=>VS>0;function FX(t){return t instanceof Array||Or.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){s1.indexOf(e)===-1&&Or.Util.warn("Unknown anchor name: "+e+". Available names are: "+s1.join(", "))}),t||[]}xr.prototype.className="Transformer";(0,_X._registerNode)(xr);Ar.Factory.addGetterSetter(xr,"enabledAnchors",s1,FX);Ar.Factory.addGetterSetter(xr,"flipEnabled",!0,(0,kc.getBooleanValidator)());Ar.Factory.addGetterSetter(xr,"resizeEnabled",!0);Ar.Factory.addGetterSetter(xr,"anchorSize",10,(0,kc.getNumberValidator)());Ar.Factory.addGetterSetter(xr,"rotateEnabled",!0);Ar.Factory.addGetterSetter(xr,"rotateLineVisible",!0);Ar.Factory.addGetterSetter(xr,"rotationSnaps",[]);Ar.Factory.addGetterSetter(xr,"rotateAnchorOffset",50,(0,kc.getNumberValidator)());Ar.Factory.addGetterSetter(xr,"rotateAnchorCursor","crosshair");Ar.Factory.addGetterSetter(xr,"rotationSnapTolerance",5,(0,kc.getNumberValidator)());Ar.Factory.addGetterSetter(xr,"borderEnabled",!0);Ar.Factory.addGetterSetter(xr,"anchorStroke","rgb(0, 161, 255)");Ar.Factory.addGetterSetter(xr,"anchorStrokeWidth",1,(0,kc.getNumberValidator)());Ar.Factory.addGetterSetter(xr,"anchorFill","white");Ar.Factory.addGetterSetter(xr,"anchorCornerRadius",0,(0,kc.getNumberValidator)());Ar.Factory.addGetterSetter(xr,"borderStroke","rgb(0, 161, 255)");Ar.Factory.addGetterSetter(xr,"borderStrokeWidth",1,(0,kc.getNumberValidator)());Ar.Factory.addGetterSetter(xr,"borderDash");Ar.Factory.addGetterSetter(xr,"keepRatio",!0);Ar.Factory.addGetterSetter(xr,"shiftBehavior","default");Ar.Factory.addGetterSetter(xr,"centeredScaling",!1);Ar.Factory.addGetterSetter(xr,"ignoreStroke",!1);Ar.Factory.addGetterSetter(xr,"padding",0,(0,kc.getNumberValidator)());Ar.Factory.addGetterSetter(xr,"nodes");Ar.Factory.addGetterSetter(xr,"node");Ar.Factory.addGetterSetter(xr,"boundBoxFunc");Ar.Factory.addGetterSetter(xr,"anchorDragBoundFunc");Ar.Factory.addGetterSetter(xr,"anchorStyleFunc");Ar.Factory.addGetterSetter(xr,"shouldOverdrawWholeArea",!1);Ar.Factory.addGetterSetter(xr,"useSingleNodeRotation",!0);Ar.Factory.backCompat(xr,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Dy={};Object.defineProperty(Dy,"__esModule",{value:!0});Dy.Wedge=void 0;const Ry=fr,jX=ts,PX=ar,YP=Kt,DX=ar;let pl=class extends jX.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,PX.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};Dy.Wedge=pl;pl.prototype.className="Wedge";pl.prototype._centroid=!0;pl.prototype._attrsAffectingSize=["radius"];(0,DX._registerNode)(pl);Ry.Factory.addGetterSetter(pl,"radius",0,(0,YP.getNumberValidator)());Ry.Factory.addGetterSetter(pl,"angle",0,(0,YP.getNumberValidator)());Ry.Factory.addGetterSetter(pl,"clockwise",!1);Ry.Factory.backCompat(pl,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Oy={};Object.defineProperty(Oy,"__esModule",{value:!0});Oy.Blur=void 0;const K5=fr,RX=rn,OX=Kt;function X5(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const MX=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],LX=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function IX(t,e){const r=t.data,n=t.width,s=t.height;let a,i,o,l,u,d,h,m,x,p,v,_,S,w,y,b,E,N,F,T;const P=e+e+1,D=n-1,R=s-1,I=e+1,W=I*(I+1)/2,le=new X5,q=MX[e],V=LX[e];let K=null,U=le,L=null,Z=null;for(let ne=1;ne<P;ne++)U=U.next=new X5,ne===I&&(K=U);U.next=le,o=i=0;for(let ne=0;ne<s;ne++){_=S=w=y=l=u=d=h=0,m=I*(b=r[i]),x=I*(E=r[i+1]),p=I*(N=r[i+2]),v=I*(F=r[i+3]),l+=W*b,u+=W*E,d+=W*N,h+=W*F,U=le;for(let z=0;z<I;z++)U.r=b,U.g=E,U.b=N,U.a=F,U=U.next;for(let z=1;z<I;z++)a=i+((D<z?D:z)<<2),l+=(U.r=b=r[a])*(T=I-z),u+=(U.g=E=r[a+1])*T,d+=(U.b=N=r[a+2])*T,h+=(U.a=F=r[a+3])*T,_+=b,S+=E,w+=N,y+=F,U=U.next;L=le,Z=K;for(let z=0;z<n;z++)r[i+3]=F=h*q>>V,F!==0?(F=255/F,r[i]=(l*q>>V)*F,r[i+1]=(u*q>>V)*F,r[i+2]=(d*q>>V)*F):r[i]=r[i+1]=r[i+2]=0,l-=m,u-=x,d-=p,h-=v,m-=L.r,x-=L.g,p-=L.b,v-=L.a,a=o+((a=z+e+1)<D?a:D)<<2,_+=L.r=r[a],S+=L.g=r[a+1],w+=L.b=r[a+2],y+=L.a=r[a+3],l+=_,u+=S,d+=w,h+=y,L=L.next,m+=b=Z.r,x+=E=Z.g,p+=N=Z.b,v+=F=Z.a,_-=b,S-=E,w-=N,y-=F,Z=Z.next,i+=4;o+=n}for(let ne=0;ne<n;ne++){S=w=y=_=u=d=h=l=0,i=ne<<2,m=I*(b=r[i]),x=I*(E=r[i+1]),p=I*(N=r[i+2]),v=I*(F=r[i+3]),l+=W*b,u+=W*E,d+=W*N,h+=W*F,U=le;for(let Y=0;Y<I;Y++)U.r=b,U.g=E,U.b=N,U.a=F,U=U.next;let z=n;for(let Y=1;Y<=e;Y++)i=z+ne<<2,l+=(U.r=b=r[i])*(T=I-Y),u+=(U.g=E=r[i+1])*T,d+=(U.b=N=r[i+2])*T,h+=(U.a=F=r[i+3])*T,_+=b,S+=E,w+=N,y+=F,U=U.next,Y<R&&(z+=n);i=ne,L=le,Z=K;for(let Y=0;Y<s;Y++)a=i<<2,r[a+3]=F=h*q>>V,F>0?(F=255/F,r[a]=(l*q>>V)*F,r[a+1]=(u*q>>V)*F,r[a+2]=(d*q>>V)*F):r[a]=r[a+1]=r[a+2]=0,l-=m,u-=x,d-=p,h-=v,m-=L.r,x-=L.g,p-=L.b,v-=L.a,a=ne+((a=Y+I)<R?a:R)*n<<2,l+=_+=L.r=r[a],u+=S+=L.g=r[a+1],d+=w+=L.b=r[a+2],h+=y+=L.a=r[a+3],L=L.next,m+=b=Z.r,x+=E=Z.g,p+=N=Z.b,v+=F=Z.a,_-=b,S-=E,w-=N,y-=F,Z=Z.next,i+=n}}const BX=function(e){const r=Math.round(this.blurRadius());r>0&&IX(e,r)};Oy.Blur=BX;K5.Factory.addGetterSetter(RX.Node,"blurRadius",0,(0,OX.getNumberValidator)(),K5.Factory.afterSetFilter);var My={};Object.defineProperty(My,"__esModule",{value:!0});My.Brighten=void 0;const Y5=fr,UX=rn,$X=Kt,zX=function(t){const e=this.brightness()*255,r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]+=e,r[s+1]+=e,r[s+2]+=e};My.Brighten=zX;Y5.Factory.addGetterSetter(UX.Node,"brightness",0,(0,$X.getNumberValidator)(),Y5.Factory.afterSetFilter);var Ly={};Object.defineProperty(Ly,"__esModule",{value:!0});Ly.Contrast=void 0;const J5=fr,WX=rn,VX=Kt,GX=function(t){const e=Math.pow((this.contrast()+100)/100,2),r=t.data,n=r.length;let s=150,a=150,i=150;for(let o=0;o<n;o+=4)s=r[o],a=r[o+1],i=r[o+2],s/=255,s-=.5,s*=e,s+=.5,s*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,i/=255,i-=.5,i*=e,i+=.5,i*=255,s=s<0?0:s>255?255:s,a=a<0?0:a>255?255:a,i=i<0?0:i>255?255:i,r[o]=s,r[o+1]=a,r[o+2]=i};Ly.Contrast=GX;J5.Factory.addGetterSetter(WX.Node,"contrast",0,(0,VX.getNumberValidator)(),J5.Factory.afterSetFilter);var Iy={};Object.defineProperty(Iy,"__esModule",{value:!0});Iy.Emboss=void 0;const ic=fr,By=rn,HX=mn,JP=Kt,KX=function(t){const e=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),s=this.embossBlend(),a=t.data,i=t.width,o=t.height,l=i*4;let u=0,d=0,h=o;switch(n){case"top-left":u=-1,d=-1;break;case"top":u=-1,d=0;break;case"top-right":u=-1,d=1;break;case"right":u=0,d=1;break;case"bottom-right":u=1,d=1;break;case"bottom":u=1,d=0;break;case"bottom-left":u=1,d=-1;break;case"left":u=0,d=-1;break;default:HX.Util.error("Unknown emboss direction: "+n)}do{const m=(h-1)*l;let x=u;h+x<1&&(x=0),h+x>o&&(x=0);const p=(h-1+x)*i*4;let v=i;do{const _=m+(v-1)*4;let S=d;v+S<1&&(S=0),v+S>i&&(S=0);const w=p+(v-1+S)*4,y=a[_]-a[w],b=a[_+1]-a[w+1],E=a[_+2]-a[w+2];let N=y;const F=N>0?N:-N,T=b>0?b:-b,P=E>0?E:-E;if(T>F&&(N=b),P>F&&(N=E),N*=e,s){const D=a[_]+N,R=a[_+1]+N,I=a[_+2]+N;a[_]=D>255?255:D<0?0:D,a[_+1]=R>255?255:R<0?0:R,a[_+2]=I>255?255:I<0?0:I}else{let D=r-N;D<0?D=0:D>255&&(D=255),a[_]=a[_+1]=a[_+2]=D}}while(--v)}while(--h)};Iy.Emboss=KX;ic.Factory.addGetterSetter(By.Node,"embossStrength",.5,(0,JP.getNumberValidator)(),ic.Factory.afterSetFilter);ic.Factory.addGetterSetter(By.Node,"embossWhiteLevel",.5,(0,JP.getNumberValidator)(),ic.Factory.afterSetFilter);ic.Factory.addGetterSetter(By.Node,"embossDirection","top-left",void 0,ic.Factory.afterSetFilter);ic.Factory.addGetterSetter(By.Node,"embossBlend",!1,void 0,ic.Factory.afterSetFilter);var Uy={};Object.defineProperty(Uy,"__esModule",{value:!0});Uy.Enhance=void 0;const Q5=fr,XX=rn,YX=Kt;function I2(t,e,r,n,s){const a=r-e,i=s-n;if(a===0)return n+i/2;if(i===0)return n;let o=(t-e)/a;return o=i*o+n,o}const JX=function(t){const e=t.data,r=e.length;let n=e[0],s=n,a,i=e[1],o=i,l,u=e[2],d=u,h;const m=this.enhance();if(m===0)return;for(let y=0;y<r;y+=4)a=e[y+0],a<n?n=a:a>s&&(s=a),l=e[y+1],l<i?i=l:l>o&&(o=l),h=e[y+2],h<u?u=h:h>d&&(d=h);s===n&&(s=255,n=0),o===i&&(o=255,i=0),d===u&&(d=255,u=0);let x,p,v,_,S,w;if(m>0)x=s+m*(255-s),p=n-m*(n-0),v=o+m*(255-o),_=i-m*(i-0),S=d+m*(255-d),w=u-m*(u-0);else{const y=(s+n)*.5;x=s+m*(s-y),p=n+m*(n-y);const b=(o+i)*.5;v=o+m*(o-b),_=i+m*(i-b);const E=(d+u)*.5;S=d+m*(d-E),w=u+m*(u-E)}for(let y=0;y<r;y+=4)e[y+0]=I2(e[y+0],n,s,p,x),e[y+1]=I2(e[y+1],i,o,_,v),e[y+2]=I2(e[y+2],u,d,w,S)};Uy.Enhance=JX;Q5.Factory.addGetterSetter(XX.Node,"enhance",0,(0,YX.getNumberValidator)(),Q5.Factory.afterSetFilter);var $y={};Object.defineProperty($y,"__esModule",{value:!0});$y.Grayscale=void 0;const QX=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4){const s=.34*e[n]+.5*e[n+1]+.16*e[n+2];e[n]=s,e[n+1]=s,e[n+2]=s}};$y.Grayscale=QX;var zy={};Object.defineProperty(zy,"__esModule",{value:!0});zy.HSL=void 0;const jf=fr,jC=rn,PC=Kt;jf.Factory.addGetterSetter(jC.Node,"hue",0,(0,PC.getNumberValidator)(),jf.Factory.afterSetFilter);jf.Factory.addGetterSetter(jC.Node,"saturation",0,(0,PC.getNumberValidator)(),jf.Factory.afterSetFilter);jf.Factory.addGetterSetter(jC.Node,"luminance",0,(0,PC.getNumberValidator)(),jf.Factory.afterSetFilter);const qX=function(t){const e=t.data,r=e.length,n=1,s=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,i=this.luminance()*127,o=n*s*Math.cos(a*Math.PI/180),l=n*s*Math.sin(a*Math.PI/180),u=.299*n+.701*o+.167*l,d=.587*n-.587*o+.33*l,h=.114*n-.114*o-.497*l,m=.299*n-.299*o-.328*l,x=.587*n+.413*o+.035*l,p=.114*n-.114*o+.293*l,v=.299*n-.3*o+1.25*l,_=.587*n-.586*o-1.05*l,S=.114*n+.886*o-.2*l;let w,y,b,E;for(let N=0;N<r;N+=4)w=e[N+0],y=e[N+1],b=e[N+2],E=e[N+3],e[N+0]=u*w+d*y+h*b+i,e[N+1]=m*w+x*y+p*b+i,e[N+2]=v*w+_*y+S*b+i,e[N+3]=E};zy.HSL=qX;var Wy={};Object.defineProperty(Wy,"__esModule",{value:!0});Wy.HSV=void 0;const Pf=fr,DC=rn,RC=Kt,ZX=function(t){const e=t.data,r=e.length,n=Math.pow(2,this.value()),s=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,i=n*s*Math.cos(a*Math.PI/180),o=n*s*Math.sin(a*Math.PI/180),l=.299*n+.701*i+.167*o,u=.587*n-.587*i+.33*o,d=.114*n-.114*i-.497*o,h=.299*n-.299*i-.328*o,m=.587*n+.413*i+.035*o,x=.114*n-.114*i+.293*o,p=.299*n-.3*i+1.25*o,v=.587*n-.586*i-1.05*o,_=.114*n+.886*i-.2*o;for(let S=0;S<r;S+=4){const w=e[S+0],y=e[S+1],b=e[S+2],E=e[S+3];e[S+0]=l*w+u*y+d*b,e[S+1]=h*w+m*y+x*b,e[S+2]=p*w+v*y+_*b,e[S+3]=E}};Wy.HSV=ZX;Pf.Factory.addGetterSetter(DC.Node,"hue",0,(0,RC.getNumberValidator)(),Pf.Factory.afterSetFilter);Pf.Factory.addGetterSetter(DC.Node,"saturation",0,(0,RC.getNumberValidator)(),Pf.Factory.afterSetFilter);Pf.Factory.addGetterSetter(DC.Node,"value",0,(0,RC.getNumberValidator)(),Pf.Factory.afterSetFilter);var Vy={};Object.defineProperty(Vy,"__esModule",{value:!0});Vy.Invert=void 0;const eY=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]};Vy.Invert=eY;var Gy={};Object.defineProperty(Gy,"__esModule",{value:!0});Gy.Kaleidoscope=void 0;const a1=fr,QP=rn,q5=mn,qP=Kt,tY=function(t,e,r){const n=t.data,s=e.data,a=t.width,i=t.height,o=r.polarCenterX||a/2,l=r.polarCenterY||i/2;let u=Math.sqrt(o*o+l*l),d=a-o,h=i-l;const m=Math.sqrt(d*d+h*h);u=m>u?m:u;const x=i,p=a,v=360/p*Math.PI/180;for(let _=0;_<p;_+=1){const S=Math.sin(_*v),w=Math.cos(_*v);for(let y=0;y<x;y+=1){d=Math.floor(o+u*y/x*w),h=Math.floor(l+u*y/x*S);let b=(h*a+d)*4;const E=n[b+0],N=n[b+1],F=n[b+2],T=n[b+3];b=(_+y*a)*4,s[b+0]=E,s[b+1]=N,s[b+2]=F,s[b+3]=T}}},rY=function(t,e,r){const n=t.data,s=e.data,a=t.width,i=t.height,o=r.polarCenterX||a/2,l=r.polarCenterY||i/2;let u=Math.sqrt(o*o+l*l),d=a-o,h=i-l;const m=Math.sqrt(d*d+h*h);u=m>u?m:u;const x=i,p=a,v=0;let _,S;for(d=0;d<a;d+=1)for(h=0;h<i;h+=1){const w=d-o,y=h-l,b=Math.sqrt(w*w+y*y)*x/u;let E=(Math.atan2(y,w)*180/Math.PI+360+v)%360;E=E*p/360,_=Math.floor(E),S=Math.floor(b);let N=(S*a+_)*4;const F=n[N+0],T=n[N+1],P=n[N+2],D=n[N+3];N=(h*a+d)*4,s[N+0]=F,s[N+1]=T,s[N+2]=P,s[N+3]=D}},nY=function(t){const e=t.width,r=t.height;let n,s,a,i,o,l,u,d,h,m,x=Math.round(this.kaleidoscopePower());const p=Math.round(this.kaleidoscopeAngle()),v=Math.floor(e*(p%360)/360);if(x<1)return;const _=q5.Util.createCanvasElement();_.width=e,_.height=r;const S=_.getContext("2d").getImageData(0,0,e,r);q5.Util.releaseCanvas(_),tY(t,S,{polarCenterX:e/2,polarCenterY:r/2});let w=e/Math.pow(2,x);for(;w<=8;)w=w*2,x-=1;w=Math.ceil(w);let y=w,b=0,E=y,N=1;for(v+w>e&&(b=y,E=0,N=-1),s=0;s<r;s+=1)for(n=b;n!==E;n+=N)a=Math.round(n+v)%e,h=(e*s+a)*4,o=S.data[h+0],l=S.data[h+1],u=S.data[h+2],d=S.data[h+3],m=(e*s+n)*4,S.data[m+0]=o,S.data[m+1]=l,S.data[m+2]=u,S.data[m+3]=d;for(s=0;s<r;s+=1)for(y=Math.floor(w),i=0;i<x;i+=1){for(n=0;n<y+1;n+=1)h=(e*s+n)*4,o=S.data[h+0],l=S.data[h+1],u=S.data[h+2],d=S.data[h+3],m=(e*s+y*2-n-1)*4,S.data[m+0]=o,S.data[m+1]=l,S.data[m+2]=u,S.data[m+3]=d;y*=2}rY(S,t,{})};Gy.Kaleidoscope=nY;a1.Factory.addGetterSetter(QP.Node,"kaleidoscopePower",2,(0,qP.getNumberValidator)(),a1.Factory.afterSetFilter);a1.Factory.addGetterSetter(QP.Node,"kaleidoscopeAngle",0,(0,qP.getNumberValidator)(),a1.Factory.afterSetFilter);var Hy={};Object.defineProperty(Hy,"__esModule",{value:!0});Hy.Mask=void 0;const Z5=fr,sY=rn,aY=Kt;function Pp(t,e,r){let n=(r*t.width+e)*4;const s=[];return s.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),s}function Wh(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function iY(t){const e=[0,0,0];for(let r=0;r<t.length;r++)e[0]+=t[r][0],e[1]+=t[r][1],e[2]+=t[r][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function oY(t,e){const r=Pp(t,0,0),n=Pp(t,t.width-1,0),s=Pp(t,0,t.height-1),a=Pp(t,t.width-1,t.height-1),i=e||10;if(Wh(r,n)<i&&Wh(n,a)<i&&Wh(a,s)<i&&Wh(s,r)<i){const o=iY([n,r,a,s]),l=[];for(let u=0;u<t.width*t.height;u++){const d=Wh(o,[t.data[u*4],t.data[u*4+1],t.data[u*4+2]]);l[u]=d<i?0:255}return l}}function lY(t,e){for(let r=0;r<t.width*t.height;r++)t.data[4*r+3]=e[r]}function cY(t,e,r){const n=[1,1,1,1,0,1,1,1,1],s=Math.round(Math.sqrt(n.length)),a=Math.floor(s/2),i=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let d=0;for(let h=0;h<s;h++)for(let m=0;m<s;m++){const x=o+h-a,p=l+m-a;if(x>=0&&x<r&&p>=0&&p<e){const v=x*e+p,_=n[h*s+m];d+=t[v]*_}}i[u]=d===255*8?255:0}return i}function uY(t,e,r){const n=[1,1,1,1,1,1,1,1,1],s=Math.round(Math.sqrt(n.length)),a=Math.floor(s/2),i=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let d=0;for(let h=0;h<s;h++)for(let m=0;m<s;m++){const x=o+h-a,p=l+m-a;if(x>=0&&x<r&&p>=0&&p<e){const v=x*e+p,_=n[h*s+m];d+=t[v]*_}}i[u]=d>=255*4?255:0}return i}function dY(t,e,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],s=Math.round(Math.sqrt(n.length)),a=Math.floor(s/2),i=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let d=0;for(let h=0;h<s;h++)for(let m=0;m<s;m++){const x=o+h-a,p=l+m-a;if(x>=0&&x<r&&p>=0&&p<e){const v=x*e+p,_=n[h*s+m];d+=t[v]*_}}i[u]=d}return i}const fY=function(t){const e=this.threshold();let r=oY(t,e);return r&&(r=cY(r,t.width,t.height),r=uY(r,t.width,t.height),r=dY(r,t.width,t.height),lY(t,r)),t};Hy.Mask=fY;Z5.Factory.addGetterSetter(sY.Node,"threshold",0,(0,aY.getNumberValidator)(),Z5.Factory.afterSetFilter);var Ky={};Object.defineProperty(Ky,"__esModule",{value:!0});Ky.Noise=void 0;const e6=fr,hY=rn,gY=Kt,mY=function(t){const e=this.noise()*255,r=t.data,n=r.length,s=e/2;for(let a=0;a<n;a+=4)r[a+0]+=s-2*s*Math.random(),r[a+1]+=s-2*s*Math.random(),r[a+2]+=s-2*s*Math.random()};Ky.Noise=mY;e6.Factory.addGetterSetter(hY.Node,"noise",.2,(0,gY.getNumberValidator)(),e6.Factory.afterSetFilter);var Xy={};Object.defineProperty(Xy,"__esModule",{value:!0});Xy.Pixelate=void 0;const t6=fr,pY=mn,xY=rn,yY=Kt,vY=function(t){let e=Math.ceil(this.pixelSize()),r=t.width,n=t.height,s=Math.ceil(r/e),a=Math.ceil(n/e),i=t.data;if(e<=0){pY.Util.error("pixelSize value can not be <= 0");return}for(let o=0;o<s;o+=1)for(let l=0;l<a;l+=1){let u=0,d=0,h=0,m=0;const x=o*e,p=x+e,v=l*e,_=v+e;let S=0;for(let w=x;w<p;w+=1)if(!(w>=r))for(let y=v;y<_;y+=1){if(y>=n)continue;const b=(r*y+w)*4;u+=i[b+0],d+=i[b+1],h+=i[b+2],m+=i[b+3],S+=1}u=u/S,d=d/S,h=h/S,m=m/S;for(let w=x;w<p;w+=1)if(!(w>=r))for(let y=v;y<_;y+=1){if(y>=n)continue;const b=(r*y+w)*4;i[b+0]=u,i[b+1]=d,i[b+2]=h,i[b+3]=m}}};Xy.Pixelate=vY;t6.Factory.addGetterSetter(xY.Node,"pixelSize",8,(0,yY.getNumberValidator)(),t6.Factory.afterSetFilter);var Yy={};Object.defineProperty(Yy,"__esModule",{value:!0});Yy.Posterize=void 0;const r6=fr,wY=rn,_Y=Kt,SY=function(t){const e=Math.round(this.levels()*254)+1,r=t.data,n=r.length,s=255/e;for(let a=0;a<n;a+=1)r[a]=Math.floor(r[a]/s)*s};Yy.Posterize=SY;r6.Factory.addGetterSetter(wY.Node,"levels",.5,(0,_Y.getNumberValidator)(),r6.Factory.afterSetFilter);var Jy={};Object.defineProperty(Jy,"__esModule",{value:!0});Jy.RGB=void 0;const i1=fr,OC=rn,bY=Kt,kY=function(t){const e=t.data,r=e.length,n=this.red(),s=this.green(),a=this.blue();for(let i=0;i<r;i+=4){const o=(.34*e[i]+.5*e[i+1]+.16*e[i+2])/255;e[i]=o*n,e[i+1]=o*s,e[i+2]=o*a,e[i+3]=e[i+3]}};Jy.RGB=kY;i1.Factory.addGetterSetter(OC.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});i1.Factory.addGetterSetter(OC.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});i1.Factory.addGetterSetter(OC.Node,"blue",0,bY.RGBComponent,i1.Factory.afterSetFilter);var Qy={};Object.defineProperty(Qy,"__esModule",{value:!0});Qy.RGBA=void 0;const ig=fr,qy=rn,CY=Kt,TY=function(t){const e=t.data,r=e.length,n=this.red(),s=this.green(),a=this.blue(),i=this.alpha();for(let o=0;o<r;o+=4){const l=1-i;e[o]=n*i+e[o]*l,e[o+1]=s*i+e[o+1]*l,e[o+2]=a*i+e[o+2]*l}};Qy.RGBA=TY;ig.Factory.addGetterSetter(qy.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});ig.Factory.addGetterSetter(qy.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});ig.Factory.addGetterSetter(qy.Node,"blue",0,CY.RGBComponent,ig.Factory.afterSetFilter);ig.Factory.addGetterSetter(qy.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var Zy={};Object.defineProperty(Zy,"__esModule",{value:!0});Zy.Sepia=void 0;const EY=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4){const s=e[n+0],a=e[n+1],i=e[n+2];e[n+0]=Math.min(255,s*.393+a*.769+i*.189),e[n+1]=Math.min(255,s*.349+a*.686+i*.168),e[n+2]=Math.min(255,s*.272+a*.534+i*.131)}};Zy.Sepia=EY;var ev={};Object.defineProperty(ev,"__esModule",{value:!0});ev.Solarize=void 0;const NY=function(t){const e=t.data,r=t.width,n=t.height,s=r*4;let a=n;do{const i=(a-1)*s;let o=r;do{const l=i+(o-1)*4;let u=e[l],d=e[l+1],h=e[l+2];u>127&&(u=255-u),d>127&&(d=255-d),h>127&&(h=255-h),e[l]=u,e[l+1]=d,e[l+2]=h}while(--o)}while(--a)};ev.Solarize=NY;var tv={};Object.defineProperty(tv,"__esModule",{value:!0});tv.Threshold=void 0;const n6=fr,AY=rn,FY=Kt,jY=function(t){const e=this.threshold()*255,r=t.data,n=r.length;for(let s=0;s<n;s+=1)r[s]=r[s]<e?0:255};tv.Threshold=jY;n6.Factory.addGetterSetter(AY.Node,"threshold",.5,(0,FY.getNumberValidator)(),n6.Factory.afterSetFilter);Object.defineProperty(dy,"__esModule",{value:!0});dy.Konva=void 0;const s6=r1,PY=py,DY=vy,RY=Sy,OY=by,MY=ky,a6=Ff,LY=Vg,IY=eh,BY=Kg,UY=Ey,$Y=Ny,zY=Ay,WY=Fy,VY=rh,GY=jy,HY=Py,KY=Dy,XY=Oy,YY=My,JY=Ly,QY=Iy,qY=Uy,ZY=$y,eJ=zy,tJ=Wy,rJ=Vy,nJ=Gy,sJ=Hy,aJ=Ky,iJ=Xy,oJ=Yy,lJ=Jy,cJ=Qy,uJ=Zy,dJ=ev,fJ=tv;dy.Konva=s6.Konva.Util._assign(s6.Konva,{Arc:PY.Arc,Arrow:DY.Arrow,Circle:RY.Circle,Ellipse:OY.Ellipse,Image:MY.Image,Label:a6.Label,Tag:a6.Tag,Line:LY.Line,Path:IY.Path,Rect:BY.Rect,RegularPolygon:UY.RegularPolygon,Ring:$Y.Ring,Sprite:zY.Sprite,Star:WY.Star,Text:VY.Text,TextPath:GY.TextPath,Transformer:HY.Transformer,Wedge:KY.Wedge,Filters:{Blur:XY.Blur,Brighten:YY.Brighten,Contrast:JY.Contrast,Emboss:QY.Emboss,Enhance:qY.Enhance,Grayscale:ZY.Grayscale,HSL:eJ.HSL,HSV:tJ.HSV,Invert:rJ.Invert,Kaleidoscope:nJ.Kaleidoscope,Mask:sJ.Mask,Noise:aJ.Noise,Pixelate:iJ.Pixelate,Posterize:oJ.Posterize,RGB:lJ.RGB,RGBA:cJ.RGBA,Sepia:uJ.Sepia,Solarize:dJ.Solarize,Threshold:fJ.Threshold}});var hJ=wC.exports;Object.defineProperty(hJ,"__esModule",{value:!0});const gJ=dy;wC.exports=gJ.Konva;var ZP=wC.exports;const mJ=U1(ZP),pJ=iF({__proto__:null,default:mJ},[ZP]);var GS={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var r=r1;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=r1;t.exports=n.Konva})(GS,GS.exports);var xJ=GS.exports;const og=U1(xJ);var eD={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yJ=function(e){var r={},n=k,s=i0,a=Object.assign;function i(f){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+f,C=1;C<arguments.length;C++)g+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+f+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),p=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),E=Symbol.iterator;function N(f){return f===null||typeof f!="object"?null:(f=E&&f[E]||f["@@iterator"],typeof f=="function"?f:null)}function F(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case d:return"Fragment";case u:return"Portal";case m:return"Profiler";case h:return"StrictMode";case _:return"Suspense";case S:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case p:return(f.displayName||"Context")+".Consumer";case x:return(f._context.displayName||"Context")+".Provider";case v:var g=f.render;return f=f.displayName,f||(f=g.displayName||g.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case w:return g=f.displayName||null,g!==null?g:F(f.type)||"Memo";case y:g=f._payload,f=f._init;try{return F(f(g))}catch{}}return null}function T(f){var g=f.type;switch(f.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=g.render,f=f.displayName||f.name||"",g.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(g);case 8:return g===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function P(f){var g=f,C=f;if(f.alternate)for(;g.return;)g=g.return;else{f=g;do g=f,g.flags&4098&&(C=g.return),f=g.return;while(f)}return g.tag===3?C:null}function D(f){if(P(f)!==f)throw Error(i(188))}function R(f){var g=f.alternate;if(!g){if(g=P(f),g===null)throw Error(i(188));return g!==f?null:f}for(var C=f,A=g;;){var j=C.return;if(j===null)break;var O=j.alternate;if(O===null){if(A=j.return,A!==null){C=A;continue}break}if(j.child===O.child){for(O=j.child;O;){if(O===C)return D(j),f;if(O===A)return D(j),g;O=O.sibling}throw Error(i(188))}if(C.return!==A.return)C=j,A=O;else{for(var oe=!1,Ee=j.child;Ee;){if(Ee===C){oe=!0,C=j,A=O;break}if(Ee===A){oe=!0,A=j,C=O;break}Ee=Ee.sibling}if(!oe){for(Ee=O.child;Ee;){if(Ee===C){oe=!0,C=O,A=j;break}if(Ee===A){oe=!0,A=O,C=j;break}Ee=Ee.sibling}if(!oe)throw Error(i(189))}}if(C.alternate!==A)throw Error(i(190))}if(C.tag!==3)throw Error(i(188));return C.stateNode.current===C?f:g}function I(f){return f=R(f),f!==null?W(f):null}function W(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var g=W(f);if(g!==null)return g;f=f.sibling}return null}function le(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){if(f.tag!==4){var g=le(f);if(g!==null)return g}f=f.sibling}return null}var q=Array.isArray,V=e.getPublicInstance,K=e.getRootHostContext,U=e.getChildHostContext,L=e.prepareForCommit,Z=e.resetAfterCommit,ne=e.createInstance,z=e.appendInitialChild,Y=e.finalizeInitialChildren,J=e.prepareUpdate,te=e.shouldSetTextContent,de=e.createTextInstance,ee=e.scheduleTimeout,ge=e.cancelTimeout,fe=e.noTimeout,ye=e.isPrimaryRenderer,Ce=e.supportsMutation,re=e.supportsPersistence,ve=e.supportsHydration,we=e.getInstanceFromNode,Oe=e.preparePortalMount,Ze=e.getCurrentEventPriority,Re=e.detachDeletedInstance,xt=e.supportsMicrotasks,$t=e.scheduleMicrotask,Ae=e.supportsTestSelectors,Pe=e.findFiberRoot,Ue=e.getBoundingRect,We=e.getTextContent,Xe=e.isHiddenSubtree,ut=e.matchAccessibilityRole,Ct=e.setFocusIfFocusable,Mt=e.setupIntersectionObserver,At=e.appendChild,Pt=e.appendChildToContainer,it=e.commitTextUpdate,rt=e.commitMount,xe=e.commitUpdate,De=e.insertBefore,Le=e.insertInContainerBefore,pt=e.removeChild,ht=e.removeChildFromContainer,Tt=e.resetTextContent,gr=e.hideInstance,tr=e.hideTextInstance,mr=e.unhideInstance,Je=e.unhideTextInstance,jt=e.clearContainer,vt=e.cloneInstance,me=e.createContainerChildSet,be=e.appendChildToContainerChildSet,_e=e.finalizeContainerChildren,Fe=e.replaceContainerChildren,nt=e.cloneHiddenInstance,Rt=e.cloneHiddenTextInstance,ke=e.canHydrateInstance,Qe=e.canHydrateTextInstance,qe=e.canHydrateSuspenseInstance,yt=e.isSuspenseInstancePending,Vt=e.isSuspenseInstanceFallback,zt=e.getSuspenseInstanceFallbackErrorDetails,G=e.registerSuspenseInstanceRetry,ce=e.getNextHydratableSibling,se=e.getFirstHydratableChild,B=e.getFirstHydratableChildWithinContainer,X=e.getFirstHydratableChildWithinSuspenseInstance,H=e.hydrateInstance,he=e.hydrateTextInstance,Ne=e.hydrateSuspenseInstance,M=e.getNextHydratableInstanceAfterSuspenseInstance,Q=e.commitHydratedContainer,ie=e.commitHydratedSuspenseInstance,ue=e.clearSuspenseBoundary,Se=e.clearSuspenseBoundaryFromContainer,Ie=e.shouldDeleteUnhydratedTailInstances,Te=e.didNotMatchHydratedContainerTextInstance,Ve=e.didNotMatchHydratedTextInstance,et;function bt(f){if(et===void 0)try{throw Error()}catch(C){var g=C.stack.trim().match(/\n( *(at )?)/);et=g&&g[1]||""}return`
`+et+f}var wt=!1;function rr(f,g){if(!f||wt)return"";wt=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(ct){var A=ct}Reflect.construct(f,[],g)}else{try{g.call()}catch(ct){A=ct}f.call(g.prototype)}else{try{throw Error()}catch(ct){A=ct}f()}}catch(ct){if(ct&&A&&typeof ct.stack=="string"){for(var j=ct.stack.split(`
`),O=A.stack.split(`
`),oe=j.length-1,Ee=O.length-1;1<=oe&&0<=Ee&&j[oe]!==O[Ee];)Ee--;for(;1<=oe&&0<=Ee;oe--,Ee--)if(j[oe]!==O[Ee]){if(oe!==1||Ee!==1)do if(oe--,Ee--,0>Ee||j[oe]!==O[Ee]){var ze=`
`+j[oe].replace(" at new "," at ");return f.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",f.displayName)),ze}while(1<=oe&&0<=Ee);break}}}finally{wt=!1,Error.prepareStackTrace=C}return(f=f?f.displayName||f.name:"")?bt(f):""}var Yt=Object.prototype.hasOwnProperty,or=[],Jt=-1;function It(f){return{current:f}}function ae(f){0>Jt||(f.current=or[Jt],or[Jt]=null,Jt--)}function Be(f,g){Jt++,or[Jt]=f.current,f.current=g}var lr={},Ot=It(lr),Xr=It(!1),Mn=lr;function Cn(f,g){var C=f.type.contextTypes;if(!C)return lr;var A=f.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===g)return A.__reactInternalMemoizedMaskedChildContext;var j={},O;for(O in C)j[O]=g[O];return A&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=g,f.__reactInternalMemoizedMaskedChildContext=j),j}function Ln(f){return f=f.childContextTypes,f!=null}function wi(){ae(Xr),ae(Ot)}function mm(f,g,C){if(Ot.current!==lr)throw Error(i(168));Be(Ot,g),Be(Xr,C)}function pm(f,g,C){var A=f.stateNode;if(g=g.childContextTypes,typeof A.getChildContext!="function")return C;A=A.getChildContext();for(var j in A)if(!(j in g))throw Error(i(108,T(f)||"Unknown",j));return a({},C,A)}function xm(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||lr,Mn=Ot.current,Be(Ot,f),Be(Xr,Xr.current),!0}function v4(f,g,C){var A=f.stateNode;if(!A)throw Error(i(169));C?(f=pm(f,g,Mn),A.__reactInternalMemoizedMergedChildContext=f,ae(Xr),ae(Ot),Be(Ot,f)):ae(Xr),Be(Xr,C)}var _i=Math.clz32?Math.clz32:kL,SL=Math.log,bL=Math.LN2;function kL(f){return f>>>=0,f===0?32:31-(SL(f)/bL|0)|0}var ym=64,vm=4194304;function gh(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function wm(f,g){var C=f.pendingLanes;if(C===0)return 0;var A=0,j=f.suspendedLanes,O=f.pingedLanes,oe=C&268435455;if(oe!==0){var Ee=oe&~j;Ee!==0?A=gh(Ee):(O&=oe,O!==0&&(A=gh(O)))}else oe=C&~j,oe!==0?A=gh(oe):O!==0&&(A=gh(O));if(A===0)return 0;if(g!==0&&g!==A&&!(g&j)&&(j=A&-A,O=g&-g,j>=O||j===16&&(O&4194240)!==0))return g;if(A&4&&(A|=C&16),g=f.entangledLanes,g!==0)for(f=f.entanglements,g&=A;0<g;)C=31-_i(g),j=1<<C,A|=f[C],g&=~j;return A}function CL(f,g){switch(f){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TL(f,g){for(var C=f.suspendedLanes,A=f.pingedLanes,j=f.expirationTimes,O=f.pendingLanes;0<O;){var oe=31-_i(O),Ee=1<<oe,ze=j[oe];ze===-1?(!(Ee&C)||Ee&A)&&(j[oe]=CL(Ee,g)):ze<=g&&(f.expiredLanes|=Ee),O&=~Ee}}function jv(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function w4(){var f=ym;return ym<<=1,!(ym&4194240)&&(ym=64),f}function Pv(f){for(var g=[],C=0;31>C;C++)g.push(f);return g}function mh(f,g,C){f.pendingLanes|=g,g!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,g=31-_i(g),f[g]=C}function EL(f,g){var C=f.pendingLanes&~g;f.pendingLanes=g,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=g,f.mutableReadLanes&=g,f.entangledLanes&=g,g=f.entanglements;var A=f.eventTimes;for(f=f.expirationTimes;0<C;){var j=31-_i(C),O=1<<j;g[j]=0,A[j]=-1,f[j]=-1,C&=~O}}function Dv(f,g){var C=f.entangledLanes|=g;for(f=f.entanglements;C;){var A=31-_i(C),j=1<<A;j&g|f[A]&g&&(f[A]|=g),C&=~j}}var Sr=0;function _4(f){return f&=-f,1<f?4<f?f&268435455?16:536870912:4:1}var Rv=s.unstable_scheduleCallback,S4=s.unstable_cancelCallback,NL=s.unstable_shouldYield,AL=s.unstable_requestPaint,ns=s.unstable_now,Ov=s.unstable_ImmediatePriority,FL=s.unstable_UserBlockingPriority,Mv=s.unstable_NormalPriority,jL=s.unstable_IdlePriority,_m=null,Ki=null;function PL(f){if(Ki&&typeof Ki.onCommitFiberRoot=="function")try{Ki.onCommitFiberRoot(_m,f,void 0,(f.current.flags&128)===128)}catch{}}function DL(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var Si=typeof Object.is=="function"?Object.is:DL,Ao=null,Sm=!1,Lv=!1;function b4(f){Ao===null?Ao=[f]:Ao.push(f)}function RL(f){Sm=!0,b4(f)}function Xi(){if(!Lv&&Ao!==null){Lv=!0;var f=0,g=Sr;try{var C=Ao;for(Sr=1;f<C.length;f++){var A=C[f];do A=A(!0);while(A!==null)}Ao=null,Sm=!1}catch(j){throw Ao!==null&&(Ao=Ao.slice(f+1)),Rv(Ov,Xi),j}finally{Sr=g,Lv=!1}}return null}var cd=[],ud=0,bm=null,km=0,$a=[],za=0,Pc=null,Fo=1,jo="";function Dc(f,g){cd[ud++]=km,cd[ud++]=bm,bm=f,km=g}function k4(f,g,C){$a[za++]=Fo,$a[za++]=jo,$a[za++]=Pc,Pc=f;var A=Fo;f=jo;var j=32-_i(A)-1;A&=~(1<<j),C+=1;var O=32-_i(g)+j;if(30<O){var oe=j-j%5;O=(A&(1<<oe)-1).toString(32),A>>=oe,j-=oe,Fo=1<<32-_i(g)+j|C<<j|A,jo=O+f}else Fo=1<<O|C<<j|A,jo=f}function Iv(f){f.return!==null&&(Dc(f,1),k4(f,1,0))}function Bv(f){for(;f===bm;)bm=cd[--ud],cd[ud]=null,km=cd[--ud],cd[ud]=null;for(;f===Pc;)Pc=$a[--za],$a[za]=null,jo=$a[--za],$a[za]=null,Fo=$a[--za],$a[za]=null}var Ca=null,Wa=null,Yr=!1,ph=!1,bi=null;function C4(f,g){var C=Xa(5,null,null,0);C.elementType="DELETED",C.stateNode=g,C.return=f,g=f.deletions,g===null?(f.deletions=[C],f.flags|=16):g.push(C)}function T4(f,g){switch(f.tag){case 5:return g=ke(g,f.type,f.pendingProps),g!==null?(f.stateNode=g,Ca=f,Wa=se(g),!0):!1;case 6:return g=Qe(g,f.pendingProps),g!==null?(f.stateNode=g,Ca=f,Wa=null,!0):!1;case 13:if(g=qe(g),g!==null){var C=Pc!==null?{id:Fo,overflow:jo}:null;return f.memoizedState={dehydrated:g,treeContext:C,retryLane:1073741824},C=Xa(18,null,null,0),C.stateNode=g,C.return=f,f.child=C,Ca=f,Wa=null,!0}return!1;default:return!1}}function Uv(f){return(f.mode&1)!==0&&(f.flags&128)===0}function $v(f){if(Yr){var g=Wa;if(g){var C=g;if(!T4(f,g)){if(Uv(f))throw Error(i(418));g=ce(C);var A=Ca;g&&T4(f,g)?C4(A,C):(f.flags=f.flags&-4097|2,Yr=!1,Ca=f)}}else{if(Uv(f))throw Error(i(418));f.flags=f.flags&-4097|2,Yr=!1,Ca=f}}}function E4(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;Ca=f}function Cm(f){if(!ve||f!==Ca)return!1;if(!Yr)return E4(f),Yr=!0,!1;if(f.tag!==3&&(f.tag!==5||Ie(f.type)&&!te(f.type,f.memoizedProps))){var g=Wa;if(g){if(Uv(f))throw N4(),Error(i(418));for(;g;)C4(f,g),g=ce(g)}}if(E4(f),f.tag===13){if(!ve)throw Error(i(316));if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));Wa=M(f)}else Wa=Ca?ce(f.stateNode):null;return!0}function N4(){for(var f=Wa;f;)f=ce(f)}function dd(){ve&&(Wa=Ca=null,ph=Yr=!1)}function zv(f){bi===null?bi=[f]:bi.push(f)}var OL=o.ReactCurrentBatchConfig;function Tm(f,g){if(Si(f,g))return!0;if(typeof f!="object"||f===null||typeof g!="object"||g===null)return!1;var C=Object.keys(f),A=Object.keys(g);if(C.length!==A.length)return!1;for(A=0;A<C.length;A++){var j=C[A];if(!Yt.call(g,j)||!Si(f[j],g[j]))return!1}return!0}function ML(f){switch(f.tag){case 5:return bt(f.type);case 16:return bt("Lazy");case 13:return bt("Suspense");case 19:return bt("SuspenseList");case 0:case 2:case 15:return f=rr(f.type,!1),f;case 11:return f=rr(f.type.render,!1),f;case 1:return f=rr(f.type,!0),f;default:return""}}function xh(f,g,C){if(f=C.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(C._owner){if(C=C._owner,C){if(C.tag!==1)throw Error(i(309));var A=C.stateNode}if(!A)throw Error(i(147,f));var j=A,O=""+f;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===O?g.ref:(g=function(oe){var Ee=j.refs;oe===null?delete Ee[O]:Ee[O]=oe},g._stringRef=O,g)}if(typeof f!="string")throw Error(i(284));if(!C._owner)throw Error(i(290,f))}return f}function Em(f,g){throw f=Object.prototype.toString.call(g),Error(i(31,f==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":f))}function A4(f){var g=f._init;return g(f._payload)}function F4(f){function g($e,je){if(f){var He=$e.deletions;He===null?($e.deletions=[je],$e.flags|=16):He.push(je)}}function C($e,je){if(!f)return null;for(;je!==null;)g($e,je),je=je.sibling;return null}function A($e,je){for($e=new Map;je!==null;)je.key!==null?$e.set(je.key,je):$e.set(je.index,je),je=je.sibling;return $e}function j($e,je){return $e=El($e,je),$e.index=0,$e.sibling=null,$e}function O($e,je,He){return $e.index=He,f?(He=$e.alternate,He!==null?(He=He.index,He<je?($e.flags|=2,je):He):($e.flags|=2,je)):($e.flags|=1048576,je)}function oe($e){return f&&$e.alternate===null&&($e.flags|=2),$e}function Ee($e,je,He,St){return je===null||je.tag!==6?(je=Lw(He,$e.mode,St),je.return=$e,je):(je=j(je,He),je.return=$e,je)}function ze($e,je,He,St){var Lt=He.type;return Lt===d?Ft($e,je,He.props.children,St,He.key):je!==null&&(je.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===y&&A4(Lt)===je.type)?(St=j(je,He.props),St.ref=xh($e,je,He),St.return=$e,St):(St=sp(He.type,He.key,He.props,null,$e.mode,St),St.ref=xh($e,je,He),St.return=$e,St)}function ct($e,je,He,St){return je===null||je.tag!==4||je.stateNode.containerInfo!==He.containerInfo||je.stateNode.implementation!==He.implementation?(je=Iw(He,$e.mode,St),je.return=$e,je):(je=j(je,He.children||[]),je.return=$e,je)}function Ft($e,je,He,St,Lt){return je===null||je.tag!==7?(je=Uc(He,$e.mode,St,Lt),je.return=$e,je):(je=j(je,He),je.return=$e,je)}function qt($e,je,He){if(typeof je=="string"&&je!==""||typeof je=="number")return je=Lw(""+je,$e.mode,He),je.return=$e,je;if(typeof je=="object"&&je!==null){switch(je.$$typeof){case l:return He=sp(je.type,je.key,je.props,null,$e.mode,He),He.ref=xh($e,null,je),He.return=$e,He;case u:return je=Iw(je,$e.mode,He),je.return=$e,je;case y:var St=je._init;return qt($e,St(je._payload),He)}if(q(je)||N(je))return je=Uc(je,$e.mode,He,null),je.return=$e,je;Em($e,je)}return null}function _t($e,je,He,St){var Lt=je!==null?je.key:null;if(typeof He=="string"&&He!==""||typeof He=="number")return Lt!==null?null:Ee($e,je,""+He,St);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case l:return He.key===Lt?ze($e,je,He,St):null;case u:return He.key===Lt?ct($e,je,He,St):null;case y:return Lt=He._init,_t($e,je,Lt(He._payload),St)}if(q(He)||N(He))return Lt!==null?null:Ft($e,je,He,St,null);Em($e,He)}return null}function $r($e,je,He,St,Lt){if(typeof St=="string"&&St!==""||typeof St=="number")return $e=$e.get(He)||null,Ee(je,$e,""+St,Lt);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case l:return $e=$e.get(St.key===null?He:St.key)||null,ze(je,$e,St,Lt);case u:return $e=$e.get(St.key===null?He:St.key)||null,ct(je,$e,St,Lt);case y:var sr=St._init;return $r($e,je,He,sr(St._payload),Lt)}if(q(St)||N(St))return $e=$e.get(He)||null,Ft(je,$e,St,Lt,null);Em(je,St)}return null}function Lr($e,je,He,St){for(var Lt=null,sr=null,Zt=je,br=je=0,is=null;Zt!==null&&br<He.length;br++){Zt.index>br?(is=Zt,Zt=null):is=Zt.sibling;var kr=_t($e,Zt,He[br],St);if(kr===null){Zt===null&&(Zt=is);break}f&&Zt&&kr.alternate===null&&g($e,Zt),je=O(kr,je,br),sr===null?Lt=kr:sr.sibling=kr,sr=kr,Zt=is}if(br===He.length)return C($e,Zt),Yr&&Dc($e,br),Lt;if(Zt===null){for(;br<He.length;br++)Zt=qt($e,He[br],St),Zt!==null&&(je=O(Zt,je,br),sr===null?Lt=Zt:sr.sibling=Zt,sr=Zt);return Yr&&Dc($e,br),Lt}for(Zt=A($e,Zt);br<He.length;br++)is=$r(Zt,$e,br,He[br],St),is!==null&&(f&&is.alternate!==null&&Zt.delete(is.key===null?br:is.key),je=O(is,je,br),sr===null?Lt=is:sr.sibling=is,sr=is);return f&&Zt.forEach(function(Nl){return g($e,Nl)}),Yr&&Dc($e,br),Lt}function da($e,je,He,St){var Lt=N(He);if(typeof Lt!="function")throw Error(i(150));if(He=Lt.call(He),He==null)throw Error(i(151));for(var sr=Lt=null,Zt=je,br=je=0,is=null,kr=He.next();Zt!==null&&!kr.done;br++,kr=He.next()){Zt.index>br?(is=Zt,Zt=null):is=Zt.sibling;var Nl=_t($e,Zt,kr.value,St);if(Nl===null){Zt===null&&(Zt=is);break}f&&Zt&&Nl.alternate===null&&g($e,Zt),je=O(Nl,je,br),sr===null?Lt=Nl:sr.sibling=Nl,sr=Nl,Zt=is}if(kr.done)return C($e,Zt),Yr&&Dc($e,br),Lt;if(Zt===null){for(;!kr.done;br++,kr=He.next())kr=qt($e,kr.value,St),kr!==null&&(je=O(kr,je,br),sr===null?Lt=kr:sr.sibling=kr,sr=kr);return Yr&&Dc($e,br),Lt}for(Zt=A($e,Zt);!kr.done;br++,kr=He.next())kr=$r(Zt,$e,br,kr.value,St),kr!==null&&(f&&kr.alternate!==null&&Zt.delete(kr.key===null?br:kr.key),je=O(kr,je,br),sr===null?Lt=kr:sr.sibling=kr,sr=kr);return f&&Zt.forEach(function(fI){return g($e,fI)}),Yr&&Dc($e,br),Lt}function Oo($e,je,He,St){if(typeof He=="object"&&He!==null&&He.type===d&&He.key===null&&(He=He.props.children),typeof He=="object"&&He!==null){switch(He.$$typeof){case l:e:{for(var Lt=He.key,sr=je;sr!==null;){if(sr.key===Lt){if(Lt=He.type,Lt===d){if(sr.tag===7){C($e,sr.sibling),je=j(sr,He.props.children),je.return=$e,$e=je;break e}}else if(sr.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===y&&A4(Lt)===sr.type){C($e,sr.sibling),je=j(sr,He.props),je.ref=xh($e,sr,He),je.return=$e,$e=je;break e}C($e,sr);break}else g($e,sr);sr=sr.sibling}He.type===d?(je=Uc(He.props.children,$e.mode,St,He.key),je.return=$e,$e=je):(St=sp(He.type,He.key,He.props,null,$e.mode,St),St.ref=xh($e,je,He),St.return=$e,$e=St)}return oe($e);case u:e:{for(sr=He.key;je!==null;){if(je.key===sr)if(je.tag===4&&je.stateNode.containerInfo===He.containerInfo&&je.stateNode.implementation===He.implementation){C($e,je.sibling),je=j(je,He.children||[]),je.return=$e,$e=je;break e}else{C($e,je);break}else g($e,je);je=je.sibling}je=Iw(He,$e.mode,St),je.return=$e,$e=je}return oe($e);case y:return sr=He._init,Oo($e,je,sr(He._payload),St)}if(q(He))return Lr($e,je,He,St);if(N(He))return da($e,je,He,St);Em($e,He)}return typeof He=="string"&&He!==""||typeof He=="number"?(He=""+He,je!==null&&je.tag===6?(C($e,je.sibling),je=j(je,He),je.return=$e,$e=je):(C($e,je),je=Lw(He,$e.mode,St),je.return=$e,$e=je),oe($e)):C($e,je)}return Oo}var fd=F4(!0),j4=F4(!1),Nm=It(null),Am=null,hd=null,Wv=null;function Vv(){Wv=hd=Am=null}function P4(f,g,C){ye?(Be(Nm,g._currentValue),g._currentValue=C):(Be(Nm,g._currentValue2),g._currentValue2=C)}function Gv(f){var g=Nm.current;ae(Nm),ye?f._currentValue=g:f._currentValue2=g}function Hv(f,g,C){for(;f!==null;){var A=f.alternate;if((f.childLanes&g)!==g?(f.childLanes|=g,A!==null&&(A.childLanes|=g)):A!==null&&(A.childLanes&g)!==g&&(A.childLanes|=g),f===C)break;f=f.return}}function gd(f,g){Am=f,Wv=hd=null,f=f.dependencies,f!==null&&f.firstContext!==null&&(f.lanes&g&&(la=!0),f.firstContext=null)}function Va(f){var g=ye?f._currentValue:f._currentValue2;if(Wv!==f)if(f={context:f,memoizedValue:g,next:null},hd===null){if(Am===null)throw Error(i(308));hd=f,Am.dependencies={lanes:0,firstContext:f}}else hd=hd.next=f;return g}var Rc=null;function Kv(f){Rc===null?Rc=[f]:Rc.push(f)}function D4(f,g,C,A){var j=g.interleaved;return j===null?(C.next=C,Kv(g)):(C.next=j.next,j.next=C),g.interleaved=C,Yi(f,A)}function Yi(f,g){f.lanes|=g;var C=f.alternate;for(C!==null&&(C.lanes|=g),C=f,f=f.return;f!==null;)f.childLanes|=g,C=f.alternate,C!==null&&(C.childLanes|=g),C=f,f=f.return;return C.tag===3?C.stateNode:null}var _l=!1;function Xv(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function R4(f,g){f=f.updateQueue,g.updateQueue===f&&(g.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function Po(f,g){return{eventTime:f,lane:g,tag:0,payload:null,callback:null,next:null}}function Sl(f,g,C){var A=f.updateQueue;if(A===null)return null;if(A=A.shared,cr&2){var j=A.pending;return j===null?g.next=g:(g.next=j.next,j.next=g),A.pending=g,Yi(f,C)}return j=A.interleaved,j===null?(g.next=g,Kv(A)):(g.next=j.next,j.next=g),A.interleaved=g,Yi(f,C)}function Fm(f,g,C){if(g=g.updateQueue,g!==null&&(g=g.shared,(C&4194240)!==0)){var A=g.lanes;A&=f.pendingLanes,C|=A,g.lanes=C,Dv(f,C)}}function O4(f,g){var C=f.updateQueue,A=f.alternate;if(A!==null&&(A=A.updateQueue,C===A)){var j=null,O=null;if(C=C.firstBaseUpdate,C!==null){do{var oe={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};O===null?j=O=oe:O=O.next=oe,C=C.next}while(C!==null);O===null?j=O=g:O=O.next=g}else j=O=g;C={baseState:A.baseState,firstBaseUpdate:j,lastBaseUpdate:O,shared:A.shared,effects:A.effects},f.updateQueue=C;return}f=C.lastBaseUpdate,f===null?C.firstBaseUpdate=g:f.next=g,C.lastBaseUpdate=g}function jm(f,g,C,A){var j=f.updateQueue;_l=!1;var O=j.firstBaseUpdate,oe=j.lastBaseUpdate,Ee=j.shared.pending;if(Ee!==null){j.shared.pending=null;var ze=Ee,ct=ze.next;ze.next=null,oe===null?O=ct:oe.next=ct,oe=ze;var Ft=f.alternate;Ft!==null&&(Ft=Ft.updateQueue,Ee=Ft.lastBaseUpdate,Ee!==oe&&(Ee===null?Ft.firstBaseUpdate=ct:Ee.next=ct,Ft.lastBaseUpdate=ze))}if(O!==null){var qt=j.baseState;oe=0,Ft=ct=ze=null,Ee=O;do{var _t=Ee.lane,$r=Ee.eventTime;if((A&_t)===_t){Ft!==null&&(Ft=Ft.next={eventTime:$r,lane:0,tag:Ee.tag,payload:Ee.payload,callback:Ee.callback,next:null});e:{var Lr=f,da=Ee;switch(_t=g,$r=C,da.tag){case 1:if(Lr=da.payload,typeof Lr=="function"){qt=Lr.call($r,qt,_t);break e}qt=Lr;break e;case 3:Lr.flags=Lr.flags&-65537|128;case 0:if(Lr=da.payload,_t=typeof Lr=="function"?Lr.call($r,qt,_t):Lr,_t==null)break e;qt=a({},qt,_t);break e;case 2:_l=!0}}Ee.callback!==null&&Ee.lane!==0&&(f.flags|=64,_t=j.effects,_t===null?j.effects=[Ee]:_t.push(Ee))}else $r={eventTime:$r,lane:_t,tag:Ee.tag,payload:Ee.payload,callback:Ee.callback,next:null},Ft===null?(ct=Ft=$r,ze=qt):Ft=Ft.next=$r,oe|=_t;if(Ee=Ee.next,Ee===null){if(Ee=j.shared.pending,Ee===null)break;_t=Ee,Ee=_t.next,_t.next=null,j.lastBaseUpdate=_t,j.shared.pending=null}}while(!0);if(Ft===null&&(ze=qt),j.baseState=ze,j.firstBaseUpdate=ct,j.lastBaseUpdate=Ft,g=j.shared.interleaved,g!==null){j=g;do oe|=j.lane,j=j.next;while(j!==g)}else O===null&&(j.shared.lanes=0);Mc|=oe,f.lanes=oe,f.memoizedState=qt}}function M4(f,g,C){if(f=g.effects,g.effects=null,f!==null)for(g=0;g<f.length;g++){var A=f[g],j=A.callback;if(j!==null){if(A.callback=null,A=C,typeof j!="function")throw Error(i(191,j));j.call(A)}}}var yh={},Ga=It(yh),vh=It(yh),md=It(yh);function Ji(f){if(f===yh)throw Error(i(174));return f}function Yv(f,g){Be(md,g),Be(vh,f),Be(Ga,yh),f=K(g),ae(Ga),Be(Ga,f)}function pd(){ae(Ga),ae(vh),ae(md)}function L4(f){var g=Ji(md.current),C=Ji(Ga.current);g=U(C,f.type,g),C!==g&&(Be(vh,f),Be(Ga,g))}function Jv(f){vh.current===f&&(ae(Ga),ae(vh))}var nn=It(0);function Pm(f){for(var g=f;g!==null;){if(g.tag===13){var C=g.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||yt(C)||Vt(C)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var Qv=[];function qv(){for(var f=0;f<Qv.length;f++){var g=Qv[f];ye?g._workInProgressVersionPrimary=null:g._workInProgressVersionSecondary=null}Qv.length=0}var Dm=o.ReactCurrentDispatcher,Zv=o.ReactCurrentBatchConfig,Oc=0,sn=null,Hn=null,ss=null,Rm=!1,wh=!1,_h=0,LL=0;function Ns(){throw Error(i(321))}function ew(f,g){if(g===null)return!1;for(var C=0;C<g.length&&C<f.length;C++)if(!Si(f[C],g[C]))return!1;return!0}function tw(f,g,C,A,j,O){if(Oc=O,sn=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Dm.current=f===null||f.memoizedState===null?$L:zL,f=C(A,j),wh){O=0;do{if(wh=!1,_h=0,25<=O)throw Error(i(301));O+=1,ss=Hn=null,g.updateQueue=null,Dm.current=WL,f=C(A,j)}while(wh)}if(Dm.current=Lm,g=Hn!==null&&Hn.next!==null,Oc=0,ss=Hn=sn=null,Rm=!1,g)throw Error(i(300));return f}function rw(){var f=_h!==0;return _h=0,f}function Qi(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ss===null?sn.memoizedState=ss=f:ss=ss.next=f,ss}function Ha(){if(Hn===null){var f=sn.alternate;f=f!==null?f.memoizedState:null}else f=Hn.next;var g=ss===null?sn.memoizedState:ss.next;if(g!==null)ss=g,Hn=f;else{if(f===null)throw Error(i(310));Hn=f,f={memoizedState:Hn.memoizedState,baseState:Hn.baseState,baseQueue:Hn.baseQueue,queue:Hn.queue,next:null},ss===null?sn.memoizedState=ss=f:ss=ss.next=f}return ss}function Sh(f,g){return typeof g=="function"?g(f):g}function nw(f){var g=Ha(),C=g.queue;if(C===null)throw Error(i(311));C.lastRenderedReducer=f;var A=Hn,j=A.baseQueue,O=C.pending;if(O!==null){if(j!==null){var oe=j.next;j.next=O.next,O.next=oe}A.baseQueue=j=O,C.pending=null}if(j!==null){O=j.next,A=A.baseState;var Ee=oe=null,ze=null,ct=O;do{var Ft=ct.lane;if((Oc&Ft)===Ft)ze!==null&&(ze=ze.next={lane:0,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null}),A=ct.hasEagerState?ct.eagerState:f(A,ct.action);else{var qt={lane:Ft,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null};ze===null?(Ee=ze=qt,oe=A):ze=ze.next=qt,sn.lanes|=Ft,Mc|=Ft}ct=ct.next}while(ct!==null&&ct!==O);ze===null?oe=A:ze.next=Ee,Si(A,g.memoizedState)||(la=!0),g.memoizedState=A,g.baseState=oe,g.baseQueue=ze,C.lastRenderedState=A}if(f=C.interleaved,f!==null){j=f;do O=j.lane,sn.lanes|=O,Mc|=O,j=j.next;while(j!==f)}else j===null&&(C.lanes=0);return[g.memoizedState,C.dispatch]}function sw(f){var g=Ha(),C=g.queue;if(C===null)throw Error(i(311));C.lastRenderedReducer=f;var A=C.dispatch,j=C.pending,O=g.memoizedState;if(j!==null){C.pending=null;var oe=j=j.next;do O=f(O,oe.action),oe=oe.next;while(oe!==j);Si(O,g.memoizedState)||(la=!0),g.memoizedState=O,g.baseQueue===null&&(g.baseState=O),C.lastRenderedState=O}return[O,A]}function I4(){}function B4(f,g){var C=sn,A=Ha(),j=g(),O=!Si(A.memoizedState,j);if(O&&(A.memoizedState=j,la=!0),A=A.queue,aw(z4.bind(null,C,A,f),[f]),A.getSnapshot!==g||O||ss!==null&&ss.memoizedState.tag&1){if(C.flags|=2048,bh(9,$4.bind(null,C,A,j,g),void 0,null),as===null)throw Error(i(349));Oc&30||U4(C,g,j)}return j}function U4(f,g,C){f.flags|=16384,f={getSnapshot:g,value:C},g=sn.updateQueue,g===null?(g={lastEffect:null,stores:null},sn.updateQueue=g,g.stores=[f]):(C=g.stores,C===null?g.stores=[f]:C.push(f))}function $4(f,g,C,A){g.value=C,g.getSnapshot=A,W4(g)&&V4(f)}function z4(f,g,C){return C(function(){W4(g)&&V4(f)})}function W4(f){var g=f.getSnapshot;f=f.value;try{var C=g();return!Si(f,C)}catch{return!0}}function V4(f){var g=Yi(f,1);g!==null&&Ka(g,f,1,-1)}function G4(f){var g=Qi();return typeof f=="function"&&(f=f()),g.memoizedState=g.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sh,lastRenderedState:f},g.queue=f,f=f.dispatch=UL.bind(null,sn,f),[g.memoizedState,f]}function bh(f,g,C,A){return f={tag:f,create:g,destroy:C,deps:A,next:null},g=sn.updateQueue,g===null?(g={lastEffect:null,stores:null},sn.updateQueue=g,g.lastEffect=f.next=f):(C=g.lastEffect,C===null?g.lastEffect=f.next=f:(A=C.next,C.next=f,f.next=A,g.lastEffect=f)),f}function H4(){return Ha().memoizedState}function Om(f,g,C,A){var j=Qi();sn.flags|=f,j.memoizedState=bh(1|g,C,void 0,A===void 0?null:A)}function Mm(f,g,C,A){var j=Ha();A=A===void 0?null:A;var O=void 0;if(Hn!==null){var oe=Hn.memoizedState;if(O=oe.destroy,A!==null&&ew(A,oe.deps)){j.memoizedState=bh(g,C,O,A);return}}sn.flags|=f,j.memoizedState=bh(1|g,C,O,A)}function K4(f,g){return Om(8390656,8,f,g)}function aw(f,g){return Mm(2048,8,f,g)}function X4(f,g){return Mm(4,2,f,g)}function Y4(f,g){return Mm(4,4,f,g)}function J4(f,g){if(typeof g=="function")return f=f(),g(f),function(){g(null)};if(g!=null)return f=f(),g.current=f,function(){g.current=null}}function Q4(f,g,C){return C=C!=null?C.concat([f]):null,Mm(4,4,J4.bind(null,g,f),C)}function iw(){}function q4(f,g){var C=Ha();g=g===void 0?null:g;var A=C.memoizedState;return A!==null&&g!==null&&ew(g,A[1])?A[0]:(C.memoizedState=[f,g],f)}function Z4(f,g){var C=Ha();g=g===void 0?null:g;var A=C.memoizedState;return A!==null&&g!==null&&ew(g,A[1])?A[0]:(f=f(),C.memoizedState=[f,g],f)}function e3(f,g,C){return Oc&21?(Si(C,g)||(C=w4(),sn.lanes|=C,Mc|=C,f.baseState=!0),g):(f.baseState&&(f.baseState=!1,la=!0),f.memoizedState=C)}function IL(f,g){var C=Sr;Sr=C!==0&&4>C?C:4,f(!0);var A=Zv.transition;Zv.transition={};try{f(!1),g()}finally{Sr=C,Zv.transition=A}}function t3(){return Ha().memoizedState}function BL(f,g,C){var A=Cl(f);if(C={lane:A,action:C,hasEagerState:!1,eagerState:null,next:null},r3(f))n3(g,C);else if(C=D4(f,g,C,A),C!==null){var j=js();Ka(C,f,A,j),s3(C,g,A)}}function UL(f,g,C){var A=Cl(f),j={lane:A,action:C,hasEagerState:!1,eagerState:null,next:null};if(r3(f))n3(g,j);else{var O=f.alternate;if(f.lanes===0&&(O===null||O.lanes===0)&&(O=g.lastRenderedReducer,O!==null))try{var oe=g.lastRenderedState,Ee=O(oe,C);if(j.hasEagerState=!0,j.eagerState=Ee,Si(Ee,oe)){var ze=g.interleaved;ze===null?(j.next=j,Kv(g)):(j.next=ze.next,ze.next=j),g.interleaved=j;return}}catch{}finally{}C=D4(f,g,j,A),C!==null&&(j=js(),Ka(C,f,A,j),s3(C,g,A))}}function r3(f){var g=f.alternate;return f===sn||g!==null&&g===sn}function n3(f,g){wh=Rm=!0;var C=f.pending;C===null?g.next=g:(g.next=C.next,C.next=g),f.pending=g}function s3(f,g,C){if(C&4194240){var A=g.lanes;A&=f.pendingLanes,C|=A,g.lanes=C,Dv(f,C)}}var Lm={readContext:Va,useCallback:Ns,useContext:Ns,useEffect:Ns,useImperativeHandle:Ns,useInsertionEffect:Ns,useLayoutEffect:Ns,useMemo:Ns,useReducer:Ns,useRef:Ns,useState:Ns,useDebugValue:Ns,useDeferredValue:Ns,useTransition:Ns,useMutableSource:Ns,useSyncExternalStore:Ns,useId:Ns,unstable_isNewReconciler:!1},$L={readContext:Va,useCallback:function(f,g){return Qi().memoizedState=[f,g===void 0?null:g],f},useContext:Va,useEffect:K4,useImperativeHandle:function(f,g,C){return C=C!=null?C.concat([f]):null,Om(4194308,4,J4.bind(null,g,f),C)},useLayoutEffect:function(f,g){return Om(4194308,4,f,g)},useInsertionEffect:function(f,g){return Om(4,2,f,g)},useMemo:function(f,g){var C=Qi();return g=g===void 0?null:g,f=f(),C.memoizedState=[f,g],f},useReducer:function(f,g,C){var A=Qi();return g=C!==void 0?C(g):g,A.memoizedState=A.baseState=g,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:g},A.queue=f,f=f.dispatch=BL.bind(null,sn,f),[A.memoizedState,f]},useRef:function(f){var g=Qi();return f={current:f},g.memoizedState=f},useState:G4,useDebugValue:iw,useDeferredValue:function(f){return Qi().memoizedState=f},useTransition:function(){var f=G4(!1),g=f[0];return f=IL.bind(null,f[1]),Qi().memoizedState=f,[g,f]},useMutableSource:function(){},useSyncExternalStore:function(f,g,C){var A=sn,j=Qi();if(Yr){if(C===void 0)throw Error(i(407));C=C()}else{if(C=g(),as===null)throw Error(i(349));Oc&30||U4(A,g,C)}j.memoizedState=C;var O={value:C,getSnapshot:g};return j.queue=O,K4(z4.bind(null,A,O,f),[f]),A.flags|=2048,bh(9,$4.bind(null,A,O,C,g),void 0,null),C},useId:function(){var f=Qi(),g=as.identifierPrefix;if(Yr){var C=jo,A=Fo;C=(A&~(1<<32-_i(A)-1)).toString(32)+C,g=":"+g+"R"+C,C=_h++,0<C&&(g+="H"+C.toString(32)),g+=":"}else C=LL++,g=":"+g+"r"+C.toString(32)+":";return f.memoizedState=g},unstable_isNewReconciler:!1},zL={readContext:Va,useCallback:q4,useContext:Va,useEffect:aw,useImperativeHandle:Q4,useInsertionEffect:X4,useLayoutEffect:Y4,useMemo:Z4,useReducer:nw,useRef:H4,useState:function(){return nw(Sh)},useDebugValue:iw,useDeferredValue:function(f){var g=Ha();return e3(g,Hn.memoizedState,f)},useTransition:function(){var f=nw(Sh)[0],g=Ha().memoizedState;return[f,g]},useMutableSource:I4,useSyncExternalStore:B4,useId:t3,unstable_isNewReconciler:!1},WL={readContext:Va,useCallback:q4,useContext:Va,useEffect:aw,useImperativeHandle:Q4,useInsertionEffect:X4,useLayoutEffect:Y4,useMemo:Z4,useReducer:sw,useRef:H4,useState:function(){return sw(Sh)},useDebugValue:iw,useDeferredValue:function(f){var g=Ha();return Hn===null?g.memoizedState=f:e3(g,Hn.memoizedState,f)},useTransition:function(){var f=sw(Sh)[0],g=Ha().memoizedState;return[f,g]},useMutableSource:I4,useSyncExternalStore:B4,useId:t3,unstable_isNewReconciler:!1};function ki(f,g){if(f&&f.defaultProps){g=a({},g),f=f.defaultProps;for(var C in f)g[C]===void 0&&(g[C]=f[C]);return g}return g}function ow(f,g,C,A){g=f.memoizedState,C=C(A,g),C=C==null?g:a({},g,C),f.memoizedState=C,f.lanes===0&&(f.updateQueue.baseState=C)}var Im={isMounted:function(f){return(f=f._reactInternals)?P(f)===f:!1},enqueueSetState:function(f,g,C){f=f._reactInternals;var A=js(),j=Cl(f),O=Po(A,j);O.payload=g,C!=null&&(O.callback=C),g=Sl(f,O,j),g!==null&&(Ka(g,f,j,A),Fm(g,f,j))},enqueueReplaceState:function(f,g,C){f=f._reactInternals;var A=js(),j=Cl(f),O=Po(A,j);O.tag=1,O.payload=g,C!=null&&(O.callback=C),g=Sl(f,O,j),g!==null&&(Ka(g,f,j,A),Fm(g,f,j))},enqueueForceUpdate:function(f,g){f=f._reactInternals;var C=js(),A=Cl(f),j=Po(C,A);j.tag=2,g!=null&&(j.callback=g),g=Sl(f,j,A),g!==null&&(Ka(g,f,A,C),Fm(g,f,A))}};function a3(f,g,C,A,j,O,oe){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(A,O,oe):g.prototype&&g.prototype.isPureReactComponent?!Tm(C,A)||!Tm(j,O):!0}function i3(f,g,C){var A=!1,j=lr,O=g.contextType;return typeof O=="object"&&O!==null?O=Va(O):(j=Ln(g)?Mn:Ot.current,A=g.contextTypes,O=(A=A!=null)?Cn(f,j):lr),g=new g(C,O),f.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Im,f.stateNode=g,g._reactInternals=f,A&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=j,f.__reactInternalMemoizedMaskedChildContext=O),g}function o3(f,g,C,A){f=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(C,A),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(C,A),g.state!==f&&Im.enqueueReplaceState(g,g.state,null)}function lw(f,g,C,A){var j=f.stateNode;j.props=C,j.state=f.memoizedState,j.refs={},Xv(f);var O=g.contextType;typeof O=="object"&&O!==null?j.context=Va(O):(O=Ln(g)?Mn:Ot.current,j.context=Cn(f,O)),j.state=f.memoizedState,O=g.getDerivedStateFromProps,typeof O=="function"&&(ow(f,g,O,C),j.state=f.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(g=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),g!==j.state&&Im.enqueueReplaceState(j,j.state,null),jm(f,C,j,A),j.state=f.memoizedState),typeof j.componentDidMount=="function"&&(f.flags|=4194308)}function xd(f,g){try{var C="",A=g;do C+=ML(A),A=A.return;while(A);var j=C}catch(O){j=`
Error generating stack: `+O.message+`
`+O.stack}return{value:f,source:g,stack:j,digest:null}}function cw(f,g,C){return{value:f,source:null,stack:C??null,digest:g??null}}function uw(f,g){try{console.error(g.value)}catch(C){setTimeout(function(){throw C})}}var VL=typeof WeakMap=="function"?WeakMap:Map;function l3(f,g,C){C=Po(-1,C),C.tag=3,C.payload={element:null};var A=g.value;return C.callback=function(){qm||(qm=!0,Fw=A),uw(f,g)},C}function c3(f,g,C){C=Po(-1,C),C.tag=3;var A=f.type.getDerivedStateFromError;if(typeof A=="function"){var j=g.value;C.payload=function(){return A(j)},C.callback=function(){uw(f,g)}}var O=f.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(C.callback=function(){uw(f,g),typeof A!="function"&&(bl===null?bl=new Set([this]):bl.add(this));var oe=g.stack;this.componentDidCatch(g.value,{componentStack:oe!==null?oe:""})}),C}function u3(f,g,C){var A=f.pingCache;if(A===null){A=f.pingCache=new VL;var j=new Set;A.set(g,j)}else j=A.get(g),j===void 0&&(j=new Set,A.set(g,j));j.has(C)||(j.add(C),f=sI.bind(null,f,g,C),g.then(f,f))}function d3(f){do{var g;if((g=f.tag===13)&&(g=f.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return f;f=f.return}while(f!==null);return null}function f3(f,g,C,A,j){return f.mode&1?(f.flags|=65536,f.lanes=j,f):(f===g?f.flags|=65536:(f.flags|=128,C.flags|=131072,C.flags&=-52805,C.tag===1&&(C.alternate===null?C.tag=17:(g=Po(-1,1),g.tag=2,Sl(C,g,1))),C.lanes|=1),f)}var GL=o.ReactCurrentOwner,la=!1;function Ys(f,g,C,A){g.child=f===null?j4(g,null,C,A):fd(g,f.child,C,A)}function h3(f,g,C,A,j){C=C.render;var O=g.ref;return gd(g,j),A=tw(f,g,C,A,O,j),C=rw(),f!==null&&!la?(g.updateQueue=f.updateQueue,g.flags&=-2053,f.lanes&=~j,Do(f,g,j)):(Yr&&C&&Iv(g),g.flags|=1,Ys(f,g,A,j),g.child)}function g3(f,g,C,A,j){if(f===null){var O=C.type;return typeof O=="function"&&!Mw(O)&&O.defaultProps===void 0&&C.compare===null&&C.defaultProps===void 0?(g.tag=15,g.type=O,m3(f,g,O,A,j)):(f=sp(C.type,null,A,g,g.mode,j),f.ref=g.ref,f.return=g,g.child=f)}if(O=f.child,!(f.lanes&j)){var oe=O.memoizedProps;if(C=C.compare,C=C!==null?C:Tm,C(oe,A)&&f.ref===g.ref)return Do(f,g,j)}return g.flags|=1,f=El(O,A),f.ref=g.ref,f.return=g,g.child=f}function m3(f,g,C,A,j){if(f!==null){var O=f.memoizedProps;if(Tm(O,A)&&f.ref===g.ref)if(la=!1,g.pendingProps=A=O,(f.lanes&j)!==0)f.flags&131072&&(la=!0);else return g.lanes=f.lanes,Do(f,g,j)}return dw(f,g,C,A,j)}function p3(f,g,C){var A=g.pendingProps,j=A.children,O=f!==null?f.memoizedState:null;if(A.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(vd,Ta),Ta|=C;else{if(!(C&1073741824))return f=O!==null?O.baseLanes|C:C,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:f,cachePool:null,transitions:null},g.updateQueue=null,Be(vd,Ta),Ta|=f,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=O!==null?O.baseLanes:C,Be(vd,Ta),Ta|=A}else O!==null?(A=O.baseLanes|C,g.memoizedState=null):A=C,Be(vd,Ta),Ta|=A;return Ys(f,g,j,C),g.child}function x3(f,g){var C=g.ref;(f===null&&C!==null||f!==null&&f.ref!==C)&&(g.flags|=512,g.flags|=2097152)}function dw(f,g,C,A,j){var O=Ln(C)?Mn:Ot.current;return O=Cn(g,O),gd(g,j),C=tw(f,g,C,A,O,j),A=rw(),f!==null&&!la?(g.updateQueue=f.updateQueue,g.flags&=-2053,f.lanes&=~j,Do(f,g,j)):(Yr&&A&&Iv(g),g.flags|=1,Ys(f,g,C,j),g.child)}function y3(f,g,C,A,j){if(Ln(C)){var O=!0;xm(g)}else O=!1;if(gd(g,j),g.stateNode===null)Um(f,g),i3(g,C,A),lw(g,C,A,j),A=!0;else if(f===null){var oe=g.stateNode,Ee=g.memoizedProps;oe.props=Ee;var ze=oe.context,ct=C.contextType;typeof ct=="object"&&ct!==null?ct=Va(ct):(ct=Ln(C)?Mn:Ot.current,ct=Cn(g,ct));var Ft=C.getDerivedStateFromProps,qt=typeof Ft=="function"||typeof oe.getSnapshotBeforeUpdate=="function";qt||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(Ee!==A||ze!==ct)&&o3(g,oe,A,ct),_l=!1;var _t=g.memoizedState;oe.state=_t,jm(g,A,oe,j),ze=g.memoizedState,Ee!==A||_t!==ze||Xr.current||_l?(typeof Ft=="function"&&(ow(g,C,Ft,A),ze=g.memoizedState),(Ee=_l||a3(g,C,Ee,A,_t,ze,ct))?(qt||typeof oe.UNSAFE_componentWillMount!="function"&&typeof oe.componentWillMount!="function"||(typeof oe.componentWillMount=="function"&&oe.componentWillMount(),typeof oe.UNSAFE_componentWillMount=="function"&&oe.UNSAFE_componentWillMount()),typeof oe.componentDidMount=="function"&&(g.flags|=4194308)):(typeof oe.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=A,g.memoizedState=ze),oe.props=A,oe.state=ze,oe.context=ct,A=Ee):(typeof oe.componentDidMount=="function"&&(g.flags|=4194308),A=!1)}else{oe=g.stateNode,R4(f,g),Ee=g.memoizedProps,ct=g.type===g.elementType?Ee:ki(g.type,Ee),oe.props=ct,qt=g.pendingProps,_t=oe.context,ze=C.contextType,typeof ze=="object"&&ze!==null?ze=Va(ze):(ze=Ln(C)?Mn:Ot.current,ze=Cn(g,ze));var $r=C.getDerivedStateFromProps;(Ft=typeof $r=="function"||typeof oe.getSnapshotBeforeUpdate=="function")||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(Ee!==qt||_t!==ze)&&o3(g,oe,A,ze),_l=!1,_t=g.memoizedState,oe.state=_t,jm(g,A,oe,j);var Lr=g.memoizedState;Ee!==qt||_t!==Lr||Xr.current||_l?(typeof $r=="function"&&(ow(g,C,$r,A),Lr=g.memoizedState),(ct=_l||a3(g,C,ct,A,_t,Lr,ze)||!1)?(Ft||typeof oe.UNSAFE_componentWillUpdate!="function"&&typeof oe.componentWillUpdate!="function"||(typeof oe.componentWillUpdate=="function"&&oe.componentWillUpdate(A,Lr,ze),typeof oe.UNSAFE_componentWillUpdate=="function"&&oe.UNSAFE_componentWillUpdate(A,Lr,ze)),typeof oe.componentDidUpdate=="function"&&(g.flags|=4),typeof oe.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof oe.componentDidUpdate!="function"||Ee===f.memoizedProps&&_t===f.memoizedState||(g.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||Ee===f.memoizedProps&&_t===f.memoizedState||(g.flags|=1024),g.memoizedProps=A,g.memoizedState=Lr),oe.props=A,oe.state=Lr,oe.context=ze,A=ct):(typeof oe.componentDidUpdate!="function"||Ee===f.memoizedProps&&_t===f.memoizedState||(g.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||Ee===f.memoizedProps&&_t===f.memoizedState||(g.flags|=1024),A=!1)}return fw(f,g,C,A,O,j)}function fw(f,g,C,A,j,O){x3(f,g);var oe=(g.flags&128)!==0;if(!A&&!oe)return j&&v4(g,C,!1),Do(f,g,O);A=g.stateNode,GL.current=g;var Ee=oe&&typeof C.getDerivedStateFromError!="function"?null:A.render();return g.flags|=1,f!==null&&oe?(g.child=fd(g,f.child,null,O),g.child=fd(g,null,Ee,O)):Ys(f,g,Ee,O),g.memoizedState=A.state,j&&v4(g,C,!0),g.child}function v3(f){var g=f.stateNode;g.pendingContext?mm(f,g.pendingContext,g.pendingContext!==g.context):g.context&&mm(f,g.context,!1),Yv(f,g.containerInfo)}function w3(f,g,C,A,j){return dd(),zv(j),g.flags|=256,Ys(f,g,C,A),g.child}var hw={dehydrated:null,treeContext:null,retryLane:0};function gw(f){return{baseLanes:f,cachePool:null,transitions:null}}function _3(f,g,C){var A=g.pendingProps,j=nn.current,O=!1,oe=(g.flags&128)!==0,Ee;if((Ee=oe)||(Ee=f!==null&&f.memoizedState===null?!1:(j&2)!==0),Ee?(O=!0,g.flags&=-129):(f===null||f.memoizedState!==null)&&(j|=1),Be(nn,j&1),f===null)return $v(g),f=g.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?(g.mode&1?Vt(f)?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(oe=A.children,f=A.fallback,O?(A=g.mode,O=g.child,oe={mode:"hidden",children:oe},!(A&1)&&O!==null?(O.childLanes=0,O.pendingProps=oe):O=ap(oe,A,0,null),f=Uc(f,A,C,null),O.return=g,f.return=g,O.sibling=f,g.child=O,g.child.memoizedState=gw(C),g.memoizedState=hw,f):mw(g,oe));if(j=f.memoizedState,j!==null&&(Ee=j.dehydrated,Ee!==null))return HL(f,g,oe,A,Ee,j,C);if(O){O=A.fallback,oe=g.mode,j=f.child,Ee=j.sibling;var ze={mode:"hidden",children:A.children};return!(oe&1)&&g.child!==j?(A=g.child,A.childLanes=0,A.pendingProps=ze,g.deletions=null):(A=El(j,ze),A.subtreeFlags=j.subtreeFlags&14680064),Ee!==null?O=El(Ee,O):(O=Uc(O,oe,C,null),O.flags|=2),O.return=g,A.return=g,A.sibling=O,g.child=A,A=O,O=g.child,oe=f.child.memoizedState,oe=oe===null?gw(C):{baseLanes:oe.baseLanes|C,cachePool:null,transitions:oe.transitions},O.memoizedState=oe,O.childLanes=f.childLanes&~C,g.memoizedState=hw,A}return O=f.child,f=O.sibling,A=El(O,{mode:"visible",children:A.children}),!(g.mode&1)&&(A.lanes=C),A.return=g,A.sibling=null,f!==null&&(C=g.deletions,C===null?(g.deletions=[f],g.flags|=16):C.push(f)),g.child=A,g.memoizedState=null,A}function mw(f,g){return g=ap({mode:"visible",children:g},f.mode,0,null),g.return=f,f.child=g}function Bm(f,g,C,A){return A!==null&&zv(A),fd(g,f.child,null,C),f=mw(g,g.pendingProps.children),f.flags|=2,g.memoizedState=null,f}function HL(f,g,C,A,j,O,oe){if(C)return g.flags&256?(g.flags&=-257,A=cw(Error(i(422))),Bm(f,g,oe,A)):g.memoizedState!==null?(g.child=f.child,g.flags|=128,null):(O=A.fallback,j=g.mode,A=ap({mode:"visible",children:A.children},j,0,null),O=Uc(O,j,oe,null),O.flags|=2,A.return=g,O.return=g,A.sibling=O,g.child=A,g.mode&1&&fd(g,f.child,null,oe),g.child.memoizedState=gw(oe),g.memoizedState=hw,O);if(!(g.mode&1))return Bm(f,g,oe,null);if(Vt(j))return A=zt(j).digest,O=Error(i(419)),A=cw(O,A,void 0),Bm(f,g,oe,A);if(C=(oe&f.childLanes)!==0,la||C){if(A=as,A!==null){switch(oe&-oe){case 4:j=2;break;case 16:j=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:j=32;break;case 536870912:j=268435456;break;default:j=0}j=j&(A.suspendedLanes|oe)?0:j,j!==0&&j!==O.retryLane&&(O.retryLane=j,Yi(f,j),Ka(A,f,j,-1))}return Ow(),A=cw(Error(i(421))),Bm(f,g,oe,A)}return yt(j)?(g.flags|=128,g.child=f.child,g=aI.bind(null,f),G(j,g),null):(f=O.treeContext,ve&&(Wa=X(j),Ca=g,Yr=!0,bi=null,ph=!1,f!==null&&($a[za++]=Fo,$a[za++]=jo,$a[za++]=Pc,Fo=f.id,jo=f.overflow,Pc=g)),g=mw(g,A.children),g.flags|=4096,g)}function S3(f,g,C){f.lanes|=g;var A=f.alternate;A!==null&&(A.lanes|=g),Hv(f.return,g,C)}function pw(f,g,C,A,j){var O=f.memoizedState;O===null?f.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:A,tail:C,tailMode:j}:(O.isBackwards=g,O.rendering=null,O.renderingStartTime=0,O.last=A,O.tail=C,O.tailMode=j)}function b3(f,g,C){var A=g.pendingProps,j=A.revealOrder,O=A.tail;if(Ys(f,g,A.children,C),A=nn.current,A&2)A=A&1|2,g.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=g.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&S3(f,C,g);else if(f.tag===19)S3(f,C,g);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===g)break e;for(;f.sibling===null;){if(f.return===null||f.return===g)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}A&=1}if(Be(nn,A),!(g.mode&1))g.memoizedState=null;else switch(j){case"forwards":for(C=g.child,j=null;C!==null;)f=C.alternate,f!==null&&Pm(f)===null&&(j=C),C=C.sibling;C=j,C===null?(j=g.child,g.child=null):(j=C.sibling,C.sibling=null),pw(g,!1,j,C,O);break;case"backwards":for(C=null,j=g.child,g.child=null;j!==null;){if(f=j.alternate,f!==null&&Pm(f)===null){g.child=j;break}f=j.sibling,j.sibling=C,C=j,j=f}pw(g,!0,C,null,O);break;case"together":pw(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Um(f,g){!(g.mode&1)&&f!==null&&(f.alternate=null,g.alternate=null,g.flags|=2)}function Do(f,g,C){if(f!==null&&(g.dependencies=f.dependencies),Mc|=g.lanes,!(C&g.childLanes))return null;if(f!==null&&g.child!==f.child)throw Error(i(153));if(g.child!==null){for(f=g.child,C=El(f,f.pendingProps),g.child=C,C.return=g;f.sibling!==null;)f=f.sibling,C=C.sibling=El(f,f.pendingProps),C.return=g;C.sibling=null}return g.child}function KL(f,g,C){switch(g.tag){case 3:v3(g),dd();break;case 5:L4(g);break;case 1:Ln(g.type)&&xm(g);break;case 4:Yv(g,g.stateNode.containerInfo);break;case 10:P4(g,g.type._context,g.memoizedProps.value);break;case 13:var A=g.memoizedState;if(A!==null)return A.dehydrated!==null?(Be(nn,nn.current&1),g.flags|=128,null):C&g.child.childLanes?_3(f,g,C):(Be(nn,nn.current&1),f=Do(f,g,C),f!==null?f.sibling:null);Be(nn,nn.current&1);break;case 19:if(A=(C&g.childLanes)!==0,f.flags&128){if(A)return b3(f,g,C);g.flags|=128}var j=g.memoizedState;if(j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),Be(nn,nn.current),A)break;return null;case 22:case 23:return g.lanes=0,p3(f,g,C)}return Do(f,g,C)}function qi(f){f.flags|=4}function k3(f,g){if(f!==null&&f.child===g.child)return!0;if(g.flags&16)return!1;for(f=g.child;f!==null;){if(f.flags&12854||f.subtreeFlags&12854)return!1;f=f.sibling}return!0}var kh,Ch,$m,zm;if(Ce)kh=function(f,g){for(var C=g.child;C!==null;){if(C.tag===5||C.tag===6)z(f,C.stateNode);else if(C.tag!==4&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===g)break;for(;C.sibling===null;){if(C.return===null||C.return===g)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},Ch=function(){},$m=function(f,g,C,A,j){if(f=f.memoizedProps,f!==A){var O=g.stateNode,oe=Ji(Ga.current);C=J(O,C,f,A,j,oe),(g.updateQueue=C)&&qi(g)}},zm=function(f,g,C,A){C!==A&&qi(g)};else if(re){kh=function(f,g,C,A){for(var j=g.child;j!==null;){if(j.tag===5){var O=j.stateNode;C&&A&&(O=nt(O,j.type,j.memoizedProps,j)),z(f,O)}else if(j.tag===6)O=j.stateNode,C&&A&&(O=Rt(O,j.memoizedProps,j)),z(f,O);else if(j.tag!==4){if(j.tag===22&&j.memoizedState!==null)O=j.child,O!==null&&(O.return=j),kh(f,j,!0,!0);else if(j.child!==null){j.child.return=j,j=j.child;continue}}if(j===g)break;for(;j.sibling===null;){if(j.return===null||j.return===g)return;j=j.return}j.sibling.return=j.return,j=j.sibling}};var C3=function(f,g,C,A){for(var j=g.child;j!==null;){if(j.tag===5){var O=j.stateNode;C&&A&&(O=nt(O,j.type,j.memoizedProps,j)),be(f,O)}else if(j.tag===6)O=j.stateNode,C&&A&&(O=Rt(O,j.memoizedProps,j)),be(f,O);else if(j.tag!==4){if(j.tag===22&&j.memoizedState!==null)O=j.child,O!==null&&(O.return=j),C3(f,j,!0,!0);else if(j.child!==null){j.child.return=j,j=j.child;continue}}if(j===g)break;for(;j.sibling===null;){if(j.return===null||j.return===g)return;j=j.return}j.sibling.return=j.return,j=j.sibling}};Ch=function(f,g){var C=g.stateNode;if(!k3(f,g)){f=C.containerInfo;var A=me(f);C3(A,g,!1,!1),C.pendingChildren=A,qi(g),_e(f,A)}},$m=function(f,g,C,A,j){var O=f.stateNode,oe=f.memoizedProps;if((f=k3(f,g))&&oe===A)g.stateNode=O;else{var Ee=g.stateNode,ze=Ji(Ga.current),ct=null;oe!==A&&(ct=J(Ee,C,oe,A,j,ze)),f&&ct===null?g.stateNode=O:(O=vt(O,ct,C,oe,A,g,f,Ee),Y(O,C,A,j,ze)&&qi(g),g.stateNode=O,f?qi(g):kh(O,g,!1,!1))}},zm=function(f,g,C,A){C!==A?(f=Ji(md.current),C=Ji(Ga.current),g.stateNode=de(A,f,C,g),qi(g)):g.stateNode=f.stateNode}}else Ch=function(){},$m=function(){},zm=function(){};function Th(f,g){if(!Yr)switch(f.tailMode){case"hidden":g=f.tail;for(var C=null;g!==null;)g.alternate!==null&&(C=g),g=g.sibling;C===null?f.tail=null:C.sibling=null;break;case"collapsed":C=f.tail;for(var A=null;C!==null;)C.alternate!==null&&(A=C),C=C.sibling;A===null?g||f.tail===null?f.tail=null:f.tail.sibling=null:A.sibling=null}}function As(f){var g=f.alternate!==null&&f.alternate.child===f.child,C=0,A=0;if(g)for(var j=f.child;j!==null;)C|=j.lanes|j.childLanes,A|=j.subtreeFlags&14680064,A|=j.flags&14680064,j.return=f,j=j.sibling;else for(j=f.child;j!==null;)C|=j.lanes|j.childLanes,A|=j.subtreeFlags,A|=j.flags,j.return=f,j=j.sibling;return f.subtreeFlags|=A,f.childLanes=C,g}function XL(f,g,C){var A=g.pendingProps;switch(Bv(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return As(g),null;case 1:return Ln(g.type)&&wi(),As(g),null;case 3:return C=g.stateNode,pd(),ae(Xr),ae(Ot),qv(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(f===null||f.child===null)&&(Cm(g)?qi(g):f===null||f.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,bi!==null&&(Dw(bi),bi=null))),Ch(f,g),As(g),null;case 5:Jv(g),C=Ji(md.current);var j=g.type;if(f!==null&&g.stateNode!=null)$m(f,g,j,A,C),f.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!A){if(g.stateNode===null)throw Error(i(166));return As(g),null}if(f=Ji(Ga.current),Cm(g)){if(!ve)throw Error(i(175));f=H(g.stateNode,g.type,g.memoizedProps,C,f,g,!ph),g.updateQueue=f,f!==null&&qi(g)}else{var O=ne(j,A,C,f,g);kh(O,g,!1,!1),g.stateNode=O,Y(O,j,A,C,f)&&qi(g)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return As(g),null;case 6:if(f&&g.stateNode!=null)zm(f,g,f.memoizedProps,A);else{if(typeof A!="string"&&g.stateNode===null)throw Error(i(166));if(f=Ji(md.current),C=Ji(Ga.current),Cm(g)){if(!ve)throw Error(i(176));if(f=g.stateNode,C=g.memoizedProps,(A=he(f,C,g,!ph))&&(j=Ca,j!==null))switch(j.tag){case 3:Te(j.stateNode.containerInfo,f,C,(j.mode&1)!==0);break;case 5:Ve(j.type,j.memoizedProps,j.stateNode,f,C,(j.mode&1)!==0)}A&&qi(g)}else g.stateNode=de(A,f,C,g)}return As(g),null;case 13:if(ae(nn),A=g.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(Yr&&Wa!==null&&g.mode&1&&!(g.flags&128))N4(),dd(),g.flags|=98560,j=!1;else if(j=Cm(g),A!==null&&A.dehydrated!==null){if(f===null){if(!j)throw Error(i(318));if(!ve)throw Error(i(344));if(j=g.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(i(317));Ne(j,g)}else dd(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;As(g),j=!1}else bi!==null&&(Dw(bi),bi=null),j=!0;if(!j)return g.flags&65536?g:null}return g.flags&128?(g.lanes=C,g):(C=A!==null,C!==(f!==null&&f.memoizedState!==null)&&C&&(g.child.flags|=8192,g.mode&1&&(f===null||nn.current&1?Kn===0&&(Kn=3):Ow())),g.updateQueue!==null&&(g.flags|=4),As(g),null);case 4:return pd(),Ch(f,g),f===null&&Oe(g.stateNode.containerInfo),As(g),null;case 10:return Gv(g.type._context),As(g),null;case 17:return Ln(g.type)&&wi(),As(g),null;case 19:if(ae(nn),j=g.memoizedState,j===null)return As(g),null;if(A=(g.flags&128)!==0,O=j.rendering,O===null)if(A)Th(j,!1);else{if(Kn!==0||f!==null&&f.flags&128)for(f=g.child;f!==null;){if(O=Pm(f),O!==null){for(g.flags|=128,Th(j,!1),f=O.updateQueue,f!==null&&(g.updateQueue=f,g.flags|=4),g.subtreeFlags=0,f=C,C=g.child;C!==null;)A=C,j=f,A.flags&=14680066,O=A.alternate,O===null?(A.childLanes=0,A.lanes=j,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=O.childLanes,A.lanes=O.lanes,A.child=O.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=O.memoizedProps,A.memoizedState=O.memoizedState,A.updateQueue=O.updateQueue,A.type=O.type,j=O.dependencies,A.dependencies=j===null?null:{lanes:j.lanes,firstContext:j.firstContext}),C=C.sibling;return Be(nn,nn.current&1|2),g.child}f=f.sibling}j.tail!==null&&ns()>Aw&&(g.flags|=128,A=!0,Th(j,!1),g.lanes=4194304)}else{if(!A)if(f=Pm(O),f!==null){if(g.flags|=128,A=!0,f=f.updateQueue,f!==null&&(g.updateQueue=f,g.flags|=4),Th(j,!0),j.tail===null&&j.tailMode==="hidden"&&!O.alternate&&!Yr)return As(g),null}else 2*ns()-j.renderingStartTime>Aw&&C!==1073741824&&(g.flags|=128,A=!0,Th(j,!1),g.lanes=4194304);j.isBackwards?(O.sibling=g.child,g.child=O):(f=j.last,f!==null?f.sibling=O:g.child=O,j.last=O)}return j.tail!==null?(g=j.tail,j.rendering=g,j.tail=g.sibling,j.renderingStartTime=ns(),g.sibling=null,f=nn.current,Be(nn,A?f&1|2:f&1),g):(As(g),null);case 22:case 23:return Rw(),C=g.memoizedState!==null,f!==null&&f.memoizedState!==null!==C&&(g.flags|=8192),C&&g.mode&1?Ta&1073741824&&(As(g),Ce&&g.subtreeFlags&6&&(g.flags|=8192)):As(g),null;case 24:return null;case 25:return null}throw Error(i(156,g.tag))}function YL(f,g){switch(Bv(g),g.tag){case 1:return Ln(g.type)&&wi(),f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 3:return pd(),ae(Xr),ae(Ot),qv(),f=g.flags,f&65536&&!(f&128)?(g.flags=f&-65537|128,g):null;case 5:return Jv(g),null;case 13:if(ae(nn),f=g.memoizedState,f!==null&&f.dehydrated!==null){if(g.alternate===null)throw Error(i(340));dd()}return f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 19:return ae(nn),null;case 4:return pd(),null;case 10:return Gv(g.type._context),null;case 22:case 23:return Rw(),null;case 24:return null;default:return null}}var Wm=!1,Fs=!1,JL=typeof WeakSet=="function"?WeakSet:Set,Et=null;function yd(f,g){var C=f.ref;if(C!==null)if(typeof C=="function")try{C(null)}catch(A){Jr(f,g,A)}else C.current=null}function xw(f,g,C){try{C()}catch(A){Jr(f,g,A)}}var T3=!1;function QL(f,g){for(L(f.containerInfo),Et=g;Et!==null;)if(f=Et,g=f.child,(f.subtreeFlags&1028)!==0&&g!==null)g.return=f,Et=g;else for(;Et!==null;){f=Et;try{var C=f.alternate;if(f.flags&1024)switch(f.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var A=C.memoizedProps,j=C.memoizedState,O=f.stateNode,oe=O.getSnapshotBeforeUpdate(f.elementType===f.type?A:ki(f.type,A),j);O.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:Ce&&jt(f.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(Ee){Jr(f,f.return,Ee)}if(g=f.sibling,g!==null){g.return=f.return,Et=g;break}Et=f.return}return C=T3,T3=!1,C}function Eh(f,g,C){var A=g.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var j=A=A.next;do{if((j.tag&f)===f){var O=j.destroy;j.destroy=void 0,O!==void 0&&xw(g,C,O)}j=j.next}while(j!==A)}}function Vm(f,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var C=g=g.next;do{if((C.tag&f)===f){var A=C.create;C.destroy=A()}C=C.next}while(C!==g)}}function yw(f){var g=f.ref;if(g!==null){var C=f.stateNode;switch(f.tag){case 5:f=V(C);break;default:f=C}typeof g=="function"?g(f):g.current=f}}function E3(f){var g=f.alternate;g!==null&&(f.alternate=null,E3(g)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(g=f.stateNode,g!==null&&Re(g)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function N3(f){return f.tag===5||f.tag===3||f.tag===4}function A3(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||N3(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function vw(f,g,C){var A=f.tag;if(A===5||A===6)f=f.stateNode,g?Le(C,f,g):Pt(C,f);else if(A!==4&&(f=f.child,f!==null))for(vw(f,g,C),f=f.sibling;f!==null;)vw(f,g,C),f=f.sibling}function ww(f,g,C){var A=f.tag;if(A===5||A===6)f=f.stateNode,g?De(C,f,g):At(C,f);else if(A!==4&&(f=f.child,f!==null))for(ww(f,g,C),f=f.sibling;f!==null;)ww(f,g,C),f=f.sibling}var ms=null,Ci=!1;function Zi(f,g,C){for(C=C.child;C!==null;)_w(f,g,C),C=C.sibling}function _w(f,g,C){if(Ki&&typeof Ki.onCommitFiberUnmount=="function")try{Ki.onCommitFiberUnmount(_m,C)}catch{}switch(C.tag){case 5:Fs||yd(C,g);case 6:if(Ce){var A=ms,j=Ci;ms=null,Zi(f,g,C),ms=A,Ci=j,ms!==null&&(Ci?ht(ms,C.stateNode):pt(ms,C.stateNode))}else Zi(f,g,C);break;case 18:Ce&&ms!==null&&(Ci?Se(ms,C.stateNode):ue(ms,C.stateNode));break;case 4:Ce?(A=ms,j=Ci,ms=C.stateNode.containerInfo,Ci=!0,Zi(f,g,C),ms=A,Ci=j):(re&&(A=C.stateNode.containerInfo,j=me(A),Fe(A,j)),Zi(f,g,C));break;case 0:case 11:case 14:case 15:if(!Fs&&(A=C.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){j=A=A.next;do{var O=j,oe=O.destroy;O=O.tag,oe!==void 0&&(O&2||O&4)&&xw(C,g,oe),j=j.next}while(j!==A)}Zi(f,g,C);break;case 1:if(!Fs&&(yd(C,g),A=C.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=C.memoizedProps,A.state=C.memoizedState,A.componentWillUnmount()}catch(Ee){Jr(C,g,Ee)}Zi(f,g,C);break;case 21:Zi(f,g,C);break;case 22:C.mode&1?(Fs=(A=Fs)||C.memoizedState!==null,Zi(f,g,C),Fs=A):Zi(f,g,C);break;default:Zi(f,g,C)}}function F3(f){var g=f.updateQueue;if(g!==null){f.updateQueue=null;var C=f.stateNode;C===null&&(C=f.stateNode=new JL),g.forEach(function(A){var j=iI.bind(null,f,A);C.has(A)||(C.add(A),A.then(j,j))})}}function Ti(f,g){var C=g.deletions;if(C!==null)for(var A=0;A<C.length;A++){var j=C[A];try{var O=f,oe=g;if(Ce){var Ee=oe;e:for(;Ee!==null;){switch(Ee.tag){case 5:ms=Ee.stateNode,Ci=!1;break e;case 3:ms=Ee.stateNode.containerInfo,Ci=!0;break e;case 4:ms=Ee.stateNode.containerInfo,Ci=!0;break e}Ee=Ee.return}if(ms===null)throw Error(i(160));_w(O,oe,j),ms=null,Ci=!1}else _w(O,oe,j);var ze=j.alternate;ze!==null&&(ze.return=null),j.return=null}catch(ct){Jr(j,g,ct)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)j3(g,f),g=g.sibling}function j3(f,g){var C=f.alternate,A=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(Ti(g,f),eo(f),A&4){try{Eh(3,f,f.return),Vm(3,f)}catch(_t){Jr(f,f.return,_t)}try{Eh(5,f,f.return)}catch(_t){Jr(f,f.return,_t)}}break;case 1:Ti(g,f),eo(f),A&512&&C!==null&&yd(C,C.return);break;case 5:if(Ti(g,f),eo(f),A&512&&C!==null&&yd(C,C.return),Ce){if(f.flags&32){var j=f.stateNode;try{Tt(j)}catch(_t){Jr(f,f.return,_t)}}if(A&4&&(j=f.stateNode,j!=null)){var O=f.memoizedProps;if(C=C!==null?C.memoizedProps:O,A=f.type,g=f.updateQueue,f.updateQueue=null,g!==null)try{xe(j,g,A,C,O,f)}catch(_t){Jr(f,f.return,_t)}}}break;case 6:if(Ti(g,f),eo(f),A&4&&Ce){if(f.stateNode===null)throw Error(i(162));j=f.stateNode,O=f.memoizedProps,C=C!==null?C.memoizedProps:O;try{it(j,C,O)}catch(_t){Jr(f,f.return,_t)}}break;case 3:if(Ti(g,f),eo(f),A&4){if(Ce&&ve&&C!==null&&C.memoizedState.isDehydrated)try{Q(g.containerInfo)}catch(_t){Jr(f,f.return,_t)}if(re){j=g.containerInfo,O=g.pendingChildren;try{Fe(j,O)}catch(_t){Jr(f,f.return,_t)}}}break;case 4:if(Ti(g,f),eo(f),A&4&&re){O=f.stateNode,j=O.containerInfo,O=O.pendingChildren;try{Fe(j,O)}catch(_t){Jr(f,f.return,_t)}}break;case 13:Ti(g,f),eo(f),j=f.child,j.flags&8192&&(O=j.memoizedState!==null,j.stateNode.isHidden=O,!O||j.alternate!==null&&j.alternate.memoizedState!==null||(Nw=ns())),A&4&&F3(f);break;case 22:var oe=C!==null&&C.memoizedState!==null;if(f.mode&1?(Fs=(C=Fs)||oe,Ti(g,f),Fs=C):Ti(g,f),eo(f),A&8192){if(C=f.memoizedState!==null,(f.stateNode.isHidden=C)&&!oe&&f.mode&1)for(Et=f,A=f.child;A!==null;){for(g=Et=A;Et!==null;){oe=Et;var Ee=oe.child;switch(oe.tag){case 0:case 11:case 14:case 15:Eh(4,oe,oe.return);break;case 1:yd(oe,oe.return);var ze=oe.stateNode;if(typeof ze.componentWillUnmount=="function"){var ct=oe,Ft=oe.return;try{var qt=ct;ze.props=qt.memoizedProps,ze.state=qt.memoizedState,ze.componentWillUnmount()}catch(_t){Jr(ct,Ft,_t)}}break;case 5:yd(oe,oe.return);break;case 22:if(oe.memoizedState!==null){R3(g);continue}}Ee!==null?(Ee.return=oe,Et=Ee):R3(g)}A=A.sibling}if(Ce){e:if(A=null,Ce)for(g=f;;){if(g.tag===5){if(A===null){A=g;try{j=g.stateNode,C?gr(j):mr(g.stateNode,g.memoizedProps)}catch(_t){Jr(f,f.return,_t)}}}else if(g.tag===6){if(A===null)try{O=g.stateNode,C?tr(O):Je(O,g.memoizedProps)}catch(_t){Jr(f,f.return,_t)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===f)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break e;for(;g.sibling===null;){if(g.return===null||g.return===f)break e;A===g&&(A=null),g=g.return}A===g&&(A=null),g.sibling.return=g.return,g=g.sibling}}}break;case 19:Ti(g,f),eo(f),A&4&&F3(f);break;case 21:break;default:Ti(g,f),eo(f)}}function eo(f){var g=f.flags;if(g&2){try{if(Ce){e:{for(var C=f.return;C!==null;){if(N3(C)){var A=C;break e}C=C.return}throw Error(i(160))}switch(A.tag){case 5:var j=A.stateNode;A.flags&32&&(Tt(j),A.flags&=-33);var O=A3(f);ww(f,O,j);break;case 3:case 4:var oe=A.stateNode.containerInfo,Ee=A3(f);vw(f,Ee,oe);break;default:throw Error(i(161))}}}catch(ze){Jr(f,f.return,ze)}f.flags&=-3}g&4096&&(f.flags&=-4097)}function qL(f,g,C){Et=f,P3(f)}function P3(f,g,C){for(var A=(f.mode&1)!==0;Et!==null;){var j=Et,O=j.child;if(j.tag===22&&A){var oe=j.memoizedState!==null||Wm;if(!oe){var Ee=j.alternate,ze=Ee!==null&&Ee.memoizedState!==null||Fs;Ee=Wm;var ct=Fs;if(Wm=oe,(Fs=ze)&&!ct)for(Et=j;Et!==null;)oe=Et,ze=oe.child,oe.tag===22&&oe.memoizedState!==null?O3(j):ze!==null?(ze.return=oe,Et=ze):O3(j);for(;O!==null;)Et=O,P3(O),O=O.sibling;Et=j,Wm=Ee,Fs=ct}D3(f)}else j.subtreeFlags&8772&&O!==null?(O.return=j,Et=O):D3(f)}}function D3(f){for(;Et!==null;){var g=Et;if(g.flags&8772){var C=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:Fs||Vm(5,g);break;case 1:var A=g.stateNode;if(g.flags&4&&!Fs)if(C===null)A.componentDidMount();else{var j=g.elementType===g.type?C.memoizedProps:ki(g.type,C.memoizedProps);A.componentDidUpdate(j,C.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var O=g.updateQueue;O!==null&&M4(g,O,A);break;case 3:var oe=g.updateQueue;if(oe!==null){if(C=null,g.child!==null)switch(g.child.tag){case 5:C=V(g.child.stateNode);break;case 1:C=g.child.stateNode}M4(g,oe,C)}break;case 5:var Ee=g.stateNode;C===null&&g.flags&4&&rt(Ee,g.type,g.memoizedProps,g);break;case 6:break;case 4:break;case 12:break;case 13:if(ve&&g.memoizedState===null){var ze=g.alternate;if(ze!==null){var ct=ze.memoizedState;if(ct!==null){var Ft=ct.dehydrated;Ft!==null&&ie(Ft)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Fs||g.flags&512&&yw(g)}catch(qt){Jr(g,g.return,qt)}}if(g===f){Et=null;break}if(C=g.sibling,C!==null){C.return=g.return,Et=C;break}Et=g.return}}function R3(f){for(;Et!==null;){var g=Et;if(g===f){Et=null;break}var C=g.sibling;if(C!==null){C.return=g.return,Et=C;break}Et=g.return}}function O3(f){for(;Et!==null;){var g=Et;try{switch(g.tag){case 0:case 11:case 15:var C=g.return;try{Vm(4,g)}catch(ze){Jr(g,C,ze)}break;case 1:var A=g.stateNode;if(typeof A.componentDidMount=="function"){var j=g.return;try{A.componentDidMount()}catch(ze){Jr(g,j,ze)}}var O=g.return;try{yw(g)}catch(ze){Jr(g,O,ze)}break;case 5:var oe=g.return;try{yw(g)}catch(ze){Jr(g,oe,ze)}}}catch(ze){Jr(g,g.return,ze)}if(g===f){Et=null;break}var Ee=g.sibling;if(Ee!==null){Ee.return=g.return,Et=Ee;break}Et=g.return}}var Gm=0,Hm=1,Km=2,Xm=3,Ym=4;if(typeof Symbol=="function"&&Symbol.for){var Nh=Symbol.for;Gm=Nh("selector.component"),Hm=Nh("selector.has_pseudo_class"),Km=Nh("selector.role"),Xm=Nh("selector.test_id"),Ym=Nh("selector.text")}function Sw(f){var g=we(f);if(g!=null){if(typeof g.memoizedProps["data-testname"]!="string")throw Error(i(364));return g}if(f=Pe(f),f===null)throw Error(i(362));return f.stateNode.current}function bw(f,g){switch(g.$$typeof){case Gm:if(f.type===g.value)return!0;break;case Hm:e:{g=g.value,f=[f,0];for(var C=0;C<f.length;){var A=f[C++],j=f[C++],O=g[j];if(A.tag!==5||!Xe(A)){for(;O!=null&&bw(A,O);)j++,O=g[j];if(j===g.length){g=!0;break e}else for(A=A.child;A!==null;)f.push(A,j),A=A.sibling}}g=!1}return g;case Km:if(f.tag===5&&ut(f.stateNode,g.value))return!0;break;case Ym:if((f.tag===5||f.tag===6)&&(f=We(f),f!==null&&0<=f.indexOf(g.value)))return!0;break;case Xm:if(f.tag===5&&(f=f.memoizedProps["data-testname"],typeof f=="string"&&f.toLowerCase()===g.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function kw(f){switch(f.$$typeof){case Gm:return"<"+(F(f.value)||"Unknown")+">";case Hm:return":has("+(kw(f)||"")+")";case Km:return'[role="'+f.value+'"]';case Ym:return'"'+f.value+'"';case Xm:return'[data-testname="'+f.value+'"]';default:throw Error(i(365))}}function M3(f,g){var C=[];f=[f,0];for(var A=0;A<f.length;){var j=f[A++],O=f[A++],oe=g[O];if(j.tag!==5||!Xe(j)){for(;oe!=null&&bw(j,oe);)O++,oe=g[O];if(O===g.length)C.push(j);else for(j=j.child;j!==null;)f.push(j,O),j=j.sibling}}return C}function Cw(f,g){if(!Ae)throw Error(i(363));f=Sw(f),f=M3(f,g),g=[],f=Array.from(f);for(var C=0;C<f.length;){var A=f[C++];if(A.tag===5)Xe(A)||g.push(A.stateNode);else for(A=A.child;A!==null;)f.push(A),A=A.sibling}return g}var ZL=Math.ceil,Jm=o.ReactCurrentDispatcher,Tw=o.ReactCurrentOwner,Tn=o.ReactCurrentBatchConfig,cr=0,as=null,In=null,ps=0,Ta=0,vd=It(0),Kn=0,Ah=null,Mc=0,Qm=0,Ew=0,Fh=null,ca=null,Nw=0,Aw=1/0,Ro=null;function wd(){Aw=ns()+500}var qm=!1,Fw=null,bl=null,Zm=!1,kl=null,ep=0,jh=0,jw=null,tp=-1,rp=0;function js(){return cr&6?ns():tp!==-1?tp:tp=ns()}function Cl(f){return f.mode&1?cr&2&&ps!==0?ps&-ps:OL.transition!==null?(rp===0&&(rp=w4()),rp):(f=Sr,f!==0?f:Ze()):1}function Ka(f,g,C,A){if(50<jh)throw jh=0,jw=null,Error(i(185));mh(f,C,A),(!(cr&2)||f!==as)&&(f===as&&(!(cr&2)&&(Qm|=C),Kn===4&&Tl(f,ps)),ua(f,A),C===1&&cr===0&&!(g.mode&1)&&(wd(),Sm&&Xi()))}function ua(f,g){var C=f.callbackNode;TL(f,g);var A=wm(f,f===as?ps:0);if(A===0)C!==null&&S4(C),f.callbackNode=null,f.callbackPriority=0;else if(g=A&-A,f.callbackPriority!==g){if(C!=null&&S4(C),g===1)f.tag===0?RL(I3.bind(null,f)):b4(I3.bind(null,f)),xt?$t(function(){!(cr&6)&&Xi()}):Rv(Ov,Xi),C=null;else{switch(_4(A)){case 1:C=Ov;break;case 4:C=FL;break;case 16:C=Mv;break;case 536870912:C=jL;break;default:C=Mv}C=K3(C,L3.bind(null,f))}f.callbackPriority=g,f.callbackNode=C}}function L3(f,g){if(tp=-1,rp=0,cr&6)throw Error(i(327));var C=f.callbackNode;if(Bc()&&f.callbackNode!==C)return null;var A=wm(f,f===as?ps:0);if(A===0)return null;if(A&30||A&f.expiredLanes||g)g=np(f,A);else{g=A;var j=cr;cr|=2;var O=$3();(as!==f||ps!==g)&&(Ro=null,wd(),Lc(f,g));do try{rI();break}catch(Ee){U3(f,Ee)}while(!0);Vv(),Jm.current=O,cr=j,In!==null?g=0:(as=null,ps=0,g=Kn)}if(g!==0){if(g===2&&(j=jv(f),j!==0&&(A=j,g=Pw(f,j))),g===1)throw C=Ah,Lc(f,0),Tl(f,A),ua(f,ns()),C;if(g===6)Tl(f,A);else{if(j=f.current.alternate,!(A&30)&&!eI(j)&&(g=np(f,A),g===2&&(O=jv(f),O!==0&&(A=O,g=Pw(f,O))),g===1))throw C=Ah,Lc(f,0),Tl(f,A),ua(f,ns()),C;switch(f.finishedWork=j,f.finishedLanes=A,g){case 0:case 1:throw Error(i(345));case 2:Ic(f,ca,Ro);break;case 3:if(Tl(f,A),(A&130023424)===A&&(g=Nw+500-ns(),10<g)){if(wm(f,0)!==0)break;if(j=f.suspendedLanes,(j&A)!==A){js(),f.pingedLanes|=f.suspendedLanes&j;break}f.timeoutHandle=ee(Ic.bind(null,f,ca,Ro),g);break}Ic(f,ca,Ro);break;case 4:if(Tl(f,A),(A&4194240)===A)break;for(g=f.eventTimes,j=-1;0<A;){var oe=31-_i(A);O=1<<oe,oe=g[oe],oe>j&&(j=oe),A&=~O}if(A=j,A=ns()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*ZL(A/1960))-A,10<A){f.timeoutHandle=ee(Ic.bind(null,f,ca,Ro),A);break}Ic(f,ca,Ro);break;case 5:Ic(f,ca,Ro);break;default:throw Error(i(329))}}}return ua(f,ns()),f.callbackNode===C?L3.bind(null,f):null}function Pw(f,g){var C=Fh;return f.current.memoizedState.isDehydrated&&(Lc(f,g).flags|=256),f=np(f,g),f!==2&&(g=ca,ca=C,g!==null&&Dw(g)),f}function Dw(f){ca===null?ca=f:ca.push.apply(ca,f)}function eI(f){for(var g=f;;){if(g.flags&16384){var C=g.updateQueue;if(C!==null&&(C=C.stores,C!==null))for(var A=0;A<C.length;A++){var j=C[A],O=j.getSnapshot;j=j.value;try{if(!Si(O(),j))return!1}catch{return!1}}}if(C=g.child,g.subtreeFlags&16384&&C!==null)C.return=g,g=C;else{if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Tl(f,g){for(g&=~Ew,g&=~Qm,f.suspendedLanes|=g,f.pingedLanes&=~g,f=f.expirationTimes;0<g;){var C=31-_i(g),A=1<<C;f[C]=-1,g&=~A}}function I3(f){if(cr&6)throw Error(i(327));Bc();var g=wm(f,0);if(!(g&1))return ua(f,ns()),null;var C=np(f,g);if(f.tag!==0&&C===2){var A=jv(f);A!==0&&(g=A,C=Pw(f,A))}if(C===1)throw C=Ah,Lc(f,0),Tl(f,g),ua(f,ns()),C;if(C===6)throw Error(i(345));return f.finishedWork=f.current.alternate,f.finishedLanes=g,Ic(f,ca,Ro),ua(f,ns()),null}function B3(f){kl!==null&&kl.tag===0&&!(cr&6)&&Bc();var g=cr;cr|=1;var C=Tn.transition,A=Sr;try{if(Tn.transition=null,Sr=1,f)return f()}finally{Sr=A,Tn.transition=C,cr=g,!(cr&6)&&Xi()}}function Rw(){Ta=vd.current,ae(vd)}function Lc(f,g){f.finishedWork=null,f.finishedLanes=0;var C=f.timeoutHandle;if(C!==fe&&(f.timeoutHandle=fe,ge(C)),In!==null)for(C=In.return;C!==null;){var A=C;switch(Bv(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&wi();break;case 3:pd(),ae(Xr),ae(Ot),qv();break;case 5:Jv(A);break;case 4:pd();break;case 13:ae(nn);break;case 19:ae(nn);break;case 10:Gv(A.type._context);break;case 22:case 23:Rw()}C=C.return}if(as=f,In=f=El(f.current,null),ps=Ta=g,Kn=0,Ah=null,Ew=Qm=Mc=0,ca=Fh=null,Rc!==null){for(g=0;g<Rc.length;g++)if(C=Rc[g],A=C.interleaved,A!==null){C.interleaved=null;var j=A.next,O=C.pending;if(O!==null){var oe=O.next;O.next=j,A.next=oe}C.pending=A}Rc=null}return f}function U3(f,g){do{var C=In;try{if(Vv(),Dm.current=Lm,Rm){for(var A=sn.memoizedState;A!==null;){var j=A.queue;j!==null&&(j.pending=null),A=A.next}Rm=!1}if(Oc=0,ss=Hn=sn=null,wh=!1,_h=0,Tw.current=null,C===null||C.return===null){Kn=1,Ah=g,In=null;break}e:{var O=f,oe=C.return,Ee=C,ze=g;if(g=ps,Ee.flags|=32768,ze!==null&&typeof ze=="object"&&typeof ze.then=="function"){var ct=ze,Ft=Ee,qt=Ft.tag;if(!(Ft.mode&1)&&(qt===0||qt===11||qt===15)){var _t=Ft.alternate;_t?(Ft.updateQueue=_t.updateQueue,Ft.memoizedState=_t.memoizedState,Ft.lanes=_t.lanes):(Ft.updateQueue=null,Ft.memoizedState=null)}var $r=d3(oe);if($r!==null){$r.flags&=-257,f3($r,oe,Ee,O,g),$r.mode&1&&u3(O,ct,g),g=$r,ze=ct;var Lr=g.updateQueue;if(Lr===null){var da=new Set;da.add(ze),g.updateQueue=da}else Lr.add(ze);break e}else{if(!(g&1)){u3(O,ct,g),Ow();break e}ze=Error(i(426))}}else if(Yr&&Ee.mode&1){var Oo=d3(oe);if(Oo!==null){!(Oo.flags&65536)&&(Oo.flags|=256),f3(Oo,oe,Ee,O,g),zv(xd(ze,Ee));break e}}O=ze=xd(ze,Ee),Kn!==4&&(Kn=2),Fh===null?Fh=[O]:Fh.push(O),O=oe;do{switch(O.tag){case 3:O.flags|=65536,g&=-g,O.lanes|=g;var $e=l3(O,ze,g);O4(O,$e);break e;case 1:Ee=ze;var je=O.type,He=O.stateNode;if(!(O.flags&128)&&(typeof je.getDerivedStateFromError=="function"||He!==null&&typeof He.componentDidCatch=="function"&&(bl===null||!bl.has(He)))){O.flags|=65536,g&=-g,O.lanes|=g;var St=c3(O,Ee,g);O4(O,St);break e}}O=O.return}while(O!==null)}W3(C)}catch(Lt){g=Lt,In===C&&C!==null&&(In=C=C.return);continue}break}while(!0)}function $3(){var f=Jm.current;return Jm.current=Lm,f===null?Lm:f}function Ow(){(Kn===0||Kn===3||Kn===2)&&(Kn=4),as===null||!(Mc&268435455)&&!(Qm&268435455)||Tl(as,ps)}function np(f,g){var C=cr;cr|=2;var A=$3();(as!==f||ps!==g)&&(Ro=null,Lc(f,g));do try{tI();break}catch(j){U3(f,j)}while(!0);if(Vv(),cr=C,Jm.current=A,In!==null)throw Error(i(261));return as=null,ps=0,Kn}function tI(){for(;In!==null;)z3(In)}function rI(){for(;In!==null&&!NL();)z3(In)}function z3(f){var g=H3(f.alternate,f,Ta);f.memoizedProps=f.pendingProps,g===null?W3(f):In=g,Tw.current=null}function W3(f){var g=f;do{var C=g.alternate;if(f=g.return,g.flags&32768){if(C=YL(C,g),C!==null){C.flags&=32767,In=C;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{Kn=6,In=null;return}}else if(C=XL(C,g,Ta),C!==null){In=C;return}if(g=g.sibling,g!==null){In=g;return}In=g=f}while(g!==null);Kn===0&&(Kn=5)}function Ic(f,g,C){var A=Sr,j=Tn.transition;try{Tn.transition=null,Sr=1,nI(f,g,C,A)}finally{Tn.transition=j,Sr=A}return null}function nI(f,g,C,A){do Bc();while(kl!==null);if(cr&6)throw Error(i(327));C=f.finishedWork;var j=f.finishedLanes;if(C===null)return null;if(f.finishedWork=null,f.finishedLanes=0,C===f.current)throw Error(i(177));f.callbackNode=null,f.callbackPriority=0;var O=C.lanes|C.childLanes;if(EL(f,O),f===as&&(In=as=null,ps=0),!(C.subtreeFlags&2064)&&!(C.flags&2064)||Zm||(Zm=!0,K3(Mv,function(){return Bc(),null})),O=(C.flags&15990)!==0,C.subtreeFlags&15990||O){O=Tn.transition,Tn.transition=null;var oe=Sr;Sr=1;var Ee=cr;cr|=4,Tw.current=null,QL(f,C),j3(C,f),Z(f.containerInfo),f.current=C,qL(C),AL(),cr=Ee,Sr=oe,Tn.transition=O}else f.current=C;if(Zm&&(Zm=!1,kl=f,ep=j),O=f.pendingLanes,O===0&&(bl=null),PL(C.stateNode),ua(f,ns()),g!==null)for(A=f.onRecoverableError,C=0;C<g.length;C++)j=g[C],A(j.value,{componentStack:j.stack,digest:j.digest});if(qm)throw qm=!1,f=Fw,Fw=null,f;return ep&1&&f.tag!==0&&Bc(),O=f.pendingLanes,O&1?f===jw?jh++:(jh=0,jw=f):jh=0,Xi(),null}function Bc(){if(kl!==null){var f=_4(ep),g=Tn.transition,C=Sr;try{if(Tn.transition=null,Sr=16>f?16:f,kl===null)var A=!1;else{if(f=kl,kl=null,ep=0,cr&6)throw Error(i(331));var j=cr;for(cr|=4,Et=f.current;Et!==null;){var O=Et,oe=O.child;if(Et.flags&16){var Ee=O.deletions;if(Ee!==null){for(var ze=0;ze<Ee.length;ze++){var ct=Ee[ze];for(Et=ct;Et!==null;){var Ft=Et;switch(Ft.tag){case 0:case 11:case 15:Eh(8,Ft,O)}var qt=Ft.child;if(qt!==null)qt.return=Ft,Et=qt;else for(;Et!==null;){Ft=Et;var _t=Ft.sibling,$r=Ft.return;if(E3(Ft),Ft===ct){Et=null;break}if(_t!==null){_t.return=$r,Et=_t;break}Et=$r}}}var Lr=O.alternate;if(Lr!==null){var da=Lr.child;if(da!==null){Lr.child=null;do{var Oo=da.sibling;da.sibling=null,da=Oo}while(da!==null)}}Et=O}}if(O.subtreeFlags&2064&&oe!==null)oe.return=O,Et=oe;else e:for(;Et!==null;){if(O=Et,O.flags&2048)switch(O.tag){case 0:case 11:case 15:Eh(9,O,O.return)}var $e=O.sibling;if($e!==null){$e.return=O.return,Et=$e;break e}Et=O.return}}var je=f.current;for(Et=je;Et!==null;){oe=Et;var He=oe.child;if(oe.subtreeFlags&2064&&He!==null)He.return=oe,Et=He;else e:for(oe=je;Et!==null;){if(Ee=Et,Ee.flags&2048)try{switch(Ee.tag){case 0:case 11:case 15:Vm(9,Ee)}}catch(Lt){Jr(Ee,Ee.return,Lt)}if(Ee===oe){Et=null;break e}var St=Ee.sibling;if(St!==null){St.return=Ee.return,Et=St;break e}Et=Ee.return}}if(cr=j,Xi(),Ki&&typeof Ki.onPostCommitFiberRoot=="function")try{Ki.onPostCommitFiberRoot(_m,f)}catch{}A=!0}return A}finally{Sr=C,Tn.transition=g}}return!1}function V3(f,g,C){g=xd(C,g),g=l3(f,g,1),f=Sl(f,g,1),g=js(),f!==null&&(mh(f,1,g),ua(f,g))}function Jr(f,g,C){if(f.tag===3)V3(f,f,C);else for(;g!==null;){if(g.tag===3){V3(g,f,C);break}else if(g.tag===1){var A=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(bl===null||!bl.has(A))){f=xd(C,f),f=c3(g,f,1),g=Sl(g,f,1),f=js(),g!==null&&(mh(g,1,f),ua(g,f));break}}g=g.return}}function sI(f,g,C){var A=f.pingCache;A!==null&&A.delete(g),g=js(),f.pingedLanes|=f.suspendedLanes&C,as===f&&(ps&C)===C&&(Kn===4||Kn===3&&(ps&130023424)===ps&&500>ns()-Nw?Lc(f,0):Ew|=C),ua(f,g)}function G3(f,g){g===0&&(f.mode&1?(g=vm,vm<<=1,!(vm&130023424)&&(vm=4194304)):g=1);var C=js();f=Yi(f,g),f!==null&&(mh(f,g,C),ua(f,C))}function aI(f){var g=f.memoizedState,C=0;g!==null&&(C=g.retryLane),G3(f,C)}function iI(f,g){var C=0;switch(f.tag){case 13:var A=f.stateNode,j=f.memoizedState;j!==null&&(C=j.retryLane);break;case 19:A=f.stateNode;break;default:throw Error(i(314))}A!==null&&A.delete(g),G3(f,C)}var H3;H3=function(f,g,C){if(f!==null)if(f.memoizedProps!==g.pendingProps||Xr.current)la=!0;else{if(!(f.lanes&C)&&!(g.flags&128))return la=!1,KL(f,g,C);la=!!(f.flags&131072)}else la=!1,Yr&&g.flags&1048576&&k4(g,km,g.index);switch(g.lanes=0,g.tag){case 2:var A=g.type;Um(f,g),f=g.pendingProps;var j=Cn(g,Ot.current);gd(g,C),j=tw(null,g,A,f,j,C);var O=rw();return g.flags|=1,typeof j=="object"&&j!==null&&typeof j.render=="function"&&j.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Ln(A)?(O=!0,xm(g)):O=!1,g.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,Xv(g),j.updater=Im,g.stateNode=j,j._reactInternals=g,lw(g,A,f,C),g=fw(null,g,A,!0,O,C)):(g.tag=0,Yr&&O&&Iv(g),Ys(null,g,j,C),g=g.child),g;case 16:A=g.elementType;e:{switch(Um(f,g),f=g.pendingProps,j=A._init,A=j(A._payload),g.type=A,j=g.tag=lI(A),f=ki(A,f),j){case 0:g=dw(null,g,A,f,C);break e;case 1:g=y3(null,g,A,f,C);break e;case 11:g=h3(null,g,A,f,C);break e;case 14:g=g3(null,g,A,ki(A.type,f),C);break e}throw Error(i(306,A,""))}return g;case 0:return A=g.type,j=g.pendingProps,j=g.elementType===A?j:ki(A,j),dw(f,g,A,j,C);case 1:return A=g.type,j=g.pendingProps,j=g.elementType===A?j:ki(A,j),y3(f,g,A,j,C);case 3:e:{if(v3(g),f===null)throw Error(i(387));A=g.pendingProps,O=g.memoizedState,j=O.element,R4(f,g),jm(g,A,null,C);var oe=g.memoizedState;if(A=oe.element,ve&&O.isDehydrated)if(O={element:A,isDehydrated:!1,cache:oe.cache,pendingSuspenseBoundaries:oe.pendingSuspenseBoundaries,transitions:oe.transitions},g.updateQueue.baseState=O,g.memoizedState=O,g.flags&256){j=xd(Error(i(423)),g),g=w3(f,g,A,C,j);break e}else if(A!==j){j=xd(Error(i(424)),g),g=w3(f,g,A,C,j);break e}else for(ve&&(Wa=B(g.stateNode.containerInfo),Ca=g,Yr=!0,bi=null,ph=!1),C=j4(g,null,A,C),g.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(dd(),A===j){g=Do(f,g,C);break e}Ys(f,g,A,C)}g=g.child}return g;case 5:return L4(g),f===null&&$v(g),A=g.type,j=g.pendingProps,O=f!==null?f.memoizedProps:null,oe=j.children,te(A,j)?oe=null:O!==null&&te(A,O)&&(g.flags|=32),x3(f,g),Ys(f,g,oe,C),g.child;case 6:return f===null&&$v(g),null;case 13:return _3(f,g,C);case 4:return Yv(g,g.stateNode.containerInfo),A=g.pendingProps,f===null?g.child=fd(g,null,A,C):Ys(f,g,A,C),g.child;case 11:return A=g.type,j=g.pendingProps,j=g.elementType===A?j:ki(A,j),h3(f,g,A,j,C);case 7:return Ys(f,g,g.pendingProps,C),g.child;case 8:return Ys(f,g,g.pendingProps.children,C),g.child;case 12:return Ys(f,g,g.pendingProps.children,C),g.child;case 10:e:{if(A=g.type._context,j=g.pendingProps,O=g.memoizedProps,oe=j.value,P4(g,A,oe),O!==null)if(Si(O.value,oe)){if(O.children===j.children&&!Xr.current){g=Do(f,g,C);break e}}else for(O=g.child,O!==null&&(O.return=g);O!==null;){var Ee=O.dependencies;if(Ee!==null){oe=O.child;for(var ze=Ee.firstContext;ze!==null;){if(ze.context===A){if(O.tag===1){ze=Po(-1,C&-C),ze.tag=2;var ct=O.updateQueue;if(ct!==null){ct=ct.shared;var Ft=ct.pending;Ft===null?ze.next=ze:(ze.next=Ft.next,Ft.next=ze),ct.pending=ze}}O.lanes|=C,ze=O.alternate,ze!==null&&(ze.lanes|=C),Hv(O.return,C,g),Ee.lanes|=C;break}ze=ze.next}}else if(O.tag===10)oe=O.type===g.type?null:O.child;else if(O.tag===18){if(oe=O.return,oe===null)throw Error(i(341));oe.lanes|=C,Ee=oe.alternate,Ee!==null&&(Ee.lanes|=C),Hv(oe,C,g),oe=O.sibling}else oe=O.child;if(oe!==null)oe.return=O;else for(oe=O;oe!==null;){if(oe===g){oe=null;break}if(O=oe.sibling,O!==null){O.return=oe.return,oe=O;break}oe=oe.return}O=oe}Ys(f,g,j.children,C),g=g.child}return g;case 9:return j=g.type,A=g.pendingProps.children,gd(g,C),j=Va(j),A=A(j),g.flags|=1,Ys(f,g,A,C),g.child;case 14:return A=g.type,j=ki(A,g.pendingProps),j=ki(A.type,j),g3(f,g,A,j,C);case 15:return m3(f,g,g.type,g.pendingProps,C);case 17:return A=g.type,j=g.pendingProps,j=g.elementType===A?j:ki(A,j),Um(f,g),g.tag=1,Ln(A)?(f=!0,xm(g)):f=!1,gd(g,C),i3(g,A,j),lw(g,A,j,C),fw(null,g,A,!0,f,C);case 19:return b3(f,g,C);case 22:return p3(f,g,C)}throw Error(i(156,g.tag))};function K3(f,g){return Rv(f,g)}function oI(f,g,C,A){this.tag=f,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xa(f,g,C,A){return new oI(f,g,C,A)}function Mw(f){return f=f.prototype,!(!f||!f.isReactComponent)}function lI(f){if(typeof f=="function")return Mw(f)?1:0;if(f!=null){if(f=f.$$typeof,f===v)return 11;if(f===w)return 14}return 2}function El(f,g){var C=f.alternate;return C===null?(C=Xa(f.tag,g,f.key,f.mode),C.elementType=f.elementType,C.type=f.type,C.stateNode=f.stateNode,C.alternate=f,f.alternate=C):(C.pendingProps=g,C.type=f.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=f.flags&14680064,C.childLanes=f.childLanes,C.lanes=f.lanes,C.child=f.child,C.memoizedProps=f.memoizedProps,C.memoizedState=f.memoizedState,C.updateQueue=f.updateQueue,g=f.dependencies,C.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},C.sibling=f.sibling,C.index=f.index,C.ref=f.ref,C}function sp(f,g,C,A,j,O){var oe=2;if(A=f,typeof f=="function")Mw(f)&&(oe=1);else if(typeof f=="string")oe=5;else e:switch(f){case d:return Uc(C.children,j,O,g);case h:oe=8,j|=8;break;case m:return f=Xa(12,C,g,j|2),f.elementType=m,f.lanes=O,f;case _:return f=Xa(13,C,g,j),f.elementType=_,f.lanes=O,f;case S:return f=Xa(19,C,g,j),f.elementType=S,f.lanes=O,f;case b:return ap(C,j,O,g);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case x:oe=10;break e;case p:oe=9;break e;case v:oe=11;break e;case w:oe=14;break e;case y:oe=16,A=null;break e}throw Error(i(130,f==null?f:typeof f,""))}return g=Xa(oe,C,g,j),g.elementType=f,g.type=A,g.lanes=O,g}function Uc(f,g,C,A){return f=Xa(7,f,A,g),f.lanes=C,f}function ap(f,g,C,A){return f=Xa(22,f,A,g),f.elementType=b,f.lanes=C,f.stateNode={isHidden:!1},f}function Lw(f,g,C){return f=Xa(6,f,null,g),f.lanes=C,f}function Iw(f,g,C){return g=Xa(4,f.children!==null?f.children:[],f.key,g),g.lanes=C,g.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},g}function cI(f,g,C,A,j){this.tag=g,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=fe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pv(0),this.expirationTimes=Pv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pv(0),this.identifierPrefix=A,this.onRecoverableError=j,ve&&(this.mutableSourceEagerHydrationData=null)}function X3(f,g,C,A,j,O,oe,Ee,ze){return f=new cI(f,g,C,Ee,ze),g===1?(g=1,O===!0&&(g|=8)):g=0,O=Xa(3,null,null,g),f.current=O,O.stateNode=f,O.memoizedState={element:A,isDehydrated:C,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xv(O),f}function Y3(f){if(!f)return lr;f=f._reactInternals;e:{if(P(f)!==f||f.tag!==1)throw Error(i(170));var g=f;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Ln(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(i(171))}if(f.tag===1){var C=f.type;if(Ln(C))return pm(f,C,g)}return g}function J3(f){var g=f._reactInternals;if(g===void 0)throw typeof f.render=="function"?Error(i(188)):(f=Object.keys(f).join(","),Error(i(268,f)));return f=I(g),f===null?null:f.stateNode}function Q3(f,g){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var C=f.retryLane;f.retryLane=C!==0&&C<g?C:g}}function ip(f,g){Q3(f,g),(f=f.alternate)&&Q3(f,g)}function uI(f){return f=I(f),f===null?null:f.stateNode}function dI(){return null}return r.attemptContinuousHydration=function(f){if(f.tag===13){var g=Yi(f,134217728);if(g!==null){var C=js();Ka(g,f,134217728,C)}ip(f,134217728)}},r.attemptDiscreteHydration=function(f){if(f.tag===13){var g=Yi(f,1);if(g!==null){var C=js();Ka(g,f,1,C)}ip(f,1)}},r.attemptHydrationAtCurrentPriority=function(f){if(f.tag===13){var g=Cl(f),C=Yi(f,g);if(C!==null){var A=js();Ka(C,f,g,A)}ip(f,g)}},r.attemptSynchronousHydration=function(f){switch(f.tag){case 3:var g=f.stateNode;if(g.current.memoizedState.isDehydrated){var C=gh(g.pendingLanes);C!==0&&(Dv(g,C|1),ua(g,ns()),!(cr&6)&&(wd(),Xi()))}break;case 13:B3(function(){var A=Yi(f,1);if(A!==null){var j=js();Ka(A,f,1,j)}}),ip(f,1)}},r.batchedUpdates=function(f,g){var C=cr;cr|=1;try{return f(g)}finally{cr=C,cr===0&&(wd(),Sm&&Xi())}},r.createComponentSelector=function(f){return{$$typeof:Gm,value:f}},r.createContainer=function(f,g,C,A,j,O,oe){return X3(f,g,!1,null,C,A,j,O,oe)},r.createHasPseudoClassSelector=function(f){return{$$typeof:Hm,value:f}},r.createHydrationContainer=function(f,g,C,A,j,O,oe,Ee,ze){return f=X3(C,A,!0,f,j,O,oe,Ee,ze),f.context=Y3(null),C=f.current,A=js(),j=Cl(C),O=Po(A,j),O.callback=g??null,Sl(C,O,j),f.current.lanes=j,mh(f,j,A),ua(f,A),f},r.createPortal=function(f,g,C){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:A==null?null:""+A,children:f,containerInfo:g,implementation:C}},r.createRoleSelector=function(f){return{$$typeof:Km,value:f}},r.createTestNameSelector=function(f){return{$$typeof:Xm,value:f}},r.createTextSelector=function(f){return{$$typeof:Ym,value:f}},r.deferredUpdates=function(f){var g=Sr,C=Tn.transition;try{return Tn.transition=null,Sr=16,f()}finally{Sr=g,Tn.transition=C}},r.discreteUpdates=function(f,g,C,A,j){var O=Sr,oe=Tn.transition;try{return Tn.transition=null,Sr=1,f(g,C,A,j)}finally{Sr=O,Tn.transition=oe,cr===0&&wd()}},r.findAllNodes=Cw,r.findBoundingRects=function(f,g){if(!Ae)throw Error(i(363));g=Cw(f,g),f=[];for(var C=0;C<g.length;C++)f.push(Ue(g[C]));for(g=f.length-1;0<g;g--){C=f[g];for(var A=C.x,j=A+C.width,O=C.y,oe=O+C.height,Ee=g-1;0<=Ee;Ee--)if(g!==Ee){var ze=f[Ee],ct=ze.x,Ft=ct+ze.width,qt=ze.y,_t=qt+ze.height;if(A>=ct&&O>=qt&&j<=Ft&&oe<=_t){f.splice(g,1);break}else if(A!==ct||C.width!==ze.width||_t<O||qt>oe){if(!(O!==qt||C.height!==ze.height||Ft<A||ct>j)){ct>A&&(ze.width+=ct-A,ze.x=A),Ft<j&&(ze.width=j-ct),f.splice(g,1);break}}else{qt>O&&(ze.height+=qt-O,ze.y=O),_t<oe&&(ze.height=oe-qt),f.splice(g,1);break}}}return f},r.findHostInstance=J3,r.findHostInstanceWithNoPortals=function(f){return f=R(f),f=f!==null?le(f):null,f===null?null:f.stateNode},r.findHostInstanceWithWarning=function(f){return J3(f)},r.flushControlled=function(f){var g=cr;cr|=1;var C=Tn.transition,A=Sr;try{Tn.transition=null,Sr=1,f()}finally{Sr=A,Tn.transition=C,cr=g,cr===0&&(wd(),Xi())}},r.flushPassiveEffects=Bc,r.flushSync=B3,r.focusWithin=function(f,g){if(!Ae)throw Error(i(363));for(f=Sw(f),g=M3(f,g),g=Array.from(g),f=0;f<g.length;){var C=g[f++];if(!Xe(C)){if(C.tag===5&&Ct(C.stateNode))return!0;for(C=C.child;C!==null;)g.push(C),C=C.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Sr},r.getFindAllNodesFailureDescription=function(f,g){if(!Ae)throw Error(i(363));var C=0,A=[];f=[Sw(f),0];for(var j=0;j<f.length;){var O=f[j++],oe=f[j++],Ee=g[oe];if((O.tag!==5||!Xe(O))&&(bw(O,Ee)&&(A.push(kw(Ee)),oe++,oe>C&&(C=oe)),oe<g.length))for(O=O.child;O!==null;)f.push(O,oe),O=O.sibling}if(C<g.length){for(f=[];C<g.length;C++)f.push(kw(g[C]));return`findAllNodes was able to match part of the selector:
  `+(A.join(" > ")+`

No matching component was found for:
  `)+f.join(" > ")}return null},r.getPublicRootInstance=function(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return V(f.child.stateNode);default:return f.child.stateNode}},r.injectIntoDevTools=function(f){if(f={bundleType:f.bundleType,version:f.version,rendererPackageName:f.rendererPackageName,rendererConfig:f.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:uI,findFiberByHostInstance:f.findFiberByHostInstance||dI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")f=!1;else{var g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(g.isDisabled||!g.supportsFiber)f=!0;else{try{_m=g.inject(f),Ki=g}catch{}f=!!g.checkDCE}}return f},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(f,g,C,A){if(!Ae)throw Error(i(363));f=Cw(f,g);var j=Mt(f,C,A).disconnect;return{disconnect:function(){j()}}},r.registerMutableSourceForHydration=function(f,g){var C=g._getVersion;C=C(g._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[g,C]:f.mutableSourceEagerHydrationData.push(g,C)},r.runWithPriority=function(f,g){var C=Sr;try{return Sr=f,g()}finally{Sr=C}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(f,g,C,A){var j=g.current,O=js(),oe=Cl(j);return C=Y3(C),g.context===null?g.context=C:g.pendingContext=C,g=Po(O,oe),g.payload={element:f},A=A===void 0?null:A,A!==null&&(g.callback=A),f=Sl(j,g,oe),f!==null&&(Ka(f,j,oe,O),Fm(f,j,oe)),oe},r};eD.exports=yJ;var vJ=eD.exports;const wJ=U1(vJ);var tD={exports:{}},qu={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */qu.ConcurrentRoot=1;qu.ContinuousEventPriority=4;qu.DefaultEventPriority=16;qu.DiscreteEventPriority=1;qu.IdleEventPriority=536870912;qu.LegacyRoot=0;tD.exports=qu;var rD=tD.exports;const i6={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let o6=!1,l6=!1;const MC=".react-konva-event";let nD=!1;function _J(t){nD=t}const SJ=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,bJ=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,kJ={};function rv(t,e,r=kJ){if(!o6&&"zIndex"in e&&(console.warn(bJ),o6=!0),!l6&&e.draggable){var n=e.x!==void 0||e.y!==void 0,s=e.onDragEnd||e.onDragMove;n&&!s&&(console.warn(SJ),l6=!0)}for(var a in r)if(!i6[a]){var i=a.slice(0,2)==="on",o=r[a]!==e[a];if(i&&o){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),t.off(l,r[a])}var u=!e.hasOwnProperty(a);u&&t.setAttr(a,void 0)}var d=nD||e._useStrictMode,h={},m=!1;const x={};for(var a in e)if(!i6[a]){var i=a.slice(0,2)==="on",p=r[a]!==e[a];if(i&&p){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e[a]&&(x[l]=e[a])}!i&&(e[a]!==r[a]||d&&e[a]!==t.getAttr(a))&&(m=!0,h[a]=e[a])}m&&(t.setAttrs(h),Cc(t));for(var l in x)t.on(l+MC,x[l])}function Cc(t){if(!ar.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const sD={},CJ={};og.Node.prototype._applyProps=rv;function TJ(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),Cc(t)}function EJ(t,e,r){let n=og[t];n||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=og.Group);const s={},a={};for(var i in e){var o=i.slice(0,2)==="on";o?a[i]=e[i]:s[i]=e[i]}const l=new n(s);return rv(l,a),l}function NJ(t,e,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function AJ(t,e,r){return!1}function FJ(t){return t}function jJ(){return null}function PJ(){return null}function DJ(t,e,r,n){return CJ}function RJ(){}function OJ(t){}function MJ(t,e){return!1}function LJ(){return sD}function IJ(){return sD}const BJ=setTimeout,UJ=clearTimeout,$J=-1;function zJ(t,e){return!1}const WJ=!1,VJ=!0,GJ=!0;function HJ(t,e){e.parent===t?e.moveToTop():t.add(e),Cc(t)}function KJ(t,e){e.parent===t?e.moveToTop():t.add(e),Cc(t)}function aD(t,e,r){e._remove(),t.add(e),e.setZIndex(r.getZIndex()),Cc(t)}function XJ(t,e,r){aD(t,e,r)}function YJ(t,e){e.destroy(),e.off(MC),Cc(t)}function JJ(t,e){e.destroy(),e.off(MC),Cc(t)}function QJ(t,e,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function qJ(t,e,r){}function ZJ(t,e,r,n,s){rv(t,s,n)}function eQ(t){t.hide(),Cc(t)}function tQ(t){}function rQ(t,e){(e.visible==null||e.visible)&&t.show()}function nQ(t,e){}function sQ(t){}function aQ(){}const iQ=()=>rD.DefaultEventPriority,oQ=Object.freeze(Object.defineProperty({__proto__:null,appendChild:HJ,appendChildToContainer:KJ,appendInitialChild:TJ,cancelTimeout:UJ,clearContainer:sQ,commitMount:qJ,commitTextUpdate:QJ,commitUpdate:ZJ,createInstance:EJ,createTextInstance:NJ,detachDeletedInstance:aQ,finalizeInitialChildren:AJ,getChildHostContext:IJ,getCurrentEventPriority:iQ,getPublicInstance:FJ,getRootHostContext:LJ,hideInstance:eQ,hideTextInstance:tQ,idlePriority:i0.unstable_IdlePriority,insertBefore:aD,insertInContainerBefore:XJ,isPrimaryRenderer:WJ,noTimeout:$J,now:i0.unstable_now,prepareForCommit:jJ,preparePortalMount:PJ,prepareUpdate:DJ,removeChild:YJ,removeChildFromContainer:JJ,resetAfterCommit:RJ,resetTextContent:OJ,run:i0.unstable_runWithPriority,scheduleTimeout:BJ,shouldDeprioritizeSubtree:MJ,shouldSetTextContent:zJ,supportsMutation:GJ,unhideInstance:rQ,unhideTextInstance:nQ,warnsIfNotActing:VJ},Symbol.toStringTag,{value:"Module"}));var lQ=Object.defineProperty,cQ=Object.defineProperties,uQ=Object.getOwnPropertyDescriptors,c6=Object.getOwnPropertySymbols,dQ=Object.prototype.hasOwnProperty,fQ=Object.prototype.propertyIsEnumerable,u6=(t,e,r)=>e in t?lQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,d6=(t,e)=>{for(var r in e||(e={}))dQ.call(e,r)&&u6(t,r,e[r]);if(c6)for(var r of c6(e))fQ.call(e,r)&&u6(t,r,e[r]);return t},hQ=(t,e)=>cQ(t,uQ(e)),f6,h6;typeof window<"u"&&((f6=window.document)!=null&&f6.createElement||((h6=window.navigator)==null?void 0:h6.product)==="ReactNative")?k.useLayoutEffect:k.useEffect;function iD(t,e,r){if(!t)return;if(r(t)===!0)return t;let n=t.child;for(;n;){const s=iD(n,e,r);if(s)return s;n=n.sibling}}function oD(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const g6=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=g6;return}return g6.apply(this,arguments)};const LC=oD(k.createContext(null));class lD extends k.Component{render(){return k.createElement(LC.Provider,{value:this._reactInternals},this.props.children)}}function gQ(){const t=k.useContext(LC);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=k.useId();return k.useMemo(()=>{for(const n of[t,t==null?void 0:t.alternate]){if(!n)continue;const s=iD(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===e)return!0;i=i.next}});if(s)return s}},[t,e])}function mQ(){const t=gQ(),[e]=k.useState(()=>new Map);e.clear();let r=t;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==LC&&!e.has(s)&&e.set(s,k.useContext(oD(s)))}r=r.return}return e}function cD(){const t=mQ();return k.useMemo(()=>Array.from(t.keys()).reduce((e,r)=>n=>k.createElement(e,null,k.createElement(r.Provider,hQ(d6({},n),{value:t.get(r)}))),e=>k.createElement(lD,d6({},e))),[t])}function pQ(t){const e=ls.useRef({});return ls.useLayoutEffect(()=>{e.current=t}),ls.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const xQ=t=>{const e=ls.useRef(null),r=ls.useRef(null),n=ls.useRef(null),s=pQ(t),a=cD(),i=o=>{const{forwardedRef:l}=t;l&&(typeof l=="function"?l(o):l.current=o)};return ls.useLayoutEffect(()=>(r.current=new og.Stage({width:t.width,height:t.height,container:e.current}),i(r.current),n.current=ef.createContainer(r.current,rD.LegacyRoot,!1,null),ef.updateContainer(ls.createElement(a,{},t.children),n.current),()=>{og.isBrowser&&(i(null),ef.updateContainer(null,n.current,null),r.current.destroy())}),[]),ls.useLayoutEffect(()=>{i(r.current),rv(r.current,t,s),ef.updateContainer(ls.createElement(a,{},t.children),n.current,null)}),ls.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},Df="Layer",yQ="FastLayer",Zd="Group",vQ="Label",ho="Rect",HS="Circle",wQ="Ellipse",_Q="Wedge",ru="Line",SQ="Sprite",uD="Image",Xc="Text",bQ="TextPath",kQ="Star",CQ="Ring",TQ="Arc",EQ="Tag",NQ="Path",AQ="RegularPolygon",KS="Arrow",FQ="Shape",dD="Transformer",jQ="18.2.13",ef=wJ(oQ);ef.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:ls.version,rendererPackageName:"react-konva"});const Rf=ls.forwardRef((t,e)=>ls.createElement(lD,{},ls.createElement(xQ,{...t,forwardedRef:e}))),PQ=_J,DQ=Object.freeze(Object.defineProperty({__proto__:null,Arc:TQ,Arrow:KS,Circle:HS,Ellipse:wQ,FastLayer:yQ,Group:Zd,Image:uD,KonvaRenderer:ef,Label:vQ,Layer:Df,Line:ru,Path:NQ,Rect:ho,RegularPolygon:AQ,Ring:CQ,Shape:FQ,Sprite:SQ,Stage:Rf,Star:kQ,Tag:EQ,Text:Xc,TextPath:bQ,Transformer:dD,Wedge:_Q,useContextBridge:cD,useStrictMode:PQ,version:jQ},Symbol.toStringTag,{value:"Module"})),at=({children:t,hover:e=!0,className:r="",...n})=>{const s=`
    bg-white rounded-xl shadow-md border border-gray-200 p-6
    ${e?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return c.jsx(Me.div,{className:s,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...n,children:t})},RQ=({children:t,className:e=""})=>c.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${e}`,children:t}),OQ=({children:t,className:e=""})=>c.jsx("h3",{className:`text-xl font-semibold text-gray-800 ${e}`,children:t}),MQ=({children:t,className:e=""})=>c.jsx("div",{className:`py-4 ${e}`,children:t}),LQ=({children:t,className:e=""})=>c.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${e}`,children:t});at.Header=RQ;at.Title=OQ;at.Body=MQ;at.Footer=LQ;const IQ=t=>{const[e,r]=k.useState({width:800,height:600}),n=k.useRef(null),s=k.useCallback(()=>{if(t.current){t.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),o=4/3;let l=a,u=l/o;u>i&&(u=i,l=u*o),r({width:l,height:u})}},[t]);return k.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:e,stageRef:n,updateCanvasSize:s}},XS={convertToOriginal:(t,e,r)=>r?{x:Number(((t-r.x)/r.scale).toFixed(4)),y:Number(((e-r.y)/r.scale).toFixed(4))}:{x:t,y:e},convertToCanvas:(t,e,r)=>r?{x:Number((r.x+t*r.scale).toFixed(4)),y:Number((r.y+e*r.scale).toFixed(4))}:{x:t,y:e},isPointInImage:(t,e)=>e?t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height:!1,calculateImageScale:(t,e)=>{if(!t||!e)return 1;const r=40,n=e.width-r,s=e.height-r;return Math.min(n/t.width,s/t.height)},calculateImageInfo:(t,e)=>{if(!t||!e)return null;const r=40,n=e.width-r,s=e.height-r,a=Math.min(n/t.width,s/t.height),i=t.width*a,o=t.height*a,l=(e.width-i)/2,u=(e.height-o)/2;return{x:l,y:u,width:i,height:o,scale:a,originalWidth:t.width,originalHeight:t.height}}},BQ=(t,e)=>{const[r,n]=k.useState(null),s=k.useCallback((a,i)=>XS.calculateImageInfo(a,i),[]);return k.useEffect(()=>{if(t&&e){const a=s(t,e);n(a)}},[t,e,s]),r},UQ=t=>{const e=k.useCallback((n,s)=>XS.convertToOriginal(n,s,t),[t]),r=k.useCallback((n,s)=>XS.convertToCanvas(n,s,t),[t]);return{convertToOriginal:e,convertToCanvas:r}},Vh={create:(t,e,r,n,s)=>({id:s,x:t-r/2,y:e-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:t=>t.width>0&&t.height>0,findAtPosition:(t,e,r)=>t.find(n=>e>=n.x&&e<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},jd={create:(t,e,r,n,s,a,i)=>({id:i,startX:t,startY:e,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(t,e,r,n=60)=>{let s=null,a=1/0;for(const i of r){const o=i.x+i.width/2,l=i.y+i.height/2,u=Math.sqrt(Math.pow(t-o,2)+Math.pow(e-l,2));u<=n&&u<a&&(a=u,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(t,e,r,n,s)=>jd.snapToNearestBlock(t,e,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},B2={create:(t,e,r)=>({id:r,blockId:t,word:e}),update:(t,e,r)=>t.map(n=>n.blockId===e?{...n,word:r}:n),delete:(t,e)=>t.filter(r=>r.blockId!==e),generateId:t=>`word_${t}`,validate:t=>t&&t.trim().length>0},$Q={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null}},zQ=(t,e)=>{switch(e.type){case"SET_CANVAS_SIZE":return{...t,canvas:{...t.canvas,size:e.payload}};case"SET_IMAGE":return{...t,canvas:{...t.canvas,image:e.payload}};case"SET_IMAGE_INFO":return{...t,canvas:{...t.canvas,imageInfo:e.payload}};case"SET_SELECTED_TOOL":return{...t,canvas:{...t.canvas,selectedTool:e.payload}};case"ADD_BLOCK":return{...t,testData:{...t.testData,blocks:[...t.testData.blocks,e.payload]}};case"ADD_WORD":return{...t,testData:{...t.testData,words:[...t.testData.words,e.payload]}};case"ADD_ARROW":return{...t,testData:{...t.testData,arrows:[...t.testData.arrows,e.payload]}};case"UPDATE_BLOCK":return{...t,testData:{...t.testData,blocks:t.testData.blocks.map(r=>r.id===e.payload.id?{...r,...e.payload.updates}:r)}};case"DELETE_BLOCK":return{...t,testData:{...t.testData,blocks:t.testData.blocks.filter(r=>r.id!==e.payload),words:t.testData.words.filter(r=>r.blockId!==e.payload),arrows:t.testData.arrows.filter(r=>r.startBlock!==e.payload&&r.endBlock!==e.payload)}};case"UPDATE_WORDS":return{...t,testData:{...t.testData,words:e.payload}};case"SET_CREATION_STATE":return{...t,creation:{...t.creation,...e.payload}};case"SET_UI_STATE":return{...t,ui:{...t.ui,...e.payload}};case"SET_LOADING":return{...t,ui:{...t.ui,isLoading:e.payload}};case"SET_ERROR":return{...t,ui:{...t.ui,error:e.payload}};case"RESET_TESTDATA":return{...t,testData:{blocks:[],words:[],arrows:[],imageUrl:t.testData.imageUrl}};default:return t}},WQ=({testName:t="",showQuestionCount:e=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[o,l]=k.useReducer(zQ,$Q),{showNotification:u}=ka(),{makeAuthenticatedRequest:d}=fl(),{user:h}=Dn(),m=k.useRef(null),x=k.useRef(null),p=k.useRef(null),v=k.useRef({}),_=k.useRef({}),{canvasSize:S,stageRef:w}=IQ(m),y=BQ(o.canvas.image,S),{convertToOriginal:b}=UQ(y);k.useEffect(()=>{l({type:"SET_CANVAS_SIZE",payload:S})},[S]),k.useEffect(()=>{y&&l({type:"SET_IMAGE_INFO",payload:y})},[y]),k.useEffect(()=>{var K,U,L;const q=p.current;if(!q)return;const V=(K=o.ui.selectedBlock)!=null&&K.id?v.current[o.ui.selectedBlock.id]:null;V?(q.nodes([V]),(U=q.getLayer())==null||U.batchDraw()):(q.nodes([]),(L=q.getLayer())==null||L.batchDraw())},[o.ui.selectedBlock]);const E=k.useCallback(()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:null}}),l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),l({type:"RESET_TESTDATA"}),l({type:"SET_ERROR",payload:null})},[]),N=k.useCallback(q=>{const V=q.target.files[0];if(!V||!V.type.startsWith("image/")){u("Please select a valid image file","error");return}const K=new FileReader;K.onload=U=>{const L=U.target.result,Z=new Image;Z.crossOrigin="anonymous",Z.onload=()=>{l({type:"SET_IMAGE",payload:Z}),l({type:"SET_UI_STATE",payload:{imageUrl:L}})},Z.src=L},K.readAsDataURL(V)},[u]),F=k.useCallback(q=>{const V=w.current;if(!V)return;const K=V.getPointerPosition();if(K){if(o.canvas.selectedTool==="create"){const U=Vh.findAtPosition(o.testData.blocks,K.x,K.y);if(U){l({type:"SET_UI_STATE",payload:{selectedBlock:U}});return}l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:K.x,y:K.y}}})}else if(o.canvas.selectedTool==="edit"){const U=Vh.findAtPosition(o.testData.blocks,K.x,K.y);l(U?{type:"SET_UI_STATE",payload:{selectedBlock:U}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(o.canvas.selectedTool==="arrow"){const U=q.target===V,L=Vh.findAtPosition(o.testData.blocks,K.x,K.y);(U||!L)&&l({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:K.x,y:K.y}}})}}},[o.canvas.selectedTool,y,o.testData.blocks]),T=k.useCallback(q=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const V=w.current;if(!V)return;const K=V.getPointerPosition();if(!K)return;const U=Math.abs(K.x-o.creation.blockCreationStart.x),L=Math.abs(K.y-o.creation.blockCreationStart.y),Z=10,ne=Math.max(U,Z),z=Math.max(L,Z);l({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(K.x,o.creation.blockCreationStart.x),y:Math.min(K.y,o.creation.blockCreationStart.y),width:ne,height:z,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const V=w.current;if(!V)return;const K=V.getPointerPosition();if(!K)return;l({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:o.creation.arrowStart.x,startY:o.creation.arrowStart.y,endX:K.x,endY:K.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[o.creation]),P=k.useCallback(q=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const V=w.current;if(!V)return;const K=V.getPointerPosition();if(!K)return;const U=Math.abs(K.x-o.creation.blockCreationStart.x),L=Math.abs(K.y-o.creation.blockCreationStart.y),Z=10,ne=Math.max(U,Z),z=Math.max(L,Z),Y=Math.min(K.x,o.creation.blockCreationStart.x)+ne/2,J=Math.min(K.y,o.creation.blockCreationStart.y)+z/2,te=Vh.generateId(),de=Vh.create(Y,J,ne,z,te),ee=B2.create(te,`Word ${o.testData.blocks.length+1}`,B2.generateId(te));l({type:"ADD_BLOCK",payload:de}),l({type:"ADD_WORD",payload:ee}),l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),o.testData.blocks.length===0&&l({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const V=w.current;if(!V)return;const K=V.getPointerPosition();if(!K)return;if(jd.validate(o.creation.arrowStart.x,o.creation.arrowStart.y,K.x,K.y,o.testData.blocks)){const U=jd.snapToNearestBlock(o.creation.arrowStart.x,o.creation.arrowStart.y,o.testData.blocks),L=jd.snapToNearestBlock(K.x,K.y,o.testData.blocks),Z=U?U.x:o.creation.arrowStart.x,ne=U?U.y:o.creation.arrowStart.y,z=L?L.x:K.x,Y=L?L.y:K.y,J=jd.generateId(),te=jd.create(Z,ne,z,Y,U?U.blockId:null,L?L.blockId:null,J);l({type:"ADD_ARROW",payload:te}),u("Arrow created successfully!","success")}else u("Arrow must start near a block!","error");l({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[o.creation,o.testData.blocks,u]),D=k.useCallback(async()=>{console.log(" [MatchingTestCreator] handleSaveTest clicked");const q=R();if(Object.keys(q).length>0){console.warn(" [MatchingTestCreator] Validation errors:",q),u("Please fix validation errors before saving","error");return}try{console.log(" [MatchingTestCreator] Preparing data to save...",{blocks:o.testData.blocks.length,words:o.testData.words.length,arrows:o.testData.arrows.length,imageUrl:o.ui.imageUrl?"present":"missing"}),l({type:"SET_LOADING",payload:!0});let V=o.ui.imageUrl;if(o.ui.imageUrl&&o.ui.imageUrl.startsWith("data:")){const U=await d("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:o.ui.imageUrl,folder:"matching_tests"})}),L=await U.json();if(U.ok&&L.success&&L.url)V=L.url;else throw new Error(L.message||"Upload failed")}const K=o.testData.blocks.map((U,L)=>{let Z;if(y){const Y=b(U.x,U.y),J=b(U.x+U.width,U.y+U.height);Z={x:Y.x,y:Y.y,width:Number((J.x-Y.x).toFixed(4)),height:Number((J.y-Y.y).toFixed(4))}}else Z={x:Number(U.x.toFixed(4)),y:Number(U.y.toFixed(4)),width:Number(U.width.toFixed(4)),height:Number(U.height.toFixed(4))};const ne=o.testData.words.find(Y=>Y.blockId===U.id),z=o.testData.arrows.find(Y=>Y.startBlock===U.id);return{question_id:L+1,word:(ne==null?void 0:ne.word)||`Word ${L+1}`,block_coordinates:Z,has_arrow:!!z,arrow:z&&y?(()=>{const Y=b(z.startX,z.startY),J=b(z.endX,z.endY),te=Y.x/y.originalWidth*100,de=Y.y/y.originalHeight*100,ee=J.x/y.originalWidth*100,ge=J.y/y.originalHeight*100;return{start_x:Number(Y.x.toFixed(4)),start_y:Number(Y.y.toFixed(4)),end_x:Number(J.x.toFixed(4)),end_y:Number(J.y.toFixed(4)),rel_start_x:Number(te.toFixed(4)),rel_start_y:Number(de.toFixed(4)),rel_end_x:Number(ee.toFixed(4)),rel_end_y:Number(ge.toFixed(4)),image_width:y.originalWidth,image_height:y.originalHeight,style:z.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log(" [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:o.testData.blocks,words:o.testData.words,arrows:o.testData.arrows,imageUrl:V,processedQuestions:K}))}catch(V){console.error("Save error:",V),u(`Error saving test: ${V.message}`,"error")}finally{l({type:"SET_LOADING",payload:!1})}},[o.testData,o.ui.imageUrl,y,b,d,r,u,t,h]),R=k.useCallback(()=>{const q={};return t.trim()||(q.testName="Test name is required"),o.testData.blocks.length===0&&(q.blocks="At least one block is required"),q},[t,o.testData.blocks.length]),I=()=>c.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[c.jsx(Ge,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"create"}),variant:o.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:" Create Blocks"}),c.jsx(Ge,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:o.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:" Edit Blocks"}),c.jsx(Ge,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:o.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:" Draw Arrows"}),c.jsx(Ge,{onClick:E,variant:"secondary",size:"sm",children:" Reset"}),c.jsx(Ge,{onClick:()=>{var q;return(q=x.current)==null?void 0:q.click()},variant:"secondary",size:"sm",children:" Upload Image"})]}),W=()=>c.jsx(Rf,{width:S.width,height:S.height,ref:w,onMouseDown:F,onMouseMove:T,onMouseUp:P,className:o.canvas.selectedTool==="arrow"||o.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:c.jsxs(Df,{children:[o.canvas.image&&y&&c.jsx(uD,{image:o.canvas.image,x:y.x,y:y.y,width:y.width,height:y.height}),o.testData.blocks.map(q=>c.jsxs(Zd,{ref:V=>{V&&(_.current[q.id]=V)},draggable:o.canvas.selectedTool==="edit",x:q.x,y:q.y,onMouseEnter:V=>{var U,L;const K=(U=V.target.getStage())==null?void 0:U.container();K&&(K.style.cursor=((L=o.ui.selectedBlock)==null?void 0:L.id)===q.id?"nwse-resize":"move")},onMouseLeave:V=>{var U;const K=(U=V.target.getStage())==null?void 0:U.container();K&&(K.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:q}})},onDragEnd:V=>{const{x:K,y:U}=V.target.position();l({type:"UPDATE_BLOCK",payload:{id:q.id,updates:{x:K,y:U}}})},onClick:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:q}})},onTap:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:q}})},children:[c.jsx(ho,{ref:V=>{V&&(v.current[q.id]=V)},width:q.width,height:q.height,fill:q.fill,stroke:q.stroke,strokeWidth:q.strokeWidth,cornerRadius:q.cornerRadius,shadowColor:q.shadowColor,shadowBlur:q.shadowBlur,shadowOffset:q.shadowOffset,shadowOpacity:q.shadowOpacity,draggable:o.canvas.selectedTool==="edit",onDragEnd:V=>{const{x:K,y:U}=V.target.getParent().position();l({type:"UPDATE_BLOCK",payload:{id:q.id,updates:{x:K,y:U}}})},onMouseEnter:V=>{var U,L;const K=(U=V.target.getStage())==null?void 0:U.container();K&&(K.style.cursor=((L=o.ui.selectedBlock)==null?void 0:L.id)===q.id?"nwse-resize":"move")},onMouseLeave:V=>{var U;const K=(U=V.target.getStage())==null?void 0:U.container();K&&(K.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:V=>{const K=v.current[q.id];if(!K)return;const U=Math.max(10,K.width()*K.scaleX()),L=Math.max(10,K.height()*K.scaleY());K.scaleX(1),K.scaleY(1),l({type:"UPDATE_BLOCK",payload:{id:q.id,updates:{width:U,height:L}}})}}),c.jsx(Xc,{x:2,y:2,text:`${o.testData.blocks.indexOf(q)+1}`,fontSize:Math.min(12,Math.max(8,q.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},q.id)),c.jsx(dD,{ref:p,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(q,V)=>({...V,width:Math.max(V.width,10),height:Math.max(V.height,10)})}),o.testData.arrows.map(q=>c.jsx(KS,{points:[q.startX,q.startY,q.endX,q.endY],stroke:q.stroke,fill:q.fill,strokeWidth:q.strokeWidth,pointerLength:q.pointerLength,pointerWidth:q.pointerWidth},q.id)),o.creation.previewBlock&&c.jsx(ho,{x:o.creation.previewBlock.x,y:o.creation.previewBlock.y,width:o.creation.previewBlock.width,height:o.creation.previewBlock.height,fill:o.creation.previewBlock.fill,stroke:o.creation.previewBlock.stroke,strokeWidth:o.creation.previewBlock.strokeWidth,dash:o.creation.previewBlock.dash,opacity:o.creation.previewBlock.opacity}),o.creation.previewArrow&&c.jsx(KS,{points:[o.creation.previewArrow.startX,o.creation.previewArrow.startY,o.creation.previewArrow.endX,o.creation.previewArrow.endY],stroke:o.creation.previewArrow.stroke,fill:o.creation.previewArrow.fill,strokeWidth:o.creation.previewArrow.strokeWidth,dash:o.creation.previewArrow.dash,opacity:o.creation.previewArrow.opacity})]})}),le=k.useMemo(()=>o.testData.blocks.length===0?null:c.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full",style:{height:"min(400px, 40vh)",overflowY:"auto"},children:[c.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),c.jsx("div",{className:"space-y-2",children:o.testData.words.map(q=>{const V=o.testData.blocks.find(K=>K.id===q.blockId);return c.jsxs("div",{className:"p-2 bg-white rounded border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",o.testData.blocks.indexOf(V)+1]}),c.jsx("button",{onClick:()=>l({type:"DELETE_BLOCK",payload:V.id}),className:"text-red-500 hover:text-red-700 text-xs",children:""})]}),c.jsx("input",{type:"text",value:q.word,onChange:K=>{const U=B2.update(o.testData.words,q.blockId,K.target.value);l({type:"UPDATE_WORDS",payload:U})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},q.blockId)})})]}),[o.testData.words,o.testData.blocks]);return c.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[c.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:c.jsx("div",{className:"mt-2 text-sm text-gray-600",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{children:[c.jsx("strong",{children:"Test Name:"})," ",t||"Untitled Test"]}),c.jsxs("span",{children:[c.jsx("strong",{children:"Questions:"})," ",o.testData.blocks.length," (auto-generated from blocks)"]})]})})}),c.jsx("div",{className:"flex gap-2",children:c.jsx(Ge,{onClick:D,disabled:a||o.ui.isLoading,variant:"primary",children:a||o.ui.isLoading?c.jsx(dr,{size:"sm"}):"Save Test"})})]})}),I(),c.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[c.jsx("div",{ref:m,className:"bg-white border overflow-auto",style:{minHeight:"400px",maxHeight:"calc(100vh - 200px)",height:"auto"},children:W()}),le]}),c.jsx("input",{ref:x,type:"file",accept:"image/*",onChange:N,className:"hidden"})]})},nv=k.createContext(null);function VQ(t,e){return{getTheme:function(){return e??null}}}function To(){const t=k.useContext(nv);return t==null&&function(e,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",e);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(8),t}function ot(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const Hi=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,GQ=Hi&&"documentMode"in document?document.documentMode:null,lo=Hi&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),bu=Hi&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),o1=!(!Hi||!("InputEvent"in window)||GQ)&&"getTargetRanges"in new window.InputEvent("input"),lg=Hi&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),Of=Hi&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,HQ=Hi&&/Android/.test(navigator.userAgent),fD=Hi&&/^(?=.*Chrome).*/i.test(navigator.userAgent),m6=Hi&&HQ&&fD,l1=Hi&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!fD;function hD(...t){const e=[];for(const r of t)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))e.push(n);return e}const KQ=1,XQ=3,YQ=9,JQ=11,ku=0,gD=1,Mf=2,QQ=0,qQ=1,ZQ=2,c1=4,u1=8,IC=128,eq=1792|(112|(3|c1|u1)|IC),BC=1,UC=2,$C=3,zC=4,WC=5,VC=6,sv=lg||Of||l1?"":"",ll=`

`,tq=bu?"":sv,Cu={bold:1,capitalize:1024,code:16,highlight:IC,italic:2,lowercase:256,strikethrough:c1,subscript:32,superscript:64,underline:u1,uppercase:512},rq={directionless:1,unmergeable:2},p6={center:UC,end:VC,justify:zC,left:BC,right:$C,start:WC},nq={[UC]:"center",[VC]:"end",[zC]:"justify",[BC]:"left",[$C]:"right",[WC]:"start"},sq={normal:0,segmented:2,token:1},aq={[QQ]:"normal",[ZQ]:"segmented",[qQ]:"token"},x6="$config";function mD(t,e,r,n,s,a){let i=t.getFirstChild();for(;i!==null;){const o=i.__key;i.__parent===e&&(Ke(i)&&mD(i,o,r,n,s,a),r.has(o)||a.delete(o),s.push(o)),i=i.getNextSibling()}}const iq=100;let YS=!1,GC=0;function oq(t){GC=t.timeStamp}function U2(t,e,r){const n=t.nodeName==="BR",s=e.__lexicalLineBreak;return s&&(t===s||n&&t.previousSibling===s)||n&&gv(t,r)!==void 0}function lq(t,e,r){const n=Vi(pi(r));let s=null,a=null;n!==null&&n.anchorNode===t&&(s=n.anchorOffset,a=n.focusOffset);const i=t.nodeValue;i!==null&&dT(e,i,s,a,!1)}function cq(t,e,r){if(st(t)){const n=t.anchor.getNode();if(n.is(r)&&t.format!==n.getFormat())return!1}return xl(e)&&r.isAttached()}function uq(t,e,r,n){for(let s=t;s&&!uZ(s);s=em(s)){const a=gv(s,e);if(a!==void 0){const i=Vn(a,r);if(i)return Tr(i)||!Gr(s)?void 0:[s,i]}else if(s===n)return[n,dR(r)]}}function pD(t,e,r){YS=!0;const n=performance.now()-GC>iq;try{Na(t,()=>{const s=mt()||function(m){return m.getEditorState().read(()=>{const x=mt();return x!==null?x.clone():null})}(t),a=new Map,i=t.getRootElement(),o=t._editorState,l=t._blockCursorElement;let u=!1,d="";for(let m=0;m<e.length;m++){const x=e[m],p=x.type,v=x.target,_=uq(v,t,o,i);if(!_)continue;const[S,w]=_;if(p==="characterData")n&&gt(w)&&xl(v)&&cq(s,v,w)&&lq(v,w,t);else if(p==="childList"){u=!0;const y=x.addedNodes;for(let N=0;N<y.length;N++){const F=y[N],T=cR(F),P=F.parentNode;if(P!=null&&F!==l&&T===null&&!U2(F,P,t)){if(bu){const D=(Gr(F)?F.innerText:null)||F.nodeValue;D&&(d+=D)}P.removeChild(F)}}const b=x.removedNodes,E=b.length;if(E>0){let N=0;for(let F=0;F<E;F++){const T=b[F];(U2(T,v,t)||l===T)&&(v.appendChild(T),N++)}E!==N&&a.set(S,w)}}}if(a.size>0)for(const[m,x]of a)x.reconcileObservedMutation(m,t);const h=r.takeRecords();if(h.length>0){for(let m=0;m<h.length;m++){const x=h[m],p=x.addedNodes,v=x.target;for(let _=0;_<p.length;_++){const S=p[_],w=S.parentNode;w==null||S.nodeName!=="BR"||U2(S,v,t)||w.removeChild(S)}}r.takeRecords()}s!==null&&(u&&Es(s),bu&&mR(t)&&s.insertRawText(d))})}finally{YS=!1}}function xD(t){const e=t._observer;e!==null&&pD(t,e.takeRecords(),e)}function yD(t){(function(e){GC===0&&pi(e).addEventListener("textInput",oq,!0)})(t),t._observer=new MutationObserver((e,r)=>{pD(t,e,r)})}function dq(t){const e=new Map,r=new Set;for(let n=typeof t=="function"?t:t.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=pT(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,e.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:e}}let fq=class vD{constructor(e,r,n=void 0,s=new Map,a=void 0){this.node=e,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,o=a!==void 0?a:function(l,u,d){let h=d.size;if(u)for(const m in u){const x=l.get(m);x&&d.has(x)||h++}return h}(i,n,s);this.size=o}getValue(e){const r=this.knownState.get(e);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(e.key,e);let n=e.defaultValue;if(this.unknownState&&e.key in this.unknownState){const s=this.unknownState[e.key];s!==void 0&&(n=e.parse(s)),this.updateFromKnown(e,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const e={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete e[n.key]:e[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in e&&(r[n]=e[n],delete e[n]);return y6(e)&&(r.$=e),r}getWritable(e){if(this.node===e)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new vD(e,r,function(a,i,o){let l;if(o)for(const[u,d]of Object.entries(o)){const h=a.get(u);h?i.has(h)||i.set(h,h.parse(d)):(l=l||{},l[u]=d)}return l}(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(e,r){const n=e.key;this.sharedNodeState.sharedConfigMap.set(n,e);const{knownState:s,unknownState:a}=this;s.has(e)||a&&n in a||(a&&(delete a[n],this.unknownState=y6(a)),this.size++),s.set(e,r)}updateFromUnknown(e,r){const n=this.sharedNodeState.sharedConfigMap.get(e);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},e in this.unknownState||this.size++,this.unknownState[e]=r)}updateFromJSON(e){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,e)for(const[n,s]of Object.entries(e))this.updateFromUnknown(n,s)}};function hq(t){const e=t.getWritable(),r=e.__state?e.__state.getWritable(e):new fq(e,wD(e));return e.__state=r,r}function wD(t){return t.__state?t.__state.sharedNodeState:iR(tm(),t.getType()).sharedNodeState}function y6(t){if(t)for(const e in t)return t}function v6(t,e,r){for(const[n,s]of e.knownState){if(t.has(n.key))continue;t.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function w6(t,e,r){const{unknownState:n}=e,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!t.has(a)&&(t.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function _6(t,e){const r=t.__state;return r&&r.node===t?r.getWritable(e):r}function S6(t,e){const r=t.__mode,n=t.__format,s=t.__style,a=e.__mode,i=e.__format,o=e.__style,l=t.__state,u=e.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===o)&&(t.__state===null||l===u||function(d,h){if(d===h)return!0;if(d&&h&&d.size!==h.size)return!1;const m=new Set;return!(d&&v6(m,d,h)||h&&v6(m,h,d)||d&&w6(m,d,h)||h&&w6(m,h,d))}(l,u))}function b6(t,e){const r=t.mergeWithSibling(e),n=hn()._normalizedNodes;return n.add(t.__key),n.add(e.__key),r}function k6(t){let e,r,n=t;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(e=n.getPreviousSibling())!==null&&gt(e)&&e.isSimpleText()&&!e.isUnmergeable();){if(e.__text!==""){if(S6(e,n)){n=b6(e,n);break}break}e.remove()}for(;(r=n.getNextSibling())!==null&&gt(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(S6(n,r)){n=b6(n,r);break}break}r.remove()}}else n.remove()}function d1(t){return C6(t.anchor),C6(t.focus),t}function C6(t){for(;t.type==="element";){const e=t.getNode(),r=t.offset;let n,s;if(r===e.getChildrenSize()?(n=e.getChildAtIndex(r-1),s=!0):(n=e.getChildAtIndex(r),s=!1),gt(n)){t.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!Ke(n))break;t.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let Tu,zs,cg,av,JS,QS,Eu,Ui,qS,ug,Yn="",io=null,oo="",Vo="",Pd=!1,f1=!1;function h1(t,e){const r=Eu.get(t);if(e!==null){const n=rb(t);n.parentNode===e&&e.removeChild(n)}if(Ui.has(t)||zs._keyToDOMMap.delete(t),Ke(r)){const n=m1(r,Eu);ZS(n,0,n.length-1,null)}r!==void 0&&fT(ug,cg,av,r,"destroyed")}function ZS(t,e,r,n){let s=e;for(;s<=r;++s){const a=t[s];a!==void 0&&h1(a,n)}}function Wc(t,e){t.setProperty("text-align",e)}const gq="40px";function _D(t,e){const r=Tu.theme.indent;if(typeof r=="string"){const s=t.classList.contains(r);e>0&&!s?t.classList.add(r):e<1&&s&&t.classList.remove(r)}const n=getComputedStyle(t).getPropertyValue("--lexical-indent-base-value")||gq;t.style.setProperty("padding-inline-start",e===0?"":`calc(${e} * ${n})`)}function SD(t,e){const r=t.style;e===0?Wc(r,""):e===BC?Wc(r,"left"):e===UC?Wc(r,"center"):e===$C?Wc(r,"right"):e===zC?Wc(r,"justify"):e===WC?Wc(r,"start"):e===VC&&Wc(r,"end")}function eb(t,e){const r=function(n){const s=n.__dir;if(s!==null)return s;if(Zn(n))return null;const a=n.getParentOrThrow();return Zn(a)&&a.__dir===null?"auto":null}(e);r!==null?t.dir=r:t.removeAttribute("dir")}function g1(t,e){const r=Ui.get(t);r===void 0&&ot(60);const n=r.createDOM(Tu,zs);if(function(s,a,i){const o=i._keyToDOMMap;(function(l,u,d){const h=`__lexicalKey_${u._key}`;l[h]=d})(a,i,s),o.set(s,a)}(t,n,zs),gt(r)?n.setAttribute("data-lexical-text","true"):Tr(r)&&n.setAttribute("data-lexical-decorator","true"),Ke(r)){const s=r.__indent,a=r.__size;if(eb(n,r),s!==0&&_D(n,s),a!==0){const o=a-1;tb(m1(r,Ui),r,0,o,r.getDOMSlot(n))}const i=r.__format;i!==0&&SD(n,i),r.isInline()||bD(null,r,n),mv(r)&&(Yn+=ll,Vo+=ll)}else{const s=r.getTextContent();if(Tr(r)){const a=r.decorate(zs,Tu);a!==null&&kD(t,a),n.contentEditable="false"}Yn+=s,Vo+=s}return e!==null&&e.insertChild(n),fT(ug,cg,av,r,"created"),n}function tb(t,e,r,n,s){const a=Yn;Yn="";let i=r;for(;i<=n;++i){g1(t[i],s);const o=Ui.get(t[i]);o!==null&&gt(o)&&(io===null&&(io=o.getFormat()),oo===""&&(oo=o.getStyle()))}mv(e)&&(Yn+=ll),s.element.__lexicalTextContent=Yn,Yn=a+Yn}function T6(t,e){if(t){const r=t.__last;if(r){const n=e.get(r);if(n)return qo(n)?"line-break":Tr(n)&&n.isInline()?"decorator":null}return"empty"}return null}function bD(t,e,r){const n=T6(t,Eu),s=T6(e,Ui);n!==s&&e.getDOMSlot(r).setManagedLineBreak(s)}function mq(t,e,r){var n;io=null,oo="",function(s,a,i){const o=Yn,l=s.__size,u=a.__size;Yn="";const d=i.element;if(l===1&&u===1){const h=s.__first,m=a.__first;if(h===m)t0(h,d);else{const p=rb(h),v=g1(m,null);try{d.replaceChild(v,p)}catch(_){if(typeof _=="object"&&_!=null){const S=`${_.toString()} Parent: ${d.tagName}, new child: {tag: ${v.tagName} key: ${m}}, old child: {tag: ${p.tagName}, key: ${h}}.`;throw new Error(S)}throw _}h1(h,null)}const x=Ui.get(m);gt(x)&&(io===null&&(io=x.getFormat()),oo===""&&(oo=x.getStyle()))}else{const h=m1(s,Eu),m=m1(a,Ui);if(h.length!==l&&ot(227),m.length!==u&&ot(228),l===0)u!==0&&tb(m,a,0,u-1,i);else if(u===0){if(l!==0){const x=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;ZS(h,0,l-1,x?null:d),x&&(d.textContent="")}}else(function(x,p,v,_,S,w){const y=_-1,b=S-1;let E,N,F=w.getFirstChild(),T=0,P=0;for(;T<=y&&P<=b;){const I=p[T],W=v[P];if(I===W)F=$2(t0(W,w.element)),T++,P++;else{E===void 0&&(E=new Set(p)),N===void 0&&(N=new Set(v));const q=N.has(I),V=E.has(W);if(q)if(V){const K=Nu(zs,W);K===F?F=$2(t0(W,w.element)):(w.withBefore(F).insertChild(K),t0(W,w.element)),T++,P++}else g1(W,w.withBefore(F)),P++;else F=$2(rb(I)),h1(I,w.element),T++}const le=Ui.get(W);le!==null&&gt(le)&&(io===null&&(io=le.getFormat()),oo===""&&(oo=le.getStyle()))}const D=T>y,R=P>b;if(D&&!R){const I=v[b+1],W=I===void 0?null:zs.getElementByKey(I);tb(v,x,P,b,w.withBefore(W))}else R&&!D&&ZS(p,T,y,w.element)})(a,h,m,l,u,i)}mv(a)&&(Yn+=ll),d.__lexicalTextContent=Yn,Yn=o+Yn}(t,e,e.getDOMSlot(r)),n=e,io==null||io===n.__textFormat||f1||n.setTextFormat(io),function(s){oo===""||oo===s.__textStyle||f1||s.setTextStyle(oo)}(e)}function m1(t,e){const r=[];let n=t.__first;for(;n!==null;){const s=e.get(n);s===void 0&&ot(101),r.push(n),n=s.__next}return r}function t0(t,e){const r=Eu.get(t);let n=Ui.get(t);r!==void 0&&n!==void 0||ot(61);const s=Pd||QS.has(t)||JS.has(t),a=Nu(zs,t);if(r===n&&!s){if(Ke(r)){const i=a.__lexicalTextContent;i!==void 0&&(Yn+=i,Vo+=i)}else{const i=r.getTextContent();Vo+=i,Yn+=i}return a}if(r!==n&&s&&fT(ug,cg,av,n,"updated"),n.updateDOM(r,a,Tu)){const i=g1(t,null);return e===null&&ot(62),e.replaceChild(i,a),h1(t,null),i}if(Ke(r)&&Ke(n)){const i=n.__indent;(Pd||i!==r.__indent)&&_D(a,i);const o=n.__format;if((Pd||o!==r.__format)&&SD(a,o),s&&(mq(r,n,a),Zn(n)||n.isInline()||bD(r,n,a)),mv(n)&&(Yn+=ll,Vo+=ll),(Pd||n.__dir!==r.__dir)&&(eb(a,n),Zn(n)&&!Pd))for(const l of n.getChildren())Ke(l)&&eb(Nu(zs,l.getKey()),l)}else{const i=n.getTextContent();if(Tr(n)){const o=n.decorate(zs,Tu);o!==null&&kD(t,o)}Yn+=i,Vo+=i}if(!f1&&Zn(n)&&n.__cachedText!==Vo){const i=n.getWritable();i.__cachedText=Vo,n=i}return a}function kD(t,e){let r=zs._pendingDecorators;const n=zs._decorators;if(r===null){if(n[t]===e)return;r=uR(zs)}r[t]=e}function $2(t){let e=t.nextSibling;return e!==null&&e===zs._blockCursorElement&&(e=e.nextSibling),e}function pq(t,e,r,n,s,a){Yn="",Vo="",Pd=n===Mf,zs=r,Tu=r._config,cg=r._nodes,av=zs._listeners.mutation,JS=s,QS=a,Eu=t._nodeMap,Ui=e._nodeMap,f1=e._readOnly,qS=new Map(r._keyToDOMMap);const i=new Map;return ug=i,t0("root",null),zs=void 0,cg=void 0,JS=void 0,QS=void 0,Eu=void 0,Ui=void 0,Tu=void 0,qS=void 0,ug=void 0,i}function rb(t){const e=qS.get(t);return e===void 0&&ot(75,t),e}function Ut(t){return{type:t}}const CD=Ut("SELECTION_CHANGE_COMMAND"),xq=Ut("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),HC=Ut("CLICK_COMMAND"),du=Ut("DELETE_CHARACTER_COMMAND"),df=Ut("INSERT_LINE_BREAK_COMMAND"),dg=Ut("INSERT_PARAGRAPH_COMMAND"),ff=Ut("CONTROLLED_TEXT_INSERTION_COMMAND"),KC=Ut("PASTE_COMMAND"),nb=Ut("REMOVE_TEXT_COMMAND"),fg=Ut("DELETE_WORD_COMMAND"),hg=Ut("DELETE_LINE_COMMAND"),ci=Ut("FORMAT_TEXT_COMMAND"),XC=Ut("UNDO_COMMAND"),YC=Ut("REDO_COMMAND"),yq=Ut("KEYDOWN_COMMAND"),TD=Ut("KEY_ARROW_RIGHT_COMMAND"),vq=Ut("MOVE_TO_END"),ED=Ut("KEY_ARROW_LEFT_COMMAND"),wq=Ut("MOVE_TO_START"),ND=Ut("KEY_ARROW_UP_COMMAND"),AD=Ut("KEY_ARROW_DOWN_COMMAND"),p1=Ut("KEY_ENTER_COMMAND"),FD=Ut("KEY_SPACE_COMMAND"),jD=Ut("KEY_BACKSPACE_COMMAND"),PD=Ut("KEY_ESCAPE_COMMAND"),DD=Ut("KEY_DELETE_COMMAND"),RD=Ut("KEY_TAB_COMMAND"),_q=Ut("INSERT_TAB_COMMAND"),Sq=Ut("INDENT_CONTENT_COMMAND"),E6=Ut("OUTDENT_CONTENT_COMMAND"),OD=Ut("DROP_COMMAND"),MD=Ut("FORMAT_ELEMENT_COMMAND"),LD=Ut("DRAGSTART_COMMAND"),ID=Ut("DRAGOVER_COMMAND"),bq=Ut("DRAGEND_COMMAND"),iv=Ut("COPY_COMMAND"),JC=Ut("CUT_COMMAND"),sb=Ut("SELECT_ALL_COMMAND"),kq=Ut("CLEAR_EDITOR_COMMAND"),Cq=Ut("CLEAR_HISTORY_COMMAND"),Dp=Ut("CAN_REDO_COMMAND"),Rp=Ut("CAN_UNDO_COMMAND"),Tq=Ut("FOCUS_COMMAND"),Eq=Ut("BLUR_COMMAND"),Nq=Ut("KEY_MODIFIER_COMMAND"),Lo=Object.freeze({}),ab=30,ib=[["keydown",function(t,e){if(_0=t.timeStamp,BD=t.key,!e.isComposing()&&!kt(e,yq,t)&&t.key!=null){if(z2&&tA(t))return Na(e,()=>{Op(e,W2)}),z2=!1,void(W2="");if(function(r){return Fr(r,"ArrowRight",{shiftKey:"any"})}(t))kt(e,TD,t);else if(function(r){return Fr(r,"ArrowRight",Uo)}(t))kt(e,vq,t);else if(function(r){return Fr(r,"ArrowLeft",{shiftKey:"any"})}(t))kt(e,ED,t);else if(function(r){return Fr(r,"ArrowLeft",Uo)}(t))kt(e,wq,t);else if(function(r){return Fr(r,"ArrowUp",{altKey:"any",shiftKey:"any"})}(t))kt(e,ND,t);else if(function(r){return Fr(r,"ArrowDown",{altKey:"any",shiftKey:"any"})}(t))kt(e,AD,t);else if(function(r){return Fr(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})}(t))S0=!0,kt(e,p1,t);else if(function(r){return r.key===" "}(t))kt(e,FD,t);else if(function(r){return lo&&Fr(r,"o",{ctrlKey:!0})}(t))t.preventDefault(),S0=!0,kt(e,df,!0);else if(function(r){return Fr(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})}(t))S0=!1,kt(e,p1,t);else if(function(r){return Fr(r,"Backspace",{shiftKey:"any"})||lo&&Fr(r,"h",{ctrlKey:!0})}(t))tA(t)?kt(e,jD,t):(t.preventDefault(),kt(e,du,!0));else if(function(r){return r.key==="Escape"}(t))kt(e,PD,t);else if(function(r){return Fr(r,"Delete",{})||lo&&Fr(r,"d",{ctrlKey:!0})}(t))(function(r){return r.key==="Delete"})(t)?kt(e,DD,t):(t.preventDefault(),kt(e,du,!1));else if(function(r){return Fr(r,"Backspace",eA)}(t))t.preventDefault(),kt(e,fg,!0);else if(function(r){return Fr(r,"Delete",eA)}(t))t.preventDefault(),kt(e,fg,!1);else if(function(r){return lo&&Fr(r,"Backspace",{metaKey:!0})}(t))t.preventDefault(),kt(e,hg,!0);else if(function(r){return lo&&(Fr(r,"Delete",{metaKey:!0})||Fr(r,"k",{ctrlKey:!0}))}(t))t.preventDefault(),kt(e,hg,!1);else if(function(r){return Fr(r,"b",Uo)}(t))t.preventDefault(),kt(e,ci,"bold");else if(function(r){return Fr(r,"u",Uo)}(t))t.preventDefault(),kt(e,ci,"underline");else if(function(r){return Fr(r,"i",Uo)}(t))t.preventDefault(),kt(e,ci,"italic");else if(function(r){return Fr(r,"Tab",{shiftKey:"any"})}(t))kt(e,RD,t);else if(function(r){return Fr(r,"z",Uo)}(t))t.preventDefault(),kt(e,XC,void 0);else if(function(r){return lo?Fr(r,"z",{metaKey:!0,shiftKey:!0}):Fr(r,"y",{ctrlKey:!0})||Fr(r,"z",{ctrlKey:!0,shiftKey:!0})}(t))t.preventDefault(),kt(e,YC,void 0);else{const r=e._editorState._selection;r===null||st(r)?rA(t)&&(t.preventDefault(),kt(e,sb,t)):function(n){return Fr(n,"c",Uo)}(t)?(t.preventDefault(),kt(e,iv,t)):function(n){return Fr(n,"x",Uo)}(t)?(t.preventDefault(),kt(e,JC,t)):rA(t)&&(t.preventDefault(),kt(e,sb,t))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(t)&&kt(e,Nq,t)}}],["pointerdown",function(t,e){const r=t.target,n=t.pointerType;ih(r)&&n!=="touch"&&n!=="pen"&&t.button===0&&Na(e,()=>{Q6(r)||(lb=!0)})}],["compositionstart",function(t,e){Na(e,()=>{const r=mt();if(st(r)&&!e.isComposing()){const n=r.anchor,s=r.anchor.getNode();Ss(n.key),(t.timeStamp<_0+ab||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||gt(s)&&s.getStyle()!==r.style)&&kt(e,ff,tq)}})}],["compositionend",function(t,e){bu?Gh=!0:Of||!lg&&!l1?Na(e,()=>{Op(e,t.data)}):(z2=!0,W2=t.data)}],["input",function(t,e){t.stopPropagation(),Na(e,()=>{if(Gr(t.target)&&Q6(t.target))return;const r=mt(),n=t.data,s=VD(t);if(n!=null&&st(r)&&zD(r,s,n,t.timeStamp,!1)){Gh&&(Op(e,n),Gh=!1);const a=r.anchor.getNode(),i=Vi(pi(e));if(i===null)return;const o=r.isBackward(),l=o?r.anchor.offset:r.focus.offset,u=o?r.focus.offset:r.anchor.offset;o1&&!r.isCollapsed()&&gt(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,l)+n+a.getTextContent().slice(l+u)===gR(i.anchorNode)||kt(e,ff,n);const d=n.length;bu&&d>1&&t.inputType==="insertCompositionText"&&!e.isComposing()&&(r.anchor.offset-=d),lg||Of||l1||!e.isComposing()||(_0=0,Ss(null))}else uT(!1,e,n!==null?n:void 0),Gh&&(Op(e,n||void 0),Gh=!1);(function(){_s();const a=hn();xD(a)})()},{event:t}),Dd=null}],["click",function(t,e){Na(e,()=>{const r=mt(),n=Vi(pi(e)),s=ah();if(n){if(st(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!Zn(i)&&gn().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(t.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const o=function(l,u){let d=l;for(;d!==gn()&&d!=null;){if(u(d))return d;d=d.getParent()}return null}(i,l=>Ke(l)&&!l.isInline());Ke(o)&&o.select(0)}}else if(t.pointerType==="touch"||t.pointerType==="pen"){const a=n.anchorNode;(Gr(a)||xl(a))&&Es(ZC(s,n,e,t))}}kt(e,HC,t)})}],["cut",Lo],["copy",Lo],["dragstart",Lo],["dragover",Lo],["dragend",Lo],["paste",Lo],["focus",Lo],["blur",Lo],["drop",Lo]];o1&&ib.push(["beforeinput",(t,e)=>function(r,n){const s=r.inputType,a=VD(r);s==="deleteCompositionText"||bu&&mR(n)||s!=="insertCompositionText"&&Na(n,()=>{const i=mt();if(s==="deleteContentBackward"){if(i===null){const x=ah();if(!st(x))return;Es(x.clone())}if(st(i)){const x=i.anchor.key===i.focus.key;if(o=r.timeStamp,BD==="MediaLast"&&o<_0+ab&&n.isComposing()&&x){if(Ss(null),_0=0,setTimeout(()=>{Na(n,()=>{Ss(null)})},ab),st(i)){const p=i.anchor.getNode();p.markDirty(),gt(p)||ot(142),WD(i,p)}}else{Ss(null),r.preventDefault();const p=i.anchor.getNode(),v=p.getTextContent(),_=p.canInsertTextAfter(),S=i.anchor.offset===0&&i.focus.offset===v.length;let w=m6&&x&&!S&&_;if(w&&i.isCollapsed()&&(w=!Tr(hb(i.anchor,!0))),!w){kt(n,du,!0);const y=mt();m6&&st(y)&&y.isCollapsed()&&(Yc=y,setTimeout(()=>Yc=null))}}return}}var o;if(!st(i))return;const l=r.data;Dd!==null&&uT(!1,n,Dd),i.dirty&&Dd===null||!i.isCollapsed()||Zn(i.anchor.getNode())||a===null||i.applyDOMRange(a),Dd=null;const u=i.anchor,d=i.focus,h=u.getNode(),m=d.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":kt(n,ff,r);break;case"insertFromComposition":Ss(null),kt(n,ff,r);break;case"insertLineBreak":Ss(null),kt(n,df,!1);break;case"insertParagraph":Ss(null),S0&&!Of?(S0=!1,kt(n,df,!1)):kt(n,dg,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":kt(n,KC,r);break;case"deleteByComposition":(function(x,p){return x!==p||Ke(x)||Ke(p)||!fu(x)||!fu(p)})(h,m)&&kt(n,nb,r);break;case"deleteByDrag":case"deleteByCut":kt(n,nb,r);break;case"deleteContent":kt(n,du,!1);break;case"deleteWordBackward":kt(n,fg,!0);break;case"deleteWordForward":kt(n,fg,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":kt(n,hg,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":kt(n,hg,!1);break;case"formatStrikeThrough":kt(n,ci,"strikethrough");break;case"formatBold":kt(n,ci,"bold");break;case"formatItalic":kt(n,ci,"italic");break;case"formatUnderline":kt(n,ci,"underline");break;case"historyUndo":kt(n,XC,void 0);break;case"historyRedo":kt(n,YC,void 0)}else{if(l===`
`)r.preventDefault(),kt(n,df,!1);else if(l===ll)r.preventDefault(),kt(n,dg,void 0);else if(l==null&&r.dataTransfer){const x=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(x)}else l!=null&&zD(i,a,l,r.timeStamp,!0)?(r.preventDefault(),kt(n,ff,l)):Dd=l;UD=r.timeStamp}})}(t,e)]);let _0=0,BD=null,UD=0,Dd=null;const x1=new WeakMap;let ob=!1,lb=!1,S0=!1,Gh=!1,z2=!1,W2="",Yc=null,$D=[0,"",0,"root",0];function zD(t,e,r,n,s){const a=t.anchor,i=t.focus,o=a.getNode(),l=hn(),u=Vi(pi(l)),d=u!==null?u.anchorNode:null,h=a.key,m=l.getElementByKey(h),x=r.length;return h!==i.key||!gt(o)||(!s&&(!o1||UD<n+50)||o.isDirty()&&x<2||fR(r))&&a.offset!==i.offset&&!o.isComposing()||zo(o)||o.isDirty()&&x>1||(s||!o1)&&m!==null&&!o.isComposing()&&d!==Lf(m)||u!==null&&e!==null&&(!e.collapsed||e.startContainer!==u.anchorNode||e.startOffset!==u.anchorOffset)||o.getFormat()!==t.format||o.getStyle()!==t.style||function(p,v){if(v.isSegmented())return!0;if(!p.isCollapsed())return!1;const _=p.anchor.offset,S=v.getParentOrThrow(),w=fu(v);return _===0?!v.canInsertTextBefore()||!S.canInsertTextBefore()&&!v.isComposing()||w||function(y){const b=y.getPreviousSibling();return(gt(b)||Ke(b)&&b.isInline())&&!b.canInsertTextAfter()}(v):_===v.getTextContentSize()&&(!v.canInsertTextAfter()||!S.canInsertTextAfter()&&!v.isComposing()||w)}(t,o)}function N6(t,e){return xl(t)&&t.nodeValue!==null&&e!==0&&e!==t.nodeValue.length}function A6(t,e,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=t;ob&&(ob=!1,N6(n,s)&&N6(a,i)&&!Yc)||Na(e,()=>{if(!r)return void Es(null);if(!Zg(e,n,a))return;let o=mt();if(Yc&&st(o)&&o.isCollapsed()){const l=o.anchor,u=Yc.anchor;(l.key===u.key&&l.offset===u.offset+1||l.offset===1&&u.getNode().is(l.getNode().getPreviousSibling()))&&(o=Yc.clone(),Es(o))}if(Yc=null,st(o)){const l=o.anchor,u=l.getNode();if(o.isCollapsed()){t.type==="Range"&&t.anchorNode===t.focusNode&&(o.dirty=!0);const d=pi(e).event,h=d?d.timeStamp:performance.now(),[m,x,p,v,_]=$D,S=gn(),w=e.isComposing()===!1&&S.getTextContent()==="";if(h<_+200&&l.offset===p&&l.key===v)wx(o,m,x);else if(l.type==="text")gt(u)||ot(141),WD(o,u);else if(l.type==="element"&&!w){Ke(u)||ot(259);const y=l.getNode();y.isEmpty()?function(b,E){const N=E.getTextFormat(),F=E.getTextStyle();wx(b,N,F)}(o,y):wx(o,0,"")}}else{const d=l.key,h=o.focus.key,m=o.getNodes(),x=m.length,p=o.isBackward(),v=p?i:s,_=p?s:i,S=p?h:d,w=p?d:h;let y=eq,b=!1;for(let E=0;E<x;E++){const N=m[E],F=N.getTextContentSize();if(gt(N)&&F!==0&&!(E===0&&N.__key===S&&v===F||E===x-1&&N.__key===w&&_===0)&&(b=!0,y&=N.getFormat(),y===0))break}o.format=b?y:0}}kt(e,CD,void 0)})}function wx(t,e,r){t.format===e&&t.style===r||(t.format=e,t.style=r,t.dirty=!0)}function WD(t,e){wx(t,e.getFormat(),e.getStyle())}function VD(t){if(!t.getTargetRanges)return null;const e=t.getTargetRanges();return e.length===0?null:e[0]}function Op(t,e){const r=t._compositionKey;if(Ss(null),r!==null&&e!=null){if(e===""){const n=Vn(r),s=Lf(t.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&gt(n)&&dT(n,s.nodeValue,null,null,!0))}if(e[e.length-1]===`
`){const n=mt();if(st(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void kt(t,p1,null)}}}uT(!0,t,e)}function GD(t){let e=t.__lexicalEventHandles;return e===void 0&&(e=[],t.__lexicalEventHandles=e),e}const hf=new Map;function HD(t){const e=oZ(t.target);if(e===null)return;const r=oR(e.anchorNode);if(r===null)return;lb&&(lb=!1,Na(r,()=>{const l=ah(),u=e.anchorNode;(Gr(u)||xl(u))&&Es(ZC(l,e,r,t))}));const n=cT(r),s=n[n.length-1],a=s._key,i=hf.get(a),o=i||s;o!==r&&A6(e,o,!1),A6(e,r,!0),r!==s?hf.set(a,r):i&&hf.delete(a)}function F6(t){t._lexicalHandled=!0}function j6(t){return t._lexicalHandled===!0}function Aq(t){const e=t.ownerDocument,r=x1.get(e);if(r===void 0)return;const n=r-1;n>=0||ot(164),x1.set(e,n),n===0&&e.removeEventListener("selectionchange",HD);const s=hv(t);lT(s)?(function(i){if(i._parentEditor!==null){const o=cT(i),l=o[o.length-1]._key;hf.get(l)===i&&hf.delete(l)}else hf.delete(i._key)}(s),t.__lexicalEditor=null):s&&ot(198);const a=GD(t);for(let i=0;i<a.length;i++)a[i]();t.__lexicalEventHandles=[]}function cb(t,e,r){_s();const n=t.__key,s=t.getParent();if(s===null)return;const a=function(o){const l=mt();if(!st(l)||!Ke(o))return l;const{anchor:u,focus:d}=l,h=u.getNode(),m=d.getNode();return gb(h,o)&&u.set(o.__key,0,"element"),gb(m,o)&&d.set(o.__key,0,"element"),l}(t);let i=!1;if(st(a)&&e){const o=a.anchor,l=a.focus;o.key===n&&(v1(o,t,s,t.getPreviousSibling(),t.getNextSibling()),i=!0),l.key===n&&(v1(l,t,s,t.getPreviousSibling(),t.getNextSibling()),i=!0)}else Os(a)&&e&&t.isSelected()&&t.selectPrevious();if(st(a)&&e&&!i){const o=t.getIndexWithinParent();hu(t),y1(a,s,o,-1)}else hu(t);r||na(s)||s.canBeEmpty()||!s.isEmpty()||cb(s,e),e&&a&&Zn(s)&&s.isEmpty()&&s.selectEnd()}class nh{static getType(){const{ownNodeType:e}=pT(this);return e===void 0&&ot(64,this.name),e}static clone(e){ot(65,this.name)}$config(){return{}}config(e,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:e}),{[e]:r}}afterCloneFrom(e){this.__key===e.__key?(this.__parent=e.__parent,this.__next=e.__next,this.__prev=e.__prev,this.__state=e.__state):e.__state&&(this.__state=e.__state.getWritable(this))}constructor(e){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),Zq(this,e)}getType(){return this.__type}isInline(){ot(137,this.constructor.name)}isAttached(){let e=this.__key;for(;e!==null;){if(e==="root")return!0;const r=Vn(e);if(r===null)break;e=r.__parent}return!1}isSelected(e){const r=e||mt();if(r==null)return!1;const n=r.getNodes().some(s=>s.__key===this.__key);if(gt(this))return n;if(st(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(Tr(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();if(e===null)return-1;let r=e.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const e=this.getLatest().__parent;return e===null?null:Vn(e)}getParentOrThrow(){const e=this.getParent();return e===null&&ot(66,this.__key),e}getTopLevelElement(){let e=this;for(;e!==null;){const r=e.getParent();if(na(r))return Ke(e)||e===this&&Tr(e)||ot(194),e;e=r}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();return e===null&&ot(67,this.__key),e}getParents(){const e=[];let r=this.getParent();for(;r!==null;)e.push(r),r=r.getParent();return e}getParentKeys(){const e=[];let r=this.getParent();for(;r!==null;)e.push(r.__key),r=r.getParent();return e}getPreviousSibling(){const e=this.getLatest().__prev;return e===null?null:Vn(e)}getPreviousSiblings(){const e=[],r=this.getParent();if(r===null)return e;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)e.push(n),n=n.getNextSibling();return e}getNextSibling(){const e=this.getLatest().__next;return e===null?null:Vn(e)}getNextSiblings(){const e=[];let r=this.getNextSibling();for(;r!==null;)e.push(r),r=r.getNextSibling();return e}getCommonAncestor(e){const r=Ke(this)?this:this.getParent(),n=Ke(e)?e:e.getParent(),s=r&&n?Sx(r,n):null;return s?s.commonAncestor:null}is(e){return e!=null&&this.__key===e.__key}isBefore(e){const r=Sx(this,e);return r!==null&&(r.type==="descendant"||(r.type==="branch"?vR(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&ot(279),!1)))}isParentOf(e){const r=Sx(this,e);return r!==null&&r.type==="ancestor"}getNodesBetween(e){const r=this.isBefore(e),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===e)break;const o=Ke(a)?r?a.getFirstChild():a.getLastChild():null;if(o!==null){a=o;continue}const l=r?a.getNextSibling():a.getPreviousSibling();if(l!==null){a=l;continue}const u=a.getParentOrThrow();if(s.has(u.__key)||n.push(u),u===e)break;let d=null,h=u;do{if(h===null&&ot(68),d=r?h.getNextSibling():h.getPreviousSibling(),h=h.getParent(),h===null)break;d!==null||s.has(h.__key)||n.push(h)}while(d===null);a=d}return r||n.reverse(),n}isDirty(){const e=hn()._dirtyLeaves;return e!==null&&e.has(this.__key)}getLatest(){const e=Vn(this.__key);return e===null&&ot(113),e}getWritable(){_s();const e=Ec(),r=hn(),n=e._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,o=mt();if(o!==null&&o.setCachedNodes(null),i.has(s))return S1(a),a;const l=gT(a);return i.add(s),S1(l),n.set(s,l),l}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(e,r){ot(70)}updateDOM(e,r,n){ot(71)}exportDOM(e){return{element:this.createDOM(e._config,e)}}exportJSON(){const e=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...e}}static importJSON(e){ot(18,this.name)}updateFromJSON(e){return function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const o of wD(s).flatKeys)o in n&&(i!==void 0&&i!==a||(i={...a}),i[o]=n[o]);return(s.__state||i)&&hq(r).updateFromJSON(i),s}(this,e)}static transform(){return null}remove(e){cb(this,!0,e)}replace(e,r){_s();let n=mt();n!==null&&(n=n.clone()),Y2(this,e);const s=this.getLatest(),a=this.__key,i=e.__key,o=e.getWritable(),l=this.getParentOrThrow().getWritable(),u=l.__size;hu(o);const d=s.getPreviousSibling(),h=s.getNextSibling(),m=s.__prev,x=s.__next,p=s.__parent;if(cb(s,!1,!0),d===null?l.__first=i:d.getWritable().__next=i,o.__prev=m,h===null?l.__last=i:h.getWritable().__prev=i,o.__next=x,o.__parent=p,l.__size=u,r&&(Ke(this)&&Ke(o)||ot(139),this.getChildren().forEach(v=>{o.append(v)})),st(n)){Es(n);const v=n.anchor,_=n.focus;v.key===a&&O6(v,o),_.key===a&&O6(_,o)}return $l()===a&&Ss(i),o}insertAfter(e,r=!0){_s(),Y2(this,e);const n=this.getWritable(),s=e.getWritable(),a=s.getParent(),i=mt();let o=!1,l=!1;if(a!==null){const x=e.getIndexWithinParent();if(hu(s),st(i)){const p=a.__key,v=i.anchor,_=i.focus;o=v.type==="element"&&v.key===p&&v.offset===x+1,l=_.type==="element"&&_.key===p&&_.offset===x+1}}const u=this.getNextSibling(),d=this.getParentOrThrow().getWritable(),h=s.__key,m=n.__next;if(u===null?d.__last=h:u.getWritable().__prev=h,d.__size++,n.__next=h,s.__next=m,s.__prev=n.__key,s.__parent=n.__parent,r&&st(i)){const x=this.getIndexWithinParent();y1(i,d,x+1);const p=d.__key;o&&i.anchor.set(p,x+2,"element"),l&&i.focus.set(p,x+2,"element")}return e}insertBefore(e,r=!0){_s(),Y2(this,e);const n=this.getWritable(),s=e.getWritable(),a=s.__key;hu(s);const i=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),l=n.__prev,u=this.getIndexWithinParent();i===null?o.__first=a:i.getWritable().__next=a,o.__size++,n.__prev=a,s.__prev=l,s.__next=n.__key,s.__parent=n.__parent;const d=mt();return r&&st(d)&&y1(d,this.getParentOrThrow(),u),e}isParentRequired(){return!1}createParentElementNode(){return tn()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(e,r){_s();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(Ke(n))return n.select();if(!gt(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(e,r)}selectNext(e,r){_s();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(Ke(n))return n.select(0,0);if(!gt(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(e,r)}markDirty(){this.getWritable()}reconcileObservedMutation(e,r){this.markDirty()}}class Xg extends nh{static getType(){return"linebreak"}static clone(e){return new Xg(e.__key)}constructor(e){super(e)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:e=>function(r){const n=r.parentElement;if(n!==null&&b1(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&Mp(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&Mp(a))return!0}}return!1}(e)||function(r){const n=r.parentElement;if(n!==null&&b1(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&Mp(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&Mp(a))return!0}return!1}(e)?null:{conversion:Fq,priority:0}}}static importJSON(e){return So().updateFromJSON(e)}}function Fq(t){return{node:So()}}function So(){return oa(new Xg)}function qo(t){return t instanceof Xg}function Mp(t){return xl(t)&&/^( |\t|\r?\n)+$/.test(t.textContent||"")}function V2(t,e){return 16&e?"code":e&IC?"mark":32&e?"sub":64&e?"sup":null}function G2(t,e){return 1&e?"strong":2&e?"em":"span"}function KD(t,e,r,n,s){const a=n.classList;let i=gf(s,"base");i!==void 0&&a.add(...i),i=gf(s,"underlineStrikethrough");let o=!1;const l=e&u1&&e&c1;i!==void 0&&(r&u1&&r&c1?(o=!0,l||a.add(...i)):l&&a.remove(...i));for(const u in Cu){const d=Cu[u];if(i=gf(s,u),i!==void 0)if(r&d){if(o&&(u==="underline"||u==="strikethrough")){e&d&&a.remove(...i);continue}e&d&&(!l||u!=="underline")&&u!=="strikethrough"||a.add(...i)}else e&d&&a.remove(...i)}}function XD(t,e,r){const n=e.firstChild,s=r.isComposing(),a=t+(s?sv:"");if(n==null)e.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||bu){const[o,l,u]=function(d,h){const m=d.length,x=h.length;let p=0,v=0;for(;p<m&&p<x&&d[p]===h[p];)p++;for(;v+p<m&&v+p<x&&d[m-v-1]===h[x-v-1];)v++;return[p,m-p-v,h.slice(p,x-v)]}(i,a);l!==0&&n.deleteData(o,l),n.insertData(o,u)}else n.nodeValue=a}}function P6(t,e,r,n,s,a){XD(s,t,e);const i=a.theme.text;i!==void 0&&KD(0,0,n,t,i)}function Lp(t,e){const r=document.createElement(e);return r.appendChild(t),r}class Tc extends nh{static getType(){return"text"}static clone(e){return new Tc(e.__text,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__text=e.__text,this.__format=e.__format,this.__style=e.__style,this.__mode=e.__mode,this.__detail=e.__detail}constructor(e="",r){super(r),this.__text=e,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const e=this.getLatest();return aq[e.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===$l()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(e){const r=Cu[e];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(e,r){return _1(this.getLatest().__format,e,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(e,r){const n=this.__format,s=V2(0,n),a=G2(0,n),i=s===null?a:s,o=document.createElement(i);let l=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),s!==null&&(l=document.createElement(a),o.appendChild(l)),P6(l,this,0,n,this.__text,e);const u=this.__style;return u!==""&&(o.style.cssText=u),o}updateDOM(e,r,n){const s=this.__text,a=e.__format,i=this.__format,o=V2(0,a),l=V2(0,i),u=G2(0,a),d=G2(0,i);if((o===null?u:o)!==(l===null?d:l))return!0;if(o===l&&u!==d){const v=r.firstChild;v==null&&ot(48);const _=document.createElement(d);return P6(_,this,0,i,s,n),r.replaceChild(_,v),!1}let h=r;l!==null&&o!==null&&(h=r.firstChild,h==null&&ot(49)),XD(s,h,this);const m=n.theme.text;m!==void 0&&a!==i&&KD(0,a,i,h,m);const x=e.__style,p=this.__style;return x!==p&&(r.style.cssText=p),!1}static importDOM(){return{"#text":()=>({conversion:Rq,priority:0}),b:()=>({conversion:Pq,priority:0}),code:()=>({conversion:Io,priority:0}),em:()=>({conversion:Io,priority:0}),i:()=>({conversion:Io,priority:0}),mark:()=>({conversion:Io,priority:0}),s:()=>({conversion:Io,priority:0}),span:()=>({conversion:jq,priority:0}),strong:()=>({conversion:Io,priority:0}),sub:()=>({conversion:Io,priority:0}),sup:()=>({conversion:Io,priority:0}),u:()=>({conversion:Io,priority:0})}}static importJSON(e){return An().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTextContent(e.text).setFormat(e.format).setDetail(e.detail).setMode(e.mode).setStyle(e.style)}exportDOM(e){let{element:r}=super.exportDOM(e);return Gr(r)||ot(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=Lp(r,"b")),this.hasFormat("italic")&&(r=Lp(r,"i")),this.hasFormat("strikethrough")&&(r=Lp(r,"s")),this.hasFormat("underline")&&(r=Lp(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(e,r){}setFormat(e){const r=this.getWritable();return r.__format=typeof e=="string"?Cu[e]:e,r}setDetail(e){const r=this.getWritable();return r.__detail=typeof e=="string"?rq[e]:e,r}setStyle(e){const r=this.getWritable();return r.__style=e,r}toggleFormat(e){const r=_1(this.getFormat(),e,null);return this.setFormat(r)}toggleDirectionless(){const e=this.getWritable();return e.__detail^=1,e}toggleUnmergeable(){const e=this.getWritable();return e.__detail^=2,e}setMode(e){const r=sq[e];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(e){if(this.__text===e)return this;const r=this.getWritable();return r.__text=e,r}select(e,r){_s();let n=e,s=r;const a=mt(),i=this.getTextContent(),o=this.__key;if(typeof i=="string"){const l=i.length;n===void 0&&(n=l),s===void 0&&(s=l)}else n=0,s=0;if(!st(a))return QD(o,n,o,s,"text","text");{const l=$l();l!==a.anchor.key&&l!==a.focus.key||Ss(o),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const e=this.getTextContentSize();return this.select(e,e)}spliceText(e,r,n,s){const a=this.getWritable(),i=a.__text,o=n.length;let l=e;l<0&&(l=o+l,l<0&&(l=0));const u=mt();if(s&&st(u)){const h=e+o;u.setTextNodeRange(a,h,a,h)}const d=i.slice(0,l)+n+i.slice(l+r);return a.__text=d,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...e){_s();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=$l(),i=n.length;e.sort((T,P)=>T-P),e.push(i);const o=[],l=e.length;for(let T=0,P=0;T<i&&P<=l;P++){const D=e[P];D>T&&(o.push(n.slice(T,D)),T=D)}const u=o.length;if(u===1)return[r];const d=o[0],h=r.getParent();let m;const x=r.getFormat(),p=r.getStyle(),v=r.__detail;let _=!1,S=null,w=null;const y=mt();if(st(y)){const[T,P]=y.isBackward()?[y.focus,y.anchor]:[y.anchor,y.focus];T.type==="text"&&T.key===s&&(S=T),P.type==="text"&&P.key===s&&(w=P)}r.isSegmented()?(m=An(d),m.__format=x,m.__style=p,m.__detail=v,m.__state=_6(r,m),_=!0):m=r.setTextContent(d);const b=[m];for(let T=1;T<u;T++){const P=An(o[T]);P.__format=x,P.__style=p,P.__detail=v,P.__state=_6(r,P);const D=P.__key;a===s&&Ss(D),b.push(P)}const E=S?S.offset:null,N=w?w.offset:null;let F=0;for(const T of b){if(!S&&!w)break;const P=F+T.getTextContentSize();if(S!==null&&E!==null&&E<=P&&E>=F&&(S.set(T.getKey(),E-F,"text"),E<P&&(S=null)),w!==null&&N!==null&&N<=P&&N>=F){w.set(T.getKey(),N-F,"text");break}F=P}if(h!==null){(function(D){const R=D.getPreviousSibling(),I=D.getNextSibling();R!==null&&S1(R),I!==null&&S1(I)})(this);const T=h.getWritable(),P=this.getIndexWithinParent();_?(T.splice(P,0,b),this.remove()):T.splice(P,1,b),st(y)&&y1(y,h,P,u-1)}return b}mergeWithSibling(e){const r=e===this.getPreviousSibling();r||e===this.getNextSibling()||ot(50);const n=this.__key,s=e.__key,a=this.__text,i=a.length;$l()===s&&Ss(n);const o=mt();if(st(o)){const h=o.anchor,m=o.focus;h!==null&&h.key===s&&z6(h,r,n,e,i),m!==null&&m.key===s&&z6(m,r,n,e,i)}const l=e.__text,u=r?l+a:a+l;this.setTextContent(u);const d=this.getWritable();return e.remove(),d}isTextEntity(){return!1}}function jq(t){return{forChild:QC(t.style),node:null}}function Pq(t){const e=t,r=e.style.fontWeight==="normal";return{forChild:QC(e.style,r?void 0:"bold"),node:null}}const D6=new WeakMap;function Dq(t){if(!Gr(t))return!1;if(t.nodeName==="PRE")return!0;const e=t.style.whiteSpace;return typeof e=="string"&&e.startsWith("pre")}function Rq(t){const e=t;t.parentElement===null&&ot(129);let r=e.textContent||"";if(function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=D6.get(a))===void 0&&!Dq(a);)i.push(a),a=a.parentNode;const o=s===void 0?a:s;for(let l=0;l<i.length;l++)D6.set(i[l],o);return o}(e)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const o=n[i];o===`
`||o===`\r
`?s.push(So()):o==="	"?s.push(sh()):o!==""&&s.push(An(o))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=e,s=!0;for(;n!==null&&(n=R6(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=e,s=!0;for(;n!==null&&(n=R6(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:An(r)}}function R6(t,e){let r=t;for(;;){let n;for(;(n=e?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,Gr(r)){const a=r.style.display;if(a===""&&!xb(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=e?r.firstChild:r.lastChild)!==null;)r=s;if(xl(r))return r;if(r.nodeName==="BR")return null}}const Oq={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function Io(t){const e=Oq[t.nodeName.toLowerCase()];return e===void 0?{node:null}:{forChild:QC(t.style,e),node:null}}function An(t=""){return oa(new Tc(t))}function gt(t){return t instanceof Tc}function QC(t,e){const r=t.fontWeight,n=t.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=t.fontStyle==="italic",o=n.includes("underline"),l=t.verticalAlign;return u=>(gt(u)&&(s&&!u.hasFormat("bold")&&u.toggleFormat("bold"),a&&!u.hasFormat("strikethrough")&&u.toggleFormat("strikethrough"),i&&!u.hasFormat("italic")&&u.toggleFormat("italic"),o&&!u.hasFormat("underline")&&u.toggleFormat("underline"),l!=="sub"||u.hasFormat("subscript")||u.toggleFormat("subscript"),l!=="super"||u.hasFormat("superscript")||u.toggleFormat("superscript"),e&&!u.hasFormat(e)&&u.toggleFormat(e)),u)}class Yg extends Tc{static getType(){return"tab"}static clone(e){return new Yg(e.__key)}constructor(e){super("	",e),this.__detail=2}static importDOM(){return null}createDOM(e){const r=super.createDOM(e),n=gf(e.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(e){return sh().updateFromJSON(e)}setTextContent(e){return e!=="	"&&e!==""&&ot(126),super.setTextContent("	")}spliceText(e,r,n,s){return n===""&&r===0||n==="	"&&r===1||ot(286),this}setDetail(e){return e!==2&&ot(127),this}setMode(e){return e!=="normal"&&ot(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function sh(){return oa(new Yg)}function ov(t){return t instanceof Yg}class Mq{constructor(e,r,n){this._selection=null,this.key=e,this.offset=r,this.type=n}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){return this.key===e.key?this.offset<e.offset:yR(ui(cl(this,"next")),ui(cl(e,"next")))<0}getNode(){const e=Vn(this.key);return e===null&&ot(20),e}set(e,r,n,s){const a=this._selection,i=this.key;s&&this.key===e&&this.offset===r&&this.type===n||(this.key=e,this.offset=r,this.type=n,Jg()||($l()===i&&Ss(e),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function bo(t,e,r){return new Mq(t,e,r)}function H2(t,e){let r=e.__key,n=t.offset,s="element";if(gt(e)){s="text";const a=e.getTextContentSize();n>a&&(n=a)}else if(!Ke(e)){const a=e.getNextSibling();if(gt(a))r=a.__key,n=0,s="text";else{const i=e.getParent();i&&(r=i.__key,n=e.getIndexWithinParent()+1)}}t.set(r,n,s)}function O6(t,e){if(Ke(e)){const r=e.getLastDescendant();Ke(r)||gt(r)?H2(t,r):H2(t,e)}else H2(t,e)}class lv{constructor(e){this._cachedNodes=null,this._nodes=e,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!Os(e))return!1;const r=this._nodes,n=e._nodes;return r.size===n.size&&Array.from(r).every(s=>n.has(s))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(e){this.dirty=!0,this._nodes.add(e),this._cachedNodes=null}delete(e){this.dirty=!0,this._nodes.delete(e),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new lv(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(gt(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(e);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const r=this._nodes,n=[];for(const s of r){const a=Vn(s);a!==null&&n.push(a)}return Jg()||(this._cachedNodes=n),n}getTextContent(){const e=this.getNodes();let r="";for(let n=0;n<e.length;n++)r+=e[n].getTextContent();return r}deleteNodes(){const e=this.getNodes();if((mt()||ah())===this&&e[0]){const r=Cs(e[0],"next");wZ(lc(r,r))}for(const r of e)r.remove()}}function st(t){return t instanceof Zu}class Zu{constructor(e,r,n,s){this.anchor=e,this.focus=r,e._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return!!st(e)&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const r=function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const o=new Set,l=new Set;for(const u of n)if(wo(u)){const{origin:d}=u;s.length===0?o.add(d):(l.add(d),s.push(d))}else{const{origin:d}=u;Ke(d)&&l.has(d)||s.push(d)}if(i&&s.push(i.caret.origin),ju(n.focus)&&Ke(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let u=xi(n.focus.origin,"previous");wo(u)&&o.has(u.origin)&&!u.origin.isEmpty()&&u.origin.is(s[s.length-1]);u=vT(u))o.delete(u.origin),s.pop();for(;s.length>1;){const u=s[s.length-1];if(!Ke(u)||l.has(u)||u.isEmpty()||o.has(u))break;s.pop()}if(s.length===0&&n.isCollapsed()){const u=ui(n.anchor),d=ui(n.anchor.getFlipped()),h=x=>Zl(x)?x.origin:x.getNodeAtCaret(),m=h(u)||h(d)||(n.anchor.getNodeAtCaret()?u.origin:d.origin);s.push(m)}return s}(_R(lA(this),"next"));return Jg()||(this._cachedNodes=r),r}setTextNodeRange(e,r,n,s){this.anchor.set(e.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const e=this.getNodes();if(e.length===0)return"";const r=e[0],n=e[e.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[o,l]=ub(this);let u="",d=!0;for(let h=0;h<e.length;h++){const m=e[h];if(Ke(m)&&!m.isInline())d||(u+=`
`),d=!m.isEmpty();else if(d=!1,gt(m)){let x=m.getTextContent();m===r?m===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(x=o<l?x.slice(o,l):x.slice(l,o)):x=i?x.slice(o):x.slice(l):m===n&&(x=i?x.slice(0,l):x.slice(0,o)),u+=x}else!Tr(m)&&!qo(m)||m===n&&this.isCollapsed()||(u+=m.getTextContent())}return u}applyDOMRange(e){const r=hn(),n=r.getEditorState()._selection,s=JD(e.startContainer,e.startOffset,e.endContainer,e.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),d1(this)}clone(){const e=this.anchor,r=this.focus;return new Zu(bo(e.key,e.offset,e.type),bo(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(e){this.format=_1(this.format,e,null),this.dirty=!0}setFormat(e){this.format=e,this.dirty=!0}setStyle(e){this.style=e,this.dirty=!0}hasFormat(e){const r=Cu[e];return!!(this.format&r)}insertRawText(e){const r=e.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(So()):i==="	"?n.push(sh()):n.push(An(i))}this.insertNodes(n)}insertText(e){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,o=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,o=r),i.type==="element"&&function(_,S,w,y){const b=_.getNode(),E=b.getChildAtIndex(_.offset),N=An();if(N.setFormat(w),N.setStyle(y),sT(E))E.splice(0,0,[N]);else{const F=Zn(b)?tn().append(N):N;E===null?b.append(F):E.insertBefore(F)}_.is(S)&&S.set(N.__key,0,"text"),_.set(N.__key,0,"text")}(i,o,s,a),o.type==="element"&&Du(o,ui(cl(o,"next")));const l=i.offset;let u=o.offset;const d=this.getNodes(),h=d.length;let m=d[0];gt(m)||ot(26);const x=m.getTextContent().length,p=m.getParentOrThrow();let v=d[h-1];if(h===1&&o.type==="element"&&(u=x,o.set(i.key,u,"text")),this.isCollapsed()&&l===x&&(zo(m)||!m.canInsertTextAfter()||!p.canInsertTextAfter()&&m.getNextSibling()===null)){let _=m.getNextSibling();if(gt(_)&&_.canInsertTextBefore()&&!zo(_)||(_=An(),_.setFormat(s),_.setStyle(a),p.canInsertTextAfter()?m.insertAfter(_):p.insertAfter(_)),_.select(0,0),m=_,e!=="")return void this.insertText(e)}else if(this.isCollapsed()&&l===0&&(zo(m)||!m.canInsertTextBefore()||!p.canInsertTextBefore()&&m.getPreviousSibling()===null)){let _=m.getPreviousSibling();if(gt(_)&&!zo(_)||(_=An(),_.setFormat(s),p.canInsertTextBefore()?m.insertBefore(_):p.insertBefore(_)),_.select(),m=_,e!=="")return void this.insertText(e)}else if(m.isSegmented()&&l!==x){const _=An(m.getTextContent());_.setFormat(s),m.replace(_),m=_}else if(!this.isCollapsed()&&e!==""){const _=v.getParent();if(!p.canInsertTextBefore()||!p.canInsertTextAfter()||Ke(_)&&(!_.canInsertTextBefore()||!_.canInsertTextAfter()))return this.insertText(""),YD(this.anchor,this.focus,null),void this.insertText(e)}if(h===1){if(fu(m)){const y=An(e);return y.select(),void m.replace(y)}const _=m.getFormat(),S=m.getStyle();if(l!==u||_===s&&S===a){if(ov(m)){const y=An(e);return y.setFormat(s),y.setStyle(a),y.select(),void m.replace(y)}}else{if(m.getTextContent()!==""){const y=An(e);if(y.setFormat(s),y.setStyle(a),y.select(),l===0)m.insertBefore(y,!1);else{const[b]=m.splitText(l);b.insertAfter(y,!1)}return void(y.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length))}m.setFormat(s),m.setStyle(a)}const w=u-l;m=m.spliceText(l,w,e,!0),m.getTextContent()===""?m.remove():this.anchor.type==="text"&&(m.isComposing()?this.anchor.offset-=e.length:(this.format=_,this.style=S))}else{const _=new Set([...m.getParentKeys(),...v.getParentKeys()]),S=Ke(m)?m:m.getParentOrThrow();let w=Ke(v)?v:v.getParentOrThrow(),y=v;if(!S.is(w)&&w.isInline())do y=w,w=w.getParentOrThrow();while(w.isInline());if(o.type==="text"&&(u!==0||v.getTextContent()==="")||o.type==="element"&&v.getIndexWithinParent()<u)if(gt(v)&&!fu(v)&&u!==v.getTextContentSize()){if(v.isSegmented()){const T=An(v.getTextContent());v.replace(T),v=T}Zn(o.getNode())||o.type!=="text"||(v=v.spliceText(0,u,"")),_.add(v.__key)}else{const T=v.getParentOrThrow();T.canBeEmpty()||T.getChildrenSize()!==1?v.remove():T.remove()}else _.add(v.__key);const b=w.getChildren(),E=new Set(d),N=S.is(w),F=S.isInline()&&m.getNextSibling()===null?S:m;for(let T=b.length-1;T>=0;T--){const P=b[T];if(P.is(m)||Ke(P)&&P.isParentOf(m))break;P.isAttached()&&(!E.has(P)||P.is(y)?N||F.insertAfter(P,!1):P.remove())}if(!N){let T=w,P=null;for(;T!==null;){const D=T.getChildren(),R=D.length;(R===0||D[R-1].is(P))&&(_.delete(T.__key),P=T),T=T.getParent()}}if(fu(m))if(l===x)m.select();else{const T=An(e);T.select(),m.replace(T)}else m=m.spliceText(l,x-l,e,!0),m.getTextContent()===""?m.remove():m.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length);for(let T=1;T<h;T++){const P=d[T],D=P.__key;_.has(D)||P.remove()}}}removeText(){const e=mt()===this;bx(this,_Z(lA(this))),e&&mt()!==this&&Es(this)}formatText(e,r=null){if(this.isCollapsed())return this.toggleFormat(e),void Ss(null);const n=this.getNodes(),s=[];for(const b of n)gt(b)&&s.push(b);const a=b=>{n.forEach(E=>{if(Ke(E)){const N=E.getFormatFlags(e,b);E.setTextFormat(N)}})},i=s.length;if(i===0)return this.toggleFormat(e),Ss(null),void a(r);const o=this.anchor,l=this.focus,u=this.isBackward(),d=u?l:o,h=u?o:l;let m=0,x=s[0],p=d.type==="element"?0:d.offset;if(d.type==="text"&&p===x.getTextContentSize()&&(m=1,x=s[1],p=0),x==null)return;const v=x.getFormatFlags(e,r);a(v);const _=i-1;let S=s[_];const w=h.type==="text"?h.offset:S.getTextContentSize();if(x.is(S)){if(p===w)return;if(zo(x)||p===0&&w===x.getTextContentSize())x.setFormat(v);else{const b=x.splitText(p,w),E=p===0?b[0]:b[1];E.setFormat(v),d.type==="text"&&d.set(E.__key,0,"text"),h.type==="text"&&h.set(E.__key,w-p,"text")}return void(this.format=v)}p===0||zo(x)||([,x]=x.splitText(p),p=0),x.setFormat(v);const y=S.getFormatFlags(e,v);w>0&&(w===S.getTextContentSize()||zo(S)||([S]=S.splitText(w)),S.setFormat(y));for(let b=m+1;b<_;b++){const E=s[b],N=E.getFormatFlags(e,y);E.setFormat(N)}d.type==="text"&&d.set(x.__key,p,"text"),h.type==="text"&&h.set(S.__key,w,"text"),this.format=v|y}insertNodes(e){if(e.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const p=mt();return st(p)||ot(134),p.insertNodes(e)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=Q2(r,oi),s=e[e.length-1];if(Ke(n)&&"__language"in n){if("__language"in e[0])this.insertText(e[0].getTextContent());else{const p=K2(this);n.splice(p,0,e),s.selectEnd()}return}if(!e.some(p=>(Ke(p)||Tr(p))&&!p.isInline())){Ke(n)||ot(211,r.constructor.name,r.getType());const p=K2(this);return n.splice(p,0,e),void s.selectEnd()}const a=function(p){const v=tn();let _=null;for(let S=0;S<p.length;S++){const w=p[S],y=qo(w);if(y||Tr(w)&&w.isInline()||Ke(w)&&w.isInline()||gt(w)||w.isParentRequired()){if(_===null&&(_=w.createParentElementNode(),v.append(_),y))continue;_!==null&&_.append(w)}else v.append(w),_=null}return v}(e),i=a.getLastDescendant(),o=a.getChildren(),l=!Ke(n)||!n.isEmpty()?this.insertParagraph():null,u=o[o.length-1];let d=o[0];var h;Ke(h=d)&&oi(h)&&!h.isEmpty()&&Ke(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(Ke(n)||ot(211,r.constructor.name,r.getType()),n.append(...d.getChildren()),d=o[1]),d&&(n===null&&ot(212,r.constructor.name,r.getType()),function(p,v,_){const S=v.getParentOrThrow().getLastChild();let w=v;const y=[v];for(;w!==S;)w.getNextSibling()||ot(140),w=w.getNextSibling(),y.push(w);let b=p;for(const E of y)b=b.insertAfter(E)}(n,d));const m=Q2(i,oi);l&&Ke(m)&&(l.canMergeWhenEmpty()||oi(u))&&(m.append(...l.getChildren()),l.remove()),Ke(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const x=Ke(n)?n.getLastChild():null;qo(x)&&m!==n&&x.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=tn();return gn().splice(this.anchor.offset,0,[i]),i.select(),i}const e=K2(this),r=Q2(this.anchor.getNode(),oi);Ke(r)||ot(213);const n=r.getChildAtIndex(e),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(e){const r=So();if(this.insertNodes([r]),e){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const e=this.getNodes(),r=e.length,n=r-1,s=this.anchor,a=this.focus;let i=e[0],o=e[n];const[l,u]=ub(this);if(r===0)return[];if(r===1){if(gt(i)&&!this.isCollapsed()){const h=l>u?u:l,m=l>u?l:u,x=i.splitText(h,m),p=h===0?x[0]:x[1];return p!=null?[p]:[]}return[i]}const d=s.isBefore(a);if(gt(i)){const h=d?l:u;h===i.getTextContentSize()?e.shift():h!==0&&([,i]=i.splitText(h),e[0]=i)}if(gt(o)){const h=o.getTextContent().length,m=d?u:l;m===0?e.pop():m!==h&&([o]=o.splitText(m),e[n]=o)}return e}modify(e,r,n){if(W6(this,e,r,n))return;const s=e==="move",a=hn(),i=Vi(pi(a));if(!i)return;const o=a._blockCursorElement,l=a._rootElement,u=this.focus.getNode();if(l===null||o===null||!Ke(u)||u.isInline()||u.canBeEmpty()||mb(o,a,l),this.dirty){let d=Nu(a,this.anchor.key),h=Nu(a,this.focus.key);this.anchor.type==="text"&&(d=Lf(d)),this.focus.type==="text"&&(h=Lf(h)),d&&h&&qD(i,d,this.anchor.offset,h,this.focus.offset)}if(function(d,h,m,x){d.modify(h,m,x)}(i,e,r?"backward":"forward",n),i.rangeCount>0){const d=i.getRangeAt(0),h=this.anchor.getNode(),m=Zn(h)?h:aZ(h);if(this.applyDOMRange(d),this.dirty=!0,!s){const x=this.getNodes(),p=[];let v=!1;for(let _=0;_<x.length;_++){const S=x[_];gb(S,m)?p.push(S):v=!0}if(v&&p.length>0)if(r){const _=p[0];Ke(_)?_.selectStart():_.getParentOrThrow().selectStart()}else{const _=p[p.length-1];Ke(_)?_.selectEnd():_.getParentOrThrow().selectEnd()}i.anchorNode===d.startContainer&&i.anchorOffset===d.startOffset||function(_){const S=_.focus,w=_.anchor,y=w.key,b=w.offset,E=w.type;w.set(S.key,S.offset,S.type,!0),S.set(y,b,E,!0)}(this)}}n==="lineboundary"&&W6(this,e,r,n,"decorators")}forwardDeletion(e,r,n){if(!n&&(e.type==="element"&&Ke(r)&&e.offset===r.getChildrenSize()||e.type==="text"&&e.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(Ke(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(e){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,e))return;const a=_T(cl(n,e?"previous":"next"));if(a.getTextSlices().every(o=>o===null||o.distance===0)){let o={type:"initial"};for(const l of a.iterNodeCarets("shadowRoot"))if(wo(l)){if(!l.origin.isInline()){if(l.origin.isShadowRoot()){if(o.type==="merge-block")break;if(Ke(a.anchor.origin)&&a.anchor.origin.isEmpty()){const u=ui(l);bx(this,lc(u,u)),a.anchor.origin.remove()}return}o.type!=="merge-next-block"&&o.type!=="merge-block"||(o={block:o.block,caret:l,type:"merge-block"})}}else{if(o.type==="merge-block")break;if(ju(l)){if(Ke(l.origin)){if(l.origin.isInline()){if(!l.origin.isParentOf(a.anchor.origin))break}else o={block:l.origin,type:"merge-next-block"};continue}if(Tr(l.origin)){if(!l.origin.isIsolated())if(o.type==="merge-next-block"&&(l.origin.isKeyboardSelectable()||!l.origin.isInline())&&Ke(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const u=qC();u.add(l.origin.getKey()),Es(u)}else l.origin.remove();return}break}}if(o.type==="merge-block"){const{caret:l,block:u}=o;return bx(this,lc(!l.origin.isEmpty()&&u.isEmpty()?bT(Cs(u,l.direction)):a.anchor,l)),this.removeText()}}const i=this.focus;if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&n.offset===0&&L6(this,n.getNode()))return}else{const o=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,o!==null&&o.isSegmented()){const l=i.offset,u=o.getTextContentSize();if(o.is(s)||e&&l!==u||!e&&l!==0)return void I6(o,e,l)}else if(s!==null&&s.isSegmented()){const l=n.offset,u=s.getTextContentSize();if(s.is(o)||e&&l!==0||!e&&l!==u)return void I6(s,e,l)}(function(l,u){const d=l.anchor,h=l.focus,m=d.getNode(),x=h.getNode();if(m===x&&d.type==="text"&&h.type==="text"){const p=d.offset,v=h.offset,_=p<v,S=_?p:v,w=_?v:p,y=w-1;S!==y&&function(b){return!(fR(b)||Lq(b))}(m.getTextContent().slice(S,w))&&(u?h.set(h.key,y,h.type):d.set(d.key,y,d.type))}})(this,e)}}if(this.removeText(),e&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&Zn(n.getParent())&&n.getPreviousSibling()===null&&L6(this,n)}}deleteLine(e){this.isCollapsed()&&this.modify("extend",e,"lineboundary"),this.isCollapsed()?this.deleteCharacter(e):this.removeText()}deleteWord(e){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,e))return;this.modify("extend",e,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function Os(t){return t instanceof lv}function M6(t){const e=t.offset;if(t.type==="text")return e;const r=t.getNode();return e===r.getChildrenSize()?r.getTextContent().length:0}function ub(t){const e=t.getStartEndPoints();if(e===null)return[0,0];const[r,n]=e;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[M6(r),M6(n)]}function L6(t,e){for(let r=e;r;r=r.getParent()){if(Ke(r)){if(r.collapseAtStart(t))return!0;if(na(r))break}if(r.getPreviousSibling())break}return!1}const Lq=(()=>{try{const t=new RegExp("\\p{Emoji}","u"),e=t.test.bind(t);if(e("")&&e("#")&&e(""))return e}catch{}return()=>!1})();function I6(t,e,r){const n=t,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,o=0;for(let u=0;u<a;u++){const d=u===a-1;if(o=i,i+=s[u].length,e&&i===r||i>r||d){s.splice(u,1),d&&(o=void 0);break}}const l=s.join("").trim();l===""?n.remove():(n.setTextContent(l),n.select(o,o))}function B6(t,e,r,n){let s,a=e;if(Gr(t)){let i=!1;const o=t.childNodes,l=o.length,u=n._blockCursorElement;a===l&&(i=!0,a=l-1);let d=o[a],h=!1;if(d===u)d=o[a+1],h=!0;else if(u!==null){const m=u.parentNode;t===m&&e>Array.prototype.indexOf.call(m.children,u)&&a--}if(s=tf(d),gt(s))a=ec(s,i?"next":"previous");else{let m=tf(t);if(m===null)return null;if(Ke(m)){const x=n.getElementByKey(m.getKey());x===null&&ot(214),[m,a]=m.getDOMSlot(x).resolveChildIndex(m,x,t,e),Ke(m)||ot(215),i&&a>=m.getChildrenSize()&&(a=Math.max(0,m.getChildrenSize()-1));let v=m.getChildAtIndex(a);if(Ke(v)&&function(_,S,w){const y=_.getParent();return w===null||y===null||!y.canBeEmpty()||y!==w.getNode()}(v,0,r)){const _=i?v.getLastDescendant():v.getFirstDescendant();_===null?m=v:(v=_,m=Ke(v)?v:v.getParentOrThrow()),a=0}gt(v)?(s=v,m=null,a=ec(v,i?"next":"previous")):v!==m&&i&&!h&&(Ke(m)||ot(216),a=Math.min(m.getChildrenSize(),a+1))}else{const x=m.getIndexWithinParent();a=e===0&&Tr(m)&&tf(t)===m?x:x+1,m=m.getParentOrThrow()}if(Ke(m))return bo(m.__key,a,"element")}}else s=tf(t);return gt(s)?bo(s.__key,ec(s,a,"clamp"),"text"):null}function U6(t,e,r){const n=t.offset,s=t.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(e){if((r||!e)&&a===null&&Ke(i)&&i.isInline()){const o=i.getPreviousSibling();gt(o)&&t.set(o.__key,o.getTextContent().length,"text")}}else Ke(a)&&!r&&a.isInline()?t.set(a.__key,a.getChildrenSize(),"element"):gt(a)&&t.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(e&&Ke(a)&&a.isInline())t.set(a.__key,0,"element");else if((r||e)&&a===null&&Ke(i)&&i.isInline()&&!i.canInsertTextAfter()){const o=i.getNextSibling();gt(o)&&t.set(o.__key,0,"text")}}}function YD(t,e,r){if(t.type==="text"&&e.type==="text"){const n=t.isBefore(e),s=t.is(e);U6(t,n,s),U6(e,!n,s),s&&e.set(t.key,t.offset,t.type);const a=hn();if(a.isComposing()&&a._compositionKey!==t.key&&st(r)){const i=r.anchor,o=r.focus;t.set(i.key,i.offset,i.type,!0),e.set(o.key,o.offset,o.type,!0)}}}function JD(t,e,r,n,s,a){if(t===null||r===null||!Zg(s,t,r))return null;const i=B6(t,e,st(a)?a.anchor:null,s);if(i===null)return null;const o=B6(r,n,st(a)?a.focus:null,s);if(o===null)return null;if(i.type==="element"&&o.type==="element"){const l=tf(t),u=tf(r);if(Tr(l)&&Tr(u))return null}return YD(i,o,a),[i,o]}function db(t){return Ke(t)&&!t.isInline()}function QD(t,e,r,n,s,a){const i=Ec(),o=new Zu(bo(t,e,s),bo(r,n,a),0,"");return o.dirty=!0,i._selection=o,o}function cv(){const t=bo("root",0,"element"),e=bo("root",0,"element");return new Zu(t,e,0,"")}function qC(){return new lv(new Set)}function ZC(t,e,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,o=i==="selectionchange",l=!YS&&(o||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let u,d,h,m;if(st(t)&&!l)return t.clone();if(e===null)return null;if(u=e.anchorNode,d=e.focusNode,h=e.anchorOffset,m=e.focusOffset,o&&st(t)&&!Zg(r,u,d))return t.clone();const x=JD(u,h,d,m,r,t);if(x===null)return null;const[p,v]=x;return new Zu(p,v,st(t)?t.format:0,st(t)?t.style:"")}function mt(){return Ec()._selection}function ah(){return hn()._editorState._selection}function y1(t,e,r,n=1){const s=t.anchor,a=t.focus,i=s.getNode(),o=a.getNode();if(!e.is(i)&&!e.is(o))return;const l=e.__key;if(t.isCollapsed()){const u=s.offset;if(r<=u&&n>0||r<u&&n<0){const d=Math.max(0,u+n);s.set(l,d,"element"),a.set(l,d,"element"),$6(t)}}else{const u=t.isBackward(),d=u?a:s,h=d.getNode(),m=u?s:a,x=m.getNode();if(e.is(h)){const p=d.offset;(r<=p&&n>0||r<p&&n<0)&&d.set(l,Math.max(0,p+n),"element")}if(e.is(x)){const p=m.offset;(r<=p&&n>0||r<p&&n<0)&&m.set(l,Math.max(0,p+n),"element")}}$6(t)}function $6(t){const e=t.anchor,r=e.offset,n=t.focus,s=n.offset,a=e.getNode(),i=n.getNode();if(t.isCollapsed()){if(!Ke(a))return;const o=a.getChildrenSize(),l=r>=o,u=l?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(gt(u)){let d=0;l&&(d=u.getTextContentSize()),e.set(u.__key,d,"text"),n.set(u.__key,d,"text")}}else{if(Ke(a)){const o=a.getChildrenSize(),l=r>=o,u=l?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(gt(u)){let d=0;l&&(d=u.getTextContentSize()),e.set(u.__key,d,"text")}}if(Ke(i)){const o=i.getChildrenSize(),l=s>=o,u=l?i.getChildAtIndex(o-1):i.getChildAtIndex(s);if(gt(u)){let d=0;l&&(d=u.getTextContentSize()),n.set(u.__key,d,"text")}}}}function v1(t,e,r,n,s){let a=null,i=0,o=null;n!==null?(a=n.__key,gt(n)?(i=n.getTextContentSize(),o="text"):Ke(n)&&(i=n.getChildrenSize(),o="element")):s!==null&&(a=s.__key,gt(s)?o="text":Ke(s)&&(o="element")),a!==null&&o!==null?t.set(a,i,o):(i=e.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),t.set(r.__key,i,"element"))}function z6(t,e,r,n,s){t.type==="text"?t.set(r,t.offset+(e?0:s),"text"):t.offset>n.getIndexWithinParent()&&t.set(t.key,t.offset-1,"element")}function qD(t,e,r,n,s){try{t.setBaseAndExtent(e,r,n,s)}catch{}}function Iq(t,e,r,n,s,a,i){const o=n.anchorNode,l=n.focusNode,u=n.anchorOffset,d=n.focusOffset,h=document.activeElement;if(s.has(sR)&&h!==a||h!==null&&oT(h))return;if(!st(e))return void(t!==null&&Zg(r,o,l)&&n.removeAllRanges());const m=e.anchor,x=e.focus,p=m.key,v=x.key,_=Nu(r,p),S=Nu(r,v),w=m.offset,y=x.offset,b=e.format,E=e.style,N=e.isCollapsed();let F=_,T=S,P=!1;if(m.type==="text"){F=Lf(_);const q=m.getNode();P=q.getFormat()!==b||q.getStyle()!==E}else st(t)&&t.anchor.type==="text"&&(P=!0);var D,R,I,W,le;if(x.type==="text"&&(T=Lf(S)),F!==null&&T!==null&&(N&&(t===null||P||st(t)&&(t.format!==b||t.style!==E))&&(D=b,R=E,I=w,W=p,le=performance.now(),$D=[D,R,I,W,le]),u!==w||d!==y||o!==F||l!==T||n.type==="Range"&&N||(h!==null&&a.contains(h)||a.focus({preventScroll:!0}),m.type==="element"))){if(qD(n,F,w,T,y),!s.has(Gq)&&e.isCollapsed()&&a!==null&&a===document.activeElement){const q=st(e)&&e.anchor.type==="element"?F.childNodes[w]||null:n.rangeCount>0?n.getRangeAt(0):null;if(q!==null){let V;if(q instanceof Text){const K=document.createRange();K.selectNode(q),V=K.getBoundingClientRect()}else V=q.getBoundingClientRect();(function(K,U,L){const Z=pR(L),ne=hT(Z);if(Z===null||ne===null)return;let{top:z,bottom:Y}=U,J=0,te=0,de=L;for(;de!==null;){const ee=de===Z.body;if(ee)J=0,te=pi(K).innerHeight;else{const fe=de.getBoundingClientRect();J=fe.top,te=fe.bottom}let ge=0;if(z<J?ge=-(J-z):Y>te&&(ge=Y-te),ge!==0)if(ee)ne.scrollBy(0,ge);else{const fe=de.scrollTop;de.scrollTop+=ge;const ye=de.scrollTop-fe;z-=ye,Y-=ye}if(ee)break;de=em(de)}})(r,V,a)}}ob=!0}}function Bq(t){let e=mt()||ah();e===null&&(e=gn().selectEnd()),e.insertNodes(t)}function K2(t){let e=t;t.isCollapsed()||e.removeText();const r=mt();st(r)&&(e=r),st(e)||ot(161);const n=e.anchor;let s=n.getNode(),a=n.offset;for(;!oi(s);){const i=s;if([s,a]=Uq(s,a),i.is(s))break}return a}function Uq(t,e){const r=t.getParent();if(!r){const s=tn();return gn().append(s),s.select(),[gn(),0]}if(gt(t)){const s=t.splitText(e);if(s.length===0)return[r,t.getIndexWithinParent()];const a=e===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!Ke(t)||e===0)return[r,t.getIndexWithinParent()];const n=t.getChildAtIndex(e);if(n){const s=new Zu(bo(t.__key,e,"element"),bo(t.__key,e,"element"),0,""),a=t.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,t.getIndexWithinParent()+1]}function W6(t,e,r,n,s="decorators-and-blocks"){if(e==="move"&&n==="character"&&!t.isCollapsed()){const[d,h]=r===t.isBackward()?[t.focus,t.anchor]:[t.anchor,t.focus];return h.set(d.key,d.offset,d.type),!0}const a=cl(t.focus,r?"previous":"next"),i=n==="lineboundary",o=e==="move";let l=a,u=s==="decorators-and-blocks";if(!wR(l)){for(const d of l){u=!1;const{origin:h}=d;if(!Tr(h)||h.isIsolated()||(l=d,!i||!h.isInline()))break}if(u)for(const d of _T(a).iterNodeCarets(e==="extend"?"shadowRoot":"root")){if(wo(d))d.origin.isInline()||(l=d);else{if(Ke(d.origin))continue;Tr(d.origin)&&!d.origin.isInline()&&(l=d)}break}}if(l===a)return!1;if(o&&!i&&Tr(l.origin)&&l.origin.isKeyboardSelectable()){const d=qC();return d.add(l.origin.getKey()),Es(d),!0}return l=ui(l),o&&Du(t.anchor,l),Du(t.focus,l),u||!i}let us=null,ds=null,wa=!1,X2=!1,_x=0;const V6={characterData:!0,childList:!0,subtree:!0};function Jg(){return wa||us!==null&&us._readOnly}function _s(){wa&&ot(13)}function ZD(){_x>99&&ot(14)}function Ec(){return us===null&&ot(195,eR()),us}function hn(){return ds===null&&ot(196,eR()),ds}function eR(){let t=0;const e=new Set,r=fv.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=hv(s);if(lT(a))t++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),e.add(i)}}let n=` Detected on the page: ${t} compatible editor(s) with version ${r}`;return e.size&&(n+=` and incompatible editors with versions ${Array.from(e).join(", ")}`),n}function $q(){return ds}function G6(t,e,r){const n=e.__type,s=iR(t,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let o=0;o<i&&(a[o](e),e.isAttached());o++);}function H6(t,e){return t!==void 0&&t.__key!==e&&t.isAttached()}function tR(t,e){if(!e)return;const r=t._updateTags;let n=e;Array.isArray(e)||(n=[e]);for(const s of n)r.add(s)}function zq(t){return eT(t,hn()._nodes)}function eT(t,e){const r=t.type,n=e.get(r);n===void 0&&ot(17,r);const s=n.klass;t.type!==s.getType()&&ot(18,s.name);const a=s.importJSON(t),i=t.children;if(Ke(a)&&Array.isArray(i))for(let o=0;o<i.length;o++){const l=eT(i[o],e);a.append(l)}return a}function K6(t,e,r){const n=us,s=wa,a=ds;us=e,wa=!0,ds=t;try{return r()}finally{us=n,wa=s,ds=a}}function Go(t,e){const r=t._pendingEditorState,n=t._rootElement,s=t._headless||n===null;if(r===null)return;const a=t._editorState,i=a._selection,o=r._selection,l=t._dirtyType!==ku,u=us,d=wa,h=ds,m=t._updating,x=t._observer;let p=null;if(t._pendingEditorState=null,t._editorState=r,!s&&l&&x!==null){ds=t,us=r,wa=!1,t._updating=!0;try{const N=t._dirtyType,F=t._dirtyElements,T=t._dirtyLeaves;x.disconnect(),p=pq(a,r,t,N,F,T)}catch(N){if(N instanceof Error&&t._onError(N),X2)throw N;return aR(t,null,n,r),yD(t),t._dirtyType=Mf,X2=!0,Go(t,a),void(X2=!1)}finally{x.observe(n,V6),t._updating=m,us=u,wa=d,ds=h}}r._readOnly||(r._readOnly=!0);const v=t._dirtyLeaves,_=t._dirtyElements,S=t._normalizedNodes,w=t._updateTags,y=t._deferred;l&&(t._dirtyType=ku,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements=new Map,t._normalizedNodes=new Set,t._updateTags=new Set),function(N,F){const T=N._decorators;let P=N._pendingDecorators||T;const D=F._nodeMap;let R;for(R in P)D.has(R)||(P===T&&(P=uR(N)),delete P[R])}(t,r);const b=s?null:Vi(pi(t));if(t._editable&&b!==null&&(l||o===null||o.dirty)&&n!==null&&!w.has(Hq)){ds=t,us=r;try{if(x!==null&&x.disconnect(),l||o===null||o.dirty){const N=t._blockCursorElement;N!==null&&mb(N,t,n),Iq(i,o,t,b,w,n)}(function(N,F,T){let P=N._blockCursorElement;if(st(T)&&T.isCollapsed()&&T.anchor.type==="element"&&F.contains(document.activeElement)){const D=T.anchor,R=D.getNode(),I=D.offset;let W=!1,le=null;if(I===R.getChildrenSize())J2(R.getChildAtIndex(I-1))&&(W=!0);else{const q=R.getChildAtIndex(I);if(q!==null&&J2(q)){const V=q.getPreviousSibling();(V===null||J2(V))&&(W=!0,le=N.getElementByKey(q.__key))}}if(W){const q=N.getElementByKey(R.__key);return P===null&&(N._blockCursorElement=P=function(V){const K=V.theme,U=document.createElement("div");U.contentEditable="false",U.setAttribute("data-lexical-cursor","true");let L=K.blockCursor;if(L!==void 0){if(typeof L=="string"){const Z=hD(L);L=K.blockCursor=Z}L!==void 0&&U.classList.add(...L)}return U}(N._config)),F.style.caretColor="transparent",void(le===null?q.appendChild(P):q.insertBefore(P,le))}}P!==null&&mb(P,N,F)})(t,n,o)}finally{x!==null&&x.observe(n,V6),ds=h,us=u}}p!==null&&function(N,F,T,P,D){const R=Array.from(N._listeners.mutation),I=R.length;for(let W=0;W<I;W++){const[le,q]=R[W];for(const V of q){const K=F.get(V);K!==void 0&&le(K,{dirtyLeaves:P,prevEditorState:D,updateTags:T})}}}(t,p,w,v,a),st(o)||o===null||i!==null&&i.is(o)||t.dispatchCommand(CD,void 0);const E=t._pendingDecorators;E!==null&&(t._decorators=E,t._pendingDecorators=null,b0("decorator",t,!0,E)),function(N,F,T){const P=q6(F),D=q6(T);P!==D&&b0("textcontent",N,!0,D)}(t,e||a,r),b0("update",t,!0,{dirtyElements:_,dirtyLeaves:v,editorState:r,mutatedNodes:p,normalizedNodes:S,prevEditorState:e||a,tags:w}),function(N,F){if(N._deferred=[],F.length!==0){const T=N._updating;N._updating=!0;try{for(let P=0;P<F.length;P++)F[P]()}finally{N._updating=T}}}(t,y),function(N){const F=N._updates;if(F.length!==0){const T=F.shift();if(T){const[P,D]=T;uv(N,P,D)}}}(t)}function b0(t,e,r,...n){const s=e._updating;e._updating=r;try{const a=Array.from(e._listeners[t]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{e._updating=s}}function X6(t,e){const r=t._updates;let n=e||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,o=t._pendingEditorState;let l;i!==void 0&&(l=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(o===null&&ot(191),o._flushSync=!0),l&&t._deferred.push(l),tR(t,i.tag)),o==null?uv(t,a,i):a()}}return n}function uv(t,e,r){const n=t._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,tR(t,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&t._deferred.push(s);const o=t._editorState;let l=t._pendingEditorState,u=!1;(l===null||l._readOnly)&&(l=t._pendingEditorState=rR(l||o),u=!0),l._flushSync=i;const d=us,h=wa,m=ds,x=t._updating;us=l,wa=!1,t._updating=!0,ds=t;const p=t._headless||t.getRootElement()===null;aT(null);try{u&&(p?o._selection!==null&&(l._selection=o._selection.clone()):l._selection=function(w,y){const b=w.getEditorState()._selection,E=Vi(pi(w));return st(b)||b==null?ZC(b,E,w,y):b.clone()}(t,r&&r.event||null));const _=t._compositionKey;e(),a=X6(t,a),function(w,y){const b=y.getEditorState()._selection,E=w._selection;if(st(E)){const N=E.anchor,F=E.focus;let T;if(N.type==="text"&&(T=N.getNode(),T.selectionTransform(b,E)),F.type==="text"){const P=F.getNode();T!==P&&P.selectionTransform(b,E)}}}(l,t),t._dirtyType!==ku&&(a?function(w,y){const b=y._dirtyLeaves,E=w._nodeMap;for(const N of b){const F=E.get(N);gt(F)&&F.isAttached()&&F.isSimpleText()&&!F.isUnmergeable()&&k6(F)}}(l,t):function(w,y){const b=y._dirtyLeaves,E=y._dirtyElements,N=w._nodeMap,F=$l(),T=new Map;let P=b,D=P.size,R=E,I=R.size;for(;D>0||I>0;){if(D>0){y._dirtyLeaves=new Set;for(const W of P){const le=N.get(W);gt(le)&&le.isAttached()&&le.isSimpleText()&&!le.isUnmergeable()&&k6(le),le!==void 0&&H6(le,F)&&G6(y,le,T),b.add(W)}if(P=y._dirtyLeaves,D=P.size,D>0){_x++;continue}}y._dirtyLeaves=new Set,y._dirtyElements=new Map,R.delete("root")&&R.set("root",!0);for(const W of R){const le=W[0],q=W[1];if(E.set(le,q),!q)continue;const V=N.get(le);V!==void 0&&H6(V,F)&&G6(y,V,T)}P=y._dirtyLeaves,D=P.size,R=y._dirtyElements,I=R.size,_x++}y._dirtyLeaves=b,y._dirtyElements=E}(l,t),X6(t),function(w,y,b,E){const N=w._nodeMap,F=y._nodeMap,T=[];for(const[P]of E){const D=F.get(P);D!==void 0&&(D.isAttached()||(Ke(D)&&mD(D,P,N,F,T,E),N.has(P)||E.delete(P),T.push(P)))}for(const P of T)F.delete(P);for(const P of b){const D=F.get(P);D===void 0||D.isAttached()||(N.has(P)||b.delete(P),F.delete(P))}}(o,l,t._dirtyLeaves,t._dirtyElements)),_!==t._compositionKey&&(l._flushSync=!0);const S=l._selection;if(st(S)){const w=l._nodeMap,y=S.anchor.key,b=S.focus.key;w.get(y)!==void 0&&w.get(b)!==void 0||ot(19)}else Os(S)&&S._nodes.size===0&&(l._selection=null)}catch(_){return _ instanceof Error&&t._onError(_),t._pendingEditorState=o,t._dirtyType=Mf,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements.clear(),void Go(t)}finally{us=d,wa=h,ds=m,t._updating=x,_x=0}t._dirtyType!==ku||t._deferred.length>0||function(_,S){const w=S.getEditorState()._selection,y=_._selection;if(y!==null){if(y.dirty||!y.is(w))return!0}else if(w!==null)return!0;return!1}(l,t)?l._flushSync?(l._flushSync=!1,Go(t)):u&&Qq(()=>{Go(t)}):(l._flushSync=!1,u&&(n.clear(),t._deferred=[],t._pendingEditorState=null))}function Na(t,e,r){ds===t&&r===void 0?e():uv(t,e,r)}class k0{constructor(e,r,n){this.element=e,this.before=r||null,this.after=n||null}withBefore(e){return new k0(this.element,e,this.after)}withAfter(e){return new k0(this.element,this.before,e)}withElement(e){return this.element===e?this:new k0(e,this.before,this.after)}insertChild(e){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&ot(222),this.element.insertBefore(e,r),this}removeChild(e){return e.parentElement!==this.element&&ot(223),this.element.removeChild(e),this}replaceChild(e,r){return r.parentElement!==this.element&&ot(224),this.element.replaceChild(e,r),this}getFirstChild(){const e=this.after?this.after.nextSibling:this.element.firstChild;return e===this.before||e===this.getManagedLineBreak()?null:e}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(e){if(e===null)this.removeManagedLineBreak();else{const r=e==="decorator"&&(Of||lg);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const e=this.getManagedLineBreak();if(e){const r=this.element,n=e.nodeName==="IMG"?e.nextSibling:null;n&&r.removeChild(n),r.removeChild(e),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(e){const r=this.getManagedLineBreak();if(r){if(e===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),e){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let e=0;for(let r=this.after;r!==null;r=r.previousSibling)e++;return e}resolveChildIndex(e,r,n,s){if(n===this.element){const l=this.getFirstChildOffset();return[e,Math.min(l+e.getChildrenSize(),Math.max(l,s))]}const a=Y6(r,n);a.push(s);const i=Y6(r,this.element);let o=e.getIndexWithinParent();for(let l=0;l<i.length;l++){const u=a[l],d=i[l];if(u===void 0||u<d)break;if(u>d){o+=1;break}}return[e.getParentOrThrow(),o]}}function Y6(t,e){const r=[];let n=e;for(;n!==t&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==t&&ot(225),r.reverse()}class Gs extends nh{constructor(e){super(e),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(e){super.afterCloneFrom(e),this.__key===e.__key&&(this.__first=e.__first,this.__last=e.__last,this.__size=e.__size),this.__indent=e.__indent,this.__format=e.__format,this.__style=e.__style,this.__dir=e.__dir,this.__textFormat=e.__textFormat,this.__textStyle=e.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const e=this.getFormat();return nq[e]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const e=[];let r=this.getFirstChild();for(;r!==null;)e.push(r),r=r.getNextSibling();return e}getChildrenKeys(){const e=[];let r=this.getFirstChild();for(;r!==null;)e.push(r.__key),r=r.getNextSibling();return e}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const e=hn()._dirtyElements;return e!==null&&e.has(this.__key)}isLastChild(){const e=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(e)}getAllTextNodes(){const e=[];let r=this.getFirstChild();for(;r!==null;){if(gt(r)&&e.push(r),Ke(r)){const n=r.getAllTextNodes();e.push(...n)}r=r.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();for(;Ke(e);){const r=e.getFirstChild();if(r===null)break;e=r}return e}getLastDescendant(){let e=this.getLastChild();for(;Ke(e);){const r=e.getLastChild();if(r===null)break;e=r}return e}getDescendantByIndex(e){const r=this.getChildren(),n=r.length;if(e>=n){const a=r[n-1];return Ke(a)&&a.getLastDescendant()||a||null}const s=r[e];return Ke(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const e=this.getLatest().__first;return e===null?null:Vn(e)}getFirstChildOrThrow(){const e=this.getFirstChild();return e===null&&ot(45,this.__key),e}getLastChild(){const e=this.getLatest().__last;return e===null?null:Vn(e)}getLastChildOrThrow(){const e=this.getLastChild();return e===null&&ot(96,this.__key),e}getChildAtIndex(e){const r=this.getChildrenSize();let n,s;if(e<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=e;){if(s===e)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=e;){if(s===e)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let e="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];e+=a.getTextContent(),Ke(a)&&s!==n-1&&!a.isInline()&&(e+=ll)}return e}getTextContentSize(){let e=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];e+=a.getTextContentSize(),Ke(a)&&s!==n-1&&!a.isInline()&&(e+=ll.length)}return e}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(e){if(e!==""){const r=p6[e];return!!(this.getFormat()&r)}return!1}hasTextFormat(e){const r=Cu[e];return!!(this.getTextFormat()&r)}getFormatFlags(e,r){return _1(this.getLatest().__textFormat,e,r)}getTextStyle(){return this.getLatest().__textStyle}select(e,r){_s();const n=mt();let s=e,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(e===0&&r===0){const l=this.getFirstChild();if(gt(l)||Ke(l))return l.select(0,0)}else if(!(e!==void 0&&e!==i||r!==void 0&&r!==i)){const l=this.getLastChild();if(gt(l)||Ke(l))return l.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const o=this.__key;return st(n)?(n.anchor.set(o,s,"element"),n.focus.set(o,a,"element"),n.dirty=!0,n):QD(o,s,o,a,"element","element")}selectStart(){const e=this.getFirstDescendant();return e?e.selectStart():this.select()}selectEnd(){const e=this.getLastDescendant();return e?e.selectEnd():this.select()}clear(){const e=this.getWritable();return this.getChildren().forEach(r=>r.remove()),e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){const r=this.getWritable();return r.__dir=e,r}setFormat(e){return this.getWritable().__format=e!==""?p6[e]:0,this}setStyle(e){return this.getWritable().__style=e||"",this}setTextFormat(e){const r=this.getWritable();return r.__textFormat=e,r}setTextStyle(e){const r=this.getWritable();return r.__textStyle=e,r}setIndent(e){return this.getWritable().__indent=e,this}splice(e,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();e+r<=a||ot(226,String(e),String(r),String(a));const o=i.__key,l=[],u=[],d=this.getChildAtIndex(e+r);let h=null,m=a-r+s;if(e!==0)if(e===a)h=this.getLastChild();else{const p=this.getChildAtIndex(e);p!==null&&(h=p.getPreviousSibling())}if(r>0){let p=h===null?this.getFirstChild():h.getNextSibling();for(let v=0;v<r;v++){p===null&&ot(100);const _=p.getNextSibling(),S=p.__key;hu(p.getWritable()),u.push(S),p=_}}let x=h;for(let p=0;p<s;p++){const v=n[p];x!==null&&v.is(x)&&(h=x=x.getPreviousSibling());const _=v.getWritable();_.__parent===o&&m--,hu(_);const S=v.__key;if(x===null)i.__first=S,_.__prev=null;else{const w=x.getWritable();w.__next=S,_.__prev=w.__key}v.__key===o&&ot(76),_.__parent=o,l.push(S),x=v}if(e+r===a)x!==null&&(x.getWritable().__next=null,i.__last=x.__key);else if(d!==null){const p=d.getWritable();if(x!==null){const v=x.getWritable();p.__prev=x.__key,v.__next=d.__key}else p.__prev=null}if(i.__size=m,u.length){const p=mt();if(st(p)){const v=new Set(u),_=new Set(l),{anchor:S,focus:w}=p;J6(S,v,_)&&v1(S,S.getNode(),this,h,d),J6(w,v,_)&&v1(w,w.getNode(),this,h,d),m!==0||this.canBeEmpty()||na(this)||this.remove()}}return i}getDOMSlot(e){return new k0(e)}exportDOM(e){const{element:r}=super.exportDOM(e);if(Gr(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const e={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(e.textFormat=r),n!==""&&(e.textStyle=n),e}updateFromJSON(e){return super.updateFromJSON(e).setFormat(e.format).setIndent(e.indent).setDirection(e.direction).setTextFormat(e.textFormat||0).setTextStyle(e.textStyle||"")}insertNewAfter(e,r){return null}canIndent(){return!0}collapseAtStart(e){return!1}excludeFromCopy(e){return!1}canReplaceWith(e){return!0}canInsertAfter(e){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(e){return!1}extractWithChild(e,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(e,r){const n=this.getDOMSlot(e);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function Ke(t){return t instanceof Gs}function J6(t,e,r){let n=t.getNode();for(;n;){const s=n.__key;if(e.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class tT extends nh{decorate(e,r){ot(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function Tr(t){return t instanceof tT}class Qg extends Gs{static getType(){return"root"}static clone(){return new Qg}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){ot(51)}getTextContent(){const e=this.__cachedText;return!Jg()&&hn()._dirtyType!==ku||e===null?super.getTextContent():e}remove(){ot(52)}replace(e){ot(53)}insertBefore(e){ot(54)}insertAfter(e){ot(55)}updateDOM(e,r){return!1}splice(e,r,n){for(const s of n)Ke(s)||Tr(s)||ot(282);return super.splice(e,r,n)}static importJSON(e){return gn().updateFromJSON(e)}collapseAtStart(){return!0}}function Zn(t){return t instanceof Qg}function rR(t){return new dv(new Map(t._nodeMap))}function rT(){return new dv(new Map([["root",new Qg]]))}function nR(t){const e=t.exportJSON(),r=t.constructor;if(e.type!==r.getType()&&ot(130,r.name),Ke(t)){const n=e.children;Array.isArray(n)||ot(59,r.name);const s=t.getChildren();for(let a=0;a<s.length;a++){const i=nR(s[a]);n.push(i)}}return e}class dv{constructor(e,r){this._nodeMap=e,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(e,r){return K6(r&&r.editor||null,this,e)}clone(e){const r=new dv(this._nodeMap,e===void 0?this._selection:e);return r._readOnly=!0,r}toJSON(){return K6(null,this,()=>({root:nR(gn())}))}}const w1="historic",Wq="history-push",C0="history-merge",Vq="paste",sR="collaboration",Gq="skip-scroll-into-view",Hq="skip-dom-selection";class nT extends Gs{static getType(){return"artificial"}createDOM(e){return document.createElement("div")}}class qg extends Gs{static getType(){return"paragraph"}static clone(e){return new qg(e.__key)}createDOM(e){const r=document.createElement("p"),n=gf(e.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(e,r,n){return!1}static importDOM(){return{p:e=>({conversion:Kq,priority:0})}}exportDOM(e){const{element:r}=super.exportDOM(e);if(Gr(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(e){return tn().updateFromJSON(e)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(e,r){const n=tn();n.setTextFormat(e.format),n.setTextStyle(e.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const e=this.getChildren();if(e.length===0||gt(e[0])&&e[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function Kq(t){const e=tn();return t.style&&(e.setFormat(t.style.textAlign),mT(t,e)),{node:e}}function tn(){return oa(new qg)}function sT(t){return t instanceof qg}const yr=0,Rd=1,Xq=4;function aR(t,e,r,n){const s=t._keyToDOMMap;s.clear(),t._editorState=rT(),t._pendingEditorState=n,t._compositionKey=null,t._dirtyType=ku,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements.clear(),t._normalizedNodes=new Set,t._updateTags=new Set,t._updates=[],t._blockCursorElement=null;const a=t._observer;a!==null&&(a.disconnect(),t._observer=null),e!==null&&(e.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function Yq(t){const e=t||{},r=$q(),n=e.theme||{},s=t===void 0?r:e.parentEditor||null,a=e.disableEvents||!1,i=rT(),o=e.namespace||(s!==null?s._config.namespace:hR()),l=e.editorState,u=[Qg,Tc,Xg,Yg,qg,nT,...e.nodes||[]],{onError:d,html:h}=e,m=e.editable===void 0||e.editable;let x;if(t===void 0&&r!==null)x=r._nodes;else{x=new Map;for(let v=0;v<u.length;v++){let _=u[v],S=null,w=null;if(typeof _!="function"){const F=_;_=F.replace,S=F.with,w=F.withKlass||null}const{ownNodeConfig:y}=pT(_),b=_.getType(),E=_.transform(),N=new Set;y&&y.$transform&&N.add(y.$transform),E!==null&&N.add(E),x.set(b,{exportDOM:h&&h.export?h.export.get(_):void 0,klass:_,replace:S,replaceWithKlass:w,sharedNodeState:dq(u[v]),transforms:N})}}const p=new fv(i,s,x,{disableEvents:a,namespace:o,theme:n},d||console.error,function(v,_){const S=new Map,w=new Set,y=b=>{Object.keys(b).forEach(E=>{let N=S.get(E);N===void 0&&(N=[],S.set(E,N)),N.push(b[E])})};return v.forEach(b=>{const E=b.klass.importDOM;if(E==null||w.has(E))return;w.add(E);const N=E.call(b.klass);N!==null&&y(N)}),_&&y(_),S}(x,h?h.import:void 0),m,t);return l!==void 0&&(p._pendingEditorState=l,p._dirtyType=Mf),p}class fv{constructor(e,r,n,s,a,i,o,l){this._createEditorArgs=l,this._parentEditor=r,this._rootElement=null,this._editorState=e,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=ku,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=hR(),this._onError=a,this._htmlConversions=i,this._editable=o,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(e){const r=this._listeners.update;return r.add(e),()=>{r.delete(e)}}registerEditableListener(e){const r=this._listeners.editable;return r.add(e),()=>{r.delete(e)}}registerDecoratorListener(e){const r=this._listeners.decorator;return r.add(e),()=>{r.delete(e)}}registerTextContentListener(e){const r=this._listeners.textcontent;return r.add(e),()=>{r.delete(e)}}registerRootListener(e){const r=this._listeners.root;return e(this._rootElement,null),r.add(e),()=>{e(null,this._rootElement),r.delete(e)}}registerCommand(e,r,n){n===void 0&&ot(35);const s=this._commands;s.has(e)||s.set(e,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(e);a===void 0&&ot(36,String(e));const i=a[n];return i.add(r),()=>{i.delete(r),a.every(o=>o.size===0)&&s.delete(e)}}registerMutationListener(e,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(e)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const o=n&&n.skipInitialization;return o!==void 0&&o||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(e){const r=this._nodes.get(e.getType());return r===void 0&&ot(37,e.name),r}resolveRegisteredNodeAfterReplacements(e){for(;e.replaceWithKlass;)e=this.getRegisteredNode(e.replaceWithKlass);return e}initializeMutationListener(e,r){const n=this._editorState,s=aA(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&e(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(e,r){const n=this.getRegisteredNode(e);return n.transforms.add(r),n}registerNodeTransform(e,r){const n=this.registerNodeTransformToKlass(e,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return function(i,o){const l=aA(i.getEditorState()),u=[];for(const d of o){const h=l.get(d);h&&u.push(h)}u.length!==0&&i.update(()=>{for(const d of u)for(const h of d.keys()){const m=Vn(h);m&&m.markDirty()}},i._pendingEditorState===null?{tag:C0}:void 0)}(this,s.map(i=>i.klass.getType())),()=>{s.forEach(i=>i.transforms.delete(r))}}hasNode(e){return this._nodes.has(e.getType())}hasNodes(e){return e.every(this.hasNode.bind(this))}dispatchCommand(e,r){return kt(this,e,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const r=this._rootElement;if(e!==r){const n=gf(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=e,aR(this,r,e,s),r!==null&&(this._config.disableEvents||Aq(r),n!=null&&r.classList.remove(...n)),e!==null){const a=hT(e),i=e.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=Mf,yD(this),this._updateTags.add(C0),Go(this),this._config.disableEvents||function(o,l){const u=o.ownerDocument,d=x1.get(u);(d===void 0||d<1)&&u.addEventListener("selectionchange",HD),x1.set(u,(d||0)+1),o.__lexicalEditor=l;const h=GD(o);for(let m=0;m<ib.length;m++){const[x,p]=ib[m],v=typeof p=="function"?_=>{j6(_)||(F6(_),(l.isEditable()||x==="click")&&p(_,l))}:_=>{if(j6(_))return;F6(_);const S=l.isEditable();switch(x){case"cut":return S&&kt(l,JC,_);case"copy":return kt(l,iv,_);case"paste":return S&&kt(l,KC,_);case"dragstart":return S&&kt(l,LD,_);case"dragover":return S&&kt(l,ID,_);case"dragend":return S&&kt(l,bq,_);case"focus":return S&&kt(l,Tq,_);case"blur":return S&&kt(l,Eq,_);case"drop":return S&&kt(l,OD,_)}};o.addEventListener(x,v),h.push(()=>{o.removeEventListener(x,v)})}}(e,this),n!=null&&e.classList.add(...n)}else this._window=null,this._updateTags.add(C0),Go(this);b0("root",this,!1,e,r)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,r){e.isEmpty()&&ot(38);let n=e;n._readOnly&&(n=rR(e),n._selection=e._selection?e._selection.clone():null),xD(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),Go(this)),this._pendingEditorState=n,this._dirtyType=Mf,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||Go(this)}parseEditorState(e,r){return function(n,s,a){const i=rT(),o=us,l=wa,u=ds,d=s._dirtyElements,h=s._dirtyLeaves,m=s._cloneNotNeeded,x=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,us=i,wa=!1,ds=s,aT(null);try{const p=s._nodes;eT(n.root,p),a&&a(),i._readOnly=!0}catch(p){p instanceof Error&&s._onError(p)}finally{s._dirtyElements=d,s._dirtyLeaves=h,s._cloneNotNeeded=m,s._dirtyType=x,us=o,wa=l,ds=u}return i}(typeof e=="string"?JSON.parse(e):e,this,r)}read(e){return Go(this),this.getEditorState().read(e,{editor:this})}update(e,r){(function(n,s,a){n._updating?n._updates.push([s,a]):uv(n,s,a)})(this,e,r)}focus(e,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),Na(this,()=>{const s=mt(),a=gn();s!==null?s.dirty||Es(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),rZ("focus"),nZ(()=>{n.removeAttribute("autocapitalize"),e&&e()})}),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const e=this._rootElement;e!==null&&e.blur();const r=Vi(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(e){this._editable!==e&&(this._editable=e,b0("editable",this,!0,e))}toJSON(){return{editorState:this._editorState.toJSON()}}}fv.version="0.35.0+prod.esm";let fb=null;function aT(t){fb=t}let Jq=1;function iR(t,e){const r=iT(t,e);return r===void 0&&ot(30,e),r}function iT(t,e){return t._nodes.get(e)}const Qq=typeof queueMicrotask=="function"?queueMicrotask:t=>{Promise.resolve().then(t)};function Q6(t){return Tr(oc(t))}function oT(t){const e=document.activeElement;if(!Gr(e))return!1;const r=e.nodeName;return Tr(oc(t))&&(r==="INPUT"||r==="TEXTAREA"||e.contentEditable==="true"&&hv(e)==null)}function Zg(t,e,r){const n=t.getRootElement();try{return n!==null&&n.contains(e)&&n.contains(r)&&e!==null&&!oT(e)&&oR(e)===t}catch{return!1}}function lT(t){return t instanceof fv}function oR(t){let e=t;for(;e!=null;){const r=hv(e);if(lT(r))return r;e=em(e)}return null}function hv(t){return t?t.__lexicalEditor:null}function fu(t){return ov(t)||t.isToken()}function zo(t){return fu(t)||t.isSegmented()}function xl(t){return ih(t)&&t.nodeType===XQ}function qq(t){return ih(t)&&t.nodeType===YQ}function Lf(t){let e=t;for(;e!=null;){if(xl(e))return e;e=e.firstChild}return null}function _1(t,e,r){const n=Cu[e];if(r!==null&&(t&n)==(r&n))return t;let s=t^n;return e==="subscript"?s&=-65:e==="superscript"?s&=-33:e==="lowercase"?(s&=-513,s&=-1025):e==="uppercase"?(s&=-257,s&=-1025):e==="capitalize"&&(s&=-257,s&=-513),s}function lR(t){return gt(t)||qo(t)||Tr(t)}function Zq(t,e){const r=function(){const i=fb;return fb=null,i}();if((e=e||r&&r.__key)!=null)return void(t.__key=e);_s(),ZD();const n=hn(),s=Ec(),a=""+Jq++;s._nodeMap.set(a,t),Ke(t)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=gD,t.__key=a}function hu(t){const e=t.getParent();if(e!==null){const r=t.getWritable(),n=e.getWritable(),s=t.getPreviousSibling(),a=t.getNextSibling(),i=a!==null?a.__key:null,o=s!==null?s.__key:null,l=s!==null?s.getWritable():null,u=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=o),l!==null&&(l.__next=i),u!==null&&(u.__prev=o),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function S1(t){ZD();const e=t.getLatest(),r=e.__parent,n=Ec(),s=hn(),a=n._nodeMap,i=s._dirtyElements;r!==null&&function(l,u,d){let h=l;for(;h!==null;){if(d.has(h))return;const m=u.get(h);if(m===void 0)break;d.set(h,!1),h=m.__parent}}(r,a,i);const o=e.__key;s._dirtyType=gD,Ke(t)?i.set(o,!0):s._dirtyLeaves.add(o)}function Ss(t){_s();const e=hn(),r=e._compositionKey;if(t!==r){if(e._compositionKey=t,r!==null){const n=Vn(r);n!==null&&n.getWritable()}if(t!==null){const n=Vn(t);n!==null&&n.getWritable()}}}function $l(){return Jg()?null:hn()._compositionKey}function Vn(t,e){const r=(e||Ec())._nodeMap.get(t);return r===void 0?null:r}function cR(t,e){const r=gv(t,hn());return r!==void 0?Vn(r,e):null}function gv(t,e){return t[`__lexicalKey_${e._key}`]}function oc(t,e){let r=t;for(;r!=null;){const n=cR(r,e);if(n!==null)return n;r=em(r)}return null}function uR(t){const e=t._decorators,r=Object.assign({},e);return t._pendingDecorators=r,r}function q6(t){return t.read(()=>gn().getTextContent())}function gn(){return dR(Ec())}function dR(t){return t._nodeMap.get("root")}function Es(t){_s();const e=Ec();t!==null&&(t.dirty=!0,t.setCachedNodes(null)),e._selection=t}function tf(t){const e=hn(),r=function(n,s){let a=n;for(;a!=null;){const i=gv(a,s);if(i!==void 0)return i;a=em(a)}return null}(t,e);return r===null?t===e.getRootElement()?Vn("root"):null:Vn(r)}function fR(t){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(t)}function cT(t){const e=[];let r=t;for(;r!==null;)e.push(r),r=r._parentEditor;return e}function hR(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function gR(t){return xl(t)?t.nodeValue:null}function uT(t,e,r){const n=Vi(pi(e));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let o=gR(s);const l=oc(s);if(o!==null&&gt(l)){if(o===sv&&r){const u=r.length;o=r,a=u,i=u}o!==null&&dT(l,o,a,i,t)}}}function dT(t,e,r,n,s){let a=t;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let o=e;(i||s)&&e[e.length-1]===sv&&(o=e.slice(0,-1));const l=a.getTextContent();if(s||o!==l){if(o===""){if(Ss(null),lg||Of||l1)a.remove();else{const v=hn();setTimeout(()=>{v.update(()=>{a.isAttached()&&a.remove()})},20)}return}const u=a.getParent(),d=ah(),h=a.getTextContentSize(),m=$l(),x=a.getKey();if(a.isToken()||m!==null&&x===m&&!i||st(d)&&(u!==null&&!u.canInsertTextBefore()&&d.anchor.offset===0||d.anchor.key===t.__key&&d.anchor.offset===0&&!a.canInsertTextBefore()&&!i||d.focus.key===t.__key&&d.focus.offset===h&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const p=mt();if(!st(p)||r===null||n===null)return void Z6(a,o,p);if(p.setTextNodeRange(a,r,a,n),a.isSegmented()){const v=An(a.getTextContent());a.replace(v),a=v}Z6(a,o,p)}}}function Z6(t,e,r){if(t.setTextContent(e),st(r)){const n=t.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=ec(t,a.offset,"clamp"))}}}function Ip(t,e,r){const n=e[r]||!1;return n==="any"||n===t[r]}function eZ(t,e){return Ip(t,e,"altKey")&&Ip(t,e,"ctrlKey")&&Ip(t,e,"shiftKey")&&Ip(t,e,"metaKey")}function Fr(t,e,r){return eZ(t,r)&&t.key.toLowerCase()===e.toLowerCase()}const Uo={ctrlKey:!lo,metaKey:lo},eA={altKey:lo,ctrlKey:!lo};function tA(t){return t.key==="Backspace"}function rA(t){return Fr(t,"a",Uo)}function tZ(t){const e=gn();if(st(t)){const r=t.anchor,n=t.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),d1(t),t}{const r=e.select(0,e.getChildrenSize());return Es(d1(r)),r}}function gf(t,e){t.__lexicalClassNameCache===void 0&&(t.__lexicalClassNameCache={});const r=t.__lexicalClassNameCache,n=r[e];if(n!==void 0)return n;const s=t[e];if(typeof s=="string"){const a=hD(s);return r[e]=a,a}return s}function fT(t,e,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,o=e.get(a);o===void 0&&ot(33,a);const l=o.klass;let u=t.get(l);u===void 0&&(u=new Map,t.set(l,u));const d=u.get(i),h=d==="destroyed"&&s==="created";(d===void 0||h)&&u.set(i,h?"updated":s)}function nA(t,e,r){const n=t.getParent();let s=r,a=t;return n!==null&&(e&&r===0?(s=a.getIndexWithinParent(),a=n):e||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(e?s-1:s)}function hb(t,e){const r=t.offset;if(t.type==="element")return nA(t.getNode(),e,r);{const n=t.getNode();if(e&&r===0||!e&&r===n.getTextContentSize()){const s=e?n.getPreviousSibling():n.getNextSibling();return s===null?nA(n.getParentOrThrow(),e,n.getIndexWithinParent()+(e?0:1)):s}}return null}function mR(t){const e=pi(t).event,r=e&&e.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function kt(t,e,r){return function(n,s,a){const i=cT(n);for(let o=4;o>=0;o--)for(let l=0;l<i.length;l++){const u=i[l],d=u._commands.get(s);if(d!==void 0){const h=d[o];if(h!==void 0){const m=Array.from(h),x=m.length;let p=!1;if(Na(u,()=>{for(let v=0;v<x;v++)if(m[v](a,n))return void(p=!0)}),p)return p}}}return!1}(t,e,r)}function mv(t){return!Zn(t)&&!t.isLastChild()&&!t.isInline()}function Nu(t,e){const r=t._keyToDOMMap.get(e);return r===void 0&&ot(75,e),r}function em(t){const e=t.assignedSlot||t.parentElement;return pb(e)?e.host:e}function pR(t){return qq(t)?t:Gr(t)?t.ownerDocument:null}function rZ(t){_s(),hn()._updateTags.add(t)}function nZ(t){_s(),hn()._deferred.push(t)}function gb(t,e){let r=t.getParent();for(;r!==null;){if(r.is(e))return!0;r=r.getParent()}return!1}function hT(t){const e=pR(t);return e?e.defaultView:null}function pi(t){const e=t._window;return e===null&&ot(78),e}function sZ(t){return Ke(t)&&t.isInline()||Tr(t)&&t.isInline()}function aZ(t){let e=t.getParentOrThrow();for(;e!==null;){if(na(e))return e;e=e.getParentOrThrow()}return e}function na(t){return Zn(t)||Ke(t)&&t.isShadowRoot()}function oa(t){const e=hn(),r=t.getType(),n=iT(e,r);n===void 0&&ot(200,t.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(t),o=i.constructor;return a!==null?i instanceof a||ot(201,a.name,a.getType(),o.name,o.getType(),t.constructor.name,r):i instanceof t.constructor&&o!==t.constructor||ot(202,o.name,o.getType(),t.constructor.name,r),i.__key===t.__key&&ot(203,t.constructor.name,r,o.name,o.getType()),i}return t}function Y2(t,e){!Zn(t.getParent())||Ke(e)||Tr(e)||ot(99)}function iZ(t){const e=Vn(t);return e===null&&ot(63,t),e}function J2(t){return(Tr(t)||Ke(t)&&!t.canBeEmpty())&&!t.isInline()}function mb(t,e,r){r.style.removeProperty("caret-color"),e._blockCursorElement=null;const n=t.parentElement;n!==null&&n.removeChild(t)}function Vi(t){return Hi?(t||window).getSelection():null}function oZ(t){const e=hT(t);return e?e.getSelection():null}function xR(t){return Gr(t)&&t.tagName==="A"}function Gr(t){return ih(t)&&t.nodeType===KQ}function ih(t){return typeof t=="object"&&t!==null&&"nodeType"in t&&typeof t.nodeType=="number"}function pb(t){return ih(t)&&t.nodeType===JQ}function xb(t){const e=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return t.nodeName.match(e)!==null}function b1(t){const e=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return t.nodeName.match(e)!==null}function oi(t){if(Tr(t)&&!t.isInline())return!0;if(!Ke(t)||na(t))return!1;const e=t.getFirstChild(),r=e===null||qo(e)||gt(e)||e.isInline();return!t.isInline()&&t.canBeEmpty()!==!1&&r}function Q2(t,e){let r=t;for(;r!==null&&r.getParent()!==null&&!e(r);)r=r.getParentOrThrow();return e(r)?r:null}function tm(){return hn()}const sA=new WeakMap,lZ=new Map;function aA(t){if(!t._readOnly&&t.isEmpty())return lZ;t._readOnly||ot(192);let e=sA.get(t);return e||(e=function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let o=n.get(i);o||(o=new Map,n.set(i,o)),o.set(s,a)}return n}(t),sA.set(t,e)),e}function gT(t){const e=t.constructor.clone(t);return e.afterCloneFrom(t),e}function mT(t,e){const r=parseInt(t.style.paddingInlineStart,10)||0,n=Math.round(r/40);e.setIndent(n)}function cZ(t){t.__lexicalUnmanaged=!0}function uZ(t){return t.__lexicalUnmanaged===!0}function Hh(t,e){return function(r,n){return Object.prototype.hasOwnProperty.call(r,n)}(t,e)&&t[e]!==nh[e]}function pT(t){const e=x6 in t.prototype?t.prototype[x6]():void 0,r=function(i){return i===tT||i===Gs||i===nh}(t),n=!r&&Hh(t,"getType")?t.getType():void 0;let s,a=n;if(e)if(n)s=e[n];else for(const[i,o]of Object.entries(e))a=i,s=o;if(!r&&a&&(Hh(t,"getType")||(t.getType=()=>a),Hh(t,"clone")||(t.clone=i=>(aT(i),new t)),Hh(t,"importJSON")||(t.importJSON=s&&s.$importJSON||(i=>new t().updateFromJSON(i))),!Hh(t,"importDOM")&&s)){const{importDOM:i}=s;i&&(t.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function dZ(t){const e=tm();return _s(),new(e.resolveRegisteredNodeAfterReplacements(e.getRegisteredNode(t))).klass}const fZ={next:"previous",previous:"next"};class xT{constructor(e){this.origin=e}[Symbol.iterator](){return ST({hasNext:ju,initial:this.getAdjacentCaret(),map:e=>e,step:e=>e.getAdjacentCaret()})}getAdjacentCaret(){return Cs(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return Cs(this.origin,this.direction)}remove(){const e=this.getNodeAtCaret();return e&&e.remove(),this}replaceOrInsert(e,r){const n=this.getNodeAtCaret();return e.is(this.origin)||e.is(n)||(n===null?this.insert(e):n.replace(e,r)),this}splice(e,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),o=new Map;for(let l=a.getAdjacentCaret();l!==null&&o.size<e;l=l.getAdjacentCaret()){const u=l.origin.getWritable();o.set(u.getKey(),u)}for(const l of s){if(o.size>0){const u=a.getNodeAtCaret();if(u){if(o.delete(u.getKey()),o.delete(l.getKey()),!(u.is(l)||a.origin.is(l))){const d=l.getParent();d&&d.is(i)&&l.remove(),u.replace(l)}}else u===null&&ot(263,Array.from(o).join(" "))}else a.insert(l);a=Cs(l,this.direction)}for(const l of o.values())l.remove();return this}}class gg extends xT{constructor(){super(...arguments);Ya(this,"type","child")}getLatest(){const r=this.origin.getLatest();return r===this.origin?this:xi(r,this.direction)}getParentCaret(r="root"){return Cs(yT(this.getParentAtCaret(),r),this.direction)}getFlipped(){const r=oh(this.direction);return Cs(this.getNodeAtCaret(),r)||xi(this.origin,r)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(r){return r instanceof gg&&this.direction===r.direction&&this.origin.is(r.origin)}isSamePointCaret(r){return this.isSameNodeCaret(r)}}const hZ={root:Zn,shadowRoot:na};function oh(t){return fZ[t]}function yT(t,e="root"){return hZ[e](t)?null:t}class Au extends xT{constructor(){super(...arguments);Ya(this,"type","sibling")}getLatest(){const r=this.origin.getLatest();return r===this.origin?this:Cs(r,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return Ke(this.origin)?xi(this.origin,this.direction):null}getParentCaret(r="root"){return Cs(yT(this.getParentAtCaret(),r),this.direction)}getFlipped(){const r=oh(this.direction);return Cs(this.getNodeAtCaret(),r)||xi(this.origin.getParentOrThrow(),r)}isSamePointCaret(r){return r instanceof Au&&this.direction===r.direction&&this.origin.is(r.origin)}isSameNodeCaret(r){return(r instanceof Au||r instanceof Fu)&&this.direction===r.direction&&this.origin.is(r.origin)}}class Fu extends xT{constructor(r,n){super(r);Ya(this,"type","text");this.offset=n}getLatest(){const r=this.origin.getLatest();return r===this.origin?this:Pu(r,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(r="root"){return Cs(yT(this.getParentAtCaret(),r),this.direction)}getFlipped(){return Pu(this.origin,oh(this.direction),this.offset)}isSamePointCaret(r){return r instanceof Fu&&this.direction===r.direction&&this.origin.is(r.origin)&&this.offset===r.offset}isSameNodeCaret(r){return(r instanceof Au||r instanceof Fu)&&this.direction===r.direction&&this.origin.is(r.origin)}getSiblingCaret(){return Cs(this.origin,this.direction)}}function Zl(t){return t instanceof Fu}function ju(t){return t instanceof Au}function wo(t){return t instanceof gg}const gZ={next:class extends Fu{constructor(){super(...arguments);Ya(this,"direction","next")}getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends Fu{constructor(){super(...arguments);Ya(this,"direction","previous")}getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},mZ={next:class extends Au{constructor(){super(...arguments);Ya(this,"direction","next")}getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends Au{constructor(){super(...arguments);Ya(this,"direction","previous")}getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},pZ={next:class extends gg{constructor(){super(...arguments);Ya(this,"direction","next")}getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends gg{constructor(){super(...arguments);Ya(this,"direction","previous")}getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function Cs(t,e){return t?new mZ[e](t):null}function Pu(t,e,r){return t?new gZ[e](t,ec(t,r)):null}function ec(t,e,r="error"){const n=t.getTextContentSize();let s=e==="next"?n:e==="previous"?0:e;return(s<0||s>n)&&(r!=="clamp"&&function(a,...i){const o=new URL("https://lexical.dev/docs/error"),l=new URLSearchParams;l.append("code",a);for(const u of i)l.append("v",u);o.search=l.toString(),console.warn(`Minified Lexical warning #${a}; visit ${o.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(284,String(e),String(n),t.getKey()),s=s<0?0:n),s}function iA(t,e){return new yZ(t,e)}function xi(t,e){return Ke(t)?new pZ[e](t):null}function xZ(t){return t&&t.getChildCaret()||t}function vT(t){return t&&xZ(t.getAdjacentCaret())}class wT{constructor(e,r,n){Ya(this,"type","node-caret-range");this.anchor=e,this.focus=r,this.direction=n}getLatest(){const e=this.anchor.getLatest(),r=this.focus.getLatest();return e===this.anchor&&r===this.focus?this:new wT(e,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const e=s=>{const a=this[s].getLatest();return Zl(a)?function(i,o){const{direction:l,origin:u}=i,d=ec(u,o==="focus"?oh(l):l);return iA(i,d-i.offset)}(a,s):null},r=e("anchor"),n=e("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[iA(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(e="root"){const r=Zl(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=Zl(n),a=i=>i.isSameNodeCaret(n)?null:vT(i)||i.getParentCaret(e);return ST({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class yZ{constructor(e,r){Ya(this,"type","slice");this.caret=e,this.distance=r}getSliceIndices(){const{distance:e,caret:{offset:r}}=this,n=r+e;return n<r?[n,r]:[r,n]}getTextContent(){const[e,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(e,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:e,direction:r}}=this,[n,s]=this.getSliceIndices(),a=e.getTextContent();return Pu(e.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function _T(t){return lc(t,Cs(gn(),t.direction))}function vZ(t){return lc(t,t)}function lc(t,e){return t.direction!==e.direction&&ot(265),new wT(t,e,t.direction)}function ST(t){const{initial:e,hasNext:r,step:n,map:s}=t;let a=e;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function yR(t,e){const r=Sx(t.origin,e.origin);switch(r===null&&ot(275,t.origin.getKey(),e.origin.getKey()),r.type){case"same":{const n=t.type==="text",s=e.type==="text";return n&&s?function(a,i){return Math.sign(a-i)}(t.offset,e.offset):t.type===e.type?0:n?-1:s?1:t.type==="child"?-1:1}case"ancestor":return t.type==="child"?-1:1;case"descendant":return e.type==="child"?1:-1;case"branch":return vR(r)}}function vR(t){const{a:e,b:r}=t,n=e.__key,s=r.__key;let a=e,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function Bp(t,e){return e.is(t)}function oA(t){return Ke(t)?[t.getLatest(),null]:[t.getParent(),t.getLatest()]}function Sx(t,e){if(t.is(e))return{commonAncestor:t,type:"same"};const r=new Map;for(let[n,s]=oA(t);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=oA(e);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(Bp(t,n)||ot(276),{commonAncestor:n,type:"ancestor"}):s===null?(Bp(e,n)||ot(277),{commonAncestor:n,type:"descendant"}):((Ke(a)||Bp(t,a))&&(Ke(s)||Bp(e,s))&&n.is(a.getParent())&&n.is(s.getParent())||ot(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function cl(t,e){const{type:r,key:n,offset:s}=t,a=iZ(t.key);return r==="text"?(gt(a)||ot(266,a.getType(),n),Pu(a,e,s)):(Ke(a)||ot(267,a.getType(),n),SZ(a,t.offset,e))}function Du(t,e){const{origin:r,direction:n}=e,s=n==="next";Zl(e)?t.set(r.getKey(),e.offset,"text"):ju(e)?gt(r)?t.set(r.getKey(),ec(r,n),"text"):t.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(wo(e)&&Ke(r)||ot(268),t.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function wZ(t){const e=mt(),r=st(e)?e:cv();return bx(r,t),Es(r),r}function bx(t,e){Du(t.anchor,e.anchor),Du(t.focus,e.focus)}function lA(t){const{anchor:e,focus:r}=t,n=cl(e,"next"),s=cl(r,"next"),a=yR(n,s)<=0?"next":"previous";return lc(If(n,a),If(s,a))}function bT(t){const{direction:e,origin:r}=t,n=Cs(r,oh(e)).getNodeAtCaret();return n?Cs(n,e):xi(r.getParentOrThrow(),e)}function cA(t,e="root"){const r=[t];for(let n=wo(t)?t.getParentCaret(e):t.getSiblingCaret();n!==null;n=n.getParentCaret(e))r.push(bT(n));return r}function q2(t){return!!t&&t.origin.isAttached()}function _Z(t,e="removeEmptySlices"){if(t.isCollapsed())return t;const r="root",n="next";let s=e;const a=_R(t,n),i=cA(a.anchor,r),o=cA(a.focus.getFlipped(),r),l=new Set,u=[];for(const p of a.iterNodeCarets(r))if(wo(p))l.add(p.origin.getKey());else if(ju(p)){const{origin:v}=p;Ke(v)&&!l.has(v.getKey())||u.push(v)}for(const p of u)p.remove();for(const p of a.getTextSlices()){if(!p)continue;const{origin:v}=p.caret,_=v.getTextContentSize(),S=bT(Cs(v,n)),w=v.getMode();if(Math.abs(p.distance)===_&&s==="removeEmptySlices"||w==="token"&&p.distance!==0)S.remove();else if(p.distance!==0){s="removeEmptySlices";let y=p.removeTextSlice();const b=p.caret.origin;if(w==="segmented"){const E=y.origin,N=An(E.getTextContent()).setStyle(E.getStyle()).setFormat(E.getFormat());S.replaceOrInsert(N),y=Pu(N,n,y.offset)}b.is(i[0].origin)&&(i[0]=y),b.is(o[0].origin)&&(o[0]=y.getFlipped())}}let d,h;for(const p of i)if(q2(p)){d=ui(p);break}for(const p of o)if(q2(p)){h=ui(p);break}const m=function(p,v,_){if(!p||!v)return null;const S=p.getParentAtCaret(),w=v.getParentAtCaret();if(!S||!w)return null;const y=S.getParents().reverse();y.push(S);const b=w.getParents().reverse();b.push(w);const E=Math.min(y.length,b.length);let N;for(N=0;N<E&&y[N]===b[N];N++);const F=(D,R)=>{let I;for(let W=N;W<D.length;W++){const le=D[W];if(na(le))return;!I&&R(le)&&(I=le)}return I},T=F(y,oi),P=T&&F(b,D=>_.has(D.getKey())&&oi(D));return T&&P?[T,P]:null}(d,h,l);if(m){const[p,v]=m;xi(p,"previous").splice(0,v.getChildren()),v.remove()}const x=[d,h,...i,...o].find(q2);if(x)return vZ(If(ui(x),t.direction));ot(269,JSON.stringify(i.map(p=>p.origin.__key)))}function ui(t){const e=function(s){let a=s;for(;wo(a);){const i=vT(a);if(!wo(i))break;a=i}return a}(t.getLatest()),{direction:r}=e;if(gt(e.origin))return Zl(e)?e:Pu(e.origin,r,r);const n=e.getAdjacentCaret();return ju(n)&&gt(n.origin)?Pu(n.origin,r,oh(r)):e}function wR(t){return Zl(t)&&t.offset!==ec(t.origin,t.direction)}function If(t,e){return t.direction===e?t:t.getFlipped()}function _R(t,e){return t.direction===e?t:lc(If(t.focus,e),If(t.anchor,e))}function SZ(t,e,r){let n=xi(t,"next");for(let s=0;s<e;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return If(n,r)}const SR=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,bZ=SR?k.useLayoutEffect:k.useEffect,Up={tag:C0};function kZ({initialConfig:t,children:e}){const r=k.useMemo(()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:o,html:l}=t,u=VQ(null,n),d=Yq({editable:t.editable,html:l,namespace:s,nodes:a,onError:h=>i(h,d),theme:n});return function(h,m){if(m!==null){if(m===void 0)h.update(()=>{const x=gn();if(x.isEmpty()){const p=tn();x.append(p);const v=SR?document.activeElement:null;(mt()!==null||v!==null&&v===h.getRootElement())&&p.select()}},Up);else if(m!==null)switch(typeof m){case"string":{const x=h.parseEditorState(m);h.setEditorState(x,Up);break}case"object":h.setEditorState(m,Up);break;case"function":h.update(()=>{gn().isEmpty()&&m(h)},Up)}}}(d,o),[d,u]},[]);return bZ(()=>{const n=t.editable,[s]=r;s.setEditable(n===void 0||n)},[]),c.jsx(nv.Provider,{value:r,children:e})}const CZ=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?k.useLayoutEffect:k.useEffect;function TZ(t){return{initialValueFn:()=>t.isEditable(),subscribe:e=>t.registerEditableListener(e)}}function EZ(){return function(t){const[e]=To(),r=k.useMemo(()=>t(e),[e,t]),[n,s]=k.useState(()=>r.initialValueFn()),a=k.useRef(n);return CZ(()=>{const{initialValueFn:i,subscribe:o}=r,l=i();return a.current!==l&&(a.current=l,s(l)),o(u=>{a.current=u,s(u)})},[r,t]),n}(TZ)}function NZ(){return gn().getTextContent()}function AZ(t,e=!0){if(t)return!1;let r=NZ();return e&&(r=r.trim()),r===""}function FZ(t){if(!AZ(t,!1))return!1;const e=gn().getChildren(),r=e.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=e[n];if(Tr(s))return!1;if(Ke(s)){if(!sT(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let o=0;o<i;o++){const l=a[n];if(!gt(l))return!1}}}return!0}function bR(t){return()=>FZ(t)}const yb=new Map;function kR(t){const e={};if(!t)return e;const r=t.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(e[s.trim()]=a.trim())}return e}function uA(t){let e=yb.get(t);return e===void 0&&(e=kR(t),yb.set(t,e)),e}function CR(t){const e=tm().getElementByKey(t.getKey());if(e===null)return null;const r=e.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(e)}function TR(t){return CR(Zn(t)?t:t.getParentOrThrow())}function dA(t){const e=TR(t);return e!==null&&e.direction==="rtl"}function ER(t,e){const r=t.getStartEndPoints();if(e.isSelected(t)&&!zo(e)&&r!==null){const[n,s]=r,a=t.isBackward(),i=n.getNode(),o=s.getNode(),l=e.is(i),u=e.is(o);if(l||u){const[d,h]=ub(t),m=i.is(o),x=e.is(a?o:i),p=e.is(a?i:o);let v,_=0;m?(_=d>h?h:d,v=d>h?d:h):x?(_=a?h:d,v=void 0):p&&(_=0,v=a?d:h),e.__text=e.__text.slice(_,v)}}return e}function jZ(t){const e=t.getStyle(),r=kR(e);yb.set(e,r)}function PZ(t,e){const r=t.getFormatType(),n=t.getIndent();r!==e.getFormatType()&&e.setFormat(r),n!==e.getIndent()&&e.setIndent(n)}function Z2(t,e,r=PZ){if(t===null)return;const n=t.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,o]=n;a=cv(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(o.key,o.offset,o.type);const l=e_(i.getNode(),oi),u=e_(o.getNode(),oi);Ke(l)&&s.set(l.getKey(),l),Ke(u)&&s.set(u.getKey(),u)}for(const i of t.getNodes())if(Ke(i)&&oi(i))s.set(i.getKey(),i);else if(n===null){const o=e_(i,oi);Ke(o)&&s.set(o.getKey(),o)}for(const[i,o]of s){const l=e();r(o,l),o.replace(l,!0),a&&(i===a.anchor.key&&a.anchor.set(l.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(l.getKey(),a.focus.offset,a.focus.type))}a&&t.is(mt())&&Es(a)}function NR(t){const e=AR(t);return e!==null&&e.writingMode==="vertical-rl"}function AR(t){const e=t.anchor.getNode();return Ke(e)?CR(e):TR(e)}function fA(t,e){let r=NR(t)?!e:e;FR(t)&&(r=!r);const n=cl(t.focus,r?"previous":"next");if(wR(n))return!1;for(const s of _T(n)){if(wo(s))return!s.origin.isInline();if(!Ke(s.origin)){if(Tr(s.origin))return!0;break}}return!1}function DZ(t,e,r,n){t.modify(e?"extend":"move",r,n)}function FR(t){const e=AR(t);return e!==null&&e.direction==="rtl"}function hA(t,e,r){const n=FR(t);let s;s=NR(t)||n?!r:r,DZ(t,e,s,"character")}function e_(t,e){let r=t;for(;r!==null&&r.getParent()!==null&&!e(r);)r=r.getParentOrThrow();return e(r)?r:null}function RZ(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const jR=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,OZ=jR&&"documentMode"in document?document.documentMode:null;!(!jR||!("InputEvent"in window)||OZ)&&"getTargetRanges"in new window.InputEvent("input");function PR(...t){const e=[];for(const r of t)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))e.push(n);return e}function ed(...t){return()=>{for(let e=t.length-1;e>=0;e--)t[e]();t.length=0}}function Jn(t,...e){const r=PR(...e);r.length>0&&t.classList.add(...r)}function tc(t,...e){const r=PR(...e);r.length>0&&t.classList.remove(...r)}function MZ(t){return t?t.getAdjacentCaret():null}function LZ(t,e){let r=t;for(;r!=null;){if(r instanceof e)return r;r=r.getParent()}return null}function IZ(t){const e=pv(t,r=>Ke(r)&&!r.isInline());return Ke(e)||RZ(4,t.__key),e}const pv=(t,e)=>{let r=t;for(;r!==gn()&&r!=null;){if(e(r))return r;r=r.getParent()}return null};function nu(t,e){return t!==null&&Object.getPrototypeOf(t).constructor.name===e.name}function DR(t,e){const r=[],n=Array.from(t).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(e(s))r.push(s);else if(Ke(s))for(const a of BZ(s))n.push(a);return r}function BZ(t){return UZ(xi(t,"previous"))}function UZ(t){return ST({hasNext:ju,initial:t.getAdjacentCaret(),map:e=>e.origin.getLatest(),step:e=>e.getAdjacentCaret()})}function $Z(t){const e=window.location.origin,r=n=>{if(n.origin!==e)return;const s=t.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const o=i.payload;if(o&&o.functionId==="makeChanges"){const l=o.args;if(l){const[u,d,h,m,x,p]=l;t.update(()=>{const v=mt();if(st(v)){const _=v.anchor;let S=_.getNode(),w=0,y=0;if(gt(S)&&u>=0&&d>=0&&(w=u,y=u+d,v.setTextNodeRange(S,w,S,y)),w===y&&h===""||(v.insertRawText(h),S=_.getNode()),gt(S)){w=m,y=m+x;const b=S.getTextContentSize();w=w>b?b:w,y=y>b?b:y,v.setTextNodeRange(S,w,S,y)}n.stopImmediatePropagation()}})}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function zZ(t,e){const r=e.body?e.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!OR.has(i.nodeName)){const o=MR(i,t,s,!1);o!==null&&(n=n.concat(o))}}return function(a){for(const i of a)i.getNextSibling()instanceof nT&&i.insertAfter(So());for(const i of a){const o=i.getChildren();for(const l of o)i.insertBefore(l);i.remove()}}(s),n}function WZ(t,e){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=gn().getChildren();for(let s=0;s<n.length;s++)RR(t,n[s],r,e);return r.innerHTML}function RR(t,e,r,n=null){let s=n===null||e.isSelected(n);const a=Ke(e)&&e.excludeFromCopy("html");let i=e;if(n!==null){let x=gT(e);x=gt(x)&&n!==null?ER(n,x):x,i=x}const o=Ke(i)?i.getChildren():[],l=iT(t,i.getType());let u;u=l&&l.exportDOM!==void 0?l.exportDOM(t,i):i.exportDOM(t);const{element:d,after:h}=u;if(!d)return!1;const m=document.createDocumentFragment();for(let x=0;x<o.length;x++){const p=o[x],v=RR(t,p,m,n);!s&&Ke(e)&&v&&e.extractWithChild(p,n,"html")&&(s=!0)}if(s&&!a){if((Gr(d)||pb(d))&&d.append(m),r.append(d),h){const x=h.call(i,d);x&&(pb(d)?d.replaceChildren(x):d.replaceWith(x))}}else r.append(m);return s}const OR=new Set(["STYLE","SCRIPT"]);function MR(t,e,r,n,s=new Map,a){let i=[];if(OR.has(t.nodeName))return i;let o=null;const l=function(p,v){const{nodeName:_}=p,S=v._htmlConversions.get(_.toLowerCase());let w=null;if(S!==void 0)for(const y of S){const b=y(p);b!==null&&(w===null||(w.priority||0)<=(b.priority||0))&&(w=b)}return w!==null?w.conversion:null}(t,e),u=l?l(t):null;let d=null;if(u!==null){d=u.after;const p=u.node;if(o=Array.isArray(p)?p[p.length-1]:p,o!==null){for(const[,v]of s)if(o=v(o,a),!o)break;o&&i.push(...Array.isArray(p)?p:[o])}u.forChild!=null&&s.set(t.nodeName,u.forChild)}const h=t.childNodes;let m=[];const x=(o==null||!na(o))&&(o!=null&&db(o)||n);for(let p=0;p<h.length;p++)m.push(...MR(h[p],e,r,x,new Map(s),o));return d!=null&&(m=d(m)),b1(t)&&(m=VZ(t,m,x?()=>{const p=new nT;return r.push(p),p}:tn)),o==null?m.length>0?i=i.concat(m):b1(t)&&function(p){return p.nextSibling==null||p.previousSibling==null?!1:xb(p.nextSibling)&&xb(p.previousSibling)}(t)&&(i=i.concat(So())):Ke(o)&&o.append(...m),i}function VZ(t,e,r){const n=t.style.textAlign,s=[];let a=[];for(let i=0;i<e.length;i++){const o=e[i];if(db(o))n&&!o.getFormat()&&o.setFormat(n),s.push(o);else if(a.push(o),i===e.length-1||i<e.length-1&&db(e[i+1])){const l=r();l.setFormat(n),l.append(...a),s.push(l),a=[]}}return s}function k1(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function GZ(t,e=mt()){return e==null&&k1(166),st(e)&&e.isCollapsed()||e.getNodes().length===0?"":WZ(t,e)}function HZ(t,e=mt()){return e==null&&k1(166),st(e)&&e.isCollapsed()||e.getNodes().length===0?null:JSON.stringify(KZ(t,e))}function gA(t,e,r){const n=t.getData("application/x-lexical-editor");if(n)try{const o=JSON.parse(n);if(o.namespace===r._config.namespace&&Array.isArray(o.nodes))return mA(r,XZ(o.nodes),e)}catch{}const s=t.getData("text/html"),a=t.getData("text/plain");if(s&&a!==s)try{const o=new DOMParser().parseFromString(function(l){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:u=>u}).createHTML(l):l}(s),"text/html");return mA(r,zZ(r,o),e)}catch{}const i=a||t.getData("text/uri-list");if(i!=null)if(st(e)){const o=i.split(/(\r?\n|\t)/);o[o.length-1]===""&&o.pop();for(let l=0;l<o.length;l++){const u=mt();if(st(u)){const d=o[l];d===`
`||d===`\r
`?u.insertParagraph():d==="	"?u.insertNodes([sh()]):u.insertText(d)}}}else e.insertRawText(i)}function mA(t,e,r){t.dispatchCommand(xq,{nodes:e,selection:r})||(r.insertNodes(e),function(n){if(st(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=cl(s,"previous");if(i)if(Zl(i))a=i.origin;else{const o=lc(i,xi(gn(),"next").getFlipped());for(const l of o){if(gt(l.origin)){a=l.origin;break}if(Ke(l.origin)&&!l.origin.isInline())break}}if(a&&gt(a)){const o=a.getFormat(),l=a.getStyle();n.format===o&&n.style===l||(n.format=o,n.style=l,n.dirty=!0)}}}(r))}function LR(t,e,r,n=[]){let s=e===null||r.isSelected(e);const a=Ke(r)&&r.excludeFromCopy("html");let i=r;if(e!==null){let u=gT(r);u=gt(u)&&e!==null?ER(e,u):u,i=u}const o=Ke(i)?i.getChildren():[],l=function(u){const d=u.exportJSON(),h=u.constructor;if(d.type!==h.getType()&&k1(58,h.name),Ke(u)){const m=d.children;Array.isArray(m)||k1(59,h.name)}return d}(i);if(gt(i)){const u=i.__text;u.length>0?l.text=u:s=!1}for(let u=0;u<o.length;u++){const d=o[u],h=LR(t,e,d,l.children);!s&&Ke(r)&&h&&r.extractWithChild(d,e,"clone")&&(s=!0)}if(s&&!a)n.push(l);else if(Array.isArray(l.children))for(let u=0;u<l.children.length;u++){const d=l.children[u];n.push(d)}return s}function KZ(t,e){const r=[],n=gn().getChildren();for(let s=0;s<n.length;s++)LR(t,e,n[s],r);return{namespace:t._config.namespace,nodes:r}}function XZ(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r],s=zq(n);gt(s)&&jZ(s),e.push(s)}return e}let Td=null;async function pA(t,e,r){if(Td!==null)return!1;if(e!==null)return new Promise((u,d)=>{t.update(()=>{u(xA(t,e,r))})});const n=t.getRootElement(),s=t._window||window,a=window.document,i=Vi(s);if(n===null||i===null)return!1;const o=a.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(a.createTextNode("#")),n.append(o);const l=new Range;return l.setStart(o,0),l.setEnd(o,1),i.removeAllRanges(),i.addRange(l),new Promise((u,d)=>{const h=t.registerCommand(iv,m=>(nu(m,ClipboardEvent)&&(h(),Td!==null&&(window.clearTimeout(Td),Td=null),u(xA(t,m,r))),!0),Xq);Td=window.setTimeout(()=>{h(),Td=null,u(!1)},50),a.execCommand("copy"),o.remove()})}function xA(t,e,r){if(r===void 0){const s=Vi(t._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!Zg(t,a,i))return!1;const o=mt();if(o===null)return!1;r=JZ(o)}e.preventDefault();const n=e.clipboardData;return n!==null&&(QZ(n,r),!0)}const YZ=[["text/html",GZ],["application/x-lexical-editor",HZ]];function JZ(t=mt()){const e={"text/plain":t?t.getTextContent():""};if(t){const r=tm();for(const[n,s]of YZ){const a=s(r,t);a!==null&&(e[n]=a)}}return e}function QZ(t,e){for(const r in e){const n=e[r];n!==void 0&&t.setData(r,n)}}function yA(t,e){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(t,e);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(t,e);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const lh=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,qZ=lh&&"documentMode"in document?document.documentMode:null,ZZ=!(!lh||!("InputEvent"in window)||qZ)&&"getTargetRanges"in new window.InputEvent("input"),eee=lh&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),vA=lh&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,tee=lh&&/^(?=.*Chrome).*/i.test(navigator.userAgent),ree=lh&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!tee,wA=Ut("DRAG_DROP_PASTE_FILE");let xv=class IR extends Gs{static getType(){return"quote"}static clone(e){return new IR(e.__key)}createDOM(e){const r=document.createElement("blockquote");return Jn(r,e.theme.quote),r}updateDOM(e,r){return!1}static importDOM(){return{blockquote:e=>({conversion:nee,priority:0})}}exportDOM(e){const{element:r}=super.exportDOM(e);if(Gr(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(e){return yv().updateFromJSON(e)}insertNewAfter(e,r){const n=tn(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const e=tn();return this.getChildren().forEach(r=>e.append(r)),this.replace(e),!0}canMergeWhenEmpty(){return!0}};function yv(){return oa(new xv)}function _A(t){return t instanceof xv}let vv=class BR extends Gs{static getType(){return"heading"}static clone(e){return new BR(e.__tag,e.__key)}constructor(e,r){super(r),this.__tag=e}getTag(){return this.__tag}setTag(e){const r=this.getWritable();return this.__tag=e,r}createDOM(e){const r=this.__tag,n=document.createElement(r),s=e.theme.heading;if(s!==void 0){const a=s[r];Jn(n,a)}return n}updateDOM(e,r,n){return e.__tag!==this.__tag}static importDOM(){return{h1:e=>({conversion:Ed,priority:0}),h2:e=>({conversion:Ed,priority:0}),h3:e=>({conversion:Ed,priority:0}),h4:e=>({conversion:Ed,priority:0}),h5:e=>({conversion:Ed,priority:0}),h6:e=>({conversion:Ed,priority:0}),p:e=>{const r=e.firstChild;return r!==null&&SA(r)?{conversion:()=>({node:null}),priority:3}:null},span:e=>SA(e)?{conversion:r=>({node:su("h1")}),priority:3}:null}}exportDOM(e){const{element:r}=super.exportDOM(e);if(Gr(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(e){return su(e.tag).updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTag(e.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(e,r=!0){const n=e?e.anchor.offset:0,s=this.getLastDescendant(),a=!s||e&&e.anchor.key===s.getKey()&&n===s.getTextContentSize()||!e?tn():su(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&e){const o=tn();o.select(),this.replace(o,!0)}return a}collapseAtStart(){const e=this.isEmpty()?tn():su(this.getTag());return this.getChildren().forEach(r=>e.append(r)),this.replace(e),!0}extractWithChild(){return!0}};function SA(t){return t.nodeName.toLowerCase()==="span"&&t.style.fontSize==="26pt"}function Ed(t){const e=t.nodeName.toLowerCase();let r=null;return e!=="h1"&&e!=="h2"&&e!=="h3"&&e!=="h4"&&e!=="h5"&&e!=="h6"||(r=su(e),t.style!==null&&(mT(t,r),r.setFormat(t.style.textAlign))),{node:r}}function nee(t){const e=yv();return t.style!==null&&(e.setFormat(t.style.textAlign),mT(t,e)),{node:e}}function su(t="h1"){return oa(new vv(t))}function see(t){return t instanceof vv}function $p(t){let e=null;if(nu(t,DragEvent)?e=t.dataTransfer:nu(t,ClipboardEvent)&&(e=t.clipboardData),e===null)return[!1,[],!1];const r=e.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(e.files),s]}function bA(t){const e=mt();if(!st(e))return!1;const r=new Set,n=e.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const o=pv(a,u=>Ke(u)&&!u.isInline());if(o===null)continue;const l=o.getKey();o.canIndent()&&!r.has(l)&&(r.add(l),t(o))}return r.size>0}function kA(t){const e=oc(t);return Tr(e)}function t_(t){for(const e of["lowercase","uppercase","capitalize"])t.hasFormat(e)&&t.toggleFormat(e)}function aee(t){return ed(t.registerCommand(HC,e=>{const r=mt();return!!Os(r)&&(r.clear(),!0)},yr),t.registerCommand(du,e=>{const r=mt();return st(r)?(r.deleteCharacter(e),!0):!!Os(r)&&(r.deleteNodes(),!0)},yr),t.registerCommand(fg,e=>{const r=mt();return!!st(r)&&(r.deleteWord(e),!0)},yr),t.registerCommand(hg,e=>{const r=mt();return!!st(r)&&(r.deleteLine(e),!0)},yr),t.registerCommand(ff,e=>{const r=mt();if(typeof e=="string")r!==null&&r.insertText(e);else{if(r===null)return!1;const n=e.dataTransfer;if(n!=null)gA(n,r,t);else if(st(r)){const s=e.data;return s&&r.insertText(s),!0}}return!0},yr),t.registerCommand(nb,()=>{const e=mt();return!!st(e)&&(e.removeText(),!0)},yr),t.registerCommand(ci,e=>{const r=mt();return!!st(r)&&(r.formatText(e),!0)},yr),t.registerCommand(MD,e=>{const r=mt();if(!st(r)&&!Os(r))return!1;const n=r.getNodes();for(const s of n){const a=pv(s,i=>Ke(i)&&!i.isInline());a!==null&&a.setFormat(e)}return!0},yr),t.registerCommand(df,e=>{const r=mt();return!!st(r)&&(r.insertLineBreak(e),!0)},yr),t.registerCommand(dg,()=>{const e=mt();return!!st(e)&&(e.insertParagraph(),!0)},yr),t.registerCommand(_q,()=>(Bq([sh()]),!0),yr),t.registerCommand(Sq,()=>bA(e=>{const r=e.getIndent();e.setIndent(r+1)}),yr),t.registerCommand(E6,()=>bA(e=>{const r=e.getIndent();r>0&&e.setIndent(Math.max(0,r-1))}),yr),t.registerCommand(ND,e=>{const r=mt();if(Os(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(st(r)){const n=hb(r.focus,!0);if(!e.shiftKey&&Tr(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),e.preventDefault(),!0}return!1},yr),t.registerCommand(AD,e=>{const r=mt();if(Os(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(st(r)){if(function(s){const a=s.focus;return a.key==="root"&&a.offset===gn().getChildrenSize()}(r))return e.preventDefault(),!0;const n=hb(r.focus,!1);if(!e.shiftKey&&Tr(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),e.preventDefault(),!0}return!1},yr),t.registerCommand(ED,e=>{const r=mt();if(Os(r)){const n=r.getNodes();if(n.length>0)return e.preventDefault(),dA(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!st(r))return!1;if(fA(r,!0)){const n=e.shiftKey;return e.preventDefault(),hA(r,n,!0),!0}return!1},yr),t.registerCommand(TD,e=>{const r=mt();if(Os(r)){const s=r.getNodes();if(s.length>0)return e.preventDefault(),dA(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!st(r))return!1;const n=e.shiftKey;return!!fA(r,!1)&&(e.preventDefault(),hA(r,n,!1),!0)},yr),t.registerCommand(jD,e=>{if(kA(e.target))return!1;const r=mt();if(st(r)){if(function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(Zn(a))return!1;const i=IZ(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))}(r))return e.preventDefault(),t.dispatchCommand(E6,void 0);if(vA&&navigator.language==="ko-KR")return!1}else if(!Os(r))return!1;return e.preventDefault(),t.dispatchCommand(du,!0)},yr),t.registerCommand(DD,e=>{if(kA(e.target))return!1;const r=mt();return!(!st(r)&&!Os(r))&&(e.preventDefault(),t.dispatchCommand(du,!1))},yr),t.registerCommand(p1,e=>{const r=mt();if(!st(r))return!1;if(t_(r),e!==null){if((vA||eee||ree)&&ZZ)return!1;if(e.preventDefault(),e.shiftKey)return t.dispatchCommand(df,!1)}return t.dispatchCommand(dg,void 0)},yr),t.registerCommand(PD,()=>{const e=mt();return!!st(e)&&(t.blur(),!0)},yr),t.registerCommand(OD,e=>{const[,r]=$p(e);if(r.length>0){const s=yA(e.clientX,e.clientY);if(s!==null){const{offset:a,node:i}=s,o=oc(i);if(o!==null){const l=cv();if(gt(o))l.anchor.set(o.getKey(),a,"text"),l.focus.set(o.getKey(),a,"text");else{const d=o.getParentOrThrow().getKey(),h=o.getIndexWithinParent()+1;l.anchor.set(d,h,"element"),l.focus.set(d,h,"element")}const u=d1(l);Es(u)}t.dispatchCommand(wA,r)}return e.preventDefault(),!0}const n=mt();return!!st(n)},yr),t.registerCommand(LD,e=>{const[r]=$p(e),n=mt();return!(r&&!st(n))},yr),t.registerCommand(ID,e=>{const[r]=$p(e),n=mt();if(r&&!st(n))return!1;const s=yA(e.clientX,e.clientY);if(s!==null){const a=oc(s.node);Tr(a)&&e.preventDefault()}return!0},yr),t.registerCommand(sb,()=>(tZ(),!0),yr),t.registerCommand(iv,e=>(pA(t,nu(e,ClipboardEvent)?e:null),!0),yr),t.registerCommand(JC,e=>(async function(r,n){await pA(n,nu(r,ClipboardEvent)?r:null),n.update(()=>{const s=mt();st(s)?s.removeText():Os(s)&&s.getNodes().forEach(a=>a.remove())})}(e,t),!0),yr),t.registerCommand(KC,e=>{const[,r,n]=$p(e);return r.length>0&&!n?(t.dispatchCommand(wA,r),!0):ih(e.target)&&oT(e.target)?!1:mt()!==null&&(function(s,a){s.preventDefault(),a.update(()=>{const i=mt(),o=nu(s,InputEvent)||nu(s,KeyboardEvent)?null:s.clipboardData;o!=null&&i!==null&&gA(o,i,a)},{tag:Vq})}(e,t),!0)},yr),t.registerCommand(FD,e=>{const r=mt();return st(r)&&t_(r),!1},yr),t.registerCommand(RD,e=>{const r=mt();return st(r)&&t_(r),!1},yr))}const vb=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?k.useLayoutEffect:k.useEffect;function CA(t){return t.getEditorState().read(bR(t.isComposing()))}function iee({contentEditable:t,placeholder:e=null,ErrorBoundary:r}){const[n]=To(),s=function(a,i){const[o,l]=k.useState(()=>a.getDecorators());return vb(()=>a.registerDecoratorListener(u=>{fS.flushSync(()=>{l(u)})}),[a]),k.useEffect(()=>{l(a.getDecorators())},[a]),k.useMemo(()=>{const u=[],d=Object.keys(o);for(let h=0;h<d.length;h++){const m=d[h],x=c.jsx(i,{onError:v=>a._onError(v),children:c.jsx(k.Suspense,{fallback:null,children:o[m]})}),p=a.getElementByKey(m);p!==null&&u.push(fS.createPortal(x,p,m))}return u},[i,o,a])}(n,r);return function(a){vb(()=>ed(aee(a),$Z(a)),[a])}(n),c.jsxs(c.Fragment,{children:[t,c.jsx(oee,{content:e}),s]})}function oee({content:t}){const[e]=To(),r=function(s){const[a,i]=k.useState(()=>CA(s));return vb(()=>{function o(){const l=CA(s);i(l)}return o(),ed(s.registerUpdateListener(()=>{o()}),s.registerEditableListener(()=>{o()}))},[s]),a}(e),n=EZ();return r?typeof t=="function"?t(n):t:null}const UR=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?k.useLayoutEffect:k.useEffect;function lee({editor:t,ariaActiveDescendant:e,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:o,ariaLabel:l,ariaLabelledBy:u,ariaMultiline:d,ariaOwns:h,ariaRequired:m,autoCapitalize:x,className:p,id:v,role:_="textbox",spellCheck:S=!0,style:w,tabIndex:y,"data-testid":b,...E},N){const[F,T]=k.useState(t.isEditable()),P=k.useCallback(R=>{R&&R.ownerDocument&&R.ownerDocument.defaultView?t.setRootElement(R):t.setRootElement(null)},[t]),D=k.useMemo(()=>function(...R){return I=>{R.forEach(W=>{typeof W=="function"?W(I):W!=null&&(W.current=I)})}}(N,P),[P,N]);return UR(()=>(T(t.isEditable()),t.registerEditableListener(R=>{T(R)})),[t]),c.jsx("div",{"aria-activedescendant":F?e:void 0,"aria-autocomplete":F?r:"none","aria-controls":F?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":F&&_==="combobox"?!!i:void 0,...o!=null?{"aria-invalid":o}:{},"aria-label":l,"aria-labelledby":u,"aria-multiline":d,"aria-owns":F?h:void 0,"aria-readonly":!F||void 0,"aria-required":m,autoCapitalize:x,className:p,contentEditable:F,"data-testid":b,id:v,ref:D,role:_,spellCheck:S,style:w,tabIndex:y,...E})}const cee=k.forwardRef(lee);function TA(t){return t.getEditorState().read(bR(t.isComposing()))}const uee=k.forwardRef(dee);function dee(t,e){const{placeholder:r,...n}=t,[s]=To();return c.jsxs(c.Fragment,{children:[c.jsx(cee,{editor:s,...n,ref:e}),r!=null&&c.jsx(fee,{editor:s,content:r})]})}function fee({content:t,editor:e}){const r=function(i){const[o,l]=k.useState(()=>TA(i));return UR(()=>{function u(){const d=TA(i);l(d)}return u(),ed(i.registerUpdateListener(()=>{u()}),i.registerEditableListener(()=>{u()}))},[i]),o}(e),[n,s]=k.useState(e.isEditable());if(k.useLayoutEffect(()=>(s(e.isEditable()),e.registerEditableListener(i=>{s(i)})),[e]),!r)return null;let a=null;return typeof t=="function"?a=t(n):t!==null&&(a=t),a===null?null:c.jsx("div",{"aria-hidden":!0,children:a})}const zp=0,wb=1,_b=2,Pi=0,hee=1,EA=2,gee=3,mee=4;function pee(t,e,r,n,s){if(t===null||r.size===0&&n.size===0&&!s)return Pi;const a=e._selection,i=t._selection;if(s)return hee;if(!(st(a)&&st(i)&&i.isCollapsed()&&a.isCollapsed()))return Pi;const o=function(S,w,y){const b=S._nodeMap,E=[];for(const N of w){const F=b.get(N);F!==void 0&&E.push(F)}for(const[N,F]of y){if(!F)continue;const T=b.get(N);T===void 0||Zn(T)||E.push(T)}return E}(e,r,n);if(o.length===0)return Pi;if(o.length>1){const S=e._nodeMap,w=S.get(a.anchor.key),y=S.get(i.anchor.key);return w&&y&&!t._nodeMap.has(w.__key)&&gt(w)&&w.__text.length===1&&a.anchor.offset===1?EA:Pi}const l=o[0],u=t._nodeMap.get(l.__key);if(!gt(u)||!gt(l)||u.__mode!==l.__mode)return Pi;const d=u.__text,h=l.__text;if(d===h)return Pi;const m=a.anchor,x=i.anchor;if(m.key!==x.key||m.type!=="text")return Pi;const p=m.offset,v=x.offset,_=h.length-d.length;return _===1&&v===p-1?EA:_===-1&&v===p+1?gee:_===-1&&v===p?mee:Pi}function xee(t,e){let r=Date.now(),n=Pi;return(s,a,i,o,l,u)=>{const d=Date.now();if(u.has(w1))return n=Pi,r=d,_b;const h=pee(s,a,o,l,t.isComposing()),m=(()=>{const x=i===null||i.editor===t,p=u.has(Wq);if(!p&&x&&u.has(C0))return zp;if(s===null)return wb;const v=a._selection;return o.size>0||l.size>0?p===!1&&h!==Pi&&h===n&&d<r+e&&x||o.size===1&&function(_,S,w){const y=S._nodeMap.get(_),b=w._nodeMap.get(_),E=S._selection,N=w._selection;return!(st(E)&&st(N)&&E.anchor.type==="element"&&E.focus.type==="element"&&N.anchor.type==="text"&&N.focus.type==="text"||!gt(y)||!gt(b)||y.__parent!==b.__parent)&&JSON.stringify(S.read(()=>y.exportJSON()))===JSON.stringify(w.read(()=>b.exportJSON()))}(Array.from(o)[0],s,a)?zp:wb:v!==null?zp:_b})();return r=d,n=h,m}}function NA(t){t.undoStack=[],t.redoStack=[],t.current=null}function yee(t,e,r){const n=xee(t,r);return ed(t.registerCommand(XC,()=>(function(a,i){const o=i.redoStack,l=i.undoStack;if(l.length!==0){const u=i.current,d=l.pop();u!==null&&(o.push(u),a.dispatchCommand(Dp,!0)),l.length===0&&a.dispatchCommand(Rp,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:w1})}}(t,e),!0),yr),t.registerCommand(YC,()=>(function(a,i){const o=i.redoStack,l=i.undoStack;if(o.length!==0){const u=i.current;u!==null&&(l.push(u),a.dispatchCommand(Rp,!0));const d=o.pop();o.length===0&&a.dispatchCommand(Dp,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:w1})}}(t,e),!0),yr),t.registerCommand(kq,()=>(NA(e),!1),yr),t.registerCommand(Cq,()=>(NA(e),t.dispatchCommand(Dp,!1),t.dispatchCommand(Rp,!1),!0),yr),t.registerUpdateListener(({editorState:a,prevEditorState:i,dirtyLeaves:o,dirtyElements:l,tags:u})=>{const d=e.current,h=e.redoStack,m=e.undoStack,x=d===null?null:d.editorState;if(d!==null&&a===x)return;const p=n(i,a,d,o,l,u);if(p===wb)h.length!==0&&(e.redoStack=[],t.dispatchCommand(Dp,!1)),d!==null&&(m.push({...d}),t.dispatchCommand(Rp,!0));else if(p===_b)return;e.current={editor:t,editorState:a}}))}function vee(){return{current:null,redoStack:[],undoStack:[]}}function wee({delay:t,externalHistoryState:e}){const[r]=To();return function(n,s,a=1e3){const i=k.useMemo(()=>s||vee(),[s]);k.useEffect(()=>yee(n,i,a),[a,n,i])}(r,e,t),null}function _ee({defaultSelection:t}){const[e]=To();return k.useEffect(()=>{e.focus(()=>{const r=document.activeElement,n=e.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})},{defaultSelection:t})},[t,e]),null}function Sb(t,e){return Sb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Sb(t,e)}var AA={error:null},See=function(t){var e,r;function n(){for(var a,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=t.call.apply(t,[this].concat(o))||this).state=AA,a.resetErrorBoundary=function(){for(var u,d=arguments.length,h=new Array(d),m=0;m<d;m++)h[m]=arguments[m];a.props.onReset==null||(u=a.props).onReset.apply(u,h),a.reset()},a}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,Sb(e,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(AA)},s.componentDidCatch=function(a,i){var o,l;(o=(l=this.props).onError)==null||o.call(l,a,i)},s.componentDidUpdate=function(a,i){var o,l,u,d,h=this.state.error,m=this.props.resetKeys;h!==null&&i.error!==null&&((u=a.resetKeys)===void 0&&(u=[]),(d=m)===void 0&&(d=[]),u.length!==d.length||u.some(function(x,p){return!Object.is(x,d[p])}))&&((o=(l=this.props).onResetKeysChange)==null||o.call(l,a.resetKeys,m),this.reset())},s.render=function(){var a=this.state.error,i=this.props,o=i.fallbackRender,l=i.FallbackComponent,u=i.fallback;if(a!==null){var d={error:a,resetErrorBoundary:this.resetErrorBoundary};if(k.isValidElement(u))return u;if(typeof o=="function")return o(d);if(l)return k.createElement(l,d);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n}(k.Component);function bee({children:t,onError:e}){return c.jsx(See,{fallback:c.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:e,children:t})}const kT=/^(\d+(?:\.\d+)?)px$/,mf={BOTH:3,NO_STATUS:0,ROW:1};class rm extends Gs{static getType(){return"tablecell"}static clone(e){return new rm(e.__headerState,e.__colSpan,e.__width,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__rowSpan=e.__rowSpan,this.__backgroundColor=e.__backgroundColor,this.__verticalAlign=e.__verticalAlign}static importDOM(){return{td:e=>({conversion:FA,priority:0}),th:e=>({conversion:FA,priority:0})}}static importJSON(e){return $R().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeaderStyles(e.headerState).setColSpan(e.colSpan||1).setRowSpan(e.rowSpan||1).setWidth(e.width||void 0).setBackgroundColor(e.backgroundColor||null).setVerticalAlign(e.verticalAlign||void 0)}constructor(e=mf.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=e,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(e){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),bb(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),Jn(r,e.theme.tableCell,this.hasHeader()&&e.theme.tableCellHeader),r}exportDOM(e){const r=super.exportDOM(e);if(Gr(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...bb(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(e){const r=this.getWritable();return r.__colSpan=e,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(e){const r=this.getWritable();return r.__rowSpan=e,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(e,r=mf.BOTH){const n=this.getWritable();return n.__headerState=e&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(e){const r=this.getWritable();return r.__width=e,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(e){const r=this.getWritable();return r.__backgroundColor=e,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(e){const r=this.getWritable();return r.__verticalAlign=e||void 0,r}toggleHeaderStyle(e){const r=this.getWritable();return(r.__headerState&e)===e?r.__headerState-=e:r.__headerState+=e,r}hasHeaderState(e){return(this.getHeaderStyles()&e)===e}hasHeader(){return this.getLatest().__headerState!==mf.NO_STATUS}updateDOM(e){return e.__headerState!==this.__headerState||e.__width!==this.__width||e.__colSpan!==this.__colSpan||e.__rowSpan!==this.__rowSpan||e.__backgroundColor!==this.__backgroundColor||e.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function bb(t){return t==="middle"||t==="bottom"}function FA(t){const e=t,r=t.nodeName.toLowerCase();let n;kT.test(e.style.width)&&(n=parseFloat(e.style.width));const s=$R(r==="th"?mf.ROW:mf.NO_STATUS,e.colSpan,n);s.__rowSpan=e.rowSpan;const a=e.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=e.style.verticalAlign;bb(i)&&(s.__verticalAlign=i);const o=e.style,l=(o&&o.textDecoration||"").split(" "),u=o.fontWeight==="700"||o.fontWeight==="bold",d=l.includes("line-through"),h=o.fontStyle==="italic",m=l.includes("underline");return{after:x=>{const p=[];let v=null;const _=()=>{if(v){const S=v.getFirstChild();qo(S)&&v.getChildrenSize()===1&&S.remove()}};for(const S of x)sZ(S)||gt(S)||qo(S)?(gt(S)&&(u&&S.toggleFormat("bold"),d&&S.toggleFormat("strikethrough"),h&&S.toggleFormat("italic"),m&&S.toggleFormat("underline")),v?v.append(S):(v=tn().append(S),p.push(v))):(p.push(S),_(),v=null);return _(),p.length===0&&p.push(tn()),p},node:s}}function $R(t=mf.NO_STATUS,e=1,r){return oa(new rm(t,e,r))}function mg(t){return t instanceof rm}function kb(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class nm extends Gs{static getType(){return"tablerow"}static clone(e){return new nm(e.__height,e.__key)}static importDOM(){return{tr:e=>({conversion:kee,priority:0})}}static importJSON(e){return zR().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeight(e.height)}constructor(e,r){super(r),this.__height=e}exportJSON(){const e=this.getHeight();return{...super.exportJSON(),...e===void 0?void 0:{height:e}}}createDOM(e){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),Jn(r,e.theme.tableRow),r}extractWithChild(e,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(e){const r=this.getWritable();return r.__height=e,r}getHeight(){return this.getLatest().__height}updateDOM(e){return e.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function kee(t){const e=t;let r;return kT.test(e.style.height)&&(r=parseFloat(e.style.height)),{after:n=>DR(n,mg),node:zR(r)}}function zR(t){return oa(new nm(t))}function WR(t){return t instanceof nm}const VR=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Cee=VR&&"documentMode"in document?document.documentMode:null;VR&&"InputEvent"in window&&!Cee&&new window.InputEvent("input");function Tee(t,e,r){const n=[];let s=null,a=null;function i(l){let u=n[l];return u===void 0&&(n[l]=u=[]),u}const o=t.getChildren();for(let l=0;l<o.length;l++){const u=o[l];WR(u)||kb(209);const d=i(l);for(let h=u.getFirstChild(),m=0;h!=null;h=h.getNextSibling()){for(mg(h)||kb(147);d[m]!==void 0;)m++;const x={cell:h,startColumn:m,startRow:l},{__rowSpan:p,__colSpan:v}=h;for(let _=0;_<p&&!(l+_>=o.length);_++){const S=i(l+_);for(let w=0;w<v;w++)S[m+w]=x}}}return[n,s,a]}function Kh(t){return Gr(t)&&t.nodeName==="TABLE"}function Eee(t,e){for(let r=e,n=null;r!==null;r=r.getParent()){if(t.is(r))return n;mg(r)&&(n=r)}return null}function Nee(t,e,r){return Eee(t,oc(e,r))}function jA(t,e,r){if(!e.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=e.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}tc(t,...n),Jn(t,...s)}const Aee=new WeakSet;function PA(t=tm()){return Aee.has(t)}class wv extends Gs{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(e){const r=this.getWritable();return r.__colWidths=e,r}static clone(e){return new wv(e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__colWidths=e.__colWidths,this.__rowStriping=e.__rowStriping,this.__frozenColumnCount=e.__frozenColumnCount,this.__frozenRowCount=e.__frozenRowCount}static importDOM(){return{table:e=>({conversion:Fee,priority:1})}}static importJSON(e){return GR().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setRowStriping(e.rowStriping||!1).setFrozenColumns(e.frozenColumnCount||0).setFrozenRows(e.frozenRowCount||0).setColWidths(e.colWidths)}constructor(e){super(e),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(e,r,n){return n==="html"}getDOMSlot(e){const r=Kh(e)?e:e.querySelector("table");return Kh(r)||kb(229),super.getDOMSlot(e).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(e,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),cZ(s),Jn(n,e.theme.table),this.updateTableElement(null,n,e),PA(r)){const a=document.createElement("div"),i=e.theme.tableScrollableWrapper;return i?Jn(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,e),a}return n}updateTableWrapper(e,r,n,s){this.__frozenColumnCount!==(e?e.__frozenColumnCount:0)&&function(a,i,o,l){l>0?(Jn(a,o.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(tc(a,o.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))}(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(e?e.__frozenRowCount:0)&&function(a,i,o,l){l>0?(Jn(a,o.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(tc(a,o.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))}(r,n,s,this.__frozenRowCount)}updateTableElement(e,r,n){this.__style!==(e?e.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!e&&e.__rowStriping)&&function(s,a,i){i?(Jn(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(tc(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))}(r,n,this.__rowStriping),function(s,a,i,o){const l=s.querySelector("colgroup");if(!l)return;const u=[];for(let d=0;d<i;d++){const h=document.createElement("col"),m=o&&o[d];m&&(h.style.width=`${m}px`),u.push(h)}l.replaceChildren(...u)}(r,0,this.getColumnCount(),this.getColWidths()),jA(r,n,this.getFormatType())}updateDOM(e,r,n){const s=this.getDOMSlot(r).element;return r===s===PA()||(Gr(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(e,r,s,n),this.updateTableElement(e,s,n),!1);var a}exportDOM(e){const r=super.exportDOM(e),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!Kh(s)&&Gr(s)&&(s=s.querySelector("table")),!Kh(s))return null;jA(s,e._config,this.getFormatType());const[a]=Tee(this),i=new Map;for(const d of a)for(const h of d){const m=h.cell.getKey();i.has(m)||i.set(m,{colSpan:h.cell.getColSpan(),startColumn:h.startColumn})}const o=new Set;for(const d of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const h=d.getAttribute("data-temporary-table-cell-lexical-key");if(h){const m=i.get(h);if(d.removeAttribute("data-temporary-table-cell-lexical-key"),m){i.delete(h);for(let x=0;x<m.colSpan;x++)o.add(x+m.startColumn)}}}const l=s.querySelector(":scope > colgroup");if(l){const d=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter((h,m)=>o.has(m));l.replaceChildren(...d)}const u=s.querySelectorAll(":scope > tr");if(u.length>0){const d=document.createElement("tbody");for(const h of u)d.appendChild(h);s.append(d)}return s},element:!Kh(n)&&Gr(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(e,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let o=0;o<i.length;o++){const l=i[o];if(l==null)continue;const{elem:u}=l,d=Nee(this,u);if(d!==null&&e.is(d))return{x:o,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(e,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[e<a.length?e:a.length-1];return i??null}getDOMCellFromCordsOrThrow(e,r,n){const s=this.getDOMCellFromCords(e,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(e,r,n){const s=this.getDOMCellFromCords(e,r,n);if(s==null)return null;const a=oc(s.elem);return mg(a)?a:null}getCellNodeFromCordsOrThrow(e,r,n){const s=this.getCellNodeFromCords(e,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(e){const r=this.getWritable();return r.__rowStriping=e,r}setFrozenColumns(e){const r=this.getWritable();return r.__frozenColumnCount=e,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(e){const r=this.getWritable();return r.__frozenRowCount=e,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const e=this.getFirstChild();if(!e)return 0;let r=0;return e.getChildren().forEach(n=>{mg(n)&&(r+=n.getColSpan())}),r}}function Fee(t){const e=GR();t.hasAttribute("data-lexical-row-striping")&&e.setRowStriping(!0),t.hasAttribute("data-lexical-frozen-column")&&e.setFrozenColumns(1),t.hasAttribute("data-lexical-frozen-row")&&e.setFrozenRows(1);const r=t.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!kT.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&e.setColWidths(n)}return{after:n=>DR(n,WR),node:e}}function GR(){return oa(new wv)}function zl(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function Cb(t){let e=1,r=t.getParent();for(;r!=null;){if(Nr(r)){const n=r.getParent();if(Qt(n)){e++,r=n.getParent();continue}zl(40)}return e}return e}function Tb(t){let e=t.getParent();Qt(e)||zl(40);let r=e;for(;r!==null;)r=r.getParent(),Qt(r)&&(e=r);return e}function HR(t){let e=[];const r=t.getChildren().filter(Nr);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();Qt(a)?e=e.concat(HR(a)):e.push(s)}return e}function fo(t){return Nr(t)&&Qt(t.getFirstChild())}function DA(t){return Ma().append(t)}function KR(t,e){return Nr(t)&&(e.length===0||e.length===1&&t.is(e[0])&&t.getChildrenSize()===0)}function RA(t){const e=mt();if(e!==null){let r=e.getNodes();if(st(e)){const s=e.getStartEndPoints();s===null&&zl(143);const[a]=s,i=a.getNode(),o=i.getParent();if(na(i)){const l=i.getFirstChild();if(l)r=l.selectStart().getNodes();else{const u=tn();i.append(u),r=u.select().getNodes()}}else if(KR(i,r)){const l=_a(t);if(na(o)){i.replace(l);const u=Ma();Ke(i)&&(u.setFormat(i.getFormatType()),u.setIndent(i.getIndent())),l.append(u)}else if(Nr(i)){const u=i.getParentOrThrow();Ru(l,u.getChildren()),u.replace(l)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(Ke(a)&&a.isEmpty()&&!Nr(a)&&!n.has(a.getKey())){OA(a,t);continue}let i=lR(a)?a.getParent():Nr(a)&&a.isEmpty()?a:null;for(;i!=null;){const o=i.getKey();if(Qt(i)){if(!n.has(o)){const l=_a(t);Ru(l,i.getChildren()),i.replace(l),n.add(o)}break}{const l=i.getParent();if(na(l)&&!n.has(o)){n.add(o),OA(i,t);break}i=l}}}}}function Ru(t,e){t.splice(t.getChildrenSize(),0,e)}function OA(t,e){if(Qt(t))return t;const r=t.getPreviousSibling(),n=t.getNextSibling(),s=Ma();let a;if(Ru(s,t.getChildren()),Qt(r)&&e===r.getListType())r.append(s),Qt(n)&&e===n.getListType()&&(Ru(r,n.getChildren()),n.remove()),a=r;else if(Qt(n)&&e===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=_a(e);i.append(s),t.replace(i),a=i}return s.setFormat(t.getFormatType()),s.setIndent(t.getIndent()),t.remove(),a}function CT(t,e){const r=t.getLastChild(),n=e.getFirstChild();r&&n&&fo(r)&&fo(n)&&(CT(r.getFirstChild(),n.getFirstChild()),n.remove());const s=e.getChildren();s.length>0&&t.append(...s),e.remove()}function jee(){const t=mt();if(st(t)){const e=new Set,r=t.getNodes(),n=t.anchor.getNode();if(KR(n,r))e.add(Tb(n));else for(let s=0;s<r.length;s++){const a=r[s];if(lR(a)){const i=LZ(a,Nc);i!=null&&e.add(Tb(i))}}for(const s of e){let a=s;const i=HR(s);for(const o of i){const l=tn().setTextStyle(t.style).setTextFormat(t.format);Ru(l,o.getChildren()),a.insertAfter(l),a=l,o.__key===t.anchor.key&&Du(t.anchor,ui(xi(l,"next"))),o.__key===t.focus.key&&Du(t.focus,ui(xi(l,"next"))),o.remove()}s.remove()}}}function XR(t){const e=t.getListType()!=="check";let r=t.getStart();for(const n of t.getChildren())Nr(n)&&(n.getValue()!==r&&n.setValue(r),e&&n.getLatest().__checked!=null&&n.setChecked(void 0),Qt(n.getFirstChild())||r++)}function Pee(t){const e=new Set;if(fo(t)||e.has(t.getKey()))return;const r=t.getParent(),n=t.getNextSibling(),s=t.getPreviousSibling();if(fo(n)&&fo(s)){const a=s.getFirstChild();if(Qt(a)){a.append(t);const i=n.getFirstChild();Qt(i)&&(Ru(a,i.getChildren()),n.remove(),e.add(n.getKey()))}}else if(fo(n)){const a=n.getFirstChild();if(Qt(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(t)}}else if(fo(s)){const a=s.getFirstChild();Qt(a)&&a.append(t)}else if(Qt(r)){const a=Ma().setTextFormat(t.getTextFormat()).setTextStyle(t.getTextStyle()),i=_a(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(t),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function Dee(t){if(fo(t))return;const e=t.getParent(),r=e?e.getParent():void 0;if(Qt(r?r.getParent():void 0)&&Nr(r)&&Qt(e)){const n=e?e.getFirstChild():void 0,s=e?e.getLastChild():void 0;if(t.is(n))r.insertBefore(t),e.isEmpty()&&r.remove();else if(t.is(s))r.insertAfter(t),e.isEmpty()&&r.remove();else{const a=e.getListType(),i=Ma(),o=_a(a);i.append(o),t.getPreviousSiblings().forEach(d=>o.append(d));const l=Ma(),u=_a(a);l.append(u),Ru(u,t.getNextSiblings()),r.insertBefore(i),r.insertAfter(l),r.replace(t)}}}function Ree(){const t=mt();if(!st(t)||!t.isCollapsed())return!1;const e=t.anchor.getNode();if(!Nr(e)||e.getChildrenSize()!==0)return!1;const r=Tb(e),n=e.getParent();Qt(n)||zl(40);const s=n.getParent();let a;if(na(s))a=tn(),r.insertAfter(a);else{if(!Nr(s))return!1;a=Ma(),s.insertAfter(a)}a.setTextStyle(t.style).setTextFormat(t.format).select();const i=e.getNextSiblings();if(i.length>0){const o=_a(n.getListType());if(Nr(a)){const l=Ma();l.append(o),a.insertAfter(l)}else a.insertAfter(o);o.append(...i)}return function(o){let l=o;for(;l.getNextSibling()==null&&l.getPreviousSibling()==null;){const u=l.getParent();if(u==null||!Nr(u)&&!Qt(u))break;l=u}l.remove()}(e),!0}function C1(...t){const e=[];for(const r of t)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))e.push(n);return e}let Nc=class extends Gs{$config(){return this.config("listitem",{$transform:e=>{if(e.__checked==null)return;const r=e.getParent();Qt(r)&&r.getListType()!=="check"&&e.getChecked()!=null&&e.setChecked(void 0)},extends:Gs,importDOM:{li:()=>({conversion:Oee,priority:0})}})}constructor(e=1,r=void 0,n){super(n),this.__value=e===void 0?1:e,this.__checked=r}afterCloneFrom(e){super.afterCloneFrom(e),this.__value=e.__value,this.__checked=e.__checked}createDOM(e){const r=document.createElement("li");return this.updateListItemDOM(null,r,e),r}updateListItemDOM(e,r,n){const s=this.getParent();Qt(s)&&s.getListType()==="check"&&function(o,l,u,d){Qt(l.getFirstChild())?(o.removeAttribute("role"),o.removeAttribute("tabIndex"),o.removeAttribute("aria-checked")):(o.setAttribute("role","checkbox"),o.setAttribute("tabIndex","-1"),u&&l.__checked===u.__checked||o.setAttribute("aria-checked",l.getChecked()?"true":"false"))}(r,this,e),r.value=this.__value,function(o,l,u){const d=[],h=[],m=l.list,x=m?m.listitem:void 0;let p;if(m&&m.nested&&(p=m.nested.listitem),x!==void 0&&d.push(...C1(x)),m){const v=u.getParent(),_=Qt(v)&&v.getListType()==="check",S=u.getChecked();_&&!S||h.push(m.listitemUnchecked),_&&S||h.push(m.listitemChecked),_&&d.push(S?m.listitemChecked:m.listitemUnchecked)}if(p!==void 0){const v=C1(p);u.getChildren().some(_=>Qt(_))?d.push(...v):h.push(...v)}h.length>0&&tc(o,...h),d.length>0&&Jn(o,...d)}(r,n.theme,this);const a=e?e.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),function(o,l,u){const d=uA(l.__textStyle);for(const h in d)o.style.setProperty(`--listitem-marker-${h}`,d[h]);if(u)for(const h in uA(u.__textStyle))h in d||o.style.removeProperty(`--listitem-marker-${h}`)}(r,this,e)}updateDOM(e,r,n){const s=r;return this.updateListItemDOM(e,s,n),!1}updateFromJSON(e){return super.updateFromJSON(e).setValue(e.value).setChecked(e.checked)}exportDOM(e){const r=this.createDOM(e._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...e){for(let r=0;r<e.length;r++){const n=e[r];if(Ke(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(e,r){if(Nr(e))return super.replace(e);this.setIndent(0);const n=this.getParentOrThrow();if(!Qt(n))return e;if(n.__first===this.getKey())n.insertBefore(e);else if(n.__last===this.getKey())n.insertAfter(e);else{const s=_a(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(e),e.insertAfter(s)}return r&&(Ke(e)||zl(139),this.getChildren().forEach(s=>{e.append(s)})),this.remove(),n.getChildrenSize()===0&&n.remove(),e}insertAfter(e,r=!0){const n=this.getParentOrThrow();if(Qt(n)||zl(39),Nr(e))return super.insertAfter(e,r);const s=this.getNextSiblings();if(n.insertAfter(e,r),s.length!==0){const a=_a(n.getListType());s.forEach(i=>a.append(i)),e.insertAfter(a,r)}return e}remove(e){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(e),r&&n&&fo(r)&&fo(n)&&(CT(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(e,r=!0){const n=Ma().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(e){const r=tn();this.getChildren().forEach(i=>r.append(i));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=Nr(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=e.anchor,o=e.focus,l=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(l,i.offset,"element"),o.type==="element"&&o.getNode().is(this)&&o.set(l,o.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(e){const r=this.getWritable();return r.__value=e,r}getChecked(){const e=this.getLatest();let r;const n=this.getParent();return Qt(n)&&(r=n.getListType()),r==="check"?!!e.__checked:void 0}setChecked(e){const r=this.getWritable();return r.__checked=e,r}toggleChecked(){const e=this.getWritable();return e.setChecked(!e.__checked)}getIndent(){const e=this.getParent();if(e===null||!this.isAttached())return this.getLatest().__indent;let r=e.getParentOrThrow(),n=0;for(;Nr(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(e){typeof e!="number"&&zl(117),(e=Math.floor(e))>=0||zl(199);let r=this.getIndent();for(;r!==e;)r<e?(Pee(this),r++):(Dee(this),r--);return this}canInsertAfter(e){return Nr(e)}canReplaceWith(e){return Nr(e)}canMergeWith(e){return Nr(e)||sT(e)}extractWithChild(e,r){if(!st(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return _a("bullet")}canMergeWhenEmpty(){return!0}};function Oee(t){if(t.classList.contains("task-list-item")){for(const r of t.children)if(r.tagName==="INPUT")return Mee(r)}const e=t.getAttribute("aria-checked");return{node:Ma(e==="true"||e!=="false"&&void 0)}}function Mee(t){return t.getAttribute("type")!=="checkbox"?{node:null}:{node:Ma(t.hasAttribute("checked"))}}function Ma(t){return oa(new Nc(void 0,t))}function Nr(t){return t instanceof Nc}let td=class extends Gs{$config(){return this.config("list",{$transform:e=>{(function(r){const n=r.getNextSibling();Qt(n)&&r.getListType()===n.getListType()&&CT(r,n)})(e),XR(e)},extends:Gs,importDOM:{ol:()=>({conversion:LA,priority:0}),ul:()=>({conversion:LA,priority:0})}})}constructor(e="number",r=1,n){super(n);const s=Iee[e]||e;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(e){super.afterCloneFrom(e),this.__listType=e.__listType,this.__tag=e.__tag,this.__start=e.__start}getTag(){return this.getLatest().__tag}setListType(e){const r=this.getWritable();return r.__listType=e,r.__tag=e==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(e){const r=this.getWritable();return r.__start=e,r}createDOM(e,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,MA(s,e.theme,this),s}updateDOM(e,r,n){return e.__tag!==this.__tag||(MA(r,n.theme,this),!1)}updateFromJSON(e){return super.updateFromJSON(e).setListType(e.listType).setStart(e.start)}exportDOM(e){const r=this.createDOM(e._config,e);return Gr(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(e,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];Nr(i)||(s===n&&(s=[...n]),s[a]=Ma().append(!Ke(i)||Qt(i)||i.isInline()?i:An(i.getTextContent())))}return super.splice(e,r,s)}extractWithChild(e){return Nr(e)}};function MA(t,e,r){const n=[],s=[],a=e.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],o=Cb(r)-1,l=o%i.length,u=i[l],d=a[r.__tag];let h;const m=a.nested,x=a.checklist;if(m!==void 0&&m.list&&(h=m.list),d!==void 0&&n.push(d),x!==void 0&&r.__listType==="check"&&n.push(x),u!==void 0){n.push(...C1(u));for(let p=0;p<i.length;p++)p!==l&&s.push(r.__tag+p)}if(h!==void 0){const p=C1(h);o>1?n.push(...p):s.push(...p)}}s.length>0&&tc(t,...s),n.length>0&&Jn(t,...n)}function Lee(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r];if(Nr(n)){e.push(n);const s=n.getChildren();s.length>1&&s.forEach(a=>{Qt(a)&&e.push(DA(a))})}else e.push(DA(n))}return e}function LA(t){const e=t.nodeName.toLowerCase();let r=null;return e==="ol"?r=_a("number",t.start):e==="ul"&&(r=function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if(Gr(s)&&s.hasAttribute("aria-checked"))return!0;return!1}(t)?_a("check"):_a("bullet")),{after:Lee,node:r}}const Iee={ol:"number",ul:"bullet"};function _a(t="number",e=1){return oa(new td(t,e))}function Qt(t){return t instanceof td}const Bee=Ut("UPDATE_LIST_START_COMMAND"),YR=Ut("INSERT_UNORDERED_LIST_COMMAND"),JR=Ut("INSERT_ORDERED_LIST_COMMAND"),QR=Ut("REMOVE_LIST_COMMAND");function Uee(t){return ed(t.registerCommand(JR,()=>(RA("number"),!0),Rd),t.registerCommand(Bee,e=>{const{listNodeKey:r,newStart:n}=e,s=Vn(r);return!!Qt(s)&&(s.getListType()==="number"&&(s.setStart(n),XR(s)),!0)},Rd),t.registerCommand(YR,()=>(RA("bullet"),!0),Rd),t.registerCommand(QR,()=>(jee(),!0),Rd),t.registerCommand(dg,()=>Ree(),Rd),t.registerNodeTransform(Nc,e=>{const r=e.getFirstChild();if(r){if(gt(r)){const n=r.getStyle(),s=r.getFormat();e.getTextStyle()!==n&&e.setTextStyle(n),e.getTextFormat()!==s&&e.setTextFormat(s)}}else{const n=mt();st(n)&&(n.style!==e.getTextStyle()||n.format!==e.getTextFormat())&&n.isCollapsed()&&e.is(n.anchor.getNode())&&e.setTextStyle(n.style).setTextFormat(n.format)}}),t.registerNodeTransform(Tc,e=>{const r=e.getParent();if(Nr(r)&&e.is(r.getFirstChild())){const n=e.getStyle(),s=e.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}}))}function $ee(t){const e=r=>{const n=r.getParent();if(Qt(r.getFirstChild())||!Qt(n))return;const s=pv(r,a=>Nr(a)&&Qt(a.getParent())&&Nr(a.getPreviousSibling()));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(Nr(s)){const a=s.getPreviousSibling();if(Nr(a)){const i=function(l){let u=l,d=u.getFirstChild();for(;Qt(d);){const h=d.getLastChild();if(!Nr(h))break;u=h,d=u.getFirstChild()}return u}(a),o=i.getParent();if(Qt(o)){const l=Cb(o);l+1<Cb(n)&&r.setIndent(l)}}}};return t.registerNodeTransform(td,r=>{const n=[r];for(;n.length>0;){const s=n.shift();if(Qt(s)){for(const a of s.getChildren())if(Nr(a)){e(a);const i=a.getFirstChild();Qt(i)&&n.push(i)}}}})}var zee={exports:{}};(function(t){var e=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function w(y){return y instanceof l?new l(y.type,w(y.content),y.alias):Array.isArray(y)?y.map(w):y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(w){return Object.prototype.toString.call(w).slice(8,-1)},objId:function(w){return w.__id||Object.defineProperty(w,"__id",{value:++a}),w.__id},clone:function w(y,b){b=b||{};var E,N;switch(o.util.type(y)){case"Object":if(N=o.util.objId(y),b[N])return b[N];E={},b[N]=E;for(var F in y)y.hasOwnProperty(F)&&(E[F]=w(y[F],b));return E;case"Array":return N=o.util.objId(y),b[N]?b[N]:(E=[],b[N]=E,y.forEach(function(T,P){E[P]=w(T,b)}),E);default:return y}},getLanguage:function(w){for(;w;){var y=s.exec(w.className);if(y)return y[1].toLowerCase();w=w.parentElement}return"none"},setLanguage:function(w,y){w.className=w.className.replace(RegExp(s,"gi"),""),w.classList.add("language-"+y)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(E){var w=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(E.stack)||[])[1];if(w){var y=document.getElementsByTagName("script");for(var b in y)if(y[b].src==w)return y[b]}return null}},isActive:function(w,y,b){for(var E="no-"+y;w;){var N=w.classList;if(N.contains(y))return!0;if(N.contains(E))return!1;w=w.parentElement}return!!b}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(w,y){var b=o.util.clone(o.languages[w]);for(var E in y)b[E]=y[E];return b},insertBefore:function(w,y,b,E){E=E||o.languages;var N=E[w],F={};for(var T in N)if(N.hasOwnProperty(T)){if(T==y)for(var P in b)b.hasOwnProperty(P)&&(F[P]=b[P]);b.hasOwnProperty(T)||(F[T]=N[T])}var D=E[w];return E[w]=F,o.languages.DFS(o.languages,function(R,I){I===D&&R!=w&&(this[R]=F)}),F},DFS:function w(y,b,E,N){N=N||{};var F=o.util.objId;for(var T in y)if(y.hasOwnProperty(T)){b.call(y,T,y[T],E||T);var P=y[T],D=o.util.type(P);D==="Object"&&!N[F(P)]?(N[F(P)]=!0,w(P,b,null,N)):D==="Array"&&!N[F(P)]&&(N[F(P)]=!0,w(P,b,T,N))}}},plugins:{},highlightAll:function(w,y){o.highlightAllUnder(document,w,y)},highlightAllUnder:function(w,y,b){var E={callback:b,container:w,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",E),E.elements=Array.prototype.slice.apply(E.container.querySelectorAll(E.selector)),o.hooks.run("before-all-elements-highlight",E);for(var N=0,F;F=E.elements[N++];)o.highlightElement(F,y===!0,E.callback)},highlightElement:function(w,y,b){var E=o.util.getLanguage(w),N=o.languages[E];o.util.setLanguage(w,E);var F=w.parentElement;F&&F.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(F,E);var T=w.textContent,P={element:w,language:E,grammar:N,code:T};function D(I){P.highlightedCode=I,o.hooks.run("before-insert",P),P.element.innerHTML=P.highlightedCode,o.hooks.run("after-highlight",P),o.hooks.run("complete",P),b&&b.call(P.element)}if(o.hooks.run("before-sanity-check",P),F=P.element.parentElement,F&&F.nodeName.toLowerCase()==="pre"&&!F.hasAttribute("tabindex")&&F.setAttribute("tabindex","0"),!P.code){o.hooks.run("complete",P),b&&b.call(P.element);return}if(o.hooks.run("before-highlight",P),!P.grammar){D(o.util.encode(P.code));return}if(y&&n.Worker){var R=new Worker(o.filename);R.onmessage=function(I){D(I.data)},R.postMessage(JSON.stringify({language:P.language,code:P.code,immediateClose:!0}))}else D(o.highlight(P.code,P.grammar,P.language))},highlight:function(w,y,b){var E={code:w,grammar:y,language:b};if(o.hooks.run("before-tokenize",E),!E.grammar)throw new Error('The language "'+E.language+'" has no grammar.');return E.tokens=o.tokenize(E.code,E.grammar),o.hooks.run("after-tokenize",E),l.stringify(o.util.encode(E.tokens),E.language)},tokenize:function(w,y){var b=y.rest;if(b){for(var E in b)y[E]=b[E];delete y.rest}var N=new h;return m(N,N.head,w),d(w,N,y,N.head,0),p(N)},hooks:{all:{},add:function(w,y){var b=o.hooks.all;b[w]=b[w]||[],b[w].push(y)},run:function(w,y){var b=o.hooks.all[w];if(!(!b||!b.length))for(var E=0,N;N=b[E++];)N(y)}},Token:l};n.Prism=o;function l(w,y,b,E){this.type=w,this.content=y,this.alias=b,this.length=(E||"").length|0}l.stringify=function w(y,b){if(typeof y=="string")return y;if(Array.isArray(y)){var E="";return y.forEach(function(D){E+=w(D,b)}),E}var N={type:y.type,content:w(y.content,b),tag:"span",classes:["token",y.type],attributes:{},language:b},F=y.alias;F&&(Array.isArray(F)?Array.prototype.push.apply(N.classes,F):N.classes.push(F)),o.hooks.run("wrap",N);var T="";for(var P in N.attributes)T+=" "+P+'="'+(N.attributes[P]||"").replace(/"/g,"&quot;")+'"';return"<"+N.tag+' class="'+N.classes.join(" ")+'"'+T+">"+N.content+"</"+N.tag+">"};function u(w,y,b,E){w.lastIndex=y;var N=w.exec(b);if(N&&E&&N[1]){var F=N[1].length;N.index+=F,N[0]=N[0].slice(F)}return N}function d(w,y,b,E,N,F){for(var T in b)if(!(!b.hasOwnProperty(T)||!b[T])){var P=b[T];P=Array.isArray(P)?P:[P];for(var D=0;D<P.length;++D){if(F&&F.cause==T+","+D)return;var R=P[D],I=R.inside,W=!!R.lookbehind,le=!!R.greedy,q=R.alias;if(le&&!R.pattern.global){var V=R.pattern.toString().match(/[imsuy]*$/)[0];R.pattern=RegExp(R.pattern.source,V+"g")}for(var K=R.pattern||R,U=E.next,L=N;U!==y.tail&&!(F&&L>=F.reach);L+=U.value.length,U=U.next){var Z=U.value;if(y.length>w.length)return;if(!(Z instanceof l)){var ne=1,z;if(le){if(z=u(K,L,w,W),!z||z.index>=w.length)break;var de=z.index,Y=z.index+z[0].length,J=L;for(J+=U.value.length;de>=J;)U=U.next,J+=U.value.length;if(J-=U.value.length,L=J,U.value instanceof l)continue;for(var te=U;te!==y.tail&&(J<Y||typeof te.value=="string");te=te.next)ne++,J+=te.value.length;ne--,Z=w.slice(L,J),z.index-=L}else if(z=u(K,0,Z,W),!z)continue;var de=z.index,ee=z[0],ge=Z.slice(0,de),fe=Z.slice(de+ee.length),ye=L+Z.length;F&&ye>F.reach&&(F.reach=ye);var Ce=U.prev;ge&&(Ce=m(y,Ce,ge),L+=ge.length),x(y,Ce,ne);var re=new l(T,I?o.tokenize(ee,I):ee,q,ee);if(U=m(y,Ce,re),fe&&m(y,U,fe),ne>1){var ve={cause:T+","+D,reach:ye};d(w,y,b,U.prev,L,ve),F&&ve.reach>F.reach&&(F.reach=ve.reach)}}}}}}function h(){var w={value:null,prev:null,next:null},y={value:null,prev:w,next:null};w.next=y,this.head=w,this.tail=y,this.length=0}function m(w,y,b){var E=y.next,N={value:b,prev:y,next:E};return y.next=N,E.prev=N,w.length++,N}function x(w,y,b){for(var E=y.next,N=0;N<b&&E!==w.tail;N++)E=E.next;y.next=E,E.prev=y,w.length-=N}function p(w){for(var y=[],b=w.head.next;b!==w.tail;)y.push(b.value),b=b.next;return y}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(w){var y=JSON.parse(w.data),b=y.language,E=y.code,N=y.immediateClose;n.postMessage(o.highlight(E,o.languages[b],b)),N&&n.close()},!1)),o;var v=o.util.currentScript();v&&(o.filename=v.src,v.hasAttribute("data-manual")&&(o.manual=!0));function _(){o.manual||o.highlightAll()}if(!o.manual){var S=document.readyState;S==="loading"||S==="interactive"&&v&&v.defer?document.addEventListener("DOMContentLoaded",_):window.requestAnimationFrame?window.requestAnimationFrame(_):window.setTimeout(_,16)}return o}(e);t.exports&&(t.exports=r),typeof Tx<"u"&&(Tx.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};o["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},r.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))}(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading",s=function(v,_){return" Error "+v+" while fetching file: "+_},a=" Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",u="loaded",d="failed",h="pre[data-src]:not(["+o+'="'+u+'"]):not(['+o+'="'+l+'"])';function m(v,_,S){var w=new XMLHttpRequest;w.open("GET",v,!0),w.onreadystatechange=function(){w.readyState==4&&(w.status<400&&w.responseText?_(w.responseText):w.status>=400?S(s(w.status,w.statusText)):S(a))},w.send(null)}function x(v){var _=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(v||"");if(_){var S=Number(_[1]),w=_[2],y=_[3];return w?y?[S,Number(y)]:[S,void 0]:[S,S]}}r.hooks.add("before-highlightall",function(v){v.selector+=", "+h}),r.hooks.add("before-sanity-check",function(v){var _=v.element;if(_.matches(h)){v.code="",_.setAttribute(o,l);var S=_.appendChild(document.createElement("CODE"));S.textContent=n;var w=_.getAttribute("data-src"),y=v.language;if(y==="none"){var b=(/\.(\w+)$/.exec(w)||[,"none"])[1];y=i[b]||b}r.util.setLanguage(S,y),r.util.setLanguage(_,y);var E=r.plugins.autoloader;E&&E.loadLanguages(y),m(w,function(N){_.setAttribute(o,u);var F=x(_.getAttribute("data-range"));if(F){var T=N.split(/\r\n?|\n/g),P=F[0],D=F[1]==null?T.length:F[1];P<0&&(P+=T.length),P=Math.max(0,Math.min(P-1,T.length)),D<0&&(D+=T.length),D=Math.max(0,Math.min(D,T.length)),N=T.slice(P,D).join(`
`),_.hasAttribute("data-start")||_.setAttribute("data-start",String(P+1))}S.textContent=N,r.highlightElement(S)},function(N){_.setAttribute(o,d),S.textContent=N})}}),r.plugins.fileHighlight={highlight:function(_){for(var S=(_||document).querySelectorAll(h),w=0,y;y=S[w++];)r.highlightElement(y)}};var p=!1;r.fileHighlight=function(){p||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),p=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(zee);Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(t){t.type==="entity"&&(t.attributes.title=t.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(e,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return e}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(t,e){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+t+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[e,"language-"+e],inside:Prism.languages[e]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(t){var e=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(d){return d=d.replace(/<inner>/g,function(){return e}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+d+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;t.languages.markdown=t.languages.extend("markup",{}),t.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:t.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:t.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:t.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(d){["url","bold","italic","strike","code-snippet"].forEach(function(h){d!==h&&(t.languages.markdown[d].inside.content.inside[h]=t.languages.markdown[h])})}),t.hooks.add("after-tokenize",function(d){if(d.language!=="markdown"&&d.language!=="md")return;function h(m){if(!(!m||typeof m=="string"))for(var x=0,p=m.length;x<p;x++){var v=m[x];if(v.type!=="code"){h(v.content);continue}var _=v.content[1],S=v.content[3];if(_&&S&&_.type==="code-language"&&S.type==="code-block"&&typeof _.content=="string"){var w=_.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");w=(/[a-z][\w-]*/i.exec(w)||[""])[0].toLowerCase();var y="language-"+w;S.alias?typeof S.alias=="string"?S.alias=[S.alias,y]:S.alias.push(y):S.alias=[y]}}}h(d.tokens)}),t.hooks.add("wrap",function(d){if(d.type==="code-block"){for(var h="",m=0,x=d.classes.length;m<x;m++){var p=d.classes[m],v=/language-(.+)/.exec(p);if(v){h=v[1];break}}var _=t.languages[h];if(_)d.content=t.highlight(u(d.content),_,h);else if(h&&h!=="none"&&t.plugins.autoloader){var S="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);d.attributes.id=S,t.plugins.autoloader.loadLanguages(h,function(){var w=document.getElementById(S);w&&(w.innerHTML=t.highlight(w.textContent,t.languages[h],h))})}}});var i=RegExp(t.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function u(d){var h=d.replace(i,"");return h=h.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(m,x){if(x=x.toLowerCase(),x[0]==="#"){var p;return x[1]==="x"?p=parseInt(x.slice(2),16):p=Number(x.slice(1)),l(p)}else{var v=o[x];return v||m}}),h}t.languages.md=t.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(t){var e=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;t.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+e.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+e.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+e.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+e.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:e,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},t.languages.css.atrule.inside.rest=t.languages.css;var r=t.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(t){var e=t.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};e.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:e},boolean:e.boolean,variable:e.variable}})(Prism);Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/};Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python;Prism.languages.py=Prism.languages.python;(function(t){for(var e=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)e=e.replace(/<self>/g,function(){return e});e=e.replace(/<self>/g,function(){return/[^\s\S]/.source}),t.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+e),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},t.languages.rust["closure-params"].inside.rest=t.languages.rust,t.languages.rust.attribute.inside.string=t.languages.rust.string})(Prism);Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(t){t.inside.interpolation.inside=Prism.languages.swift});(function(t){t.languages.typescript=t.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),t.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete t.languages.typescript.parameter,delete t.languages.typescript["literal-property"];var e=t.languages.extend("typescript",{});delete e["class-name"],t.languages.typescript["class-name"].inside=e,t.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e}}}}),t.languages.ts=t.languages.typescript})(Prism);(function(t){var e=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};t.languages.java=t.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:e,function:[t.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),t.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),t.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:e,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return e.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism);(function(t){var e=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return e.source});t.languages.cpp=t.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return e.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:e,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),t.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),t.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t.languages.cpp}}}}),t.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),t.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:t.languages.extend("cpp",{})}}),t.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},t.languages.cpp["base-clause"])})(Prism);function qR(t,e){for(const r of t.childNodes){if(Gr(r)&&r.tagName===e)return!0;qR(r,e)}return!1}const r0="data-language",Xh="data-highlight-language",Wp="data-theme";class ch extends Gs{static getType(){return"code"}static clone(e){return new ch(e.__language,e.__key)}constructor(e,r){super(r),this.__language=e||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(e){super.afterCloneFrom(e),this.__language=e.__language,this.__theme=e.__theme,this.__isSyntaxHighlightSupported=e.__isSyntaxHighlightSupported}createDOM(e){const r=document.createElement("code");Jn(r,e.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(r0,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(Xh,n));const s=this.getTheme();s&&r.setAttribute(Wp,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(e,r,n){const s=this.__language,a=e.__language;s?s!==a&&r.setAttribute(r0,s):a&&r.removeAttribute(r0);const i=this.__isSyntaxHighlightSupported;e.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(Xh,s):r.removeAttribute(Xh):i&&s&&r.setAttribute(Xh,s);const o=this.__theme,l=e.__theme;o?o!==l&&r.setAttribute(Wp,o):l&&r.removeAttribute(Wp);const u=this.__style,d=e.__style;return u?u!==d&&r.setAttribute("style",u):d&&r.removeAttribute("style"),!1}exportDOM(e){const r=document.createElement("pre");Jn(r,e._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(r0,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(Xh,n));const s=this.getTheme();s&&r.setAttribute(Wp,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:e=>e.textContent!=null&&(/\r?\n/.test(e.textContent)||qR(e,"BR"))?{conversion:IA,priority:1}:null,div:()=>({conversion:Wee,priority:1}),pre:()=>({conversion:IA,priority:0}),table:e=>r_(e)?{conversion:Vee,priority:3}:null,td:e=>{const r=e,n=r.closest("table");return r.classList.contains("js-file-line")||n&&r_(n)?{conversion:BA,priority:3}:null},tr:e=>{const r=e.closest("table");return r&&r_(r)?{conversion:BA,priority:3}:null}}}static importJSON(e){return Xo().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setLanguage(e.language).setTheme(e.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(e,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const l=tn();return this.insertAfter(l,r),l}const{anchor:a,focus:i}=e,o=(a.isBefore(i)?a:i).getNode();if(gt(o)){let l=Hee(o);const u=[];for(;;)if(ov(l))u.push(sh()),l=l.getNextSibling();else{if(!tO(l))break;{let _=0;const S=l.getTextContent(),w=l.getTextContentSize();for(;_<w&&S[_]===" ";)_++;if(_!==0&&u.push(eO(" ".repeat(_))),_!==w)break;l=l.getNextSibling()}}const d=o.splitText(a.offset)[0],h=a.offset===0?0:1,m=d.getIndexWithinParent()+h,x=o.getParentOrThrow(),p=[So(),...u];x.splice(m,0,p);const v=u[u.length-1];v?v.select():a.offset===0?d.selectPrevious():d.getNextSibling().selectNext(0,0)}if(TT(o)){const{offset:l}=e.anchor;o.splice(l,0,[So()]),o.select(l+1,l+1)}return null}canIndent(){return!1}collapseAtStart(){const e=tn();return this.getChildren().forEach(r=>e.append(r)),this.replace(e),!0}setLanguage(e){const r=this.getWritable();return r.__language=e||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(e){const r=this.getWritable();return r.__isSyntaxHighlightSupported=e,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(e){const r=this.getWritable();return r.__theme=e||void 0,r}getTheme(){return this.getLatest().__theme}}function Xo(t,e){return dZ(ch).setLanguage(t).setTheme(e)}function TT(t){return t instanceof ch}function IA(t){return{node:Xo(t.getAttribute(r0))}}function Wee(t){const e=t,r=UA(e);return r||function(n){let s=n.parentElement;for(;s!==null;){if(UA(s))return!0;s=s.parentElement}return!1}(e)?{node:r?Xo():null}:{node:null}}function Vee(){return{node:Xo()}}function BA(){return{node:null}}function UA(t){return t.style.fontFamily.match("monospace")!==null}function r_(t){return t.classList.contains("js-file-line-container")}let ET=class ZR extends Tc{constructor(e="",r,n){super(e,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(e){return new ZR(e.__text,e.__highlightType||void 0,e.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(e){const r=this.getWritable();return r.__highlightType=e||void 0,r}canHaveFormat(){return!1}createDOM(e){const r=super.createDOM(e),n=n_(e.theme,this.__highlightType);return Jn(r,n),r}updateDOM(e,r,n){const s=super.updateDOM(e,r,n),a=n_(n.theme,e.__highlightType),i=n_(n.theme,this.__highlightType);return a!==i&&(a&&tc(r,a),i&&Jn(r,i)),s}static importJSON(e){return eO().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHighlightType(e.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(e){return this}isParentRequired(){return!0}createParentElementNode(){return Xo()}};function n_(t,e){return e&&t&&t.codeHighlight&&t.codeHighlight[e]}function eO(t="",e){return oa(new ET(t,e))}function tO(t){return t instanceof ET}function Gee(t,e){let r=t;for(let n=Cs(t,e);n&&(tO(n.origin)||ov(n.origin));n=MZ(n))r=n.origin;return r}function Hee(t){return Gee(t,"previous")}(function(t){t.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var e={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(e).forEach(function(r){var n=e[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),t.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}}),Object.defineProperty(t.languages.diff,"PREFIXES",{value:e})})(Prism);const Kee=new Set(["http:","https:","mailto:","sms:","tel:"]);class rd extends Gs{static getType(){return"link"}static clone(e){return new rd(e.__url,{rel:e.__rel,target:e.__target,title:e.__title},e.__key)}constructor(e="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=e,this.__target=s,this.__rel=a,this.__title=i}createDOM(e){const r=document.createElement("a");return this.updateLinkDOM(null,r,e),Jn(r,e.theme.link),r}updateLinkDOM(e,r,n){if(xR(r)){e&&e.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];e&&e[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(e,r,n){return this.updateLinkDOM(e,r,n),!1}static importDOM(){return{a:e=>({conversion:Xee,priority:1})}}static importJSON(e){return T1().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setURL(e.url).setRel(e.rel||null).setTarget(e.target||null).setTitle(e.title||null)}sanitizeUrl(e){e=zA(e);try{const r=new URL(zA(e));if(!Kee.has(r.protocol))return"about:blank"}catch{return e}return e}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(e){const r=this.getWritable();return r.__url=e,r}getTarget(){return this.getLatest().__target}setTarget(e){const r=this.getWritable();return r.__target=e,r}getRel(){return this.getLatest().__rel}setRel(e){const r=this.getWritable();return r.__rel=e,r}getTitle(){return this.getLatest().__title}setTitle(e){const r=this.getWritable();return r.__title=e,r}insertNewAfter(e,r=!0){const n=T1(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(e,r,n){if(!st(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function Xee(t){let e=null;if(xR(t)){const r=t.textContent;(r!==null&&r!==""||t.children.length>0)&&(e=T1(t.getAttribute("href")||"",{rel:t.getAttribute("rel"),target:t.getAttribute("target"),title:t.getAttribute("title")}))}return{node:e}}function T1(t="",e){return oa(new rd(t,e))}function Yee(t){return t instanceof rd}class sm extends rd{constructor(e="",r={},n){super(e,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(e){return new sm(e.__url,{isUnlinked:e.__isUnlinked,rel:e.__rel,target:e.__target,title:e.__title},e.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(e){const r=this.getWritable();return r.__isUnlinked=e,r}createDOM(e){return this.__isUnlinked?document.createElement("span"):super.createDOM(e)}updateDOM(e,r,n){return super.updateDOM(e,r,n)||e.__isUnlinked!==this.__isUnlinked}static importJSON(e){return $A().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setIsUnlinked(e.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(e,r=!0){const n=this.getParentOrThrow().insertNewAfter(e,r);if(Ke(n)){const s=$A(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function $A(t="",e){return oa(new sm(t,e))}function Jee(t){return t instanceof sm}const Qee=/^\+?[0-9\s()-]{5,}$/;function zA(t){return t.match(/^[a-z][a-z0-9+.-]*:/i)||t.match(/^[/#.]/)?t:t.includes("@")?`mailto:${t}`:Qee.test(t)?`tel:${t}`:`https://${t}`}function Eb(t,e){const r={};for(const n of t){const s=e(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function qee(t){const e=Eb(t,r=>r.type);return{element:e.element||[],multilineElement:e["multiline-element"]||[],textFormat:e["text-format"]||[],textMatch:e["text-match"]||[]}}const WA=/[!-/:-@[-`{-~\s]/;function Zee(t){return gt(t)&&!t.hasFormat("code")}function ete(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function VA(t,e,r){const n=r.length;for(let s=e;s>=n;s--){const a=s-n;if(rO(t,a,r,0,n)&&t[a+n]!==" ")return a}return-1}function rO(t,e,r,n,s){for(let a=0;a<s;a++)if(t[e+a]!==r[n+a])return!1;return!0}function tte(t,e=AT){const r=qee(e),n=Eb(r.textFormat,({tag:i})=>i[i.length-1]),s=Eb(r.textMatch,({trigger:i})=>i);for(const i of e){const o=i.type;if(o==="element"||o==="text-match"||o==="multiline-element"){const l=i.dependencies;for(const u of l)t.hasNode(u)||ete(173,u.getType())}}const a=(i,o,l)=>{(function(u,d,h,m){const x=u.getParent();if(!na(x)||u.getFirstChild()!==d)return!1;const p=d.getTextContent();if(p[h-1]!==" ")return!1;for(const{regExp:v,replace:_}of m){const S=p.match(v);if(S&&S[0].length===(S[0].endsWith(" ")?h:h-1)){const w=d.getNextSiblings(),[y,b]=d.splitText(h);if(_(u,b?[b,...w]:w,S,!1)!==!1)return y.remove(),!0}}return!1})(i,o,l,r.element)||function(u,d,h,m){const x=u.getParent();if(!na(x)||u.getFirstChild()!==d)return!1;const p=d.getTextContent();if(p[h-1]!==" ")return!1;for(const{regExpStart:v,replace:_,regExpEnd:S}of m){if(S&&!("optional"in S)||S&&"optional"in S&&!S.optional)continue;const w=p.match(v);if(w&&w[0].length===(w[0].endsWith(" ")?h:h-1)){const y=d.getNextSiblings(),[b,E]=d.splitText(h);if(_(u,E?[E,...y]:y,w,null,null,!1)!==!1)return b.remove(),!0}}return!1}(i,o,l,r.multilineElement)||function(u,d,h){let m=u.getTextContent();const x=h[m[d-1]];if(x==null)return!1;d<m.length&&(m=m.slice(0,d));for(const p of x){if(!p.replace||!p.regExp)continue;const v=m.match(p.regExp);if(v===null)continue;const _=v.index||0,S=_+v[0].length;let w;return _===0?[w]=u.splitText(S):[,w]=u.splitText(_,S),w.selectNext(0,0),p.replace(w,v),!0}return!1}(o,l,s)||function(u,d,h){const m=u.getTextContent(),x=d-1,p=m[x],v=h[p];if(!v)return!1;for(const _ of v){const{tag:S}=_,w=S.length,y=x-w+1;if(w>1&&!rO(m,y,S,0,w)||m[y-1]===" ")continue;const b=m[x+1];if(_.intraword===!1&&b&&!WA.test(b))continue;const E=u;let N=E,F=VA(m,y,S),T=N;for(;F<0&&(T=T.getPreviousSibling())&&!qo(T);)if(gt(T)){if(T.hasFormat("code"))continue;const K=T.getTextContent();N=T,F=VA(K,K.length,S)}if(F<0||N===E&&F+w===y)continue;const P=N.getTextContent();if(F>0&&P[F-1]===p)continue;const D=P[F-1];if(_.intraword===!1&&D&&!WA.test(D))continue;const R=E.getTextContent(),I=R.slice(0,y)+R.slice(x+1);E.setTextContent(I);const W=N===E?I:P;N.setTextContent(W.slice(0,F)+W.slice(F+w));const le=mt(),q=cv();Es(q);const V=x-w*(N===E?2:1)+1;q.anchor.set(N.__key,F,"text"),q.focus.set(E.__key,V,"text");for(const K of _.format)q.hasFormat(K)||q.formatText(K);q.anchor.set(q.focus.key,q.focus.offset,q.focus.type);for(const K of _.format)q.hasFormat(K)&&q.toggleFormat(K);return st(le)&&(q.format=le.format),!0}}(o,l,n)};return t.registerUpdateListener(({tags:i,dirtyLeaves:o,editorState:l,prevEditorState:u})=>{if(i.has(sR)||i.has(w1)||t.isComposing())return;const d=l.read(mt),h=u.read(mt);if(!st(h)||!st(d)||!d.isCollapsed()||d.is(h))return;const m=d.anchor.key,x=d.anchor.offset,p=l._nodeMap.get(m);!gt(p)||!o.has(m)||x!==1&&x>h.anchor.offset+1||t.update(()=>{if(!Zee(p))return;const v=p.getParent();v===null||TT(v)||a(v,p,d.anchor.offset)})})}const rte=/^(\s*)(\d{1,})\.\s/,nte=/^(\s*)[-*+]\s/,ste=/^(#{1,6})\s/,ate=/^>\s/,ite=/^[ \t]*```([\w-]+)?/,ote=/[ \t]*```$/,nO=t=>(e,r,n,s)=>{const a=t(n);a.append(...r),e.replace(a),s||a.select(0,0)},sO=t=>(e,r,n,s)=>{const a=e.getPreviousSibling(),i=e.getNextSibling(),o=Ma(t==="check"?n[3]==="x":void 0);if(Qt(i)&&i.getListType()===t){const u=i.getFirstChild();u!==null?u.insertBefore(o):i.append(o),e.remove()}else if(Qt(a)&&a.getListType()===t)a.append(o),e.remove();else{const u=_a(t,t==="number"?Number(n[2]):void 0);u.append(o),e.replace(u)}o.append(...r),s||o.select(0,0);const l=function(u){const d=u.match(/\t/g),h=u.match(/ /g);let m=0;return d&&(m+=d.length),h&&(m+=Math.floor(h.length/4)),m}(n[1]);l&&o.setIndent(l)},NT=(t,e,r)=>{const n=[],s=t.getChildren();let a=0;for(const i of s)if(Nr(i)){if(i.getChildrenSize()===1){const d=i.getFirstChild();if(Qt(d)){n.push(NT(d,e,r+1));continue}}const o=" ".repeat(4*r),l=t.getListType(),u=l==="number"?`${t.getStart()+a}. `:l==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(o+u+e(i)),a++}return n.join(`
`)},lte={dependencies:[vv],export:(t,e)=>{if(!see(t))return null;const r=Number(t.getTag().slice(1));return"#".repeat(r)+" "+e(t)},regExp:ste,replace:nO(t=>{const e="h"+t[1].length;return su(e)}),type:"element"},cte={dependencies:[xv],export:(t,e)=>{if(!_A(t))return null;const r=e(t).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:ate,replace:(t,e,r,n)=>{if(n){const a=t.getPreviousSibling();if(_A(a))return a.splice(a.getChildrenSize(),0,[So(),...e]),void t.remove()}const s=yv();s.append(...e),t.replace(s),n||s.select(0,0)},type:"element"},ute={dependencies:[ch],export:t=>{if(!TT(t))return null;const e=t.getTextContent();return"```"+(t.getLanguage()||"")+(e?`
`+e:"")+"\n```"},regExpEnd:{optional:!0,regExp:ote},regExpStart:ite,replace:(t,e,r,n,s,a)=>{let i,o;if(!e&&s){if(s.length===1)n?(i=Xo(),o=r[1]+s[0]):(i=Xo(r[1]),o=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=Xo(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();o=s.join(`
`)}const l=An(o);i.append(l),t.append(i)}else e&&nO(l=>Xo(l?l[1]:void 0))(t,e,r,a)},type:"multiline-element"},dte={dependencies:[td,Nc],export:(t,e)=>Qt(t)?NT(t,e,0):null,regExp:nte,replace:sO("bullet"),type:"element"},fte={dependencies:[td,Nc],export:(t,e)=>Qt(t)?NT(t,e,0):null,regExp:rte,replace:sO("number"),type:"element"},hte={format:["code"],tag:"`",type:"text-format"},gte={format:["highlight"],tag:"==",type:"text-format"},mte={format:["bold","italic"],tag:"***",type:"text-format"},pte={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},xte={format:["bold"],tag:"**",type:"text-format"},yte={format:["bold"],intraword:!1,tag:"__",type:"text-format"},vte={format:["strikethrough"],tag:"~~",type:"text-format"},wte={format:["italic"],tag:"*",type:"text-format"},_te={format:["italic"],intraword:!1,tag:"_",type:"text-format"},Ste={dependencies:[rd],export:(t,e,r)=>{if(!Yee(t)||Jee(t))return null;const n=t.getTitle(),s=e(t);return n?`[${s}](${t.getURL()} "${n}")`:`[${s}](${t.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(t,e)=>{const[,r,n,s]=e,a=T1(n,{title:s}),i=r.split("[").length-1,o=r.split("]").length-1;let l=r,u="";if(i<o)return;if(i>o){const h=r.split("[");u="["+h[0],l=h.slice(1).join("[")}const d=An(l);return d.setFormat(t.getFormat()),a.append(d),t.replace(a),u&&a.insertBefore(An(u)),d},trigger:")",type:"text-match"},bte=[lte,cte,dte,fte],kte=[ute],Cte=[hte,mte,pte,xte,yte,gte,wte,_te,vte],Tte=[Ste],AT=[...bte,...kte,...Cte,...Tte];function GA(t,e){return t.getEditorState().read(()=>{const r=Vn(e);return r!==null&&r.isSelected()})}function Ete(t){const[e]=To(),[r,n]=k.useState(()=>GA(e,t));return k.useEffect(()=>{let s=!0;const a=e.registerUpdateListener(()=>{s&&n(GA(e,t))});return()=>{s=!1,a()}},[e,t]),[r,k.useCallback(s=>{e.update(()=>{let a=mt();Os(a)||(a=qC(),Es(a)),Os(a)&&(s?a.add(t):a.delete(t))})},[e,t]),k.useCallback(()=>{e.update(()=>{const s=mt();Os(s)&&s.clear()})},[e])]}function Nte({nodeKey:t}){const[e]=To(),[r,n,s]=Ete(t);return k.useEffect(()=>ed(e.registerCommand(HC,a=>{const i=e.getElementByKey(t);return a.target===i&&(a.shiftKey||s(),n(!r),!0)},Rd)),[s,e,r,t,n]),k.useEffect(()=>{const a=e.getElementByKey(t),i=e._config.theme.hrSelected??"selected";a!==null&&(r?Jn(a,i):tc(a,i))},[e,r,t]),null}class am extends tT{static getType(){return"horizontalrule"}static clone(e){return new am(e.__key)}static importJSON(e){return FT().updateFromJSON(e)}static importDOM(){return{hr:()=>({conversion:Ate,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(e){const r=document.createElement("hr");return Jn(r,e.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return c.jsx(Nte,{nodeKey:this.__key})}}function Ate(){return{node:FT()}}function FT(){return oa(new am)}function Fte(t){return t instanceof am}const jte=[{dependencies:[am],export:t=>Fte(t)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(t,e,r,n)=>{const s=FT();n||t.getNextSibling()!=null?t.replace(s):t.insertBefore(s),s.selectNext()},type:"element"},...AT];function Pte({transformers:t=jte}){const[e]=To();return k.useEffect(()=>tte(e,t),[e,t]),null}function Dte({hasStrictIndent:t=!1}){const[e]=To();return k.useEffect(()=>{if(!e.hasNodes([td,Nc]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")},[e]),k.useEffect(()=>{if(t)return $ee(e)},[e,t]),function(r){k.useEffect(()=>Uee(r),[r])}(e),null}const Rte=({onChange:t})=>{const[e]=k.useContext(nv)||[];return k.useEffect(()=>{if(t&&e)return e.registerUpdateListener(({editorState:r})=>{r.read(()=>{gn().getTextContent();const s=r.toJSON();t(JSON.stringify(s))})})},[e,t]),null},Ote=()=>{const[t]=k.useContext(nv)||[],e=k.useCallback(()=>{t&&t.dispatchCommand(ci,"bold")},[t]),r=k.useCallback(()=>{t&&t.dispatchCommand(ci,"italic")},[t]),n=k.useCallback(()=>{t&&t.dispatchCommand(ci,"underline")},[t]),s=k.useCallback(()=>{t&&t.dispatchCommand(ci,"strikethrough")},[t]),a=k.useCallback(x=>{t&&t.update(()=>{const p=mt();st(p)&&Z2(p,()=>su(x))})},[t]),i=k.useCallback(()=>{t&&t.update(()=>{const x=mt();st(x)&&Z2(x,()=>tn())})},[t]);k.useCallback(()=>{t&&t.update(()=>{const x=mt();st(x)&&Z2(x,()=>yv())})},[t]);const o=k.useCallback(()=>{t&&t.dispatchCommand(YR)},[t]),l=k.useCallback(()=>{t&&t.dispatchCommand(JR)},[t]),u=k.useCallback(()=>{t&&t.dispatchCommand(QR)},[t]),d=k.useCallback(x=>{t&&t.update(()=>{const p=mt();st(p)&&p.getNodes().forEach(v=>{gt(v)&&v.setStyle(`color: ${x}`)})})},[t]),h=k.useCallback(x=>{t&&t.update(()=>{const p=mt();st(p)&&p.getNodes().forEach(v=>{(v.getType()==="paragraph"||v.getType()==="heading")&&v.setStyle(`font-size: ${x}px`)})})},[t]),m=k.useCallback(x=>{t&&t.dispatchCommand(MD,x)},[t]);return c.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:e,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),c.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),c.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),c.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),c.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),c.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),c.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:o,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:" List"}),c.jsx("button",{type:"button",onClick:l,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),c.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),c.jsx("button",{type:"button",onClick:()=>d("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),c.jsx("button",{type:"button",onClick:()=>d("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),c.jsx("button",{type:"button",onClick:()=>d("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),c.jsx("button",{type:"button",onClick:()=>d("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),c.jsx("button",{type:"button",onClick:()=>h(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),c.jsx("button",{type:"button",onClick:()=>h(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),c.jsx("button",{type:"button",onClick:()=>h(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),c.jsx("button",{type:"button",onClick:()=>h(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),c.jsx("button",{type:"button",onClick:()=>m("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:""}),c.jsx("button",{type:"button",onClick:()=>m("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:""}),c.jsx("button",{type:"button",onClick:()=>m("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:""})]})]})},Mte=({value:t,onChange:e,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[vv,td,Nc,xv,ch,ET,wv,rm,nm,sm,rd],onError:s=>{console.error("Lexical error:",s)},editorState:t?(()=>{try{const s=JSON.parse(t);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:t,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return c.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:c.jsxs(kZ,{initialConfig:n,children:[c.jsx(Ote,{}),c.jsx(Rte,{onChange:e}),c.jsxs("div",{className:"relative",children:[c.jsx(iee,{contentEditable:c.jsx(uee,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:c.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:bee}),c.jsx(wee,{}),c.jsx(_ee,{}),c.jsx(Dte,{}),c.jsx(Pte,{transformers:AT})]})]})})},Lte=({testName:t="",onTestSaved:e,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=Dn();fl();const{showNotification:o}=ka(),[l,u]=k.useState({test_name:t,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[d,h]=k.useState({isLoading:!1,error:null,showPreview:!0});k.useEffect(()=>{u(w=>({...w,test_name:t||""}))},[t]);const m=()=>{if(l.num_questions>=3){h(b=>({...b,error:"Maximum 3 questions allowed for performance reasons"}));return}const y={id:Math.max(...l.questions.map(b=>b.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};u(b=>({...b,num_questions:b.num_questions+1,questions:[...b.questions,y]}))},x=w=>{l.questions.length<=1||u(y=>({...y,num_questions:y.num_questions-1,questions:y.questions.filter(b=>b.id!==w)}))},p=(w,y)=>{u(b=>({...b,questions:b.questions.map(E=>E.id===w?{...E,question_json:y}:E)}))},v=(w,y,b)=>{u(E=>({...E,questions:E.questions.map(N=>N.id===w?{...N,canvas_width:y,canvas_height:b}:N)}))},_=(w,y,b)=>{u(E=>({...E,questions:E.questions.map(N=>N.id===w?{...N,max_canvas_width:y,max_canvas_height:b}:N)}))},S=async()=>{if(!l.test_name.trim()){h(w=>({...w,error:"Test name is required"}));return}if(l.questions.some(w=>!w.question_json.trim())){h(w=>({...w,error:"All questions must have content"}));return}h(w=>({...w,isLoading:!0,error:null}));try{const w={test_name:l.test_name,num_questions:l.num_questions,passing_score:l.passing_score,questions:l.questions.map((y,b)=>({question_id:b+1,question_json:y.question_json,canvas_width:y.canvas_width,canvas_height:y.canvas_height,max_canvas_width:y.max_canvas_width,max_canvas_height:y.max_canvas_height}))};e&&e(w)}catch(w){console.error("Error preparing drawing test:",w),h(y=>({...y,error:"Failed to prepare drawing test. Please try again."})),o("Failed to prepare drawing test","error")}finally{h(w=>({...w,isLoading:!1}))}};return c.jsx("div",{className:"drawing-test-creator max-w-4xl mx-auto p-6",children:c.jsxs(at,{className:"p-6",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),c.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",l.num_questions,"/3)"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),c.jsxs(Ge,{onClick:m,disabled:l.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),c.jsx("div",{className:"space-y-4",children:l.questions.map((w,y)=>c.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",y+1]}),l.questions.length>1&&c.jsx(Ge,{onClick:()=>x(w.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),c.jsx(Mte,{value:w.question_json,onChange:b=>p(w.id,b),placeholder:""})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Canvas Dimensions"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Base Width"}),c.jsx("input",{type:"number",value:w.canvas_width,onChange:b=>v(w.id,parseInt(b.target.value),w.canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Base Height"}),c.jsx("input",{type:"number",value:w.canvas_height,onChange:b=>v(w.id,w.canvas_width,parseInt(b.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Max Width"}),c.jsx("input",{type:"number",value:w.max_canvas_width,onChange:b=>_(w.id,parseInt(b.target.value),w.max_canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Max Height"}),c.jsx("input",{type:"number",value:w.max_canvas_height,onChange:b=>_(w.id,w.max_canvas_width,parseInt(b.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]})]})]})]},w.id))})]}),d.error&&c.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:d.error}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx(Ge,{onClick:r,variant:"secondary",disabled:d.isLoading,children:"Cancel"}),c.jsx(Ge,{onClick:S,variant:"primary",disabled:d.isLoading||!l.test_name.trim(),className:"flex items-center gap-2",children:d.isLoading?c.jsxs(c.Fragment,{children:[c.jsx(dr,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})})},Ite=({question:t,testId:e,testType:r="true_false",mode:n="student",onAnswerChange:s,onQuestionChange:a,onSave:i,isEditing:o=!1,isSaving:l=!1,validationErrors:u={},showCorrectAnswers:d=!1,studentId:h=null})=>{const{getItem:m,setItem:x}=Bk();ka(),k.useRef(null);const[p,v]=k.useState(""),[_,S]=k.useState(""),[w,y]=k.useState(""),[b,E]=k.useState(!1),[N,F]=k.useState(!0),[T,P]=k.useState(""),[D,R]=k.useState(!1),[I,W]=k.useState(null);k.useEffect(()=>{if(t&&(y(t.question||""),S(t.correct_answer||""),n==="student"&&h)){const J=m(`test_progress_${h}_${r}_${e}_${t.question_id}`);J&&v(J)}},[t,e,r,n,m]),k.useEffect(()=>{if(n==="student"&&p&&e&&(t!=null&&t.question_id)&&h){const J=setTimeout(()=>{R(!0),x(`test_progress_${h}_${r}_${e}_${t.question_id}`,p),W(new Date().toLocaleTimeString()),setTimeout(()=>R(!1),1e3)},1e3);return()=>clearTimeout(J)}},[p,e,r,t==null?void 0:t.question_id,n,h,x]),k.useEffect(()=>{if(n==="teacher"&&(w||_)){const J=setTimeout(()=>{R(!0);const te={question:w,correct_answer:_,timestamp:Date.now()};x(`teacher_form_${r}_${e}`,te),W(new Date().toLocaleTimeString()),setTimeout(()=>R(!1),1e3)},2e3);return()=>clearTimeout(J)}},[w,_,e,r,n,x]);const le=k.useCallback(J=>{n==="student"&&(v(J),s&&s(t.question_id,J),K(J))},[n,t==null?void 0:t.question_id,s]),q=k.useCallback(J=>{y(J),a&&a(t.question_id,J),U(J)},[t==null?void 0:t.question_id,a]),V=k.useCallback(J=>{S(J),a&&a(t.question_id,{...t,correct_answer:J}),L(J)},[t,a]),K=k.useCallback(J=>{if(n==="student"){if(!J){F(!1),P("Please select an answer");return}F(!0),P("")}},[n]),U=k.useCallback(J=>{if(n==="teacher"){if(!J||J.trim().length<10){F(!1),P("Question must be at least 10 characters long");return}F(!0),P("")}},[n]),L=k.useCallback(J=>{if(n==="teacher"){if(!J){F(!1),P("Please select a correct answer");return}F(!0),P("")}},[n]),Z=k.useCallback(()=>{if(n!=="teacher"||!i)return;const J={question_id:t.question_id,question:w,correct_answer:_,type:"true_false"};i(J)},[n,i,t==null?void 0:t.question_id,w,_]),ne=k.useCallback(J=>J?J.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),z=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",t==null?void 0:t.question_id]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[D&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(dr,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),I&&!D&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",I]})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:ne(w)}}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${p==="true"?"border-blue-500 bg-blue-50":"border-gray-200"} ${d&&_==="true"?"ring-2 ring-green-400":""}`,children:[c.jsx("input",{type:"radio",name:`question_${t==null?void 0:t.question_id}`,value:"true",checked:p==="true",onChange:()=>le("true"),className:"sr-only","aria-label":"True"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${p==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:p==="true"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${p==="false"?"border-blue-500 bg-blue-50":"border-gray-200"} ${d&&_==="false"?"ring-2 ring-green-400":""}`,children:[c.jsx("input",{type:"radio",name:`question_${t==null?void 0:t.question_id}`,value:"false",checked:p==="false",onChange:()=>le("false"),className:"sr-only","aria-label":"False"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${p==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:p==="false"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]}),!N&&T&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:T})]}),Y=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",(t==null?void 0:t.question_id)||"New Question"]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[D&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(dr,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),I&&!D&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",I]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${t==null?void 0:t.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("textarea",{id:`question_${t==null?void 0:t.question_id}`,value:w,onChange:J=>q(J.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${_==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[c.jsx("input",{type:"radio",name:`correct_${t==null?void 0:t.question_id}`,value:"true",checked:_==="true",onChange:()=>V("true"),className:"sr-only","aria-label":"True"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${_==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:_==="true"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${_==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[c.jsx("input",{type:"radio",name:`correct_${t==null?void 0:t.question_id}`,value:"false",checked:_==="false",onChange:()=>V("false"),className:"sr-only","aria-label":"False"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${_==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:_==="false"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!N&&T&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:T}),c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(Ge,{variant:"success",onClick:Z,disabled:!N||l,className:"w-full sm:w-auto",children:l?c.jsx(dr,{size:"small"}):"Save Question"})})]});return c.jsx("div",{className:"true-false-question-container",children:n==="student"?z():Y()})},Bte=({question:t,testId:e,testType:r="multiple_choice",mode:n="student",onAnswerChange:s,onQuestionChange:a,onOptionAdd:i,onOptionRemove:o,onSave:l,isEditing:u=!1,isSaving:d=!1,validationErrors:h={},showCorrectAnswers:m=!1,studentId:x=null})=>{const{getItem:p,setItem:v}=Bk(),{showNotification:_}=ka();k.useRef(null);const[S,w]=k.useState(""),[y,b]=k.useState(["","","",""]),[E,N]=k.useState(""),[F,T]=k.useState(""),[P,D]=k.useState(!1),[R,I]=k.useState(!0),[W,le]=k.useState(""),[q,V]=k.useState(!1),[K,U]=k.useState(null);k.useEffect(()=>{if(t&&(T(t.question||""),b(t.options||["","","",""]),N(t.correct_answer||""),n==="student"&&x)){const ve=p(`test_progress_${x}_${r}_${e}_${t.question_id}`);ve&&w(ve)}},[t,e,r,n,p]),k.useEffect(()=>{if(n==="student"&&S&&e&&(t!=null&&t.question_id)&&x){const ve=setTimeout(()=>{V(!0),v(`test_progress_${x}_${r}_${e}_${t.question_id}`,S),U(new Date().toLocaleTimeString()),setTimeout(()=>V(!1),1e3)},1e3);return()=>clearTimeout(ve)}},[S,e,r,t==null?void 0:t.question_id,n,x,v]),k.useEffect(()=>{if(n==="teacher"&&(F||y.some(ve=>ve.trim()))){const ve=setTimeout(()=>{V(!0);const we={question:F,options:y,correct_answer:E,timestamp:Date.now()};v(`teacher_form_${r}_${e}`,we),U(new Date().toLocaleTimeString()),setTimeout(()=>V(!1),1e3)},2e3);return()=>clearTimeout(ve)}},[F,y,E,e,r,n,v]);const L=k.useCallback(ve=>{if(n!=="student")return;const we=String(ve);w(we),s&&s(t.question_id,we),te(we)},[n,t==null?void 0:t.question_id,s]),Z=k.useCallback(ve=>{T(ve),a&&a(t.question_id,ve),de(ve)},[t==null?void 0:t.question_id,a]),ne=k.useCallback((ve,we)=>{const Oe=[...y];Oe[ve]=we,b(Oe),a&&a(t.question_id,{...t,options:Oe}),ee(Oe)},[y,t,a]),z=k.useCallback(ve=>{N(ve),a&&a(t.question_id,{...t,correct_answer:ve}),ge(ve)},[t,a]),Y=k.useCallback(()=>{if(y.length<6){const ve=[...y,""];b(ve),i&&i(t.question_id,ve)}else _("Maximum 6 options allowed","warning")},[y,t==null?void 0:t.question_id,i,_]),J=k.useCallback(ve=>{if(y.length>2){const we=y.filter((Oe,Ze)=>Ze!==ve);if(b(we),E===String.fromCharCode(65+ve))N("");else if(E&&String.fromCharCode(65+ve)<E){const Oe=String.fromCharCode(65+ve-1);N(Oe)}o&&o(t.question_id,we)}else _("Minimum 2 options required","warning")},[y,E,t==null?void 0:t.question_id,o,_]),te=k.useCallback(ve=>{if(n==="student"){if(!ve){I(!1),le("Please select an answer");return}I(!0),t!=null&&t.correct_answer&&ve===t.correct_answer?le(" Correct answer!"):t!=null&&t.correct_answer?le(" Incorrect answer"):le("Answer selected")}},[n,t==null?void 0:t.correct_answer]),de=k.useCallback(ve=>{if(n==="teacher"){if(!ve||ve.trim().length<10){I(!1),le("Question must be at least 10 characters long");return}I(!0),le("")}},[n]),ee=k.useCallback(ve=>{if(n!=="teacher")return;if(ve.filter(Oe=>Oe.trim().length>0).length<2){I(!1),le("At least 2 options must be filled");return}if(ve.some(Oe=>Oe.trim().length>0&&Oe.trim().length<3)){I(!1),le("Each option must be at least 3 characters long");return}I(!0),le("")},[n]),ge=k.useCallback(ve=>{if(n==="teacher"){if(!ve){I(!1),le("Please select a correct answer");return}I(!0),le("")}},[n]),fe=k.useCallback(()=>{if(n!=="teacher"||!l)return;const ve={question_id:t.question_id,question:F,options:y.filter(we=>we.trim().length>0),correct_answer:E,type:"multiple_choice"};l(ve)},[n,l,t==null?void 0:t.question_id,F,y,E]),ye=k.useCallback(ve=>ve?ve.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),Ce=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",t==null?void 0:t.question_id]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[q&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(dr,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),K&&!q&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",K]})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:ye(F)}}),c.jsx("div",{className:"space-y-3",children:y.map((ve,we)=>{if(!ve.trim())return null;const Oe=String.fromCharCode(65+we),Ze=S===String(we),Re=m&&E===Oe;return c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${Ze?"border-blue-500 bg-blue-50":"border-gray-200"} ${Re?"ring-2 ring-green-400":""}`,children:[c.jsx("input",{type:"radio",name:`question_${t==null?void 0:t.question_id}`,value:we,checked:Ze,onChange:()=>L(we),className:"sr-only","aria-label":`Option ${Oe}: ${ve}`}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${Ze?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:Ze&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsxs("span",{className:"text-gray-800 font-medium",children:[c.jsxs("span",{className:"font-semibold text-gray-600 mr-2",children:[Oe,")"]}),ve]})]},we)})}),!R&&W&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:W})]}),re=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",(t==null?void 0:t.question_id)||"New Question"]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[q&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(dr,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),K&&!q&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",K]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${t==null?void 0:t.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("textarea",{id:`question_${t==null?void 0:t.question_id}`,value:F,onChange:ve=>Z(ve.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),c.jsx(Ge,{variant:"secondary",size:"small",onClick:Y,disabled:y.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),c.jsx("div",{className:"space-y-3",children:y.map((ve,we)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+we)}),c.jsx("input",{type:"text",value:ve,onChange:Oe=>ne(we,Oe.target.value),placeholder:`Option ${String.fromCharCode(65+we)}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0}),y.length>2&&c.jsx(Ge,{variant:"danger",size:"small",onClick:()=>J(we),className:"px-2 py-1 text-sm",children:""})]},we))})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:`correct_${t==null?void 0:t.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),c.jsxs("select",{id:`correct_${t==null?void 0:t.question_id}`,value:E,onChange:ve=>z(ve.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[c.jsx("option",{value:"",children:"Select correct answer"}),y.map((ve,we)=>{if(!ve.trim())return null;const Oe=String.fromCharCode(65+we);return c.jsxs("option",{value:Oe,children:[Oe,") ",ve]},we)})]})]})]}),!R&&W&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:W}),c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(Ge,{variant:"success",onClick:fe,disabled:!R||d,className:"w-full sm:w-auto",children:d?c.jsx(dr,{size:"small"}):"Save Question"})})]});return c.jsx("div",{className:"multiple-choice-question-container",children:n==="student"?Ce():re()})},Ute=({question:t,testId:e,testType:r="input",mode:n="student",onAnswerChange:s,onQuestionChange:a,onAnswerAdd:i,onAnswerRemove:o,onSave:l,isEditing:u=!1,isSaving:d=!1,validationErrors:h={},showCorrectAnswers:m=!1,studentId:x=null})=>{const{getItem:p,setItem:v}=Bk(),{showNotification:_}=ka(),S=k.useRef(null),[w,y]=k.useState(""),[b,E]=k.useState([""]),[N,F]=k.useState(!1),[T,P]=k.useState(!0),[D,R]=k.useState(""),[I,W]=k.useState(!1);k.useEffect(()=>{if(n==="student"&&(t!=null&&t.question_id)&&e&&r&&x){const te=`test_progress_${x}_${r}_${e}_${t.question_id}`,de=p(te);de&&y(de)}},[t==null?void 0:t.question_id,r,e,n,x,p]),k.useEffect(()=>{n==="teacher"&&(t!=null&&t.answers)&&E(t.answers.length>0?t.answers:[""])},[t==null?void 0:t.answers,n]),k.useEffect(()=>{if(n==="student"&&w&&(t!=null&&t.question_id)&&e&&r&&x){const te=setTimeout(()=>{W(!0),v(`test_progress_${x}_${r}_${e}_${t.question_id}`,w),setTimeout(()=>W(!1),1e3)},1e3);return()=>clearTimeout(te)}},[w,t==null?void 0:t.question_id,r,e,n,x,v]),k.useEffect(()=>{if(n==="teacher"&&b&&a){const te=setTimeout(()=>{a({...t,answers:b.filter(de=>de.trim())})},500);return()=>clearTimeout(te)}},[b,t,n,a]);const le=k.useCallback(te=>{y(te);const de=te.trim().length>0;P(de),R(de?"":"Please enter an answer"),s&&s(t.question_id,te)},[t==null?void 0:t.question_id,s]),q=k.useCallback((te,de)=>{const ee=[...b];ee[te]=de,E(ee),s&&s(t.question_id,ee)},[b,t==null?void 0:t.question_id,s]),V=k.useCallback(()=>{if(n==="teacher"){const te=[...b,""];E(te),i&&i(t.question_id,te)}},[b,t==null?void 0:t.question_id,n,i]),K=k.useCallback(te=>{if(n==="teacher"&&b.length>1){const de=b.filter((ee,ge)=>ge!==te);E(de),o&&o(t.question_id,de)}},[b,t==null?void 0:t.question_id,n,o]),U=k.useCallback(()=>{if(n==="student"){const te=w.trim().length>0;return P(te),R(te?"":"Please enter an answer"),te}else if(n==="teacher"){const te=b.some(de=>de.trim().length>0);return P(te),R(te?"":"Please enter at least one correct answer"),te}return!0},[w,b,n]),L=k.useCallback(te=>te?te.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"",[]),Z=k.useCallback(()=>{F(!0)},[]),ne=k.useCallback(()=>{F(!1),U()},[U]),z=k.useCallback(te=>{te.key==="Enter"&&n==="student"&&w.trim()&&(v(`test_progress_${r}_${e}_${t.question_id}`,w),_("Answer saved","success"))},[w,r,e,t==null?void 0:t.question_id,n,v,_]);k.useEffect(()=>{S.current&&n==="student"&&S.current.focus()},[n]);const Y=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",t.question_id]}),I&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[c.jsx(dr,{size:"small"}),c.jsx("span",{children:"Saving..."})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:L(t.question)}}),c.jsx("div",{className:"space-y-3",children:c.jsx("input",{ref:S,type:"text",id:`input_${t.question_id}`,placeholder:"Enter your answer here...",value:w,onChange:te=>le(te.target.value),onFocus:Z,onBlur:ne,onKeyPress:z,className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${T?N?"border-blue-500":"border-gray-300 hover:border-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500"}`,"data-question-id":t.question_id,"aria-label":`Answer for question ${t.question_id}`,"aria-invalid":!T,"aria-describedby":T?void 0:`error-${t.question_id}`})}),m&&t.correct_answers&&c.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[c.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),c.jsx("ul",{className:"space-y-1",children:t.correct_answers.map((te,de)=>c.jsxs("li",{className:"text-green-700 text-sm",children:[" ",te]},de))})]})]}),J=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",t.question_id||"New"]}),d&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[c.jsx(dr,{size:"small"}),c.jsx("span",{children:"Saving..."})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${t.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("input",{type:"text",id:`question_${t.question_id||"new"}`,value:t.question||"",onChange:te=>a&&a({...t,question:te.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${h.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),h.question&&c.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:h.question})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),c.jsx(Ge,{type:"button",variant:"secondary",size:"small",onClick:V,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),c.jsx("div",{className:"space-y-3",children:b.map((te,de)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:de+1}),c.jsx("input",{type:"text",value:te,onChange:ee=>q(de,ee.target.value),placeholder:`Correct answer ${de+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":t.question_id,"data-answer-index":de}),b.length>1&&c.jsx(Ge,{type:"button",variant:"danger",size:"small",onClick:()=>K(de),className:"px-2 py-1 text-sm",children:" Remove"})]},de))}),h.answers&&c.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:h.answers})]})]}),l&&c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(Ge,{type:"button",variant:"success",onClick:l,disabled:d,className:"w-full sm:w-auto",children:d?c.jsx(dr,{size:"small"}):"Save Question"})})]});return c.jsx("div",{className:`input-question-container ${n} ${N?"focused":""}`,children:n==="student"?Y():J()})},Ou=({isOpen:t=!1,onClose:e,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:o="",...l})=>{if(!t)return null;const u=h=>{i&&h.target===h.currentTarget&&e()};ls.useEffect(()=>{const h=m=>{m.key==="Escape"&&e()};return t&&(document.addEventListener("keydown",h),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",h),document.body.style.overflow="unset"}},[t,e]);const d={small:"max-w-sm",medium:"max-w-md",large:"max-w-2xl"};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:u,role:"dialog","aria-modal":"true","aria-label":r,...l,children:c.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-6
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${d[s]} mx-auto
          ${o}
        `,onClick:h=>h.stopPropagation(),children:[(r||a)&&c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&c.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&c.jsx(Ge,{variant:"secondary",size:"small",onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200","aria-label":"Close modal",children:""})]}),c.jsx("div",{className:"space-y-6",children:n})]})})},_v=(t,e,r)=>{const[n,s]=k.useState(!1),[a,i]=k.useState(0),[o,l]=k.useState(!1),u=k.useRef(!1);k.useEffect(()=>{if(!t||!e||!r)return;const _=`anti_cheating_${r}_${t}_${e}`,S=wn(_);S&&(i(S.tabSwitches||0),l(S.isCheating||!1))},[t,e,r]);const d=k.useCallback(()=>{if(console.log(" handleTabSwitch called - isTracking:",u.current),!u.current){console.log(" Not tracking, returning early");return}console.log(" Tab switch detected - starting 7 second timer...");const _=Date.now();setTimeout(()=>{const S=Date.now()-_;console.log(" Timer completed - time hidden:",S,"ms"),S>=6500?(console.log(" Tab was hidden for sufficient time - counting as tab switch"),i(w=>{const y=w+1,b=y>=2;console.log(" Tab switch count updated:",{newCount:y,cheating:b}),l(b);const E=`anti_cheating_${r}_${t}_${e}`;return Zr(E,{tabSwitches:y,isCheating:b},2*60*1e3),y})):console.log(" Tab was not hidden long enough - not counting as switch")},7e3)},[t,e,r]),h=k.useCallback(()=>{u.current&&(console.log(" Visibility change detected:",{hidden:document.hidden,isTracking:u.current}),document.hidden?d():console.log(" Tab became visible"))},[d]),m=k.useCallback(()=>{console.log(" startTracking called - setting up anti-cheating detection"),console.log(" Current document.hidden state:",document.hidden),console.log(" Current document.visibilityState:",document.visibilityState),s(!0),u.current=!0,document.addEventListener("visibilitychange",h),console.log(" Anti-cheating event listeners added (visibilitychange only)")},[h]),x=k.useCallback(()=>{console.log(" stopTracking called - removing anti-cheating detection"),s(!1),u.current=!1,document.removeEventListener("visibilitychange",h),console.log(" Anti-cheating event listeners removed")},[h]),p=k.useCallback(()=>{const _={caught_cheating:o,visibility_change_times:a};return console.log(" getCheatingData called:",_),_},[o,a]),v=k.useCallback(()=>{r&&t&&e&&Lg(r,t,e),i(0),l(!1),console.log(" Anti-cheating data deleted from localStorage")},[r,t,e]);return{startTracking:m,stopTracking:x,clearData:v,getCheatingData:p,tabSwitches:a,isCheating:o,isTracking:n}},$te=({testData:t,onTestComplete:e,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=k.useState(null),[o,l]=k.useState(null);k.useEffect(()=>{(async()=>{try{const[Pe,Ue]=await Promise.all([xx(()=>Promise.resolve().then(()=>DQ),void 0),xx(()=>Promise.resolve().then(()=>pJ),void 0)]);i(Pe),l(Ue.default)}catch(Pe){console.error("Failed to load Konva:",Pe)}})()},[]);const u=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[d,h]=k.useState({}),[m,x]=k.useState({}),[p,v]=k.useState(0),[_,S]=k.useState(!1),[w,y]=k.useState(null),[b,E]=k.useState(0),[N,F]=k.useState(0),[T,P]=k.useState(null),[D,R]=k.useState(null),[I,W]=k.useState(!1),[le,q]=k.useState(!1),{showNotification:V}=ka(),{makeAuthenticatedRequest:K}=fl(),{user:U}=Dn(),{startTracking:L,stopTracking:Z,getCheatingData:ne,clearData:z}=_v("matching_type",t==null?void 0:t.id,(U==null?void 0:U.student_id)||(U==null?void 0:U.id)),Y=k.useRef(null),J=k.useRef(null),te=k.useRef(null),de=k.useRef(0),[ee,ge]=k.useState(400);k.useRef({});const fe=k.useCallback(()=>{W(!0)},[]),ye=k.useCallback(()=>{x({}),h({}),W(!1)},[]),Ce=k.useCallback(()=>{q(!0)},[]),re=k.useCallback(()=>{q(!1),r()},[r]),ve=k.useMemo(()=>{if(!t)return null;const Ae=t.blocks.map(We=>{let Xe=We.coordinates;if(typeof Xe=="string")try{Xe=JSON.parse(Xe)}catch(ut){console.error(" Failed to parse coordinates:",ut),Xe={x:0,y:0,width:100,height:100}}return Xe={x:(typeof Xe.x=="number"?Xe.x:Number(Xe.x))||0,y:(typeof Xe.y=="number"?Xe.y:Number(Xe.y))||0,width:(typeof Xe.width=="number"?Xe.width:Number(Xe.width))||30,height:(typeof Xe.height=="number"?Xe.height:Number(Xe.height))||10},{id:We.id,word:We.word,coordinates:Xe,hasArrow:We.hasArrow,arrow:We.arrow}}),Pe=Array.isArray(t.arrows)?t.arrows:[],Ue=t.words.map(We=>({id:We.id,word:We.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:Ae,arrows:Pe,words:Ue}},[t]);k.useEffect(()=>{if(!(t!=null&&t.image_url))return;const Ae=new Image;Ae.crossOrigin="anonymous",Ae.onload=()=>{var it,rt,xe;console.log(" Image loaded successfully"),E(Ae.width),F(Ae.height);const Pe=((it=Y.current)==null?void 0:it.clientWidth)||800,Ue=((rt=Y.current)==null?void 0:rt.clientHeight)||600,We=Pe/Ae.width,Xe=Ue/Ae.height,ut=Math.min(We,Xe,1),Ct=Ae.width*ut,Mt=Ae.height*ut,At=(Pe-Ct)/2,Pt=(Ue-Mt)/2;y({x:At,y:Pt,width:Ct,height:Mt,scaleX:ut,scaleY:ut,scale:ut,image:Ae}),de.current=((xe=Y.current)==null?void 0:xe.clientWidth)||800,console.log(" Image info calculated:",{x:At,y:Pt,width:Ct,height:Mt,scaleX:ut,scaleY:ut})},Ae.onerror=()=>{console.error(" Failed to load image"),V("Failed to load test image","error")},Ae.src=t.image_url},[t==null?void 0:t.image_url,V]),k.useEffect(()=>{var Pt;if(!ve||!w)return;const Ae=de.current||((Pt=Y.current)==null?void 0:Pt.clientWidth)||800,Pe=12,Ue=38;let We=w.x,Xe=w.y+w.height+Pe;const ut=w.x+w.width,Ct={};ve.words.forEach(it=>{if(!Object.prototype.hasOwnProperty.call(m,it.id)){const rt=typeof it.word=="string"?it.word:"",xe=Math.max(60,rt.length*8+20);We+xe>Math.min(Ae-Pe,ut)&&(We=w.x,Xe+=Ue),d[it.id]||(Ct[it.id]={x:We,y:Xe}),We+=xe+Pe}}),Object.keys(Ct).length&&h(it=>({...it,...Ct}));const Mt=Object.values(Ct).reduce((it,rt)=>Math.max(it,rt.y),Xe),At=Math.max(w.y+w.height+Pe,Mt+Ue+Pe);ge(Math.max(400,Math.ceil(At)))},[ve,w,m,d]);const we=k.useCallback(()=>{if(!w||!ve)return[];const Ae=u();return Ae?ve.blocks.map(Pe=>{var At;const Ue=Pe.coordinates;let We,Xe,ut,Ct;We=w.x+Ue.x*(w.scale??w.scaleX),Xe=w.y+Ue.y*(w.scale??w.scaleY),ut=Ue.width*(w.scale??w.scaleX),Ct=Ue.height*(w.scale??w.scaleY);const Mt=m[Pe.id];return c.jsxs(Ae.Group,{children:[c.jsx(Ae.Rect,{x:We,y:Xe,width:ut,height:Ct,fill:Mt?"rgba(40, 167, 69, 0.4)":T===Pe.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:Mt?"#28a745":T===Pe.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:Mt?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),Mt&&c.jsx(Ae.KonvaText,{x:We+5,y:Xe+Ct/2-10,width:ut-10,height:20,text:((At=ve.words.find(Pt=>Pt.id===Mt))==null?void 0:At.word)||"",fontSize:Math.min(12,ut/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},Pe.id)}):[]},[w,ve,m,a]),Oe=k.useCallback(()=>{if(!w||!ve)return[];const Ae=u();return Ae?(console.log(" Processing arrows:",ve.arrows),ve.arrows.map(Pe=>{var Ct,Mt,At;if(console.log(" Arrow data:",Pe),!Pe.start||!Pe.end)return console.warn(" Arrow missing start/end coordinates:",Pe),null;let Ue,We,Xe,ut;if(Pe.rel_start_x!==null&&Pe.rel_start_y!==null&&Pe.rel_end_x!==null&&Pe.rel_end_y!==null&&Pe.image_width&&Pe.image_height&&Pe.image_width>0&&Pe.image_height>0){const Pt=Pe.image_width,it=Pe.image_height,rt=w.width/Pt,xe=w.height/it;Ue=w.x+Number(Pe.rel_start_x)/100*Pt*rt,We=w.y+Number(Pe.rel_start_y)/100*it*xe,Xe=w.x+Number(Pe.rel_end_x)/100*Pt*rt,ut=w.y+Number(Pe.rel_end_y)/100*it*xe}else{const Pt=w.scale??w.scaleX??1,it=Number(Pe.start.x),rt=Number(Pe.start.y),xe=Number(Pe.end.x),De=Number(Pe.end.y);it<=w.width+1&&xe<=w.width+1&&rt<=w.height+1&&De<=w.height+1?(Ue=w.x+(isNaN(it)?0:it),We=w.y+(isNaN(rt)?0:rt),Xe=w.x+(isNaN(xe)?0:xe),ut=w.y+(isNaN(De)?0:De)):(Ue=w.x+(isNaN(it)?0:it)*Pt,We=w.y+(isNaN(rt)?0:rt)*Pt,Xe=w.x+(isNaN(xe)?0:xe)*Pt,ut=w.y+(isNaN(De)?0:De)*Pt)}return c.jsx(Ae.Arrow,{points:[Ue,We,Xe,ut],stroke:((Ct=Pe.style)==null?void 0:Ct.color)||"#dc3545",fill:((Mt=Pe.style)==null?void 0:Mt.color)||"#dc3545",strokeWidth:((At=Pe.style)==null?void 0:At.thickness)||3,pointerLength:10,pointerWidth:10},Pe.id)}).filter(Boolean)):[]},[w,ve,a]),Ze=k.useCallback(()=>{if(!ve)return[];const Ae=u();return Ae?ve.words.map(Pe=>{const Ue=d[Pe.id]||{x:0,y:0},We=typeof Pe.word=="string"?Pe.word:"",Xe=Math.max(60,We.length*8+20);return Object.values(m).includes(Pe.id)?null:c.jsxs(Ae.Group,{x:Ue.x,y:Ue.y,draggable:!0,onDragEnd:Ct=>Re(Ct,Pe.id),children:[c.jsx(Ae.Rect,{width:Xe,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),c.jsx(Ae.KonvaText,{text:We,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:Xe,height:34,listening:!1})]},Pe.id)}):[]},[ve,d,m,w,a]),Re=k.useCallback((Ae,Pe)=>{const Ue=Ae.target.x(),We=Ae.target.y();if(h(rt=>({...rt,[Pe]:{x:Ue,y:We}})),!w||!ve)return;const Xe=ve.words.find(rt=>rt.id===Pe);if(!Xe)return;const ut=typeof Xe.word=="string"?Xe.word:"",Ct=Math.max(60,ut.length*8+20),Mt={x:Ue,y:We,width:Ct,height:34},At=w.scale??w.scaleX??1,Pt=(rt,xe)=>!(xe.x>rt.x+rt.width||xe.x+xe.width<rt.x||xe.y>rt.y+rt.height||xe.y+xe.height<rt.y),it=ve.blocks.find(rt=>{const xe=rt.coordinates,De={x:w.x+xe.x*At,y:w.y+xe.y*At,width:xe.width*At,height:xe.height*At};return Pt(Mt,De)});if(it){x(ht=>({...ht,[it.id]:Pe}));const rt=it.coordinates,xe=w.x+rt.x*At,De=w.y+rt.y*At,Le=rt.width*At,pt=rt.height*At;h(ht=>({...ht,[Pe]:{x:xe+(Le-Ct)/2,y:De+(pt-34)/2}})),V(`Word "${Xe.word}" placed in block`,"success")}},[w,ve,V]),xt=k.useCallback(()=>{if(!ve)return 0;const Ae=ve.words.length,Pe=Object.keys(m).length;return Ae>0?Pe/Ae*100:0},[ve,m]);k.useEffect(()=>{const Ae=xt();v(Ae)},[xt]),k.useEffect(()=>{if(t&&!D){const Ae=new Date;R(Ae),console.log(" Test timer started at:",Ae.toISOString()),L(),console.log(" Anti-cheating tracking started")}},[t,D,L]);const $t=k.useCallback(async()=>{if(ve){S(!0);try{const Ae=ve.words.length;let Pe=0;console.log(" Scoring check - placedWords:",m),console.log(" Scoring check - blocks:",ve.blocks.map(rt=>({id:rt.id,word:rt.word}))),console.log(" Scoring check - words:",ve.words.map(rt=>({id:rt.id,word:rt.word}))),ve.blocks.forEach(rt=>{const xe=m[rt.id];if(console.log(` Block ${rt.id} (expects "${rt.word}") has placed word ID: ${xe}`),xe){const De=ve.words.find(Le=>Le.id===xe);console.log(" Placed word:",De),De&&De.word===rt.word?(Pe++,console.log(` Correct! Block ${rt.id} has correct word "${De.word}"`)):console.log(` Incorrect! Block ${rt.id} expected "${rt.word}" but got "${(De==null?void 0:De.word)||"nothing"}"`)}else console.log(` Block ${rt.id} has no word placed`)});const Ue=Pe,We=Ae;console.log(` Final Score: ${Ue}/${We} (${Math.round(Ue/We*100)}%)`);const Xe=new Date,ut=D?Math.round((Xe-D)/1e3):0,Ct=D?D.toISOString():Xe.toISOString();console.log(" Test timing:",{startedAt:Ct,endTime:Xe.toISOString(),timeTaken:`${ut} seconds`});const Mt=ne();console.log(" Anti-cheating data for submission:",Mt);const At={test_id:t.id,test_name:t.test_name,teacher_id:t.teacher_id||null,subject_id:t.subject_id||null,student_id:U.student_id,answers:m,score:Ue,maxScore:We,time_taken:ut,started_at:Ct,submitted_at:Xe.toISOString(),caught_cheating:Mt.caught_cheating,visibility_change_times:Mt.visibility_change_times};console.log(" Submitting test data:",At);const it=await(await K("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(At)})).json();if(console.log(" Submission response:",it),it.success){if(V("Test submitted successfully!","success"),Z(),z(),U!=null&&U.student_id&&Lg(U.student_id,"matching_type",t.id),U!=null&&U.student_id){const rt=`test_completed_${U.student_id}_matching_type_${t.id}`;localStorage.setItem(rt,"true"),console.log(" Test marked as completed in localStorage:",rt)}if(U!=null&&U.student_id){const{setCachedData:rt,CACHE_TTL:xe}=await xx(async()=>{const{setCachedData:Le,CACHE_TTL:pt}=await Promise.resolve().then(()=>D9);return{setCachedData:Le,CACHE_TTL:pt}},void 0),De=`student_results_table_${U.student_id}`;rt(De,it,xe.student_results_table),console.log(" Test results cached with key:",De)}e&&e(Ue)}else throw new Error(it.message||"Failed to submit test")}catch(Ae){console.error(" Error submitting test:",Ae),V(`Error submitting test: ${Ae.message}`,"error")}finally{S(!1)}}},[ve,m,t,U,D,K,V,e]);return!t||!ve?c.jsx(dr,{}):c.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.test_name})}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),c.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(p),"%"]})]})]}),c.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${p}%`}})})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:c.jsx("div",{className:"lg:col-span-3",children:c.jsxs(at,{className:"p-4",children:[c.jsxs("div",{className:"mb-4 text-center space-x-4",children:[c.jsx(Ge,{onClick:fe,variant:"secondary",children:"Reset"}),c.jsx(Ge,{onClick:Ce,variant:"secondary",children:"Back to Cabinet"})]}),c.jsx("div",{ref:Y,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${ee}px`},children:w&&a?(()=>{var We;const{Stage:Ae,Layer:Pe,KonvaImage:Ue}=u();return c.jsxs(Ae,{ref:J,width:((We=Y.current)==null?void 0:We.clientWidth)||800,height:ee,children:[c.jsxs(Pe,{children:[c.jsx(Ue,{ref:te,image:w.image,x:w.x,y:w.y,width:w.width,height:w.height,listening:!1}),we(),Oe()]}),c.jsx(Pe,{listening:!0,children:Ze()})]})})():w?c.jsxs("div",{className:"flex items-center justify-center h-full",children:[c.jsx(dr,{size:"lg"}),c.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),c.jsx("div",{className:"mt-4 text-center",children:c.jsx(Ge,{onClick:$t,disabled:_||p<100,children:_?"Submitting...":"Submit Test"})})]})})}),c.jsx(Ou,{isOpen:I,onClose:()=>W(!1),title:"Reset Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Ge,{onClick:()=>W(!1),variant:"secondary",children:"Cancel"}),c.jsx(Ge,{onClick:ye,variant:"primary",children:"Reset"})]})]})}),c.jsx(Ou,{isOpen:le,onClose:()=>q(!1),title:"Exit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Ge,{onClick:()=>q(!1),variant:"secondary",children:"Cancel"}),c.jsx(Ge,{onClick:re,variant:"primary",children:"Go Back"})]})]})})]})})},zte=({testName:t="",onTestSaved:e,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=Dn(),{makeAuthenticatedRequest:o}=fl(),{showNotification:l}=ka(),[u,d]=k.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[h,m]=k.useState("drag"),[x,p]=k.useState(!1),[v,_]=k.useState(null),S=k.useCallback(()=>{d(F=>[...F,{leftWord:"",rightWord:""}])},[]),w=k.useCallback(F=>{u.length>1&&d(T=>T.filter((P,D)=>D!==F))},[u.length]),y=k.useCallback((F,T)=>{d(P=>P.map((D,R)=>R===F?{...D,leftWord:T}:D))},[]),b=k.useCallback((F,T)=>{d(P=>P.map((D,R)=>R===F?{...D,rightWord:T}:D))},[]),E=k.useCallback(()=>u.every(F=>F.leftWord.trim()&&F.rightWord.trim()),[u]),N=k.useCallback(async()=>{if(!E()){l("Please fill in all word pairs","error");return}p(!0),_(null);try{const F=u.map((P,D)=>({question_id:D+1,left_word:P.leftWord.trim(),right_word:P.rightWord.trim()})),T={test_name:t,num_questions:F.length,interaction_type:h,questions:F};console.log(" Saving word matching test:",T),e({testName:t,numQuestions:F.length,interactionType:h,wordPairs:u,questions:F})}catch(F){console.error("Error saving word matching test:",F),_(F.message),l("Failed to save test: "+F.message,"error")}finally{p(!1)}},[t,u,h,E,o,l,e]);return c.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-6",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Word Matching Test"}),c.jsx("p",{className:"text-gray-600",children:"Enter word pairs - position 1 left matches position 1 right"})]}),c.jsx(at,{className:"mb-6",children:c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${h==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>m("drag"),children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("input",{type:"radio",checked:h==="drag",onChange:()=>m("drag"),className:"mr-3"}),c.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),c.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" Easier for younger students",c.jsx("br",{})," Visual feedback on placement",c.jsx("br",{})," Mobile-friendly"]})]}),c.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${h==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>m("arrow"),children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("input",{type:"radio",checked:h==="arrow",onChange:()=>m("arrow"),className:"mr-3"}),c.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),c.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" More challenging",c.jsx("br",{})," Better for visual learners",c.jsx("br",{})," Requires precision"]})]})]})]})}),c.jsx(at,{className:"mb-6",children:c.jsxs("div",{className:"word-pairs-section",children:[c.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),c.jsx(Ge,{onClick:S,size:"sm",children:"+ Add Pair"})]}),c.jsx("div",{className:"pairs-list space-y-3",children:u.map((F,T)=>c.jsxs("div",{className:"word-pair-row flex items-center space-x-4 p-4 bg-gray-50 rounded-lg border",children:[c.jsx("div",{className:"pair-number flex-shrink-0",children:c.jsx("span",{className:"number-badge w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:T+1})}),c.jsx("div",{className:"left-word flex-1",children:c.jsx("input",{type:"text",value:F.leftWord,onChange:P=>y(T,P.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),c.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-xl",children:""}),c.jsx("div",{className:"right-word flex-1",children:c.jsx("input",{type:"text",value:F.rightWord,onChange:P=>b(T,P.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),c.jsx("div",{className:"pair-actions flex-shrink-0",children:c.jsx(Ge,{onClick:()=>w(T),variant:"outline",size:"sm",className:"remove-btn w-8 h-8 p-0 text-red-500 hover:bg-red-50",disabled:u.length<=1,children:""})})]},T))})]})}),c.jsx(at,{className:"mb-6",children:c.jsxs("div",{className:"preview-section",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),c.jsx("div",{className:"preview-pairs space-y-2",children:u.map((F,T)=>c.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[c.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[T+1,"."]}),c.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:F.leftWord||"Left word"}),c.jsx("span",{className:"preview-arrow text-gray-500",children:""}),c.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:F.rightWord||"Right word"})]},T))})]})}),c.jsxs("div",{className:"flex justify-center space-x-4",children:[c.jsx(Ge,{onClick:N,disabled:!E()||x,className:"px-8",children:x?c.jsxs(c.Fragment,{children:[c.jsx(dr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),c.jsx(Ge,{onClick:r,variant:"secondary",children:"Cancel"})]}),v&&c.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-600",children:v})})]})},Wte=(t,e)=>{const[r,n,s]=M9(`test_progress_${t}_${e}`,{}),[a,i]=k.useState(!1),[o,l]=k.useState(0),[u,d]=k.useState(0),[h,m]=k.useState(!1),[x,p]=k.useState(null),v=k.useRef(null),_=k.useRef(null),S=k.useCallback((L,Z)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(ne=>({...ne,[L]:Z})),console.log(`Saved progress for question ${L}:`,Z)},[n]),w=k.useCallback(L=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[L]||null,[r]),y=k.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${t}, testId: ${e}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const L=`test_progress_${t}_${e}`;console.log(`[DEBUG] Removing localStorage key: ${L}`);const Z=Object.keys(r).length>0;s(),console.log(Z?`[DEBUG] Progress cleared for test ${t}_${e}`:`[DEBUG] No progress found to clear for test ${t}_${e}`)},[s,t,e,r]),b=k.useCallback(()=>{v.current&&(b(v.current),v.current=null),_.current&&(b(_.current),_.current=null)},[]),E=k.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${t}, testId: ${e}`),_.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),D()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[t,e]),N=k.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${t}, testId: ${e}`);const L=P(),Z=u>0?Math.round(L/u*100):0;return console.log(`[DEBUG] Progress: ${L}/${u} questions answered`),console.log(`[DEBUG] Progress bar updated: ${Z}%`),{answeredQuestions:L,totalQuestions:u,percentage:Z}},[t,e,u]),F=k.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const L=P();console.log(`[DEBUG] Submit button state check: ${L}/${u} questions answered`);const Z=L===u&&u>0;return console.log(Z?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),Z},[u]),T=k.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${t}, testId: ${e}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const L=Object.keys(r).length;l(L),console.log(`[DEBUG] Restored ${L} answered questions`)}catch(L){console.error("[ERROR] Failed to load saved progress:",L),p(L.message)}},[t,e,r]),P=k.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${t}`);const L=Object.keys(r).length;return l(L),console.log(`[DEBUG] Found ${L} answered questions`),L},[t,r]),D=k.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${t}, testId: ${e}`);try{console.log("[DEBUG] Progress saved:",r)}catch(L){console.error("[ERROR] Failed to save progress:",L),p(L.message)}},[t,e,r]),R=k.useCallback(()=>{try{const L=`test_completed_${t}_${e}`,Z=localStorage.getItem(L)==="true";return i(Z),Z}catch(L){return console.error("Error checking test completion:",L),!1}},[t,e]),I=k.useCallback(()=>{try{const L=`test_completed_${t}_${e}`;localStorage.setItem(L,"true"),i(!0),console.log(`Test ${t}_${e} marked as completed`)}catch(L){console.error("Error marking test completed:",L)}},[t,e]),W=k.useCallback(()=>{console.log("Marking test completed in UI:",{testType:t,testId:e}),I()},[t,e,I]),le=k.useCallback(L=>{try{const Z=`test_creation_state_${t}_${e}`;localStorage.setItem(Z,JSON.stringify(L)),console.log("Test creation state saved:",L)}catch(Z){console.error("Error saving test creation state:",Z)}},[t,e]),q=k.useCallback(()=>{try{const L=`test_creation_state_${t}_${e}`;localStorage.removeItem(L),console.log("Test creation state cleared")}catch(L){console.error("Error clearing test creation state:",L)}},[t,e]),V=k.useCallback((L,Z)=>{try{const ne=`test_step_${t}_${e}_${L}`;localStorage.setItem(ne,JSON.stringify(Z)),console.log(`Step ${L} data saved:`,Z)}catch(ne){console.error(`Error saving step ${L} data:`,ne)}},[t,e]),K=k.useCallback(L=>{try{const Z=`test_step_${t}_${e}_${L}`,ne=localStorage.getItem(Z);return ne?JSON.parse(ne):null}catch(Z){return console.error(`Error restoring step ${L} data:`,Z),null}},[t,e]),U=k.useCallback(()=>{try{const L=`test_creation_state_${t}_${e}`,Z=localStorage.getItem(L);return Z?JSON.parse(Z):null}catch(L){return console.error("Error restoring test creation state:",L),null}},[t,e]);return k.useEffect(()=>()=>{b()},[t,e,E,T,b]),k.useEffect(()=>{P()},[r,P]),{progress:r,isCompleted:a,answeredCount:o,totalQuestions:u,isLoading:h,error:x,saveProgress:S,getProgress:w,clearProgress:y,clearInterval:b,setupProgressTracking:E,updateProgress:N,updateSubmitButton:F,loadProgress:T,getAnsweredCount:P,saveProgressForPage:D,checkCompleted:R,markCompleted:I,markCompletedUI:W,saveState:le,clearState:q,saveStepData:V,restoreStepData:K,restoreState:U,setTotalQuestions:d,setError:p}},Vte=({testData:t,onTestComplete:e,onBackToCabinet:r})=>{var Ae,Pe;const{user:n}=Dn(),{makeAuthenticatedRequest:s}=fl(),[a,i]=k.useState({width:window.innerWidth,height:window.innerHeight});k.useEffect(()=>{const Ue=()=>{i({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",Ue),()=>window.removeEventListener("resize",Ue)},[]);const{getCheatingData:o,stopTracking:l,clearData:u}=_v(),[d,h]=k.useState(null),[m,x]=k.useState({}),[p,v]=k.useState(null),_=k.useRef(null),[S,w]=k.useState(800),y={VERY_SMALL:400,MOBILE:600,TABLET:900},b={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},E={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:100,MARGIN:50,PADDING:20},N=a.width<y.VERY_SMALL,F=a.width>=y.VERY_SMALL&&a.width<y.MOBILE,T=a.width>=y.MOBILE&&a.width<y.TABLET;a.width>=y.TABLET;const P=N?b.VERY_SMALL:F?b.MOBILE:T?b.TABLET:b.DESKTOP;k.useEffect(()=>{const Ue=()=>{if(_.current){const Xe=_.current.clientWidth;console.log(" Container width detected:",Xe),Xe>0&&w(Xe)}};Ue();const We=[setTimeout(Ue,50),setTimeout(Ue,100),setTimeout(Ue,200),setTimeout(Ue,500)];return window.addEventListener("resize",Ue),()=>{We.forEach(Xe=>clearTimeout(Xe)),window.removeEventListener("resize",Ue)}},[d]);const D=Math.max(E.CANVAS_HEIGHT*P,(((Ae=d==null?void 0:d.leftWords)==null?void 0:Ae.length)||3)*E.BLOCK_SPACING*P+E.PADDING*2),R=E.BLOCK_WIDTH*P,I=E.BLOCK_HEIGHT*P,W=E.BLOCK_SPACING*P,le=E.MARGIN*P,q=le;console.log(" Mobile Debug:",{screenWidth:a.width,containerWidth:(Pe=_.current)==null?void 0:Pe.clientWidth,canvasWidth:S,scale:P,blockWidth:R,margin:le,leftBlockX:q,displayDataLoaded:!!d});const V=q+R+20+R+le,K=V<=S;let U,L=R,Z=I;if(K)U=Math.min(Math.max(q+R+20,S-R-le),S-R-le);else{const Ue=S-le*2,We=Math.floor((Ue-20)/2);L=Math.max(60,We),Z=Math.max(30,Z*(L/R)),U=q+L+20,console.log(" Very small screen - adjusted block size:",{availableWidth:Ue,maxBlockWidth:We,actualBlockWidth:L,actualBlockHeight:Z})}console.log(" Right Block Position:",{rightBlockX:U,rightBlockRightEdge:U+L,canvasWidth:S,fits:U+L<=S,canFitSideBySide:K,minRequiredWidth:V});const ne=le,z={DRAGGED_WORD:Math.max(8,14*P),ORIGINAL_WORD:Math.max(10,16*P),LEFT_WORD:Math.max(10,14*P)},Y=Math.max(1,3*P),[J,te]=k.useState([]),[de,ee]=k.useState(!1),[ge,fe]=k.useState(null),[ye,Ce]=k.useState(!1),[re,ve]=k.useState(!1);k.useEffect(()=>{if(t&&(h(t),fe(new Date),n!=null&&n.student_id)){const Ue=`test_progress_${n.student_id}_word_matching_${t.id}`,We=wn(Ue);We&&(x(We.answers||{}),te(We.arrows||[]),fe(new Date(We.startTime)),console.log(" Test progress restored:",We))}},[t,n==null?void 0:n.student_id]),k.useEffect(()=>{if(d&&ge&&(n!=null&&n.student_id)){const Ue=setInterval(()=>{const We={answers:m,arrows:J,startTime:ge.toISOString()},Xe=`test_progress_${n.student_id}_word_matching_${t.id}`;Zr(Xe,We,on.test_progress),console.log(" Progress auto-saved")},3e4);return()=>clearInterval(Ue)}},[d,m,J,ge,n==null?void 0:n.student_id,t==null?void 0:t.id]);const we=k.useCallback((Ue,We)=>{if(t.interaction_type==="arrow")if(p){if(p.side===Ue&&p.index===We)v(null);else if(p.side!==Ue){const Xe={id:Date.now().toString(),startWord:p,endWord:{side:Ue,index:We},color:"#3B82F6"};te(ut=>[...ut,Xe]),x(ut=>({...ut,[p.index]:We})),v(null)}}else v({side:Ue,index:We})},[p,t==null?void 0:t.interaction_type]);k.useCallback((Ue,We)=>{t.interaction_type==="drag"&&x(Xe=>({...Xe,[Ue]:We}))},[t==null?void 0:t.interaction_type]);const Oe=k.useCallback(()=>{Ce(!0)},[]),Ze=k.useCallback(()=>{x({}),te([]),v(null),Ce(!1)},[]),Re=k.useCallback(()=>{ve(!0)},[]),xt=k.useCallback(()=>{ve(!1),r&&r()},[r]),$t=k.useCallback(async()=>{if(d){ee(!0);try{const Ue=d.leftWords.length;let We=0,Xe={};t.interaction_type==="drag"?Object.entries(m).forEach(([Le,pt])=>{const ht=d.correctPairs[Le];pt===ht&&We++,Xe[Le]=pt}):J.forEach(Le=>{const pt=Le.startWord.side==="left"?Le.startWord.index:Le.endWord.index,ht=Le.startWord.side==="right"?Le.startWord.index:Le.endWord.index;d.correctPairs[pt]===ht&&We++,Xe[pt]=ht});const ut=We,Ct=Ue;console.log(` Final Score: ${ut}/${Ct} (${Math.round(ut/Ct*100)}%)`);const Mt=new Date,At=ge?Math.round((Mt-ge)/1e3):0,Pt=ge?ge.toISOString():Mt.toISOString(),it=o(),rt={test_id:t.id,test_name:t.test_name,teacher_id:t.teacher_id||null,subject_id:t.subject_id||null,student_id:n.student_id,interaction_type:t.interaction_type,answers:Xe,score:ut,maxScore:Ct,time_taken:At,started_at:Pt,submitted_at:Mt.toISOString(),caught_cheating:it.caught_cheating,visibility_change_times:it.visibility_change_times};console.log(" Submission data being sent:",rt),console.log(" TestData structure:",t),console.log(" Submitting test results...");const xe=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(rt)});console.log(" Submission response received:",xe.status);const De=await xe.json();if(De.success){if(l(),u(),n!=null&&n.student_id){const Le=`test_completed_${n.student_id}_word_matching_${t.id}`;localStorage.setItem(Le,"true"),console.log(" Test marked as completed in localStorage:",Le),Lg(n.student_id,"word_matching",t.id),console.log(" Test data cleared from cache");const pt=`student_results_table_${n.student_id}`;Zr(pt,De,on.student_results_table),console.log(" Test results cached with key:",pt)}setTimeout(()=>{e&&e(ut)},2e3)}else throw new Error(De.message||"Failed to submit test")}catch(Ue){console.error("Error submitting test:",Ue)}finally{ee(!1)}}},[d,m,J,t,n,ge,o,l,u,s,e]);return d?c.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-4xl mx-auto p-6",children:[de&&c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),c.jsx(at,{className:"mb-6",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:t.test_name}),c.jsx("p",{className:"text-gray-600",children:t.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]})}),t.interaction_type==="drag"?c.jsx(at,{className:"mb-6",children:c.jsx("div",{ref:_,className:"relative w-full",children:c.jsx(Rf,{width:S,height:D,className:`border-2 border-gray-200 rounded-lg ${de?"pointer-events-none opacity-50":""}`,children:c.jsxs(Df,{children:[d.leftWords.map((Ue,We)=>{const Xe=m[We]!==void 0,ut=ne+We*W;return c.jsxs(Zd,{x:q,y:ut,draggable:!Xe,onDragStart:Ct=>{Ct.target.moveToTop()},onDragEnd:Ct=>{Ct.target.getStage();const Mt=d.rightWords,At=L+60,Pt=Z+30,it=U-30,rt=ne-15;console.log(" Drop detection - Word dropped at:",Ct.target.x(),Ct.target.y());for(let xe=0;xe<Mt.length;xe++){const De=rt+xe*W,Le=it,pt=it+At,ht=De,Tt=De+Pt;if(console.log(` Checking drop zone ${xe}:`,{left:Le,right:pt,top:ht,bottom:Tt,word:Mt[xe]}),Ct.target.x()>=Le&&Ct.target.x()<=pt&&Ct.target.y()>=ht&&Ct.target.y()<=Tt){console.log(` Match found! Word "${d.leftWords[We]}" matched with "${Mt[xe]}"`),x(gr=>({...gr,[We]:xe}));break}}console.log(" No match found, resetting position"),Ct.target.position({x:q,y:ut})},children:[c.jsx(ho,{width:L,height:Z,fill:Xe?"#e5e7eb":"#3b82f6",stroke:Xe?"#9ca3af":"#1d4ed8",strokeWidth:2,cornerRadius:8,opacity:Xe?.5:1}),c.jsx(Xc,{text:Ue,x:L/2,y:Z/2,fontSize:z.LEFT_WORD,fontFamily:"Arial",fill:Xe?"#dc2626":"white",align:"center",verticalAlign:"middle",width:L,offsetX:L/2,offsetY:Z/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${We}`)}),d.rightWords.map((Ue,We)=>{const Xe=ne+We*W,ut=Object.keys(m).find(Ct=>m[Ct]===We);return c.jsxs(Zd,{x:U,y:Xe,children:[c.jsx(ho,{width:L,height:Z,fill:ut?"#10b981":"#f3f4f6",stroke:ut?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8}),c.jsx(Xc,{text:Ue,x:L/2,y:Z/2,fontSize:z.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:L,offsetX:L/2,offsetY:Z/2,wrap:"word",ellipsis:!0,listening:!1}),ut&&c.jsx(Xc,{text:d.leftWords[ut],x:R/2,y:I/4,fontSize:z.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:L,offsetX:L/2,offsetY:Z/8,wrap:"word",ellipsis:!0})]},`right-${We}`)})]})})})}):c.jsx(at,{className:"mb-6",children:c.jsx("div",{ref:_,className:"relative w-full",children:c.jsx(Rf,{width:S,height:D,className:`border-2 border-gray-200 rounded-lg ${de?"pointer-events-none opacity-50":""}`,children:c.jsxs(Df,{children:[d.leftWords.map((Ue,We)=>{const Xe=ne+We*W,ut=(p==null?void 0:p.side)==="left"&&(p==null?void 0:p.index)===We;return c.jsxs(Zd,{x:q,y:Xe,onClick:()=>we("left",We),children:[c.jsx(ho,{width:L,height:Z,fill:ut?"#3b82f6":"#f3f4f6",stroke:ut?"#1d4ed8":"#d1d5db",strokeWidth:ut?3:2,cornerRadius:8}),c.jsx(Xc,{text:Ue,x:R/2,y:I/2,fontSize:z.LEFT_WORD,fontFamily:"Arial",fill:ut?"white":"#374151",align:"center",verticalAlign:"middle",width:L,offsetX:L/2,offsetY:Z/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${We}`)}),d.rightWords.map((Ue,We)=>{const Xe=ne+We*W,ut=(p==null?void 0:p.side)==="right"&&(p==null?void 0:p.index)===We;return c.jsxs(Zd,{x:U,y:Xe,onClick:()=>we("right",We),children:[c.jsx(ho,{width:L,height:Z,fill:ut?"#3b82f6":"#f3f4f6",stroke:ut?"#1d4ed8":"#d1d5db",strokeWidth:ut?3:2,cornerRadius:8}),c.jsx(Xc,{text:Ue,x:R/2,y:I/2,fontSize:z.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:L,offsetX:L/2,offsetY:Z/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${We}`)}),J.map((Ue,We)=>{const Xe=ne+Ue.startWord.index*W+I/2,ut=ne+Ue.endWord.index*W+I/2;return c.jsx(ru,{points:[q+R+20,Xe,U-20,ut],stroke:Ue.color||"#3b82f6",strokeWidth:Y,lineCap:"round",lineJoin:"round"},We)})]})})})}),c.jsx(at,{children:c.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${de?"pointer-events-none opacity-50":""}`,children:[c.jsx(Ge,{onClick:Oe,variant:"outline",disabled:de,children:"Reset"}),c.jsx(Ge,{onClick:Re,variant:"outline",disabled:de,children:"Back to Cabinet"}),c.jsx(Ge,{onClick:$t,disabled:de,className:"px-8",children:de?c.jsxs(c.Fragment,{children:[c.jsx(dr,{size:"sm",color:"white",className:"mr-2"}),"Submitting..."]}):"Submit Test"})]})}),c.jsx(Ou,{isOpen:ye&&!de,onClose:()=>Ce(!1),title:"Reset Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Ge,{onClick:()=>Ce(!1),variant:"secondary",children:"Cancel"}),c.jsx(Ge,{onClick:Ze,variant:"primary",children:"Reset"})]})]})}),c.jsx(Ou,{isOpen:re&&!de,onClose:()=>ve(!1),title:"Exit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Ge,{onClick:()=>ve(!1),variant:"secondary",children:"Cancel"}),c.jsx(Ge,{onClick:xt,variant:"primary",children:"Leave"})]})]})})]}):c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(dr,{size:"lg"})})},Gte=({width:t,height:e,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:o,onZoomChange:l,isPanning:u,isFullscreen:d,constrainPanPosition:h,handleWheel:m,stageRef:x,setIsPanning:p,responsiveDimensions:v,canvasSize:_,question:S})=>{const[w,y]=k.useState(!1),[b,E]=k.useState([]),[N,F]=k.useState(null),[T,P]=k.useState(null),D=W=>{const le=x.current,q=le.getPointerPosition();if(s==="pan")return;y(!0);const V={x:(q.x-le.x())/le.scaleX(),y:(q.y-le.y())/le.scaleY()};P(V),s==="pencil"?E([{x:V.x,y:V.y,color:a,thickness:i}]):["line","rectangle","circle"].includes(s)&&F({type:s,startX:V.x,startY:V.y,endX:V.x,endY:V.y,color:a,thickness:i})},R=W=>{const le=x.current,q=le.getPointerPosition();if(s==="pan"||!w)return;const V={x:(q.x-le.x())/le.scaleX(),y:(q.y-le.y())/le.scaleY()};if(s==="pencil"){const K=[...b,{x:V.x,y:V.y,color:a,thickness:i}];E(K)}else["line","rectangle","circle"].includes(s)&&N&&F({...N,endX:V.x,endY:V.y})},I=()=>{if(s!=="pan"&&w){if(s==="pencil"){const W=[...r,b];n(W),E([])}else if(["line","rectangle","circle"].includes(s)&&N){const W=[...r,N];n(W),F(null)}y(!1),P(null)}};return c.jsx("div",{className:"relative w-full flex justify-center",children:c.jsx("div",{className:"w-full max-w-full flex justify-center",children:c.jsxs("div",{className:"relative",style:{border:d&&(v.width<window.innerWidth-40||v.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[c.jsx(Rf,{ref:x,width:v.width,height:v.height,onMouseDown:D,onMousemove:R,onMouseup:I,onWheel:m||(()=>{}),onDragStart:()=>{console.log(" Drag started"),s==="pan"&&p(!0)},onDragEnd:()=>{if(console.log(" Drag ended"),s==="pan"&&(p(!1),h)){const W=x.current,le=v.width,q=v.height,V=_.width*W.scaleX(),K=_.height*W.scaleY(),U=W.x(),L=W.y();(U>le||U<-V||L>q||L<-K)&&h(W)}},draggable:s==="pan"&&o>.25,className:`border border-gray-300 rounded-lg shadow-sm ${s==="pan"?"cursor-grab":u?"cursor-grabbing":"cursor-crosshair"}`,style:{maxWidth:"100%",height:"auto"},onLoad:()=>{console.log(" DrawingTestStudent - Stage loaded with dimensions:",v.width,"x",v.height),console.log(" DrawingTestStudent - Canvas size:",_.width,"x",_.height),console.log(" DrawingTestStudent - Current zoom level:",o),console.log(" DrawingTestStudent - Effective display size:",Math.round(_.width*o),"x",Math.round(_.height*o)),console.log(" DrawingTestStudent - Total pixels displayed:",Math.round(_.width*o*_.height*o))},children:c.jsxs(Df,{children:[c.jsx(ho,{x:0,y:0,width:t,height:e,fill:"white"}),r.map((W,le)=>{var q,V;if(Array.isArray(W))return c.jsx(ru,{points:W.flatMap(K=>[K.x,K.y]),stroke:((q=W[0])==null?void 0:q.color)||"#000000",strokeWidth:((V=W[0])==null?void 0:V.thickness)||2,tension:.5,lineCap:"round",lineJoin:"round"},le);if(W.type==="line")return c.jsx(ru,{points:[W.startX,W.startY,W.endX,W.endY],stroke:W.color,strokeWidth:W.thickness,lineCap:"round"},le);if(W.type==="rectangle"){const K=Math.abs(W.endX-W.startX),U=Math.abs(W.endY-W.startY),L=Math.min(W.startX,W.endX),Z=Math.min(W.startY,W.endY);return c.jsx(ho,{x:L,y:Z,width:K,height:U,stroke:W.color,strokeWidth:W.thickness,fill:"transparent"},le)}else if(W.type==="circle"){const K=Math.sqrt(Math.pow(W.endX-W.startX,2)+Math.pow(W.endY-W.startY,2))/2,U=(W.startX+W.endX)/2,L=(W.startY+W.endY)/2;return c.jsx(HS,{x:U,y:L,radius:K,stroke:W.color,strokeWidth:W.thickness,fill:"transparent"},le)}return null}),s==="pencil"&&c.jsx(ru,{points:b.flatMap(W=>[W.x,W.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),N&&N.type==="line"&&c.jsx(ru,{points:[N.startX,N.startY,N.endX,N.endY],stroke:N.color,strokeWidth:N.thickness,lineCap:"round"}),N&&N.type==="rectangle"&&c.jsx(ho,{x:Math.min(N.startX,N.endX),y:Math.min(N.startY,N.endY),width:Math.abs(N.endX-N.startX),height:Math.abs(N.endY-N.startY),stroke:N.color,strokeWidth:N.thickness,fill:"transparent"}),N&&N.type==="circle"&&c.jsx(HS,{x:(N.startX+N.endX)/2,y:(N.startY+N.endY)/2,radius:Math.sqrt(Math.pow(N.endX-N.startX,2)+Math.pow(N.endY-N.startY,2))/2,stroke:N.color,strokeWidth:N.thickness,fill:"transparent"})]})}),c.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[c.jsx("button",{onClick:()=>{const W=x.current,le=W.scaleX(),q=(S==null?void 0:S.max_canvas_width)||1536,V=(S==null?void 0:S.max_canvas_height)||2048,K=q/_.width,U=V/_.height,L=Math.min(K,U,5),Z=Math.min(L,W.scaleX()*1.2);W.scale({x:Z,y:Z}),W.batchDraw(),console.log(" DrawingTestStudent - Zoom In button:",le.toFixed(2),"->",Z.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(_.width*Z),"x",Math.round(_.height*Z)),console.log(" DrawingTestStudent - New resolution:",Math.round(_.width*Z*_.height*Z),"pixels"),l(Z)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),c.jsx("button",{onClick:()=>{const W=x.current,le=W.scaleX(),q=Math.max(.25,W.scaleX()*.8);W.scale({x:q,y:q}),W.batchDraw(),console.log(" DrawingTestStudent - Zoom Out button:",le.toFixed(2),"->",q.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(_.width*q),"x",Math.round(_.height*q)),console.log(" DrawingTestStudent - New resolution:",Math.round(_.width*q*_.height*q),"pixels"),l(q)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:""}),c.jsx("button",{onClick:()=>{const W=x.current,le=W.scaleX();W.scale({x:1,y:1}),W.position({x:0,y:0}),W.batchDraw(),console.log(" DrawingTestStudent - Reset zoom:",le.toFixed(2),"-> 1.00"),console.log(" DrawingTestStudent - Reset effective size:",_.width,"x",_.height),console.log(" DrawingTestStudent - Reset resolution:",_.width*_.height,"pixels"),l(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),c.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(o*100),"%"]})]})})})},Hte=({content:t})=>{if(!t)return c.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const e=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(e).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(e).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const o=i.children?i.children.map(e).join(""):"";let l="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?l+=" text-align: center;":i.format==="right"?l+=" text-align: right;":i.format==="left"&&(l+=" text-align: left;")),`<li style="${l}">${o}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(e).join(""):""};let r=t;if(typeof t=="string"&&t.startsWith("{"))try{const n=JSON.parse(t);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(e).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return c.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},Kte=({question:t,questionIndex:e,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{ka();const[o,l]=k.useState([]),[u,d]=k.useState(!0),[h,m]=k.useState("pencil"),[x,p]=k.useState("#000000"),[v,_]=k.useState(2),[S,w]=k.useState({width:600,height:800}),[y,b]=k.useState(1),[E,N]=k.useState(!1),[F,T]=k.useState(!1),[P,D]=k.useState(!1),[R,I]=k.useState(!1),W=k.useRef(null),[le,q]=k.useState({width:600,height:800}),V=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];k.useEffect(()=>{const Y=()=>{D(window.innerWidth>=1024)};return Y(),window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]),k.useEffect(()=>{if(t){const Y=t.canvas_width||600,J=t.canvas_height||800;if(w({width:Y,height:J}),console.log(" DrawingTestStudent - Canvas size set:",Y,"x",J),console.log(" DrawingTestStudent - Image resolution:",Y*J,"pixels"),console.log(" DrawingTestStudent - Aspect ratio:",(Y/J).toFixed(2)),console.log(" DrawingTestStudent - Max canvas size:",t.max_canvas_width||1536,"x",t.max_canvas_height||2048),r&&typeof r=="string")try{const te=JSON.parse(r);l(te)}catch{console.log("No valid drawing data found")}d(!1)}},[t,r]);const K=Y=>{l(Y),n(t.question_id,JSON.stringify(Y))},U=()=>{l([]),n(t.question_id,"")},L=()=>{if(R)return{width:window.innerWidth-20,height:window.innerHeight-20};const Y=window.innerWidth-16,J=window.innerHeight-150,te=Math.min(S.width,Y),de=Math.min(S.height,J);return{width:Math.max(250,te),height:Math.max(300,de)}};k.useEffect(()=>{const Y=()=>{q(L())};return Y(),window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[R,S]);const Z=Y=>{Y.evt.preventDefault();const J=W.current,te=J.scaleX(),de=J.getPointerPosition(),ee={x:(de.x-J.x())/te,y:(de.y-J.y())/te},ge=Y.evt.deltaY>0?te*.9:te*1.1,fe=(t==null?void 0:t.max_canvas_width)||1536,ye=(t==null?void 0:t.max_canvas_height)||2048,Ce=fe/S.width,re=ye/S.height,ve=Math.min(Ce,re,5),we=Math.max(.25,Math.min(ve,ge)),Oe={x:de.x-ee.x*we,y:de.y-ee.y*we};J.scale({x:we,y:we}),J.position(Oe),J.batchDraw(),console.log(" DrawingTestStudent - Wheel zoom:",te.toFixed(2),"->",we.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(S.width*we),"x",Math.round(S.height*we)),console.log(" DrawingTestStudent - New resolution:",Math.round(S.width*we*S.height*we),"pixels"),b(we)},ne=Y=>{const J=Y.scaleX(),te=le.width,de=le.height,ee=S.width*J,ge=S.height*J;if(J<=.25){const Re=(te-ee)/2,xt=(de-ge)/2;Y.position({x:Re,y:xt}),Y.batchDraw();return}if(ee<=te&&ge<=de){const Re=(te-ee)/2,xt=(de-ge)/2;Y.position({x:Re,y:xt}),Y.batchDraw();return}const fe=Math.max(0,ee-te),ye=Math.max(0,ge-de),Ce=-fe,re=-ye,ve=Y.x(),we=Y.y(),Oe=Math.max(Ce,Math.min(fe,ve)),Ze=Math.max(re,Math.min(ye,we));(Oe!==ve||Ze!==we)&&(Y.position({x:Oe,y:Ze}),Y.batchDraw())},z=()=>{if(R)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const Y=document.querySelector(".drawing-canvas-container");Y&&(Y.requestFullscreen?Y.requestFullscreen():Y.webkitRequestFullscreen?Y.webkitRequestFullscreen():Y.msRequestFullscreen&&Y.msRequestFullscreen())}};return k.useEffect(()=>{const Y=()=>{I(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",Y),document.addEventListener("webkitfullscreenchange",Y),document.addEventListener("msfullscreenchange",Y),()=>{document.removeEventListener("fullscreenchange",Y),document.removeEventListener("webkitfullscreenchange",Y),document.removeEventListener("msfullscreenchange",Y)}},[]),u?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx(dr,{})}):t?c.jsxs("div",{className:`drawing-question max-w-6xl mx-auto p-1 sm:p-2 ${R?"fixed inset-0 z-50 bg-white":""}`,children:[!R&&c.jsx("div",{className:"mb-4",children:c.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",e+1]})}),!R&&t.question_json&&t.question_json.trim()&&c.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),c.jsx("div",{className:"text-gray-700",children:c.jsx(Hte,{content:t.question_json})})]}),!R&&c.jsx(at,{className:"p-1 sm:p-2 mb-2",children:c.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-sm text-gray-700",children:"Tool:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>m("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:""}),c.jsx("button",{onClick:()=>m("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:""}),c.jsx("button",{onClick:()=>m("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:""}),c.jsx("button",{onClick:()=>m("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:""}),P&&c.jsx("button",{onClick:()=>m("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:""})]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>N(!E),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[c.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:x}}),c.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),E&&c.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:c.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:V.map(Y=>c.jsx("button",{onClick:()=>{p(Y),N(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${x===Y?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:Y},title:Y},Y))})})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[c.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),c.jsx("input",{type:"range",min:"1",max:"10",value:v,onChange:Y=>_(parseInt(Y.target.value)),className:"w-16 sm:w-20"}),c.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[v,"px"]})]}),c.jsx(Ge,{onClick:U,variant:"secondary",size:"sm",children:"Clear"})]})}),c.jsx(at,{className:"p-1 sm:p-2",children:c.jsxs("div",{className:"w-full overflow-hidden drawing-canvas-container relative",children:[c.jsx(Gte,{width:S.width,height:S.height,lines:o,onDrawingChange:K,currentTool:h,currentColor:x,currentThickness:v,zoom:y,onZoomChange:b,isPanning:F,isFullscreen:R,constrainPanPosition:ne,handleWheel:Z,stageRef:W,setIsPanning:T,responsiveDimensions:le,canvasSize:S,question:t}),c.jsx("button",{onClick:z,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:R?"Exit Fullscreen":"Enter Fullscreen",children:R?c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},HA={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},Qr={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing"},Zs={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(t,e)=>e+1);const cc={DEBUG_MODE:!1,NOTIFICATION_DURATION:3e3},Xte=()=>{const t=Ua(),{login:e,setUserData:r,isAuthenticated:n,user:s}=Dn(),[a,i]=k.useState({username:"",password:""}),[o,l]=k.useState(!1),[u,d]=k.useState(""),[h,m]=k.useState([]),[x,p]=k.useState(!1);k.useEffect(()=>{v()},[]);const v=k.useCallback(()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager&&window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const R=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());R&&R.role?console.log("User role from JWT:",R.role):console.log("No valid role found in JWT, showing login")}catch(R){console.error("Error decoding JWT token:",R)}}else console.log("No valid JWT session found, showing login")},[]),_=k.useCallback(async R=>{if(R.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),T("Please wait for the logout process to complete.","warning");return}const{username:I,password:W}=a;if(!I||!W){d("Please enter both username and password");return}l(!0),d("");try{let le,q;I==="admin"?(le=await E2.adminLogin({username:I,password:W}),q=Zs.ADMIN):/^\d+$/.test(I)?(le=await E2.studentLogin({username:I,password:W}),q=Zs.STUDENT):(le=await E2.teacherLogin({username:I,password:W}),q=Zs.TEACHER);let V,K;if(le.response?(V=le,K=le.response):(V=await le.json(),K=le),await S(K,q,V)){T("Login successful!","success");try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(le){console.error("Login error:",le),N(le)}finally{l(!1)}},[a]),S=k.useCallback(async(R,I,W)=>{if(R.ok&&W.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),N(),!1;try{W.token&&(window.tokenManager.setTokens(W.token,I),W.refreshToken&&window.tokenManager.setRefreshToken(W.refreshToken),console.log("JWT token stored successfully"));const le={...W.data,...W,role:I};return r(le),await w(le),!0}catch(le){return console.error("Error handling login response:",le),N(le),!1}}else return console.error("Login failed:",W.error||"Unknown error"),d(W.error||"Login failed. Please check your credentials."),!1},[e]),w=k.useCallback(async R=>{if(console.log("Handling post-login actions for role:",R.role),x){console.log(" Post-login already handled, skipping");return}p(!0);try{switch(R.role){case Zs.STUDENT:await y(R),t("/student");break;case Zs.TEACHER:await b(R),t("/teacher");break;case Zs.ADMIN:await E(R),t("/admin");break;default:console.error("Unknown user role:",R.role),N()}}catch(I){console.error("Error in post-login actions:",I),N(I)}},[t,x]);k.useEffect(()=>{n||p(!1)},[n]);const y=k.useCallback(async R=>{console.log("Populating student info:",R)},[]),b=k.useCallback(async R=>{console.log("Populating teacher info:",R)},[]),E=k.useCallback(async R=>{console.log("Populating admin info:",R)},[]),N=k.useCallback((R=null)=>{console.error("Login failure:",R),d("Login failed. Please check your credentials and try again."),F()},[]),F=k.useCallback(()=>{i({username:"",password:""}),d(""),l(!1)},[]),T=k.useCallback((R,I)=>{const W={id:Date.now(),message:R,type:I,timestamp:new Date};m(le=>[...le,W]),setTimeout(()=>{m(le=>le.filter(q=>q.id!==W.id))},cc.NOTIFICATION_DURATION)},[]),P=k.useCallback(R=>{const{name:I,value:W}=R.target;i(le=>({...le,[I]:W})),u&&d("")},[u]),D=k.useCallback(R=>{R.key==="Enter"&&!o&&_(R)},[_,o]);return c.jsxs(Me.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsxs(Me.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsxs(Me.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsx(Me.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:c.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-16 w-16 object-contain"})}),c.jsx(Me.h1,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"Mathayom Watsing School"}),c.jsx(Me.p,{className:"text-lg text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:"Test Management System"})]}),c.jsxs(Me.div,{className:"bg-white rounded-xl shadow-2xl p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[c.jsx(Me.h2,{className:"text-2xl font-semibold text-gray-900 text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"Login"}),c.jsxs("form",{onSubmit:_,className:"space-y-6",children:[c.jsxs(Me.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[c.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Student ID"}),c.jsx(Me.input,{type:"text",id:"username",name:"username",value:a.username,onChange:P,onKeyDown:D,placeholder:"Enter student ID",required:!0,autoComplete:"username",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),c.jsxs(Me.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),c.jsx(Me.input,{type:"password",id:"password",name:"password",value:a.password,onChange:P,onKeyDown:D,placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),c.jsx(ea,{children:u&&c.jsx(Me.div,{id:"error-message",className:"bg-red-50 border border-red-200 rounded-lg p-3",role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:c.jsx("p",{className:"text-sm text-red-600",children:u})})}),c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:c.jsx(Ge,{type:"submit",variant:"primary",size:"lg",disabled:o,className:"w-full",children:o?c.jsxs(c.Fragment,{children:[c.jsx(dr,{size:"sm",className:"mr-2"}),"Logging in..."]}):"Login"})})]})]}),cc.DEBUG_MODE]}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:c.jsx(ea,{children:h.map(R=>c.jsx(Me.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:c.jsx(_o,{type:R.type,message:R.message,onClose:()=>m(I=>I.filter(W=>W.id!==R.id))})},R.id))})})]})},jT=({testResults:t,onBackToCabinet:e,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0})=>{if(!t||!t.showResults)return c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:i,testType:o,score:l,totalQuestions:u,percentage:d,passed:h,questionAnalysis:m,timestamp:x}=t,p=S=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[S]||S,v=S=>S>=80?"text-green-600 bg-green-50":S>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",_=S=>S?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):c.jsx("div",{className:"bg-gray-50 py-8 overflow-y-auto",children:c.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs(Me.div,{className:"bg-white rounded-lg shadow-lg p-6 mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[((t==null?void 0:t.caught_cheating)||s)&&c.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-6",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsxs("p",{className:"text-sm text-red-700",children:[c.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",(t==null?void 0:t.visibility_change_times)||a||0," times during the test."]})})]})}),c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Test Results"}),c.jsx("h2",{className:"text-xl text-gray-700 mb-1",children:(i==null?void 0:i.test_name)||"Test"}),c.jsxs("p",{className:"text-sm text-gray-500",children:[p(o),"  Completed on ",new Date(x).toLocaleDateString()]})]}),c.jsx("div",{className:"text-right",children:c.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${_(h)}`,children:h?" PASSED":" FAILED"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:l}),c.jsx("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:u}),c.jsx("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:`text-3xl font-bold ${v(d).split(" ")[0]}`,children:[d,"%"]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Score"})]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-6",children:c.jsx(Me.div,{className:`h-3 rounded-full ${v(d).split(" ")[1]}`,initial:{width:0},animate:{width:`${d}%`},transition:{duration:1,ease:"easeOut"}})}),c.jsx("div",{className:"flex flex-wrap gap-3",children:c.jsx(Ge,{onClick:e,variant:"primary",className:"flex items-center gap-2",children:" Back to Cabinet"})})]}),o!=="matching_type"&&o!=="word_matching"&&c.jsxs(Me.div,{className:"bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Question Review"}),c.jsx("div",{className:"space-y-4",children:m.map((S,w)=>c.jsxs(Me.div,{className:`p-4 rounded-lg border-2 ${S.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:w*.1},children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Question ",S.questionNumber]}),c.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${S.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.isCorrect?" Correct":" Incorrect"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Question:"}),c.jsx("p",{className:"text-gray-700 bg-gray-100 p-3 rounded",children:S.question})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Your Answer:"}),c.jsx("p",{className:`p-3 rounded ${S.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.userAnswer||"No answer provided"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Correct Answer:"}),c.jsx("p",{className:"bg-blue-100 text-blue-800 p-3 rounded",children:S.correctAnswer})]})]})]},w))})]}),c.jsxs(Me.div,{className:"bg-white rounded-lg shadow-lg p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Summary Statistics"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.filter(S=>S.isCorrect).length}),c.jsx("div",{className:"text-sm text-blue-600",children:"Correct"})]}),c.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-red-600",children:m.filter(S=>!S.isCorrect).length}),c.jsx("div",{className:"text-sm text-red-600",children:"Incorrect"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[Math.round(m.filter(S=>S.isCorrect).length/u*100),"%"]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy"})]}),c.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u}),c.jsx("div",{className:"text-sm text-purple-600",children:"Total"})]})]})]})]})})},aO=({isOpen:t,onClose:e,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1})=>{if(!t)return null;const o=h=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[h]||h,l=h=>({multiple_choice:"",true_false:"",input:"",matching_type:""})[h]||"",u=(h,m)=>{switch(m){case"multiple_choice":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[h.option_a&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),c.jsx("span",{className:"text-gray-700",children:h.option_a})]}),h.option_b&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),c.jsx("span",{className:"text-gray-700",children:h.option_b})]}),h.option_c&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),c.jsx("span",{className:"text-gray-700",children:h.option_c})]}),h.option_d&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),c.jsx("span",{className:"text-gray-700",children:h.option_d})]}),h.option_e&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),c.jsx("span",{className:"text-gray-700",children:h.option_e})]}),h.option_f&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),c.jsx("span",{className:"text-gray-700",children:h.option_f})]})]})]});case"true_false":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),c.jsx("span",{className:"text-gray-700",children:"True"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),c.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),c.jsx("div",{className:"bg-gray-100 p-3 rounded",children:c.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),c.jsx("div",{className:"bg-gray-100 p-3 rounded",children:c.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},d=(h,m)=>{if(!h.correct_answer)return null;let x="";switch(m){case"multiple_choice":x=h.correct_answer.toUpperCase();break;case"true_false":x=h.correct_answer?"True":"False";break;case"input":x=h.correct_answer;break;case"matching_type":x=typeof h.correct_answer=="object"?JSON.stringify(h.correct_answer):h.correct_answer;break;default:x=String(h.correct_answer)}return c.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[c.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),c.jsx("p",{className:"text-green-700 font-mono",children:x})]})};return c.jsx(ea,{children:c.jsxs(Me.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[c.jsx(Me.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs(Me.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("span",{className:"text-2xl",children:l(r)}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[o(r),"  ",a.length," Questions"]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Ge,{onClick:()=>window.print(),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Print"}),c.jsx(Ge,{onClick:e,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Close"})]})]}),c.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?c.jsx("div",{className:"flex items-center justify-center py-12",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):a.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),c.jsx("p",{className:"text-gray-500",children:"This test doesn't have any questions yet."})]}):c.jsx("div",{className:"space-y-6",children:a.map((h,m)=>c.jsxs(Me.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.1,duration:.3},children:[c.jsx("div",{className:"flex items-start justify-between mb-4",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",m+1]}),c.jsx("span",{className:"text-gray-500 text-sm",children:o(r)})]})}),c.jsx("div",{className:"mb-4",children:c.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:h.question||h.question_text})}),u(h,r),d(h,r)]},h.id||h.question_id||m))})}),c.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[c.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&c.jsxs("span",{children:["Showing ",a.length," question",a.length!==1?"s":""]})}),c.jsx("div",{className:"flex items-center space-x-3",children:c.jsx(Ge,{onClick:e,variant:"primary",className:"flex items-center space-x-2",children:"Close"})})]})]})})]})})},Yte=({answeredCount:t=0,totalQuestions:e=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i=""})=>{const o=e>0?Math.round(t/e*100):0,l=e-t,u=m=>{const x=Math.floor(m/3600),p=Math.floor(m%3600/60),v=m%60;return x>0?`${x}:${p.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`:`${p}:${v.toString().padStart(2,"0")}`},d=m=>m>=100?"bg-green-500":m>=80?"bg-blue-500":m>=60?"bg-yellow-500":m>=40?"bg-orange-500":"bg-red-500",h=m=>m>=100?"text-green-600":m>=80?"text-blue-600":m>=60?"text-yellow-600":m>=40?"text-orange-600":"text-red-600";return c.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 ${i}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Progress"}),c.jsx("div",{className:"flex items-center space-x-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsx("span",{className:"text-sm font-mono text-gray-600",children:u(r)})]})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),c.jsxs("span",{className:`text-sm font-semibold ${h(o)}`,children:[o,"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:c.jsx(Me.div,{className:`h-full ${d(o)} transition-colors duration-300`,initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5,ease:"easeOut"}})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[c.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t}),c.jsx("div",{className:"text-xs text-blue-600",children:"Answered"})]}),c.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-gray-600",children:l}),c.jsx("div",{className:"text-xs text-gray-600",children:"Remaining"})]}),c.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e}),c.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]})]}),c.jsx("div",{className:"mb-4",children:t===e?c.jsx(Me.div,{className:"flex items-center justify-center p-3 bg-green-50 border border-green-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:c.jsx("span",{className:"text-green-600 font-medium",children:" All questions answered! Ready to submit."})}):l===1?c.jsx(Me.div,{className:"flex items-center justify-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:c.jsx("span",{className:"text-yellow-600 font-medium",children:"Almost there! 1 question remaining."})}):c.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:c.jsxs("span",{className:"text-gray-600 font-medium",children:[l," questions remaining"]})})}),c.jsx("div",{className:"flex justify-center",children:c.jsx(Me.button,{onClick:n,disabled:!a||s,className:`px-8 py-3 rounded-lg font-semibold text-white transition-all duration-300 ${a&&!s?"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl":"bg-gray-400 cursor-not-allowed"}`,whileHover:a&&!s?{scale:1.05}:{},whileTap:a&&!s?{scale:.95}:{},children:s?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),c.jsx("span",{children:"Submitting..."})]}):a?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Submit Test"})]}):c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{children:""}),c.jsxs("span",{children:["Complete ",l," more question",l!==1?"s":""]})]})})}),t<e&&c.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:c.jsxs("div",{className:"text-sm text-blue-700",children:[c.jsx("strong",{children:" Tip:"})," Your progress is automatically saved. You can close this test and return later to continue where you left off."]})})]})};let Jte=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const e=localStorage.getItem(this.userKey);return e?JSON.parse(e):null}setToken(e){localStorage.setItem(this.tokenKey,e)}setRefreshToken(e){localStorage.setItem(this.refreshTokenKey,e)}setUserData(e){localStorage.setItem(this.userKey,JSON.stringify(e))}setTokens(e,r){this.setToken(e),this.setUserData({role:r}),localStorage.setItem("accessToken",e)}isAuthenticated(){const e=this.getToken();if(!e)return!1;try{const r=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const e=this.getUserData();return e?e.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const e=this.getToken();return e?`Bearer ${e}`:null}async makeAuthenticatedRequest(e,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(e,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(e,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const e=this.getRefreshToken();if(!e)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},50*60*1e3)}};const Bf=new Jte;window.tokenManager=Bf;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{Bf.init()}):Bf.init());const iO=async(t,e,r,n,s)=>{var a;try{console.log(" Fetching teacher student results:",{teacherId:t,grade:e,className:r,semester:n,academicPeriodId:s});const o=await(await Bf.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${t}&grade=${e}&class=${r}&semester=${n}&academic_period_id=${s}`)).json();if(o.success)return console.log(" Teacher student results loaded:",o.results.length,"results"),console.log(" Students loaded:",((a=o.students)==null?void 0:a.length)||0,"students"),{success:!0,results:o.results,students:o.students||[],count:o.results.length,student_count:o.student_count||0};throw new Error(o.error||"Failed to load teacher student results")}catch(i){return console.error("Error fetching teacher student results:",i),{success:!1,error:i.message,results:[]}}},oO=async(t,e)=>{try{console.log(" Fetching student results view:",{studentId:t,academicPeriodId:e});const r=e?`&academic_period_id=${e}`:"",s=await(await Bf.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${t}${r}`)).json();if(s.success)return console.log(" Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},Qte=async(t,e,r,n)=>{try{console.log(" Fetching class summary:",{teacherId:t,grade:e,className:r,academicPeriodId:n});const a=await(await Bf.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${t}&grade=${e}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log(" Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},qte=async(t,e,r,n,s,a={})=>{try{const i=await iO(t,e,r,n,s);if(!i.success)return i;let o=i.results;return a.subject&&(o=o.filter(l=>l.subject&&l.subject.toLowerCase().includes(a.subject.toLowerCase()))),a.testType&&(o=o.filter(l=>l.test_type===a.testType)),a.minScore!==void 0&&(o=o.filter(l=>l.score/l.max_score*100>=a.minScore)),a.maxScore!==void 0&&(o=o.filter(l=>l.score/l.max_score*100<=a.maxScore)),a.passed!==void 0&&(o=o.filter(l=>l.score>=l.passing_score===a.passed)),{success:!0,results:o,count:o.length,originalCount:i.results.length}}catch(i){return console.error("Error filtering teacher student results:",i),{success:!1,error:i.message,results:[]}}},Zte=async(t,e,r={})=>{try{const n=await oO(t,e);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},ere={getTeacherStudentResults:iO,getStudentResultsView:oO,getClassSummary:Qte,getTeacherStudentResultsFiltered:qte,getStudentResultsViewFiltered:Zte};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tre=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),rre=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),KA=t=>{const e=rre(t);return e.charAt(0).toUpperCase()+e.slice(1)},lO=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),nre=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var sre={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const are=k.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},l)=>k.createElement("svg",{ref:l,...sre,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:lO("lucide",s),...!a&&!nre(o)&&{"aria-hidden":"true"},...o},[...i.map(([u,d])=>k.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=(t,e)=>{const r=k.forwardRef(({className:n,...s},a)=>k.createElement(are,{ref:a,iconNode:e,className:lO(`lucide-${tre(KA(t))}`,`lucide-${t}`,n),...s}));return r.displayName=KA(t),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ire=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ore=im("download",ire);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lre=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],cre=im("rotate-cw",lre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ure=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],XA=im("x",ure);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dre=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],fre=im("zoom-in",dre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hre=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],gre=im("zoom-out",hre),cO=({drawing:t,isOpen:e,onClose:r,onScoreChange:n,onMaxScoreChange:s})=>{var U,L;const[a,i]=k.useState([]),[o,l]=k.useState([]),[u,d]=k.useState(0),[h,m]=k.useState({width:600,height:800}),[x,p]=k.useState(1),[v,_]=k.useState(0),[S,w]=k.useState(!1),[y,b]=k.useState({x:0,y:0}),[E,N]=k.useState({x:0,y:0}),F=k.useRef(null);k.useEffect(()=>{if(e&&t){p(1),_(0),N({x:0,y:0}),console.log(" DrawingModal - drawing object:",t),console.log(" DrawingModal - drawing.answers:",t.answers);let Z=[];if(t.answers){console.log(" DrawingModal - drawing.answers type:",typeof t.answers),console.log(" DrawingModal - drawing.answers:",t.answers);let ne;if(typeof t.answers=="string"){console.log(" DrawingModal - drawing.answers is a string, parsing JSON...");try{ne=JSON.parse(t.answers),console.log(" DrawingModal - parsed answers:",ne)}catch(z){console.error(" DrawingModal - Error parsing JSON string:",z),ne=null}}else Array.isArray(t.answers)?(console.log(" DrawingModal - drawing.answers is already an array"),ne=t.answers):(console.log(" DrawingModal - drawing.answers is neither string nor array:",typeof t.answers),ne=null);if(ne)if(Array.isArray(ne)&&ne.length>0){console.log(" DrawingModal - processing",ne.length,"questions");const z=[];ne.forEach((Y,J)=>{console.log(` DrawingModal - processing question ${J+1}:`,Y);let te=[];if(typeof Y=="string")try{const de=JSON.parse(Y);console.log(` DrawingModal - parsed drawing data for question ${J+1}:`,de),Array.isArray(de)?de.length>0&&Array.isArray(de[0])?(te=de,console.log(` DrawingModal - question ${J+1} has lines:`,de)):(te=[de],console.log(` DrawingModal - question ${J+1} has single line:`,de)):console.log(` DrawingModal - parsed drawing for question ${J+1} is not an array`)}catch(de){console.error(` DrawingModal - Error parsing question ${J+1}:`,de)}else Array.isArray(Y)?(te=Y,console.log(` DrawingModal - question ${J+1} is already array:`,Y)):console.log(` DrawingModal - question ${J+1} is not a string or array`);z.push({questionNumber:J+1,drawingData:te})}),console.log(" DrawingModal - processed questions:",z),l(z),z.length>0?(console.log(" DrawingModal - Setting first question data:",z[0].drawingData),i(z[0].drawingData),d(0),console.log(" DrawingModal - First question set, drawingData length:",z[0].drawingData.length)):console.log(" DrawingModal - No questions to display")}else console.log(" DrawingModal - answers is not an array or is empty");else console.log(" DrawingModal - answers is null or invalid")}else console.log(" DrawingModal - No answers field in drawing object");if(Z.length===0){if(console.log(" DrawingModal - No drawing data found, trying alternative approaches..."),t.drawing_data){console.log(" DrawingModal - Found drawing_data field:",t.drawing_data);try{const ne=JSON.parse(t.drawing_data);Array.isArray(ne)&&(Z=ne,console.log(" DrawingModal - Using drawing_data field:",ne))}catch(ne){console.error(" DrawingModal - Error parsing drawing_data:",ne)}}t.answers&&Array.isArray(t.answers)&&(console.log(" DrawingModal - answers is already an array:",t.answers),Z=t.answers)}i(Z),console.log(" DrawingModal - Final drawing data:",Z),t.canvas_width&&t.canvas_height?(m({width:t.canvas_width,height:t.canvas_height}),console.log(" DrawingModal - Using canvas size from drawing data:",t.canvas_width,"x",t.canvas_height),console.log(" DrawingModal - Image resolution:",t.canvas_width*t.canvas_height,"pixels"),console.log(" DrawingModal - Aspect ratio:",(t.canvas_width/t.canvas_height).toFixed(2))):(m({width:1536,height:2048}),console.log(" DrawingModal - Using maximum canvas size to show all lines"),console.log(" DrawingModal - Image resolution:",1536*2048,"pixels"),console.log(" DrawingModal - This will display all drawing lines to the teacher"))}},[e,t]),k.useEffect(()=>{console.log(" DrawingModal - questionsData changed:",o.length,"questions"),console.log(" DrawingModal - currentQuestionIndex:",u),console.log(" DrawingModal - drawingData.length:",a.length),o.length>0&&(console.log(" DrawingModal - Setting first question from questionsData"),i(o[0].drawingData),d(0),console.log(" DrawingModal - First question data:",o[0].drawingData))},[o]);const T=()=>{const Z=(t==null?void 0:t.max_canvas_width)||1536,ne=(t==null?void 0:t.max_canvas_height)||2048,z=Z/h.width,Y=ne/h.height,J=Math.min(z,Y,5);p(te=>{const de=Math.min(te*1.2,J),ee=Math.round(h.width*de),ge=Math.round(h.height*de),fe=ee*ge;return console.log(" DrawingModal - Zoom In:",te.toFixed(2),"->",de.toFixed(2)),console.log(" DrawingModal - New effective size:",ee,"x",ge),console.log(" DrawingModal - New resolution:",fe,"pixels"),console.log(" DrawingModal - Max allowed resolution:",Z*ne,"pixels"),console.log(" DrawingModal - Within bounds:",fe<=Z*ne),de})},P=()=>{const Z=(t==null?void 0:t.max_canvas_width)||1536,ne=(t==null?void 0:t.max_canvas_height)||2048;p(z=>{const Y=Math.max(z/1.2,.25),J=Math.round(h.width*Y),te=Math.round(h.height*Y),de=J*te;return console.log(" DrawingModal - Zoom Out:",z.toFixed(2),"->",Y.toFixed(2)),console.log(" DrawingModal - New effective size:",J,"x",te),console.log(" DrawingModal - New resolution:",de,"pixels"),console.log(" DrawingModal - Max allowed resolution:",Z*ne,"pixels"),console.log(" DrawingModal - Within bounds:",de<=Z*ne),Y})},D=()=>{_(Z=>(Z+90)%360)},R=Z=>{w(!0),b({x:Z.clientX-E.x,y:Z.clientY-E.y})},I=Z=>{S&&N({x:Z.clientX-y.x,y:Z.clientY-y.y})},W=()=>{w(!1)},le=Z=>{const ne=Z.scaleX(),z=800,Y=600,J=h.width*ne,te=h.height*ne,de=Math.max(0,(J-z)*.5),ee=Math.max(0,(te-Y)*.5),ge=-de,fe=-ee,ye=Z.x(),Ce=Z.y(),re=Math.max(ge,Math.min(de,ye)),ve=Math.max(fe,Math.min(ee,Ce));(re!==ye||ve!==Ce)&&(Z.position({x:re,y:ve}),Z.batchDraw())},q=Z=>{const ne=Z.target;le(ne)},V=()=>{if(F.current){const Z=F.current.toDataURL({mimeType:"image/png",quality:1,pixelRatio:2}),ne=document.createElement("a");ne.href=Z,ne.download=`drawing-${(t==null?void 0:t.name)||"student"}.png`,document.body.appendChild(ne),ne.click(),document.body.removeChild(ne)}},K=()=>{(t==null?void 0:t.score)!==void 0&&(t==null?void 0:t.max_score)!==void 0&&r()};return!e||!t?null:c.jsx(ea,{children:c.jsx(Me.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:c.jsxs(Me.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl max-h-[90vh] w-full mx-4 flex flex-col",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:Z=>Z.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[t.name," ",t.surname," - ",t.test_name]})]}),c.jsx(Ge,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:c.jsx(XA,{className:"w-5 h-5"})})]}),o.length>1&&c.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Ge,{onClick:()=>{if(u>0){const Z=u-1;d(Z),i(o[Z].drawingData)}},disabled:u===0,variant:"outline",size:"sm",children:"Previous"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",u+1," of ",o.length]}),c.jsx(Ge,{onClick:()=>{if(u<o.length-1){const Z=u+1;d(Z),i(o[Z].drawingData)}},disabled:u===o.length-1,variant:"outline",size:"sm",children:"Next"})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[((L=(U=o[u])==null?void 0:U.drawingData)==null?void 0:L.length)||0," lines"]})]})}),c.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"flex-1 relative overflow-auto bg-gray-100 p-4",children:[c.jsx("div",{className:"w-full h-full flex items-center justify-center",onMouseDown:R,onMouseMove:I,onMouseUp:W,onMouseLeave:W,style:{cursor:S?"grabbing":"grab"},children:(console.log(" DrawingModal - Rendering check - drawingData.length:",a.length),console.log(" DrawingModal - drawingData:",a),a.length===0)?c.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[c.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center",children:c.jsx(XA,{className:"w-8 h-8 text-gray-400"})}),c.jsx("p",{className:"text-gray-600",children:"No drawing data available"})]}):c.jsx("div",{style:{transform:`rotate(${v}deg) translate(${E.x}px, ${E.y}px)`,transformOrigin:"center center"},children:c.jsx(Rf,{ref:F,width:h.width,height:h.height,scaleX:x,scaleY:x,onDragMove:q,onDragEnd:()=>le(F.current),onWheel:Z=>{Z.evt.preventDefault();const ne=(t==null?void 0:t.max_canvas_width)||1536,z=(t==null?void 0:t.max_canvas_height)||2048,Y=ne/h.width,J=z/h.height,te=Math.min(Y,J,5),de=x,ee=Z.evt.deltaY>0?Math.max(de*.9,.25):Math.min(de*1.1,te),ge=Math.round(h.width*ee),fe=Math.round(h.height*ee),ye=ge*fe;console.log(" DrawingModal - Wheel zoom:",de.toFixed(2),"->",ee.toFixed(2)),console.log(" DrawingModal - New effective size:",ge,"x",fe),console.log(" DrawingModal - New resolution:",ye,"pixels"),console.log(" DrawingModal - Max allowed resolution:",ne*z,"pixels"),console.log(" DrawingModal - Within bounds:",ye<=ne*z),p(ee)},style:{maxWidth:"100%",maxHeight:"100%"},onLoad:()=>{console.log(" DrawingModal - Stage loaded with dimensions:",h.width,"x",h.height),console.log(" DrawingModal - Current zoom level:",x),console.log(" DrawingModal - Effective display size:",h.width*x,"x",h.height*x),console.log(" DrawingModal - Total pixels displayed:",Math.round(h.width*x*h.height*x))},children:c.jsx(Df,{children:a.map((Z,ne)=>{var z,Y;if(Array.isArray(Z)&&Z.length>0){let J=1/0,te=1/0,de=-1/0,ee=-1/0;a.forEach(Ze=>{Array.isArray(Ze)&&Ze.forEach(Re=>{Re&&typeof Re=="object"&&Re.x!==void 0&&Re.y!==void 0&&(J=Math.min(J,Re.x),te=Math.min(te,Re.y),de=Math.max(de,Re.x),ee=Math.max(ee,Re.y))})});const ge=de-J,fe=ee-te,ye=ge>0?h.width*.8/ge:1,Ce=fe>0?h.height*.8/fe:1,re=Math.min(ye,Ce),ve=(h.width-ge*re)/2-J*re,we=(h.height-fe*re)/2-te*re,Oe=Z.flatMap(Ze=>[Ze.x*re+ve,Ze.y*re+we]);return console.log(` DrawingModal - Line ${ne}:`,{originalPoints:Z.length,scaledPoints:Oe.length/2,scale:re,offsetX:ve,offsetY:we,firstPoint:{x:Oe[0],y:Oe[1]},lastPoint:{x:Oe[Oe.length-2],y:Oe[Oe.length-1]}}),c.jsx(ru,{points:Oe,stroke:((z=Z[0])==null?void 0:z.color)||"#000000",strokeWidth:(((Y=Z[0])==null?void 0:Y.thickness)||2)*re,tension:.5,lineCap:"round",lineJoin:"round"},ne)}return null})})})})}),c.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2",children:[c.jsx(Ge,{onClick:T,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:c.jsx(fre,{className:"w-4 h-4"})}),c.jsx(Ge,{onClick:P,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:c.jsx(gre,{className:"w-4 h-4"})}),c.jsx(Ge,{onClick:D,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:c.jsx(cre,{className:"w-4 h-4"})}),c.jsx(Ge,{onClick:V,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:c.jsx(ore,{className:"w-4 h-4"})})]}),c.jsxs("div",{className:"absolute bottom-4 left-4 bg-black bg-opacity-75 text-white px-3 py-1 rounded-full text-sm",children:[Math.round(x*100),"%"]})]}),c.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Score:"}),c.jsx("input",{type:"number",min:"0",max:t.max_score||100,value:t.score||"",onChange:Z=>n(t.id,Z.target.value),className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max Score:"}),c.jsx("input",{type:"number",min:"1",value:t.max_score||100,onChange:Z=>s(t.id,Z.target.value),className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"100"})]}),t.score!==void 0&&t.max_score!==void 0&&c.jsxs("div",{className:"text-sm text-gray-600",children:["Percentage: ",Math.round(t.score/t.max_score*100),"%"]})]}),c.jsx(Ge,{onClick:K,variant:"primary",size:"sm",children:"Save Score"})]})})]})]})})})},uO=({testType:t,testId:e,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:o=3})=>{const l=Ua(),{user:u,isAuthenticated:d}=Dn(),{testResults:h,loadTestResults:m}=ay(),[x,p]=k.useState(!0),[v,_]=k.useState(""),[S,w]=k.useState([]),[y,b]=k.useState([]),[E,N]=k.useState(null),[F,T]=k.useState([]),[P,D]=k.useState(0),[R,I]=k.useState(0),[W,le]=k.useState(!1),[q,V]=k.useState(null);k.useEffect(()=>{K()},[t,e]),k.useEffect(()=>{!t&&!e&&(h&&h.results?(console.log(" Using cached test results from TestContext"),b(h.results),p(!1)):L())},[t,e,h]);const K=k.useCallback(async()=>{console.log(" Initializing Student Results...");try{if(p(!0),_(""),!d||!u){console.log(" User not authenticated"),_("User not authenticated");return}if(u.role!==Zs.STUDENT){console.error(" Invalid user role for student results:",u.role),_("Access denied. Student role required.");return}console.log(" Loading test results..."),await m((u==null?void 0:u.student_id)||(u==null?void 0:u.id)||""),t&&e&&r&&(console.log(" Loading specific test results..."),await U(t,e,r)),console.log(" Student Results initialization complete!")}catch(fe){console.error(" Error initializing student results:",fe),_("Failed to initialize student results")}finally{p(!1)}},[d,u,t,e,r,m]),U=k.useCallback(async(fe,ye,Ce)=>{console.log(" Loading specific test results:",fe,ye);try{const re=await Er.getTestInfo(fe,ye);console.log(" Test info loaded:",re),N(re);const ve=await Er.getTestQuestions(fe,ye);console.log(" Test questions loaded:",ve),T(ve);const we=z(ve,Ce,fe),Oe=ve.length>0?Math.round(we/ve.length*100):0;D(we),I(Oe),console.log(" Test results calculated:",{score:we,percentage:Oe})}catch(re){throw console.error(" Error loading specific test results:",re),re}},[]),L=k.useCallback(async(fe=0)=>{console.log(" Loading all student results using existing test results API...",fe>0?`(retry ${fe})`:"");try{if(!((u==null?void 0:u.student_id)||(u==null?void 0:u.sub)))throw new Error("Student ID not found");const Ce=await Er.getStudentTestResults();if(Ce.success){console.log(" All student results loaded:",Ce.results.length,"results");const re=Ce.results.map(ve=>({...ve,caught_cheating:ve.caught_cheating||!1,visibility_change_times:ve.visibility_change_times||0}));b(re),V(new Date),Ce.results.length===0&&fe===0&&(console.log(" No results found, retrying in 2 seconds..."),setTimeout(()=>{L(1)},2e3))}else throw new Error(Ce.error||"Failed to load student results")}catch(ye){console.error(" Error loading all student results:",ye),_(ye.message)}},[u]),Z=k.useCallback(fe=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[fe]||fe,[]),ne=k.useCallback(fe=>{if(!fe||fe.length===0)return c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No results available"})});const ye=a?fe:fe.slice(0,o);return c.jsxs("div",{className:"overflow-x-auto",children:[c.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),c.jsx("th",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ye.map((Ce,re)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium text-gray-900",children:c.jsx("span",{className:"bg-blue-100 text-blue-800 px-0.5 sm:px-2 py-0.5 rounded text-xs",children:Z(Ce.subject)})}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-12 sm:max-w-none",children:Ce.teacher_name}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-16 sm:max-w-none",children:Ce.test_name}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500",children:c.jsx("div",{className:"flex flex-col items-center space-y-1",children:Ce.test_type==="drawing"?Ce.score!==null?c.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(Ce.score/Ce.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(Ce.score/Ce.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[Ce.score,"/",Ce.max_score," (",Math.round(Ce.score/Ce.max_score*100),"%)"]}):c.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):c.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(Ce.score/Ce.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(Ce.score/Ce.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[Ce.score,"/",Ce.max_score," (",Math.round(Ce.score/Ce.max_score*100),"%)"]})})}),c.jsx("td",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(Ce.submitted_at).toLocaleDateString()})]},re))})]}),fe.length>o&&i&&c.jsx("div",{className:"text-center pt-4",children:c.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${fe.length-o} More`})})]})},[Z,a,o,i]),z=k.useCallback((fe,ye,Ce)=>{console.log(" Calculating test score...");let re=0;return fe.forEach((ve,we)=>{const Oe=ye[we],Ze=J(ve,Ce);Y(ve,Oe,Ze,Ce)&&re++}),console.log(" Score calculated:",re,"out of",fe.length),re},[]),Y=k.useCallback((fe,ye,Ce,re)=>{if(!ye||!Ce)return!1;switch(re){case"true_false":return ye.toLowerCase()===Ce.toLowerCase();case"multiple_choice":return ye===Ce;case"input":return ye.toLowerCase().trim()===Ce.toLowerCase().trim();case"word_matching":return JSON.stringify(ye)===JSON.stringify(Ce);case"drawing":return ye&&ye!=="No answer";default:return!1}},[]),J=k.useCallback((fe,ye)=>{switch(ye){case"true_false":return fe.correct_answer||fe.answer;case"multiple_choice":return fe.correct_answer||fe.answer;case"input":return fe.correct_answer||fe.answer;case"word_matching":return fe.correct_answer||fe.answer;case"drawing":return"Drawing submitted";default:return fe.correct_answer||fe.answer}},[]),te=k.useCallback((fe,ye)=>{if(!fe)return"No answer";switch(ye){case"true_false":return fe.charAt(0).toUpperCase()+fe.slice(1).toLowerCase();case"multiple_choice":return fe.toUpperCase();case"input":return fe;case"word_matching":return typeof fe=="object"?Object.entries(fe).map(([Ce,re])=>`${Ce}  ${re}`).join(", "):fe;case"drawing":return"Drawing submitted";default:return fe}},[]),de=k.useCallback(()=>!E||!F||!r?null:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Test Results: ",E.test_name||E.title||"Test"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-blue-600",children:P}),c.jsx("p",{className:"text-sm text-gray-500",children:"Correct Answers"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:F.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Total Questions"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:`text-3xl font-bold ${R>=80?"text-green-600":R>=60?"text-yellow-600":"text-red-600"}`,children:[R,"%"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Score"})]})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions Review"}),c.jsx("div",{className:"space-y-4",children:F.map((fe,ye)=>{const Ce=r[ye],re=J(fe,t),ve=Y(fe,Ce,re,t);return c.jsxs("div",{className:`border rounded-lg p-4 ${ve?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",ye+1]}),c.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${ve?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ve?"Correct":"Incorrect"})]}),c.jsx("p",{className:"text-gray-700 mb-3",children:fe.question}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Your Answer:"}),c.jsx("p",{className:"text-sm text-gray-900",children:te(Ce,t)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Correct Answer:"}),c.jsx("p",{className:"text-sm text-gray-900",children:te(re,t)})]})]})]},ye)})})]})]}),[E,F,r,t,P,R,J,Y,te]),ee=k.useCallback(()=>{if(!y||y.length===0)return c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No test results available yet."})});const fe={};return y.forEach(ye=>{const Ce=ye.subject||"Unknown Subject";fe[Ce]||(fe[Ce]=[]),fe[Ce].push(ye)}),c.jsx("div",{className:"space-y-6",children:Object.entries(fe).map(([ye,Ce])=>c.jsxs("div",{className:"bg-white rounded-lg shadow",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ye})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ce.map((re,ve)=>{const we=Math.round(re.score/re.max_score*100),Oe=we>=80?"text-green-600":we>=60?"text-yellow-600":"text-red-600";return c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:re.test_name}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.teacher_name||"Unknown"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsxs("span",{className:Oe,children:[re.score,"/",re.max_score," (",we,"%)"]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(re.submitted_at).toLocaleDateString()})]},ve)})})]})})]},ye))})},[y]);k.useCallback(()=>{console.log(" Clearing test data and returning to cabinet..."),N(null),T([]),setStudentAnswers(null),D(0),I(0),le(!1),n?n():l("/student")},[n,l]);const ge=k.useCallback(()=>{console.log(" Navigating back to cabinet..."),n?n():l("/student")},[n,l]);return k.useCallback((fe,ye)=>{const Ce={id:Date.now(),message:fe,type:ye,timestamp:new Date};w(re=>[...re,Ce]),setTimeout(()=>{w(re=>re.filter(ve=>ve.id!==Ce.id))},cc.NOTIFICATION_DURATION)},[]),x?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(dr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Student Results..."})]})}):v?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:v}),c.jsx(Ge,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?c.jsxs("div",{children:[x?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(dr,{size:"md"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Loading results..."})]}):v?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-red-500 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-red-600",children:v})]}):ne(y),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:S.map(fe=>c.jsx(_o,{type:fe.type,message:fe.message,onClose:()=>w(ye=>ye.filter(Ce=>Ce.id!==fe.id))},fe.id))})]}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Results"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",q?q.toLocaleString():"Never"]})]}),c.jsxs("div",{className:"flex space-x-3",children:[E&&c.jsx(Ge,{variant:"outline",onClick:()=>le(!W),children:W?"Hide Details":"Show Details"}),c.jsx(Ge,{variant:"outline",onClick:ge,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:W&&E?de():ee()}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:S.map(fe=>c.jsx(_o,{type:fe.type,message:fe.message,onClose:()=>w(ye=>ye.filter(Ce=>Ce.id!==fe.id))},fe.id))}),selectedDrawing&&c.jsx(cO,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},mre=({isMenuOpen:t,onToggleMenu:e,onShowPasswordChange:r})=>{var ve;const n=Ua(),{user:s,isAuthenticated:a,logout:i}=Dn(),{studentData:o,loadStudentData:l}=iy(),{activeTests:u,testResults:d,loadActiveTests:h,loadTestResults:m,viewTestDetails:x,testDetailsModal:p,closeTestDetailsModal:v}=ay(),[_,S]=k.useState(!0),[w,y]=k.useState(""),[b,E]=k.useState([]),[N,F]=k.useState(null),[T,P]=k.useState(!1),[D,R]=k.useState(null),[I,W]=k.useState(null),[le,q]=k.useState(new Set),[V,K]=k.useState(!1),[U,L]=k.useState(!1),[Z,ne]=k.useState(!1),[z,Y]=k.useState(!1);k.useEffect(()=>{J()},[]),k.useEffect(()=>()=>{ne(!1)},[]),k.useEffect(()=>{if(Z){const we=setTimeout(()=>{ne(!1)},1e3);return()=>clearTimeout(we)}},[Z]);const J=k.useCallback(async()=>{console.log(" Initializing Student Cabinet...");try{if(S(!0),y(""),!a||!s){console.log(" User not authenticated, redirecting to login"),n("/login");return}if(s.role!==Zs.STUDENT){console.error(" Invalid user role for student cabinet:",s.role),y("Access denied. Student role required.");return}console.log(" Loading student data..."),await l(),console.log(" Loading active tests..."),await h(),console.log(" Loading test results..."),await m((s==null?void 0:s.student_id)||(s==null?void 0:s.id)||""),console.log(" Calculating average score..."),await te(),console.log(" Student Cabinet initialization complete!")}catch(we){console.error(" Error initializing student cabinet:",we),y("Failed to initialize student cabinet")}finally{S(!1)}},[a,s,n]),te=k.useCallback(async()=>{console.log(" Calculating average score...");try{if(d&&d.length>0){const we=d.reduce((Ze,Re)=>typeof Re.score=="number"&&typeof Re.max_score=="number"&&Re.max_score>0?Ze+Math.round(Re.score/Re.max_score*100):Ze,0),Oe=Math.round(we/d.length);W(Oe),console.log(" Average score calculated:",Oe)}}catch(we){console.error(" Error calculating average score:",we)}},[d]);k.useEffect(()=>{if(Z){console.log(" Skipping completed tests initialization during navigation");return}const we=new Set,Oe=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||"";for(let Ze=0;Ze<localStorage.length;Ze++){const Re=localStorage.key(Ze);if(Re&&Re.startsWith(`test_completed_${Oe}_`)&&localStorage.getItem(Re)==="true"){const $t=Re.replace(`test_completed_${Oe}_`,"").split("_");if($t.length>=2){const Ae=$t[0],Pe=$t.slice(1).join("_"),Ue=`${Ae}_${Pe}`;we.add(Ue),console.log(" Found completed test in localStorage:",Ue)}}}q(we),Y(!0),console.log(" Initialized completed tests from localStorage:",Array.from(we))},[s==null?void 0:s.student_id,s==null?void 0:s.id,Z]),k.useEffect(()=>{console.log(" testResults structure:",d);const we=(d==null?void 0:d.results)||d;if(console.log(" resultsArray:",we),we&&we.length>0){const Oe=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||"",Ze=new Set;we.forEach(Re=>{const xt=`${Re.test_type}_${Re.test_id}`;Ze.add(xt),localStorage.setItem(`test_completed_${Oe}_${Re.test_type}_${Re.test_id}`,"true")}),q(Re=>{const xt=new Set([...Re,...Ze]);return console.log(" Updated completed tests (merged):",Array.from(xt)),xt})}},[d,s==null?void 0:s.student_id,s==null?void 0:s.id]);const de=k.useCallback(async(we,Oe)=>{console.log(" Checking test completion:",we,Oe);try{const Ze=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||"",Re=`test_completed_${Ze}_${we}_${Oe}`,xt=localStorage.getItem(Re);if(console.log(" localStorage key:",Re),console.log(" localStorage value:",xt),we==="word_matching"){console.log(" Debug: All localStorage keys for student",Ze);for(let Ae=0;Ae<localStorage.length;Ae++){const Pe=localStorage.key(Ae);Pe&&Pe.includes(Ze)&&Pe.includes("word_matching")&&console.log(" Found word_matching key:",Pe,"=",localStorage.getItem(Pe))}}if(xt==="true")return console.log(" Found completion status in local storage:",xt),!0;const $t=(d==null?void 0:d.results)||d;return $t&&$t.length>0&&(console.log(" Checking database results:",$t.length,"results"),$t.some(Pe=>(console.log(" Checking result:",Pe.test_type,Pe.test_id,"vs",we,Oe),Pe.test_type===we&&Pe.test_id===Oe)))?(console.log(" Found completion status in database results"),localStorage.setItem(Re,"true"),!0):(console.log(" Test not completed according to local storage or database"),!1)}catch(Ze){return console.error(" Error checking test completion:",Ze),!1}},[d,s==null?void 0:s.student_id,s==null?void 0:s.id]),ee=k.useCallback((we,Oe)=>{const Ze={id:Date.now(),message:we,type:Oe,timestamp:new Date};E(Re=>[...Re,Ze]),setTimeout(()=>{E(Re=>Re.filter(xt=>xt.id!==Ze.id))},cc.NOTIFICATION_DURATION)},[]),ge=k.useCallback(async we=>{console.log(" Showing test details:",we);try{await x(we.test_type,we.test_id,we.test_name)}catch(Oe){console.error("Error loading test details:",Oe),ee("Failed to load test details","error")}},[x,ee]),fe=k.useCallback(we=>{console.log(" Starting test:",we);const Oe=`${we.test_type}_${we.test_id}`;if(le.has(Oe)){ee("This test has already been completed","warning");return}if(ne(!0),console.log(" Set isStartingTest to true for test:",we.test_type),we.test_type==="matching_type"){console.log(" Redirecting to matching test page for testId:",we.test_id),n(`/student/matching-test/${we.test_id}`);return}if(we.test_type==="word_matching"){console.log(" Redirecting to word matching test page for testId:",we.test_id),n(`/student/word-matching-test/${we.test_id}`);return}n(`/student/test/${we.test_type}/${we.test_id}`)},[n,le,ee]),ye=k.useCallback(()=>{K(we=>!we)},[]),Ce=k.useCallback(()=>{L(we=>!we)},[]),re=k.useCallback(async we=>{if(console.log(" Starting test:",we),Z){console.log(" Test already starting, ignoring click");return}try{if(await de(we.test_type,we.test_id)){ee("This test has already been completed","warning");return}fe(we)}catch(Oe){console.error(" Error starting test:",Oe),ee("Failed to start test. Please try again.","error")}},[de,fe,ee,Z]);return k.useCallback(we=>{console.log(" Viewing test details:",we),ge(we)},[ge]),_?c.jsx(Me.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:c.jsxs(Me.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx(dr,{size:"lg"}),c.jsx(Me.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):w?c.jsx(Me.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:c.jsx(Me.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:c.jsxs(Me.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[c.jsx(Me.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:""}),c.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),c.jsx("p",{className:"text-red-600 mb-6",children:w}),c.jsx(Ge,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs(Me.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(Me.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-6",children:[c.jsxs(Me.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Me.div,{className:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:c.jsx("span",{className:"text-white font-semibold text-xl",children:((ve=s==null?void 0:s.name)==null?void 0:ve.charAt(0))||"S"})})}),c.jsxs("div",{children:[c.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white",children:[s==null?void 0:s.name," ",s==null?void 0:s.surname]}),c.jsxs("p",{className:"text-blue-100 text-sm sm:text-base md:text-lg",children:["Grade ",s==null?void 0:s.grade," - Class ",s==null?void 0:s.class]})]})]}),c.jsxs(Me.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsxs("button",{onClick:e,className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",style:{zIndex:1e3},children:[c.jsx("span",{className:"hidden sm:inline",children:"Menu"}),c.jsx(Me.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:t?180:0},transition:{duration:.2},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),c.jsx(ea,{children:t&&c.jsx(Me.div,{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:c.jsxs("div",{className:"py-2",children:[c.jsx(Me.button,{onClick:r,className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),c.jsx(Me.button,{onClick:()=>{e(),i()},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),c.jsxs(Me.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:c.jsx("div",{className:"lg:col-span-1 space-y-6",children:I!==null&&c.jsx(Me.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:c.jsxs(at,{children:[c.jsx(at.Header,{children:c.jsx(at.Title,{children:"Average Score"})}),c.jsx(at.Body,{children:c.jsxs(Me.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[c.jsxs(Me.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[I,"%"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Overall Performance"})]})})]})})})}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:c.jsxs(at,{children:[c.jsx(at.Header,{children:c.jsx(at.Title,{className:"text-center",children:"Active Tests"})}),c.jsx(at.Body,{children:u&&u.length>0?c.jsxs("div",{className:"relative",children:[console.log(" Rendering overlay, isStartingTest:",Z),Z&&c.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 border-blue-200",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Starting test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait..."})]})}),c.jsxs("div",{className:"space-y-4",children:[(V?u:u.slice(0,3)).map((we,Oe)=>c.jsx(Me.div,{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:V?0:.7+Oe*.1,duration:.3},whileHover:{scale:1.02},children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[c.jsx("h3",{className:"text-sm sm:text-lg font-medium text-gray-900 w-16 sm:w-auto break-words leading-tight line-clamp-2 sm:line-clamp-none",children:we.test_name}),c.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:we.subject}),c.jsx("span",{className:"text-gray-500",children:we.teacher_name}),c.jsxs("span",{className:"text-gray-500",children:[c.jsx("span",{className:"sm:hidden",children:new Date(we.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}),c.jsx("span",{className:"hidden sm:inline",children:new Date(we.assigned_at).toLocaleDateString()})]})]})}),c.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const Ze=`${we.test_type}_${we.test_id}`,Re=le.has(Ze);return z?Re?c.jsx(Ge,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):(console.log(" Button render, isStartingTest:",Z,"test:",we.test_type),c.jsx(Ge,{variant:"primary",size:"sm",onClick:()=>re(we),disabled:Z,children:"Start Test"})):c.jsx(Ge,{variant:"secondary",size:"sm",disabled:!0,className:"bg-gray-100 text-gray-500 border-gray-200",children:"Loading..."})})()})]})},`${we.test_type}_${we.test_id}`)),u.length>3&&c.jsx("div",{className:"text-center pt-2",children:c.jsx("button",{onClick:ye,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:V?"Show Less":`Show ${u.length-3} More`})})]})]}):c.jsxs(Me.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[c.jsx(Me.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"},children:""}),c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Active Tests"}),c.jsx("p",{className:"text-gray-500",children:"No active tests available for your class at the moment."})]})})]})}),c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:c.jsxs(at,{children:[c.jsx(at.Header,{children:c.jsx(at.Title,{children:"Test Results"})}),c.jsx(at.Body,{children:d&&d.showResults?c.jsx(jT,{testResults:d,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(we,Oe)=>{const Re=`test_completed_${(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||""}_${we}_${Oe}`;localStorage.removeItem(Re),h(),setTestResults(null)},isLoading:_}):c.jsx(uO,{compact:!0,showAll:U,onToggleShowAll:Ce,maxInitial:3})})]})})]})]}),c.jsx(aO,{isOpen:p.isOpen,onClose:v,testType:p.testType,testId:p.testId,testName:p.testName,questions:p.questions||[],isLoading:p.isLoading||!1}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:c.jsx(ea,{children:b.map(we=>c.jsx(Me.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:c.jsx(Notification,{type:we.type,message:we.message,onClose:()=>E(Oe=>Oe.filter(Ze=>Ze.id!==we.id))})},we.id))})})]})},pre=({testInfo:t,questions:e,testType:r,studentAnswers:n,onBackToCabinet:s,calculateTestScore:a,checkAnswerCorrectness:i,formatStudentAnswerForDisplay:o,getCorrectAnswer:l})=>{const[u,d]=k.useState(0),[h,m]=k.useState(0),[x,p]=k.useState(!0);if(k.useEffect(()=>{const S=()=>{try{const w=a(e,n,r),y=(t==null?void 0:t.num_questions)||(e==null?void 0:e.length)||0,b=y>0?Math.round(w/y*100):0;d(w),m(b),p(!1)}catch(w){console.error("Error calculating test results:",w),d(0),m(0),p(!1)}};e&&e.length>0?S():p(!1)},[e,n,r,t,a]),x)return c.jsx("div",{className:"flex justify-center items-center min-h-64",children:c.jsx("div",{className:"text-lg",children:"Calculating results..."})});const v=(t==null?void 0:t.num_questions)||(e==null?void 0:e.length)||0,_=(t==null?void 0:t.test_name)||(t==null?void 0:t.title)||"Test";return c.jsxs("div",{className:"test-results-page max-w-4xl mx-auto p-6",children:[c.jsx(at,{className:"mb-6",children:c.jsxs("div",{className:"results-header text-center",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Test Results: ",_]}),c.jsx("p",{className:"text-gray-600",children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),c.jsx(at,{className:"mb-6",children:c.jsxs("div",{className:"results-summary",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 text-center",children:["Your Score: ",u," / ",v," (",h,"%)"]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:c.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${h>=80?"bg-green-500":h>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${h}%`}})}),c.jsx("div",{className:"text-center",children:c.jsx("p",{className:`text-lg font-medium ${h>=80?"text-green-600":h>=60?"text-yellow-600":"text-red-600"}`,children:h>=80?"Excellent!":h>=60?"Good job!":"Keep practicing!"})})]})}),e&&e.length>0&&c.jsx(at,{className:"mb-6",children:c.jsxs("div",{className:"questions-review",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Question Review"}),c.jsx("div",{className:"space-y-4",children:e.map((S,w)=>{const y=n[String(S.question_id)]||"No answer",b=i(S,y,r);return c.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${b?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[c.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[c.jsxs("h4",{className:"text-lg font-medium text-gray-800",children:["Question ",w+1]}),c.jsx("span",{className:`text-2xl font-bold ${b?"text-green-600":"text-red-600"}`,children:b?"":""})]}),c.jsx("div",{className:"question-text mb-3",children:c.jsx("p",{className:"text-gray-700 font-medium",children:S.question})}),c.jsxs("div",{className:"answer-section space-y-2",children:[c.jsxs("p",{className:"student-answer",children:[c.jsx("strong",{className:"text-gray-600",children:"Your Answer:"})," ",c.jsx("span",{className:`font-medium ${b?"text-green-700":"text-red-700"}`,children:o(y,r)})]}),!b&&c.jsxs("p",{className:"correct-answer",children:[c.jsx("strong",{className:"text-gray-600",children:"Correct Answer:"})," ",c.jsx("span",{className:"text-green-700 font-medium",children:l(S,r)})]})]})]},S.question_id||w)})})]})}),c.jsx(at,{children:c.jsx("div",{className:"results-actions text-center",children:c.jsx(Ge,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-medium",children:"Back to Cabinet"})})})]})},xre=({onBackToCabinet:t,currentTest:e})=>{const r=Ua(),{user:n,isAuthenticated:s}=Dn(),{activeTests:a,loadActiveTests:i}=ay(),o=k.useCallback((xe,De,Le)=>{try{const ht=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${xe}_${De}`;localStorage.setItem(ht,JSON.stringify(Le)),console.log(`Saved test progress for ${xe}_${De}:`,Le)}catch(pt){console.error("Error saving test progress:",pt)}},[n==null?void 0:n.student_id,n==null?void 0:n.id]),l=k.useCallback((xe,De)=>{try{const pt=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${xe}_${De}`,ht=localStorage.getItem(pt);return ht?JSON.parse(ht):null}catch(Le){return console.error("Error getting test progress:",Le),null}},[n==null?void 0:n.student_id,n==null?void 0:n.id]),u=k.useCallback((xe,De)=>{try{const Le=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown",pt=`test_progress_${Le}_${xe}_${De}`;localStorage.removeItem(pt);for(let ht=0;ht<localStorage.length;ht++){const Tt=localStorage.key(ht);Tt&&Tt.startsWith(`test_progress_${Le}_${xe}_${De}_`)&&(localStorage.removeItem(Tt),console.log(` Cleared individual question key: ${Tt}`))}console.log(`Cleared test progress for ${xe}_${De}`)}catch(Le){console.error("Error clearing test progress:",Le)}},[n==null?void 0:n.student_id,n==null?void 0:n.id]),[d,h]=k.useState(!0),[m,x]=k.useState(!1),[p,v]=k.useState(""),[_,S]=k.useState([]),[w,y]=k.useState(e?"test":"list"),[b,E]=k.useState(null),[N,F]=k.useState(null),[T,P]=k.useState(null),[D,R]=k.useState([]),[I,W]=k.useState([]),[le,q]=k.useState(0),[V,K]=k.useState(0),[U,L]=k.useState(null),[Z,ne]=k.useState(!1),[z,Y]=k.useState(!1),[J,te]=k.useState(null),[de,ee]=k.useState(null),{startTracking:ge,stopTracking:fe,getCheatingData:ye,clearData:Ce,isCheating:re,tabSwitches:ve}=_v(b==null?void 0:b.test_type,b==null?void 0:b.test_id,(n==null?void 0:n.student_id)||(n==null?void 0:n.id));k.useEffect(()=>{(()=>{const De=[];for(let Le=0;Le<localStorage.length;Le++){const pt=localStorage.key(Le);if(pt&&pt.startsWith("test_progress_")&&!pt.includes("_51712_")&&!pt.includes("_51736_")){const ht=pt.split("_");ht.length===4&&ht[0]==="test"&&ht[1]==="progress"&&De.push(pt)}}De.forEach(Le=>{localStorage.removeItem(Le),console.log(" Cleared old cache key:",Le)})})()},[]),k.useEffect(()=>{we()},[]),k.useEffect(()=>{e&&(console.log(" Auto-starting test from prop:",e),x(!0),Re(e))},[e]);const we=k.useCallback(async()=>{console.log(" Initializing Student Tests...");try{if(h(!0),v(""),!s||!n){console.log(" User not authenticated"),v("User not authenticated");return}if(n.role!==Zs.STUDENT){console.error(" Invalid user role for student tests:",n.role),v("Access denied. Student role required.");return}console.log(" Loading active tests..."),await i(),console.log(" Student Tests initialization complete!")}catch(xe){console.error(" Error initializing student tests:",xe),v("Failed to initialize student tests")}finally{h(!1)}},[s,n,i]);k.useCallback(async()=>{console.log(" Loading student active tests...");try{const xe=await Er.getActiveTests();console.log(" Active tests loaded:",xe);const De=xe.map(Le=>({...Le,subject_id:Le.subject_id||Le.subjectId,teacher_id:Le.teacher_id||Le.teacherId,is_active:Le.is_active!==void 0?Le.is_active:!0,created_at:Le.created_at||Le.createdAt,updated_at:Le.updated_at||Le.updatedAt}));return ee(new Date),De}catch(xe){throw console.error(" Error loading active tests:",xe),xe}},[]),k.useCallback(async(xe,De)=>{console.log(" Checking test completion:",xe,De);try{const Le=l(xe,De);return Le&&Le.completed}catch(Le){return console.error(" Error checking test completion:",Le),!1}},[l]),k.useEffect(()=>{if(D.length>0&&(b!=null&&b.test_id)){const xe=setTimeout(()=>{let De=!1;const Le=new Array(D.length).fill("");if(D.forEach((pt,ht)=>{const gr=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${N}_${b==null?void 0:b.test_id}_${pt.question_id}`,tr=localStorage.getItem(gr);if(tr){const mr=tr.replace(/^"(.*)"$/,"$1");Le[ht]=mr,De=!0}}),De){W(Le);const pt=Le.filter(Tt=>Tt&&typeof Tt=="string"&&Tt.trim()!=="").length,ht=D.length>0?pt/D.length*100:0;q(ht)}},100);return()=>clearTimeout(xe)}},[D,N,b==null?void 0:b.test_id]);const Oe=k.useCallback(async(xe,De)=>{console.log(" Marking test as completed:",xe,De);try{const Le=l(xe,De)||{};Le.completed=!0,Le.completedAt=new Date().toISOString(),o(xe,De,Le);const ht=`test_completed_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||""}_${xe}_${De}`;localStorage.setItem(ht,"true"),console.log(" Test completion marked in localStorage:",ht),console.log(" localStorage value after setting:",localStorage.getItem(ht)),Mt("Test marked as completed","success")}catch(Le){console.error(" Error marking test as completed:",Le),Mt("Failed to mark test as completed","error")}},[l,o]),Ze=k.useCallback(xe=>{console.log(" Showing test details:",xe),te(xe),Y(!0)},[]),Re=k.useCallback(async xe=>{console.log(" Starting test:",xe);try{h(!0);const Le=`test_completed_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||""}_${xe.test_type}_${xe.test_id}`;if(localStorage.getItem(Le)==="true"){console.log(" Test already completed, redirecting to main cabinet"),Mt("This test has already been completed","info"),r("/student");return}if(xe.test_type===Qr.MATCHING){console.log(" Redirecting to matching test page for testId:",xe.test_id),r(`/student/matching-test/${xe.test_id}`);return}if(xe.test_type===Qr.WORD_MATCHING){console.log(" Redirecting to word matching test page for testId:",xe.test_id),r(`/student/word-matching-test/${xe.test_id}`);return}E(xe),F(xe.test_type);const ht=await Er.getTestInfo(xe.test_type,xe.test_id),Tt=await Er.getTestQuestions(xe.test_type,xe.test_id);P(ht),R(Tt);const gr=l(xe.test_type,xe.test_id);let tr=(gr==null?void 0:gr.answers)||new Array(Tt.length).fill("");Tt.forEach((vt,me)=>{const _e=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${xe.test_type}_${xe.test_id}_${vt.question_id}`,Fe=localStorage.getItem(_e);console.log(` Checking individual answer for question ${vt.question_id}:`,Fe),Fe&&(tr[me]=Fe,console.log(` Loaded individual answer for question ${vt.question_id}:`,Fe))}),console.log(" Initial answers after loading individual saves:",tr),W(tr);const mr=tr.filter(vt=>vt&&typeof vt=="string"&&vt.trim()!=="").length,Je=Tt.length>0?mr/Tt.length*100:0;console.log(" Calculated progress:",mr,"answered out of",Tt.length,"=",Je+"%"),q(Je),ht.time_limit&&K(ht.time_limit*60);const jt=new Date;L(jt),console.log(" Test timer started at:",jt.toISOString()),ge(),console.log(" Anti-cheating tracking started"),y("test"),console.log(" Test started successfully")}catch(De){console.error(" Error starting test:",De),Mt("Failed to start test","error")}finally{h(!1),x(!1)}},[l]),xt=k.useCallback(async()=>{if(!b||!T||!D||!I){Mt("No test data to submit","error");return}console.log(" Submitting test:",b);try{ne(!0);const xe=$t(D,I,b.test_type),De=new Date,Le=U?Math.round((De-U)/1e3):0,pt=U?U.toISOString():De.toISOString();console.log(" Test timing:",{startedAt:pt,endTime:De.toISOString(),timeTaken:`${Le} seconds`});const ht=ye();console.log(" Anti-cheating data for submission:",ht);const Tt=await Er.submitTest(b.test_type,b.test_id,I,{time_taken:Le,started_at:pt,submitted_at:De.toISOString(),caught_cheating:ht.caught_cheating,visibility_change_times:ht.visibility_change_times},n);if(console.log(" Test submission result:",Tt),Tt.success){if(console.log(" Marking test as completed..."),await Oe(b.test_type,b.test_id),b.test_type!=="drawing"){console.log(" Caching test results after submission...");const Je=`student_results_table_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}`,{setCachedData:jt,CACHE_TTL:vt}=await xx(async()=>{const{setCachedData:me,CACHE_TTL:be}=await Promise.resolve().then(()=>D9);return{setCachedData:me,CACHE_TTL:be}},void 0);jt(Je,Tt,vt.student_results_table),console.log(" Test results cached with key:",Je)}else console.log(" Drawing test submitted - not caching results (will appear after teacher grades)");console.log(" Clearing test progress..."),u(b.test_type,b.test_id),console.log(" Clearing test progress and anti-cheating data...");const gr=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown",tr=[];for(let mr=0;mr<localStorage.length;mr++){const Je=localStorage.key(mr);Je&&(Je.startsWith(`test_progress_${gr}_`)||Je.startsWith(`anti_cheating_${gr}_`))&&tr.push(Je)}tr.forEach(mr=>{localStorage.removeItem(mr),console.log(` Cleared: ${mr}`)}),console.log(" Clearing anti-cheating data..."),fe(),Ce(),b.test_type!=="drawing"?y("results"):r("/student"),Mt("Test submitted successfully!","success"),console.log(" Test submitted successfully")}else throw console.error(" Test submission failed:",Tt.error),new Error(Tt.error||"Failed to submit test")}catch(xe){console.error(" Error submitting test:",xe),Mt("Failed to submit test","error")}finally{ne(!1)}},[b,T,D,I,Oe,u]),$t=k.useCallback((xe,De,Le)=>{console.log(" Calculating test score...");let pt=0;return xe.forEach((ht,Tt)=>{const gr=De[Tt],tr=Pe(ht,Le);Ae(ht,gr,tr,Le)&&pt++}),console.log(" Score calculated:",pt,"out of",xe.length),pt},[]),Ae=k.useCallback((xe,De,Le,pt)=>{if(!De||!Le)return!1;switch(pt){case Qr.TRUE_FALSE:return De.toLowerCase()===Le.toLowerCase();case Qr.MULTIPLE_CHOICE:const ht=String.fromCharCode(65+parseInt(De)),Tt=Le.includes("Option ")?Le.replace("Option ",""):Le;return ht===Tt;case Qr.INPUT:return(xe.correct_answers||[]).some(tr=>De.toLowerCase().trim()===tr.toLowerCase().trim());case Qr.MATCHING:return JSON.stringify(De)===JSON.stringify(Le);case Qr.WORD_MATCHING:return JSON.stringify(De)===JSON.stringify(Le);case Qr.DRAWING:return De&&De.trim()!=="";default:return!1}},[]),Pe=k.useCallback((xe,De)=>{console.log(" Getting correct answer for question:",xe,"testType:",De);let Le="";switch(De){case Qr.TRUE_FALSE:Le=xe.correct_answer?"True":"False";break;case Qr.MULTIPLE_CHOICE:const pt=xe.correct_answer.charCodeAt(0)-65,ht=`option_${String.fromCharCode(97+pt)}`;Le=xe[ht]||`Option ${xe.correct_answer}`;break;case Qr.INPUT:xe.correct_answers&&Array.isArray(xe.correct_answers)?Le=xe.correct_answers.join(", "):Le=xe.correct_answer||"Unknown";break;case Qr.MATCHING:Le=xe.correct_answer||xe.answer;break;case Qr.DRAWING:Le="Drawing required";break;default:Le="Unknown"}return console.log(" Correct answer:",Le),Le},[]);k.useCallback(()=>(console.log(" Collecting test answers..."),I),[I]);const Ue=k.useCallback(()=>{if(!D||!I)return;const xe=I.filter(Le=>Le&&typeof Le=="string"&&Le.trim()!=="").length,De=D.length>0?xe/D.length*100:0;if(q(De),console.log(` Progress updated: ${xe}/${D.length} questions answered (${Math.round(De)}%)`),b){const Le={answers:I,progress:De,lastSaved:new Date().toISOString()};o(b.test_type,b.test_id,Le)}},[D,I,b,o]);k.useEffect(()=>{Ue()},[Ue]);const We=k.useCallback(()=>{if(!I)return 0;const xe=I.filter(De=>De&&typeof De=="string"&&De.trim()!=="").length;return console.log(" getAnsweredCount:",{studentAnswers:I,answeredCount:xe,totalQuestions:D==null?void 0:D.length}),xe},[I,D]),Xe=k.useCallback(()=>{console.log(" Navigating back to cabinet..."),t?t():r("/student")},[t,r]);k.useCallback(()=>{console.log(" Showing test results..."),y("results")},[]);const ut=k.useCallback((xe,De)=>{switch(console.log(" Formatting student answer for display:",xe,"testType:",De),De){case Qr.MULTIPLE_CHOICE:const Le=String.fromCharCode(65+parseInt(xe));return console.log(" Converted",xe,"to",Le),Le;case Qr.TRUE_FALSE:return xe==="true"?"True":"False";case Qr.INPUT:return xe;case Qr.MATCHING:return typeof xe=="object"?JSON.stringify(xe):xe;case Qr.WORD_MATCHING:return typeof xe=="object"?JSON.stringify(xe):xe;case Qr.DRAWING:return xe&&xe.trim()!==""?"Drawing submitted":"No drawing";default:return console.warn(" Unknown test type for answer formatting:",De),xe}},[]),Ct=k.useCallback((xe,De,Le)=>(console.log(" Checking answer correctness:",xe,De,Le),Ae(xe,De,Pe(xe,Le),Le)),[Ae,Pe]),Mt=k.useCallback((xe,De)=>{const Le={id:Date.now(),message:xe,type:De,timestamp:new Date};S(pt=>[...pt,Le]),setTimeout(()=>{S(pt=>pt.filter(ht=>ht.id!==Le.id))},cc.NOTIFICATION_DURATION)},[]);k.useEffect(()=>{Ue()},[Ue]),k.useEffect(()=>{if(V>0&&w==="test"){const xe=setInterval(()=>{K(De=>De<=1?(xt(),0):De-1)},1e3);return()=>clearInterval(xe)}},[V,w,xt]);const At=k.useCallback((xe,De)=>{if(!xe)return null;const Le=(pt,ht)=>{const Tt=[...I];Tt[De]=ht,W(Tt),console.log(` Answer changed: question ${pt} = ${ht}`),console.log(" Updated studentAnswers:",Tt)};switch(b.test_type){case Qr.TRUE_FALSE:return c.jsx(Ite,{question:xe,questionIndex:De,studentAnswer:I[De]||"",onAnswerChange:Le,mode:"student",testId:b==null?void 0:b.test_id,testType:N});case Qr.MULTIPLE_CHOICE:return c.jsx(Bte,{question:xe,questionIndex:De,studentAnswer:I[De]||"",onAnswerChange:Le,mode:"student",testId:b==null?void 0:b.test_id,testType:N});case Qr.INPUT:return c.jsx(Ute,{question:xe,questionIndex:De,studentAnswer:I[De]||"",onAnswerChange:Le,mode:"student",testId:b==null?void 0:b.test_id,testType:N});case Qr.MATCHING:return console.error("Matching test reached renderQuestion - this should not happen"),c.jsxs("div",{className:"text-center p-8",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),c.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),c.jsx(Ge,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case Qr.DRAWING:return c.jsx(Kte,{question:xe,questionIndex:De,studentAnswer:I[De]||"",onAnswerChange:Le,mode:"student",testId:b==null?void 0:b.test_id,testType:N});default:return c.jsx("div",{children:"Unsupported question type"})}},[b,I,N]);function Pt(){return!b||!T||!D?null:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:T.test_name||T.title||"Test"}),V>0&&c.jsxs("div",{className:"text-lg font-semibold text-blue-600",children:["Time: ",Math.floor(V/60),":",(V%60).toString().padStart(2,"0")]})]}),c.jsx("div",{className:"mb-4",children:c.jsx(Yte,{answeredCount:We(),totalQuestions:D.length,percentage:Math.round(le),showDetails:!0})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Answer all questions below:"}),c.jsx("div",{className:"space-y-8",children:D.map((xe,De)=>c.jsx("div",{className:"question-container",children:At(xe,De)},xe.question_id||De))})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx(Ge,{variant:"primary",size:"lg",onClick:xt,disabled:Z||We()<D.length,loading:Z,children:Z?"Submitting...":`Submit Test (${We()}/${D.length})`})})]})}if(d)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(dr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:e?"Starting Test...":"Loading Student Tests..."})]})});if(p)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:p}),c.jsx(Ge,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Tests"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",de?de.toLocaleString():"Never"]})]}),c.jsx(Ge,{variant:"outline",onClick:Xe,children:"Back to Cabinet"})]})})}),re&&w==="results"&&c.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsxs("p",{className:"text-sm text-red-700",children:[c.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",ve," times during the test."]})})]})}),c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[!e&&w==="list"&&it(),w==="test"&&Pt(),w==="results"&&rt()]}),c.jsx(aO,{isOpen:z,onClose:()=>Y(!1),testType:J==null?void 0:J.test_type,testId:J==null?void 0:J.test_id,testName:J==null?void 0:J.test_name,questions:J==null?void 0:J.questions,isLoading:d}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:_.map(xe=>c.jsx(_o,{type:xe.type,message:xe.message,onClose:()=>S(De=>De.filter(Le=>Le.id!==xe.id))},xe.id))})]});function it(){return!a||a.length===0?c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No active tests available for your class."})}):c.jsx("div",{className:"space-y-6",children:a.map((xe,De)=>c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:xe.test_name}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Subject:"})," ",xe.subject]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Teacher:"})," ",xe.teacher_name]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Type:"})," ",xe.test_type]})]}),c.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Assigned: ",new Date(xe.assigned_at).toLocaleDateString()]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx(Ge,{variant:"outline",onClick:()=>Ze(xe),disabled:m||d,children:"View Details"}),c.jsx(Ge,{variant:"primary",onClick:()=>Re(xe),disabled:m||d,children:m?"Starting...":"Start Test"})]})]})},De))})}function rt(){if(!b||!T||!D||!I)return null;const xe={};return I.forEach((De,Le)=>{D[Le]&&(xe[D[Le].question_id||D[Le].id||Le]=De)}),c.jsx(pre,{testInfo:T,questions:D,testType:b.test_type,studentAnswers:xe,onBackToCabinet:Xe,calculateTestScore:$t,checkAnswerCorrectness:Ct,formatStudentAnswerForDisplay:ut,getCorrectAnswer:Pe})}},yre=()=>{const{testId:t}=Mk(),e=Ua(),{user:r}=Dn(),{makeAuthenticatedRequest:n}=fl(),{showNotification:s}=ka(),[a,i]=k.useState(null),[o,l]=k.useState(!0),[u,d]=k.useState(null),[h,m]=k.useState(null),[x,p]=k.useState(!1);_v("matching_type",a==null?void 0:a.id);const v=k.useCallback(()=>{if(!(r!=null&&r.student_id)||!t)return!1;const b=`test_completed_${r.student_id}_matching_type_${t}`;return localStorage.getItem(b)==="true"?(console.log(" Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),e("/student"),!0):!1},[r==null?void 0:r.student_id,t,e,s]),_=k.useCallback(async()=>{if(!t){d("Test ID is required"),l(!1);return}if(!v())try{l(!0),d(null);const b=await n(`/.netlify/functions/get-matching-type-test?test_id=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!b.ok)throw new Error("Failed to load test data");const E=await b.json();if(!E.success)throw new Error(E.message||"Failed to load test");const N=E.data;console.log(" Test data from get-matching-type-test:",N);const F=await n(`/.netlify/functions/get-test-questions?test_id=${t}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!F.ok)throw new Error("Failed to load test questions");const T=await F.json();if(!T.success)throw new Error(T.message||"Failed to load test questions");console.log(" Questions data from get-test-questions:",T);const P={id:N.test_id,test_name:N.test_name,teacher_id:N.teacher_id,subject_id:N.subject_id,image_url:N.image_url,image:null,blocks:(()=>{if(Array.isArray(T.questions)&&T.questions.length>0){const D=T.questions[0];return Array.isArray(D.blocks)?D.blocks.map((R,I)=>{let W=R.block_coordinates||R.coordinates||(typeof R.x=="number"?{x:R.x,y:R.y,width:R.width,height:R.height}:null);if(typeof W=="string")try{W=JSON.parse(W)}catch{W=null}return(!W||typeof W!="object")&&(W={x:0,y:0,width:30,height:10}),W={x:(typeof W.x=="number"?W.x:Number(W.x))||0,y:(typeof W.y=="number"?W.y:Number(W.y))||0,width:(typeof W.width=="number"?W.width:Number(W.width))||30,height:(typeof W.height=="number"?W.height:Number(W.height))||10},{id:R.block_id||R.question_id||R.id||I+1,word:R.word||`Word ${I+1}`,coordinates:W,hasArrow:!!R.has_arrow,arrow:R.arrow||null}}):T.questions.map(R=>{console.log(" Processing question:",R);let I;try{I=typeof R.block_coordinates=="string"?JSON.parse(R.block_coordinates):R.block_coordinates}catch{I={x:0,y:0,width:100,height:100}}return(!I||typeof I!="object")&&(I={x:0,y:0,width:100,height:100}),I={x:(typeof I.x=="number"?I.x:Number(I.x))||0,y:(typeof I.y=="number"?I.y:Number(I.y))||0,width:(typeof I.width=="number"?I.width:Number(I.width))||100,height:(typeof I.height=="number"?I.height:Number(I.height))||100},{id:R.question_id,word:R.word,coordinates:I,hasArrow:R.has_arrow,arrow:R.arrow}})}return[]})(),words:(()=>{if(Array.isArray(T.questions)&&T.questions.length>0){const D=T.questions[0];if(Array.isArray(D.words)){const R=D.words,I=Array.isArray(D.blocks)?D.blocks:[];return typeof R[0]=="string"?R.map((le,q)=>{var K,U,L;return{id:`w_${((K=I[q])==null?void 0:K.question_id)||((U=I[q])==null?void 0:U.block_id)||((L=T.questions[q])==null?void 0:L.question_id)||q+1}_${q}`,word:String(le),blockId:null,isPlaced:!1,isCorrect:!1}}):R.map((le,q)=>({id:`w_${le.question_id||le.id||q+1}_${q}`,word:le.word||String(le.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return T.questions.map(R=>({id:`w_${R.question_id}`,word:R.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:N.arrows?N.arrows.map(D=>(console.log(" Processing arrow:",D),{id:D.id,questionId:D.question_id,blockId:D.block_id||D.question_id,start:{x:Number(D.start_x)||0,y:Number(D.start_y)||0},end:{x:Number(D.end_x)||0,y:Number(D.end_y)||0},rel_start_x:D.rel_start_x!==null?Number(D.rel_start_x):null,rel_start_y:D.rel_start_y!==null?Number(D.rel_start_y):null,rel_end_x:D.rel_end_x!==null?Number(D.rel_end_x):null,rel_end_y:D.rel_end_y!==null?Number(D.rel_end_y):null,image_width:D.image_width?Number(D.image_width):null,image_height:D.image_height?Number(D.image_height):null,style:(typeof D.style=="string"?JSON.parse(D.style):D.style)||{color:"#dc3545",thickness:3}})):[]};if(N.image_url){const D=new Image;D.crossOrigin="anonymous",D.onload=()=>{P.image=D,i(P),l(!1)},D.onerror=()=>{console.warn("Failed to load test image"),i(P),l(!1)},D.src=N.image_url}else i(P),l(!1)}catch(b){console.error("Error loading test data:",b),d(b.message||"Failed to load test"),l(!1)}},[t,n]);k.useEffect(()=>{r!=null&&r.student_id&&_()},[_,r==null?void 0:r.student_id]);const S=k.useCallback(async b=>{var P;console.log("Test completed:",b),s("Test completed successfully!","success");const E=parseInt(b)||0,N=(a==null?void 0:a.num_questions)||0,F=N>0?Math.round(E/N*100):0,T={showResults:!0,testInfo:{test_name:(a==null?void 0:a.test_name)||"Test",id:a==null?void 0:a.id,test_id:a==null?void 0:a.id},testType:"matching_type",score:E,totalQuestions:N,percentage:F,passed:F>=60,questionAnalysis:((P=a==null?void 0:a.questions)==null?void 0:P.map((D,R)=>({questionNumber:R+1,isCorrect:R<E,userAnswer:R<E?`Matched: ${D.word}`:"Not answered",correctAnswer:`Match: ${D.word}`})))||Array.from({length:N},(D,R)=>({questionNumber:R+1,isCorrect:R<E,userAnswer:R<E?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log(" Using test results data:",T),m(T),p(!0)},[a,s]),w=k.useCallback(()=>{e("/student")},[e]),y=k.useCallback(()=>{p(!1),m(null),_()},[_]);return o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(at,{className:"max-w-md w-full",children:c.jsxs(at.Body,{className:"text-center",children:[c.jsx(dr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):u?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(at,{className:"max-w-md w-full",children:c.jsxs(at.Body,{className:"text-center",children:[c.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),c.jsx("p",{className:"text-gray-600 mb-4",children:u}),c.jsx("button",{onClick:w,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):a?x&&h?c.jsx("div",{className:"bg-gray-50",children:c.jsx(jT,{testResults:h,onBackToCabinet:w,onRetakeTest:y,isLoading:!1})}):c.jsx($te,{testData:a,onTestComplete:S,onBackToCabinet:w}):c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(at,{className:"max-w-md w-full",children:c.jsxs(at.Body,{className:"text-center",children:[c.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),c.jsx("button",{onClick:w,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},vre=()=>{const{testId:t}=Mk(),e=Ua(),{user:r}=Dn(),{makeAuthenticatedRequest:n}=fl(),{showNotification:s}=ka(),[a,i]=k.useState(null),[o,l]=k.useState(!0),[u,d]=k.useState(null),[h,m]=k.useState(null),[x,p]=k.useState(!1),v=k.useCallback(()=>{if(!(r!=null&&r.student_id)||!t)return!1;const y=`test_completed_${r.student_id}_word_matching_${t}`;return localStorage.getItem(y)==="true"},[r==null?void 0:r.student_id,t]),_=k.useCallback(async()=>{if(!t){d("Test ID is required"),l(!1);return}if(v()){s("This test has already been completed","warning"),e("/student");return}l(!0),d(null);try{const y=`word_matching_test_${t}`,b=wn(y);if(b){if(console.log(" Word matching test loaded from cache:",b),b.id)i(b);else{const F={id:b.test_id,test_id:b.test_id,test_name:b.test_name,teacher_id:b.teacher_id,subject_id:b.subject_id,num_questions:b.num_questions,interaction_type:b.interaction_type,passing_score:b.passing_score,created_at:b.created_at,updated_at:b.updated_at,leftWords:b.leftWords,rightWords:b.rightWords,correctPairs:b.correctPairs,originalPairs:b.originalPairs};i(F)}l(!1);return}const N=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${t}`)).json();if(N.success){const F={id:N.data.test_id,test_id:N.data.test_id,test_name:N.data.test_name,teacher_id:N.data.teacher_id,subject_id:N.data.subject_id,num_questions:N.data.num_questions,interaction_type:N.data.interaction_type,passing_score:N.data.passing_score,created_at:N.data.created_at,updated_at:N.data.updated_at,leftWords:N.data.leftWords,rightWords:N.data.rightWords,correctPairs:N.data.correctPairs,originalPairs:N.data.originalPairs};i(F),Zr(y,F,on.word_matching_test),console.log(" Word matching test loaded from API and cached:",F)}else throw new Error(N.message||"Failed to load test")}catch(y){console.error("Error loading word matching test:",y),d(y.message),s("Failed to load test: "+y.message,"error")}finally{l(!1)}},[t,v,n,s,e]),S=k.useCallback(async y=>{console.log("Test completed:",y),s("Test completed successfully!","success");const b=parseInt(y)||0,E=(a==null?void 0:a.num_questions)||0,N=E>0?Math.round(b/E*100):0,F={showResults:!0,testInfo:{test_name:(a==null?void 0:a.test_name)||"Test",id:a==null?void 0:a.id,test_id:a==null?void 0:a.id},testType:"word_matching",score:b,totalQuestions:E,percentage:N,passed:N>=60,questionAnalysis:Array.isArray(a==null?void 0:a.correctPairs)?a.correctPairs.map((T,P)=>({questionNumber:P+1,isCorrect:P<b,userAnswer:P<b?`${T.left}  ${T.right}`:"Not answered",correctAnswer:`${T.left}  ${T.right}`})):Array.from({length:E},(T,P)=>({questionNumber:P+1,isCorrect:P<b,userAnswer:P<b?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log(" Using test results data:",F),m(F),p(!0)},[a,s]),w=k.useCallback(()=>{e("/student")},[e]);return k.useEffect(()=>{_()},[_]),o?c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsxs(at,{className:"p-8 text-center",children:[c.jsx(dr,{size:"lg",className:"mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):u?c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(at,{className:"p-8 text-center",children:c.jsxs("div",{className:"text-red-600 mb-4",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),c.jsx("p",{className:"text-gray-600 mb-4",children:u}),c.jsx("button",{onClick:()=>e("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):a?x&&h?c.jsx("div",{className:"bg-gray-50",children:c.jsx(jT,{testResults:h,onBackToCabinet:()=>{m(null),p(!1),e("/student")},onRetakeTest:(y,b)=>{const N=`test_completed_${(r==null?void 0:r.student_id)||(r==null?void 0:r.id)||""}_${y}_${b}`;localStorage.removeItem(N),m(null),p(!1),_()},isLoading:!1})}):c.jsx(Me.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gray-50 py-8",children:c.jsx(Vte,{testData:a,onTestComplete:S,onBackToCabinet:w})}):c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(at,{className:"p-8 text-center",children:c.jsxs("div",{className:"text-gray-600 mb-4",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),c.jsx("button",{onClick:()=>e("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},wre=()=>{const{testType:t,testId:e}=Mk(),r=Ua(),n=()=>{r("/student")};return c.jsx(xre,{onBackToCabinet:n,currentTest:{test_type:t,test_id:parseInt(e)}})},_re=()=>{const t=Ua(),{user:e,isAuthenticated:r,isLoading:n}=Dn(),[s,a]=k.useState(!1),[i,o]=k.useState(!0),[l,u]=k.useState(""),[d,h]=k.useState([]),[m,x]=k.useState(!1),[p,v]=k.useState(!1),[_,S]=k.useState({currentPassword:"",newPassword:"",confirmPassword:""}),w=k.useCallback(async()=>{console.log(" Initializing Student Application...");try{if(o(!0),u(""),!r||!e){console.log(" User not authenticated, redirecting to login"),t("/login");return}if(e.role!==Zs.STUDENT){console.error(" Invalid user role for student app:",e.role),u("Access denied. Student role required.");return}console.log(" Initializing event listeners..."),y(),console.log(" Setting up back to cabinet button listeners..."),b(),console.log(" Setting up password change form listener..."),E(),console.log(" Loading student data..."),await N(),console.log(" Exposing student functions globally..."),F(),console.log(" Populating student info from user data..."),W(e),a(!0),console.log(" Student Application initialization complete!")}catch(V){console.error(" Error initializing student app:",V),u("Failed to initialize student application")}finally{o(!1)}},[r,e,t]);k.useEffect(()=>{n||w()},[n,r,e,w]);const y=k.useCallback(()=>{console.log(" Setting up student event listeners...");const V=U=>{m&&!U.target.closest(".student-menu")&&x(!1)},K=U=>{U.key==="Escape"&&m&&x(!1)};return document.addEventListener("click",V),document.addEventListener("keydown",K),()=>{document.removeEventListener("click",V),document.removeEventListener("keydown",K)}},[m]),b=k.useCallback(()=>{console.log(" Setting up back to cabinet listeners...")},[]),E=k.useCallback(()=>{console.log(" Setting up password change form...")},[]),N=k.useCallback(async()=>{console.log(" Loading student data...");try{console.log(" Student data loaded successfully")}catch(V){throw console.error(" Error loading student data:",V),V}},[]),F=k.useCallback(()=>{console.log(" Exposing student functions globally..."),window.toggleStudentMenu=T,window.showChangePasswordTab=P,window.hideChangePasswordTab=D,window.navigateBackToCabinet=I,window.handlePasswordChange=R,window.populateStudentInfoDirectly=W,console.log(" All student functions exposed globally")},[]),T=k.useCallback(()=>{console.log(" toggleStudentMenu called"),x(V=>{const K=!V;return console.log(" Menu state changed from",V,"to",K),K}),console.log(" Toggled dropdown menu")},[]),P=k.useCallback(()=>{console.log(" showChangePasswordTab called"),v(!0),x(!1)},[]),D=k.useCallback(()=>{console.log(" hideChangePasswordTab called"),v(!1),S({currentPassword:"",newPassword:"",confirmPassword:""})},[]),R=k.useCallback(async V=>{V.preventDefault(),console.log(" handlePasswordChange called");const{currentPassword:K,newPassword:U,confirmPassword:L}=_;if(!K||!U||!L){le("Please fill in all fields","error");return}if(U!==L){le("New passwords do not match","error");return}if(U.length<3){le("New password must be at least 3 characters long","error");return}if(!e||!e.student_id){le("Session expired. Please login again.","error");return}const Z=e.student_id;if(window.confirm("Are you sure you want to change your password?"))try{o(!0);const ne=await Br.changePassword({studentId:Z,currentPassword:K,newPassword:U});ne.success?(le("Password changed successfully!","success"),D()):le(ne.message||"Failed to change password","error")}catch(ne){console.error("Password change error:",ne),le("Failed to change password. Please try again.","error")}finally{o(!1)}},[_,e]),I=k.useCallback(()=>{if(console.log("[DEBUG] navigateBackToCabinet called"),!r||!e){console.warn("[WARN] No valid user found, redirecting to login"),t("/login");return}e.role===Zs.STUDENT?(console.log("[DEBUG] Navigating to student cabinet"),t("/student")):(console.warn("[WARN] Unknown user role, redirecting to login"),t("/login"))},[r,e,t]),W=k.useCallback(V=>{console.log(" populateStudentInfoDirectly called with:",V);try{console.log(" Student info populated successfully")}catch(K){console.error(" Error populating student info:",K)}},[]),le=k.useCallback((V,K)=>{const U={id:Date.now(),message:V,type:K,timestamp:new Date};h(L=>[...L,U]),setTimeout(()=>{h(L=>L.filter(Z=>Z.id!==U.id))},cc.NOTIFICATION_DURATION)},[]),q=k.useCallback(V=>{const{name:K,value:U}=V.target;S(L=>({...L,[K]:U}))},[]);return i?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(dr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):l?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:l}),c.jsx(Ge,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?c.jsxs("div",{className:"bg-gray-50",children:[c.jsxs(Lk,{children:[c.jsx(Fn,{path:"/",element:c.jsxs("div",{className:"student-app",children:[c.jsx(mre,{isMenuOpen:m,onToggleMenu:T,onShowPasswordChange:P}),p&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),c.jsxs("form",{onSubmit:R,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),c.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:_.currentPassword,onChange:q,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),c.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:_.newPassword,onChange:q,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),c.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:_.confirmPassword,onChange:q,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{className:"flex space-x-3 pt-4",children:[c.jsx(Ge,{type:"button",variant:"secondary",onClick:D,className:"flex-1",children:"Cancel"}),c.jsx(Ge,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?c.jsxs(c.Fragment,{children:[c.jsx(dr,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),c.jsx(Fn,{path:"/test/:testType/:testId",element:c.jsx(wre,{})}),c.jsx(Fn,{path:"matching-test/:testId",element:c.jsx(yre,{})}),c.jsx(Fn,{path:"word-matching-test/:testId",element:c.jsx(vre,{})}),c.jsx(Fn,{path:"/results",element:c.jsx(uO,{})})]}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(V=>c.jsx(_o,{type:V.type,message:V.message,onClose:()=>h(K=>K.filter(U=>U.id!==V.id))},V.id))})]}):c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(dr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},Sre=()=>c.jsx(O9,{children:c.jsx(I9,{children:c.jsx(U9,{children:c.jsx(_re,{})})})});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var E1={};E1.version="0.18.5";var dO=1252,bre=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],PT={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},DT=function(t){bre.indexOf(t)!=-1&&(dO=PT[0]=t)};function kre(){DT(1252)}var Oi=function(t){DT(t)};function RT(){Oi(1200),kre()}function YA(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Cre(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function fO(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var n0=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Cre(t.slice(2)):e==254&&r==255?fO(t.slice(2)):e==65279?t.slice(1):t},Vp=function(e){return String.fromCharCode(e)},JA=function(e){return String.fromCharCode(e)},pg,Wl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xg(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),a=r>>2,n=t.charCodeAt(u++),i=(r&3)<<4|n>>4,s=t.charCodeAt(u++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Wl.charAt(a)+Wl.charAt(i)+Wl.charAt(o)+Wl.charAt(l);return e}function La(t){var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)a=Wl.indexOf(t.charAt(u++)),i=Wl.indexOf(t.charAt(u++)),r=a<<2|i>>4,e+=String.fromCharCode(r),o=Wl.indexOf(t.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Wl.indexOf(t.charAt(u++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var ir=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),yl=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function uc(t){return ir?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function QA(t){return ir?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ja=function(e){return ir?yl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Sv(t){if(typeof ArrayBuffer>"u")return ja(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Ac(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Tre(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function OT(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return OT(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var fs=ir?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:yl(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Ere(t){for(var e=[],r=0,n=t.length+250,s=uc(t.length+255),a=0;a<t.length;++a){var i=t.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=t.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(e.push(s.slice(0,r)),r=0,s=uc(65535),n=65530)}return e.push(s.slice(0,r)),fs(e)}var sa=/\u0000/g,s0=/[\u0001-\u0006]/g;function pf(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Mi(t,e){var r=""+t;return r.length>=e?r:vn("0",e-r.length)+r}function MT(t,e){var r=""+t;return r.length>=e?r:vn(" ",e-r.length)+r}function N1(t,e){var r=""+t;return r.length>=e?r:r+vn(" ",e-r.length)}function Nre(t,e){var r=""+Math.round(t);return r.length>=e?r:vn("0",e-r.length)+r}function Are(t,e){var r=""+t;return r.length>=e?r:vn("0",e-r.length)+r}var qA=Math.pow(2,32);function Nd(t,e){if(t>qA||t<-qA)return Nre(t,e);var r=Math.round(t);return Are(r,e)}function A1(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var ZA=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],s_=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Fre(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Bt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},e8={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},jre={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function F1(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,i=1,o=0,l=1,u=0,d=0,h=Math.floor(s);u<e&&(h=Math.floor(s),o=h*i+a,d=h*u+l,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,l=u,u=d;if(d>e&&(u>e?(d=l,o=a):(d=u,o=i)),!r)return[0,n*o,d];var m=Math.floor(n*o/d);return[m,n*o-m*d,d]}function au(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,i=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=Lre(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var hO=new Date(1899,11,31,0,0,0),Pre=hO.getTime(),Dre=new Date(1900,2,1,0,0,0);function gO(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Dre&&(r+=24*60*60*1e3),(r-(Pre+(t.getTimezoneOffset()-hO.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function LT(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Rre(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Ore(t){var e=t<0?12:11,r=LT(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Mre(t){var e=LT(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function yg(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Ore(t):e===10?r=t.toFixed(10).substr(0,12):r=Mre(t),LT(Rre(r.toUpperCase()))}function Mu(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):yg(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return yi(14,gO(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Lre(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function Ire(t,e,r,n){var s="",a=0,i=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return s_[r.m-1][1];case 5:return s_[r.m-1][0];default:return s_[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return ZA[r.q][0];default:return ZA[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Mi(r.S,e.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),e==="s"?a===0?"0":""+a/i:(s=Mi(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var d=u>0?Mi(l,u):"";return d}function Vl(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var mO=/%/g;function Bre(t,e,r){var n=e.replace(mO,""),s=e.length-n.length;return Zo(t,n,r*Math.pow(10,2*s))+vn("%",s)}function Ure(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Zo(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function pO(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+pO(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var xO=/# (\?+)( ?)\/( ?)(\d+)/;function $re(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?vn(" ",t[1].length+1+t[4].length):MT(i,t[1].length)+t[2]+"/"+t[3]+Mi(o,t[4].length))}function zre(t,e,r){return r+(e===0?"":""+e)+vn(" ",t[1].length+2+t[4].length)}var yO=/^#*0*\.([0#]+)/,vO=/\).*[0#]/,wO=/\(###\) ###\\?-####/;function Qs(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function t8(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function r8(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Wre(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Vre(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Za(t,e,r){if(t.charCodeAt(0)===40&&!e.match(vO)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Za("n",n,r):"("+Za("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Ure(t,e,r);if(e.indexOf("%")!==-1)return Bre(t,e,r);if(e.indexOf("E")!==-1)return pO(e,r);if(e.charCodeAt(0)===36)return"$"+Za(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Nd(l,e.length);if(e.match(/^[#?]+$/))return s=Nd(r,0),s==="0"&&(s=""),s.length>e.length?s:Qs(e.substr(0,e.length-s.length))+s;if(a=e.match(xO))return $re(a,l,u);if(e.match(/^#+0+$/))return u+Nd(l,e.length-e.indexOf("0"));if(a=e.match(yO))return s=t8(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Qs(a[1])).replace(/\.$/,"."+Qs(a[1])).replace(/\.(\d*)$/,function(p,v){return"."+v+vn("0",Qs(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return u+t8(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return u+Vl(Nd(l,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Za(t,e,-r):Vl(""+(Math.floor(r)+Wre(r,a[1].length)))+"."+Mi(r8(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return Za(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=pf(Za(t,e.replace(/[\\-]/g,""),r)),i=0,pf(pf(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<s.length?s.charAt(i++):p==="0"?"0":""}));if(e.match(wO))return s=Za(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=F1(l,Math.pow(10,i)-1,!1),s=""+u,d=Zo("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=N1(o[2],i),d.length<a[4].length&&(d=Qs(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=F1(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?MT(o[1],i)+a[2]+"/"+a[3]+N1(o[2],i):vn(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=Nd(r,0),e.length<=s.length?s:Qs(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=e.indexOf(".")-i,m=e.length-s.length-h;return Qs(e.substr(0,h)+s+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return i=r8(r,a[1].length),r<0?"-"+Za(t,e,-r):Vl(Vre(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Mi(0,3-p.length):"")+p})+"."+Mi(i,a[1].length);switch(e){case"###,##0.00":return Za(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=Vl(Nd(l,0));return x!=="0"?u+x:"";case"###,###.00":return Za(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Za(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Gre(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Zo(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Hre(t,e,r){var n=e.replace(mO,""),s=e.length-n.length;return Zo(t,n,r*Math.pow(10,2*s))+vn("%",s)}function _O(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+_O(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function no(t,e,r){if(t.charCodeAt(0)===40&&!e.match(vO)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?no("n",n,r):"("+no("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Gre(t,e,r);if(e.indexOf("%")!==-1)return Hre(t,e,r);if(e.indexOf("E")!==-1)return _O(e,r);if(e.charCodeAt(0)===36)return"$"+no(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Mi(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Qs(e.substr(0,e.length-s.length))+s;if(a=e.match(xO))return zre(a,l,u);if(e.match(/^#+0+$/))return u+Mi(l,e.length-e.indexOf("0"));if(a=e.match(yO))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Qs(a[1])).replace(/\.$/,"."+Qs(a[1])),s=s.replace(/\.(\d*)$/,function(p,v){return"."+v+vn("0",Qs(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return u+Vl(""+l);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+no(t,e,-r):Vl(""+r)+"."+vn("0",a[1].length);if(a=e.match(/^#,#*,#0/))return no(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=pf(no(t,e.replace(/[\\-]/g,""),r)),i=0,pf(pf(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<s.length?s.charAt(i++):p==="0"?"0":""}));if(e.match(wO))return s=no(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=F1(l,Math.pow(10,i)-1,!1),s=""+u,d=Zo("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=N1(o[2],i),d.length<a[4].length&&(d=Qs(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=F1(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?MT(o[1],i)+a[2]+"/"+a[3]+N1(o[2],i):vn(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Qs(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=e.indexOf(".")-i,m=e.length-s.length-h;return Qs(e.substr(0,h)+s+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+no(t,e,-r):Vl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Mi(0,3-p.length):"")+p})+"."+Mi(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var x=Vl(""+l);return x!=="0"?u+x:"";default:if(e.match(/\.[0#?]*$/))return no(t,e.slice(0,e.lastIndexOf(".")),r)+Qs(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Zo(t,e,r){return(r|0)===r?no(t,e,r):Za(t,e,r)}function Kre(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var SO=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function uh(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":A1(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(SO))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Xre(t,e,r,n){for(var s=[],a="",i=0,o="",l="t",u,d,h,m="H";i<t.length;)switch(o=t.charAt(i)){case"G":if(!A1(t,i))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=t.charCodeAt(++i))!==34&&i<t.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var x=t.charAt(++i),p=x==="("||x===")"?x:"t";s[s.length]={t:p,v:x},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:e},++i;break;case"B":case"b":if(t.charAt(i+1)==="1"||t.charAt(i+1)==="2"){if(u==null&&(u=au(e,r,t.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:t.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=au(e,r),u==null))return"";for(a=o;++i<t.length&&t.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(u==null&&(u=au(e,r)),t.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",m="h",i+=3):t.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",i+=5,m="h"):t.substr(i,5).toUpperCase()==="/"?(u!=null&&(v.v=u.H>=12?"":""),v.t="T",i+=5,m="h"):(v.t="t",++i),u==null&&v.t==="T")return"";s[s.length]=v,l=o;break;case"[":for(a=o;t.charAt(i++)!=="]"&&i<t.length;)a+=t.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(SO)){if(u==null&&(u=au(e,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",uh(t)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<t.length&&(o=t.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(t.charAt(i)==" "||t.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<t.length&&"0123456789".indexOf(t.charAt(++i))>-1;)a+=t.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++i;break}var _=0,S=0,w;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=m,l="h",_<1&&(_=1);break;case"s":(w=s[i].v.match(/\.0+$/))&&(S=Math.max(S,w[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&s[i].v.match(/[Hh]/)&&(_=1),_<2&&s[i].v.match(/[Mm]/)&&(_=2),_<3&&s[i].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",b;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=Ire(s[i].t.charCodeAt(0),s[i].v,u,S),s[i].t="t";break;case"n":case"?":for(b=i+1;s[b]!=null&&((o=s[b].t)==="?"||o==="D"||(o===" "||o==="t")&&s[b+1]!=null&&(s[b+1].t==="?"||s[b+1].t==="t"&&s[b+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[b].v==="/"||s[b].v===" "&&s[b+1]!=null&&s[b+1].t=="?"));)s[i].v+=s[b].v,s[b]={v:"",t:";"},++b;y+=s[i].v,i=b-1;break;case"G":s[i].t="t",s[i].v=Mu(e,r);break}var E="",N,F;if(y.length>0){y.charCodeAt(0)==40?(N=e<0&&y.charCodeAt(0)===45?-e:e,F=Zo("n",y,N)):(N=e<0&&n>1?-e:e,F=Zo("n",y,N),N<0&&s[0]&&s[0].t=="t"&&(F=F.substr(1),s[0].v="-"+s[0].v)),b=F.length-1;var T=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){T=i;break}var P=s.length;if(T===s.length&&F.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(b>=s[i].v.length-1?(b-=s[i].v.length,s[i].v=F.substr(b+1,s[i].v.length)):b<0?s[i].v="":(s[i].v=F.substr(0,b+1),b=-1),s[i].t="t",P=i);b>=0&&P<s.length&&(s[P].v=F.substr(0,b+1)+s[P].v)}else if(T!==s.length&&F.indexOf("E")===-1){for(b=F.indexOf(".")-1,i=T;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")-1:s[i].v.length-1,E=s[i].v.substr(d+1);d>=0;--d)b>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(E=F.charAt(b--)+E);s[i].v=E,s[i].t="t",P=i}for(b>=0&&P<s.length&&(s[P].v=F.substr(0,b+1)+s[P].v),b=F.indexOf(".")+1,i=T;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==T)){for(d=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")+1:0,E=s[i].v.substr(0,d);d<s[i].v.length;++d)b<F.length&&(E+=F.charAt(b++));s[i].v=E,s[i].t="t",P=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(N=n>1&&e<0&&i>0&&s[i-1].v==="-"?-e:e,s[i].v=Zo(s[i].t,s[i].v,N),s[i].t="t");var D="";for(i=0;i!==s.length;++i)s[i]!=null&&(D+=s[i].v);return D}var n8=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function s8(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function Yre(t,e){var r=Kre(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(n8),o=r[1].match(n8);return s8(e,i)?[n,r[0]]:s8(e,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function yi(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Bt)[t],n==null&&(n=r.table&&r.table[e8[t]]||Bt[e8[t]]),n==null&&(n=jre[t]||"General");break}if(A1(n,0))return Mu(e,r);e instanceof Date&&(e=gO(e,r.date1904));var s=Yre(n,e);if(A1(s[1]))return Mu(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Xre(s[1],e,r,s[0])}function el(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Bt[r]==null){e<0&&(e=r);continue}if(Bt[r]==t){e=r;break}}e<0&&(e=391)}return Bt[e]=t,e}function bv(t){for(var e=0;e!=392;++e)t[e]!==void 0&&el(t[e],e)}function dh(){Bt=Fre()}var Jre={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},bO=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Qre(t){var e=typeof t=="number"?Bt[t]:t;return e=e.replace(bO,"(\\d+)"),new RegExp("^"+e+"$")}function qre(t,e,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(e.match(bO)||[]).forEach(function(h,m){var x=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=x;break;case"d":a=x;break;case"h":i=x;break;case"s":l=x;break;case"m":i>=0?o=x:s=x;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var Zre=function(){var t={};t.version="1.2.0";function e(){for(var F=0,T=new Array(256),P=0;P!=256;++P)F=P,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,T[P]=F;return typeof Int32Array<"u"?new Int32Array(T):T}var r=e();function n(F){var T=0,P=0,D=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)R[D]=F[D];for(D=0;D!=256;++D)for(P=F[D],T=256+D;T<4096;T+=256)P=R[T]=P>>>8^F[P&255];var I=[];for(D=1;D!=16;++D)I[D-1]=typeof Int32Array<"u"?R.subarray(D*256,D*256+256):R.slice(D*256,D*256+256);return I}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],u=s[4],d=s[5],h=s[6],m=s[7],x=s[8],p=s[9],v=s[10],_=s[11],S=s[12],w=s[13],y=s[14];function b(F,T){for(var P=T^-1,D=0,R=F.length;D<R;)P=P>>>8^r[(P^F.charCodeAt(D++))&255];return~P}function E(F,T){for(var P=T^-1,D=F.length-15,R=0;R<D;)P=y[F[R++]^P&255]^w[F[R++]^P>>8&255]^S[F[R++]^P>>16&255]^_[F[R++]^P>>>24]^v[F[R++]]^p[F[R++]]^x[F[R++]]^m[F[R++]]^h[F[R++]]^d[F[R++]]^u[F[R++]]^l[F[R++]]^o[F[R++]]^i[F[R++]]^a[F[R++]]^r[F[R++]];for(D+=15;R<D;)P=P>>>8^r[(P^F[R++])&255];return~P}function N(F,T){for(var P=T^-1,D=0,R=F.length,I=0,W=0;D<R;)I=F.charCodeAt(D++),I<128?P=P>>>8^r[(P^I)&255]:I<2048?(P=P>>>8^r[(P^(192|I>>6&31))&255],P=P>>>8^r[(P^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,W=F.charCodeAt(D++)&1023,P=P>>>8^r[(P^(240|I>>8&7))&255],P=P>>>8^r[(P^(128|I>>2&63))&255],P=P>>>8^r[(P^(128|W>>6&15|(I&3)<<4))&255],P=P>>>8^r[(P^(128|W&63))&255]):(P=P>>>8^r[(P^(224|I>>12&15))&255],P=P>>>8^r[(P^(128|I>>6&63))&255],P=P>>>8^r[(P^(128|I&63))&255]);return~P}return t.table=r,t.bstr=b,t.buf=E,t.str=N,t}(),Dt=function(){var e={};e.version="1.2.1";function r(G,ce){for(var se=G.split("/"),B=ce.split("/"),X=0,H=0,he=Math.min(se.length,B.length);X<he;++X){if(H=se[X].length-B[X].length)return H;if(se[X]!=B[X])return se[X]<B[X]?-1:1}return se.length-B.length}function n(G){if(G.charAt(G.length-1)=="/")return G.slice(0,-1).indexOf("/")===-1?G:n(G.slice(0,-1));var ce=G.lastIndexOf("/");return ce===-1?G:G.slice(0,ce+1)}function s(G){if(G.charAt(G.length-1)=="/")return s(G.slice(0,-1));var ce=G.lastIndexOf("/");return ce===-1?G:G.slice(ce+1)}function a(G,ce){typeof ce=="string"&&(ce=new Date(ce));var se=ce.getHours();se=se<<6|ce.getMinutes(),se=se<<5|ce.getSeconds()>>>1,G.write_shift(2,se);var B=ce.getFullYear()-1980;B=B<<4|ce.getMonth()+1,B=B<<5|ce.getDate(),G.write_shift(2,B)}function i(G){var ce=G.read_shift(2)&65535,se=G.read_shift(2)&65535,B=new Date,X=se&31;se>>>=5;var H=se&15;se>>>=4,B.setMilliseconds(0),B.setFullYear(se+1980),B.setMonth(H-1),B.setDate(X);var he=ce&31;ce>>>=5;var Ne=ce&63;return ce>>>=6,B.setHours(ce),B.setMinutes(Ne),B.setSeconds(he<<1),B}function o(G){ws(G,0);for(var ce={},se=0;G.l<=G.length-4;){var B=G.read_shift(2),X=G.read_shift(2),H=G.l+X,he={};switch(B){case 21589:se=G.read_shift(1),se&1&&(he.mtime=G.read_shift(4)),X>5&&(se&2&&(he.atime=G.read_shift(4)),se&4&&(he.ctime=G.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}G.l=H,ce[B]=he}return ce}var l;function u(){return l||(l={})}function d(G,ce){if(G[0]==80&&G[1]==75)return mr(G,ce);if((G[0]|32)==109&&(G[1]|32)==105)return Rt(G,ce);if(G.length<512)throw new Error("CFB file size "+G.length+" < 512");var se=3,B=512,X=0,H=0,he=0,Ne=0,M=0,Q=[],ie=G.slice(0,512);ws(ie,0);var ue=h(ie);switch(se=ue[0],se){case 3:B=512;break;case 4:B=4096;break;case 0:if(ue[1]==0)return mr(G,ce);default:throw new Error("Major Version: Expected 3 or 4 saw "+se)}B!==512&&(ie=G.slice(0,B),ws(ie,28));var Se=G.slice(0,B);m(ie,se);var Ie=ie.read_shift(4,"i");if(se===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);ie.l+=4,he=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),Ne=ie.read_shift(4,"i"),X=ie.read_shift(4,"i"),M=ie.read_shift(4,"i"),H=ie.read_shift(4,"i");for(var Te=-1,Ve=0;Ve<109&&(Te=ie.read_shift(4,"i"),!(Te<0));++Ve)Q[Ve]=Te;var et=x(G,B);_(M,H,et,B,Q);var bt=w(et,he,Q,B);bt[he].name="!Directory",X>0&&Ne!==W&&(bt[Ne].name="!MiniFAT"),bt[Q[0]].name="!FAT",bt.fat_addrs=Q,bt.ssz=B;var wt={},rr=[],Yt=[],or=[];y(he,bt,et,rr,X,wt,Yt,Ne),p(Yt,or,rr),rr.shift();var Jt={FileIndex:Yt,FullPaths:or};return ce&&ce.raw&&(Jt.raw={header:Se,sectors:et}),Jt}function h(G){if(G[G.l]==80&&G[G.l+1]==75)return[0,0];G.chk(le,"Header Signature: "),G.l+=16;var ce=G.read_shift(2,"u");return[G.read_shift(2,"u"),ce]}function m(G,ce){var se=9;switch(G.l+=2,se=G.read_shift(2)){case 9:if(ce!=3)throw new Error("Sector Shift: Expected 9 saw "+se);break;case 12:if(ce!=4)throw new Error("Sector Shift: Expected 12 saw "+se);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+se)}G.chk("0600","Mini Sector Shift: "),G.chk("000000000000","Reserved: ")}function x(G,ce){for(var se=Math.ceil(G.length/ce)-1,B=[],X=1;X<se;++X)B[X-1]=G.slice(X*ce,(X+1)*ce);return B[se-1]=G.slice(se*ce),B}function p(G,ce,se){for(var B=0,X=0,H=0,he=0,Ne=0,M=se.length,Q=[],ie=[];B<M;++B)Q[B]=ie[B]=B,ce[B]=se[B];for(;Ne<ie.length;++Ne)B=ie[Ne],X=G[B].L,H=G[B].R,he=G[B].C,Q[B]===B&&(X!==-1&&Q[X]!==X&&(Q[B]=Q[X]),H!==-1&&Q[H]!==H&&(Q[B]=Q[H])),he!==-1&&(Q[he]=B),X!==-1&&B!=Q[B]&&(Q[X]=Q[B],ie.lastIndexOf(X)<Ne&&ie.push(X)),H!==-1&&B!=Q[B]&&(Q[H]=Q[B],ie.lastIndexOf(H)<Ne&&ie.push(H));for(B=1;B<M;++B)Q[B]===B&&(H!==-1&&Q[H]!==H?Q[B]=Q[H]:X!==-1&&Q[X]!==X&&(Q[B]=Q[X]));for(B=1;B<M;++B)if(G[B].type!==0){if(Ne=B,Ne!=Q[Ne])do Ne=Q[Ne],ce[B]=ce[Ne]+"/"+ce[B];while(Ne!==0&&Q[Ne]!==-1&&Ne!=Q[Ne]);Q[B]=-1}for(ce[0]+="/",B=1;B<M;++B)G[B].type!==2&&(ce[B]+="/")}function v(G,ce,se){for(var B=G.start,X=G.size,H=[],he=B;se&&X>0&&he>=0;)H.push(ce.slice(he*I,he*I+I)),X-=I,he=Jc(se,he*4);return H.length===0?Ye(0):fs(H).slice(0,G.size)}function _(G,ce,se,B,X){var H=W;if(G===W){if(ce!==0)throw new Error("DIFAT chain shorter than expected")}else if(G!==-1){var he=se[G],Ne=(B>>>2)-1;if(!he)return;for(var M=0;M<Ne&&(H=Jc(he,M*4))!==W;++M)X.push(H);_(Jc(he,B-4),ce-1,se,B,X)}}function S(G,ce,se,B,X){var H=[],he=[];X||(X=[]);var Ne=B-1,M=0,Q=0;for(M=ce;M>=0;){X[M]=!0,H[H.length]=M,he.push(G[M]);var ie=se[Math.floor(M*4/B)];if(Q=M*4&Ne,B<4+Q)throw new Error("FAT boundary crossed: "+M+" 4 "+B);if(!G[ie])break;M=Jc(G[ie],Q)}return{nodes:H,data:p8([he])}}function w(G,ce,se,B){var X=G.length,H=[],he=[],Ne=[],M=[],Q=B-1,ie=0,ue=0,Se=0,Ie=0;for(ie=0;ie<X;++ie)if(Ne=[],Se=ie+ce,Se>=X&&(Se-=X),!he[Se]){M=[];var Te=[];for(ue=Se;ue>=0;){Te[ue]=!0,he[ue]=!0,Ne[Ne.length]=ue,M.push(G[ue]);var Ve=se[Math.floor(ue*4/B)];if(Ie=ue*4&Q,B<4+Ie)throw new Error("FAT boundary crossed: "+ue+" 4 "+B);if(!G[Ve]||(ue=Jc(G[Ve],Ie),Te[ue]))break}H[Se]={nodes:Ne,data:p8([M])}}return H}function y(G,ce,se,B,X,H,he,Ne){for(var M=0,Q=B.length?2:0,ie=ce[G].data,ue=0,Se=0,Ie;ue<ie.length;ue+=128){var Te=ie.slice(ue,ue+128);ws(Te,64),Se=Te.read_shift(2),Ie=VT(Te,0,Se-Q),B.push(Ie);var Ve={name:Ie,type:Te.read_shift(1),color:Te.read_shift(1),L:Te.read_shift(4,"i"),R:Te.read_shift(4,"i"),C:Te.read_shift(4,"i"),clsid:Te.read_shift(16),state:Te.read_shift(4,"i"),start:0,size:0},et=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);et!==0&&(Ve.ct=b(Te,Te.l-8));var bt=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);bt!==0&&(Ve.mt=b(Te,Te.l-8)),Ve.start=Te.read_shift(4,"i"),Ve.size=Te.read_shift(4,"i"),Ve.size<0&&Ve.start<0&&(Ve.size=Ve.type=0,Ve.start=W,Ve.name=""),Ve.type===5?(M=Ve.start,X>0&&M!==W&&(ce[M].name="!StreamData")):Ve.size>=4096?(Ve.storage="fat",ce[Ve.start]===void 0&&(ce[Ve.start]=S(se,Ve.start,ce.fat_addrs,ce.ssz)),ce[Ve.start].name=Ve.name,Ve.content=ce[Ve.start].data.slice(0,Ve.size)):(Ve.storage="minifat",Ve.size<0?Ve.size=0:M!==W&&Ve.start!==W&&ce[M]&&(Ve.content=v(Ve,ce[M].data,(ce[Ne]||{}).data))),Ve.content&&ws(Ve.content,0),H[Ie]=Ve,he.push(Ve)}}function b(G,ce){return new Date((Fa(G,ce+4)/1e7*Math.pow(2,32)+Fa(G,ce)/1e7-11644473600)*1e3)}function E(G,ce){return u(),d(l.readFileSync(G),ce)}function N(G,ce){var se=ce&&ce.type;switch(se||ir&&Buffer.isBuffer(G)&&(se="buffer"),se||"base64"){case"file":return E(G,ce);case"base64":return d(ja(La(G)),ce);case"binary":return d(ja(G),ce)}return d(G,ce)}function F(G,ce){var se=ce||{},B=se.root||"Root Entry";if(G.FullPaths||(G.FullPaths=[]),G.FileIndex||(G.FileIndex=[]),G.FullPaths.length!==G.FileIndex.length)throw new Error("inconsistent CFB structure");G.FullPaths.length===0&&(G.FullPaths[0]=B+"/",G.FileIndex[0]={name:B,type:5}),se.CLSID&&(G.FileIndex[0].clsid=se.CLSID),T(G)}function T(G){var ce="Sh33tJ5";if(!Dt.find(G,"/"+ce)){var se=Ye(4);se[0]=55,se[1]=se[3]=50,se[2]=54,G.FileIndex.push({name:ce,type:2,content:se,size:4,L:69,R:69,C:69}),G.FullPaths.push(G.FullPaths[0]+ce),P(G)}}function P(G,ce){F(G);for(var se=!1,B=!1,X=G.FullPaths.length-1;X>=0;--X){var H=G.FileIndex[X];switch(H.type){case 0:B?se=!0:(G.FileIndex.pop(),G.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(H.R*H.L*H.C)&&(se=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(se=!0);break;default:se=!0;break}}if(!(!se&&!ce)){var he=new Date(1987,1,19),Ne=0,M=Object.create?Object.create(null):{},Q=[];for(X=0;X<G.FullPaths.length;++X)M[G.FullPaths[X]]=!0,G.FileIndex[X].type!==0&&Q.push([G.FullPaths[X],G.FileIndex[X]]);for(X=0;X<Q.length;++X){var ie=n(Q[X][0]);B=M[ie],B||(Q.push([ie,{name:s(ie).replace("/",""),type:1,clsid:V,ct:he,mt:he,content:null}]),M[ie]=!0)}for(Q.sort(function(Ie,Te){return r(Ie[0],Te[0])}),G.FullPaths=[],G.FileIndex=[],X=0;X<Q.length;++X)G.FullPaths[X]=Q[X][0],G.FileIndex[X]=Q[X][1];for(X=0;X<Q.length;++X){var ue=G.FileIndex[X],Se=G.FullPaths[X];if(ue.name=s(Se).replace("/",""),ue.L=ue.R=ue.C=-(ue.color=1),ue.size=ue.content?ue.content.length:0,ue.start=0,ue.clsid=ue.clsid||V,X===0)ue.C=Q.length>1?1:-1,ue.size=0,ue.type=5;else if(Se.slice(-1)=="/"){for(Ne=X+1;Ne<Q.length&&n(G.FullPaths[Ne])!=Se;++Ne);for(ue.C=Ne>=Q.length?-1:Ne,Ne=X+1;Ne<Q.length&&n(G.FullPaths[Ne])!=n(Se);++Ne);ue.R=Ne>=Q.length?-1:Ne,ue.type=1}else n(G.FullPaths[X+1]||"")==n(Se)&&(ue.R=X+1),ue.type=2}}}function D(G,ce){var se=ce||{};if(se.fileType=="mad")return ke(G,se);switch(P(G),se.fileType){case"zip":return jt(G,se)}var B=function(Ie){for(var Te=0,Ve=0,et=0;et<Ie.FileIndex.length;++et){var bt=Ie.FileIndex[et];if(bt.content){var wt=bt.content.length;wt>0&&(wt<4096?Te+=wt+63>>6:Ve+=wt+511>>9)}}for(var rr=Ie.FullPaths.length+3>>2,Yt=Te+7>>3,or=Te+127>>7,Jt=Yt+Ve+rr+or,It=Jt+127>>7,ae=It<=109?0:Math.ceil((It-109)/127);Jt+It+ae+127>>7>It;)ae=++It<=109?0:Math.ceil((It-109)/127);var Be=[1,ae,It,or,rr,Ve,Te,0];return Ie.FileIndex[0].size=Te<<6,Be[7]=(Ie.FileIndex[0].start=Be[0]+Be[1]+Be[2]+Be[3]+Be[4]+Be[5])+(Be[6]+7>>3),Be}(G),X=Ye(B[7]<<9),H=0,he=0;{for(H=0;H<8;++H)X.write_shift(1,q[H]);for(H=0;H<8;++H)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),H=0;H<3;++H)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,B[2]),X.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:W),X.write_shift(4,B[3]),X.write_shift(-4,B[1]?B[0]-1:W),X.write_shift(4,B[1]),H=0;H<109;++H)X.write_shift(-4,H<B[2]?B[1]+H:-1)}if(B[1])for(he=0;he<B[1];++he){for(;H<236+he*127;++H)X.write_shift(-4,H<B[2]?B[1]+H:-1);X.write_shift(-4,he===B[1]-1?W:he+1)}var Ne=function(Ie){for(he+=Ie;H<he-1;++H)X.write_shift(-4,H+1);Ie&&(++H,X.write_shift(-4,W))};for(he=H=0,he+=B[1];H<he;++H)X.write_shift(-4,K.DIFSECT);for(he+=B[2];H<he;++H)X.write_shift(-4,K.FATSECT);Ne(B[3]),Ne(B[4]);for(var M=0,Q=0,ie=G.FileIndex[0];M<G.FileIndex.length;++M)ie=G.FileIndex[M],ie.content&&(Q=ie.content.length,!(Q<4096)&&(ie.start=he,Ne(Q+511>>9)));for(Ne(B[6]+7>>3);X.l&511;)X.write_shift(-4,K.ENDOFCHAIN);for(he=H=0,M=0;M<G.FileIndex.length;++M)ie=G.FileIndex[M],ie.content&&(Q=ie.content.length,!(!Q||Q>=4096)&&(ie.start=he,Ne(Q+63>>6)));for(;X.l&511;)X.write_shift(-4,K.ENDOFCHAIN);for(H=0;H<B[4]<<2;++H){var ue=G.FullPaths[H];if(!ue||ue.length===0){for(M=0;M<17;++M)X.write_shift(4,0);for(M=0;M<3;++M)X.write_shift(4,-1);for(M=0;M<12;++M)X.write_shift(4,0);continue}ie=G.FileIndex[H],H===0&&(ie.start=ie.size?ie.start-1:W);var Se=H===0&&se.root||ie.name;if(Q=2*(Se.length+1),X.write_shift(64,Se,"utf16le"),X.write_shift(2,Q),X.write_shift(1,ie.type),X.write_shift(1,ie.color),X.write_shift(-4,ie.L),X.write_shift(-4,ie.R),X.write_shift(-4,ie.C),ie.clsid)X.write_shift(16,ie.clsid,"hex");else for(M=0;M<4;++M)X.write_shift(4,0);X.write_shift(4,ie.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,ie.start),X.write_shift(4,ie.size),X.write_shift(4,0)}for(H=1;H<G.FileIndex.length;++H)if(ie=G.FileIndex[H],ie.size>=4096)if(X.l=ie.start+1<<9,ir&&Buffer.isBuffer(ie.content))ie.content.copy(X,X.l,0,ie.size),X.l+=ie.size+511&-512;else{for(M=0;M<ie.size;++M)X.write_shift(1,ie.content[M]);for(;M&511;++M)X.write_shift(1,0)}for(H=1;H<G.FileIndex.length;++H)if(ie=G.FileIndex[H],ie.size>0&&ie.size<4096)if(ir&&Buffer.isBuffer(ie.content))ie.content.copy(X,X.l,0,ie.size),X.l+=ie.size+63&-64;else{for(M=0;M<ie.size;++M)X.write_shift(1,ie.content[M]);for(;M&63;++M)X.write_shift(1,0)}if(ir)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function R(G,ce){var se=G.FullPaths.map(function(M){return M.toUpperCase()}),B=se.map(function(M){var Q=M.split("/");return Q[Q.length-(M.slice(-1)=="/"?2:1)]}),X=!1;ce.charCodeAt(0)===47?(X=!0,ce=se[0].slice(0,-1)+ce):X=ce.indexOf("/")!==-1;var H=ce.toUpperCase(),he=X===!0?se.indexOf(H):B.indexOf(H);if(he!==-1)return G.FileIndex[he];var Ne=!H.match(s0);for(H=H.replace(sa,""),Ne&&(H=H.replace(s0,"!")),he=0;he<se.length;++he)if((Ne?se[he].replace(s0,"!"):se[he]).replace(sa,"")==H||(Ne?B[he].replace(s0,"!"):B[he]).replace(sa,"")==H)return G.FileIndex[he];return null}var I=64,W=-2,le="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],V="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:V,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function U(G,ce,se){u();var B=D(G,se);l.writeFileSync(ce,B)}function L(G){for(var ce=new Array(G.length),se=0;se<G.length;++se)ce[se]=String.fromCharCode(G[se]);return ce.join("")}function Z(G,ce){var se=D(G,ce);switch(ce&&ce.type||"buffer"){case"file":return u(),l.writeFileSync(ce.filename,se),se;case"binary":return typeof se=="string"?se:L(se);case"base64":return xg(typeof se=="string"?se:L(se));case"buffer":if(ir)return Buffer.isBuffer(se)?se:yl(se);case"array":return typeof se=="string"?ja(se):se}return se}var ne;function z(G){try{var ce=G.InflateRaw,se=new ce;if(se._processChunk(new Uint8Array([3,0]),se._finishFlushFlag),se.bytesRead)ne=G;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function Y(G,ce){if(!ne)return gr(G,ce);var se=ne.InflateRaw,B=new se,X=B._processChunk(G.slice(G.l),B._finishFlushFlag);return G.l+=B.bytesRead,X}function J(G){return ne?ne.deflateRawSync(G):it(G)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(G){var ce=(G<<1|G<<11)&139536|(G<<5|G<<15)&558144;return(ce>>16|ce>>8|ce)&255}for(var fe=typeof Uint8Array<"u",ye=fe?new Uint8Array(256):[],Ce=0;Ce<256;++Ce)ye[Ce]=ge(Ce);function re(G,ce){var se=ye[G&255];return ce<=8?se>>>8-ce:(se=se<<8|ye[G>>8&255],ce<=16?se>>>16-ce:(se=se<<8|ye[G>>16&255],se>>>24-ce))}function ve(G,ce){var se=ce&7,B=ce>>>3;return(G[B]|(se<=6?0:G[B+1]<<8))>>>se&3}function we(G,ce){var se=ce&7,B=ce>>>3;return(G[B]|(se<=5?0:G[B+1]<<8))>>>se&7}function Oe(G,ce){var se=ce&7,B=ce>>>3;return(G[B]|(se<=4?0:G[B+1]<<8))>>>se&15}function Ze(G,ce){var se=ce&7,B=ce>>>3;return(G[B]|(se<=3?0:G[B+1]<<8))>>>se&31}function Re(G,ce){var se=ce&7,B=ce>>>3;return(G[B]|(se<=1?0:G[B+1]<<8))>>>se&127}function xt(G,ce,se){var B=ce&7,X=ce>>>3,H=(1<<se)-1,he=G[X]>>>B;return se<8-B||(he|=G[X+1]<<8-B,se<16-B)||(he|=G[X+2]<<16-B,se<24-B)||(he|=G[X+3]<<24-B),he&H}function $t(G,ce,se){var B=ce&7,X=ce>>>3;return B<=5?G[X]|=(se&7)<<B:(G[X]|=se<<B&255,G[X+1]=(se&7)>>8-B),ce+3}function Ae(G,ce,se){var B=ce&7,X=ce>>>3;return se=(se&1)<<B,G[X]|=se,ce+1}function Pe(G,ce,se){var B=ce&7,X=ce>>>3;return se<<=B,G[X]|=se&255,se>>>=8,G[X+1]=se,ce+8}function Ue(G,ce,se){var B=ce&7,X=ce>>>3;return se<<=B,G[X]|=se&255,se>>>=8,G[X+1]=se&255,G[X+2]=se>>>8,ce+16}function We(G,ce){var se=G.length,B=2*se>ce?2*se:ce+5,X=0;if(se>=ce)return G;if(ir){var H=QA(B);if(G.copy)G.copy(H);else for(;X<G.length;++X)H[X]=G[X];return H}else if(fe){var he=new Uint8Array(B);if(he.set)he.set(G);else for(;X<se;++X)he[X]=G[X];return he}return G.length=B,G}function Xe(G){for(var ce=new Array(G),se=0;se<G;++se)ce[se]=0;return ce}function ut(G,ce,se){var B=1,X=0,H=0,he=0,Ne=0,M=G.length,Q=fe?new Uint16Array(32):Xe(32);for(H=0;H<32;++H)Q[H]=0;for(H=M;H<se;++H)G[H]=0;M=G.length;var ie=fe?new Uint16Array(M):Xe(M);for(H=0;H<M;++H)Q[X=G[H]]++,B<X&&(B=X),ie[H]=0;for(Q[0]=0,H=1;H<=B;++H)Q[H+16]=Ne=Ne+Q[H-1]<<1;for(H=0;H<M;++H)Ne=G[H],Ne!=0&&(ie[H]=Q[Ne+16]++);var ue=0;for(H=0;H<M;++H)if(ue=G[H],ue!=0)for(Ne=re(ie[H],B)>>B-ue,he=(1<<B+4-ue)-1;he>=0;--he)ce[Ne|he<<ue]=ue&15|H<<4;return B}var Ct=fe?new Uint16Array(512):Xe(512),Mt=fe?new Uint16Array(32):Xe(32);if(!fe){for(var At=0;At<512;++At)Ct[At]=0;for(At=0;At<32;++At)Mt[At]=0}(function(){for(var G=[],ce=0;ce<32;ce++)G.push(5);ut(G,Mt,32);var se=[];for(ce=0;ce<=143;ce++)se.push(8);for(;ce<=255;ce++)se.push(9);for(;ce<=279;ce++)se.push(7);for(;ce<=287;ce++)se.push(8);ut(se,Ct,288)})();var Pt=function(){for(var ce=fe?new Uint8Array(32768):[],se=0,B=0;se<ee.length-1;++se)for(;B<ee[se+1];++B)ce[B]=se;for(;B<32768;++B)ce[B]=29;var X=fe?new Uint8Array(259):[];for(se=0,B=0;se<de.length-1;++se)for(;B<de[se+1];++B)X[B]=se;function H(Ne,M){for(var Q=0;Q<Ne.length;){var ie=Math.min(65535,Ne.length-Q),ue=Q+ie==Ne.length;for(M.write_shift(1,+ue),M.write_shift(2,ie),M.write_shift(2,~ie&65535);ie-- >0;)M[M.l++]=Ne[Q++]}return M.l}function he(Ne,M){for(var Q=0,ie=0,ue=fe?new Uint16Array(32768):[];ie<Ne.length;){var Se=Math.min(65535,Ne.length-ie);if(Se<10){for(Q=$t(M,Q,+(ie+Se==Ne.length)),Q&7&&(Q+=8-(Q&7)),M.l=Q/8|0,M.write_shift(2,Se),M.write_shift(2,~Se&65535);Se-- >0;)M[M.l++]=Ne[ie++];Q=M.l*8;continue}Q=$t(M,Q,+(ie+Se==Ne.length)+2);for(var Ie=0;Se-- >0;){var Te=Ne[ie];Ie=(Ie<<5^Te)&32767;var Ve=-1,et=0;if((Ve=ue[Ie])&&(Ve|=ie&-32768,Ve>ie&&(Ve-=32768),Ve<ie))for(;Ne[Ve+et]==Ne[ie+et]&&et<250;)++et;if(et>2){Te=X[et],Te<=22?Q=Pe(M,Q,ye[Te+1]>>1)-1:(Pe(M,Q,3),Q+=5,Pe(M,Q,ye[Te-23]>>5),Q+=3);var bt=Te<8?0:Te-4>>2;bt>0&&(Ue(M,Q,et-de[Te]),Q+=bt),Te=ce[ie-Ve],Q=Pe(M,Q,ye[Te]>>3),Q-=3;var wt=Te<4?0:Te-2>>1;wt>0&&(Ue(M,Q,ie-Ve-ee[Te]),Q+=wt);for(var rr=0;rr<et;++rr)ue[Ie]=ie&32767,Ie=(Ie<<5^Ne[ie])&32767,++ie;Se-=et-1}else Te<=143?Te=Te+48:Q=Ae(M,Q,1),Q=Pe(M,Q,ye[Te]),ue[Ie]=ie&32767,++ie}Q=Pe(M,Q,0)-1}return M.l=(Q+7)/8|0,M.l}return function(M,Q){return M.length<8?H(M,Q):he(M,Q)}}();function it(G){var ce=Ye(50+Math.floor(G.length*1.1)),se=Pt(G,ce);return ce.slice(0,se)}var rt=fe?new Uint16Array(32768):Xe(32768),xe=fe?new Uint16Array(32768):Xe(32768),De=fe?new Uint16Array(128):Xe(128),Le=1,pt=1;function ht(G,ce){var se=Ze(G,ce)+257;ce+=5;var B=Ze(G,ce)+1;ce+=5;var X=Oe(G,ce)+4;ce+=4;for(var H=0,he=fe?new Uint8Array(19):Xe(19),Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=1,Q=fe?new Uint8Array(8):Xe(8),ie=fe?new Uint8Array(8):Xe(8),ue=he.length,Se=0;Se<X;++Se)he[te[Se]]=H=we(G,ce),M<H&&(M=H),Q[H]++,ce+=3;var Ie=0;for(Q[0]=0,Se=1;Se<=M;++Se)ie[Se]=Ie=Ie+Q[Se-1]<<1;for(Se=0;Se<ue;++Se)(Ie=he[Se])!=0&&(Ne[Se]=ie[Ie]++);var Te=0;for(Se=0;Se<ue;++Se)if(Te=he[Se],Te!=0){Ie=ye[Ne[Se]]>>8-Te;for(var Ve=(1<<7-Te)-1;Ve>=0;--Ve)De[Ie|Ve<<Te]=Te&7|Se<<3}var et=[];for(M=1;et.length<se+B;)switch(Ie=De[Re(G,ce)],ce+=Ie&7,Ie>>>=3){case 16:for(H=3+ve(G,ce),ce+=2,Ie=et[et.length-1];H-- >0;)et.push(Ie);break;case 17:for(H=3+we(G,ce),ce+=3;H-- >0;)et.push(0);break;case 18:for(H=11+Re(G,ce),ce+=7;H-- >0;)et.push(0);break;default:et.push(Ie),M<Ie&&(M=Ie);break}var bt=et.slice(0,se),wt=et.slice(se);for(Se=se;Se<286;++Se)bt[Se]=0;for(Se=B;Se<30;++Se)wt[Se]=0;return Le=ut(bt,rt,286),pt=ut(wt,xe,30),ce}function Tt(G,ce){if(G[0]==3&&!(G[1]&3))return[uc(ce),2];for(var se=0,B=0,X=QA(ce||1<<18),H=0,he=X.length>>>0,Ne=0,M=0;!(B&1);){if(B=we(G,se),se+=3,B>>>1)B>>1==1?(Ne=9,M=5):(se=ht(G,se),Ne=Le,M=pt);else{se&7&&(se+=8-(se&7));var Q=G[se>>>3]|G[(se>>>3)+1]<<8;if(se+=32,Q>0)for(!ce&&he<H+Q&&(X=We(X,H+Q),he=X.length);Q-- >0;)X[H++]=G[se>>>3],se+=8;continue}for(;;){!ce&&he<H+32767&&(X=We(X,H+32767),he=X.length);var ie=xt(G,se,Ne),ue=B>>>1==1?Ct[ie]:rt[ie];if(se+=ue&15,ue>>>=4,!(ue>>>8&255))X[H++]=ue;else{if(ue==256)break;ue-=257;var Se=ue<8?0:ue-4>>2;Se>5&&(Se=0);var Ie=H+de[ue];Se>0&&(Ie+=xt(G,se,Se),se+=Se),ie=xt(G,se,M),ue=B>>>1==1?Mt[ie]:xe[ie],se+=ue&15,ue>>>=4;var Te=ue<4?0:ue-2>>1,Ve=ee[ue];for(Te>0&&(Ve+=xt(G,se,Te),se+=Te),!ce&&he<Ie&&(X=We(X,Ie+100),he=X.length);H<Ie;)X[H]=X[H-Ve],++H}}}return ce?[X,se+7>>>3]:[X.slice(0,H),se+7>>>3]}function gr(G,ce){var se=G.slice(G.l||0),B=Tt(se,ce);return G.l+=B[1],B[0]}function tr(G,ce){if(G)typeof console<"u"&&console.error(ce);else throw new Error(ce)}function mr(G,ce){var se=G;ws(se,0);var B=[],X=[],H={FileIndex:B,FullPaths:X};F(H,{root:ce.root});for(var he=se.length-4;(se[he]!=80||se[he+1]!=75||se[he+2]!=5||se[he+3]!=6)&&he>=0;)--he;se.l=he+4,se.l+=4;var Ne=se.read_shift(2);se.l+=6;var M=se.read_shift(4);for(se.l=M,he=0;he<Ne;++he){se.l+=20;var Q=se.read_shift(4),ie=se.read_shift(4),ue=se.read_shift(2),Se=se.read_shift(2),Ie=se.read_shift(2);se.l+=8;var Te=se.read_shift(4),Ve=o(se.slice(se.l+ue,se.l+ue+Se));se.l+=ue+Se+Ie;var et=se.l;se.l=Te+4,Je(se,Q,ie,H,Ve),se.l=et}return H}function Je(G,ce,se,B,X){G.l+=2;var H=G.read_shift(2),he=G.read_shift(2),Ne=i(G);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var M=G.read_shift(4),Q=G.read_shift(4),ie=G.read_shift(4),ue=G.read_shift(2),Se=G.read_shift(2),Ie="",Te=0;Te<ue;++Te)Ie+=String.fromCharCode(G[G.l++]);if(Se){var Ve=o(G.slice(G.l,G.l+Se));(Ve[21589]||{}).mt&&(Ne=Ve[21589].mt),((X||{})[21589]||{}).mt&&(Ne=X[21589].mt)}G.l+=Se;var et=G.slice(G.l,G.l+Q);switch(he){case 8:et=Y(G,ie);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var bt=!1;H&8&&(M=G.read_shift(4),M==134695760&&(M=G.read_shift(4),bt=!0),Q=G.read_shift(4),ie=G.read_shift(4)),Q!=ce&&tr(bt,"Bad compressed size: "+ce+" != "+Q),ie!=se&&tr(bt,"Bad uncompressed size: "+se+" != "+ie),qe(B,Ie,et,{unsafe:!0,mt:Ne})}function jt(G,ce){var se=ce||{},B=[],X=[],H=Ye(1),he=se.compression?8:0,Ne=0,M=0,Q=0,ie=0,ue=0,Se=G.FullPaths[0],Ie=Se,Te=G.FileIndex[0],Ve=[],et=0;for(M=1;M<G.FullPaths.length;++M)if(Ie=G.FullPaths[M].slice(Se.length),Te=G.FileIndex[M],!(!Te.size||!Te.content||Ie=="Sh33tJ5")){var bt=ie,wt=Ye(Ie.length);for(Q=0;Q<Ie.length;++Q)wt.write_shift(1,Ie.charCodeAt(Q)&127);wt=wt.slice(0,wt.l),Ve[ue]=Zre.buf(Te.content,0);var rr=Te.content;he==8&&(rr=J(rr)),H=Ye(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,Ne),H.write_shift(2,he),Te.mt?a(H,Te.mt):H.write_shift(4,0),H.write_shift(-4,Ve[ue]),H.write_shift(4,rr.length),H.write_shift(4,Te.content.length),H.write_shift(2,wt.length),H.write_shift(2,0),ie+=H.length,B.push(H),ie+=wt.length,B.push(wt),ie+=rr.length,B.push(rr),H=Ye(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,Ne),H.write_shift(2,he),H.write_shift(4,0),H.write_shift(-4,Ve[ue]),H.write_shift(4,rr.length),H.write_shift(4,Te.content.length),H.write_shift(2,wt.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,bt),et+=H.l,X.push(H),et+=wt.length,X.push(wt),++ue}return H=Ye(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,ue),H.write_shift(2,ue),H.write_shift(4,et),H.write_shift(4,ie),H.write_shift(2,0),fs([fs(B),fs(X),H])}var vt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function me(G,ce){if(G.ctype)return G.ctype;var se=G.name||"",B=se.match(/\.([^\.]+)$/);return B&&vt[B[1]]||ce&&(B=(se=ce).match(/[\.\\]([^\.\\])+$/),B&&vt[B[1]])?vt[B[1]]:"application/octet-stream"}function be(G){for(var ce=xg(G),se=[],B=0;B<ce.length;B+=76)se.push(ce.slice(B,B+76));return se.join(`\r
`)+`\r
`}function _e(G){var ce=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var ie=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});ce=ce.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ce.charAt(0)==`
`&&(ce="=0D"+ce.slice(1)),ce=ce.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var se=[],B=ce.split(`\r
`),X=0;X<B.length;++X){var H=B[X];if(H.length==0){se.push("");continue}for(var he=0;he<H.length;){var Ne=76,M=H.slice(he,he+Ne);M.charAt(Ne-1)=="="?Ne--:M.charAt(Ne-2)=="="?Ne-=2:M.charAt(Ne-3)=="="&&(Ne-=3),M=H.slice(he,he+Ne),he+=Ne,he<H.length&&(M+="="),se.push(M)}}return se.join(`\r
`)}function Fe(G){for(var ce=[],se=0;se<G.length;++se){for(var B=G[se];se<=G.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+G[++se];ce.push(B)}for(var X=0;X<ce.length;++X)ce[X]=ce[X].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return ja(ce.join(`\r
`))}function nt(G,ce,se){for(var B="",X="",H="",he,Ne=0;Ne<10;++Ne){var M=ce[Ne];if(!M||M.match(/^\s*$/))break;var Q=M.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":B=Q[2].trim();break;case"content-type":H=Q[2].trim();break;case"content-transfer-encoding":X=Q[2].trim();break}}switch(++Ne,X.toLowerCase()){case"base64":he=ja(La(ce.slice(Ne).join("")));break;case"quoted-printable":he=Fe(ce.slice(Ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var ie=qe(G,B.slice(se.length),he,{unsafe:!0});H&&(ie.ctype=H)}function Rt(G,ce){if(L(G.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var se=ce&&ce.root||"",B=(ir&&Buffer.isBuffer(G)?G.toString("binary"):L(G)).split(`\r
`),X=0,H="";for(X=0;X<B.length;++X)if(H=B[X],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),se||(se=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,se.length)!=se))for(;se.length>0&&(se=se.slice(0,se.length-1),se=se.slice(0,se.lastIndexOf("/")+1),H.slice(0,se.length)!=se););var he=(B[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Ne="--"+(he[1]||""),M=[],Q=[],ie={FileIndex:M,FullPaths:Q};F(ie);var ue,Se=0;for(X=0;X<B.length;++X){var Ie=B[X];Ie!==Ne&&Ie!==Ne+"--"||(Se++&&nt(ie,B.slice(ue,X),se),ue=X)}return ie}function ke(G,ce){var se=ce||{},B=se.boundary||"SheetJS";B="------="+B;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],H=G.FullPaths[0],he=H,Ne=G.FileIndex[0],M=1;M<G.FullPaths.length;++M)if(he=G.FullPaths[M].slice(H.length),Ne=G.FileIndex[M],!(!Ne.size||!Ne.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(et){return"_x"+et.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(et){return"_u"+et.charCodeAt(0).toString(16)+"_"});for(var Q=Ne.content,ie=ir&&Buffer.isBuffer(Q)?Q.toString("binary"):L(Q),ue=0,Se=Math.min(1024,ie.length),Ie=0,Te=0;Te<=Se;++Te)(Ie=ie.charCodeAt(Te))>=32&&Ie<128&&++ue;var Ve=ue>=Se*4/5;X.push(B),X.push("Content-Location: "+(se.root||"file:///C:/SheetJS/")+he),X.push("Content-Transfer-Encoding: "+(Ve?"quoted-printable":"base64")),X.push("Content-Type: "+me(Ne,he)),X.push(""),X.push(Ve?_e(ie):be(ie))}return X.push(B+`--\r
`),X.join(`\r
`)}function Qe(G){var ce={};return F(ce,G),ce}function qe(G,ce,se,B){var X=B&&B.unsafe;X||F(G);var H=!X&&Dt.find(G,ce);if(!H){var he=G.FullPaths[0];ce.slice(0,he.length)==he?he=ce:(he.slice(-1)!="/"&&(he+="/"),he=(he+ce).replace("//","/")),H={name:s(ce),type:2},G.FileIndex.push(H),G.FullPaths.push(he),X||Dt.utils.cfb_gc(G)}return H.content=se,H.size=se?se.length:0,B&&(B.CLSID&&(H.clsid=B.CLSID),B.mt&&(H.mt=B.mt),B.ct&&(H.ct=B.ct)),H}function yt(G,ce){F(G);var se=Dt.find(G,ce);if(se){for(var B=0;B<G.FileIndex.length;++B)if(G.FileIndex[B]==se)return G.FileIndex.splice(B,1),G.FullPaths.splice(B,1),!0}return!1}function Vt(G,ce,se){F(G);var B=Dt.find(G,ce);if(B){for(var X=0;X<G.FileIndex.length;++X)if(G.FileIndex[X]==B)return G.FileIndex[X].name=s(se),G.FullPaths[X]=se,!0}return!1}function zt(G){P(G,!0)}return e.find=R,e.read=N,e.parse=d,e.write=Z,e.writeFile=U,e.utils={cfb_new:Qe,cfb_add:qe,cfb_del:yt,cfb_mov:Vt,cfb_gc:zt,ReadShift:T0,CheckField:GO,prep_blob:ws,bconcat:fs,use_zlib:z,_deflateRaw:it,_inflateRaw:gr,consts:K},e}();function ene(t){return typeof t=="string"?Sv(t):Array.isArray(t)?Tre(t):t}function om(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Sv(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?go(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([ene(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=t,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Ac(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function tne(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function bn(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function a8(t,e){for(var r=[],n=bn(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function kv(t){for(var e=[],r=bn(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Cv(t){for(var e=[],r=bn(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function rne(t){for(var e=[],r=bn(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var j1=new Date(1899,11,30,0,0,0);function es(t,e){var r=t.getTime(),n=j1.getTime()+(t.getTimezoneOffset()-j1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var kO=new Date,nne=j1.getTime()+(kO.getTimezoneOffset()-j1.getTimezoneOffset())*6e4,i8=kO.getTimezoneOffset();function Tv(t){var e=new Date;return e.setTime(t*24*60*60*1e3+nne),e.getTimezoneOffset()!==i8&&e.setTime(e.getTime()+(e.getTimezoneOffset()-i8)*6e4),e}function sne(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var o8=new Date("2017-02-19T19:06:09.000Z"),CO=isNaN(o8.getFullYear())?new Date("2/19/17"):o8,ane=CO.getFullYear()==2017;function Hr(t,e){var r=new Date(t);if(ane)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(CO.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Lu(t,e){if(ir&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return go(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return go(fO(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return go(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return go(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Kr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Kr(t[r]));return e}function vn(t,e){for(var r="";r.length<e;)r+=t;return r}function $i(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var ine=["january","february","march","april","may","june","july","august","september","october","november","december"];function Uf(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var i=t.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&ine.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var one=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function TO(t){return t?t.content&&t.type?Lu(t.content,!0):t.data?n0(t.data):t.asNodeBuffer&&ir?n0(t.asNodeBuffer().toString("binary")):t.asBinary?n0(t.asBinary()):t._data&&t._data.getContent?n0(Lu(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function EO(t){if(!t)return null;if(t.data)return YA(t.data);if(t.asNodeBuffer&&ir)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?YA(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function lne(t){return t&&t.name.slice(-4)===".bin"?EO(t):TO(t)}function ni(t,e){for(var r=t.FullPaths||bn(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function IT(t,e){var r=ni(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Un(t,e,r){if(!r)return lne(IT(t,e));if(!e)return null;try{return Un(t,e)}catch{return null}}function Pa(t,e,r){if(!r)return TO(IT(t,e));if(!e)return null;try{return Pa(t,e)}catch{return null}}function cne(t,e,r){return EO(IT(t,e))}function l8(t){for(var e=t.FullPaths||bn(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function nr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return ir?n=yl(r):n=Ere(r),Dt.utils.cfb_add(t,e,n)}Dt.utils.cfb_add(t,e,r)}else t.file(e,r)}function BT(){return Dt.utils.cfb_new()}function NO(t,e){switch(e.type){case"base64":return Dt.read(t,{type:"base64"});case"binary":return Dt.read(t,{type:"binary"});case"buffer":case"array":return Dt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function a0(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var On=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,une=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,c8=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,dne=/<[^>]*>/g,Xs=On.match(c8)?c8:dne,fne=/<\w*:/,hne=/<(\/?)\w+:/;function Ht(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var i=t.match(une),o=0,l="",u=0,d="",h="",m=1;if(i)for(u=0;u!=i.length;++u){for(h=i[u],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(d=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(m=(s=h.charCodeAt(a+1))==34||s==39?1:0,l=h.slice(a+1+m,h.length-m),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var x=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[x]&&d.slice(o-3,o)=="ext")continue;n[x]=l,n[x.toLowerCase()]=l}}return n}function Eo(t){return t.replace(hne,"<$1")}var AO={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},UT=kv(AO),wr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(o,l){return AO[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),$T=/[&<>'"]/g,gne=/[\u0000-\u0008\u000b-\u001f]/g;function Dr(t){var e=t+"";return e.replace($T,function(r){return UT[r]}).replace(gne,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function u8(t){return Dr(t).replace(/ /g,"_x0020_")}var FO=/[\u0000-\u001f]/g;function zT(t){var e=t+"";return e.replace($T,function(r){return UT[r]}).replace(/\n/g,"<br/>").replace(FO,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function mne(t){var e=t+"";return e.replace($T,function(r){return UT[r]}).replace(FO,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var d8=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function pne(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Wr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function a_(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,e+=String.fromCharCode(i);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function f8(t){var e=uc(2*t.length),r,n,s=1,a=0,i=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(e[a++]=i&255,e[a++]=i>>>8,i=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function h8(t){return yl(t,"binary").toString("utf8")}var Gp="foo bar baz",Mr=ir&&(h8(Gp)==a_(Gp)&&h8||f8(Gp)==a_(Gp)&&f8)||a_,go=ir?function(t){return yl(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},vg=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),jO=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),xne=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),yne=/<\/?(?:vt:)?variant>/g,vne=/<(?:vt:)([^>]*)>([\s\S]*)</;function g8(t,e){var r=Ht(t),n=t.match(xne(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(yne,"").match(vne);i&&s.push({v:Mr(i[2]),t:i[1]})}),s}var PO=/(^\s|\s$|\n)/;function bs(t,e){return"<"+t+(e.match(PO)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function wg(t){return bn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function dt(t,e,r){return"<"+t+(r!=null?wg(r):"")+(e!=null?(e.match(PO)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Nb(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function wne(t,e){switch(typeof t){case"string":var r=dt("vt:lpwstr",Dr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return dt((t|0)==t?"vt:i4":"vt:r8",Dr(String(t)));case"boolean":return dt("vt:bool",t?"true":"false")}if(t instanceof Date)return dt("vt:filetime",Nb(t));throw new Error("Unable to serialize "+t)}function WT(t){if(ir&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Mr(Ac(OT(t)));throw new Error("Bad input format: expected Buffer or string")}var _g=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Qn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},nd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Aa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function _ne(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Sne(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,i=n?-e:e;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var o=0;o<=5;++o,a/=256)t[r+o]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var m8=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},p8=ir?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:yl(e)})):m8(t)}:m8,x8=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Yo(t,s)));return n.join("").replace(sa,"")},VT=ir?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(sa,""):x8(t,e,r)}:x8,y8=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},DO=ir?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):y8(t,e,r)}:y8,v8=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Od(t,s)));return n.join("")},lm=ir?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):v8(e,r,n)}:v8,RO=function(t,e){var r=Fa(t,e);return r>0?lm(t,e+4,e+4+r-1):""},OO=RO,MO=function(t,e){var r=Fa(t,e);return r>0?lm(t,e+4,e+4+r-1):""},LO=MO,IO=function(t,e){var r=2*Fa(t,e);return r>0?lm(t,e+4,e+4+r-1):""},BO=IO,UO=function(e,r){var n=Fa(e,r);return n>0?VT(e,r+4,r+4+n):""},$O=UO,zO=function(t,e){var r=Fa(t,e);return r>0?lm(t,e+4,e+4+r):""},WO=zO,VO=function(t,e){return _ne(t,e)},P1=VO,GT=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};ir&&(OO=function(e,r){if(!Buffer.isBuffer(e))return RO(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},LO=function(e,r){if(!Buffer.isBuffer(e))return MO(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},BO=function(e,r){if(!Buffer.isBuffer(e))return IO(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},$O=function(e,r){if(!Buffer.isBuffer(e))return UO(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},WO=function(e,r){if(!Buffer.isBuffer(e))return zO(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},P1=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):VO(e,r)},GT=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Od=function(t,e){return t[e]},Yo=function(t,e){return t[e+1]*256+t[e]},bne=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Fa=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Jc=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},kne=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function T0(t,e){var r="",n,s,a=[],i,o,l,u;switch(e){case"dbcs":if(u=this.l,ir&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Yo(this,u)),u+=2;t*=2;break;case"utf8":r=lm(this,this.l,this.l+t);break;case"utf16le":t*=2,r=VT(this,this.l,this.l+t);break;case"wstr":return T0.call(this,t,"dbcs");case"lpstr-ansi":r=OO(this,this.l),t=4+Fa(this,this.l);break;case"lpstr-cp":r=LO(this,this.l),t=4+Fa(this,this.l);break;case"lpwstr":r=BO(this,this.l),t=4+2*Fa(this,this.l);break;case"lpp4":t=4+Fa(this,this.l),r=$O(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Fa(this,this.l),r=WO(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(i=Od(this,this.l+t++))!==0;)a.push(Vp(i));r=a.join("");break;case"_wstr":for(t=0,r="";(i=Yo(this,this.l+t))!==0;)a.push(Vp(i)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Od(this,u),this.l=u+1,o=T0.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Vp(Yo(this,u))),u+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Od(this,u),this.l=u+1,o=T0.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Vp(Od(this,u))),u+=1}r=a.join("");break;default:switch(t){case 1:return n=Od(this,this.l),this.l++,n;case 2:return n=(e==="i"?bne:Yo)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Jc:kne)(this,this.l),this.l+=4,n):(s=Fa(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=P1(this,this.l):s=P1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=DO(this,this.l,t);break}}return this.l+=t,r}var Cne=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},Tne=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Ene=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Nne(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)Ene(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var i=e.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Cne(this,e,this.l);break;case 8:if(n=8,r==="f"){Sne(this,e,this.l);break}case 16:break;case-4:n=4,Tne(this,e,this.l);break}return this.l+=n,this}function GO(t,e){var r=DO(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ws(t,e){t.l=e,t.read_shift=T0,t.chk=GO,t.write_shift=Nne}function Hs(t,e){t.l+=e}function Ye(t){var e=uc(t);return ws(e,0),e}function vl(t,e,r){if(t){var n,s,a;ws(t,t.l||0);for(var i=t.length,o=0,l=0;t.l<i;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=Eg[o]||Eg[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;l=t.l+a;var d=u.f&&u.f(t,a,r);if(t.l=l,e(d,u,o))return}}}function Sa(){var t=[],e=ir?256:2048,r=function(u){var d=Ye(u);return ws(d,0),d},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,e)))},i=function(){return s(),fs(t)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:o,end:i,_bufs:t}}function tt(t,e,r,n){var s=+e,a;if(!isNaN(s)){n||(n=Eg[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=t.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&GT(r)&&t.push(r)}}function E0(t,e,r){var n=Kr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function w8(t,e,r){var n=Kr(t);return n.s=E0(n.s,e.s,r),n.e=E0(n.e,e.s,r),n}function N0(t,e){if(t.cRel&&t.c<0)for(t=Kr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Kr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Wt(t);return!t.cRel&&t.cRel!=null&&(r=jne(r)),!t.rRel&&t.rRel!=null&&(r=Ane(r)),r}function i_(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+cn(t.s.c)+":"+(t.e.cRel?"":"$")+cn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Pn(t.s.r)+":"+(t.e.rRel?"":"$")+Pn(t.e.r):N0(t.s,e.biff)+":"+N0(t.e,e.biff)}function HT(t){return parseInt(Fne(t),10)-1}function Pn(t){return""+(t+1)}function Ane(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Fne(t){return t.replace(/\$(\d+)$/,"$1")}function KT(t){for(var e=Pne(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function cn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function jne(t){return t.replace(/^([A-Z])/,"$$$1")}function Pne(t){return t.replace(/^\$([A-Z])/,"$1")}function Dne(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function un(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Wt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ba(t){var e=t.indexOf(":");return e==-1?{s:un(t),e:un(t)}:{s:un(t.slice(0,e)),e:un(t.slice(e+1))}}function er(t,e){return typeof e>"u"||typeof e=="number"?er(t.s,t.e):(typeof t!="string"&&(t=Wt(t)),typeof e!="string"&&(e=Wt(e)),t==e?t:t+":"+e)}function _r(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function _8(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=yi(t.z,r?es(e):e)}catch{}try{return t.w=yi((t.XF||{}).numFmtId||(r?14:0),r?es(e):e)}catch{return""+e}}function ul(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?wl[t.v]||t.v:e==null?_8(t,t.v):_8(t,e))}function Fc(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function HO(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?un(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=_r(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[h].length;++m)if(!(typeof e[h][m]>"u")){var x={v:e[h][m]},p=i+h,v=o+m;if(u.s.r>p&&(u.s.r=p),u.s.c>v&&(u.s.c=v),u.e.r<p&&(u.e.r=p),u.e.c<v&&(u.e.c=v),e[h][m]&&typeof e[h][m]=="object"&&!Array.isArray(e[h][m])&&!(e[h][m]instanceof Date))x=e[h][m];else if(Array.isArray(x.v)&&(x.f=e[h][m][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||Bt[14],n.cellDates?(x.t="d",x.w=yi(x.z,es(x.v))):(x.t="n",x.v=es(x.v),x.w=yi(x.z,x.v))):x.t="s";if(s)a[p]||(a[p]=[]),a[p][v]&&a[p][v].z&&(x.z=a[p][v].z),a[p][v]=x;else{var _=Wt({c:v,r:p});a[_]&&a[_].z&&(x.z=a[_].z),a[_]=x}}}return u.s.c<1e7&&(a["!ref"]=er(u)),a}function fh(t,e){return HO(null,t,e)}function Rne(t){return t.read_shift(4,"i")}function zi(t,e){return e||(e=Ye(4)),e.write_shift(4,t),e}function Ws(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function hs(t,e){var r=!1;return e==null&&(r=!0,e=Ye(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function One(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Mne(t,e){return e||(e=Ye(4)),e.write_shift(2,0),e.write_shift(2,0),e}function XT(t,e){var r=t.l,n=t.read_shift(1),s=Ws(t),a=[],i={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(One(t));i.r=a}else i.r=[{ich:0,ifnt:0}];return t.l=r+e,i}function Lne(t,e){var r=!1;return e==null&&(r=!0,e=Ye(15+4*t.t.length)),e.write_shift(1,0),hs(t.t,e),r?e.slice(0,e.l):e}var Ine=XT;function Bne(t,e){var r=!1;return e==null&&(r=!0,e=Ye(23+4*t.t.length)),e.write_shift(1,1),hs(t.t,e),e.write_shift(4,1),Mne({},e),r?e.slice(0,e.l):e}function vi(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function sd(t,e){return e==null&&(e=Ye(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function ad(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function id(t,e){return e==null&&(e=Ye(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Une=Ws,KO=hs;function YT(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function D1(t,e){var r=!1;return e==null&&(r=!0,e=Ye(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var $ne=Ws,Ab=YT,JT=D1;function QT(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?P1([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Jc(e,0)>>2;return r?s/100:s}function XO(t,e){e==null&&(e=Ye(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function YO(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function zne(t,e){return e||(e=Ye(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var od=YO,hh=zne;function Us(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Iu(t,e){return(e||Ye(8)).write_shift(8,t,"f")}function Wne(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),i=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var u=gu[s];u&&(e.rgb=bg(u));break;case 2:e.rgb=bg([i,o,l]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function R1(t,e){if(e||(e=Ye(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Vne(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Gne(t,e){e||(e=Ye(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function JO(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function Hne(t){return JO(t,1)}function Kne(t){return JO(t,2)}var qT=2,ha=3,Hp=11,S8=12,O1=19,Kp=64,Xne=65,Yne=71,Jne=4108,Qne=4126,os=80,QO=81,qne=[os,QO],Fb={1:{n:"CodePage",t:qT},2:{n:"Category",t:os},3:{n:"PresentationFormat",t:os},4:{n:"ByteCount",t:ha},5:{n:"LineCount",t:ha},6:{n:"ParagraphCount",t:ha},7:{n:"SlideCount",t:ha},8:{n:"NoteCount",t:ha},9:{n:"HiddenCount",t:ha},10:{n:"MultimediaClipCount",t:ha},11:{n:"ScaleCrop",t:Hp},12:{n:"HeadingPairs",t:Jne},13:{n:"TitlesOfParts",t:Qne},14:{n:"Manager",t:os},15:{n:"Company",t:os},16:{n:"LinksUpToDate",t:Hp},17:{n:"CharacterCount",t:ha},19:{n:"SharedDoc",t:Hp},22:{n:"HyperlinksChanged",t:Hp},23:{n:"AppVersion",t:ha,p:"version"},24:{n:"DigSig",t:Xne},26:{n:"ContentType",t:os},27:{n:"ContentStatus",t:os},28:{n:"Language",t:os},29:{n:"Version",t:os},255:{},2147483648:{n:"Locale",t:O1},2147483651:{n:"Behavior",t:O1},1919054434:{}},jb={1:{n:"CodePage",t:qT},2:{n:"Title",t:os},3:{n:"Subject",t:os},4:{n:"Author",t:os},5:{n:"Keywords",t:os},6:{n:"Comments",t:os},7:{n:"Template",t:os},8:{n:"LastAuthor",t:os},9:{n:"RevNumber",t:os},10:{n:"EditTime",t:Kp},11:{n:"LastPrinted",t:Kp},12:{n:"CreatedDate",t:Kp},13:{n:"ModifiedDate",t:Kp},14:{n:"PageCount",t:ha},15:{n:"WordCount",t:ha},16:{n:"CharCount",t:ha},17:{n:"Thumbnail",t:Yne},18:{n:"Application",t:os},19:{n:"DocSecurity",t:ha},255:{},2147483648:{n:"Locale",t:O1},2147483651:{n:"Behavior",t:O1},1919054434:{}},b8={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Zne=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ese(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var tse=ese([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),gu=Kr(tse),wl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qO={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Pb={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Xp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ZT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function rse(t){var e=ZT();if(!t||!t.match)return e;var r={};if((t.match(Xs)||[]).forEach(function(n){var s=Ht(n);switch(s[0].replace(fne,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[Pb[s.ContentType]]!==void 0&&e[Pb[s.ContentType]].push(s.PartName);break}}),e.xmlns!==Qn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function ZO(t,e){var r=rne(Pb),n=[],s;n[n.length]=On,n[n.length]=dt("Types",null,{xmlns:Qn.CT,"xmlns:xsd":Qn.xsd,"xmlns:xsi":Qn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return dt("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){t[l]&&t[l].length>0&&(s=t[l][0],n[n.length]=dt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Xp[l][e.bookType]||Xp[l].xlsx}))},i=function(l){(t[l]||[]).forEach(function(u){n[n.length]=dt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Xp[l][e.bookType]||Xp[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=dt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ur={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Sg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function A0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Xs)||[]).forEach(function(s){var a=Ht(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:a0(a.Target,e);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function xf(t){var e=[On,dt("Relationships",null,{xmlns:Qn.RELS})];return bn(t["!id"]).forEach(function(r){e[e.length]=dt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Pr(t,e,r,n,s,a){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[ur.HLINK,ur.XPATH,ur.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var nse="application/vnd.oasis.opendocument.spreadsheet";function sse(t,e){for(var r=WT(t),n,s;n=_g.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Ht(n[0],!1),s.path=="/"&&s.type!==nse)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function ase(t){var e=[On];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function k8(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function ise(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function ose(t){var e=[On];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(k8(t[r][0],t[r][1])),e.push(ise("",t[r][0]));return e.push(k8("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function eM(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+E1.version+"</meta:generator></office:meta></office:document-meta>"}var hi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],lse=function(){for(var t=new Array(hi.length),e=0;e<hi.length;++e){var r=hi[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function tM(t){var e={};t=Mr(t);for(var r=0;r<hi.length;++r){var n=hi[r],s=t.match(lse[r]);s!=null&&s.length>0&&(e[n[1]]=wr(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Hr(e[n[1]]))}return e}function o_(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=Dr(e),n[n.length]=r?dt(t,e,r):bs(t,e))}function rM(t,e){var r=e||{},n=[On,dt("cp:coreProperties",null,{"xmlns:cp":Qn.CORE_PROPS,"xmlns:dc":Qn.dc,"xmlns:dcterms":Qn.dcterms,"xmlns:dcmitype":Qn.dcmitype,"xmlns:xsi":Qn.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&o_("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Nb(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&o_("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Nb(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=hi.length;++a){var i=hi[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:t?t[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&o_(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var mu=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],nM=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function sM(t,e,r,n){var s=[];if(typeof t=="string")s=g8(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(d){return{v:d}}));var i=typeof e=="string"?g8(e,n).map(function(d){return d.v}):e,o=0,l=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(l=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function cse(t,e,r){var n={};return e||(e={}),t=Mr(t),mu.forEach(function(s){var a=(t.match(vg(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=wr(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var i=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&sM(n.HeadingPairs,n.TitlesOfParts,e,r),e}function aM(t){var e=[],r=dt;return t||(t={}),t.Application="SheetJS",e[e.length]=On,e[e.length]=dt("Properties",null,{xmlns:Qn.EXT_PROPS,"xmlns:vt":Qn.vt}),mu.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Dr(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Dr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var use=/<[^>]+>[^<]*/g;function dse(t,e){var r={},n="",s=t.match(use);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Ht(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=wr(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),d=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=wr(d);break;case"bool":r[n]=Wr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Hr(d);break;case"cy":case"error":r[n]=wr(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(e.WTF)throw new Error(i)}}}return r}function iM(t){var e=[On,dt("Properties",null,{xmlns:Qn.CUST_PROPS,"xmlns:vt":Qn.vt})];if(!t)return e.join("");var r=1;return bn(t).forEach(function(s){++r,e[e.length]=dt("property",wne(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Dr(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Db={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},l_;function fse(t,e,r){l_||(l_=kv(Db)),e=l_[e]||e,t[e]=r}function hse(t,e){var r=[];return bn(Db).map(function(n){for(var s=0;s<hi.length;++s)if(hi[s][1]==n)return hi[s];for(s=0;s<mu.length;++s)if(mu[s][1]==n)return mu[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(bs(Db[n[1]]||n[1],s))}}),dt("DocumentProperties",r.join(""),{xmlns:Aa.o})}function gse(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&bn(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var i=0;i<hi.length;++i)if(a==hi[i][1])return;for(i=0;i<mu.length;++i)if(a==mu[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(dt(u8(a),o,{"dt:dt":l}))}}),e&&bn(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var i=e[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(dt(u8(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Aa.o+'">'+s.join("")+"</"+n+">"}function e4(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function mse(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=Ye(8);return i.write_shift(4,n),i.write_shift(4,s),i}function oM(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function lM(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function cM(t,e,r){return e===31?lM(t):oM(t,e,r)}function Rb(t,e,r){return cM(t,e,r===!1?0:4)}function pse(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return cM(t,e,0)}function xse(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(sa,""),t.l-s&2&&(t.l+=2)}return r}function yse(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(sa,"");return r}function vse(t){var e=t.l,r=M1(t,QO);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=M1(t,ha);return[r,n]}function wse(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(vse(t));return r}function C8(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),i=t.read_shift(4);n[a]=t.read_shift(i,e===1200?"utf16le":"utf8").replace(sa,"").replace(s0,"!"),e===1200&&i%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function uM(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function _se(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function M1(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==S8&&n!==e&&qne.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===S8?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return oM(t,n,4).replace(sa,"");case 31:return lM(t);case 64:return e4(t);case 65:return uM(t);case 71:return _se(t);case 80:return Rb(t,n,!a.raw).replace(sa,"");case 81:return pse(t,n).replace(sa,"");case 4108:return wse(t);case 4126:case 4127:return n==4127?xse(t):yse(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function T8(t,e){var r=Ye(4),n=Ye(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Ye(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=mse(e);break;case 31:case 80:for(n=Ye(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return fs([r,n])}function E8(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0,o=0,l=-1,u={};for(i=0;i!=s;++i){var d=t.read_shift(4),h=t.read_shift(4);a[i]=[d,h+r]}a.sort(function(w,y){return w[1]-y[1]});var m={};for(i=0;i!=s;++i){if(t.l!==a[i][1]){var x=!0;if(i>0&&e)switch(e[a[i-1][0]].t){case 2:t.l+2===a[i][1]&&(t.l+=2,x=!1);break;case 80:t.l<=a[i][1]&&(t.l=a[i][1],x=!1);break;case 4108:t.l<=a[i][1]&&(t.l=a[i][1],x=!1);break}if((!e||i==0)&&t.l<=a[i][1]&&(x=!1,t.l=a[i][1]),x)throw new Error("Read Error: Expected address "+a[i][1]+" at "+t.l+" :"+i)}if(e){var p=e[a[i][0]];if(m[p.n]=M1(t,p.t,{raw:!0}),p.p==="version"&&(m[p.n]=String(m[p.n]>>16)+"."+("0000"+String(m[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(m[p.n]){case 0:m[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Oi(o=m[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[p.n])}}else if(a[i][0]===1){if(o=m.CodePage=M1(t,qT),Oi(o),l!==-1){var v=t.l;t.l=a[l][1],u=C8(t,o),t.l=v}}else if(a[i][0]===0){if(o===0){l=i,t.l=a[i+1][1];continue}u=C8(t,o)}else{var _=u[a[i][0]],S;switch(t[t.l]){case 65:t.l+=4,S=uM(t);break;case 30:t.l+=4,S=Rb(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,S=Rb(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,S=t.read_shift(4,"i");break;case 19:t.l+=4,S=t.read_shift(4);break;case 5:t.l+=4,S=t.read_shift(8,"f");break;case 11:t.l+=4,S=En(t,4);break;case 64:t.l+=4,S=Hr(e4(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[_]=S}}return t.l=r+n,m}var dM=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Sse(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function N8(t,e,r){var n=Ye(8),s=[],a=[],i=8,o=0,l=Ye(8),u=Ye(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),a.push(l),s.push(u),i+=8+l.length,!e){u=Ye(8),u.write_shift(4,0),s.unshift(u);var d=[Ye(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=Ye(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=fs(d),a.unshift(l),i+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(dM.indexOf(t[o][0])>-1||nM.indexOf(t[o][0])>-1)&&t[o][1]!=null){var m=t[o][1],x=0;if(e){x=+e[t[o][0]];var p=r[x];if(p.p=="version"&&typeof m=="string"){var v=m.split(".");m=(+v[0]<<16)+(+v[1]||0)}l=T8(p.t,m)}else{var _=Sse(m);_==-1&&(_=31,m=String(m)),l=T8(_,m)}a.push(l),u=Ye(8),u.write_shift(4,e?x:2+o),s.push(u),i+=8+l.length}var S=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,S),S+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),fs([n].concat(s).concat(a))}function A8(t,e,r){var n=t.content;if(!n)return{};ws(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Dt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var h=E8(n,e),m={SystemIdentifier:u};for(var x in h)m[x]=h[x];if(m.FMTID=a,s===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var p;try{p=E8(n,null)}catch{}for(x in p)m[x]=p[x];return m.FMTID=[a,i],m}function F8(t,e,r,n,s,a){var i=Ye(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Dt.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,e,"hex"),i.write_shift(4,s?68:48);var l=N8(t,r,n);if(o.push(l),s){var u=N8(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+l.length),o.push(u)}return fs(o)}function jl(t,e){return t.read_shift(e),null}function bse(t,e){e||(e=Ye(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function kse(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function En(t,e){return t.read_shift(e)===1}function qs(t,e){return e||(e=Ye(2)),e.write_shift(2,+!!t),e}function $n(t){return t.read_shift(2,"u")}function si(t,e){return e||(e=Ye(2)),e.write_shift(2,t),e}function fM(t,e){return kse(t,e,$n)}function Cse(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function hM(t,e,r){return r||(r=Ye(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function cm(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?t.read_shift(n,s):"";return i}function Tse(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=t.read_shift(2)),n&&(o=t.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return s&&(t.l+=4*i),n&&(t.l+=o),l.t=d,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Ese(t){var e=t.t||"",r=Ye(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Ye(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return fs(s)}function Bu(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function um(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Bu(t,n,r)}function ld(t,e,r){if(r.biff>5)return um(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function gM(t,e,r){return r||(r=Ye(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Nse(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function Ase(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(sa,"");return n&&(t.l+=24),s}function Fse(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=t.read_shift(a>>1,"utf16le").replace(sa,"");return r+i}function jse(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Ase(t);case"0303000000000000c000000000000046":return Fse(t);default:throw new Error("Unsupported Moniker "+r)}}function Yp(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(sa,""):"";return r}function j8(t,e){e||(e=Ye(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function Pse(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,i,o,l,u="",d,h;s&16&&(a=Yp(t,r-t.l)),s&128&&(i=Yp(t,r-t.l)),(s&257)===257&&(o=Yp(t,r-t.l)),(s&257)===1&&(l=jse(t,r-t.l)),s&8&&(u=Yp(t,r-t.l)),s&32&&(d=t.read_shift(16)),s&64&&(h=e4(t)),t.l=r;var m=i||o||l||"";m&&u&&(m+="#"+u),m||(m="#"+u),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var x={Target:m};return d&&(x.guid=d),h&&(x.time=h),a&&(x.Tooltip=a),x}function Dse(t){var e=Ye(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)e.write_shift(4,i[r]);if(a==28)n=n.slice(1),j8(n,e);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)e.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),a&8&&j8(s>-1?n.slice(s+1):"",e)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)e.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function mM(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function pM(t,e){var r=mM(t);return r[3]=0,r}function No(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Uu(t,e,r,n){return n||(n=Ye(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function Rse(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function Ose(t,e,r){return e===0?"":ld(t,e,r)}function Mse(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),i=t.read_shift(n,"i");return[s,a,i]}function xM(t){var e=t.read_shift(2),r=QT(t);return[e,r]}function Lse(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=cm(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function Ev(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function yM(t,e){return e||(e=Ye(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function vM(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var Ise=vM;function wM(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function Bse(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Use(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Rs(t){t.l+=2,t.l+=t.read_shift(2)}var $se={0:Rs,4:Rs,5:Rs,6:Rs,7:Use,8:Rs,9:Rs,10:Rs,11:Rs,12:Rs,13:Bse,14:Rs,15:Rs,16:Rs,17:Rs,18:Rs,19:Rs,20:Rs,21:wM};function zse(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push($se[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Jp(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function t4(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Ye(s);return a.write_shift(2,n),a.write_shift(2,e),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Wse(t,e){return e===0||t.read_shift(2),1200}function Vse(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=ld(t,0,r);return t.read_shift(e+n-t.l),s}function Gse(t,e){var r=!e||e.biff==8,n=Ye(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Hse(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Kse(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=cm(t,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function Xse(t,e){var r=!e||e.biff>=8?2:1,n=Ye(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function Yse(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0;i!=s&&t.l<r;++i)a.push(Tse(t));return a.Count=n,a.Unique=s,a}function Jse(t,e){var r=Ye(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=Ese(t[s]);var a=fs([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function Qse(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function qse(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function Zse(t){var e=Rse(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function eae(t){return t.read_shift(2),t.read_shift(4)}function P8(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function tae(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function rae(){var t=Ye(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function nae(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function sae(t){var e=Ye(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function aae(){}function iae(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=cm(t,0,r),n}function oae(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,a=Ye(s);return a.write_shift(2,t.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function lae(t){var e=No(t);return e.isst=t.read_shift(4),e}function cae(t,e,r,n){var s=Ye(10);return Uu(t,e,n,s),s.write_shift(4,r),s}function uae(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=No(t);r.biff==2&&t.l++;var a=um(t,n-t.l,r);return s.val=a,s}function dae(t,e,r,n,s){var a=!s||s.biff==8,i=Ye(8+ +a+(1+a)*r.length);return Uu(t,e,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function fae(t,e,r){var n=t.read_shift(2),s=ld(t,0,r);return[n,s]}function hae(t,e,r,n){var s=r&&r.biff==5;n||(n=Ye(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var gae=ld;function D8(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function mae(t,e){var r=e.biff==8||!e.biff?4:2,n=Ye(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function pae(t){var e=t.read_shift(2),r=t.read_shift(2),n=xM(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function xae(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(xM(t));if(t.l!==r)throw new Error("MulRK read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function yae(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function vae(t,e,r,n){var s={},a=t.read_shift(4),i=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=Zne[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function wae(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=vae(t,e,n.fStyle,r),n}function R8(t,e,r,n){var s=r&&r.biff==5;n||(n=Ye(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function _ae(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Sae(t){var e=Ye(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function O8(t,e,r){var n=No(t);(r.biff==2||e==9)&&++t.l;var s=Cse(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function bae(t,e,r,n,s,a){var i=Ye(8);return Uu(t,e,n,i),hM(r,a,i),i}function kae(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=No(t),s=Us(t);return n.val=s,n}function Cae(t,e,r,n){var s=Ye(14);return Uu(t,e,n,s),Iu(r,s),s}var M8=Ose;function Tae(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Bu(t,a),o=[];n>t.l;)o.push(um(t));return[a,s,i,o]}function L8(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=Lse(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var Eae=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function I8(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=Bu(t,i,r);s&32&&(u=Eae[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var h=n==t.l||o===0||!(d>0)?[]:zce(t,d,r,o);return{chKey:a,Name:u,itab:l,rgce:h}}function _M(t,e,r){if(r.biff<8)return Nae(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(Mse(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function Nae(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=cm(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function Aae(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=Bu(t,n,r),i=Bu(t,s,r);return[a,i]}function Fae(t,e,r){var n=vM(t);t.l++;var s=t.read_shift(1);return e-=8,[Wce(t,e,r),s,n]}function B8(t,e,r){var n=Ise(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Uce(t,e,r)]}function jae(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function Pae(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=ld(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,i,a]}}function Dae(t,e,r){return Pae(t,e,r)}function Rae(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Ev(t));return r}function Oae(t){var e=Ye(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)yM(t[r],e);return e}function Mae(t,e,r){if(r&&r.biff<8)return Iae(t,e,r);var n=wM(t),s=zse(t,e-22,n[1]);return{cmo:n,ft:s}}var Lae={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function Iae(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var i=[];return i.push((Lae[n]||Hs)(t,e,r)),{cmo:[s,n,a],ft:i}}function Bae(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:i=Nse(t,6,r);var o=t.read_shift(2);t.read_shift(2),$n(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],h=Bu(t,t.lens[u+1]-t.lens[u]-1);if(s+=h,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function Uae(t,e){var r=Ev(t);t.l+=16;var n=Pse(t,e-24);return[r,n]}function $ae(t){var e=Ye(24),r=un(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return fs([e,Dse(t[1])])}function zae(t,e){t.read_shift(2);var r=Ev(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(sa,""),[r,n]}function Wae(t){var e=t[1].Tooltip,r=Ye(10+2*(e.length+1));r.write_shift(2,2048);var n=un(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function Vae(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=b8[r]||r,r=t.read_shift(2),e[1]=b8[r]||r,e}function Gae(t){return t||(t=Ye(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Hae(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(pM(t));return r}function Kae(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(pM(t));return r}function Xae(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function SM(t,e,r){if(!r.cellStyles)return Hs(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function Yae(t,e){var r=Ye(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Jae(t,e){var r={};return e<32||(t.l+=16,r.header=Us(t),r.footer=Us(t),t.l+=2),r}function Qae(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function qae(t){for(var e=Ye(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var Zae=No,eie=fM,tie=um;function rie(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function nie(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=No(t);++t.l;var s=ld(t,e-7,r);return n.t="str",n.val=s,n}function sie(t){var e=No(t);++t.l;var r=Us(t);return e.t="n",e.val=r,e}function aie(t,e,r){var n=Ye(15);return gm(n,t,e),n.write_shift(8,r,"f"),n}function iie(t){var e=No(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function oie(t,e,r){var n=Ye(9);return gm(n,t,e),n.write_shift(2,r),n}function lie(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function cie(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function uie(t,e,r){var n=t.l+e,s=No(t),a=t.read_shift(2),i=Bu(t,a,r);return t.l=n,s.t="str",s.val=i,s}var die=[2,3,48,49,131,139,140,245],Ob=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=kv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],d=uc(1);switch(l.type){case"base64":d=ja(La(o));break;case"binary":d=ja(o);break;case"buffer":case"array":d=o;break}ws(d,0);var h=d.read_shift(1),m=!!(h&136),x=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:x=!0,m=!0;break;case 49:x=!0,m=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,_=521;h==2&&(v=d.read_shift(2)),d.l+=3,h!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(_=d.read_shift(2));var S=d.read_shift(2),w=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=t[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var y=[],b={},E=Math.min(d.length,h==2?521:_-10-(x?264:0)),N=p?32:11;d.l<E&&d[d.l]!=13;)switch(b={},b.name=pg.utils.decode(w,d.slice(d.l,d.l+N)).replace(/[\u0000\r\n].*$/g,""),d.l+=N,b.type=String.fromCharCode(d.read_shift(1)),h!=2&&!p&&(b.offset=d.read_shift(4)),b.len=d.read_shift(1),h==2&&(b.offset=d.read_shift(2)),b.dec=d.read_shift(1),b.name.length&&y.push(b),h!=2&&(d.l+=p?13:14),b.type){case"B":(!x||b.len!=8)&&l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(d[d.l]!==13&&(d.l=_-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=_;var F=0,T=0;for(u[0]=[],T=0;T!=y.length;++T)u[0][T]=y[T].name;for(;v-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,u[++F]=[],T=0,T=0;T!=y.length;++T){var P=d.slice(d.l,d.l+y[T].len);d.l+=y[T].len,ws(P,0);var D=pg.utils.decode(w,P);switch(y[T].type){case"C":D.trim().length&&(u[F][T]=D.replace(/\s+$/,""));break;case"D":D.length===8?u[F][T]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):u[F][T]=D;break;case"F":u[F][T]=parseFloat(D.trim());break;case"+":case"I":u[F][T]=p?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":u[F][T]=!0;break;case"N":case"F":u[F][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[F][T]="##MEMO##"+(p?parseInt(D.trim(),10):P.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(u[F][T]=+D||0);break;case"@":u[F][T]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[F][T]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[F][T]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[F][T]=-P.read_shift(-8,"f");break;case"B":if(x&&y[T].len==8){u[F][T]=P.read_shift(8,"f");break}case"G":case"P":P.l+=y[T].len;break;case"0":if(y[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[T].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=y,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=fh(r(o,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function s(o,l){try{return Fc(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&Oi(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Sa(),h=B1(o,{header:1,raw:!0,cellDates:!0}),m=h[0],x=h.slice(1),p=o["!cols"]||[],v=0,_=0,S=0,w=1;for(v=0;v<m.length;++v){if(((p[v]||{}).DBF||{}).name){m[v]=p[v].DBF.name,++S;continue}if(m[v]!=null){if(++S,typeof m[v]=="number"&&(m[v]=m[v].toString(10)),typeof m[v]!="string")throw new Error("DBF Invalid column name "+m[v]+" |"+typeof m[v]+"|");if(m.indexOf(m[v])!==v){for(_=0;_<1024;++_)if(m.indexOf(m[v]+"_"+_)==-1){m[v]+="_"+_;break}}}}var y=_r(o["!ref"]),b=[],E=[],N=[];for(v=0;v<=y.e.c-y.s.c;++v){var F="",T="",P=0,D=[];for(_=0;_<x.length;++_)x[_][v]!=null&&D.push(x[_][v]);if(D.length==0||m[v]==null){b[v]="?";continue}for(_=0;_<D.length;++_){switch(typeof D[_]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=D[_]instanceof Date?"D":"C";break;default:T="C"}P=Math.max(P,String(D[_]).length),F=F&&F!=T?"C":T}P>250&&(P=250),T=((p[v]||{}).DBF||{}).type,T=="C"&&p[v].DBF.len>P&&(P=p[v].DBF.len),F=="B"&&T=="N"&&(F="N",N[v]=p[v].DBF.dec,P=p[v].DBF.len),E[v]=F=="C"||T=="N"?P:a[F]||0,w+=E[v],b[v]=F}var R=d.next(32);for(R.write_shift(4,318902576),R.write_shift(4,x.length),R.write_shift(2,296+32*S),R.write_shift(2,w),v=0;v<4;++v)R.write_shift(4,0);for(R.write_shift(4,0|(+e[dO]||3)<<8),v=0,_=0;v<m.length;++v)if(m[v]!=null){var I=d.next(32),W=(m[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,W,"sbcs"),I.write_shift(1,b[v]=="?"?"C":b[v],"sbcs"),I.write_shift(4,_),I.write_shift(1,E[v]||a[b[v]]||0),I.write_shift(1,N[v]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),_+=E[v]||a[b[v]]||0}var le=d.next(264);for(le.write_shift(4,13),v=0;v<65;++v)le.write_shift(4,0);for(v=0;v<x.length;++v){var q=d.next(w);for(q.write_shift(1,0),_=0;_<m.length;++_)if(m[_]!=null)switch(b[_]){case"L":q.write_shift(1,x[v][_]==null?63:x[v][_]?84:70);break;case"B":q.write_shift(8,x[v][_]||0,"f");break;case"N":var V="0";for(typeof x[v][_]=="number"&&(V=x[v][_].toFixed(N[_]||0)),S=0;S<E[_]-V.length;++S)q.write_shift(1,32);q.write_shift(1,V,"sbcs");break;case"D":x[v][_]?(q.write_shift(4,("0000"+x[v][_].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(x[v][_].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+x[v][_].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var K=String(x[v][_]!=null?x[v][_]:"").slice(0,E[_]);for(q.write_shift(1,K,"sbcs"),S=0;S<E[_]-K.length;++S)q.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),bM=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+bn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,x){var p=t[x];return typeof p=="number"?JA(p):p},n=function(m,x,p){var v=x.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return v==59?m:JA(v)};t["|"]=254;function s(m,x){switch(x.type){case"base64":return a(La(m),x);case"binary":return a(m,x);case"buffer":return a(ir&&Buffer.isBuffer(m)?m.toString("binary"):Ac(m),x);case"array":return a(Lu(m),x)}throw new Error("Unrecognized type "+x.type)}function a(m,x){var p=m.split(/[\n\r]+/),v=-1,_=-1,S=0,w=0,y=[],b=[],E=null,N={},F=[],T=[],P=[],D=0,R;for(+x.codepage>=0&&Oi(+x.codepage);S!==p.length;++S){D=0;var I=p[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),W=I.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),le=W[0],q;if(I.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":W[1].charAt(0)=="P"&&b.push(I.slice(3).replace(/;;/g,";"));break;case"C":var V=!1,K=!1,U=!1,L=!1,Z=-1,ne=-1;for(w=1;w<W.length;++w)switch(W[w].charAt(0)){case"A":break;case"X":_=parseInt(W[w].slice(1))-1,K=!0;break;case"Y":for(v=parseInt(W[w].slice(1))-1,K||(_=0),R=y.length;R<=v;++R)y[R]=[];break;case"K":q=W[w].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN($i(q))?isNaN(Uf(q).getDate())||(q=Hr(q)):(q=$i(q),E!==null&&uh(E)&&(q=Tv(q))),V=!0;break;case"E":L=!0;var z=yf(W[w].slice(1),{r:v,c:_});y[v][_]=[y[v][_],z];break;case"S":U=!0,y[v][_]=[y[v][_],"S5S"];break;case"G":break;case"R":Z=parseInt(W[w].slice(1))-1;break;case"C":ne=parseInt(W[w].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+I)}if(V&&(y[v][_]&&y[v][_].length==2?y[v][_][0]=q:y[v][_]=q,E=null),U){if(L)throw new Error("SYLK shared formula cannot have own formula");var Y=Z>-1&&y[Z][ne];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");y[v][_][1]=$M(Y[1],{r:v-Z,c:_-ne})}break;case"F":var J=0;for(w=1;w<W.length;++w)switch(W[w].charAt(0)){case"X":_=parseInt(W[w].slice(1))-1,++J;break;case"Y":for(v=parseInt(W[w].slice(1))-1,R=y.length;R<=v;++R)y[R]=[];break;case"M":D=parseInt(W[w].slice(1))/20;break;case"F":break;case"G":break;case"P":E=b[parseInt(W[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=W[w].slice(1).split(" "),R=parseInt(P[0],10);R<=parseInt(P[1],10);++R)D=parseInt(P[2],10),T[R-1]=D===0?{hidden:!0}:{wch:D},dc(T[R-1]);break;case"C":_=parseInt(W[w].slice(1))-1,T[_]||(T[_]={});break;case"R":v=parseInt(W[w].slice(1))-1,F[v]||(F[v]={}),D>0?(F[v].hpt=D,F[v].hpx=zf(D)):D===0&&(F[v].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+I)}J<1&&(E=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+I)}}return F.length>0&&(N["!rows"]=F),T.length>0&&(N["!cols"]=T),x&&x.sheetRows&&(y=y.slice(0,x.sheetRows)),[y,N]}function i(m,x){var p=s(m,x),v=p[0],_=p[1],S=fh(v,x);return bn(_).forEach(function(w){S[w]=_[w]}),S}function o(m,x){return Fc(i(m,x),x)}function l(m,x,p,v){var _="C;Y"+(p+1)+";X"+(v+1)+";K";switch(m.t){case"n":_+=m.v||0,m.f&&!m.F&&(_+=";E"+o4(m.f,{r:p,c:v}));break;case"b":_+=m.v?"TRUE":"FALSE";break;case"e":_+=m.w||m.v;break;case"d":_+='"'+(m.w||m.v)+'"';break;case"s":_+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function u(m,x){x.forEach(function(p,v){var _="F;W"+(v+1)+" "+(v+1)+" ";p.hidden?_+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=kg(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Cg(p.wpx)),typeof p.wch=="number"&&(_+=Math.round(p.wch))),_.charAt(_.length-1)!=" "&&m.push(_)})}function d(m,x){x.forEach(function(p,v){var _="F;";p.hidden?_+="M0;":p.hpt?_+="M"+20*p.hpt+";":p.hpx&&(_+="M"+20*Tg(p.hpx)+";"),_.length>2&&m.push(_+"R"+(v+1))})}function h(m,x){var p=["ID;PWXL;N;E"],v=[],_=_r(m["!ref"]),S,w=Array.isArray(m),y=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),m["!cols"]&&u(p,m["!cols"]),m["!rows"]&&d(p,m["!rows"]),p.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var b=_.s.r;b<=_.e.r;++b)for(var E=_.s.c;E<=_.e.c;++E){var N=Wt({r:b,c:E});S=w?(m[b]||[])[E]:m[N],!(!S||S.v==null&&(!S.f||S.F))&&v.push(l(S,m,b,E))}return p.join(y)+y+v.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),kM=function(){function t(a,i){switch(i.type){case"base64":return e(La(a),i);case"binary":return e(a,i);case"buffer":return e(ir&&Buffer.isBuffer(a)?a.toString("binary"):Ac(a),i);case"array":return e(Lu(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){for(var o=a.split(`
`),l=-1,u=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var m=o[d].trim().split(","),x=m[0],p=m[1];++d;for(var v=o[d]||"";(v.match(/["]/g)||[]).length&1&&d<o.length-1;)v+=`
`+o[++d];switch(v=v.trim(),+x){case-1:if(v==="BOT"){h[++l]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[l][u]=!0:v==="FALSE"?h[l][u]=!1:isNaN($i(p))?isNaN(Uf(p).getDate())?h[l][u]=p:h[l][u]=Hr(p):h[l][u]=$i(p),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[l][u++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return fh(t(a,i),i)}function n(a,i){return Fc(r(a,i),i)}var s=function(){var a=function(l,u,d,h,m){l.push(u),l.push(d+","+h),l.push('"'+m.replace(/"/g,'""')+'"')},i=function(l,u,d,h){l.push(u+","+d),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],d=_r(l["!ref"]),h,m=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var x=d.s.r;x<=d.e.r;++x){i(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var v=Wt({r:x,c:p});if(h=m?(l[x]||[])[p]:l[v],!h){i(u,1,0,"");continue}switch(h.t){case"n":var _=h.w;!_&&h.v!=null&&(_=h.v),_==null?h.f&&!h.F?i(u,1,0,"="+h.f):i(u,1,0,""):i(u,0,_,"V");break;case"b":i(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=yi(h.z||Bt[14],es(Hr(h.v)))),i(u,0,h.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var S=`\r
`,w=u.join(S);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),CM=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var x=h.split(`
`),p=-1,v=-1,_=0,S=[];_!==x.length;++_){var w=x[_].trim().split(":");if(w[0]==="cell"){var y=un(w[1]);if(S.length<=y.r)for(p=S.length;p<=y.r;++p)S[p]||(S[p]=[]);switch(p=y.r,v=y.c,w[2]){case"t":S[p][v]=t(w[3]);break;case"v":S[p][v]=+w[3];break;case"vtf":var b=w[w.length-1];case"vtc":switch(w[3]){case"nl":S[p][v]=!!+w[4];break;default:S[p][v]=+w[4];break}w[2]=="vtf"&&(S[p][v]=[S[p][v],b])}}}return m&&m.sheetRows&&(S=S.slice(0,m.sheetRows)),S}function n(h,m){return fh(r(h,m),m)}function s(h,m){return Fc(n(h,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var m=[],x=[],p,v="",_=ba(h["!ref"]),S=Array.isArray(h),w=_.s.r;w<=_.e.r;++w)for(var y=_.s.c;y<=_.e.c;++y)if(v=Wt({r:w,c:y}),p=S?(h[w]||[])[y]:h[v],!(!p||p.v==null||p.t==="z")){switch(x=["cell",v,"t"],p.t){case"s":case"str":x.push(e(p.v));break;case"n":p.f?(x[2]="vtf",x[3]="n",x[4]=p.v,x[5]=e(p.f)):(x[2]="v",x[3]=p.v);break;case"b":x[2]="vt"+(p.f?"f":"c"),x[3]="nl",x[4]=p.v?"1":"0",x[5]=e(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var b=es(Hr(p.v));x[2]="vtc",x[3]="nd",x[4]=""+b,x[5]=p.w||yi(p.z||Bt[14],b);break;case"e":continue}m.push(x.join(":"))}return m.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(h){return[a,i,o,i,u(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),$f=function(){function t(d,h,m,x,p){p.raw?h[m][x]=d:d===""||(d==="TRUE"?h[m][x]=!0:d==="FALSE"?h[m][x]=!1:isNaN($i(d))?isNaN(Uf(d).getDate())?h[m][x]=d:h[m][x]=Hr(d):h[m][x]=$i(d))}function e(d,h){var m=h||{},x=[];if(!d||d.length===0)return x;for(var p=d.split(/[\r\n]/),v=p.length-1;v>=0&&p[v].length===0;)--v;for(var _=10,S=0,w=0;w<=v;++w)S=p[w].indexOf(" "),S==-1?S=p[w].length:S++,_=Math.max(_,S);for(w=0;w<=v;++w){x[w]=[];var y=0;for(t(p[w].slice(0,_).trim(),x,w,y,m),y=1;y<=(p[w].length-_)/10+1;++y)t(p[w].slice(_+(y-1)*10,_+y*10).trim(),x,w,y,m)}return m.sheetRows&&(x=x.slice(0,m.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var h={},m=!1,x=0,p=0;x<d.length;++x)(p=d.charCodeAt(x))==34?m=!m:!m&&p in r&&(h[p]=(h[p]||0)+1);p=[];for(x in h)Object.prototype.hasOwnProperty.call(h,x)&&p.push([h[x],x]);if(!p.length){h=n;for(x in h)Object.prototype.hasOwnProperty.call(h,x)&&p.push([h[x],x])}return p.sort(function(v,_){return v[0]-_[0]||n[v[1]]-n[_[1]]}),r[p.pop()[1]]||44}function a(d,h){var m=h||{},x="",p=m.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(x=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(x=d.charAt(4),d=d.slice(6)):x=s(d.slice(0,1024)):m&&m.FS?x=m.FS:x=s(d.slice(0,1024));var _=0,S=0,w=0,y=0,b=0,E=x.charCodeAt(0),N=!1,F=0,T=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var P=m.dateNF!=null?Qre(m.dateNF):null;function D(){var R=d.slice(y,b),I={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)I.t="z";else if(m.raw)I.t="s",I.v=R;else if(R.trim().length===0)I.t="s",I.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(I.t="s",I.v=R.slice(2,-1).replace(/""/g,'"')):Tle(R)?(I.t="n",I.f=R.slice(1)):(I.t="s",I.v=R);else if(R=="TRUE")I.t="b",I.v=!0;else if(R=="FALSE")I.t="b",I.v=!1;else if(!isNaN(w=$i(R)))I.t="n",m.cellText!==!1&&(I.w=R),I.v=w;else if(!isNaN(Uf(R).getDate())||P&&R.match(P)){I.z=m.dateNF||Bt[14];var W=0;P&&R.match(P)&&(R=qre(R,m.dateNF,R.match(P)||[]),W=1),m.cellDates?(I.t="d",I.v=Hr(R,W)):(I.t="n",I.v=es(Hr(R,W))),m.cellText!==!1&&(I.w=yi(I.z,I.v instanceof Date?es(I.v):I.v)),m.cellNF||delete I.z}else I.t="s",I.v=R;if(I.t=="z"||(m.dense?(p[_]||(p[_]=[]),p[_][S]=I):p[Wt({c:S,r:_})]=I),y=b+1,T=d.charCodeAt(y),v.e.c<S&&(v.e.c=S),v.e.r<_&&(v.e.r=_),F==E)++S;else if(S=0,++_,m.sheetRows&&m.sheetRows<=_)return!0}e:for(;b<d.length;++b)switch(F=d.charCodeAt(b)){case 34:T===34&&(N=!N);break;case E:case 10:case 13:if(!N&&D())break e;break}return b-y>0&&D(),p["!ref"]=er(v),p}function i(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,h):fh(e(d,h),h)}function o(d,h){var m="",x=h.type=="string"?[0,0,0,0]:m4(d,h);switch(h.type){case"base64":m=La(d);break;case"binary":m=d;break;case"buffer":h.codepage==65001?m=d.toString("utf8"):h.codepage&&typeof pg<"u"||(m=ir&&Buffer.isBuffer(d)?d.toString("binary"):Ac(d));break;case"array":m=Lu(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+h.type)}return x[0]==239&&x[1]==187&&x[2]==191?m=Mr(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=Mr(m):h.type=="binary"&&typeof pg<"u",m.slice(0,19)=="socialcalc:version:"?CM.to_sheet(h.type=="string"?m:Mr(m),h):i(m,h)}function l(d,h){return Fc(o(d,h),h)}function u(d){for(var h=[],m=_r(d["!ref"]),x,p=Array.isArray(d),v=m.s.r;v<=m.e.r;++v){for(var _=[],S=m.s.c;S<=m.e.c;++S){var w=Wt({r:v,c:S});if(x=p?(d[v]||[])[S]:d[w],!x||x.v==null){_.push("          ");continue}for(var y=(x.w||(ul(x),x.w)||"").slice(0,10);y.length<10;)y+=" ";_.push(y+(S===0?" ":""))}h.push(_.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function fie(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=bM.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return $f.to_workbook(t,e)}}var pu=function(){function t(z,Y,J){if(z){ws(z,z.l||0);for(var te=J.Enum||Z;z.l<z.length;){var de=z.read_shift(2),ee=te[de]||te[65535],ge=z.read_shift(2),fe=z.l+ge,ye=ee.f&&ee.f(z,ge,J);if(z.l=fe,Y(ye,ee,de))return}}}function e(z,Y){switch(Y.type){case"base64":return r(ja(La(z)),Y);case"binary":return r(ja(z),Y);case"buffer":case"array":return r(z,Y)}throw"Unsupported type "+Y.type}function r(z,Y){if(!z)return z;var J=Y||{},te=J.dense?[]:{},de="Sheet1",ee="",ge=0,fe={},ye=[],Ce=[],re={s:{r:0,c:0},e:{r:0,c:0}},ve=J.sheetRows||0;if(z[2]==0&&(z[3]==8||z[3]==9)&&z.length>=16&&z[14]==5&&z[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(z[2]==2)J.Enum=Z,t(z,function(Re,xt,$t){switch($t){case 0:J.vers=Re,Re>=4096&&(J.qpro=!0);break;case 6:re=Re;break;case 204:Re&&(ee=Re);break;case 222:ee=Re;break;case 15:case 51:J.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:$t==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=J.dateNF||Bt[14],J.cellDates&&(Re[1].t="d",Re[1].v=Tv(Re[1].v))),J.qpro&&Re[3]>ge&&(te["!ref"]=er(re),fe[de]=te,ye.push(de),te=J.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},ge=Re[3],de=ee||"Sheet"+(ge+1),ee="");var Ae=J.dense?(te[Re[0].r]||[])[Re[0].c]:te[Wt(Re[0])];if(Ae){Ae.t=Re[1].t,Ae.v=Re[1].v,Re[1].z!=null&&(Ae.z=Re[1].z),Re[1].f!=null&&(Ae.f=Re[1].f);break}J.dense?(te[Re[0].r]||(te[Re[0].r]=[]),te[Re[0].r][Re[0].c]=Re[1]):te[Wt(Re[0])]=Re[1];break}},J);else if(z[2]==26||z[2]==14)J.Enum=ne,z[2]==14&&(J.qpro=!0,z.l=0),t(z,function(Re,xt,$t){switch($t){case 204:de=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>ge&&(te["!ref"]=er(re),fe[de]=te,ye.push(de),te=J.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},ge=Re[3],de="Sheet"+(ge+1)),ve>0&&Re[0].r>=ve)break;J.dense?(te[Re[0].r]||(te[Re[0].r]=[]),te[Re[0].r][Re[0].c]=Re[1]):te[Wt(Re[0])]=Re[1],re.e.c<Re[0].c&&(re.e.c=Re[0].c),re.e.r<Re[0].r&&(re.e.r=Re[0].r);break;case 27:Re[14e3]&&(Ce[Re[14e3][0]]=Re[14e3][1]);break;case 1537:Ce[Re[0]]=Re[1],Re[0]==ge&&(de=Re[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+z[2]);if(te["!ref"]=er(re),fe[ee||de]=te,ye.push(ee||de),!Ce.length)return{SheetNames:ye,Sheets:fe};for(var we={},Oe=[],Ze=0;Ze<Ce.length;++Ze)fe[ye[Ze]]?(Oe.push(Ce[Ze]||ye[Ze]),we[Ce[Ze]]=fe[Ce[Ze]]||fe[ye[Ze]]):(Oe.push(Ce[Ze]),we[Ce[Ze]]={"!ref":"A1"});return{SheetNames:Oe,Sheets:we}}function n(z,Y){var J=Y||{};if(+J.codepage>=0&&Oi(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var te=Sa(),de=_r(z["!ref"]),ee=Array.isArray(z),ge=[];ft(te,0,a(1030)),ft(te,6,l(de));for(var fe=Math.min(de.e.r,8191),ye=de.s.r;ye<=fe;++ye)for(var Ce=Pn(ye),re=de.s.c;re<=de.e.c;++re){ye===de.s.r&&(ge[re]=cn(re));var ve=ge[re]+Ce,we=ee?(z[ye]||[])[re]:z[ve];if(!(!we||we.t=="z"))if(we.t=="n")(we.v|0)==we.v&&we.v>=-32768&&we.v<=32767?ft(te,13,x(ye,re,we.v)):ft(te,14,v(ye,re,we.v));else{var Oe=ul(we);ft(te,15,h(ye,re,Oe.slice(0,239)))}}return ft(te,1),te.end()}function s(z,Y){var J=Y||{};if(+J.codepage>=0&&Oi(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var te=Sa();ft(te,0,i(z));for(var de=0,ee=0;de<z.SheetNames.length;++de)(z.Sheets[z.SheetNames[de]]||{})["!ref"]&&ft(te,27,L(z.SheetNames[de],ee++));var ge=0;for(de=0;de<z.SheetNames.length;++de){var fe=z.Sheets[z.SheetNames[de]];if(!(!fe||!fe["!ref"])){for(var ye=_r(fe["!ref"]),Ce=Array.isArray(fe),re=[],ve=Math.min(ye.e.r,8191),we=ye.s.r;we<=ve;++we)for(var Oe=Pn(we),Ze=ye.s.c;Ze<=ye.e.c;++Ze){we===ye.s.r&&(re[Ze]=cn(Ze));var Re=re[Ze]+Oe,xt=Ce?(fe[we]||[])[Ze]:fe[Re];if(!(!xt||xt.t=="z"))if(xt.t=="n")ft(te,23,D(we,Ze,ge,xt.v));else{var $t=ul(xt);ft(te,22,F(we,Ze,ge,$t.slice(0,239)))}}++ge}}return ft(te,1),te.end()}function a(z){var Y=Ye(2);return Y.write_shift(2,z),Y}function i(z){var Y=Ye(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var J=0,te=0,de=0,ee=0;ee<z.SheetNames.length;++ee){var ge=z.SheetNames[ee],fe=z.Sheets[ge];if(!(!fe||!fe["!ref"])){++de;var ye=ba(fe["!ref"]);J<ye.e.r&&(J=ye.e.r),te<ye.e.c&&(te=ye.e.c)}}return J>8191&&(J=8191),Y.write_shift(2,J),Y.write_shift(1,de),Y.write_shift(1,te),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function o(z,Y,J){var te={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&J.qpro?(te.s.c=z.read_shift(1),z.l++,te.s.r=z.read_shift(2),te.e.c=z.read_shift(1),z.l++,te.e.r=z.read_shift(2),te):(te.s.c=z.read_shift(2),te.s.r=z.read_shift(2),Y==12&&J.qpro&&(z.l+=2),te.e.c=z.read_shift(2),te.e.r=z.read_shift(2),Y==12&&J.qpro&&(z.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function l(z){var Y=Ye(8);return Y.write_shift(2,z.s.c),Y.write_shift(2,z.s.r),Y.write_shift(2,z.e.c),Y.write_shift(2,z.e.r),Y}function u(z,Y,J){var te=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(te[0].c=z.read_shift(1),te[3]=z.read_shift(1),te[0].r=z.read_shift(2),z.l+=2):(te[2]=z.read_shift(1),te[0].c=z.read_shift(2),te[0].r=z.read_shift(2)),te}function d(z,Y,J){var te=z.l+Y,de=u(z,Y,J);if(de[1].t="s",J.vers==20768){z.l++;var ee=z.read_shift(1);return de[1].v=z.read_shift(ee,"utf8"),de}return J.qpro&&z.l++,de[1].v=z.read_shift(te-z.l,"cstr"),de}function h(z,Y,J){var te=Ye(7+J.length);te.write_shift(1,255),te.write_shift(2,Y),te.write_shift(2,z),te.write_shift(1,39);for(var de=0;de<te.length;++de){var ee=J.charCodeAt(de);te.write_shift(1,ee>=128?95:ee)}return te.write_shift(1,0),te}function m(z,Y,J){var te=u(z,Y,J);return te[1].v=z.read_shift(2,"i"),te}function x(z,Y,J){var te=Ye(7);return te.write_shift(1,255),te.write_shift(2,Y),te.write_shift(2,z),te.write_shift(2,J,"i"),te}function p(z,Y,J){var te=u(z,Y,J);return te[1].v=z.read_shift(8,"f"),te}function v(z,Y,J){var te=Ye(13);return te.write_shift(1,255),te.write_shift(2,Y),te.write_shift(2,z),te.write_shift(8,J,"f"),te}function _(z,Y,J){var te=z.l+Y,de=u(z,Y,J);if(de[1].v=z.read_shift(8,"f"),J.qpro)z.l=te;else{var ee=z.read_shift(2);b(z.slice(z.l,z.l+ee),de),z.l+=ee}return de}function S(z,Y,J){var te=Y&32768;return Y&=-32769,Y=(te?z:0)+(Y>=8192?Y-16384:Y),(te?"":"$")+(J?cn(Y):Pn(Y))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(z,Y){ws(z,0);for(var J=[],te=0,de="",ee="",ge="",fe="";z.l<z.length;){var ye=z[z.l++];switch(ye){case 0:J.push(z.read_shift(8,"f"));break;case 1:ee=S(Y[0].c,z.read_shift(2),!0),de=S(Y[0].r,z.read_shift(2),!1),J.push(ee+de);break;case 2:{var Ce=S(Y[0].c,z.read_shift(2),!0),re=S(Y[0].r,z.read_shift(2),!1);ee=S(Y[0].c,z.read_shift(2),!0),de=S(Y[0].r,z.read_shift(2),!1),J.push(Ce+re+":"+ee+de)}break;case 3:if(z.l<z.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(z.read_shift(2));break;case 6:{for(var ve="";ye=z[z.l++];)ve+=String.fromCharCode(ye);J.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:fe=J.pop(),ge=J.pop(),J.push(["AND","OR"][ye-20]+"("+ge+","+fe+")");break;default:if(ye<32&&y[ye])fe=J.pop(),ge=J.pop(),J.push(ge+y[ye]+fe);else if(w[ye]){if(te=w[ye][1],te==69&&(te=z[z.l++]),te>J.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+J.join("|")+"|");return}var we=J.slice(-te);J.length-=te,J.push(w[ye][0]+"("+we.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}J.length==1?Y[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function E(z){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=z.read_shift(2),Y[3]=z[z.l++],Y[0].c=z[z.l++],Y}function N(z,Y){var J=E(z);return J[1].t="s",J[1].v=z.read_shift(Y-4,"cstr"),J}function F(z,Y,J,te){var de=Ye(6+te.length);de.write_shift(2,z),de.write_shift(1,J),de.write_shift(1,Y),de.write_shift(1,39);for(var ee=0;ee<te.length;++ee){var ge=te.charCodeAt(ee);de.write_shift(1,ge>=128?95:ge)}return de.write_shift(1,0),de}function T(z,Y){var J=E(z);J[1].v=z.read_shift(2);var te=J[1].v>>1;if(J[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return J[1].v=te,J}function P(z,Y){var J=E(z),te=z.read_shift(4),de=z.read_shift(4),ee=z.read_shift(2);if(ee==65535)return te===0&&de===3221225472?(J[1].t="e",J[1].v=15):te===0&&de===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var ge=ee&32768;return ee=(ee&32767)-16446,J[1].v=(1-ge*2)*(de*Math.pow(2,ee+32)+te*Math.pow(2,ee)),J}function D(z,Y,J,te){var de=Ye(14);if(de.write_shift(2,z),de.write_shift(1,J),de.write_shift(1,Y),te==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var ee=0,ge=0,fe=0,ye=0;return te<0&&(ee=1,te=-te),ge=Math.log2(te)|0,te/=Math.pow(2,ge-31),ye=te>>>0,ye&2147483648||(te/=2,++ge,ye=te>>>0),te-=ye,ye|=2147483648,ye>>>=0,te*=Math.pow(2,32),fe=te>>>0,de.write_shift(4,fe),de.write_shift(4,ye),ge+=16383+(ee?32768:0),de.write_shift(2,ge),de}function R(z,Y){var J=P(z);return z.l+=Y-14,J}function I(z,Y){var J=E(z),te=z.read_shift(4);return J[1].v=te>>6,J}function W(z,Y){var J=E(z),te=z.read_shift(8,"f");return J[1].v=te,J}function le(z,Y){var J=W(z);return z.l+=Y-10,J}function q(z,Y){return z[z.l+Y-1]==0?z.read_shift(Y,"cstr"):""}function V(z,Y){var J=z[z.l++];J>Y-1&&(J=Y-1);for(var te="";te.length<J;)te+=String.fromCharCode(z[z.l++]);return te}function K(z,Y,J){if(!(!J.qpro||Y<21)){var te=z.read_shift(1);z.l+=17,z.l+=1,z.l+=2;var de=z.read_shift(Y-21,"cstr");return[te,de]}}function U(z,Y){for(var J={},te=z.l+Y;z.l<te;){var de=z.read_shift(2);if(de==14e3){for(J[de]=[0,""],J[de][0]=z.read_shift(2);z[z.l];)J[de][1]+=String.fromCharCode(z[z.l]),z.l++;z.l++}}return J}function L(z,Y){var J=Ye(5+z.length);J.write_shift(2,14e3),J.write_shift(2,Y);for(var te=0;te<z.length;++te){var de=z.charCodeAt(te);J[J.l++]=de>127?95:de}return J[J.l++]=0,J}var Z={0:{n:"BOF",f:$n},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:V},65535:{n:""}},ne={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:U},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:W},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:K},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function hie(t){var e={},r=t.match(Xs),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Ht(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=PT[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var gie=function(){var t=vg("t"),e=vg("rPr");function r(a){var i=a.match(t);if(!i)return{t:"s",v:""};var o={t:"s",v:wr(i[1])},l=a.match(e);return l&&(o.s=hie(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),mie=function(){var e=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),pie=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,xie=/<(?:\w+:)?r>/,yie=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function r4(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=wr(Mr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Mr(t),r&&(n.h=zT(n.t))):t.match(xie)&&(n.r=Mr(t),n.t=wr(Mr((t.replace(yie,"").match(pie)||[]).join("").replace(Xs,""))),r&&(n.h=mie(gie(n.r)))),n):{t:""}}var vie=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,wie=/<(?:\w+:)?(?:si|sstItem)>/g,_ie=/<\/(?:\w+:)?(?:si|sstItem)>/;function Sie(t,e){var r=[],n="";if(!t)return r;var s=t.match(vie);if(s){n=s[2].replace(wie,"").split(_ie);for(var a=0;a!=n.length;++a){var i=r4(n[a].trim(),e);i!=null&&(r[r.length]=i)}s=Ht(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var bie=/^\s|\s$|[\t\n\r]/;function TM(t,e){if(!e.bookSST)return"";var r=[On];r[r.length]=dt("sst",null,{xmlns:nd[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(bie)&&(a+=' xml:space="preserve"'),a+=">"+Dr(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function kie(t){return[t.read_shift(4),t.read_shift(4)]}function Cie(t,e){var r=[],n=!1;return vl(t,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Tie(t,e){return e||(e=Ye(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Eie=Lne;function Nie(t){var e=Sa();tt(e,159,Tie(t));for(var r=0;r<t.length;++r)tt(e,19,Eie(t[r]));return tt(e,160),e.end()}function EM(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function tl(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Aie(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=tl(t,4),e.U=tl(t,4),e.W=tl(t,4),e}function Fie(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function jie(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Fie(t));return e}function Pie(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Die(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=tl(t,4),e.U=tl(t,4),e.W=tl(t,4),e}function Rie(t){var e=Die(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function NM(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function AM(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Oie(t){var e=tl(t);switch(e.Minor){case 2:return[e.Minor,Mie(t)];case 3:return[e.Minor,Lie()];case 4:return[e.Minor,Iie(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Mie(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=NM(t,r),s=AM(t,t.length-t.l);return{t:"Std",h:n,v:s}}function Lie(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Iie(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Xs,function(a){var i=Ht(a);switch(Eo(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Bie(t,e){var r={},n=r.EncryptionVersionInfo=tl(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=NM(t,s),e-=s,r.EncryptionVerifier=AM(t,e),r}function Uie(t){var e={},r=e.EncryptionVersionInfo=tl(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function n4(t){var e=0,r,n=EM(t),s=n.length+1,a,i,o,l,u;for(r=uc(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^i;return e^52811}var FM=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=e[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var d=i[u],h=0;h!=7;++h)d&64&&(o^=r[l]),d*=2,--l;return o};return function(i){for(var o=EM(i),l=a(o),u=o.length,d=uc(16),h=0;h!=16;++h)d[h]=0;var m,x,p;for((u&1)===1&&(m=l>>8,d[u]=s(t[0],m),--u,m=l&255,x=o[o.length-1],d[u]=s(x,m));u>0;)--u,m=l>>8,d[u]=s(o[u],m),--u,m=l&255,d[u]=s(o[u],m);for(u=15,p=15-o.length;p>0;)m=l>>8,d[u]=s(t[p],m),--u,--p,m=l&255,d[u]=s(o[u],m),--u,--p;return d}}(),$ie=function(t,e,r,n,s){s||(s=e),n||(n=FM(t));var a,i;for(a=0;a!=e.length;++a)i=e[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},zie=function(t){var e=0,r=FM(t);return function(n){var s=$ie("",n,e,r);return e=s[1],s[0]}};function Wie(t,e,r,n){var s={key:$n(t),verificationBytes:$n(t)};return r.password&&(s.verifier=n4(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=zie(r.password)),s}function Vie(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Uie(t):n.Data=Bie(t,e),n}function Gie(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Vie(t,e-2,n):Wie(t,r.biff>=8?e:e-2,r,n),n}var jM=function(){function t(s,a){switch(a.type){case"base64":return e(La(s),a);case"binary":return e(s,a);case"buffer":return e(ir&&Buffer.isBuffer(s)?s.toString("binary"):Ac(s),a);case"array":return e(Lu(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,x=0,p,v=-1;p=m.exec(d);){switch(p[0]){case"\\cell":var _=d.slice(x,m.lastIndex-p[0].length);if(_[0]==" "&&(_=_.slice(1)),++v,_.length){var S={v:_,t:"s"};Array.isArray(o)?o[h][v]=S:o[Wt({r:h,c:v})]=S}break}x=m.lastIndex}v>u.e.c&&(u.e.c=v)}),o["!ref"]=er(u),o}function r(s,a){return Fc(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=_r(s["!ref"]),o,l=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var h=Wt({r:u,c:d});o=l?(s[u]||[])[d]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(ul(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Hie(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function bg(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Kie(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),i=s-a;if(i===0)return[0,0,e];var o=0,l=0,u=s+a;switch(l=i/(u>1?2-u:u),s){case e:o=((r-n)/i+6)%6;break;case r:o=(n-e)/i+2;break;case n:o=(e-r)/i+4;break}return[o/6,l,u/2]}function Xie(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function L1(t,e){if(e===0)return t;var r=Kie(Hie(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),bg(Xie(r))}var PM=6,Yie=15,Jie=1,Bs=PM;function kg(t){return Math.floor((t+Math.round(128/Bs)/256)*Bs)}function Cg(t){return Math.floor((t-5)/Bs*100+.5)/100}function I1(t){return Math.round((t*Bs+5)/Bs*256)/256}function c_(t){return I1(Cg(kg(t)))}function s4(t){var e=Math.abs(t-c_(t)),r=Bs;if(e>.005)for(Bs=Jie;Bs<Yie;++Bs)Math.abs(t-c_(t))<=e&&(e=Math.abs(t-c_(t)),r=Bs);Bs=r}function dc(t){t.width?(t.wpx=kg(t.width),t.wch=Cg(t.wpx),t.MDW=Bs):t.wpx?(t.wch=Cg(t.wpx),t.width=I1(t.wch),t.MDW=Bs):typeof t.wch=="number"&&(t.width=I1(t.wch),t.wpx=kg(t.width),t.MDW=Bs),t.customWidth&&delete t.customWidth}var Qie=96,DM=Qie;function Tg(t){return t*96/DM}function zf(t){return t*DM/96}var qie={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Zie(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(Xs)||[]).forEach(function(i){var o=Ht(i);switch(Eo(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Wr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Wr(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function eoe(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(Xs)||[]).forEach(function(i){var o=Ht(i);switch(Eo(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function toe(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(Xs)||[]).forEach(function(i){var o=Ht(i);switch(Eo(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Mr(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Wr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Wr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Wr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Wr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Wr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Wr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Wr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=PT[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Wr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=gu[s.color.index];s.color.index==81&&(l=gu[1]),l||(l=gu[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=L1(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function roe(t,e,r){e.NumberFmt=[];for(var n=bn(Bt),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Bt[n[s]];var a=t[0].match(Xs);if(a)for(s=0;s<a.length;++s){var i=Ht(a[s]);switch(Eo(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=wr(Mr(i.formatCode)),l=parseInt(i.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}el(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function noe(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=dt("numFmt",null,{numFmtId:n,formatCode:Dr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=dt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Qp=["numFmtId","fillId","fontId","borderId","xfId"],qp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function soe(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Xs)||[]).forEach(function(a){var i=Ht(a),o=0;switch(Eo(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Qp.length;++o)n[Qp[o]]&&(n[Qp[o]]=parseInt(n[Qp[o]],10));for(o=0;o<qp.length;++o)n[qp[o]]&&(n[qp[o]]=Wr(n[qp[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Wr(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function aoe(t){var e=[];return e[e.length]=dt("cellXfs",null),t.forEach(function(r){e[e.length]=dt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=dt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var ioe=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&roe(h,d,u),(h=o.match(s))&&toe(h,d,l,u),(h=o.match(n))&&eoe(h,d,l,u),(h=o.match(a))&&Zie(h,d,l,u),(h=o.match(r))&&soe(h,d,u),d}}();function RM(t,e){var r=[On,dt("styleSheet",null,{xmlns:nd[0],"xmlns:vt":Qn.vt})],n;return t.SSF&&(n=noe(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=aoe(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ooe(t,e){var r=t.read_shift(2),n=Ws(t);return[r,n]}function loe(t,e,r){r||(r=Ye(6+4*e.length)),r.write_shift(2,t),hs(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function coe(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=Vne(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=t.read_shift(1);i!=0&&(n.underline=i);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Wne(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ws(t),n}function uoe(t,e){e||(e=Ye(25+4*32)),e.write_shift(2,t.sz*20),Gne(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),R1(t.color,e);var n=0;return n=2,e.write_shift(1,n),hs(t.name,e),e.length>e.l?e.slice(0,e.l):e}var doe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],u_,foe=Hs;function U8(t,e){e||(e=Ye(4*3+8*7+16*1)),u_||(u_=kv(doe));var r=u_[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(R1({auto:1},e),R1({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function hoe(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function OM(t,e,r){r||(r=Ye(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Yh(t,e){return e||(e=Ye(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var goe=Hs;function moe(t,e){return e||(e=Ye(51)),e.write_shift(1,0),Yh(null,e),Yh(null,e),Yh(null,e),Yh(null,e),Yh(null,e),e.length>e.l?e.slice(0,e.l):e}function poe(t,e){return e||(e=Ye(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),D1(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function xoe(t,e,r){var n=Ye(2052);return n.write_shift(4,t),D1(e,n),D1(r,n),n.length>n.l?n.slice(0,n.l):n}function yoe(t,e,r){var n={};n.NumberFmt=[];for(var s in Bt)n.NumberFmt[s]=Bt[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return vl(t,function(l,u,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],el(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=L1(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function voe(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(tt(t,615,zi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&tt(t,44,loe(s,e[s]))}),tt(t,616))}}function woe(t){var e=1;tt(t,611,zi(e)),tt(t,43,uoe({sz:12,color:{theme:1},name:"Calibri",family:2})),tt(t,612)}function _oe(t){var e=2;tt(t,603,zi(e)),tt(t,45,U8({patternType:"none"})),tt(t,45,U8({patternType:"gray125"})),tt(t,604)}function Soe(t){var e=1;tt(t,613,zi(e)),tt(t,46,moe()),tt(t,614)}function boe(t){var e=1;tt(t,626,zi(e)),tt(t,47,OM({numFmtId:0},65535)),tt(t,627)}function koe(t,e){tt(t,617,zi(e.length)),e.forEach(function(r){tt(t,47,OM(r,0))}),tt(t,618)}function Coe(t){var e=1;tt(t,619,zi(e)),tt(t,48,poe({xfId:0,name:"Normal"})),tt(t,620)}function Toe(t){var e=0;tt(t,505,zi(e)),tt(t,506)}function Eoe(t){var e=0;tt(t,508,xoe(e,"TableStyleMedium9","PivotStyleMedium4")),tt(t,509)}function Noe(t,e){var r=Sa();return tt(r,278),voe(r,t.SSF),woe(r),_oe(r),Soe(r),boe(r),koe(r,e.cellXfs),Coe(r),Toe(r),Eoe(r),tt(r,279),r.end()}var Aoe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Foe(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Xs)||[]).forEach(function(s){var a=Ht(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[Aoe.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function joe(){}function Poe(){}var Doe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Roe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Ooe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Moe(t,e,r){e.themeElements={};var n;[["clrScheme",Doe,Foe],["fontScheme",Roe,joe],["fmtScheme",Ooe,Poe]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var Loe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function MM(t,e){(!t||t.length===0)&&(t=a4());var r,n={};if(!(r=t.match(Loe)))throw new Error("themeElements not found in theme");return Moe(r[0],n,e),n.raw=t,n}function a4(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[On];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Ioe(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var i;try{i=NO(a,{type:"array"})}catch{return}var o=Pa(i,"theme/theme/theme1.xml",!0);if(o)return MM(o,r)}}function Boe(t){return t.read_shift(4)}function Uoe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=$oe(t,4);break;case 2:e.xclrValue=mM(t);break;case 3:e.xclrValue=Boe(t);break;case 4:t.l+=4;break}return t.l+=8,e}function $oe(t,e){return Hs(t,e)}function zoe(t,e){return Hs(t,e)}function Woe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Uoe(t);break;case 6:n[1]=zoe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Voe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(Woe(t,r-t.l));return{ixfe:n,ext:a}}function Goe(t,e){e.forEach(function(r){switch(r[0]){}})}function Hoe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ws(t)}}function Koe(t){var e=Ye(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),hs(t.name,e),e.slice(0,e.l)}function Xoe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Yoe(t){var e=Ye(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function Joe(t,e){var r=Ye(8+2*e.length);return r.write_shift(4,t),hs(e,r),r.slice(0,r.l)}function Qoe(t){return t.l+=4,t.read_shift(4)!=0}function qoe(t,e){var r=Ye(8);return r.write_shift(4,t),r.write_shift(4,1),r}function Zoe(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return vl(t,function(l,u,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function ele(){var t=Sa();return tt(t,332),tt(t,334,zi(1)),tt(t,335,Koe({name:"XLDAPR",version:12e4,flags:3496657072})),tt(t,336),tt(t,339,Joe(1,"XLDAPR")),tt(t,52),tt(t,35,zi(514)),tt(t,4096,zi(0)),tt(t,4097,si(1)),tt(t,36),tt(t,53),tt(t,340),tt(t,337,qoe(1)),tt(t,51,Yoe([[1,0]])),tt(t,338),tt(t,333),t.end()}function tle(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,i;return t.replace(Xs,function(o){var l=Ht(o);switch(Eo(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function LM(){var t=[On];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function rle(t){var e=[];if(!t)return e;var r=1;return(t.match(Xs)||[]).forEach(function(n){var s=Ht(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function nle(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Wt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function sle(t,e,r){var n=[];return vl(t,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function ale(t,e,r,n){if(!t)return t;var s=n||{},a=!1;vl(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function ile(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var rf=1024;function IM(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[dt("xml",null,{"xmlns:v":Aa.v,"xmlns:o":Aa.o,"xmlns:x":Aa.x,"xmlns:mv":Aa.mv}).replace(/\/>/,">"),dt("o:shapelayout",dt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),dt("v:shapetype",[dt("v:stroke",null,{joinstyle:"miter"}),dt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];rf<t*1e3;)rf+=1e3;return e.forEach(function(a){var i=un(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?dt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=dt("v:fill",l,o),d={on:"t",obscured:"t"};++rf,s=s.concat(["<v:shape"+wg({id:"_x0000_s"+rf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,dt("v:shadow",null,d),dt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",bs("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),bs("x:AutoFill","False"),bs("x:Row",String(i.r)),bs("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function $8(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(i){var o=un(i.ref);if(s?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[i.ref],!a){a={t:"z"},s?t[o.r][o.c]=a:t[i.ref]=a;var l=_r(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=er(l);u!==t["!ref"]&&(t["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}a.c.push(d)})}function ole(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ht(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=un(l.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&r4(h[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function BM(t){var e=[On,dt("comments",null,{xmlns:nd[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var a=Dr(s.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(Dr(l.a))),a.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)e.push(bs("t",Dr(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;e.push(bs("t",Dr(i)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function lle(t,e){var r=[],n=!1,s={},a=0;return t.replace(Xs,function(o,l){var u=Ht(o);switch(Eo(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function cle(t,e,r){var n=[On,dt("ThreadedComments",null,{xmlns:Qn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&e.indexOf(i.a)==-1&&e.push(i.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(i.a)).slice(-12)+"}"),n.push(dt("threadedComment",bs("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function ule(t,e){var r=[],n=!1;return t.replace(Xs,function(a){var i=Ht(a);switch(Eo(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function dle(t){var e=[On,dt("personList",null,{xmlns:Qn.TCMNT,"xmlns:x":nd[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(dt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function fle(t){var e={};e.iauthor=t.read_shift(4);var r=od(t);return e.rfx=r.s,e.ref=Wt(r.s),t.l+=16,e}function hle(t,e){return e==null&&(e=Ye(36)),e.write_shift(4,t[1].iauthor),hh(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var gle=Ws;function mle(t){return hs(t.slice(0,54))}function ple(t,e){var r=[],n=[],s={},a=!1;return vl(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function xle(t){var e=Sa(),r=[];return tt(e,628),tt(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),tt(e,632,mle(s.a)))})}),tt(e,631),tt(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:un(n[0]),e:un(n[0])};tt(e,635,hle([a,s])),s.t&&s.t.length>0&&tt(e,637,Bne(s)),tt(e,636),delete s.iauthor})}),tt(e,634),tt(e,629),e.end()}var yle="application/vnd.ms-office.vbaProject";function vle(t){var e=Dt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Dt.utils.cfb_add(e,s,t.FileIndex[n].content)}}),Dt.write(e)}function wle(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Dt.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var UM=["xlsb","xlsm","xlam","biff8","xla"];function _le(){return{"!type":"dialog"}}function Sle(){return{"!type":"dialog"}}function ble(){return{"!type":"macro"}}function kle(){return{"!type":"macro"}}var yf=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=e.c:--d,l?u+=e.r:--u,s+(o?"":"$")+cn(d)+(l?"":"$")+Pn(u)}return function(s,a){return e=a,s.replace(t,r)}}(),i4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,o4=function(){return function(e,r){return e.replace(i4,function(n,s,a,i,o,l){var u=KT(i)-(a?0:r.c),d=HT(l)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",m=u==0?"":a?u+1:"["+u+"]";return s+"R"+h+"C"+m})}}();function $M(t,e){return t.replace(i4,function(r,n,s,a,i,o){return n+(s=="$"?s+a:cn(KT(a)+e.c))+(i=="$"?i+o:Pn(HT(o)+e.r))})}function Cle(t,e,r){var n=ba(e),s=n.s,a=un(r),i={r:a.r-s.r,c:a.c-s.c};return $M(t,i)}function Tle(t){return t.length!=1}function z8(t){return t.replace(/_xlfn\./g,"")}function Bn(t){t.l+=1}function fc(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function zM(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return WM(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),i=fc(t),o=fc(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function WM(t){var e=fc(t),r=fc(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Ele(t,e,r){if(r.biff<8)return WM(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=fc(t),i=fc(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function VM(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Nle(t);var n=t.read_shift(r&&r.biff==12?4:2),s=fc(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Nle(t){var e=fc(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Ale(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Fle(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return jle(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function jle(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function Ple(t,e,r){var n=(t[t.l++]&96)>>5,s=zM(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Dle(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var i=zM(t,a,r);return[n,s,i]}function Rle(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Ole(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function Mle(t,e,r){var n=(t[t.l++]&96)>>5,s=Ele(t,e-1,r);return[n,s]}function Lle(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function W8(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function Ile(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function Ble(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Ule(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function $le(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function zle(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function GM(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Wle(t){return t.read_shift(2),GM(t)}function Vle(t){return t.read_shift(2),GM(t)}function Gle(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=VM(t,0,r);return[n,s]}function Hle(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Fle(t,0,r);return[n,s]}function Kle(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=VM(t,0,r);return[n,s,a]}function Xle(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[Qce[s],XM[s],n]}function Yle(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Jle(t);return[s,(a[0]===0?XM:Jce)[a[1]]]}function Jle(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Qle(t,e,r){t.l+=r&&r.biff==2?3:4}function qle(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Zle(t){return t.l++,wl[t.read_shift(1)]}function ece(t){return t.l++,t.read_shift(2)}function tce(t){return t.l++,t.read_shift(1)!==0}function rce(t){return t.l++,Us(t)}function nce(t,e,r){return t.l++,cm(t,e-1,r)}function sce(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=En(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=wl[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Us(t);break;case 2:r[1]=ld(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ace(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?od:Ev)(t));return s}function ice(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=sce(t,r.biff);return i}function oce(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function lce(t,e,r){if(r.biff==5)return cce(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function cce(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function uce(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function dce(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function fce(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function hce(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var gce=Hs,mce=Hs,pce=Hs;function dm(t,e,r){return t.l+=2,[Ale(t)]}function l4(t){return t.l+=6,[]}var xce=dm,yce=l4,vce=l4,wce=dm;function HM(t){return t.l+=2,[$n(t),t.read_shift(2)&1]}var _ce=dm,Sce=HM,bce=l4,kce=dm,Cce=dm,Tce=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Ece(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),i=Tce[r>>2&31];return{ixti:e,coltype:r&3,rt:i,idx:n,c:s,C:a}}function Nce(t){return t.l+=2,[t.read_shift(4)]}function Ace(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function Fce(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function jce(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Pce(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Dce(t){return t.l+=4,[0,0]}var V8={1:{n:"PtgExp",f:qle},2:{n:"PtgTbl",f:pce},3:{n:"PtgAdd",f:Bn},4:{n:"PtgSub",f:Bn},5:{n:"PtgMul",f:Bn},6:{n:"PtgDiv",f:Bn},7:{n:"PtgPower",f:Bn},8:{n:"PtgConcat",f:Bn},9:{n:"PtgLt",f:Bn},10:{n:"PtgLe",f:Bn},11:{n:"PtgEq",f:Bn},12:{n:"PtgGe",f:Bn},13:{n:"PtgGt",f:Bn},14:{n:"PtgNe",f:Bn},15:{n:"PtgIsect",f:Bn},16:{n:"PtgUnion",f:Bn},17:{n:"PtgRange",f:Bn},18:{n:"PtgUplus",f:Bn},19:{n:"PtgUminus",f:Bn},20:{n:"PtgPercent",f:Bn},21:{n:"PtgParen",f:Bn},22:{n:"PtgMissArg",f:Bn},23:{n:"PtgStr",f:nce},26:{n:"PtgSheet",f:Ace},27:{n:"PtgEndSheet",f:Fce},28:{n:"PtgErr",f:Zle},29:{n:"PtgBool",f:tce},30:{n:"PtgInt",f:ece},31:{n:"PtgNum",f:rce},32:{n:"PtgArray",f:Lle},33:{n:"PtgFunc",f:Xle},34:{n:"PtgFuncVar",f:Yle},35:{n:"PtgName",f:oce},36:{n:"PtgRef",f:Gle},37:{n:"PtgArea",f:Ple},38:{n:"PtgMemArea",f:uce},39:{n:"PtgMemErr",f:gce},40:{n:"PtgMemNoMem",f:mce},41:{n:"PtgMemFunc",f:dce},42:{n:"PtgRefErr",f:fce},43:{n:"PtgAreaErr",f:Rle},44:{n:"PtgRefN",f:Hle},45:{n:"PtgAreaN",f:Mle},46:{n:"PtgMemAreaN",f:jce},47:{n:"PtgMemNoMemN",f:Pce},57:{n:"PtgNameX",f:lce},58:{n:"PtgRef3d",f:Kle},59:{n:"PtgArea3d",f:Dle},60:{n:"PtgRefErr3d",f:hce},61:{n:"PtgAreaErr3d",f:Ole},255:{}},Rce={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Oce={1:{n:"PtgElfLel",f:HM},2:{n:"PtgElfRw",f:kce},3:{n:"PtgElfCol",f:xce},6:{n:"PtgElfRwV",f:Cce},7:{n:"PtgElfColV",f:wce},10:{n:"PtgElfRadical",f:_ce},11:{n:"PtgElfRadicalS",f:bce},13:{n:"PtgElfColS",f:yce},15:{n:"PtgElfColSV",f:vce},16:{n:"PtgElfRadicalLel",f:Sce},25:{n:"PtgList",f:Ece},29:{n:"PtgSxName",f:Nce},255:{}},Mce={0:{n:"PtgAttrNoop",f:Dce},1:{n:"PtgAttrSemi",f:zle},2:{n:"PtgAttrIf",f:Ule},4:{n:"PtgAttrChoose",f:Ile},8:{n:"PtgAttrGoto",f:Ble},16:{n:"PtgAttrSum",f:Qle},32:{n:"PtgAttrBaxcel",f:W8},33:{n:"PtgAttrBaxcel",f:W8},64:{n:"PtgAttrSpace",f:Wle},65:{n:"PtgAttrSpaceSemi",f:Vle},128:{n:"PtgAttrIfError",f:$le},255:{}};function fm(t,e,r,n){if(n.biff<8)return Hs(t,e);for(var s=t.l+e,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=ice(t,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=ace(t,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=t.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return e=s-t.l,e!==0&&a.push(Hs(t,e)),a}function hm(t,e,r){for(var n=t.l+e,s,a,i=[];n!=t.l;)e=n-t.l,a=t[t.l],s=V8[a]||V8[Rce[a]],(a===24||a===25)&&(s=(a===24?Oce:Mce)[t[t.l+1]]),!s||!s.f?Hs(t,e):i.push([s.n,s.f(t,e,r)]);return i}function Lce(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var Ice={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Bce(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function KM(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function G8(t,e,r){var n=KM(t,e,r);return n=="#REF"?n:Bce(n,r)}function Ls(t,e,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,u,d,h=0,m=0,x,p="";if(!t[0]||!t[0][0])return"";for(var v=-1,_="",S=0,w=t[0].length;S<w;++S){var y=t[0][S];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:_=vn(" ",t[0][v][1][1]);break;case 1:_=vn("\r",t[0][v][1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}u=u+_,v=-1}o.push(u+Ice[y[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=E0(y[1][1],i,s),o.push(N0(d,a));break;case"PtgRefN":d=r?E0(y[1][1],r,s):y[1][1],o.push(N0(d,a));break;case"PtgRef3d":h=y[1][1],d=E0(y[1][2],i,s),p=G8(n,h,s),o.push(p+"!"+N0(d,a));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],E=y[1][1];b||(b=0),b&=127;var N=b==0?[]:o.slice(-b);o.length-=b,E==="User"&&(E=N.shift()),o.push(E+"("+N.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":x=w8(y[1][1],r?{s:r}:i,s),o.push(i_(x,s));break;case"PtgArea":x=w8(y[1][1],i,s),o.push(i_(x,s));break;case"PtgArea3d":h=y[1][1],x=y[1][2],p=G8(n,h,s),o.push(p+"!"+i_(x,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=y[1][2];var F=(n.names||[])[m-1]||(n[0]||[])[m],T=F?F.Name:"SH33TJSNAME"+String(m);T&&T.slice(0,6)=="_xlfn."&&!s.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var P=y[1][1];m=y[1][2];var D;if(s.biff<=5)P<0&&(P=-P),n[P]&&(D=n[P][m]);else{var R="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][m]&&n[P][m].itab>0&&(R=n.SheetNames[n[P][m].itab-1]+"!"):R=n.SheetNames[m-1]+"!"),n[P]&&n[P][m])R+=n[P][m].Name;else if(n[0]&&n[0][m])R+=n[0][m].Name;else{var I=(KM(n,P,s)||"").split(";;");I[m-1]?R=I[m-1]:R+="SH33TJSERRX"}o.push(R);break}D||(D={Name:"SH33TJSERRY"}),o.push(D.Name);break;case"PtgParen":var W="(",le=")";if(v>=0){switch(_="",t[0][v][1][0]){case 2:W=vn(" ",t[0][v][1][1])+W;break;case 3:W=vn("\r",t[0][v][1][1])+W;break;case 4:le=vn(" ",t[0][v][1][1])+le;break;case 5:le=vn("\r",t[0][v][1][1])+le;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(W+o.pop()+le);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var q={c:r.c,r:r.r};if(n.sharedf[Wt(d)]){var V=n.sharedf[Wt(d)];o.push(Ls(V,i,q,n,s))}else{var K=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Ls(u[1],i,q,n,s)),K=!0;break}K||o.push(y[1])}break;case"PtgArray":o.push("{"+Lce(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var U=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&U.indexOf(t[0][S][0])==-1){y=t[0][v];var L=!0;switch(y[1][0]){case 4:L=!1;case 0:_=vn(" ",y[1][1]);break;case 5:L=!1;case 1:_=vn("\r",y[1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((L?_:"")+o.pop()+(L?"":_)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Uce(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Hs(t,e-2)];var o=hm(t,i,r);return e!==i+s&&(a=fm(t,e-i-s,o,r)),t.l=n,[o,a]}function $ce(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Hs(t,e-2)];var o=hm(t,i,r);return e!==i+s&&(a=fm(t,e-i-s,o,r)),t.l=n,[o,a]}function zce(t,e,r,n){var s=t.l+e,a=hm(t,n,r),i;return s!==t.l&&(i=fm(t,s-t.l,a,r)),[a,i]}function Wce(t,e,r){var n=t.l+e,s,a=t.read_shift(2),i=hm(t,a,r);return a==65535?[[],Hs(t,e-2)]:(e!==a+2&&(s=fm(t,n-a-2,i,r)),[i,s])}function Vce(t){var e;if(Yo(t,t.l+6)!==65535)return[Us(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Gce(t){if(t==null){var e=Ye(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Iu(t);return Iu(0)}function d_(t,e,r){var n=t.l+e,s=No(t);r.biff==2&&++t.l;var a=Vce(t),i=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=$ce(t,n-t.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Hce(t,e,r,n,s){var a=Uu(e,r,s),i=Gce(t.v),o=Ye(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Ye(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var h=fs([a,i,o,u]);return h}function Nv(t,e,r){var n=t.read_shift(4),s=hm(t,n,r),a=t.read_shift(4),i=a>0?fm(t,a,s,r):null;return[s,i]}var Kce=Nv,Av=Nv,Xce=Nv,Yce=Nv,Jce={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},XM={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Qce={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function H8(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function qce(t){var e="of:="+t.replace(i4,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function f_(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function Zce(t){return t.replace(/\./,"!")}var F0={},vf={},j0=typeof Map<"u";function c4(t,e,r){var n=0,s=t.length;if(r){if(j0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=j0?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(j0?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function Fv(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Bs=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Cg(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=I1(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function xu(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function jc(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,a=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){el(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=a;++s)if(t[s].numFmtId===n)return s;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function YM(t,e,r,n,s,a){try{n.cellNF&&(t.z=Bt[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Hr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Bt[e]==null&&el(Jre[e]||"General",e),t.t==="e")t.w=t.w||wl[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=yg(t.v);else if(t.t==="d"){var i=es(t.v);(i|0)===i?t.w=i.toString(10):t.w=yg(i)}else{if(t.v===void 0)return"";t.w=Mu(t.v,vf)}else t.t==="d"?t.w=yi(e,es(t.v),vf):t.w=yi(e,t.v,vf)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=L1(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=L1(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function eue(t,e,r){if(t&&t["!ref"]){var n=_r(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function tue(t,e){var r=_r(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=er(r))}var rue=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,nue=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,sue=/<(?:\w:)?hyperlink [^>]*>/mg,aue=/"(\w*:\w*)"/,iue=/<(?:\w:)?col\b[^>]*[\/]?>/g,oue=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,lue=/<(?:\w:)?pageMargins[^>]*\/>/g,JM=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,cue=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,uue=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function due(t,e,r,n,s,a,i){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",h=t.match(nue);h?(u=t.slice(0,h.index),d=t.slice(h.index+h[0].length)):u=d=t;var m=u.match(JM);m?u4(m[0],o,s,r):(m=u.match(cue))&&hue(m[0],m[1]||"",o,s,r);var x=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var p=u.slice(x,x+50).match(aue);p&&tue(o,p[1])}var v=u.match(uue);v&&v[1]&&Tue(v[1],s);var _=[];if(e.cellStyles){var S=u.match(iue);S&&_ue(_,S)}h&&Aue(h[1],o,e,l,a,i);var w=d.match(oue);w&&(o["!autofilter"]=bue(w[0]));var y=[],b=d.match(rue);if(b)for(x=0;x!=b.length;++x)y[x]=_r(b[x].slice(b[x].indexOf('"')+1));var E=d.match(sue);E&&yue(o,E,n);var N=d.match(lue);if(N&&(o["!margins"]=vue(Ht(N[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=er(l)),e.sheetRows>0&&o["!ref"]){var F=_r(o["!ref"]);e.sheetRows<=+F.e.r&&(F.e.r=e.sheetRows-1,F.e.r>l.e.r&&(F.e.r=l.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>l.e.c&&(F.e.c=l.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),o["!fullref"]=o["!ref"],o["!ref"]=er(F))}return _.length>0&&(o["!cols"]=_),y.length>0&&(o["!merges"]=y),o}function fue(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+er(t[r])+'"/>';return e+"</mergeCells>"}function u4(t,e,r,n){var s=Ht(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=wr(Mr(s.codeName)))}function hue(t,e,r,n,s){u4(t.slice(0,t.indexOf(">")),r,n,s)}function gue(t,e,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}a=!0,i.codeName=go(Dr(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+dt("outlinePr",null,u)}!a&&!o||(s[s.length]=dt("sheetPr",o,i))}var mue=["objects","scenarios","selectLockedCells","selectUnlockedCells"],pue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function xue(t){var e={sheet:1};return mue.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),pue.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=n4(t.password).toString(16).toUpperCase()),dt("sheetProtection",null,e)}function yue(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=Ht(Mr(e[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+wr(a.location))):(a.Target="#"+wr(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=_r(a.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var d=Wt({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=a):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=a)}}}function vue(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function wue(t){return xu(t),dt("pageMargins",null,t)}function _ue(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Ht(e[n],!0);s.hidden&&(s.hidden=Wr(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,s4(s.width)),dc(s);a<=i;)t[a++]=Kr(s)}}function Sue(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=dt("col",null,Fv(s,n)));return r[r.length]="</cols>",r.join("")}function bue(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function kue(t,e,r,n){var s=typeof t.ref=="string"?t.ref:er(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=ba(s);i.s.r==i.e.r&&(i.e.r=ba(e["!ref"]).e.r,s=er(i));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),dt("autoFilter",null,{ref:s})}var Cue=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Tue(t,e){e.Views||(e.Views=[{}]),(t.match(Cue)||[]).forEach(function(r,n){var s=Ht(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Wr(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function Eue(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),dt("sheetViews",dt("sheetView",null,s),{})}function Nue(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",a=t.t,i=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=wl[t.v];break;case"d":n&&n.cellDates?s=Hr(t.v,-1).toISOString():(t=Kr(t),t.t="n",s=""+(t.v=es(Hr(t.v)))),typeof t.z>"u"&&(t.z=Bt[14]);break;default:s=t.v;break}var o=bs("v",Dr(s)),l={r:e},u=jc(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=bs("v",""+c4(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=a&&(t.t=a,t.v=i),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=dt("f",Dr(t.f),d)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),dt("c",o,l)}var Aue=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=vg("v"),i=vg("f");return function(l,u,d,h,m,x){for(var p=0,v="",_=[],S=[],w=0,y=0,b=0,E="",N,F,T=0,P=0,D,R,I=0,W=0,le=Array.isArray(x.CellXf),q,V=[],K=[],U=Array.isArray(u),L=[],Z={},ne=!1,z=!!d.sheetStubs,Y=l.split(e),J=0,te=Y.length;J!=te;++J){v=Y[J].trim();var de=v.length;if(de!==0){var ee=0;e:for(p=0;p<de;++p)switch(v[p]){case">":if(v[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(F=Ht(v.slice(ee,p),!0),T=F.r!=null?parseInt(F.r,10):T+1,P=-1,d.sheetRows&&d.sheetRows<T)continue;Z={},ne=!1,F.ht&&(ne=!0,Z.hpt=parseFloat(F.ht),Z.hpx=zf(Z.hpt)),F.hidden=="1"&&(ne=!0,Z.hidden=!0),F.outlineLevel!=null&&(ne=!0,Z.level=+F.outlineLevel),ne&&(L[T-1]=Z)}break;case"<":ee=p;break}if(ee>=p)break;if(F=Ht(v.slice(ee,p),!0),T=F.r!=null?parseInt(F.r,10):T+1,P=-1,!(d.sheetRows&&d.sheetRows<T)){h.s.r>T-1&&(h.s.r=T-1),h.e.r<T-1&&(h.e.r=T-1),d&&d.cellStyles&&(Z={},ne=!1,F.ht&&(ne=!0,Z.hpt=parseFloat(F.ht),Z.hpx=zf(Z.hpt)),F.hidden=="1"&&(ne=!0,Z.hidden=!0),F.outlineLevel!=null&&(ne=!0,Z.level=+F.outlineLevel),ne&&(L[T-1]=Z)),_=v.slice(p).split(t);for(var ge=0;ge!=_.length&&_[ge].trim().charAt(0)=="<";++ge);for(_=_.slice(ge),p=0;p!=_.length;++p)if(v=_[p].trim(),v.length!==0){if(S=v.match(r),w=p,y=0,b=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,S!=null&&S.length===2){for(w=0,E=S[1],y=0;y!=E.length&&!((b=E.charCodeAt(y)-64)<1||b>26);++y)w=26*w+b;--w,P=w}else++P;for(y=0;y!=v.length&&v.charCodeAt(y)!==62;++y);if(++y,F=Ht(v.slice(0,y),!0),F.r||(F.r=Wt({r:T-1,c:P})),E=v.slice(y),N={t:""},(S=E.match(a))!=null&&S[1]!==""&&(N.v=wr(S[1])),d.cellFormula){if((S=E.match(i))!=null&&S[1]!==""){if(N.f=wr(Mr(S[1])).replace(/\r\n/g,`
`),d.xlfn||(N.f=z8(N.f)),S[0].indexOf('t="array"')>-1)N.F=(E.match(s)||[])[1],N.F.indexOf(":")>-1&&V.push([_r(N.F),N.F]);else if(S[0].indexOf('t="shared"')>-1){R=Ht(S[0]);var fe=wr(Mr(S[1]));d.xlfn||(fe=z8(fe)),K[parseInt(R.si,10)]=[R,fe,F.r]}}else(S=E.match(/<f[^>]*\/>/))&&(R=Ht(S[0]),K[R.si]&&(N.f=Cle(K[R.si][1],K[R.si][2],F.r)));var ye=un(F.r);for(y=0;y<V.length;++y)ye.r>=V[y][0].s.r&&ye.r<=V[y][0].e.r&&ye.c>=V[y][0].s.c&&ye.c<=V[y][0].e.c&&(N.F=V[y][1])}if(F.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(z)N.t="z";else continue;else N.t=F.t||"n";switch(h.s.c>P&&(h.s.c=P),h.e.c<P&&(h.e.c=P),N.t){case"n":if(N.v==""||N.v==null){if(!z)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!z)continue;N.t="z"}else D=F0[parseInt(N.v,10)],N.v=D.t,N.r=D.r,d.cellHTML&&(N.h=D.h);break;case"str":N.t="s",N.v=N.v!=null?Mr(N.v):"",d.cellHTML&&(N.h=zT(N.v));break;case"inlineStr":S=E.match(n),N.t="s",S!=null&&(D=r4(S[1]))?(N.v=D.t,d.cellHTML&&(N.h=D.h)):N.v="";break;case"b":N.v=Wr(N.v);break;case"d":d.cellDates?N.v=Hr(N.v,1):(N.v=es(Hr(N.v,1)),N.t="n");break;case"e":(!d||d.cellText!==!1)&&(N.w=N.v),N.v=qO[N.v];break}if(I=W=0,q=null,le&&F.s!==void 0&&(q=x.CellXf[F.s],q!=null&&(q.numFmtId!=null&&(I=q.numFmtId),d.cellStyles&&q.fillId!=null&&(W=q.fillId))),YM(N,I,W,d,m,x),d.cellDates&&le&&N.t=="n"&&uh(Bt[I])&&(N.t="d",N.v=Tv(N.v)),F.cm&&d.xlmeta){var Ce=(d.xlmeta.Cell||[])[+F.cm-1];Ce&&Ce.type=="XLDAPR"&&(N.D=!0)}if(U){var re=un(F.r);u[re.r]||(u[re.r]=[]),u[re.r][re.c]=N}else u[F.r]=N}}}}L.length>0&&(u["!rows"]=L)}}();function Fue(t,e,r,n){var s=[],a=[],i=_r(t["!ref"]),o="",l,u="",d=[],h=0,m=0,x=t["!rows"],p=Array.isArray(t),v={r:u},_,S=-1;for(m=i.s.c;m<=i.e.c;++m)d[m]=cn(m);for(h=i.s.r;h<=i.e.r;++h){for(a=[],u=Pn(h),m=i.s.c;m<=i.e.c;++m){l=d[m]+u;var w=p?(t[h]||[])[m]:t[l];w!==void 0&&(o=Nue(w,l,t,e))!=null&&a.push(o)}(a.length>0||x&&x[h])&&(v={r:u},x&&x[h]&&(_=x[h],_.hidden&&(v.hidden=1),S=-1,_.hpx?S=Tg(_.hpx):_.hpt&&(S=_.hpt),S>-1&&(v.ht=S,v.customHeight=1),_.level&&(v.outlineLevel=_.level)),s[s.length]=dt("row",a.join(""),v))}if(x)for(;h<x.length;++h)x&&x[h]&&(v={r:h+1},_=x[h],_.hidden&&(v.hidden=1),S=-1,_.hpx?S=Tg(_.hpx):_.hpt&&(S=_.hpt),S>-1&&(v.ht=S,v.customHeight=1),_.level&&(v.outlineLevel=_.level),s[s.length]=dt("row","",v));return s.join("")}function QM(t,e,r,n){var s=[On,dt("worksheet",null,{xmlns:nd[0],"xmlns:r":Qn.r})],a=r.SheetNames[t],i=0,o="",l=r.Sheets[a];l==null&&(l={});var u=l["!ref"]||"A1",d=_r(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=er(d)}n||(n={}),l["!comments"]=[];var h=[];gue(l,r,t,e,s),s[s.length]=dt("dimension",null,{ref:u}),s[s.length]=Eue(l,e,t,r),e.sheetFormat&&(s[s.length]=dt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=Sue(l,l["!cols"])),s[i=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=Fue(l,e),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),l["!protect"]&&(s[s.length]=xue(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=kue(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=fue(l["!merges"]));var m=-1,x,p=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(x={ref:v[0]},v[1].Target.charAt(0)!="#"&&(p=Pr(n,-1,Dr(v[1].Target).replace(/#.*$/,""),ur.HLINK),x["r:id"]="rId"+p),(m=v[1].Target.indexOf("#"))>-1&&(x.location=Dr(v[1].Target.slice(m+1))),v[1].Tooltip&&(x.tooltip=Dr(v[1].Tooltip)),s[s.length]=dt("hyperlink",null,x))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=wue(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=bs("ignoredErrors",dt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(p=Pr(n,-1,"../drawings/drawing"+(t+1)+".xml",ur.DRAW),s[s.length]=dt("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=h),l["!comments"].length>0&&(p=Pr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ur.VML),s[s.length]=dt("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function jue(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function Pue(t,e,r){var n=Ye(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;s.hpx?a=Tg(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var h=-1,m=-1,x=d<<10;x<d+1<<10;++x){u.c=x;var p=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Wt(u)];p&&(h<0&&(h=x),m=x)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,m))}var v=n.l;return n.l=l,n.write_shift(4,o),n.l=v,n.length>n.l?n.slice(0,n.l):n}function Due(t,e,r,n){var s=Pue(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&tt(t,0,s)}var Rue=od,Oue=hh;function Mue(){}function Lue(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Une(t),r}function Iue(t,e,r){r==null&&(r=Ye(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return R1({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),KO(t,r),r.slice(0,r.l)}function Bue(t){var e=vi(t);return[e]}function Uue(t,e,r){return r==null&&(r=Ye(8)),sd(e,r)}function $ue(t){var e=ad(t);return[e]}function zue(t,e,r){return r==null&&(r=Ye(4)),id(e,r)}function Wue(t){var e=vi(t),r=t.read_shift(1);return[e,r,"b"]}function Vue(t,e,r){return r==null&&(r=Ye(9)),sd(e,r),r.write_shift(1,t.v?1:0),r}function Gue(t){var e=ad(t),r=t.read_shift(1);return[e,r,"b"]}function Hue(t,e,r){return r==null&&(r=Ye(5)),id(e,r),r.write_shift(1,t.v?1:0),r}function Kue(t){var e=vi(t),r=t.read_shift(1);return[e,r,"e"]}function Xue(t,e,r){return r==null&&(r=Ye(9)),sd(e,r),r.write_shift(1,t.v),r}function Yue(t){var e=ad(t),r=t.read_shift(1);return[e,r,"e"]}function Jue(t,e,r){return r==null&&(r=Ye(8)),id(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function Que(t){var e=vi(t),r=t.read_shift(4);return[e,r,"s"]}function que(t,e,r){return r==null&&(r=Ye(12)),sd(e,r),r.write_shift(4,e.v),r}function Zue(t){var e=ad(t),r=t.read_shift(4);return[e,r,"s"]}function ede(t,e,r){return r==null&&(r=Ye(8)),id(e,r),r.write_shift(4,e.v),r}function tde(t){var e=vi(t),r=Us(t);return[e,r,"n"]}function rde(t,e,r){return r==null&&(r=Ye(16)),sd(e,r),Iu(t.v,r),r}function qM(t){var e=ad(t),r=Us(t);return[e,r,"n"]}function nde(t,e,r){return r==null&&(r=Ye(12)),id(e,r),Iu(t.v,r),r}function sde(t){var e=vi(t),r=QT(t);return[e,r,"n"]}function ade(t,e,r){return r==null&&(r=Ye(12)),sd(e,r),XO(t.v,r),r}function ide(t){var e=ad(t),r=QT(t);return[e,r,"n"]}function ode(t,e,r){return r==null&&(r=Ye(8)),id(e,r),XO(t.v,r),r}function lde(t){var e=vi(t),r=XT(t);return[e,r,"is"]}function cde(t){var e=vi(t),r=Ws(t);return[e,r,"str"]}function ude(t,e,r){return r==null&&(r=Ye(12+4*t.v.length)),sd(e,r),hs(t.v,r),r.length>r.l?r.slice(0,r.l):r}function dde(t){var e=ad(t),r=Ws(t);return[e,r,"str"]}function fde(t,e,r){return r==null&&(r=Ye(8+4*t.v.length)),id(e,r),hs(t.v,r),r.length>r.l?r.slice(0,r.l):r}function hde(t,e,r){var n=t.l+e,s=vi(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"b"];if(r.cellFormula){t.l+=2;var o=Av(t,n-t.l,r);i[3]=Ls(o,null,s,r.supbooks,r)}else t.l=n;return i}function gde(t,e,r){var n=t.l+e,s=vi(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"e"];if(r.cellFormula){t.l+=2;var o=Av(t,n-t.l,r);i[3]=Ls(o,null,s,r.supbooks,r)}else t.l=n;return i}function mde(t,e,r){var n=t.l+e,s=vi(t);s.r=r["!row"];var a=Us(t),i=[s,a,"n"];if(r.cellFormula){t.l+=2;var o=Av(t,n-t.l,r);i[3]=Ls(o,null,s,r.supbooks,r)}else t.l=n;return i}function pde(t,e,r){var n=t.l+e,s=vi(t);s.r=r["!row"];var a=Ws(t),i=[s,a,"str"];if(r.cellFormula){t.l+=2;var o=Av(t,n-t.l,r);i[3]=Ls(o,null,s,r.supbooks,r)}else t.l=n;return i}var xde=od,yde=hh;function vde(t,e){return e==null&&(e=Ye(4)),e.write_shift(4,t),e}function wde(t,e){var r=t.l+e,n=od(t),s=YT(t),a=Ws(t),i=Ws(t),o=Ws(t);t.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function _de(t,e){var r=Ye(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));hh({s:un(t[0]),e:un(t[0])},r),JT("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return hs(s||"",r),hs(t[1].Tooltip||"",r),hs("",r),r.slice(0,r.l)}function Sde(){}function bde(t,e,r){var n=t.l+e,s=YO(t),a=t.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=Kce(t,n-t.l,r);i[1]=o}else t.l=n;return i}function kde(t,e,r){var n=t.l+e,s=od(t),a=[s];if(r.cellFormula){var i=Yce(t,n-t.l,r);a[1]=i,t.l=n}else t.l=n;return a}function Cde(t,e,r){r==null&&(r=Ye(18));var n=Fv(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var ZM=["left","right","top","bottom","header","footer"];function Tde(t){var e={};return ZM.forEach(function(r){e[r]=Us(t)}),e}function Ede(t,e){return e==null&&(e=Ye(6*8)),xu(t),ZM.forEach(function(r){Iu(t[r],e)}),e}function Nde(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Ade(t,e,r){r==null&&(r=Ye(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Fde(t){var e=Ye(24);return e.write_shift(4,4),e.write_shift(4,1),hh(t,e),e}function jde(t,e){return e==null&&(e=Ye(16*4+2)),e.write_shift(2,t.password?n4(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Pde(){}function Dde(){}function Rde(t,e,r,n,s,a,i){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,m=!1,x,p,v,_,S,w,y,b,E,N=[];o.biff=12,o["!row"]=0;var F=0,T=!1,P=[],D={},R=o.supbooks||s.supbooks||[[]];if(R.sharedf=D,R.arrayf=P,R.SheetNames=s.SheetNames||s.Sheets.map(function(U){return U.name}),!o.supbooks&&(o.supbooks=R,s.Names))for(var I=0;I<s.Names.length;++I)R[0][I+1]=s.Names[I];var W=[],le=[],q=!1;Eg[16]={n:"BrtShortReal",f:qM};var V;if(vl(t,function(L,Z,ne){if(!m)switch(ne){case 148:u=L;break;case 0:x=L,o.sheetRows&&o.sheetRows<=x.r&&(m=!0),b=Pn(_=x.r),o["!row"]=x.r,(L.hidden||L.hpt||L.level!=null)&&(L.hpt&&(L.hpx=zf(L.hpt)),le[L.r]=L);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:L[2]},L[2]){case"n":p.v=L[1];break;case"s":y=F0[L[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!L[1];break;case"e":p.v=L[1],o.cellText!==!1&&(p.w=wl[p.v]);break;case"str":p.t="s",p.v=L[1];break;case"is":p.t="s",p.v=L[1].t;break}if((v=i.CellXf[L[0].iStyleRef])&&YM(p,v.numFmtId,null,o,a,i),S=L[0].c==-1?S+1:L[0].c,o.dense?(l[_]||(l[_]=[]),l[_][S]=p):l[cn(S)+b]=p,o.cellFormula){for(T=!1,F=0;F<P.length;++F){var z=P[F];x.r>=z[0].s.r&&x.r<=z[0].e.r&&S>=z[0].s.c&&S<=z[0].e.c&&(p.F=er(z[0]),T=!0)}!T&&L.length>3&&(p.f=L[3])}if(d.s.r>x.r&&(d.s.r=x.r),d.s.c>S&&(d.s.c=S),d.e.r<x.r&&(d.e.r=x.r),d.e.c<S&&(d.e.c=S),o.cellDates&&v&&p.t=="n"&&uh(Bt[v.numFmtId])){var Y=au(p.v);Y&&(p.t="d",p.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}V&&(V.type=="XLDAPR"&&(p.D=!0),V=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;p={t:"z",v:void 0},S=L[0].c==-1?S+1:L[0].c,o.dense?(l[_]||(l[_]=[]),l[_][S]=p):l[cn(S)+b]=p,d.s.r>x.r&&(d.s.r=x.r),d.s.c>S&&(d.s.c=S),d.e.r<x.r&&(d.e.r=x.r),d.e.c<S&&(d.e.c=S),V&&(V.type=="XLDAPR"&&(p.D=!0),V=void 0);break;case 176:N.push(L);break;case 49:V=((o.xlmeta||{}).Cell||[])[L-1];break;case 494:var J=n["!id"][L.relId];for(J?(L.Target=J.Target,L.loc&&(L.Target+="#"+L.loc),L.Rel=J):L.relId==""&&(L.Target="#"+L.loc),_=L.rfx.s.r;_<=L.rfx.e.r;++_)for(S=L.rfx.s.c;S<=L.rfx.e.c;++S)o.dense?(l[_]||(l[_]=[]),l[_][S]||(l[_][S]={t:"z",v:void 0}),l[_][S].l=L):(w=Wt({c:S,r:_}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=L);break;case 426:if(!o.cellFormula)break;P.push(L),E=o.dense?l[_][S]:l[cn(S)+b],E.f=Ls(L[1],d,{r:x.r,c:S},R,o),E.F=er(L[0]);break;case 427:if(!o.cellFormula)break;D[Wt(L[0].s)]=L[1],E=o.dense?l[_][S]:l[cn(S)+b],E.f=Ls(L[1],d,{r:x.r,c:S},R,o);break;case 60:if(!o.cellStyles)break;for(;L.e>=L.s;)W[L.e--]={width:L.w/256,hidden:!!(L.flags&1),level:L.level},q||(q=!0,s4(L.w/256)),dc(W[L.e+1]);break;case 161:l["!autofilter"]={ref:er(L)};break;case 476:l["!margins"]=L;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),L.name&&(s.Sheets[r].CodeName=L.name),(L.above||L.left)&&(l["!outline"]={above:L.above,left:L.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),L.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Z.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+ne.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=er(u||d)),o.sheetRows&&l["!ref"]){var K=_r(l["!ref"]);o.sheetRows<=+K.e.r&&(K.e.r=o.sheetRows-1,K.e.r>d.e.r&&(K.e.r=d.e.r),K.e.r<K.s.r&&(K.s.r=K.e.r),K.e.c>d.e.c&&(K.e.c=d.e.c),K.e.c<K.s.c&&(K.s.c=K.e.c),l["!fullref"]=l["!ref"],l["!ref"]=er(K))}return N.length>0&&(l["!merges"]=N),W.length>0&&(l["!cols"]=W),le.length>0&&(l["!rows"]=le),l}function Ode(t,e,r,n,s,a,i){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Kr(e),e.z=e.z||Bt[14],e.v=es(Hr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=jc(s.cellXfs,e,s),e.l&&a["!links"].push([Wt(l),e.l]),e.c&&a["!comments"].push([Wt(l),e.c]),e.t){case"s":case"str":return s.bookSST?(o=c4(s.Strings,e.v,s.revStrings),l.t="s",l.v=o,i?tt(t,18,ede(e,l)):tt(t,7,que(e,l))):(l.t="str",i?tt(t,17,fde(e,l)):tt(t,6,ude(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?i?tt(t,13,ode(e,l)):tt(t,2,ade(e,l)):i?tt(t,16,nde(e,l)):tt(t,5,rde(e,l)),!0;case"b":return l.t="b",i?tt(t,15,Hue(e,l)):tt(t,4,Vue(e,l)),!0;case"e":return l.t="e",i?tt(t,14,Jue(e,l)):tt(t,3,Xue(e,l)),!0}return i?tt(t,12,zue(e,l)):tt(t,1,Uue(e,l)),!0}function Mde(t,e,r,n){var s=_r(e["!ref"]||"A1"),a,i="",o=[];tt(t,145);var l=Array.isArray(e),u=s.e.r;e["!rows"]&&(u=Math.max(s.e.r,e["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=Pn(d),Due(t,e,s,d);var h=!1;if(d<=s.e.r)for(var m=s.s.c;m<=s.e.c;++m){d===s.s.r&&(o[m]=cn(m)),a=o[m]+i;var x=l?(e[d]||[])[m]:e[a];if(!x){h=!1;continue}h=Ode(t,x,d,m,n,e,h)}}tt(t,146)}function Lde(t,e){!e||!e["!merges"]||(tt(t,177,vde(e["!merges"].length)),e["!merges"].forEach(function(r){tt(t,176,yde(r))}),tt(t,178))}function Ide(t,e){!e||!e["!cols"]||(tt(t,390),e["!cols"].forEach(function(r,n){r&&tt(t,60,Cde(n,r))}),tt(t,391))}function Bde(t,e){!e||!e["!ref"]||(tt(t,648),tt(t,649,Fde(_r(e["!ref"]))),tt(t,650))}function Ude(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=Pr(r,-1,n[1].Target.replace(/#.*$/,""),ur.HLINK);tt(t,494,_de(n,s))}}),delete e["!links"]}function $de(t,e,r,n){if(e["!comments"].length>0){var s=Pr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ur.VML);tt(t,551,JT("rId"+s)),e["!legacy"]=s}}function zde(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],a=typeof s.ref=="string"?s.ref:er(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=ba(a);o.s.r==o.e.r&&(o.e.r=ba(e["!ref"]).e.r,a=er(o));for(var l=0;l<i.length;++l){var u=i[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),tt(t,161,hh(_r(a))),tt(t,162)}}function Wde(t,e,r){tt(t,133),tt(t,137,Ade(e,r)),tt(t,138),tt(t,134)}function Vde(t,e){e["!protect"]&&tt(t,535,jde(e["!protect"]))}function Gde(t,e,r,n){var s=Sa(),a=r.SheetNames[t],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=_r(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],tt(s,129),(r.vbaraw||i["!outline"])&&tt(s,147,Iue(o,i["!outline"])),tt(s,148,Oue(l)),Wde(s,i,r.Workbook),Ide(s,i),Mde(s,i,t,e),Vde(s,i),zde(s,i,r,t),Lde(s,i),Ude(s,i,n),i["!margins"]&&tt(s,476,Ede(i["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Bde(s,i),$de(s,i,t,n),tt(s,130),s.end()}function Hde(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(e[+i[1]]=r?+i[2]:i[2])});var s=wr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function Kde(t,e,r,n,s,a){var i=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=Hde(h);d.s.r=d.s.c=0,d.e.c=o,u=cn(o),m[0].forEach(function(x,p){i[u+Pn(p)]={t:"n",v:x,z:m[1]},l=p}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=er(d)),i}function Xde(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=t.match(JM);return o&&u4(o[0],a,s,r),(i=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Yde(t,e){t.l+=10;var r=Ws(t);return{name:r}}function Jde(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return vl(t,function(l,u,d){switch(d){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var d4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Qde=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],qde=[],Zde=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function K8(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Wr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function X8(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Wr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function eL(t){X8(t.WBProps,d4),X8(t.CalcPr,Zde),K8(t.WBView,Qde),K8(t.Sheets,qde),vf.date1904=Wr(t.WBProps.date1904)}function efe(t){return!t.Workbook||!t.Workbook.WBProps?"false":Wr(t.Workbook.WBProps.date1904)?"true":"false"}var tfe="][*?/\\".split("");function tL(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return tfe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function rfe(t,e,r){t.forEach(function(n,s){tL(n);for(var a=0;a<s;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=e&&e[s]&&e[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function nfe(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];rfe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)eue(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var sfe=/<\w+:workbook/;function afe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(t.replace(Xs,function(l,u){var d=Ht(l);switch(Eo(d[0])){case"<?xml":break;case"<workbook":l.match(sfe)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":d4.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Wr(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=Mr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=wr(Mr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Mr(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Wr(d.hidden||"0")&&(a.Hidden=!0),i=u+l.length;break;case"</definedName>":a.Ref=wr(Mr(t.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),nd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return eL(r),r}function rL(t){var e=[On];e[e.length]=dt("workbook",null,{xmlns:nd[0],"xmlns:r":Qn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(d4.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=dt("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var i={name:Dr(t.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}e[e.length]=dt("sheet",null,i)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=dt("definedName",Dr(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function ife(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Ab(t),r.name=Ws(t),r}function ofe(t,e){return e||(e=Ye(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),JT(t.strRelID,e),hs(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function lfe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Ws(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function cfe(t,e){e||(e=Ye(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),KO(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function ufe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function dfe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=$ne(t),i=Xce(t,0,r),o=YT(t);t.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function ffe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Eg[16]={n:"BrtFRTArchID$",f:ufe},vl(t,function(l,u,d){switch(d){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Ls(l.Ptg,null,null,i,e),delete e.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,l]):i[0]=[d,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),eL(r),r.Names=a,r.supbooks=i,r}function hfe(t,e){tt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};tt(t,156,ofe(s))}tt(t,144)}function gfe(t,e){e||(e=Ye(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return hs("SheetJS",e),hs(E1.version,e),hs(E1.version,e),hs("7262",e),e.length>e.l?e.slice(0,e.l):e}function mfe(t,e){e||(e=Ye(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function pfe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(tt(t,135),tt(t,158,mfe(s)),tt(t,136))}}function xfe(t,e){var r=Sa();return tt(r,131),tt(r,128,gfe()),tt(r,153,cfe(t.Workbook&&t.Workbook.WBProps||null)),pfe(r,t),hfe(r,t),tt(r,132),r.end()}function yfe(t,e,r){return e.slice(-4)===".bin"?ffe(t,r):afe(t,r)}function vfe(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?Rde(t,n,r,s,a,i,o):due(t,n,r,s,a,i,o)}function wfe(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?Jde(t,n,r,s,a):Xde(t,n,r,s,a)}function _fe(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?ble():kle()}function Sfe(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?_le():Sle()}function bfe(t,e,r,n){return e.slice(-4)===".bin"?yoe(t,r,n):ioe(t,r,n)}function kfe(t,e,r){return MM(t,r)}function Cfe(t,e,r){return e.slice(-4)===".bin"?Cie(t,r):Sie(t,r)}function Tfe(t,e,r){return e.slice(-4)===".bin"?ple(t,r):ole(t,r)}function Efe(t,e,r){return e.slice(-4)===".bin"?sle(t):rle(t)}function Nfe(t,e,r,n){return r.slice(-4)===".bin"?ale(t,e,r,n):void 0}function Afe(t,e,r){return e.slice(-4)===".bin"?Zoe(t,e,r):tle(t,e,r)}function Ffe(t,e,r){return(e.slice(-4)===".bin"?xfe:rL)(t)}function jfe(t,e,r,n,s){return(e.slice(-4)===".bin"?Gde:QM)(t,r,n,s)}function Pfe(t,e,r){return(e.slice(-4)===".bin"?Noe:RM)(t,r)}function Dfe(t,e,r){return(e.slice(-4)===".bin"?Nie:TM)(t,r)}function Rfe(t,e,r){return(e.slice(-4)===".bin"?xle:BM)(t)}function Ofe(t){return(t.slice(-4)===".bin"?ele:LM)()}var nL=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,sL=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ni(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(nL),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(sL),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function Mfe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(nL),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(sL),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var P0;function Lfe(t,e){var r=P0[t]||wr(t);return r==="General"?Mu(e):yi(r,e)}function Ife(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Wr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Hr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[wr(e)]=s}function Bfe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||wl[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=yg(t.v):t.w=Mu(t.v):t.w=Lfe(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=P0[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&uh(n)){var s=au(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function Ufe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=qie[n.Pattern]||n.Pattern)}t[e.ID]=e}function $fe(t,e,r,n,s,a,i,o,l,u){var d="General",h=n.StyleID,m={};u=u||{};var x=[],p=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);a[h]!==void 0&&(a[h].nf&&(d=a[h].nf),a[h].Interior&&x.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Wr(t);break;case"String":n.t="s",n.r=d8(wr(t)),n.v=t.indexOf("<")>-1?wr(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Hr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=wr(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=qO[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=d8(e||t));break}if(Bfe(n,d,u),u.cellFormula!==!1)if(n.Formula){var v=wr(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=yf(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=yf("RC:RC",s):n.ArrayRange&&(n.F=yf(n.ArrayRange,s),l.push([_r(n.F),n.F]))}else for(p=0;p<l.length;++p)s.r>=l[p][0].s.r&&s.r<=l[p][0].e.r&&s.c>=l[p][0].s.c&&s.c<=l[p][0].e.c&&(n.F=l[p][1]);u.cellStyles&&(x.forEach(function(_){!m.patternType&&_.patternType&&(m.patternType=_.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function zfe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function h_(t,e){var r=e||{};dh();var n=n0(WT(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Mr(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Kr(r);return i.type="string",$f.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(xt){s.indexOf("<"+xt)>=0&&(a=!0)}),a)return Ehe(n,r);P0={"General Number":"General","General Date":Bt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Bt[15],"Short Date":Bt[14],"Long Time":Bt[19],"Medium Time":Bt[18],"Short Time":Bt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Bt[2],Standard:Bt[4],Percent:Bt[10],Scientific:Bt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,d={},h=[],m=r.dense?[]:{},x="",p={},v={},_=Ni('<Data ss:Type="String">'),S=0,w=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},N={},F="",T=0,P=[],D={},R={},I=0,W=[],le=[],q={},V=[],K,U=!1,L=[],Z=[],ne={},z=0,Y=0,J={Sheets:[],WBProps:{date1904:!1}},te={};_g.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";o=_g.exec(n);)switch(o[3]=(de=o[3]).toLowerCase()){case"data":if(de=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?$fe(n.slice(S,o.index),F,_,l[l.length-1][0]=="comment"?q:p,{c:w,r:y},E,V[w],v,L,r):(F="",_=Ni(o[0]),S=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(le.length>0&&(p.c=le),(!r.sheetRows||r.sheetRows>y)&&p.v!==void 0&&(r.dense?(m[y]||(m[y]=[]),m[y][w]=p):m[cn(w)+Pn(y)]=p),p.HRef&&(p.l={Target:wr(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(z=w+(parseInt(p.MergeAcross,10)|0),Y=y+(parseInt(p.MergeDown,10)|0),P.push({s:{c:w,r:y},e:{c:z,r:Y}})),!r.sheetStubs)p.MergeAcross?w=z+1:++w;else if(p.MergeAcross||p.MergeDown){for(var ee=w;ee<=z;++ee)for(var ge=y;ge<=Y;++ge)(ee>w||ge>y)&&(r.dense?(m[ge]||(m[ge]=[]),m[ge][ee]={t:"z"}):m[cn(ee)+Pn(ge)]={t:"z"});w=z+1}else++w;else p=Mfe(o[0]),p.Index&&(w=+p.Index-1),w<b.s.c&&(b.s.c=w),w>b.e.c&&(b.e.c=w),o[0].slice(-2)==="/>"&&++w,le=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),o[0].slice(-2)==="/>"&&(v=Ni(o[0]),v.Index&&(y=+v.Index-1)),w=0,++y):(v=Ni(o[0]),v.Index&&(y=+v.Index-1),ne={},(v.AutoFitHeight=="0"||v.Height)&&(ne.hpx=parseInt(v.Height,10),ne.hpt=Tg(ne.hpx),Z[y]=ne),v.Hidden=="1"&&(ne.hidden=!0,Z[y]=ne));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));h.push(x),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(m["!ref"]=er(b),r.sheetRows&&r.sheetRows<=b.e.r&&(m["!fullref"]=m["!ref"],b.e.r=r.sheetRows-1,m["!ref"]=er(b))),P.length&&(m["!merges"]=P),V.length>0&&(m["!cols"]=V),Z.length>0&&(m["!rows"]=Z),d[x]=m}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=w=0,l.push([o[3],!1]),u=Ni(o[0]),x=wr(u.Name),m=r.dense?[]:{},P=[],L=[],Z=[],te={name:x,Hidden:0},J.Sheets.push(te);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),V=[],U=!1}break;case"style":o[1]==="/"?Ufe(E,N,r):N=Ni(o[0]);break;case"numberformat":N.nf=wr(Ni(o[0]).Format||"General"),P0[N.nf]&&(N.nf=P0[N.nf]);for(var fe=0;fe!=392&&Bt[fe]!=N.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(Bt[fe]==null){el(N.nf,fe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(K=Ni(o[0]),K.Hidden&&(K.hidden=!0,delete K.Hidden),K.Width&&(K.wpx=parseInt(K.Width,10)),!U&&K.wpx>10){U=!0,Bs=PM;for(var ye=0;ye<V.length;++ye)V[ye]&&dc(V[ye])}U&&dc(K),V[K.Index-1||V.length]=K;for(var Ce=0;Ce<+K.Span;++Ce)V[V.length]=Kr(K);break;case"namedrange":if(o[1]==="/")break;J.Names||(J.Names=[]);var re=Ht(o[0]),ve={Name:re.Name,Ref:yf(re.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(ve.Sheet=J.Sheets.length-1),J.Names.push(ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=Ni(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?fse(D,de,n.slice(I,o.index)):I=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));zfe(q),le.push(q)}else l.push([o[3],!1]),u=Ni(o[0]),q={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var we=Ni(o[0]);m["!autofilter"]={ref:yf(we.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Z8(n,r);var Oe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Oe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Oe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Oe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Oe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(I,o.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else I=o.index+o[0].length;break;case"header":m["!margins"]||xu(m["!margins"]={},"xlml"),isNaN(+Ht(o[0]).Margin)||(m["!margins"].header=+Ht(o[0]).Margin);break;case"footer":m["!margins"]||xu(m["!margins"]={},"xlml"),isNaN(+Ht(o[0]).Margin)||(m["!margins"].footer=+Ht(o[0]).Margin);break;case"pagemargins":var Ze=Ht(o[0]);m["!margins"]||xu(m["!margins"]={},"xlml"),isNaN(+Ze.Top)||(m["!margins"].top=+Ze.Top),isNaN(+Ze.Left)||(m["!margins"].left=+Ze.Left),isNaN(+Ze.Right)||(m["!margins"].right=+Ze.Right),isNaN(+Ze.Bottom)||(m["!margins"].bottom=+Ze.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Oe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Oe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Oe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Oe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Oe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Oe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Oe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Oe=!1}break;case"smarttags":break;default:Oe=!1;break}if(Oe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Ife(R,de,W,n.slice(I,o.index)):(W=o,I=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Re={};return!r.bookSheets&&!r.bookProps&&(Re.Sheets=d),Re.SheetNames=h,Re.Workbook=J,Re.SSF=Kr(Bt),Re.Props=D,Re.Custprops=R,Re}function Mb(t,e){switch(h4(e=e||{}),e.type||"base64"){case"base64":return h_(La(t),e);case"binary":case"buffer":case"file":return h_(t,e);case"array":return h_(Ac(t),e)}}function Wfe(t,e){var r=[];return t.Props&&r.push(hse(t.Props,e)),t.Custprops&&r.push(gse(t.Props,t.Custprops)),r.join("")}function Vfe(){return""}function Gfe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var a=[];a.push(dt("NumberFormat",null,{"ss:Format":Dr(Bt[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(dt("Style",a.join(""),i))}),dt("Styles",r.join(""))}function aL(t){return dt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+o4(t.Ref,{r:0,c:0})})}function Hfe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(aL(s)))}return dt("Names",r.join(""))}function Kfe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(aL(o)))}return a.join("")}function Xfe(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(dt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(dt("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(dt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(dt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(bs("ProtectContents","True")),t["!protect"].objects&&s.push(bs("ProtectObjects","True")),t["!protect"].scenarios&&s.push(bs("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(bs("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(bs("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){t["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":dt("WorksheetOptions",s.join(""),{xmlns:Aa.x})}function Yfe(t){return t.map(function(e){var r=pne(e.t||""),n=dt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return dt("Comment",n,{"ss:Author":e.a})}).join("")}function Jfe(t,e,r,n,s,a,i){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Dr(o4(t.f,i))),t.F&&t.F.slice(0,e.length)==e){var l=un(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Dr(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Dr(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var h="",m="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",m=String(t.v);break;case"b":h="Boolean",m=t.v?"1":"0";break;case"e":h="Error",m=wl[t.v];break;case"d":h="DateTime",m=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Bt[14]);break;case"s":h="String",m=mne(t.v||"");break}var x=jc(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+x),o["ss:Index"]=i.c+1;var p=t.v!=null?m:"",v=t.t=="z"?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(t.c||[]).length>0&&(v+=Yfe(t.c)),dt("Cell",v,o)}function Qfe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=zf(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function qfe(t,e,r,n){if(!t["!ref"])return"";var s=_r(t["!ref"]),a=t["!merges"]||[],i=0,o=[];t["!cols"]&&t["!cols"].forEach(function(_,S){dc(_);var w=!!_.width,y=Fv(S,_),b={"ss:Index":S+1};w&&(b["ss:Width"]=kg(y.width)),_.hidden&&(b["ss:Hidden"]="1"),o.push(dt("Column",null,b))});for(var l=Array.isArray(t),u=s.s.r;u<=s.e.r;++u){for(var d=[Qfe(u,(t["!rows"]||[])[u])],h=s.s.c;h<=s.e.c;++h){var m=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>h)&&!(a[i].s.r>u)&&!(a[i].e.c<h)&&!(a[i].e.r<u)){(a[i].s.c!=h||a[i].s.r!=u)&&(m=!0);break}if(!m){var x={r:u,c:h},p=Wt(x),v=l?(t[u]||[])[h]:t[p];d.push(Jfe(v,p,t,e,r,n,x))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function Zfe(t,e,r){var n=[],s=r.SheetNames[t],a=r.Sheets[s],i=a?Kfe(a,e,t,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?qfe(a,e,t,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(Xfe(a,e,t,r)),n.join("")}function ehe(t,e){e||(e={}),t.SSF||(t.SSF=Kr(Bt)),t.SSF&&(dh(),bv(t.SSF),e.revssf=Cv(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],jc(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Wfe(t,e)),r.push(Vfe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(dt("Worksheet",Zfe(n,e,t),{"ss:Name":Dr(t.SheetNames[n])}));return r[2]=Gfe(t,e),r[3]=Hfe(t),On+dt("Workbook",r.join(""),{xmlns:Aa.ss,"xmlns:o":Aa.o,"xmlns:x":Aa.x,"xmlns:ss":Aa.ss,"xmlns:dt":Aa.dt,"xmlns:html":Aa.html})}function the(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Hne(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=Kne(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var rhe=[60,1084,2066,2165,2175];function nhe(t,e,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=Yo(r,r.l),u=Lb[l],d=0;u!=null&&rhe.indexOf(l)>-1;)a=Yo(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=Lb[l=Yo(r,r.l)];var h=fs(i);ws(h,0);var m=0;h.lens=[];for(var x=0;x<i.length;++x)h.lens.push(m),m+=i[x].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function ro(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Bt[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||wl[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=yg(t.v):t.w=Mu(t.v):t.w=yi(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&uh(Bt[n]||String(n))){var s=au(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Zp(t,e,r){return{v:t,ixfe:e,t:r}}function she(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},i={},o=null,l=[],u="",d={},h,m="",x,p,v,_,S={},w=[],y,b,E=[],N=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},P=function(it){return it<8?gu[it]:it<64&&N[it-8]||gu[it]},D=function(it,rt,xe){var De=rt.XF.data;if(!(!De||!De.patternType||!xe||!xe.cellStyles)){rt.s={},rt.s.patternType=De.patternType;var Le;(Le=bg(P(De.icvFore)))&&(rt.s.fgColor={rgb:Le}),(Le=bg(P(De.icvBack)))&&(rt.s.bgColor={rgb:Le})}},R=function(it,rt,xe){if(!(ne>1)&&!(xe.sheetRows&&it.r>=xe.sheetRows)){if(xe.cellStyles&&rt.XF&&rt.XF.data&&D(it,rt,xe),delete rt.ixfe,delete rt.XF,h=it,m=Wt(it),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),it.r<i.s.r&&(i.s.r=it.r),it.c<i.s.c&&(i.s.c=it.c),it.r+1>i.e.r&&(i.e.r=it.r+1),it.c+1>i.e.c&&(i.e.c=it.c+1),xe.cellFormula&&rt.f){for(var De=0;De<w.length;++De)if(!(w[De][0].s.c>it.c||w[De][0].s.r>it.r)&&!(w[De][0].e.c<it.c||w[De][0].e.r<it.r)){rt.F=er(w[De][0]),(w[De][0].s.c!=it.c||w[De][0].s.r!=it.r)&&delete rt.f,rt.f&&(rt.f=""+Ls(w[De][1],i,it,L,I));break}}xe.dense?(s[it.r]||(s[it.r]=[]),s[it.r][it.c]=rt):s[m]=rt}},I={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(I.password=e.password);var W,le=[],q=[],V=[],K=[],U=!1,L=[];L.SheetNames=I.snames,L.sharedf=I.sharedf,L.arrayf=I.arrayf,L.names=[],L.XTI=[];var Z=0,ne=0,z=0,Y=[],J=[],te;I.codepage=1200,Oi(1200);for(var de=!1;t.l<t.length-1;){var ee=t.l,ge=t.read_shift(2);if(ge===0&&Z===10)break;var fe=t.l===t.length?0:t.read_shift(2),ye=Lb[ge];if(ye&&ye.f){if(e.bookSheets&&Z===133&&ge!==133)break;if(Z=ge,ye.r===2||ye.r==12){var Ce=t.read_shift(2);if(fe-=2,!I.enc&&Ce!==ge&&((Ce&255)<<8|Ce>>8)!==ge)throw new Error("rt mismatch: "+Ce+"!="+ge);ye.r==12&&(t.l+=10,fe-=10)}var re={};if(ge===10?re=ye.f(t,fe,I):re=nhe(ge,ye,t,fe,I),ne==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(ge){case 34:r.opts.Date1904=F.WBProps.date1904=re;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(t.l=0),I.enc=re,!e.password)throw new Error("File is password-protected");if(re.valid==null)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=re;break;case 66:var ve=Number(re);switch(ve){case 21010:ve=1200;break;case 32768:ve=1e4;break;case 32769:ve=1252;break}Oi(I.codepage=ve),de=!0;break;case 317:I.rrtabid=re;break;case 25:I.winlocked=re;break;case 439:r.opts.RefreshAll=re;break;case 12:r.opts.CalcCount=re;break;case 16:r.opts.CalcDelta=re;break;case 17:r.opts.CalcIter=re;break;case 13:r.opts.CalcMode=re;break;case 14:r.opts.CalcPrecision=re;break;case 95:r.opts.CalcSaveRecalc=re;break;case 15:I.CalcRefMode=re;break;case 2211:r.opts.FullCalc=re;break;case 129:re.fDialog&&(s["!type"]="dialog"),re.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),re.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:E.push(re);break;case 430:L.push([re]),L[L.length-1].XTI=[];break;case 35:case 547:L[L.length-1].push(re);break;case 24:case 536:te={Name:re.Name,Ref:Ls(re.rgce,i,null,L,I)},re.itab>0&&(te.Sheet=re.itab-1),L.names.push(te),L[0]||(L[0]=[],L[0].XTI=[]),L[L.length-1].push(re),re.Name=="_xlnm._FilterDatabase"&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&re.rgce[0][0][0]=="PtgArea3d"&&(J[re.itab-1]={ref:er(re.rgce[0][0][1][2])});break;case 22:I.ExternCount=re;break;case 23:L.length==0&&(L[0]=[],L[0].XTI=[]),L[L.length-1].XTI=L[L.length-1].XTI.concat(re),L.XTI=L.XTI.concat(re);break;case 2196:if(I.biff<8)break;te!=null&&(te.Comment=re[1]);break;case 18:s["!protect"]=re;break;case 19:re!==0&&I.WTF&&console.error("Password verifier: "+re);break;case 133:a[re.pos]=re,I.snames.push(re.name);break;case 10:{if(--ne)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=er(i),e.sheetRows&&e.sheetRows<=i.e.r){var we=i.e.r;i.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=er(i),i.e.r=we}i.e.r++,i.e.c++}le.length>0&&(s["!merges"]=le),q.length>0&&(s["!objects"]=q),V.length>0&&(s["!cols"]=V),K.length>0&&(s["!rows"]=K),F.Sheets.push(T)}u===""?d=s:n[u]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[ge]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),I.biffguess=re.BIFFVer==0,re.BIFFVer==0&&re.dt==4096&&(I.biff=5,de=!0,Oi(I.codepage=28591)),I.biff==8&&re.BIFFVer==0&&re.dt==16&&(I.biff=2),ne++)break;if(s=e.dense?[]:{},I.biff<8&&!de&&(de=!0,Oi(I.codepage=e.codepage||1252)),I.biff<5||re.BIFFVer==0&&re.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Oe={pos:t.l-fe,name:u};a[Oe.pos]=Oe,I.snames.push(u)}else u=(a[ee]||{name:""}).name;re.dt==32&&(s["!type"]="chart"),re.dt==64&&(s["!type"]="macro"),le=[],q=[],I.arrayf=w=[],V=[],K=[],U=!1,T={Hidden:(a[ee]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[re.r]||[])[re.c]:s[Wt({c:re.c,r:re.r})])&&++re.c,y={ixfe:re.ixfe,XF:E[re.ixfe]||{},v:re.val,t:"n"},z>0&&(y.z=Y[y.ixfe>>8&63]),ro(y,e,r.opts.Date1904),R({c:re.c,r:re.r},y,e);break;case 5:case 517:y={ixfe:re.ixfe,XF:E[re.ixfe],v:re.val,t:re.t},z>0&&(y.z=Y[y.ixfe>>8&63]),ro(y,e,r.opts.Date1904),R({c:re.c,r:re.r},y,e);break;case 638:y={ixfe:re.ixfe,XF:E[re.ixfe],v:re.rknum,t:"n"},z>0&&(y.z=Y[y.ixfe>>8&63]),ro(y,e,r.opts.Date1904),R({c:re.c,r:re.r},y,e);break;case 189:for(var Ze=re.c;Ze<=re.C;++Ze){var Re=re.rkrec[Ze-re.c][0];y={ixfe:Re,XF:E[Re],v:re.rkrec[Ze-re.c][1],t:"n"},z>0&&(y.z=Y[y.ixfe>>8&63]),ro(y,e,r.opts.Date1904),R({c:Ze,r:re.r},y,e)}break;case 6:case 518:case 1030:{if(re.val=="String"){o=re;break}if(y=Zp(re.val,re.cell.ixfe,re.tt),y.XF=E[y.ixfe],e.cellFormula){var xt=re.formula;if(xt&&xt[0]&&xt[0][0]&&xt[0][0][0]=="PtgExp"){var $t=xt[0][0][1][0],Ae=xt[0][0][1][1],Pe=Wt({r:$t,c:Ae});S[Pe]?y.f=""+Ls(re.formula,i,re.cell,L,I):y.F=((e.dense?(s[$t]||[])[Ae]:s[Pe])||{}).F}else y.f=""+Ls(re.formula,i,re.cell,L,I)}z>0&&(y.z=Y[y.ixfe>>8&63]),ro(y,e,r.opts.Date1904),R(re.cell,y,e),o=re}break;case 7:case 519:if(o)o.val=re,y=Zp(re,o.cell.ixfe,"s"),y.XF=E[y.ixfe],e.cellFormula&&(y.f=""+Ls(o.formula,i,o.cell,L,I)),z>0&&(y.z=Y[y.ixfe>>8&63]),ro(y,e,r.opts.Date1904),R(o.cell,y,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(re);var Ue=Wt(re[0].s);if(x=e.dense?(s[re[0].s.r]||[])[re[0].s.c]:s[Ue],e.cellFormula&&x){if(!o||!Ue||!x)break;x.f=""+Ls(re[1],i,re[0],L,I),x.F=er(re[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!o)break;S[Wt(o.cell)]=re[0],x=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Wt(o.cell)],(x||{}).f=""+Ls(re[0],i,h,L,I)}}break;case 253:y=Zp(l[re.isst].t,re.ixfe,"s"),l[re.isst].h&&(y.h=l[re.isst].h),y.XF=E[y.ixfe],z>0&&(y.z=Y[y.ixfe>>8&63]),ro(y,e,r.opts.Date1904),R({c:re.c,r:re.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:re.ixfe,XF:E[re.ixfe],t:"z"},z>0&&(y.z=Y[y.ixfe>>8&63]),ro(y,e,r.opts.Date1904),R({c:re.c,r:re.r},y,e));break;case 190:if(e.sheetStubs)for(var We=re.c;We<=re.C;++We){var Xe=re.ixfe[We-re.c];y={ixfe:Xe,XF:E[Xe],t:"z"},z>0&&(y.z=Y[y.ixfe>>8&63]),ro(y,e,r.opts.Date1904),R({c:We,r:re.r},y,e)}break;case 214:case 516:case 4:y=Zp(re.val,re.ixfe,"s"),y.XF=E[y.ixfe],z>0&&(y.z=Y[y.ixfe>>8&63]),ro(y,e,r.opts.Date1904),R({c:re.c,r:re.r},y,e);break;case 0:case 512:ne===1&&(i=re);break;case 252:l=re;break;case 1054:if(I.biff==4){Y[z++]=re[1];for(var ut=0;ut<z+163&&Bt[ut]!=re[1];++ut);ut>=163&&el(re[1],z+163)}else el(re[1],re[0]);break;case 30:{Y[z++]=re;for(var Ct=0;Ct<z+163&&Bt[Ct]!=re;++Ct);Ct>=163&&el(re,z+163)}break;case 229:le=le.concat(re);break;case 93:q[re.cmo[0]]=I.lastobj=re;break;case 438:I.lastobj.TxO=re;break;case 127:I.lastobj.ImData=re;break;case 440:for(_=re[0].s.r;_<=re[0].e.r;++_)for(v=re[0].s.c;v<=re[0].e.c;++v)x=e.dense?(s[_]||[])[v]:s[Wt({c:v,r:_})],x&&(x.l=re[1]);break;case 2048:for(_=re[0].s.r;_<=re[0].e.r;++_)for(v=re[0].s.c;v<=re[0].e.c;++v)x=e.dense?(s[_]||[])[v]:s[Wt({c:v,r:_})],x&&x.l&&(x.l.Tooltip=re[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;x=e.dense?(s[re[0].r]||[])[re[0].c]:s[Wt(re[0])];var Mt=q[re[2]];x||(e.dense?(s[re[0].r]||(s[re[0].r]=[]),x=s[re[0].r][re[0].c]={t:"z"}):x=s[Wt(re[0])]={t:"z"},i.e.r=Math.max(i.e.r,re[0].r),i.s.r=Math.min(i.s.r,re[0].r),i.e.c=Math.max(i.e.c,re[0].c),i.s.c=Math.min(i.s.c,re[0].c)),x.c||(x.c=[]),p={a:re[1],t:Mt.TxO.t},x.c.push(p)}break;case 2173:Goe(E[re.ixfe],re.ext);break;case 125:{if(!I.cellStyles)break;for(;re.e>=re.s;)V[re.e--]={width:re.w/256,level:re.level||0,hidden:!!(re.flags&1)},U||(U=!0,s4(re.w/256)),dc(V[re.e+1])}break;case 520:{var At={};re.level!=null&&(K[re.r]=At,At.level=re.level),re.hidden&&(K[re.r]=At,At.hidden=!0),re.hpt&&(K[re.r]=At,At.hpt=re.hpt,At.hpx=zf(re.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||xu(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ge]]=re;break;case 161:s["!margins"]||xu(s["!margins"]={}),s["!margins"].header=re.header,s["!margins"].footer=re.footer;break;case 574:re.RTL&&(F.Views[0].RTL=!0);break;case 146:N=re;break;case 2198:W=re;break;case 140:b=re;break;case 442:u?T.CodeName=re||T.name:F.WBProps.CodeName=re||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+ge.toString(16)),t.l+=fe}return r.SheetNames=bn(a).sort(function(Pt,it){return Number(Pt)-Number(it)}).map(function(Pt){return a[Pt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&J.forEach(function(Pt,it){r.Sheets[r.SheetNames[it]]["!autofilter"]=Pt}),r.Strings=l,r.SSF=Kr(Bt),I.enc&&(r.Encryption=I.enc),W&&(r.Themes=W),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),L.names.length>0&&(F.Names=L.names),r.Workbook=F,r}var D0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ahe(t,e,r){var n=Dt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=A8(n,Fb,D0.DSI);for(var a in s)e[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Dt.find(t,"/!SummaryInformation");if(i&&i.size>0)try{var o=A8(i,jb,D0.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(sM(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function ihe(t,e){var r=[],n=[],s=[],a=0,i,o=a8(Fb,"n"),l=a8(jb,"n");if(t.Props)for(i=bn(t.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],t.Props[i[a]]]);if(t.Custprops)for(i=bn(t.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],t.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)dM.indexOf(s[a][0])>-1||nM.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Dt.utils.cfb_add(e,"/SummaryInformation",F8(n,D0.SI,l,jb)),(r.length||u.length)&&Dt.utils.cfb_add(e,"/DocumentSummaryInformation",F8(r,D0.DSI,o,Fb,u.length?u:null,D0.UDI))}function iL(t,e){e||(e={}),h4(e),RT(),e.codepage&&DT(e.codepage);var r,n;if(t.FullPaths){if(Dt.find(t,"/encryption"))throw new Error("File is password-protected");r=Dt.find(t,"!CompObj"),n=Dt.find(t,"/Workbook")||Dt.find(t,"/Book")}else{switch(e.type){case"base64":t=ja(La(t));break;case"binary":t=ja(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ws(t,0),n={content:t}}var s,a;if(r&&the(r),e.bookProps&&!e.bookSheets)s={};else{var i=ir?"buffer":"array";if(n&&n.content)s=she(n.content,e);else if((a=Dt.find(t,"PerfectOffice_MAIN"))&&a.content)s=pu.to_workbook(a.content,(e.type=i,e));else if((a=Dt.find(t,"NativeContent_MAIN"))&&a.content)s=pu.to_workbook(a.content,(e.type=i,e));else throw(a=Dt.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Dt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=vle(t))}var o={};return t.FullPaths&&ahe(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}function ohe(t,e){var r=e||{},n=Dt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Dt.utils.cfb_add(n,s,oL(t,r)),r.biff==8&&(t.Props||t.Custprops)&&ihe(t,n),r.biff==8&&t.vbaraw&&wle(n,Dt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Eg={0:{f:jue},1:{f:Bue},2:{f:sde},3:{f:Kue},4:{f:Wue},5:{f:tde},6:{f:cde},7:{f:Que},8:{f:pde},9:{f:mde},10:{f:hde},11:{f:gde},12:{f:$ue},13:{f:ide},14:{f:Yue},15:{f:Gue},16:{f:qM},17:{f:dde},18:{f:Zue},19:{f:XT},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:dfe},40:{},42:{},43:{f:coe},44:{f:ooe},45:{f:foe},46:{f:goe},47:{f:hoe},48:{},49:{f:Rne},50:{},51:{f:Xoe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:SM},62:{f:lde},63:{f:nle},64:{f:Pde},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Nde},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Lue},148:{f:Rue,p:16},151:{f:Sde},152:{},153:{f:lfe},154:{},155:{},156:{f:ife},157:{},158:{},159:{T:1,f:kie},160:{T:-1},161:{T:1,f:od},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:xde},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Hoe},336:{T:-1},337:{f:Qoe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ab},357:{},358:{},359:{},360:{T:1},361:{},362:{f:_M},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:bde},427:{f:kde},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Tde},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Mue},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wde},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ab},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:gle},633:{T:1},634:{T:-1},635:{T:1,f:fle},636:{T:-1},637:{f:Ine},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Yde},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Dde},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Lb={6:{f:d_},10:{f:jl},12:{f:$n},13:{f:$n},14:{f:En},15:{f:En},16:{f:Us},17:{f:En},18:{f:En},19:{f:$n},20:{f:M8},21:{f:M8},23:{f:_M},24:{f:I8},25:{f:En},26:{},27:{},28:{f:Dae},29:{},34:{f:En},35:{f:L8},38:{f:Us},39:{f:Us},40:{f:Us},41:{f:Us},42:{f:En},43:{f:En},47:{f:Gie},49:{f:iae},51:{f:$n},60:{},61:{f:tae},64:{f:En},65:{f:aae},66:{f:$n},77:{},80:{},81:{},82:{},85:{f:$n},89:{},90:{},91:{},92:{f:Vse},93:{f:Mae},94:{},95:{f:En},96:{},97:{},99:{f:En},125:{f:SM},128:{f:_ae},129:{f:Hse},130:{f:$n},131:{f:En},132:{f:En},133:{f:Kse},134:{},140:{f:Vae},141:{f:$n},144:{},146:{f:Kae},151:{},152:{},153:{},154:{},155:{},156:{f:$n},157:{},158:{},160:{f:eie},161:{f:Jae},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:xae},190:{f:yae},193:{f:jl},197:{},198:{},199:{},200:{},201:{},202:{f:En},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:$n},220:{},221:{f:En},222:{},224:{f:wae},225:{f:Wse},226:{f:jl},227:{},229:{f:Rae},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Yse},253:{f:lae},255:{f:Qse},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:fM},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:En},353:{f:jl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Tae},431:{f:En},432:{},433:{},434:{},437:{},438:{f:Bae},439:{f:En},440:{f:Uae},441:{},442:{f:um},443:{},444:{f:$n},445:{},446:{},448:{f:jl},449:{f:eae,r:2},450:{f:jl},512:{f:D8},513:{f:Zae},515:{f:kae},516:{f:uae},517:{f:O8},519:{f:tie},520:{f:qse},523:{},545:{f:B8},549:{f:P8},566:{},574:{f:nae},638:{f:pae},659:{},1048:{},1054:{f:fae},1084:{},1212:{f:Fae},2048:{f:zae},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Jp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:jl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Xae,r:12},2173:{f:Voe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:En,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Aae,r:12},2197:{},2198:{f:Ioe,r:12},2199:{},2200:{},2201:{},2202:{f:jae,r:12},2203:{f:jl},2204:{},2205:{},2206:{},2207:{},2211:{f:Zse},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:$n},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Qae},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Hae},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:D8},1:{},2:{f:iie},3:{f:sie},4:{f:nie},5:{f:O8},7:{f:lie},8:{},9:{f:Jp},11:{},22:{f:$n},30:{f:gae},31:{},32:{},33:{f:B8},36:{},37:{f:P8},50:{f:cie},62:{},52:{},67:{},68:{f:$n},69:{},86:{},126:{},127:{f:rie},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:uie},223:{},234:{},354:{},421:{},518:{f:d_},521:{f:Jp},536:{f:I8},547:{f:L8},561:{},579:{},1030:{f:d_},1033:{f:Jp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ft(t,e,r,n){var s=e;if(!isNaN(s)){var a=n||(r||[]).length||0,i=t.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&GT(r)&&t.push(r)}}function lhe(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return ft(t,e,r,s);var a=e;if(!isNaN(a)){for(var i=r.parts||[],o=0,l=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,a),d.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<s;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function gm(t,e,r){return t||(t=Ye(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function che(t,e,r,n){var s=Ye(9);return gm(s,t,e),hM(r,n||"b",s),s}function uhe(t,e,r){var n=Ye(8+2*r.length);return gm(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function dhe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?es(Hr(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?ft(t,2,oie(r,n,s)):ft(t,3,aie(r,n,s));return;case"b":case"e":ft(t,5,che(r,n,e.v,e.t));return;case"s":case"str":ft(t,4,uhe(r,n,(e.v||"").slice(0,255)));return}ft(t,1,gm(null,r,n))}function fhe(t,e,r,n){var s=Array.isArray(e),a=_r(e["!ref"]||"A1"),i,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=er(a)}for(var u=a.s.r;u<=a.e.r;++u){o=Pn(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(l[d]=cn(d)),i=l[d]+o;var h=s?(e[u]||[])[d]:e[i];h&&dhe(t,h,u,d)}}}function hhe(t,e){for(var r=e||{},n=Sa(),s=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ft(n,r.biff==4?1033:r.biff==3?521:9,t4(t,16,r)),fhe(n,t.Sheets[t.SheetNames[s]],s,r),ft(n,10),n.end()}function ghe(t,e,r){ft(t,49,oae({sz:12,name:"Arial"},r))}function mhe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&ft(t,1054,hae(s,e[s],r))})}function phe(t,e){var r=Ye(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ft(t,2151,r),r=Ye(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),yM(_r(e["!ref"]||"A1"),r),r.write_shift(4,4),ft(t,2152,r)}function xhe(t,e){for(var r=0;r<16;++r)ft(t,224,R8({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ft(t,224,R8(n,0,e))})}function yhe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ft(t,440,$ae(n)),n[1].Tooltip&&ft(t,2048,Wae(n))}delete e["!links"]}function vhe(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&ft(t,125,Yae(Fv(s,n),s))})}}function whe(t,e,r,n,s){var a=16+jc(s.cellXfs,e,s);if(e.v==null&&!e.bf){ft(t,513,Uu(r,n,a));return}if(e.bf)ft(t,6,Hce(e,r,n,s,a));else switch(e.t){case"d":case"n":var i=e.t=="d"?es(Hr(e.v)):e.v;ft(t,515,Cae(r,n,i,a));break;case"b":case"e":ft(t,517,bae(r,n,e.v,a,s,e.t));break;case"s":case"str":if(s.bookSST){var o=c4(s.Strings,e.v,s.revStrings);ft(t,253,cae(r,n,o,a))}else ft(t,516,dae(r,n,(e.v||"").slice(0,255),a,s));break;default:ft(t,513,Uu(r,n,a))}}function _he(t,e,r){var n=Sa(),s=r.SheetNames[t],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[t]||{},l=Array.isArray(a),u=e.biff==8,d,h="",m=[],x=_r(a["!ref"]||"A1"),p=u?65536:16384;if(x.e.c>255||x.e.r>=p){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,p-1)}ft(n,2057,t4(r,16,e)),ft(n,13,si(1)),ft(n,12,si(100)),ft(n,15,qs(!0)),ft(n,17,qs(!1)),ft(n,16,Iu(.001)),ft(n,95,qs(!0)),ft(n,42,qs(!1)),ft(n,43,qs(!1)),ft(n,130,si(1)),ft(n,128,Sae()),ft(n,131,qs(!1)),ft(n,132,qs(!1)),u&&vhe(n,a["!cols"]),ft(n,512,mae(x,e)),u&&(a["!links"]=[]);for(var v=x.s.r;v<=x.e.r;++v){h=Pn(v);for(var _=x.s.c;_<=x.e.c;++_){v===x.s.r&&(m[_]=cn(_)),d=m[_]+h;var S=l?(a[v]||[])[_]:a[d];S&&(whe(n,S,v,_,e),u&&S.l&&a["!links"].push([d,S.l]))}}var w=o.CodeName||o.name||s;return u&&ft(n,574,sae((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&ft(n,229,Oae(a["!merges"])),u&&yhe(n,a),ft(n,442,gM(w)),u&&phe(n,a),ft(n,10),n.end()}function She(t,e,r){var n=Sa(),s=(t||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,l=r.biff==5;if(ft(n,2057,t4(t,5,r)),r.bookType=="xla"&&ft(n,135),ft(n,225,o?si(1200):null),ft(n,193,bse(2)),l&&ft(n,191),l&&ft(n,192),ft(n,226),ft(n,92,Gse("SheetJS",r)),ft(n,66,si(o?1200:1252)),o&&ft(n,353,si(0)),o&&ft(n,448),ft(n,317,qae(t.SheetNames.length)),o&&t.vbaraw&&ft(n,211),o&&t.vbaraw){var u=i.CodeName||"ThisWorkbook";ft(n,442,gM(u))}ft(n,156,si(17)),ft(n,25,qs(!1)),ft(n,18,qs(!1)),ft(n,19,si(0)),o&&ft(n,431,qs(!1)),o&&ft(n,444,si(0)),ft(n,61,rae()),ft(n,64,qs(!1)),ft(n,141,si(0)),ft(n,34,qs(efe(t)=="true")),ft(n,14,qs(!0)),o&&ft(n,439,qs(!1)),ft(n,218,si(0)),ghe(n,t,r),mhe(n,t.SSF,r),xhe(n,r),o&&ft(n,352,qs(!1));var d=n.end(),h=Sa();o&&ft(h,140,Gae()),o&&r.Strings&&lhe(h,252,Jse(r.Strings)),ft(h,10);var m=h.end(),x=Sa(),p=0,v=0;for(v=0;v<t.SheetNames.length;++v)p+=(o?12:11)+(o?2:1)*t.SheetNames[v].length;var _=d.length+p+m.length;for(v=0;v<t.SheetNames.length;++v){var S=a[v]||{};ft(x,133,Xse({pos:_,hs:S.Hidden||0,dt:0,name:t.SheetNames[v]},r)),_+=e[v].length}var w=x.end();if(p!=w.length)throw new Error("BS8 "+p+" != "+w.length);var y=[];return d.length&&y.push(d),w.length&&y.push(w),m.length&&y.push(m),fs(y)}function bhe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Kr(Bt)),t&&t.SSF&&(dh(),bv(t.SSF),r.revssf=Cv(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,g4(r),r.cellXfs=[],jc(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=_he(s,r,t);return n.unshift(She(t,n,r)),fs(n)}function oL(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=ba(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return bhe(t,e);case 4:case 3:case 2:return hhe(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Y8(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),i=s.index,o=a&&a.index||t.length,l=one(t.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,h=0,m=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<l.length;++i){var v=l[i].trim(),_=v.slice(0,3).toLowerCase();if(_=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(_!="<td"&&_!="<th")){var S=v.split(/<\/t[dh]>/i);for(o=0;o<S.length;++o){var w=S[o].trim();if(w.match(/<t[dh]/i)){for(var y=w,b=0;y.charAt(0)=="<"&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var E=0;E<p.length;++E){var N=p[E];N.s.c==d&&N.s.r<u&&u<=N.e.r&&(d=N.e.c+1,E=-1)}var F=Ht(w.slice(0,w.indexOf(">")));m=F.colspan?+F.colspan:1,((h=+F.rowspan)>1||m>1)&&p.push({s:{r:u,c:d},e:{r:u+(h||1)-1,c:d+m-1}});var T=F.t||F["data-t"]||"";if(!y.length){d+=m;continue}if(y=jO(y),x.s.r>u&&(x.s.r=u),x.e.r<u&&(x.e.r=u),x.s.c>d&&(x.s.c=d),x.e.c<d&&(x.e.c=d),!y.length){d+=m;continue}var P={t:"s",v:y};r.raw||!y.trim().length||T=="s"||(y==="TRUE"?P={t:"b",v:!0}:y==="FALSE"?P={t:"b",v:!1}:isNaN($i(y))?isNaN(Uf(y).getDate())||(P={t:"d",v:Hr(y)},r.cellDates||(P={t:"n",v:es(P.v)}),P.z=r.dateNF||Bt[14]):P={t:"n",v:$i(y)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=P):n[Wt({r:u,c:d})]=P,d+=m}}}}return n["!ref"]=er(x),p.length&&(n["!merges"]=p),n}function khe(t,e,r,n){for(var s=t["!merges"]||[],a=[],i=e.s.c;i<=e.e.c;++i){for(var o=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Wt({r,c:i}),h=n.dense?(t[r]||[])[i]:t[d],m=h&&h.v!=null&&(h.h||zT(h.w||(ul(h),h.w)||""))||"",x={};o>1&&(x.rowspan=o),l>1&&(x.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(x["data-t"]=h&&h.t||"z",h.v!=null&&(x["data-v"]=h.v),h.z!=null&&(x["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),x.id=(n.id||"sjs")+"-"+d,a.push(dt("td",m,x))}}var p="<tr>";return p+a.join("")+"</tr>"}var Che='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',The="</body></html>";function Ehe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Fc(Y8(r[0],e),e);var n=x4();return r.forEach(function(s,a){y4(n,Y8(s,e),"Sheet"+(a+1))}),n}function Nhe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function lL(t,e){var r=e||{},n=r.header!=null?r.header:Che,s=r.footer!=null?r.footer:The,a=[n],i=ba(t["!ref"]);r.dense=Array.isArray(t),a.push(Nhe(t,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(khe(t,i,o,r));return a.push("</table>"+s),a.join("")}function cL(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?un(n.origin):n.origin;s=i.r,a=i.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var d=ba(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var h=[],m=0,x=t["!rows"]||(t["!rows"]=[]),p=0,v=0,_=0,S=0,w=0,y=0;for(t["!cols"]||(t["!cols"]=[]);p<o.length&&v<l;++p){var b=o[p];if(J8(b)){if(n.display)continue;x[v]={hidden:!0}}var E=b.children;for(_=S=0;_<E.length;++_){var N=E[_];if(!(n.display&&J8(N))){var F=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):jO(N.innerHTML),T=N.getAttribute("data-z")||N.getAttribute("z");for(m=0;m<h.length;++m){var P=h[m];P.s.c==S+a&&P.s.r<v+s&&v+s<=P.e.r&&(S=P.e.c+1-a,m=-1)}y=+N.getAttribute("colspan")||1,((w=+N.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:v+s,c:S+a},e:{r:v+s+(w||1)-1,c:S+a+(y||1)-1}});var D={t:"s",v:F},R=N.getAttribute("data-t")||N.getAttribute("t")||"";F!=null&&(F.length==0?D.t=R||"z":n.raw||F.trim().length==0||R=="s"||(F==="TRUE"?D={t:"b",v:!0}:F==="FALSE"?D={t:"b",v:!1}:isNaN($i(F))?isNaN(Uf(F).getDate())||(D={t:"d",v:Hr(F)},n.cellDates||(D={t:"n",v:es(D.v)}),D.z=n.dateNF||Bt[14]):D={t:"n",v:$i(F)})),D.z===void 0&&T!=null&&(D.z=T);var I="",W=N.getElementsByTagName("A");if(W&&W.length)for(var le=0;le<W.length&&!(W[le].hasAttribute("href")&&(I=W[le].getAttribute("href"),I.charAt(0)!="#"));++le);I&&I.charAt(0)!="#"&&(D.l={Target:I}),n.dense?(t[v+s]||(t[v+s]=[]),t[v+s][S+a]=D):t[Wt({c:S+a,r:v+s})]=D,u.e.c<S+a&&(u.e.c=S+a),S+=y}}++v}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,v-1+s),t["!ref"]=er(u),v>=l&&(t["!fullref"]=er((u.e.r=o.length-p+v-1+s,u))),t}function uL(t,e){var r=e||{},n=r.dense?[]:{};return cL(n,t,e)}function Ahe(t,e){return Fc(uL(t,e),e)}function J8(t){var e="",r=Fhe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Fhe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function jhe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=wr(e.replace(/<[^>]*>/g,""));return[r]}var Q8={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function dL(t,e){var r=e||{},n=WT(t),s=[],a,i,o={name:""},l="",u=0,d,h,m={},x=[],p=r.dense?[]:{},v,_,S={value:""},w="",y=0,b=[],E=-1,N=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,P={},D=[],R={},I=0,W=0,le=[],q=1,V=1,K=[],U={Names:[]},L={},Z=["",""],ne=[],z={},Y="",J=0,te=!1,de=!1,ee=0;for(_g.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=_g.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?p["!ref"]=er(F):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(p["!fullref"]=p["!ref"],F.e.r=r.sheetRows-1,p["!ref"]=er(F)),D.length&&(p["!merges"]=D),le.length&&(p["!rows"]=le),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),x.push(d.name),m[d.name]=p,de=!1):v[0].charAt(v[0].length-2)!=="/"&&(d=Ht(v[0],!1),E=N=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,p=r.dense?[]:{},D=[],le=[],de=!0);break;case"table-row-group":v[1]==="/"?--T:++T;break;case"table-row":case"":if(v[1]==="/"){E+=q,q=1;break}if(h=Ht(v[0],!1),h.?E=h.-1:E==-1&&(E=0),q=+h["number-rows-repeated"]||1,q<10)for(ee=0;ee<q;++ee)T>0&&(le[E+ee]={level:T});N=-1;break;case"covered-table-cell":v[1]!=="/"&&++N,r.sheetStubs&&(r.dense?(p[E]||(p[E]=[]),p[E][N]={t:"z"}):p[Wt({r:E,c:N})]={t:"z"}),w="",b=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++N,S=Ht(v[0],!1),V=parseInt(S["number-columns-repeated"]||"1",10),_={t:"z",v:null},S.formula&&r.cellFormula!=!1&&(_.f=H8(wr(S.formula))),(S.||S["value-type"])=="string"&&(_.t="s",_.v=wr(S["string-value"]||""),r.dense?(p[E]||(p[E]=[]),p[E][N]=_):p[Wt({r:E,c:N})]=_),N+=V-1;else if(v[1]!=="/"){++N,w="",y=0,b=[],V=1;var ge=q?E+q-1:E;if(N>F.e.c&&(F.e.c=N),N<F.s.c&&(F.s.c=N),E<F.s.r&&(F.s.r=E),ge>F.e.r&&(F.e.r=ge),S=Ht(v[0],!1),ne=[],z={},_={t:S.||S["value-type"],v:null},r.cellFormula)if(S.formula&&(S.formula=wr(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(I=parseInt(S["number-matrix-rows-spanned"],10)||0,W=parseInt(S["number-matrix-columns-spanned"],10)||0,R={s:{r:E,c:N},e:{r:E+I-1,c:N+W-1}},_.F=er(R),K.push([R,_.F])),S.formula)_.f=H8(S.formula);else for(ee=0;ee<K.length;++ee)E>=K[ee][0].s.r&&E<=K[ee][0].e.r&&N>=K[ee][0].s.c&&N<=K[ee][0].e.c&&(_.F=K[ee][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(I=parseInt(S["number-rows-spanned"],10)||0,W=parseInt(S["number-columns-spanned"],10)||0,R={s:{r:E,c:N},e:{r:E+I-1,c:N+W-1}},D.push(R)),S["number-columns-repeated"]&&(V=parseInt(S["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Wr(S["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(S.value);break;case"percentage":_.t="n",_.v=parseFloat(S.value);break;case"currency":_.t="n",_.v=parseFloat(S.value);break;case"date":_.t="d",_.v=Hr(S["date-value"]),r.cellDates||(_.t="n",_.v=es(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=sne(S["time-value"])/86400,r.cellDates&&(_.t="d",_.v=Tv(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(S.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",S["string-value"]!=null&&(w=wr(S["string-value"]),b=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(te=!1,_.t==="s"&&(_.v=w||"",b.length&&(_.R=b),te=y==0),L.Target&&(_.l=L),ne.length>0&&(_.c=ne,ne=[]),w&&r.cellText!==!1&&(_.w=w),te&&(_.t="z",delete _.v),(!te||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var fe=0;fe<q;++fe){if(V=parseInt(S["number-columns-repeated"]||"1",10),r.dense)for(p[E+fe]||(p[E+fe]=[]),p[E+fe][N]=fe==0?_:Kr(_);--V>0;)p[E+fe][N+V]=Kr(_);else for(p[Wt({r:E+fe,c:N})]=_;--V>0;)p[Wt({r:E+fe,c:N+V})]=Kr(_);F.e.c<=N&&(F.e.c=N)}V=parseInt(S["number-columns-repeated"]||"1",10),N+=V-1,V=0,_={},w="",b=[]}L={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;z.t=w,b.length&&(z.R=b),z.a=Y,ne.push(z)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);Y="",J=0,w="",y=0,b=[];break;case"creator":v[1]==="/"?Y=n.slice(J,v.index):J=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);w="",y=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(P[o.name]=l,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=Ht(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Ht(v[0],!1),l+=Q8[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Ht(v[0],!1),l+=Q8[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,v.index);break}else u=v.index+v[0].length;break;case"named-range":i=Ht(v[0],!1),Z=f_(i["cell-range-address"]);var ye={Name:i.name,Ref:Z[0]+"!"+Z[1]};de&&(ye.Sheet=x.length),U.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!S||!S["string-value"])){var Ce=jhe(n.slice(y,v.index));w=(w.length>0?w+`
`:"")+Ce[0]}else Ht(v[0],!1),y=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{Z=f_(Ht(v[0])["target-range-address"]),m[Z[0]]["!autofilter"]={ref:Z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(L=Ht(v[0],!1),!L.href)break;L.Target=wr(L.href),delete L.href,L.Target.charAt(0)=="#"&&L.Target.indexOf(".")>-1?(Z=f_(L.Target.slice(1)),L.Target="#"+Z[0]+"!"+Z[1]):L.Target.match(/^\.\.[\\\/]/)&&(L.Target=L.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var re={Sheets:m,SheetNames:x,Workbook:U};return r.bookSheets&&delete re.Sheets,re}function q8(t,e){e=e||{},ni(t,"META-INF/manifest.xml")&&sse(Un(t,"META-INF/manifest.xml"),e);var r=Pa(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=dL(Mr(r),e);return ni(t,"meta.xml")&&(n.Props=tM(Un(t,"meta.xml"))),n}function Z8(t,e){return dL(t,e)}var Phe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+wg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return On+e}}(),eF=function(){var t=function(a){return Dr(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var l=[];l.push('      <table:table table:name="'+Dr(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,h=ba(a["!ref"]||"A1"),m=a["!merges"]||[],x=0,p=Array.isArray(a);if(a["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var v="",_=a["!rows"]||[];for(u=0;u<h.s.r;++u)v=_[u]?' table:style-name="ro'+_[u].ods+'"':"",l.push("        <table:table-row"+v+`></table:table-row>
`);for(;u<=h.e.r;++u){for(v=_[u]?' table:style-name="ro'+_[u].ods+'"':"",l.push("        <table:table-row"+v+`>
`),d=0;d<h.s.c;++d)l.push(e);for(;d<=h.e.c;++d){var S=!1,w={},y="";for(x=0;x!=m.length;++x)if(!(m[x].s.c>d)&&!(m[x].s.r>u)&&!(m[x].e.c<d)&&!(m[x].e.r<u)){(m[x].s.c!=d||m[x].s.r!=u)&&(S=!0),w["table:number-columns-spanned"]=m[x].e.c-m[x].s.c+1,w["table:number-rows-spanned"]=m[x].e.r-m[x].s.r+1;break}if(S){l.push(r);continue}var b=Wt({r:u,c:d}),E=p?(a[u]||[])[d]:a[b];if(E&&E.f&&(w["table:formula"]=Dr(qce(E.f)),E.F&&E.F.slice(0,b.length)==b)){var N=ba(E.F);w["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,w["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!E){l.push(e);continue}switch(E.t){case"b":y=E.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=E.v?"true":"false";break;case"n":y=E.w||String(E.v||0),w["office:value-type"]="float",w["office:value"]=E.v||0;break;case"s":case"str":y=E.v==null?"":E.v,w["office:value-type"]="string";break;case"d":y=E.w||Hr(E.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Hr(E.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(e);continue}var F=t(y);if(E.l&&E.l.Target){var T=E.l.Target;T=T.charAt(0)=="#"?"#"+Zce(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),F=dt("text:a",F,{"xlink:href":T.replace(/&/g,"&amp;")})}l.push("          "+dt("table:table-cell",dt("text:p",F,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var h=u["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;dc(h),h.ods=o;var m=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=l;var h=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var l=[On],u=wg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=wg({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+d+`>
`),l.push(eM().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),s(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=i.SheetNames.length;++h)l.push(n(i.Sheets[i.SheetNames[h]],i,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function fL(t,e){if(e.bookType=="fods")return eF(t,e);var r=BT(),n="",s=[],a=[];return n="mimetype",nr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",nr(r,n,eF(t,e)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",nr(r,n,Phe(t,e)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",nr(r,n,On+eM()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",nr(r,n,ose(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",nr(r,n,ase(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function $u(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ib(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Mr(Ac(t))}function Dhe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):ja(go(t))}function Rhe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function hc(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function tF(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Ohe(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Mhe(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)t[e+a]=s&255;t[e+15]|=r>=0?0:128}function Ng(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function jr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Sn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Cr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Ng(t,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:i=4,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Ng(t,r),o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};e[s]==null?e[s]=[u]:e[s].push(u)}return e}function xs(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(jr(n*8+s.type)),s.type==2&&e.push(jr(s.data.length)),e.push(s.data))})}),hc(e)}function f4(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ei(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Ng(t,n),a=Cr(t.slice(n[0],n[0]+s));n[0]+=s;var i={id:Sn(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Cr(o.data),u=Sn(l[3][0].data);i.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=a[3])!=null&&e[0]&&(i.merge=Sn(a[3][0].data)>>>0>0),r.push(i)}return r}function Ad(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:jr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:jr(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:jr(i.data.length)}],n[2].push({data:xs(i.meta),type:2})});var a=xs(n);e.push(jr(a.length)),e.push(a),s.forEach(function(i){return e.push(i)})}),hc(e)}function Lhe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Ng(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var i=e[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=e[r[0]],o>1&&(i|=e[r[0]+1]<<8),o>2&&(i|=e[r[0]+2]<<16),o>3&&(i|=e[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(e.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(a==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,a==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[hc(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var d=hc(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function ti(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Lhe(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return hc(e)}function Fd(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var a=jr(n),i=a.length;e.push(a),n<=60?(i++,e.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return hc(e)}function Ihe(t,e,r,n){var s=$u(t),a=s.getUint32(4,!0),i=(n>1?12:8)+tF(a&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=tF(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function Bhe(t,e,r){var n=$u(t),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(l=Ohe(t,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function g_(t,e){var r=new Uint8Array(32),n=$u(r),s=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,Mhe(r,s,t.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),a|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,s)}function m_(t,e){var r=new Uint8Array(32),n=$u(r),s=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),a|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Uhe(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Ihe(t,e,r,t[0]);case 5:return Bhe(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ms(t){var e=Cr(t);return Ng(e[1][0].data)}function rF(t,e){var r=Cr(e.data),n=Sn(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Cr(i.data),l=Sn(o[1][0].data)>>>0;switch(n){case 1:a[l]=Ib(o[3][0].data);break;case 8:{var u=t[Ms(o[9][0].data)][0],d=Cr(u.data),h=t[Ms(d[1][0].data)][0],m=Sn(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var x=Cr(h.data);a[l]=x[3].map(function(p){return Ib(p.data)}).join("")}break}}),a}function $he(t,e){var r,n,s,a,i,o,l,u,d,h,m,x,p,v,_=Cr(t),S=Sn(_[1][0].data)>>>0,w=Sn(_[2][0].data)>>>0,y=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&Sn(_[8][0].data)>0||!1,b,E;if((a=(s=_[7])==null?void 0:s[0])!=null&&a.data&&e!=0)b=(o=(i=_[7])==null?void 0:i[0])==null?void 0:o.data,E=(u=(l=_[6])==null?void 0:l[0])==null?void 0:u.data;else if((h=(d=_[4])==null?void 0:d[0])!=null&&h.data&&e!=1)b=(x=(m=_[4])==null?void 0:m[0])==null?void 0:x.data,E=(v=(p=_[3])==null?void 0:p[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var N=y?4:1,F=$u(b),T=[],P=0;P<b.length/2;++P){var D=F.getUint16(P*2,!0);D<65535&&T.push([P,D])}if(T.length!=w)throw"Expected ".concat(w," cells, found ").concat(T.length);var R=[];for(P=0;P<T.length-1;++P)R[T[P][0]]=E.subarray(T[P][1]*N,T[P+1][1]*N);return T.length>=1&&(R[T[T.length-1][0]]=E.subarray(T[T.length-1][1]*N)),{R:S,cells:R}}function zhe(t,e){var r,n=Cr(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Sn(n[7][0].data)>>>0>0?1:0:-1,a=f4(n[5],function(i){return $he(i,s)});return{nrows:Sn(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function Whe(t,e,r){var n,s=Cr(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Sn(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Sn(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=er(a);var i=Cr(s[4][0].data),o=rF(t,t[Ms(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?rF(t,t[Ms(i[17][0].data)][0]):[],u=Cr(i[3][0].data),d=0;u[1].forEach(function(h){var m=Cr(h.data),x=t[Ms(m[2][0].data)][0],p=Sn(x.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var v=zhe(t,x);v.data.forEach(function(_,S){_.forEach(function(w,y){var b=Wt({r:d+S,c:y}),E=Uhe(w,o,l);E&&(r[b]=E)})}),d+=v.nrows})}function Vhe(t,e){var r=Cr(e.data),n={"!ref":"A1"},s=t[Ms(r[2][0].data)],a=Sn(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Whe(t,s[0],n),n}function Ghe(t,e){var r,n=Cr(e.data),s={name:(r=n[1])!=null&&r[0]?Ib(n[1][0].data):"",sheets:[]},a=f4(n[2],Ms);return a.forEach(function(i){t[i].forEach(function(o){var l=Sn(o.meta[1][0].data);l==6e3&&s.sheets.push(Vhe(t,o))})}),s}function Hhe(t,e){var r=x4(),n=Cr(e.data),s=f4(n[1],Ms);if(s.forEach(function(a){t[a].forEach(function(i){var o=Sn(i.meta[1][0].data);if(o==2){var l=Ghe(t,i);l.sheets.forEach(function(u,d){y4(r,u,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function p_(t){var e,r,n,s,a={},i=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=ti(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var d;try{d=ei(u)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){a[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Sn(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(u){var d=Sn(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Hhe(a,o)}function Khe(t,e,r){var n,s,a,i;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=t[8])==null?void 0:a[0])==null?void 0:i.data)&&Sn(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=$u(t[7][0].data),d=0,h=[],m=$u(t[4][0].data),x=0,p=[],v=0;v<e.length;++v){if(e[v]==null){u.setUint16(v*2,65535,!0),m.setUint16(v*2,65535);continue}u.setUint16(v*2,d,!0),m.setUint16(v*2,x,!0);var _,S;switch(typeof e[v]){case"string":_=g_({t:"s",v:e[v]},r),S=m_({t:"s",v:e[v]},r);break;case"number":_=g_({t:"n",v:e[v]},r),S=m_({t:"n",v:e[v]},r);break;case"boolean":_=g_({t:"b",v:e[v]},r),S=m_({t:"b",v:e[v]},r);break;default:throw new Error("Unsupported value "+e[v])}h.push(_),d+=_.length,p.push(S),x+=S.length,++l}for(t[2][0].data=jr(l);v<t[7][0].data.length/2;++v)u.setUint16(v*2,65535,!0),m.setUint16(v*2,65535,!0);return t[6][0].data=hc(h),t[3][0].data=hc(p),l}function Xhe(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ba(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(er(n)));var a=B1(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(Y){return Y.forEach(function(J){typeof J=="string"&&i.push(J)})});var o={},l=[],u=Dt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(Y,J){return[Y,u.FullPaths[J]]}).forEach(function(Y){var J=Y[0],te=Y[1];if(J.type==2&&J.name.match(/\.iwa/)){var de=J.content,ee=ti(de),ge=ei(ee);ge.forEach(function(fe){l.push(fe.id),o[fe.id]={deps:[],location:te,type:Sn(fe.messages[0].meta[1][0].data)}})}}),l.sort(function(Y,J){return Y-J});var d=l.filter(function(Y){return Y>1}).map(function(Y){return[Y,jr(Y)]});u.FileIndex.map(function(Y,J){return[Y,u.FullPaths[J]]}).forEach(function(Y){var J=Y[0];if(Y[1],!!J.name.match(/\.iwa/)){var te=ei(ti(J.content));te.forEach(function(de){de.messages.forEach(function(ee){d.forEach(function(ge){de.messages.some(function(fe){return Sn(fe.meta[1][0].data)!=11006&&Rhe(fe.data,ge[1])})&&o[ge[0]].deps.push(de.id)})})})}});for(var h=Dt.find(u,o[1].location),m=ei(ti(h.content)),x,p=0;p<m.length;++p){var v=m[p];v.id==1&&(x=v)}var _=Ms(Cr(x.messages[0].data)[1][0].data);for(h=Dt.find(u,o[_].location),m=ei(ti(h.content)),p=0;p<m.length;++p)v=m[p],v.id==_&&(x=v);for(_=Ms(Cr(x.messages[0].data)[2][0].data),h=Dt.find(u,o[_].location),m=ei(ti(h.content)),p=0;p<m.length;++p)v=m[p],v.id==_&&(x=v);for(_=Ms(Cr(x.messages[0].data)[2][0].data),h=Dt.find(u,o[_].location),m=ei(ti(h.content)),p=0;p<m.length;++p)v=m[p],v.id==_&&(x=v);var S=Cr(x.messages[0].data);{S[6][0].data=jr(n.e.r+1),S[7][0].data=jr(n.e.c+1);var w=Ms(S[46][0].data),y=Dt.find(u,o[w].location),b=ei(ti(y.content));{for(var E=0;E<b.length&&b[E].id!=w;++E);if(b[E].id!=w)throw"Bad ColumnRowUIDMapArchive";var N=Cr(b[E].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var F=0;F<=n.e.c;++F){var T=[];T[1]=T[2]=[{type:0,data:jr(F+420690)}],N[1].push({type:2,data:xs(T)}),N[2].push({type:0,data:jr(F)}),N[3].push({type:0,data:jr(F)})}N[4]=[],N[5]=[],N[6]=[];for(var P=0;P<=n.e.r;++P)T=[],T[1]=T[2]=[{type:0,data:jr(P+726270)}],N[4].push({type:2,data:xs(T)}),N[5].push({type:0,data:jr(P)}),N[6].push({type:0,data:jr(P)});b[E].messages[0].data=xs(N)}y.content=Fd(Ad(b)),y.size=y.content.length,delete S[46];var D=Cr(S[4][0].data);{D[7][0].data=jr(n.e.r+1);var R=Cr(D[1][0].data),I=Ms(R[2][0].data);y=Dt.find(u,o[I].location),b=ei(ti(y.content));{if(b[0].id!=I)throw"Bad HeaderStorageBucket";var W=Cr(b[0].messages[0].data);for(P=0;P<a.length;++P){var le=Cr(W[2][0].data);le[1][0].data=jr(P),le[4][0].data=jr(a[P].length),W[2][P]={type:W[2][0].type,data:xs(le)}}b[0].messages[0].data=xs(W)}y.content=Fd(Ad(b)),y.size=y.content.length;var q=Ms(D[2][0].data);y=Dt.find(u,o[q].location),b=ei(ti(y.content));{if(b[0].id!=q)throw"Bad HeaderStorageBucket";for(W=Cr(b[0].messages[0].data),F=0;F<=n.e.c;++F)le=Cr(W[2][0].data),le[1][0].data=jr(F),le[4][0].data=jr(n.e.r+1),W[2][F]={type:W[2][0].type,data:xs(le)};b[0].messages[0].data=xs(W)}y.content=Fd(Ad(b)),y.size=y.content.length;var V=Ms(D[4][0].data);(function(){for(var Y=Dt.find(u,o[V].location),J=ei(ti(Y.content)),te,de=0;de<J.length;++de){var ee=J[de];ee.id==V&&(te=ee)}var ge=Cr(te.messages[0].data);{ge[3]=[];var fe=[];i.forEach(function(re,ve){fe[1]=[{type:0,data:jr(ve)}],fe[2]=[{type:0,data:jr(1)}],fe[3]=[{type:2,data:Dhe(re)}],ge[3].push({type:2,data:xs(fe)})})}te.messages[0].data=xs(ge);var ye=Ad(J),Ce=Fd(ye);Y.content=Ce,Y.size=Y.content.length})();var K=Cr(D[3][0].data);{var U=K[1][0];delete K[2];var L=Cr(U.data);{var Z=Ms(L[2][0].data);(function(){for(var Y=Dt.find(u,o[Z].location),J=ei(ti(Y.content)),te,de=0;de<J.length;++de){var ee=J[de];ee.id==Z&&(te=ee)}var ge=Cr(te.messages[0].data);{delete ge[6],delete K[7];var fe=new Uint8Array(ge[5][0].data);ge[5]=[];for(var ye=0,Ce=0;Ce<=n.e.r;++Ce){var re=Cr(fe);ye+=Khe(re,a[Ce],i),re[1][0].data=jr(Ce),ge[5].push({data:xs(re),type:2})}ge[1]=[{type:0,data:jr(n.e.c+1)}],ge[2]=[{type:0,data:jr(n.e.r+1)}],ge[3]=[{type:0,data:jr(ye)}],ge[4]=[{type:0,data:jr(n.e.r+1)}]}te.messages[0].data=xs(ge);var ve=Ad(J),we=Fd(ve);Y.content=we,Y.size=Y.content.length})()}U.data=xs(L)}D[3][0].data=xs(K)}S[4][0].data=xs(D)}x.messages[0].data=xs(S);var ne=Ad(m),z=Fd(ne);return h.content=z,h.size=h.content.length,u}function hL(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function h4(t){hL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function g4(t){hL([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Yhe(t){return ur.WS.indexOf(t)>-1?"sheet":t==ur.CS?"chart":t==ur.DS?"dialog":t==ur.MS?"macro":t&&t.length?t:"sheet"}function Jhe(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Yhe(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Qhe(t,e,r,n,s,a,i,o,l,u,d,h){try{a[n]=A0(Pa(t,r,!0),e);var m=Un(t,e),x;switch(o){case"sheet":x=vfe(m,e,s,l,a[n],u,d,h);break;case"chart":if(x=wfe(m,e,s,l,a[n],u,d,h),!x||!x["!drawel"])break;var p=a0(x["!drawel"].Target,e),v=Sg(p),_=ile(Pa(t,p,!0),A0(Pa(t,v,!0),p)),S=a0(_,p),w=Sg(S);x=Kde(Pa(t,S,!0),S,l,A0(Pa(t,w,!0),S),u,x);break;case"macro":x=_fe(m,e,s,l,a[n],u,d,h);break;case"dialog":x=Sfe(m,e,s,l,a[n],u,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=x;var y=[];a&&a[n]&&bn(a[n]).forEach(function(b){var E="";if(a[n][b].Type==ur.CMNT){E=a0(a[n][b].Target,e);var N=Tfe(Un(t,E,!0),E,l);if(!N||!N.length)return;$8(x,N,!1)}a[n][b].Type==ur.TCMNT&&(E=a0(a[n][b].Target,e),y=y.concat(lle(Un(t,E,!0),l)))}),y&&y.length&&$8(x,y,!0,l.people||[])}catch(b){if(l.WTF)throw b}}function qa(t){return t.charAt(0)=="/"?t.slice(1):t}function qhe(t,e){if(dh(),e=e||{},h4(e),ni(t,"META-INF/manifest.xml")||ni(t,"objectdata.xml"))return q8(t,e);if(ni(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof p_<"u"){if(t.FileIndex)return p_(t);var r=Dt.utils.cfb_new();return l8(t).forEach(function(le){nr(r,le,cne(t,le))}),p_(r)}throw new Error("Unsupported NUMBERS file")}if(!ni(t,"[Content_Types].xml"))throw ni(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ni(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=l8(t),s=rse(Pa(t,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Un(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Un(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(F0=[],s.sst)try{F0=Cfe(Un(t,qa(s.sst)),s.sst,e)}catch(le){if(e.WTF)throw le}e.cellStyles&&s.themes.length&&(l=kfe(Pa(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(u=bfe(Un(t,qa(s.style)),s.style,l,e))}s.links.map(function(le){try{var q=A0(Pa(t,Sg(qa(le))),le);return Nfe(Un(t,qa(le)),q,le,e)}catch{}});var d=yfe(Un(t,qa(s.workbooks[0])),s.workbooks[0],e),h={},m="";s.coreprops.length&&(m=Un(t,qa(s.coreprops[0]),!0),m&&(h=tM(m)),s.extprops.length!==0&&(m=Un(t,qa(s.extprops[0]),!0),m&&cse(m,h,e)));var x={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(m=Pa(t,qa(s.custprops[0]),!0),m&&(x=dse(m,e)));var p={};if((e.bookSheets||e.bookProps)&&(d.Sheets?i=d.Sheets.map(function(q){return q.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),e.bookProps&&(p.Props=h,p.Custprops=x),e.bookSheets&&typeof i<"u"&&(p.SheetNames=i),e.bookSheets?p.SheetNames:e.bookProps))return p;i={};var v={};e.bookDeps&&s.calcchain&&(v=Efe(Un(t,qa(s.calcchain)),s.calcchain));var _=0,S={},w,y;{var b=d.Sheets;h.Worksheets=b.length,h.SheetNames=[];for(var E=0;E!=b.length;++E)h.SheetNames[E]=b[E].name}var N=a?"bin":"xml",F=s.workbooks[0].lastIndexOf("/"),T=(s.workbooks[0].slice(0,F+1)+"_rels/"+s.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");ni(t,T)||(T="xl/_rels/workbook."+N+".rels");var P=A0(Pa(t,T,!0),T.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=Afe(Un(t,qa(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=ule(Un(t,qa(s.people[0])),e)),P&&(P=Jhe(P,d.Sheets));var D=Un(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=h.Worksheets;++_){var R="sheet";if(P&&P[_]?(w="xl/"+P[_][1].replace(/[\/]?xl\//,""),ni(t,w)||(w=P[_][1]),ni(t,w)||(w=T.replace(/_rels\/.*$/,"")+P[_][1]),R=P[_][2]):(w="xl/worksheets/sheet"+(_+1-D)+"."+N,w=w.replace(/sheet0\./,"sheet.")),y=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(h.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var I=!1,W=0;W!=e.sheets.length;++W)typeof e.sheets[W]=="number"&&e.sheets[W]==_&&(I=1),typeof e.sheets[W]=="string"&&e.sheets[W].toLowerCase()==h.SheetNames[_].toLowerCase()&&(I=1);if(!I)continue e}}Qhe(t,w,y,h.SheetNames[_],_,S,i,R,e,d,l,u)}return p={Directory:s,Workbook:d,Props:h,Custprops:x,Deps:v,Sheets:i,SheetNames:h.SheetNames,Strings:F0,Styles:u,Themes:l,SSF:Kr(Bt)},e&&e.bookFiles&&(t.files?(p.keys=n,p.files=t.files):(p.keys=[],p.files={},t.FullPaths.forEach(function(le,q){le=le.replace(/^Root Entry[\/]/,""),p.keys.push(le),p.files[le]=t.FileIndex[q]}))),e&&e.bookVBA&&(s.vba.length>0?p.vbaraw=Un(t,qa(s.vba[0]),!0):s.defaults&&s.defaults.bin===yle&&(p.vbaraw=Un(t,"xl/vbaProject.bin",!0))),p}function Zhe(t,e){var r=e||{},n="Workbook",s=Dt.find(t,n);try{if(n="/!DataSpaces/Version",s=Dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Aie(s.content),n="/!DataSpaces/DataSpaceMap",s=Dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=jie(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Pie(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Rie(s.content)}catch{}if(n="/EncryptionInfo",s=Dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Oie(s.content);if(n="/EncryptedPackage",s=Dt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function e0e(t,e){return e.bookType=="ods"?fL(t,e):e.bookType=="numbers"?Xhe(t,e):e.bookType=="xlsb"?t0e(t,e):r0e(t,e)}function t0e(t,e){rf=1024,t&&!t.SSF&&(t.SSF=Kr(Bt)),t&&t.SSF&&(dh(),bv(t.SSF),e.revssf=Cv(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,j0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=UM.indexOf(e.bookType)>-1,s=ZT();g4(e=e||{});var a=BT(),i="",o=0;if(e.cellXfs=[],jc(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),i="docProps/core.xml",nr(a,i,rM(t.Props,e)),s.coreprops.push(i),Pr(e.rels,2,i,ur.CORE_PROPS),i="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,nr(a,i,aM(t.Props)),s.extprops.push(i),Pr(e.rels,3,i,ur.EXT_PROPS),t.Custprops!==t.Props&&bn(t.Custprops||{}).length>0&&(i="docProps/custom.xml",nr(a,i,iM(t.Custprops)),s.custprops.push(i),Pr(e.rels,4,i,ur.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,nr(a,i,jfe(o-1,i,e,t,d)),s.sheets.push(i),Pr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,ur.WS[0])}if(h){var x=h["!comments"],p=!1,v="";x&&x.length>0&&(v="xl/comments"+o+"."+r,nr(a,v,Rfe(x,v)),s.comments.push(v),Pr(d,-1,"../comments"+o+"."+r,ur.CMNT),p=!0),h["!legacy"]&&p&&nr(a,"xl/drawings/vmlDrawing"+o+".vml",IM(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&nr(a,Sg(i),xf(d))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+r,nr(a,i,Dfe(e.Strings,i,e)),s.strs.push(i),Pr(e.wbrels,-1,"sharedStrings."+r,ur.SST)),i="xl/workbook."+r,nr(a,i,Ffe(t,i)),s.workbooks.push(i),Pr(e.rels,1,i,ur.WB),i="xl/theme/theme1.xml",nr(a,i,a4(t.Themes,e)),s.themes.push(i),Pr(e.wbrels,-1,"theme/theme1.xml",ur.THEME),i="xl/styles."+r,nr(a,i,Pfe(t,i,e)),s.styles.push(i),Pr(e.wbrels,-1,"styles."+r,ur.STY),t.vbaraw&&n&&(i="xl/vbaProject.bin",nr(a,i,t.vbaraw),s.vba.push(i),Pr(e.wbrels,-1,"vbaProject.bin",ur.VBA)),i="xl/metadata."+r,nr(a,i,Ofe(i)),s.metadata.push(i),Pr(e.wbrels,-1,"metadata."+r,ur.XLMETA),nr(a,"[Content_Types].xml",ZO(s,e)),nr(a,"_rels/.rels",xf(e.rels)),nr(a,"xl/_rels/workbook."+r+".rels",xf(e.wbrels)),delete e.revssf,delete e.ssf,a}function r0e(t,e){rf=1024,t&&!t.SSF&&(t.SSF=Kr(Bt)),t&&t.SSF&&(dh(),bv(t.SSF),e.revssf=Cv(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,j0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=UM.indexOf(e.bookType)>-1,s=ZT();g4(e=e||{});var a=BT(),i="",o=0;if(e.cellXfs=[],jc(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),i="docProps/core.xml",nr(a,i,rM(t.Props,e)),s.coreprops.push(i),Pr(e.rels,2,i,ur.CORE_PROPS),i="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,nr(a,i,aM(t.Props)),s.extprops.push(i),Pr(e.rels,3,i,ur.EXT_PROPS),t.Custprops!==t.Props&&bn(t.Custprops||{}).length>0&&(i="docProps/custom.xml",nr(a,i,iM(t.Custprops)),s.custprops.push(i),Pr(e.rels,4,i,ur.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},m=t.Sheets[t.SheetNames[o-1]],x=(m||{})["!type"]||"sheet";switch(x){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,nr(a,i,QM(o-1,e,t,h)),s.sheets.push(i),Pr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,ur.WS[0])}if(m){var p=m["!comments"],v=!1,_="";if(p&&p.length>0){var S=!1;p.forEach(function(w){w[1].forEach(function(y){y.T==!0&&(S=!0)})}),S&&(_="xl/threadedComments/threadedComment"+o+"."+r,nr(a,_,cle(p,d,e)),s.threadedcomments.push(_),Pr(h,-1,"../threadedComments/threadedComment"+o+"."+r,ur.TCMNT)),_="xl/comments"+o+"."+r,nr(a,_,BM(p)),s.comments.push(_),Pr(h,-1,"../comments"+o+"."+r,ur.CMNT),v=!0}m["!legacy"]&&v&&nr(a,"xl/drawings/vmlDrawing"+o+".vml",IM(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&nr(a,Sg(i),xf(h))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+r,nr(a,i,TM(e.Strings,e)),s.strs.push(i),Pr(e.wbrels,-1,"sharedStrings."+r,ur.SST)),i="xl/workbook."+r,nr(a,i,rL(t)),s.workbooks.push(i),Pr(e.rels,1,i,ur.WB),i="xl/theme/theme1.xml",nr(a,i,a4(t.Themes,e)),s.themes.push(i),Pr(e.wbrels,-1,"theme/theme1.xml",ur.THEME),i="xl/styles."+r,nr(a,i,RM(t,e)),s.styles.push(i),Pr(e.wbrels,-1,"styles."+r,ur.STY),t.vbaraw&&n&&(i="xl/vbaProject.bin",nr(a,i,t.vbaraw),s.vba.push(i),Pr(e.wbrels,-1,"vbaProject.bin",ur.VBA)),i="xl/metadata."+r,nr(a,i,LM()),s.metadata.push(i),Pr(e.wbrels,-1,"metadata."+r,ur.XLMETA),d.length>1&&(i="xl/persons/person.xml",nr(a,i,dle(d)),s.people.push(i),Pr(e.wbrels,-1,"persons/person.xml",ur.PEOPLE)),nr(a,"[Content_Types].xml",ZO(s,e)),nr(a,"_rels/.rels",xf(e.rels)),nr(a,"xl/_rels/workbook."+r+".rels",xf(e.wbrels)),delete e.revssf,delete e.ssf,a}function m4(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=La(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function n0e(t,e){return Dt.find(t,"EncryptedPackage")?Zhe(t,e):iL(t,e)}function s0e(t,e){var r,n=t,s=e||{};return s.type||(s.type=ir&&Buffer.isBuffer(t)?"buffer":"base64"),r=NO(n,s),qhe(r,s)}function gL(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Mb(t.slice(r),e);default:break e}return $f.to_workbook(t,e)}function a0e(t,e){var r="",n=m4(t,e);switch(e.type){case"base64":r=La(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Lu(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Mr(r)),e.type="binary",gL(r,e)}function i0e(t,e){var r=t;return e.type=="base64"&&(r=La(r)),r=pg.utils.decode(1200,r.slice(2),"str"),e.type="binary",gL(r,e)}function o0e(t){return t.match(/[^\x00-\x7F]/)?go(t):t}function x_(t,e,r,n){return n?(r.type="string",$f.to_workbook(t,r)):$f.to_workbook(e,r)}function Bb(t,e){RT();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Bb(new Uint8Array(t),(r=Kr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),vf={},r.dateNF&&(vf.dateNF=r.dateNF),r.type||(r.type=ir&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=ir?"buffer":"binary",n=tne(t),typeof Uint8Array<"u"&&!ir&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=o0e(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Kr(r),r.type="array",Bb(OT(n),r)}switch((s=m4(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return n0e(Dt.read(n,r),r);break;case 9:if(s[1]<=8)return iL(n,r);break;case 60:return Mb(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return fie(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return kM.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?s0e(n,r):x_(t,n,r,a);case 239:return s[3]===60?Mb(n,r):x_(t,n,r,a);case 255:if(s[1]===254)return i0e(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return pu.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return pu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Ob.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return jM.to_workbook(n,r);break;case 10:case 13:case 32:return a0e(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return die.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Ob.to_workbook(n,r):x_(t,n,r,a)}function mL(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return om(e.file,Dt.write(t,{type:ir?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Dt.write(t,e)}function l0e(t,e){var r=Kr(e||{}),n=e0e(t,r);return c0e(n,r)}function c0e(t,e){var r={},n=ir?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?Dt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Sv(s))}return e.password&&typeof encrypt_agile<"u"?mL(encrypt_agile(s,e.password),e):e.type==="file"?om(e.file,s):e.type=="string"?Mr(s):s}function u0e(t,e){var r=e||{},n=ohe(t,r);return mL(n,r)}function so(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return xg(go(n));case"binary":return go(n);case"string":return t;case"file":return om(e.file,n,"utf8");case"buffer":return ir?yl(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):so(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function d0e(t,e){switch(e.type){case"base64":return xg(t);case"binary":return t;case"string":return t;case"file":return om(e.file,t,"binary");case"buffer":return ir?yl(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ex(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?xg(r):e.type=="string"?Mr(r):r;case"file":return om(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function pL(t,e){RT(),nfe(t);var r=Kr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=pL(t,r);return r.type="array",Sv(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return so(ehe(t,r),r);case"slk":case"sylk":return so(bM.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return so(lL(t.Sheets[t.SheetNames[s]],r),r);case"txt":return d0e(xL(t.Sheets[t.SheetNames[s]],r),r);case"csv":return so(p4(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return so(kM.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return ex(Ob.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return so($f.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return so(jM.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return so(CM.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return so(fL(t,r),r);case"wk1":return ex(pu.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return ex(pu.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ex(oL(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),u0e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return l0e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function f0e(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function h0e(t,e,r){var n={};return n.type="file",n.file=e,f0e(n),pL(t,n)}function g0e(t,e,r,n,s,a,i,o){var l=Pn(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||t[r])for(var x=e.s.c;x<=e.e.c;++x){var p=i?t[r][x]:t[n[x]+l];if(p===void 0||p.t===void 0){if(u===void 0)continue;a[x]!=null&&(m[a[x]]=u);continue}var v=p.v;switch(p.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(a[x]!=null){if(v==null)if(p.t=="e"&&v===null)m[a[x]]=null;else if(u!==void 0)m[a[x]]=u;else if(d&&v===null)m[a[x]]=null;else continue;else m[a[x]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?v:ul(p,v,o);v!=null&&(h=!1)}}return{row:m,isempty:h}}function B1(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":l=_r(d);break;case"number":l=_r(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(s=0);var h=Pn(l.s.r),m=[],x=[],p=0,v=0,_=Array.isArray(t),S=l.s.r,w=0,y={};_&&!t[S]&&(t[S]=[]);var b=u.skipHidden&&t["!cols"]||[],E=u.skipHidden&&t["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(b[w]||{}).hidden)switch(m[w]=cn(w),r=_?t[S][w]:t[m[w]+h],n){case 1:a[w]=w-l.s.c;break;case 2:a[w]=m[w];break;case 3:a[w]=u.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ul(r,null,u),v=y[i]||0,!v)y[i]=1;else{do o=i+"_"+v++;while(y[o]);y[i]=v,y[o]=1}a[w]=o}for(S=l.s.r+s;S<=l.e.r;++S)if(!(E[S]||{}).hidden){var N=g0e(t,l,S,m,n,a,_,u);(N.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(x[p++]=N.row)}return x.length=p,x}var nF=/"/g;function m0e(t,e,r,n,s,a,i,o){for(var l=!0,u=[],d="",h=Pn(r),m=e.s.c;m<=e.e.c;++m)if(n[m]){var x=o.dense?(t[r]||[])[m]:t[n[m]+h];if(x==null)d="";else if(x.v!=null){l=!1,d=""+(o.rawNumbers&&x.t=="n"?x.v:ul(x,null,o));for(var p=0,v=0;p!==d.length;++p)if((v=d.charCodeAt(p))===s||v===a||v===34||o.forceQuotes){d='"'+d.replace(nF,'""')+'"';break}d=="ID"&&(d='"ID"')}else x.f!=null&&!x.F?(l=!1,d="="+x.f,d.indexOf(",")>=0&&(d='"'+d.replace(nF,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&l?null:u.join(i)}function p4(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=_r(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",h=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],x=n.skipHidden&&t["!rows"]||[],p=s.s.c;p<=s.e.c;++p)(m[p]||{}).hidden||(h[p]=cn(p));for(var v=0,_=s.s.r;_<=s.e.r;++_)(x[_]||{}).hidden||(d=m0e(t,s,_,h,i,l,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((v++?o:"")+d)));return delete n.dense,r.join("")}function xL(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=p4(t,e);return r}function p0e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=_r(t["!ref"]),a="",i=[],o,l=[],u=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)i[o]=cn(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=Pn(d),o=s.s.c;o<=s.e.c;++o)if(e=i[o]+a,r=u?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function yL(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?un(n.origin):n.origin;i=l.r,o=l.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+e.length-1+s}};if(a["!ref"]){var h=_r(a["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),i==-1&&(i=h.e.r+1,d.e.r=i+e.length-1+s)}else i==-1&&(i=0,d.e.r=e.length-1+s);var m=n.header||[],x=0;e.forEach(function(v,_){bn(v).forEach(function(S){(x=m.indexOf(S))==-1&&(m[x=m.length]=S);var w=v[S],y="z",b="",E=Wt({c:o+x,r:i+_+s});u=Ag(a,E),w&&typeof w=="object"&&!(w instanceof Date)?a[E]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",n.cellDates||(y="n",w=es(w)),b=n.dateNF||Bt[14]):w===null&&n.nullError&&(y="e",w=0),u?(u.t=y,u.v=w,delete u.w,delete u.R,b&&(u.z=b)):a[E]=u={t:y,v:w},b&&(u.z=b))})}),d.e.c=Math.max(d.e.c,o+m.length-1);var p=Pn(i);if(s)for(x=0;x<m.length;++x)a[cn(x+o)+p]={t:"s",v:m[x]};return a["!ref"]=er(d),a}function x0e(t,e){return yL(null,t,e)}function Ag(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=un(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Ag(t,Wt(e)):Ag(t,Wt({r:e,c:r||0}))}function y0e(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function x4(){return{SheetNames:[],Sheets:{}}}function y4(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=i+s)!=-1;++s);}if(tL(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function v0e(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=y0e(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function w0e(t,e){return t.z=e,t}function vL(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function _0e(t,e,r){return vL(t,"#"+e,r)}function S0e(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function b0e(t,e,r,n){for(var s=typeof e!="string"?e:_r(e),a=typeof e=="string"?e:er(e),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=Ag(t,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var kx={encode_col:cn,encode_row:Pn,encode_cell:Wt,encode_range:er,decode_col:KT,decode_row:HT,split_cell:Dne,decode_cell:un,decode_range:ba,format_cell:ul,sheet_add_aoa:HO,sheet_add_json:yL,sheet_add_dom:cL,aoa_to_sheet:fh,json_to_sheet:x0e,table_to_sheet:uL,table_to_book:Ahe,sheet_to_csv:p4,sheet_to_txt:xL,sheet_to_json:B1,sheet_to_html:lL,sheet_to_formulae:p0e,sheet_to_row_object_array:B1,sheet_get_cell:Ag,book_new:x4,book_append_sheet:y4,book_set_sheet_visibility:v0e,cell_set_number_format:w0e,cell_set_hyperlink:vL,cell_set_internal_link:_0e,cell_add_comment:S0e,sheet_set_array_formula:b0e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const wL=({onBackToCabinet:t,selectedGrade:e,selectedClass:r})=>{Ua(),sy();const{user:n,isAuthenticated:s}=Dn(),{showNotification:a}=ka(),[i,o]=k.useState(null),[l,u]=k.useState(!0),[d,h]=k.useState(""),[m,x]=k.useState([]),[p,v]=k.useState(null),[_,S]=k.useState(!1),[w,y]=k.useState([]),[b,E]=k.useState([]),[N,F]=k.useState([1,2]),[T,P]=k.useState(null),[D,R]=k.useState(null),[I,W]=k.useState(null),[le,q]=k.useState("main"),[V,K]=k.useState(null),[U,L]=k.useState(null),Z=V||e,ne=U||r,[z,Y]=k.useState(null),[J,te]=k.useState({}),[de,ee]=k.useState(!1),[ge,fe]=k.useState(new Set),[ye,Ce]=k.useState(!1),[re,ve]=k.useState(!1),we=k.useRef(null),[Oe,Ze]=k.useState(null),[Re,xt]=k.useState(!1),[$t,Ae]=k.useState(null),[Pe,Ue]=k.useState(""),[We,Xe]=k.useState(""),[ut,Ct]=k.useState(!1),[Mt,At]=k.useState(!1),[Pt,it]=k.useState(new Set),[rt,xe]=k.useState({}),[De,Le]=k.useState(!1),pt=k.useRef(new Set),ht=k.useRef({}),Tt=k.useRef(null);k.useEffect(()=>{console.log(" editingColumns state changed:",Array.from(Pt)),pt.current=Pt},[Pt]),k.useEffect(()=>{console.log(" columnScores state changed:",rt),ht.current=rt},[rt]);const gr=k.useCallback(B=>{console.log(" Toggling test collapse for:",B),fe(X=>{const H=new Set(X);return H.has(B)?(H.delete(B),console.log(" Expanding test:",B)):(H.add(B),console.log(" Collapsing test:",B)),console.log(" New collapsed tests:",Array.from(H)),H})},[]),tr=k.useCallback(()=>{if(we.current){const{scrollLeft:B,scrollWidth:X,clientWidth:H}=we.current;Ce(B>0),ve(B<X-H-1)}},[]);k.useEffect(()=>{jt()},[]),k.useEffect(()=>{T&&we.current&&setTimeout(tr,100)},[T,tr]),k.useEffect(()=>{console.log(" Current collapsed tests state:",Array.from(ge))},[ge]);const mr=k.useCallback(async(B,X,H)=>{var he,Ne,M;console.log(" Loading class results for:",B,X,H),ee(!0);try{const Q=`${B}/${X}`;console.log(" Formatted class name:",Q);let ie=i;ie||(console.log(" Teacher data not loaded, loading now..."),ie=await Br.getTeacherData(),o(ie));const ue=n==null?void 0:n.teacher_id;let Se=null,Ie=D;if(Ie||(console.log(" Academic year data not loaded, loading now..."),Ie=await be()),Ie&&Array.isArray(Ie)&&Ie.length>0){const Ve=parseInt(H);console.log(" Looking for semester",Ve,"in current academic year");const et=new Date,bt=Ie.find(Jt=>{const It=new Date(Jt.start_date),ae=new Date(Jt.end_date);return et>=It&&et<=ae}),wt=bt?bt.academic_year:Ie[0].academic_year;console.log(" Current academic year:",wt);const rr=Ie.filter(Jt=>Jt.academic_year===wt);console.log(" Current year periods:",rr);const Yt=rr.filter(Jt=>parseInt(Jt.semester)===1),or=rr.filter(Jt=>parseInt(Jt.semester)===2);if(console.log(" Semester 1 periods:",Yt),console.log(" Semester 2 periods:",or),Ve===1?(Se=(he=Yt[0])==null?void 0:he.id,console.log(" Using semester 1 period:",Yt[0])):Ve===2&&(Se=(Ne=or[0])==null?void 0:Ne.id,console.log(" Using semester 2 period:",or[0])),!Se)throw new Error(`No ${Ve===1?"Semester 1":"Semester 2"} data available for academic year ${wt}`)}if(!ue||!Se)throw console.error(" Missing data:",{teacherId:ue,academicPeriodId:Se,academicYear:D}),new Error("Missing teacher ID or academic period ID");const Te=await ere.getTeacherStudentResults(ue,B,Q,H,Se);if(console.log(" Class results response:",Te),Te.success){console.log(" API Response details:",{results:Te.results,students:Te.students,count:Te.count,student_count:Te.student_count});const Ve=[],et=new Set,bt=new Set;Te.results&&Te.results.length>0&&Te.results.forEach(Yt=>{Yt.test_name&&!et.has(Yt.test_name)&&(et.add(Yt.test_name),Ve.push({test_name:Yt.test_name,test_type:Yt.test_type,subject:Yt.subject})),Yt.subject&&bt.add(Yt.subject)});const wt=(Te.students||[]).map(Yt=>{const or={};return(Te.results||[]).filter(It=>It.student_id===Yt.student_id).forEach(It=>{It.test_name&&(or[It.test_name]={id:It.id,test_type:It.test_type,score:It.score,max_score:It.max_score,caught_cheating:It.caught_cheating,visibility_change_times:It.visibility_change_times,answers:It.answers,name:It.name,surname:It.surname,test_name:It.test_name})}),{...Yt,...or}}),rr={results:Te.results||[],students:wt,class:wt,unique_tests:Ve,subjects:Array.from(bt),count:Te.count||0,student_count:Te.student_count||0};console.log(" Processed results data:",{uniqueTests:Ve.length,subjects:Array.from(bt),resultsCount:((M=Te.results)==null?void 0:M.length)||0,studentsWithScores:wt.length,sampleStudent:wt[0]}),P(rr),te(rr),W(new Date),Te.students&&Te.students.length>0?(console.log(" Student list loaded:",Te.students.length,"students"),console.log(" Sample student:",Te.students[0])):console.log(" No students found for this class")}else console.log(" API call failed for this class"),P(null),te(null)}catch(Q){console.error(" Error loading class results:",Q),a("Error loading class results","error"),P(null),te(null)}finally{ee(!1)}},[i,n,D,a]),Je=k.useCallback(async(B,X)=>{console.log(" Determining current semester for:",B,X);try{if(D&&D.length>0){const H=new Date;let he=1,Ne=null;for(const M of D){const Q=new Date(M.start_date),ie=new Date(M.end_date);if(console.log(" Checking period:",{period:M,semester:M.semester,semesterType:typeof M.semester,startDate:Q,endDate:ie,currentDate:H,isInRange:H>=Q&&H<=ie}),H>=Q&&H<=ie){Ne=M,he=M.semester,console.log(" Found matching period:",{period:M,semester:M.semester,semesterType:typeof M.semester});break}}if(Ne){console.log(" Current academic period found:",Ne),console.log(" Current semester:",he);const M=he&&!isNaN(he)?he:1;console.log(" Using semester:",M),v(M),await mr(B,X,M)}else console.log(" No current academic period found, using default semester 1"),v(1),await mr(B,X,1)}else console.log(" No academic year data, using default semester 1"),v(1),await mr(B,X,1)}catch(H){console.error(" Error determining current semester:",H),v(1),await mr(B,X,1)}},[D,mr]);k.useEffect(()=>{e&&r&&(console.log(" Props detected:",{grade:e,class:r}),Je(e,r))},[e,r,Je]);const jt=k.useCallback(async()=>{console.log(" Initializing teacher results...");try{if(u(!0),h(""),!s||!n){console.log(" User not authenticated"),h("User not authenticated");return}if(n.role!==Zs.TEACHER){console.error(" Invalid user role for teacher results:",n.role),h("Access denied. Teacher role required.");return}console.log(" Loading teacher assignments..."),await vt(),console.log(" Loading academic year data..."),await me(),console.log(" Teacher results initialization complete!")}catch(B){console.error(" Error initializing teacher results:",B),h("Failed to initialize teacher results")}finally{u(!1)}},[s,n]),vt=k.useCallback(async()=>{console.log(" Loading teacher assignments...");try{const B=`teacher_data_${(n==null?void 0:n.teacher_id)||(n==null?void 0:n.id)||""}`;let X=wn(B);X?console.log(" Cache HIT! Using cached teacher data"):(console.log(" Cache MISS! Fetching teacher data from API"),X=await Br.getTeacherData(),console.log(" Teacher data loaded:",X),Zr(B,X,on.teacher_subjects)),o(X);const H=[];X&&X.subjects&&X.subjects.forEach(Q=>{Q.classes&&Q.classes.forEach(ie=>{ie.grade&&ie.class&&H.push({grade:ie.grade,class:ie.class,subject:Q.name})})}),E(H),console.log(" Available classes from teacher data:",H);const he=`teacher_tests_${(n==null?void 0:n.teacher_id)||(n==null?void 0:n.id)||""}`;let Ne=wn(he);Ne?console.log(" Cache HIT! Using cached teacher tests"):(console.log(" Cache MISS! Fetching teacher tests from API"),Ne=await Er.getTeacherTests(),console.log(" Teacher tests loaded:",Ne),Zr(he,Ne,on.teacher_tests));const M=Ne.flatMap(Q=>Q.assignments||[]);x(M),console.log(" Raw assignments data:",M),console.log(" Teacher assignments loaded:",M.length)}catch(B){console.error(" Error loading teacher assignments:",B),a("Failed to load teacher assignments","error")}},[a]),me=k.useCallback(async()=>{var B;console.log(" Loading academic year data...");try{const X="admin_academic_years_";let H=wn(X);H?console.log(" Cache HIT! Using cached academic year data"):(console.log(" Cache MISS! Fetching academic year from API"),H=await Br.getAcademicYear(),console.log(" Academic year response:",H),Zr(X,H,on.admin_academic_years)),console.log(" First academic year record:",(H==null?void 0:H[0])||((B=H==null?void 0:H.academic_years)==null?void 0:B[0])),H&&Array.isArray(H)?(R(H),console.log(" Academic year data loaded:",H.length),console.log(" Sample record fields:",Object.keys(H[0]||{}))):H&&H.academic_years?(R(H.academic_years),console.log(" Academic year data loaded:",H.academic_years.length),console.log(" Sample record fields:",Object.keys(H.academic_years[0]||{}))):console.warn(" Failed to load academic year data:",(H==null?void 0:H.error)||"No data received")}catch(X){console.error(" Error loading academic year data:",X)}},[]),be=k.useCallback(async()=>{console.log(" Loading academic year data (direct return)...");try{const B="admin_academic_years_";let X=wn(B);return X?console.log(" Cache HIT! Using cached academic year data"):(console.log(" Cache MISS! Fetching academic year from API"),X=await Br.getAcademicYear(),console.log(" Academic year response:",X),Zr(B,X,on.admin_academic_years)),X&&Array.isArray(X)?(console.log(" Returning academic year data:",X.length),X):X&&X.academic_years?(console.log(" Returning academic year data:",X.academic_years.length),X.academic_years):(console.warn(" Failed to load academic year data:",(X==null?void 0:X.error)||"No data received"),null)}catch(B){return console.error(" Error loading academic year data:",B),null}},[]),_e=k.useCallback(async(B,X)=>{console.log(" Showing classes for grade:",B,"class:",X),K(B),L(X),v(null),P(null),B&&X&&await Je(B,X)},[Je]);k.useCallback((B,X)=>{console.log(" Showing semesters for class:",B,X),v(null),P(null),Je(B,X)},[]),k.useCallback((B,X)=>{console.log(" Class clicked:",B,X),S(!0),Je(B,X)},[]);const Fe=k.useCallback(async B=>{!Z||!ne||(console.log(" Loading results for semester:",B),v(B),await mr(Z,ne,B))},[Z,ne,mr]);k.useCallback(()=>{let B=1;if(D&&D.length>0){const X=new Date;for(const H of D){const he=new Date(H.start_date),Ne=new Date(H.end_date);if(X>=he&&X<=Ne){B=H.semester;break}}}return c.jsx("div",{className:"flex space-x-4 mb-6",children:[1,2].map(X=>c.jsxs(Me.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${p===X?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>Fe(X),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",X,X===B&&c.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},X))})},[p,Fe,D]),k.useCallback(B=>B.reduce((X,H)=>(X[H.student_id]||(X[H.student_id]=[]),X[H.student_id].push(H),X),{}),[]),k.useCallback(B=>{if(B.length===0)return 0;const X=B.reduce((H,he)=>H+(he.percentage||0),0);return Math.round(X/B.length)},[]),k.useCallback(B=>{B.score<B.passing_score&&window.confirm("Give another try?")&&nt(B.student_id,B.test_id)},[]);const nt=k.useCallback(async(B,X)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:B,testId:X})})).ok&&(ne&&Fe(p),a("Test made accessible to student","success"))}catch(H){console.error("Error resetting test attempt:",H),a("Failed to reset test attempt","error")}},[ne,p,Fe,a]),Rt=k.useCallback((B,X)=>{if(B===null||X===null)return"";const H=Math.round(B/X*100);return H>=80?"text-green-600 bg-green-50":H>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),ke=k.useCallback(B=>{Ze(B),xt(!0)},[]);k.useCallback((B,X,H)=>{Ae({resultId:B,score:X,maxScore:H}),Ue((X==null?void 0:X.toString())||""),Xe((H==null?void 0:H.toString())||""),At(!0)},[]),k.useCallback(B=>{Ue(B)},[]),k.useCallback(B=>{Xe(B)},[]),k.useCallback(async()=>{if($t){Ct(!0);try{const B={resultId:$t.resultId,score:parseInt(Pe)||0,maxScore:parseInt(We)||1};(await fetch(HA.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)})).ok?(a("Score updated successfully","success"),ne&&Fe(p),Ae(null),Ue(""),Xe(""),At(!1)):a("Failed to update score","error")}catch(B){console.error("Error updating score:",B),a("Failed to update score","error")}finally{Ct(!1)}}},[$t,Pe,We,ne,p,Fe,a]),k.useCallback(()=>{Ae(null),Ue(""),Xe(""),At(!1)},[]);const Qe=(B,X)=>{if(console.log(" Starting column editing for drawing test:",B),console.log(" Current editingColumns before update:",Array.from(Pt)),console.log(" Results data passed to function:",X),it(H=>{const he=new Set(H).add(B);return console.log(" Updated editingColumns:",Array.from(he)),he}),console.log(" Initializing column scores for test:",B),console.log(" Results data:",X),console.log(" Results.class:",X?X.class:"null"),X&&X.class){const H={};console.log(" Processing",X.class.length,"students"),X.class.forEach((he,Ne)=>{console.log(` Student ${Ne}:`,he.student_id,"Keys:",Object.keys(he));const M=he[B];console.log(` Student ${he.student_id} test result for ${B}:`,M),console.log(" Test result keys:",M?Object.keys(M):"null"),console.log(" Test result id:",M?M.id:"null"),M&&M.test_type==="drawing"&&(H[he.student_id]={score:(M.score||0).toString(),maxScore:(M.max_score||100).toString(),resultId:M.id})}),console.log(" Initial scores for column:",H),xe(he=>({...he,[B]:H}))}else console.log(" No results or class data available")},qe=k.useCallback(B=>{it(X=>{const H=new Set(X);return H.delete(B),H}),xe(X=>{const H={...X};return delete H[B],H})},[]),yt=k.useCallback((B,X,H,he)=>{const Ne=he.toString();ht.current[B]||(ht.current[B]={}),ht.current[B][X]||(ht.current[B][X]={}),ht.current[B][X][H]=Ne;const M=parseInt(he)||0;xe(Q=>{var ie;return{...Q,[B]:{...Q[B],[X]:{...(ie=Q[B])==null?void 0:ie[X],[H]:M}}}})},[]),Vt=k.useCallback(async B=>{if(ht.current[B]){Le(!0);try{const X=Object.entries(ht.current[B]).map(([M,Q])=>({resultId:Q.resultId,score:parseInt(Q.score)||0,maxScore:parseInt(Q.maxScore)||100}));console.log(" Saving column scores for",B,":",X);const H=X.map(M=>(console.log(" Sending update:",M),fetch(HA.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})));(await Promise.all(H)).every(M=>M.ok)?(a(`Scores updated successfully for ${B}`,"success"),ne&&Fe(p),qe(B)):a("Failed to update some scores","error")}catch(X){console.error("Error updating column scores:",X),a("Failed to update scores","error")}finally{Le(!1)}}},[rt,ne,p,Fe,a,qe]),zt=k.useCallback((B,X,H)=>!X||X.length===0?c.jsx(Me.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:c.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):c.jsxs(Me.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[ye&&c.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-500 text-white rounded-full p-2 shadow-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),re&&c.jsx("div",{className:"absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-500 text-white rounded-full p-2 shadow-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),c.jsxs(Me.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[c.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:he=>{we.current&&(we.current.scrollLeft=he.target.scrollLeft)},children:c.jsx("div",{className:"min-w-full h-1",children:c.jsx("div",{className:"h-1",style:{width:`${(H.length+5)*120}px`}})})}),c.jsx("div",{ref:we,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:he=>{tr(he);const Ne=he.target.previousElementSibling;Ne&&(Ne.scrollLeft=he.target.scrollLeft)},children:c.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[c.jsx("thead",{children:c.jsxs(Me.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[120px]",children:"Name"}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[120px]",children:"Surname"}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),H.map((he,Ne)=>{const M=ge.has(he.test_name),Q=he.test_type==="drawing",ie=pt.current.has(he.test_name);return console.log(` Rendering test ${he.test_name}:`,{isDrawingTest:Q,isEditingColumn:ie,editingColumns:Array.from(pt.current),test_type:he.test_type}),c.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${M?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:ue=>{ue.preventDefault(),ue.stopPropagation(),console.log(" Clicked on test header:",he.test_name),gr(he.test_name)},children:M?c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):c.jsxs("div",{className:"flex flex-col space-y-2",children:[Q&&c.jsx("div",{className:"flex justify-center",children:ie?c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:ue=>{ue.preventDefault(),ue.stopPropagation(),Vt(he.test_name)},disabled:De,className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",children:De?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):"Save"}),c.jsx("button",{onClick:ue=>{ue.preventDefault(),ue.stopPropagation(),qe(he.test_name)},disabled:De,className:"px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):c.jsx("button",{onClick:ue=>{ue.preventDefault(),ue.stopPropagation(),console.log(" Edit Column button clicked for drawing test:",he.test_name),console.log(" Results state at button click:",T),console.log(" Current results ref:",Tt.current),Qe(he.test_name,Tt.current)},className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit Column"})}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"truncate",title:he.test_name,children:he.test_name.length>8?he.test_name.substring(0,8)+"...":he.test_name}),c.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})},Ne)})]})}),c.jsx("tbody",{children:c.jsx(ea,{children:X.map((he,Ne)=>c.jsxs(Me.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Ne%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+Ne*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[c.jsx(Me.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:he.student_id}),c.jsx(Me.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:he.name}),c.jsx(Me.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:he.surname}),c.jsx(Me.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:he.number??Ne+1}),c.jsx(Me.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:he.nickname||"-"}),H.map((M,Q)=>{var Se,Ie,Te,Ve;const ie=ge.has(M.test_name),ue=he[M.test_name];return ie?(console.log(" Rendering collapsed column for test:",M.test_name),c.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:et=>{et.preventDefault(),et.stopPropagation(),console.log(" Clicked on collapsed arrow for:",M.test_name),gr(M.test_name)},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Q)):c.jsx(Me.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},children:ue&&ue.test_type==="drawing"?c.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[c.jsx("button",{onClick:()=>ke(ue),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const et=pt.current.has(M.test_name);return console.log(` Score cell for ${M.test_name}:`,{isEditing:et,editingColumns:Array.from(pt.current),test_name:M.test_name}),et})()?c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",min:"0",max:ue.max_score||100,value:((Ie=(Se=ht.current[M.test_name])==null?void 0:Se[he.student_id])==null?void 0:Ie.score)||ue.score||"",onChange:et=>yt(M.test_name,he.student_id,"score",et.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),c.jsx("span",{className:"text-xs text-gray-500",children:"/"}),c.jsx("input",{type:"number",min:"1",value:((Ve=(Te=ht.current[M.test_name])==null?void 0:Te[he.student_id])==null?void 0:Ve.maxScore)||ue.max_score||100,onChange:et=>yt(M.test_name,he.student_id,"maxScore",et.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):c.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors",onDoubleClick:()=>{console.log(" Double-clicked on drawing test score:",M.test_name),console.log(" Results state at double-click:",T),console.log(" Current results ref:",Tt.current),Qe(M.test_name,Tt.current)},title:"Double-click to edit column",children:[ue.score||0,"/",ue.max_score||100]}),ue.caught_cheating&&ue.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",ue.visibility_change_times,")"]})]}):ue&&ue.score!==null&&ue.score!==void 0?c.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[c.jsxs(Me.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${ue.caught_cheating?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800"}`,whileHover:{scale:1.1},transition:{duration:.2},children:[ue.score,"/",ue.max_score,ue.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]}),ue.caught_cheating&&ue.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",ue.visibility_change_times,")"]})]}):c.jsx("span",{className:"text-gray-400",children:"-"})},Q)})]},Ne))})})]})})]})]}),[Rt,ge,gr]),G=k.useCallback((B,X,H)=>!X||X.length===0?c.jsx(Me.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:c.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):c.jsx(Me.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:c.jsx(Me.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:c.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:c.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[c.jsx("thead",{children:c.jsxs(Me.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",children:"Name"}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",children:"Surname"}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),H.map((he,Ne)=>{const M=he.test_type==="drawing",Q=pt.current.has(he.test_name);return c.jsx(Me.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+Ne*.05},children:c.jsxs("div",{className:"flex flex-col space-y-1",children:[M&&c.jsx("div",{className:"flex justify-center",children:Q?c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:ie=>{ie.preventDefault(),ie.stopPropagation(),Vt(he.test_name)},disabled:De,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:De?"Saving...":"Save"}),c.jsx("button",{onClick:ie=>{ie.preventDefault(),ie.stopPropagation(),qe(he.test_name)},disabled:De,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):c.jsx("button",{onClick:ie=>{ie.preventDefault(),ie.stopPropagation(),Qe(he.test_name)},className:"px-1 py-0.5 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit"})}),c.jsx("span",{className:"text-xs",children:he.test_name.length>10?he.test_name.substring(0,10)+"...":he.test_name})]})},Ne)})]})}),c.jsx("tbody",{children:c.jsx(ea,{children:X.map((he,Ne)=>c.jsxs(Me.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Ne%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+Ne*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[c.jsx(Me.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:he.student_id}),c.jsx(Me.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:he.name}),c.jsx(Me.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:he.surname}),c.jsx(Me.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:he.number??Ne+1}),c.jsx(Me.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:he.nickname||"-"}),H.map((M,Q)=>{var Se,Ie,Te,Ve;const ie=ge.has(M.test_name),ue=he[M.test_name];return ie?c.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:et=>{et.preventDefault(),et.stopPropagation(),gr(M.test_name)},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Q):c.jsx(Me.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},children:ue&&ue.score!==null&&ue.score!==void 0?c.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[ue.test_type==="drawing"?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>ke(ue),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),pt.current.has(M.test_name)?c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",min:"0",max:ue.max_score||100,value:((Ie=(Se=ht.current[M.test_name])==null?void 0:Se[he.student_id])==null?void 0:Ie.score)||ue.score||"",onChange:et=>yt(M.test_name,he.student_id,"score",et.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),c.jsx("span",{className:"text-xs text-gray-500",children:"/"}),c.jsx("input",{type:"number",min:"1",value:((Ve=(Te=ht.current[M.test_name])==null?void 0:Te[he.student_id])==null?void 0:Ve.maxScore)||ue.max_score||100,onChange:et=>yt(M.test_name,he.student_id,"maxScore",et.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):c.jsxs(Me.div,{className:`px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors ${ue.caught_cheating?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800"}`,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>Qe(M.test_name),title:"Double-click to edit column",children:[ue.score,"/",ue.max_score,ue.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})]}):c.jsxs(Me.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${ue.caught_cheating?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800"}`,whileHover:{scale:1.05},transition:{duration:.15},children:[ue.score,"/",ue.max_score,ue.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]}),ue.caught_cheating&&ue.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",ue.visibility_change_times,")"]})]}):c.jsx("span",{className:"text-gray-400",children:"-"})},Q)})]},Ne))})})]})})})}),[Rt,ge,gr]),ce=k.useCallback(()=>{var H;if(!T)return null;console.log(" renderResults - results:",T),console.log(" renderResults - results.class:",T.class),console.log(" renderResults - results.unique_tests:",T.unique_tests);const B=T.class&&Array.isArray(T.class)&&T.class.length>0;if(console.log(" renderResults - hasStudentData:",B),!B)return console.log(" renderResults - No student data, showing no students message"),c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const X=T.unique_tests||[];return console.log(" renderResults - uniqueTests:",X),Tt.current=T,c.jsxs("div",{className:"space-y-6",children:[c.jsxs(Me.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[c.jsxs(Me.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",Z,", Class ",Z,"/",ne,", Semester ",p]}),c.jsxs(Me.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",((H=T.subjects)==null?void 0:H.length)||0," subject(s)"]}),c.jsxs(Me.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[c.jsx("button",{onClick:()=>{var Ne;const he=((Ne=T.unique_tests)==null?void 0:Ne.map(M=>M.test_name))||[];fe(new Set(he))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),c.jsx("button",{onClick:()=>fe(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),c.jsxs(Me.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[c.jsx(Me.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),c.jsx("div",{className:"hidden md:block",children:zt("All Subjects",T.class,X)}),c.jsx("div",{className:"md:hidden",children:G("All Subjects",T.class,X)})]})]})},[T,zt,Z,ne,p]),se=k.useCallback(()=>{if(!T||!T.class||!T.unique_tests)return;const B=["Student ID","Name","Surname","No.","Nickname",...T.unique_tests.map(Q=>Q.test_name)],X=T.class.map((Q,ie)=>{const ue=[];return ue.push(Q.student_id),ue.push(Q.name),ue.push(Q.surname),ue.push(Q.number??ie+1),ue.push(Q.nickname||"-"),T.unique_tests.forEach(Se=>{const Ie=Q[Se.test_name];Ie&&Ie.score!==null&&Ie.score!==void 0?ue.push(`${Ie.score}/${Ie.max_score}`):ue.push("-")}),ue}),H=kx.aoa_to_sheet([B,...X]),he=kx.book_new(),Ne=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...T.unique_tests.map(()=>({wch:15}))];H["!cols"]=Ne,kx.book_append_sheet(he,H,"Class Results");const M=`class-results-${Z}-${ne}-semester-${p}.xlsx`;h0e(he,M),a("Excel file exported successfully!","success")},[T,Z,ne,p,a]);return l?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(dr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):d?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:d}),c.jsx(Ge,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsx("div",{className:"flex justify-between items-center py-4",children:c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",I?I.toLocaleString():"Never"]})]})})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),b.length>0?c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:b.map((B,X)=>c.jsxs(Ge,{variant:Z===B.grade&&ne===B.class?"primary":"outline",onClick:()=>_e(B.grade,B.class),className:"w-full",children:[B.grade,"/",B.class]},`${B.grade}-${B.class}-${X}`))}):c.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),ne&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Select Semester for ",Z,"/",ne]}),c.jsx("div",{className:"flex space-x-4",children:[1,2].map(B=>{let X=1;if(D&&D.length>0){const H=new Date;for(const he of D){const Ne=new Date(he.start_date),M=new Date(he.end_date);if(H>=Ne&&H<=M){X=he.semester;break}}}return c.jsxs(Me.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${p===B?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>Fe(B),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",B,B===X&&c.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},B)})})]}),ne&&T&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[Z," ",ne," - Test Results (Semester ",p,")"]}),c.jsx("div",{className:"flex space-x-3",children:c.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:se,children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),c.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),ce()]}),ne&&!T&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No test results available for this class and semester."})})})]})}),Oe&&c.jsx(cO,{drawing:Oe,isOpen:Re,onClose:()=>xt(!1)})]})},sF=({onBackToLogin:t})=>{const e=Ua(),{user:r,isAuthenticated:n,logout:s,getCurrentTeacherUsername:a}=Dn(),{teacherData:i,loadTeacherData:o}=iy(),{activeTests:l,loadActiveTests:u}=ay(),{showNotification:d,notifications:h}=ka(),[m,x]=k.useState(!0),[p,v]=k.useState(""),[_,S]=k.useState("main"),[w,y]=k.useState([]),[b,E]=k.useState([]),[N,F]=k.useState(null),[T,P]=k.useState(null),[D,R]=k.useState(null),[I,W]=k.useState(!1),[le,q]=k.useState(!1),[V,K]=k.useState(null),[U,L]=k.useState(!1),[Z,ne]=k.useState(null),[z,Y]=k.useState(null),[J,te]=k.useState([]),[de,ee]=k.useState(!1),[ge,fe]=k.useState(null),[ye,Ce]=k.useState({}),[re,ve]=k.useState(!1),[we,Oe]=k.useState(!1),[Ze,Re]=k.useState([]),[xt,$t]=k.useState([]),[Ae,Pe]=k.useState(!1),[Ue,We]=k.useState(null),[Xe,ut]=k.useState([]),[Ct,Mt]=k.useState(!1),[At,Pt]=k.useState("subject");k.useEffect(()=>{De()},[]),k.useEffect(()=>{const ke=Qe=>{re&&!Qe.target.closest(".relative")&&ve(!1),we&&!Qe.target.closest(".relative")&&Oe(!1)};return document.addEventListener("mousedown",ke),()=>{document.removeEventListener("mousedown",ke)}},[re,we]);const it=k.useCallback(async()=>{console.log(" Loading teacher data...");try{const ke=await Br.getTeacherData();return console.log(" Teacher data loaded:",ke),Y(new Date),ke}catch(ke){throw console.error(" Error loading teacher data:",ke),ke}},[]),rt=k.useCallback(async()=>{var ke;console.log(" Loading teacher subjects...");try{const Qe=`teacher_subjects_${(r==null?void 0:r.teacher_id)||(r==null?void 0:r.id)||""}`,qe=wn(Qe);if(qe)return console.log(" Using cached teacher subjects"),y(qe),qe;const yt=await Br.getTeacherData();console.log(" Raw teacher data:",yt);const Vt=Br.getTeacherSubjects(yt.subjects);return console.log(" Teacher subjects loaded:",Vt),y(Vt),Zr(Qe,Vt,on.teacher_subjects),console.log(" Available classes for performance chart:",((ke=Vt[0])==null?void 0:ke.classes)||[]),console.log(" Performance chart will load when user clicks on a class"),Vt}catch(Qe){throw console.error(" Error loading teacher subjects:",Qe),Qe}},[r==null?void 0:r.teacher_id,r==null?void 0:r.id]),xe=k.useCallback(async()=>{console.log(" Loading teacher active tests...");try{const ke=`teacher_tests_${(r==null?void 0:r.teacher_id)||(r==null?void 0:r.id)||""}`,Qe=wn(ke);if(Qe)return console.log(" Using cached teacher tests"),E(Qe),Qe;const qe=await Er.getTeacherTests();return console.log(" Teacher tests loaded:",qe),E(qe),Zr(ke,qe,on.teacher_tests),qe}catch(ke){throw console.error(" Error loading teacher tests:",ke),ke}},[r==null?void 0:r.teacher_id,r==null?void 0:r.id]),De=k.useCallback(async()=>{console.log(" Initializing Teacher Cabinet...");try{if(x(!0),v(""),!n||!r){console.log(" User not authenticated"),v("User not authenticated");return}if(r.role!==Zs.TEACHER){console.error(" Invalid user role for teacher cabinet:",r.role),v("Access denied. Teacher role required.");return}console.log(" Loading teacher data..."),await it(),console.log(" Loading teacher subjects..."),await rt(),console.log(" Loading active tests..."),await xe(),console.log(" Teacher Cabinet initialization complete!")}catch(ke){console.error(" Error initializing teacher cabinet:",ke),v("Failed to initialize teacher cabinet")}finally{x(!1)}},[n,r,it,rt,xe]),Le=k.useCallback(()=>{console.log(" Showing subject selection prompt..."),W(!0),pt(),Pt("subject")},[]),pt=k.useCallback(async()=>{console.log(" Loading available subjects..."),Pe(!0);try{const ke=await Br.getSubjectsForSelection();Re(ke),console.log(" Available subjects loaded:",ke)}catch(ke){console.error(" Error loading available subjects:",ke),d("Failed to load subjects","error")}finally{Pe(!1)}},[]),ht=k.useCallback(ke=>{if(!ke){We(null);return}const Qe=Ze.find(qe=>qe.subject_id==ke);Qe&&(We(Qe),ut([]),Pt("classes"))},[Ze]),Tt=k.useCallback((ke,Qe)=>{ut(qe=>qe.some(yt=>yt.grade===ke&&yt.class===Qe)?qe.filter(yt=>!(yt.grade===ke&&yt.class===Qe)):[...qe,{grade:ke,class:Qe}])},[]),gr=k.useCallback(()=>{if(!Ue||Xe.length===0){d("Please select at least one class","warning");return}const ke={subject_id:parseInt(Ue.subject_id),subject_name:Ue.subject,classes:Xe};$t(Qe=>[...Qe,ke]),We(null),ut([]),Pt("subject"),d(`Added ${Ue.subject} with ${Xe.length} classes`,"success")},[Ue,Xe]),tr=k.useCallback(ke=>{$t(Qe=>Qe.filter((qe,yt)=>yt!==ke))},[]),mr=k.useCallback(async()=>{if(xt.length===0){d("Please select at least one subject","warning");return}try{const ke=await Br.saveTeacherSubjects(xt);if(ke.success)d("Subjects saved successfully!","success"),W(!1),$t([]),Pt("subject"),await rt();else throw new Error(ke.error||"Failed to save subjects")}catch(ke){console.error(" Error saving teacher subjects:",ke),d("Failed to save subjects","error")}},[xt,rt]);k.useCallback(async ke=>{console.log(" Saving teacher subjects:",ke);try{const Qe=await Br.saveTeacherSubjects(ke);if(Qe.success)d("Subjects saved successfully!","success"),await rt(),W(!1);else throw new Error(Qe.error||"Failed to save subjects")}catch(Qe){console.error(" Error saving teacher subjects:",Qe),d("Failed to save subjects","error")}},[rt]);const Je=k.useCallback(()=>{console.log(" Showing active tests..."),S("tests")},[]),jt=k.useCallback(ke=>{console.log(" Showing test details:",ke),K(ke),q(!0)},[]);k.useCallback(async(ke,Qe,qe)=>{console.log(" Removing class assignment:",ke,Qe,qe);try{const yt=await Er.removeClassAssignment(ke,Qe,qe);if(yt.success)d("Assignment removed successfully!","success"),await xe();else throw new Error(yt.error||"Failed to remove assignment")}catch(yt){console.error(" Error removing class assignment:",yt),d("Failed to remove assignment","error")}},[xe]);const vt=k.useCallback(async(ke,Qe)=>{console.log(" Marking test as completed:",ke,Qe);try{const qe=await Er.markTestCompleted(ke,Qe);if(qe.success){d("Test marked as completed!","success");const yt=`teacher_tests_${(r==null?void 0:r.teacher_id)||(r==null?void 0:r.id)||""}`;localStorage.removeItem(yt),console.log(" Cleared teacher tests cache"),await xe()}else throw new Error(qe.error||"Failed to mark test as completed")}catch(qe){console.error(" Error marking test as completed:",qe),d("Failed to mark test as completed","error")}},[xe,d,r==null?void 0:r.teacher_id,r==null?void 0:r.id]),me=k.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await xe(),d("Tests refreshed successfully!","success")}catch(ke){console.error(" Error refreshing tests:",ke),d("Failed to refresh tests","error")}},[xe]),be=k.useCallback(async ke=>{var Qe;console.log(" Loading performance data for class:",ke),console.log(" Current selectedClassForChart:",ge);try{const[qe,yt]=ke.split("/"),Vt=qe.startsWith("M")?qe:`M${qe}`,zt=await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${r.teacher_id}&grade=${Vt}&class=${ke}&semester=1&academic_period_id=8`);console.log(" API response status:",zt.status);const G=await zt.json();if(console.log(" Performance API response:",G),console.log(" API success:",G.success),console.log(" API results:",G.results),G.success&&G.results&&Array.isArray(G.results)){console.log(" Processing performance data:",G.results),console.log(" Results count:",G.results.length),console.log(" Students count:",(Qe=G.students)==null?void 0:Qe.length);const ce={};G.students&&Array.isArray(G.students)&&G.students.forEach(H=>{ce[H.student_id]={student_id:H.student_id,name:H.name,surname:H.surname,nickname:H.nickname,number:H.number}}),G.results.forEach(H=>{if(ce[H.student_id]){const he=H.test_name;ce[H.student_id][he]=`${H.score}/${H.max_score}`}});const se=Object.values(ce),B={},X=new Map;G.results.forEach(H=>{X.has(H.test_name)||X.set(H.test_name,{test_name:H.test_name,test_type:H.test_type})}),X.forEach((H,he)=>{B[he]={test_name:H.test_name,test_type:H.test_type,average_score:0,total_students:se.length,students_with_results:0}}),console.log(" Found students for performance calculation:",se.length),console.log(" Sample student data:",se[0]),console.log(" Test averages before calculation:",B),se.forEach(H=>{Object.keys(H).forEach(he=>{if(B[he]&&H[he]&&typeof H[he]=="string"&&H[he].includes("/")){const[Ne,M]=H[he].split("/").map(Number);!isNaN(Ne)&&!isNaN(M)&&M>0&&(B[he].average_score+=Ne/M*100,B[he].students_with_results+=1),B[he].total_students+=1}})}),Object.keys(B).forEach(H=>{B[H].students_with_results>0&&(B[H].average_score=B[H].average_score/B[H].students_with_results)}),console.log(" Calculated test averages:",B),Ce(H=>({...H,[ke]:B}))}else console.log(" No performance data available for class:",ke),Ce(ce=>({...ce,[ke]:{}}))}catch(qe){console.error(" Error loading performance data:",qe),console.error(" Error details:",qe.message),Ce(yt=>({...yt,[ke]:{}}))}},[r]);k.useCallback((ke,Qe)=>{console.log(" Showing class results:",ke,Qe),console.log(" Class click - grade:",ke,"className:",Qe),P(ke),R(Qe),S("results");const qe=`${ke}/${Qe}`;console.log(" Loading performance data for clicked class:",qe),fe(qe),be(qe)},[be]);const _e=k.useCallback(ke=>{if(!ke)return c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-gray-500",children:"Click on a class to view performance data"})]});const Qe=ye[ke]||{},qe=Object.values(Qe);if(qe.length===0)return c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-gray-500",children:"No test data available for this class"})]});const yt=qe.length>0?qe.reduce((zt,G)=>zt+G.average_score,0)/qe.length:0,Vt=Array.from({length:16},(zt,G)=>`Week ${G+1}`);return c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"h-64 bg-gray-50 rounded-lg p-4",children:c.jsxs("svg",{viewBox:"0 0 400 200",className:"w-full h-full",preserveAspectRatio:"xMidYMid meet",children:[[0,25,50,75,100].map(zt=>{const G=20+(100-zt)*1.6;return c.jsxs("g",{children:[c.jsx("line",{x1:"40",y1:G,x2:"360",y2:G,stroke:"#E5E7EB",strokeWidth:"1"}),c.jsxs("text",{x:"35",y:G+4,fontSize:"12",fill:"#6B7280",textAnchor:"end",children:[zt,"%"]})]},zt)}),Vt.map((zt,G)=>{if(G%4!==0)return null;const ce=40+G/(Vt.length-1)*320;return c.jsx("text",{x:ce,y:"190",fontSize:"10",fill:"#6B7280",textAnchor:"middle",children:zt},zt)}),(()=>{const zt=Vt.map((ce,se)=>{const B=Math.min(qe.length,Math.ceil((se+1)/4)*2),X=B/Math.max(qe.length,1);let H;if(B===0)H=0;else{const M=yt,Q=Math.min(X*20,15),ie=Math.sin(se*.3)*5;H=Math.max(0,Math.min(100,M+Q+ie))}const he=40+se/(Vt.length-1)*320,Ne=20+(100-H)*1.6;return{x:he,y:Ne,score:H,weekIndex:se}}),G=zt.map((ce,se)=>`${se===0?"M":"L"} ${ce.x} ${ce.y}`).join(" ");return c.jsxs("g",{children:[c.jsx("path",{d:G,fill:"none",stroke:"#3B82F6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),zt.map((ce,se)=>ce.score===0?null:c.jsx("circle",{cx:ce.x,cy:ce.y,r:"4",fill:"#3B82F6",stroke:"white",strokeWidth:"2"},se)),(()=>{const ce=Math.min(qe.length*2,16),se=zt[Math.min(ce-1,zt.length-1)];return se&&se.score>0?c.jsx("circle",{cx:se.x,cy:se.y,r:"6",fill:"#EF4444",stroke:"white",strokeWidth:"2"}):null})()]})})()]})}),c.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[c.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[c.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[yt.toFixed(1),"%"]}),c.jsx("div",{className:"text-sm text-blue-600",children:"Overall Average"})]}),c.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[c.jsx("div",{className:"text-2xl font-bold text-green-600",children:qe.length}),c.jsx("div",{className:"text-sm text-green-600",children:"Tests Completed"})]}),c.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-600",children:qe.length>0?Math.ceil(qe.length*2):0}),c.jsx("div",{className:"text-sm text-purple-600",children:"Weeks Progress"})]})]})]})},[ye]);if(m)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(dr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]})});if(p)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:p}),c.jsx(Ge,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return c.jsxs(Me.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(Me.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-6",children:[c.jsxs(Me.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),c.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",a()||""]})]}),c.jsxs(Me.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsx("div",{className:"hidden md:block",children:c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>ve(!re),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[c.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),c.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:re?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),re&&c.jsx(Me.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:c.jsxs("button",{onClick:()=>{ve(!1),t?t():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{children:"Logout"})]})})]})}),c.jsxs("div",{className:"md:hidden",children:[c.jsx("button",{onClick:()=>Oe(!we),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),we&&c.jsxs(Me.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[c.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:a()||"Teacher"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),c.jsxs("button",{onClick:()=>{Oe(!1),t?t():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{children:"Logout"})]})]})]})]})]})})}),c.jsx(Me.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:c.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((ke,Qe)=>c.jsxs(Me.button,{onClick:()=>ke.key==="tests"?Je():S(ke.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 ${_===ke.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+Qe*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[c.jsx("span",{className:"sm:hidden",children:ke.shortLabel}),c.jsx("span",{className:"hidden sm:inline",children:ke.label})]},ke.key))})})}),c.jsx(Me.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:c.jsxs(ea,{mode:"wait",children:[_==="main"&&c.jsx(Me.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Fe()},"main"),_==="subjects"&&c.jsx(Me.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:nt()},"subjects"),_==="tests"&&c.jsx(Me.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Rt()},"tests"),_==="results"&&c.jsx(Me.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:c.jsx(wL,{selectedGrade:T,selectedClass:D,onBackToCabinet:()=>S("main")})},"results")]})}),I&&c.jsx(Ou,{isOpen:I,onClose:()=>{W(!1),Pt("subject"),$t([]),We(null),ut([])},title:"Select Subjects and Classes",size:"large",children:c.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[At==="subject"&&c.jsxs(Me.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),Ae?c.jsxs("div",{className:"flex items-center justify-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),c.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):c.jsxs("select",{value:(Ue==null?void 0:Ue.subject_id)||"",onChange:ke=>ht(ke.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"Select a subject"}),Ze.map(ke=>c.jsx("option",{value:ke.subject_id,children:ke.subject},ke.subject_id))]})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx(Ge,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),c.jsx(Ge,{variant:"primary",onClick:()=>Pt("classes"),disabled:!Ue,children:"Next: Select Classes"})]})]}),At==="classes"&&Ue&&c.jsxs(Me.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",Ue.subject]}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),c.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:c.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6].map(ke=>c.jsxs("div",{className:"space-y-2",children:[c.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",ke]}),c.jsx("div",{className:"space-y-1",children:[15,16].map(Qe=>c.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[c.jsx("input",{type:"checkbox",checked:Xe.some(qe=>qe.grade===ke.toString()&&qe.class===Qe.toString()),onChange:()=>Tt(ke.toString(),Qe.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",Qe]})]},Qe))})]},ke))})})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx(Ge,{variant:"outline",onClick:()=>Pt("subject"),children:"Back to Subjects"}),c.jsxs("div",{className:"space-x-3",children:[c.jsx(Ge,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),c.jsx(Ge,{variant:"primary",onClick:gr,disabled:Xe.length===0,children:"Add Subject"})]})]})]}),xt.length>0&&c.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),c.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:xt.map((ke,Qe)=>c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:ke.subject_name}),c.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",ke.classes.map(qe=>`Grade ${qe.grade} Class ${qe.class}`).join(", ")]})]}),c.jsx("button",{onClick:()=>tr(Qe),className:"text-red-600 hover:text-red-800 p-1",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Qe))})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx(Ge,{variant:"outline",onClick:()=>Pt("subject"),children:"Add More Subjects"}),c.jsxs("div",{className:"space-x-3",children:[c.jsx(Ge,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),c.jsx(Ge,{variant:"primary",onClick:mr,children:"Save All Subjects"})]})]})]})]})}),le&&V&&c.jsxs(Ou,{isOpen:le,onClose:()=>q(!1),title:"Test Details",size:"large",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Name:"}),c.jsx("p",{className:"text-sm text-gray-900",children:V.test_name})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),c.jsx("p",{className:"text-sm text-gray-900",children:V.subject})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Type:"}),c.jsx("p",{className:"text-sm text-gray-900",children:V.test_type})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),c.jsx("p",{className:"text-sm text-gray-900",children:new Date(V.created_at).toLocaleDateString()})]})]}),c.jsx("div",{className:"flex justify-end space-x-3 mt-6",children:c.jsx(Ge,{variant:"outline",onClick:()=>q(!1),children:"Close"})})]}),c.jsx(Me.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:h.map(ke=>c.jsx(Me.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:c.jsx("div",{className:`p-4 rounded-lg shadow-lg ${ke.type==="success"?"bg-green-600 text-white":ke.type==="error"?"bg-red-600 text-white":ke.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{children:ke.message}),c.jsx("button",{onClick:()=>setNotifications(Qe=>Qe.filter(qe=>qe.id!==ke.id)),className:"ml-4 text-white hover:text-gray-200",children:""})]})})},ke.id))})]});function Fe(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsxs(at,{children:[c.jsx(at.Header,{children:c.jsx(at.Title,{children:"My Subjects & Classes"})}),c.jsx(at.Body,{children:w.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),c.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),c.jsx(Ge,{variant:"outline",onClick:()=>S("subjects"),children:"Manage Subjects"})]}):c.jsx("div",{className:"space-y-6",children:w.map((ke,Qe)=>{var qe;return c.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+Qe*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ke.name}),c.jsxs("span",{className:"text-sm text-gray-500",children:[((qe=ke.classes)==null?void 0:qe.length)||0," classes"]})]}),ke.classes&&ke.classes.length>0?c.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:ke.classes.map((yt,Vt)=>c.jsx(Me.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+Qe*.1+Vt*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:c.jsxs(Ge,{variant:"outline",size:"sm",onClick:()=>{P(yt.grade),R(yt.class),S("results")},className:"font-medium",children:[yt.grade,"/",yt.class]})},Vt))}):c.jsx("div",{className:"text-center py-4 text-gray-500",children:c.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},ke.id)})})})]})}),c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:c.jsxs(at,{children:[c.jsxs(at.Header,{children:[c.jsx(at.Title,{children:"Test Performance Overview"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Average scores across all tests by class"})]}),c.jsx(at.Body,{children:w.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const ke=[];return w.forEach(Qe=>{Qe.classes&&Qe.classes.forEach(qe=>{const yt=`${qe.grade}/${qe.class}`;ke.find(Vt=>Vt.key===yt)||ke.push({key:yt,grade:qe.grade,class:qe.class,subject:Qe.name})})}),ke})().map((ke,Qe)=>c.jsxs("button",{onClick:()=>{console.log(" Class button clicked:",ke.key),fe(ke.key),be(ke.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${ge===ke.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[ke.grade,"/",ke.class]},ke.key))}),c.jsx("div",{className:"mt-4",children:_e(ge)})]})})]})})]})}function nt(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsx(at,{children:c.jsx(at.Header,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx(at.Title,{children:"Subject Management"}),c.jsx(Ge,{variant:"primary",onClick:Le,children:"Add Subject"})]})})})}),w.length===0?c.jsx(Me.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:c.jsx(at,{children:c.jsx(at.Body,{children:c.jsxs("div",{className:"text-center p-12",children:[c.jsx(Me.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),c.jsx(Ge,{variant:"primary",onClick:Le,size:"lg",children:"Add Your First Subject"})]})})})}):c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:c.jsxs(at,{children:[c.jsx(at.Header,{children:c.jsx(at.Title,{children:"Your Subjects"})}),c.jsx(at.Body,{children:c.jsx("div",{className:"space-y-4",children:w.map((ke,Qe)=>{var qe;return c.jsx(Me.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+Qe*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:c.jsx("div",{className:"flex justify-between items-start",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:ke.name}),c.jsx("div",{className:"flex flex-wrap gap-2",children:((qe=ke.classes)==null?void 0:qe.map((yt,Vt)=>c.jsxs(Me.span,{className:"inline-block bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+Qe*.1+Vt*.05,duration:.2},whileHover:{scale:1.1},children:[yt.grade," - ",yt.className]},Vt)))||c.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},Qe)})})})]})})]})}function Rt(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsx(at,{children:c.jsx(at.Header,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx(at.Title,{children:"Active Tests"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx(Ge,{variant:"outline",onClick:me,children:"Refresh"}),c.jsx(Ge,{variant:"primary",onClick:()=>e("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),b.length===0?c.jsx(Me.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:c.jsx(at,{children:c.jsx(at.Body,{children:c.jsxs("div",{className:"text-center p-12",children:[c.jsx(Me.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),c.jsx(Ge,{variant:"primary",onClick:()=>e("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:b.map((ke,Qe)=>{var qe,yt,Vt;return c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+Qe*.1,duration:.3},whileHover:{scale:1.01},children:c.jsx(at,{children:c.jsx(at.Body,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex-1 flex items-center space-x-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0",children:ke.test_name}),c.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:ke.test_type}),c.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[c.jsx("span",{className:"font-medium",children:"Assignments:"}),c.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:((qe=ke.assignments)==null?void 0:qe.length)||0})]}),ke.assignments&&ke.assignments.length>0&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[c.jsx("span",{className:"font-medium",children:"Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-1",children:ke.assignments.map((zt,G)=>c.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[zt.grade,"/",zt.class]},G))})]}),c.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(ke.created_at).toLocaleDateString()})]})]}),c.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[c.jsx("div",{className:"sm:hidden",children:c.jsx(Ge,{variant:"outline",onClick:()=>jt(ke),size:"sm",className:"text-xs",title:`Assignments: ${((yt=ke.assignments)==null?void 0:yt.length)||0} | Classes: ${((Vt=ke.assignments)==null?void 0:Vt.map(zt=>`${zt.grade}/${zt.class}`).join(", "))||"None"} | ${new Date(ke.created_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}`,children:"Details"})}),c.jsx("div",{className:"hidden sm:block",children:c.jsx(Ge,{variant:"outline",onClick:()=>jt(ke),size:"sm",children:"Details"})}),c.jsx(Ge,{variant:"success",onClick:()=>vt(ke.test_type,ke.test_id),size:"sm",children:"Complete"})]})]})})})},Qe)})})]})}},k0e={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing"},aF=()=>{var H,he,Ne;const{user:t}=Dn();Wte();const{notifications:e,showNotification:r,removeNotification:n}=ka(),[s,a]=k.useState(!1),[i,o]=k.useState(!1),[l,u]=k.useState("typeSelection"),[d,h]=k.useState(!1),[m,x]=k.useState(null),[p,v]=k.useState([]),[_,S]=k.useState(!1),[w,y]=k.useState(!1),[b,E]=k.useState(!1),[N,F]=k.useState(!1),[T,P]=k.useState({testName:"",numQuestions:0,numOptions:0,questions:{}}),[D,R]=k.useState([]),[I,W]=k.useState(null);k.useRef(null),k.useRef(null),k.useRef(null),k.useRef(null),k.useRef(null),k.useRef(null),k.useRef(null);const le=k.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" Setting up test creation event listeners..."),ne(),console.log(" Test creation initialization complete")},[t,r]),q=k.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" showTestTypeSelection called - starting new test creation"),o(!1),console.log(" Reset testAssignmentCompleted flag to false"),a(!0),console.log(" Set isInTestCreation flag to true"),V(),u("typeSelection"),U("testTypeSelection")},[t,r]),V=k.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log(" Disabling navigation buttons..."),h(!0)},[t]),K=k.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log(" Enabling navigation buttons..."),h(!1)},[t]),U=k.useCallback(async M=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("  saveTestCreationState called with step:",M),console.log("  Call stack:",new Error().stack);const Q={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},ie={isInTestCreation:!0,currentStep:M,timestamp:Date.now(),excelState:Q};localStorage.setItem("test_creation_state",JSON.stringify(ie)),console.log(" Saved test creation state:",ie);const ue={};switch(M){case"testTypeSelection":break;case"multipleChoiceForm":ue.testName=T.testName||"",ue.numQuestions=T.numQuestions||"",ue.numOptions=T.numOptions||"",ue.questions=T.questions||{};break;case"trueFalseForm":ue.testName=T.testName||"",ue.numQuestions=T.numQuestions||"",ue.questions=T.questions||{};break;case"inputForm":ue.testName=T.testName||"",ue.numQuestions=T.numQuestions||"",ue.questions=T.questions||{};break;case"formCreation":ue.testName=T.testName||"",ue.numQuestions=T.numQuestions||"",ue.numOptions=T.numOptions||"",ue.questions=T.questions||{};break;case"assignment":case"testAssignment":ue.testName=T.testName||"",ue.numQuestions=T.numQuestions||"",ue.numOptions=T.numOptions||"",ue.questions=T.questions||{};break;default:console.log(" Unknown step in saveTestCreationState:",M);break}Object.keys(ue).length>0&&(localStorage.setItem(`form_data_${M}`,JSON.stringify(ue)),console.log(" Saved form data for step:",M,ue))},[t,T]),L=k.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const M=[];for(let Q=0;Q<localStorage.length;Q++){const ie=localStorage.key(Q);ie&&(ie.includes("test")||ie.includes("form")||ie.includes("question"))&&M.push(ie)}M.forEach(Q=>{localStorage.removeItem(Q),console.log(" Removed localStorage key:",Q)}),console.log(" Cleared test creation state from localStorage")},[t]);k.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log(" Clearing all test form fields..."),P({testName:"",numQuestions:0,numOptions:0,questions:{}}),x(null),R([]),W(null),console.log(" Cleared all test form fields")},[t]);const Z=k.useCallback(()=>{console.log(" Resetting Excel upload state..."),rt({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(Q=>{const ie=document.querySelector(`.excel-upload-btn[data-test-type="${Q}"]`);ie&&(ie.style.display="none",console.log(" Excel button hidden for:",Q));const ue=document.querySelector(`.excel-hint[data-test-type="${Q}"]`);ue&&(ue.style.display="none",console.log(" Excel hint hidden for:",Q));const Se=document.querySelector(`.excel-file-input[data-test-type="${Q}"]`);Se&&(Se.value="",console.log(" File input cleared for:",Q))}),console.log(" Excel upload state reset complete")},[]),ne=k.useCallback(()=>{console.log(" Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions"].forEach(Q=>{const ie=document.getElementById(Q);ie&&ie.addEventListener("input",()=>{console.log(` Auto-save triggered for field: ${Q}`)})}),console.log(" Form auto-save setup complete")},[]);k.useCallback(async M=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("  saveFormDataForStep called with step:",M),console.log("  Call stack:",new Error().stack);const Q={};switch(M){case"testTypeSelection":break;case"multipleChoiceForm":Q.testName=T.testName||"",Q.numQuestions=T.numQuestions||"",Q.numOptions=T.numOptions||"",Q.questions=T.questions||{};break;case"trueFalseForm":Q.testName=T.testName||"",Q.numQuestions=T.numQuestions||"",Q.questions=T.questions||{};break;case"inputForm":Q.testName=T.testName||"",Q.numQuestions=T.numQuestions||"",Q.questions=T.questions||{};break;case"formCreation":Q.testName=T.testName||"",Q.numQuestions=T.numQuestions||"",Q.numOptions=T.numOptions||"",Q.questions=T.questions||{};break;default:console.log(" Unknown step for form data save:",M);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:M,data:Q,timestamp:Date.now()})),console.log(" Saved form data for step:",M,Q)},[t,T]);const z=k.useCallback(async M=>{console.log(" Restoring form data for step:",M);try{const Q=localStorage.getItem(`form_data_${M}`);if(Q){const ie=JSON.parse(Q);console.log(" Restored form data:",ie),P(ue=>{const Se={...ue,...ie};return console.log(" Updated formData with restored data:",Se),console.log(" Matching test data in restored data:",Se.matchingTestData),Se}),Object.keys(ie).forEach(ue=>{const Se=document.getElementById(ue);Se&&ie[ue]!==void 0&&(Se.value=ie[ue])}),console.log(" Form data restored for step:",M)}else console.log(" No saved data found for step:",M)}catch(Q){console.error(" Error restoring form data:",Q)}},[t]),Y=k.useCallback(()=>{console.log(" Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(ie=>{const ue=document.getElementById(ie);ue&&ue.addEventListener("input",()=>{console.log(` Auto-save triggered for MC field: ${ie}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(ie=>{ie.addEventListener("input",()=>{console.log(" Auto-save triggered for MC question field")})}),console.log(" Multiple choice form auto-save setup complete")},[]),J=k.useCallback(()=>{console.log(" Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(Q=>{Q.addEventListener("input",()=>{console.log(" Auto-save triggered for TF question field")})}),console.log(" True/false form auto-save setup complete")},[]),te=k.useCallback(()=>{console.log(" Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(Q=>{Q.addEventListener("input",()=>{console.log(" Auto-save triggered for Input question field")})}),console.log(" Input form auto-save setup complete")},[]),de=k.useCallback(M=>{console.log(" showExcelUploadButton called with testType:",M);const Q=M==="multiple-choice"?"multipleChoice":M==="true-false"?"trueFalse":M==="input"?"input":M;rt(ie=>({...ie,[Q]:{...ie[Q],buttonVisible:!0}}))},[]),ee=k.useCallback(M=>{console.log(" showExcelHint called with testType:",M);const Q=M==="multiple-choice"?"multipleChoice":M==="true-false"?"trueFalse":M==="input"?"input":M;rt(ie=>({...ie,[Q]:{...ie[Q],hintVisible:!0}}))},[]),ge=k.useCallback(async(M,Q,ie)=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:M,testType:Q,testId:ie}),v(M),console.log(" Test assignment options displayed for:",{testType:Q,testId:ie,classesCount:M.length})},[t]),fe=k.useCallback(async(M,Q)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!t||!t.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",t.teacher_id);const ue=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${t.teacher_id}`)).json();console.log("Teacher subjects response:",ue),ue.success&&ue.subjects&&ue.subjects.length>0?(console.log("Teacher subjects loaded:",ue.subjects),v(ue.subjects),ge(ue.subjects,M,Q)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(ie){console.error("Error loading teacher grades and classes:",ie),r("Error loading teacher grades and classes","error")}},[t,r,ge]),ye=k.useCallback(async()=>{console.log(" Loading available classes...");try{const M=await Br.getGradesAndClasses();if(console.log(" Raw grades/classes data:",M),!M||M.length===0){v([]);return}const Q=new Map;M.forEach(ue=>{const Se=ue.subject_id,Ie=ue.subject||`Subject ${Se}`;Q.has(Se)||Q.set(Se,{subject_id:Se,subject:Ie,classes:[]}),Q.get(Se).classes.push({grade:ue.grade,class:ue.class})});const ie=Array.from(Q.values());v(ie),console.log(" Transformed available classes:",ie)}catch(M){console.error(" Error loading available classes:",M),r("Failed to load available classes","error")}},[r]);k.useCallback(async(M,Q)=>{if(i){o(!1);return}if(!t||!t.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}V(),U("testAssignment"),W(Q),x(M),u("testAssignment"),fe(M,Q),ye(),console.log(" Test assignment interface shown for:",{testType:M,testId:Q})},[i,t,V,U,fe,ye]);const Ce=k.useCallback(async M=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log(" Displaying teacher active tests:",M),M.length===0){Re([]);return}Re(M),console.log(" Active tests displayed:",M.length,"tests")},[t]);k.useCallback(async(M,Q)=>{try{console.log(" Loading test questions for:",{testType:M,testId:Q});const ie=await Er.getTestQuestions(Q,M);return console.log(" Test questions loaded:",ie),ie}catch(ie){throw console.error("Error loading test questions:",ie),ie}},[]),k.useCallback((M,Q,ie,ue)=>{console.log(" Showing teacher test details modal:",{testType:M,testId:Q,testName:ie,questionsCount:ue.length}),console.log("Test Details:",{testType:M,testId:Q,testName:ie,questions:ue.map(Se=>({id:Se.question_id,question:Se.question,correctAnswer:Se.correct_answer}))}),r(`Test details for "${ie}" loaded successfully.`,"success")},[r]);const re=k.useCallback(async()=>{console.log(" DEBUG: loadTeacherActiveTests called");try{console.log(" DEBUG: Fetching teacher active tests using JWT authentication...");const M=await Er.getTeacherTests();console.log(" DEBUG: Tests loaded:",M),M&&M.length>0?(console.log(" DEBUG: Success! Displaying",M.length,"tests"),Ce(M)):(console.log(" DEBUG: No tests found"),Re([]))}catch(M){console.error(" DEBUG: Error loading active tests:",M),r("Error loading active tests.","error")}},[r,Ce]),ve=k.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),u("typeSelection"),P({testName:"",numQuestions:0,numOptions:0,questions:{}}),R([]),o(!1),a(!1),L()},[r,L]),we=k.useCallback(async(M,Q)=>{if(console.log(" === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log(" Test Type:",M),console.log(" Test ID:",Q),console.log(" Current formData:",T),console.log(" Selected Classes:",D),console.log(" User:",t),!t||!t.teacher_id){console.error(" No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}if(console.log(" Teacher ID:",t.teacher_id),D.length===0){console.warn(" No classes selected"),r("Please select at least one class.","warning");return}try{console.log(" Preparing test + assignment request...");const ie=D.map(Te=>{const Ve={grade:parseInt(Te.grade),class:parseInt(Te.class),subject_id:parseInt(Te.subject_id),academic_period_id:8,due_date:null};return console.log(" Created assignment:",Ve),Ve});if(console.log(" Final assignments array:",ie),M==="matching"){console.log(" Processing matching test..."),console.log(" Setting isAssigningTest to true for matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(wt=>setTimeout(wt,100));const Te=T.matchingTestData;if(console.log(" Matching test data from formData:",Te),!Te){console.error(" Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log(" Matching test data found, processing...");let Ve;Te.processedQuestions?(console.log(" Using pre-processed questions from MatchingTestCreator"),Ve=Te.processedQuestions):(console.log(" Converting blocks to questions (fallback)..."),console.log(" Blocks:",Te.blocks),console.log(" Words:",Te.words),console.log(" Arrows:",Te.arrows),Ve=Te.blocks.map((wt,rr)=>{var ae;const Yt=((ae=Te.words.find(Be=>Be.blockId===wt.id))==null?void 0:ae.word)||`Word ${rr+1}`,or=Te.arrows.some(Be=>Be.startBlock===wt.id),Jt=Te.arrows.find(Be=>Be.startBlock===wt.id)||null,It={question_id:rr+1,word:Yt,block_coordinates:{x:wt.x,y:wt.y,width:wt.width,height:wt.height},has_arrow:or,arrow:Jt?{startX:Jt.startX,startY:Jt.startY,endX:Jt.endX,endY:Jt.endY,style:Jt.style||{}}:null};return console.log(` Question ${rr+1}:`,It),It})),console.log(" Final questions array:",Ve);const et={teacher_id:t.teacher_id,test_name:T.testName,image_url:Te.imageUrl,num_blocks:Te.blocks.length,questions:Ve,assignments:ie};console.log(" Final matching test data payload:",et),console.log(" Calling testService.saveMatchingTest...");const bt=await Er.saveMatchingTest(et);console.log(" API Response:",bt),bt.success?(console.log(" Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),o(!0),Oe()):(console.error(" Failed to create matching test:",bt.message),r("Error creating and assigning matching test: "+bt.message,"error")),F(!1);return}if(M==="wordMatching"){console.log(" Processing word matching test..."),console.log(" Setting isAssigningTest to true for word matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(wt=>setTimeout(wt,100));const Te=T.wordMatchingData;if(console.log(" Word matching test data from formData:",Te),!Te){console.error(" Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log(" Word matching test data found, processing...");const Ve=Te.wordPairs.map((wt,rr)=>({question_id:rr+1,left_word:wt.leftWord,right_word:wt.rightWord}));console.log(" Final word matching questions array:",Ve);const et={teacher_id:t.teacher_id,test_type:"word_matching",test_name:T.testName,num_questions:Te.wordPairs.length,interaction_type:Te.interactionType||"drag",questions:Ve,assignments:ie};console.log(" Final word matching test data payload:",et),console.log(" Calling testService.assignTestToClasses for word matching...");const bt=await Er.assignTestToClasses(et);console.log(" API Response:",bt),bt.success?(console.log(" Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),o(!0),Oe()):(console.error(" Failed to create word matching test:",bt.message),r("Error creating and assigning word matching test: "+bt.message,"error")),F(!1);return}if(M==="drawing"){console.log(" Processing drawing test..."),console.log(" Setting isAssigningTest to true for drawing test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(wt=>setTimeout(wt,100));const Te=T.drawingData;if(console.log(" Drawing test data from formData:",Te),!Te){console.error(" Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log(" Drawing test data found, processing...");const Ve=Te.questions||[];console.log(" Drawing questions array:",Ve);const et={teacher_id:t.teacher_id,test_type:"drawing",test_name:T.testName,num_questions:Te.num_questions,passing_score:Te.passing_score,questions:Ve,assignments:ie};console.log(" Final drawing test data payload:",et),console.log(" Calling testService.assignTestToClasses...");const bt=await Er.assignTestToClasses(et);console.log(" API Response:",bt),bt.success?(console.log(" Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),o(!0),Oe()):(console.error(" Failed to create drawing test:",bt.message),r("Error creating and assigning drawing test: "+bt.message,"error")),F(!1);return}console.log(" Processing non-matching test..."),console.log(" Form data questions:",T.questions);const ue=Object.keys(T.questions).map(Te=>{var wt;const Ve=T.questions[Te];console.log(` Processing question ${Te}:`,Ve);let et;M==="input"?et={correct_answers:Ve.correct_answers||[Ve.correctAnswer||""]}:et={correct_answer:Ve.correctAnswer||((wt=Ve.correct_answers)==null?void 0:wt[0])||""};const bt={question_id:parseInt(Te),question:Ve.question,...et,options:Ve.options||[]};return console.log(` Question ${Te} correct_answers:`,Ve.correct_answers),console.log(` Question ${Te} correctAnswer:`,Ve.correctAnswer),console.log(` Converted question ${Te}:`,bt),bt});console.log(" Final questions array:",ue);const Se={teacher_id:t.teacher_id,test_type:k0e[M],test_name:T.testName,num_questions:T.numQuestions,num_options:T.numOptions,questions:ue,assignments:ie};console.log(" Final test data payload:",Se),console.log(" Setting isAssigningTest to true..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Te=>setTimeout(Te,100)),console.log(" Calling testService.assignTestToClasses...");const Ie=await Er.assignTestToClasses(Se);console.log(" API Response:",Ie),Ie.success?(console.log(" Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),o(!0),Oe()):(console.error(" Failed to create and assign test:",Ie.message),r("Error creating and assigning test: "+Ie.message,"error"))}catch(ie){console.error(" Exception in assignTestToClasses:",ie),console.error("Error creating and assigning test:",ie),r("Error creating and assigning test. Please try again.","error")}finally{F(!1)}console.log(" === ASSIGN TEST TO CLASSES DEBUG END ===")},[t,D,T,r,ve]),Oe=k.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),o(!1),u("typeSelection"),x(null),W(null),R([]),K(),L(),ve(),console.log(" Returned to main cabinet")}catch(M){console.error("Error returning to main cabinet:",M)}},[K,L,ve]),[Ze,Re]=k.useState([]),[xt,$t]=k.useState(!1);k.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await re(),r("Active tests data refreshed.","success")}catch(M){console.error("Error refreshing active tests data:",M),r("Error refreshing data.","error")}},[re,r]);const[Ae,Pe]=k.useState([]),[Ue,We]=k.useState([]),[Xe,ut]=k.useState(!1),[Ct,Mt]=k.useState(!1),At=k.useCallback(async M=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",M),Pe(M),console.log(" Existing subjects displayed in selection:",M.length,"subjects")},[t]);k.useCallback(async()=>{try{console.log("Loading existing subjects...");const M=await Br.getTeacherSubjects();console.log("Existing subjects loaded:",M),M&&M.length>0?At(M):(console.log("No existing subjects found"),Pe([]))}catch(M){console.error("Error loading existing subjects:",M),r("Error loading subjects.","error")}},[r,At]);const Pt=k.useCallback(M=>{console.log("Checking for outside click...");const Q=document.getElementById("dropdownMenu"),ie=document.querySelector("[data-menu-button]");Q&&!Q.contains(M.target)&&!(ie!=null&&ie.contains(M.target))&&(console.log("Outside click detected, closing menu"),Q.classList.remove("show"),document.removeEventListener("click",Pt))},[]),[it,rt]=k.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),xe=k.useCallback((M,Q)=>{const ie=M.target.files[0];if(!ie)return;if(!ie.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),M.target.value="";return}if(ie.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),M.target.value="";return}E(!0);const ue=new FileReader;ue.onload=function(Se){try{console.log(" File loaded, processing data...");const Ie=new Uint8Array(Se.target.result),Te=Bb(Ie,{type:"array"}),Ve=Te.SheetNames[0],et=Te.Sheets[Ve],bt=kx.sheet_to_json(et,{header:1});console.log(" Parsed Excel data:",bt),Le(bt,Q),E(!1)}catch(Ie){console.error("Error processing Excel file:",Ie),r("Error reading Excel file: "+Ie.message,"error"),M.target.value="",E(!1)}},ue.onerror=function(){r("Failed to read file","error"),M.target.value="",E(!1)},ue.readAsArrayBuffer(ie)},[r]),De=k.useCallback(()=>{console.log(" Initializing Excel upload for all test types...");const M=document.querySelectorAll(".excel-upload-btn");console.log(` Found ${M.length} Excel upload buttons`),M.forEach((Q,ie)=>{const ue=Q.dataset.testType,Se=document.querySelector(`.excel-file-input[data-test-type="${ue}"]`);console.log(` Processing button ${ie+1}: testType=${ue}, fileInput=${Se?"found":"not found"}`),Se?(Q._excelClickHandler&&Q.removeEventListener("click",Q._excelClickHandler),Se._excelChangeHandler&&Se.removeEventListener("change",Se._excelChangeHandler),Q._excelClickHandler=()=>{console.log(` Excel upload button clicked for test type: ${ue}`),Se.click()},Se._excelChangeHandler=Ie=>{console.log(` File input changed for test type: ${ue}`),xe(Ie,ue)},Q.addEventListener("click",Q._excelClickHandler),Se.addEventListener("change",Se._excelChangeHandler),console.log(` Excel upload initialized for test type: ${ue}`)):console.warn(` File input not found for test type: ${ue}`)}),console.log(" Excel upload initialization complete")},[xe]),Le=k.useCallback((M,Q)=>{const ie=M.filter(et=>Array.isArray(et)&&et.length>0&&et.some(bt=>bt&&bt.toString().trim()!==""));console.log(" Original Excel data rows:",M.length),console.log(" Filtered Excel data rows:",ie.length);const Se=pt(ie,Q).dataRows;if(Se.length===0){const et="No data rows found after header processing. Please check your Excel file.";r(et,"error"),alert(et),jt(Q);return}console.log(` Processing Excel data for test type: ${Q}`),console.log(" Data rows after header processing:",Se);const Ie=gr(Se,Q);if(console.log(" Recognition result:",Ie),!Ie.recognized){console.log(` Excel data recognition failed for test type: ${Q}`);const et="Excel data recognition failed. Please check your file format.";r(et,"error"),alert(et),jt(Q);return}console.log(` Excel data recognition successful for test type: ${Q}`);const Te=Se.length,Ve=Je(Q);if(Ve===0)console.log(` No question count specified, using CSV count: ${Te}`),P(et=>({...et,numQuestions:Te}));else if(Te!==Ve){const et=`Your CSV file has ${Te} data rows, but you specified ${Ve} questions.

Please either:
1. Change your question count to ${Te}, or
2. Fix your CSV file to have exactly ${Ve} data rows

Then try uploading again.`;r(et,"error"),jt(Q);return}vt(Se,Q)},[r]),pt=k.useCallback((M,Q)=>{if(M.length===0)return{hasHeaders:!1,headerRow:null,dataRows:M};const ie=M[0],ue=ht(Q);if(Tt(ie,ue).isLikelyHeader){const Ie=`The first row of your Excel file looks like it contains headers:

"${ie.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(Ie))return{hasHeaders:!0,headerRow:ie,dataRows:M.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:M}},[]),ht=k.useCallback(M=>{switch(M){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),Tt=k.useCallback((M,Q)=>{if(!M||M.length===0)return{isLikelyHeader:!1};if(M.length<Q.expectedColumns)return{isLikelyHeader:!1};const ie=M.join(" ").toLowerCase(),ue=Q.keywords.filter(Ie=>ie.includes(Ie.toLowerCase()));return{isLikelyHeader:ue.length>Q.keywords.length/2,keywordMatches:ue}},[]),gr=k.useCallback((M,Q)=>{if(M.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(` Checking data pattern for test type: ${Q}`),console.log(" Excel data to validate:",M);const ie=tr(M,Q);if(console.log(" Recognition result:",ie),!ie.matches){const ue=`Your Excel file doesn't match the expected format.

Required format:
${mr(Q)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log(" Data pattern validation failed:",ue),console.log(" Calling showNotification with message:",ue),r(ue,"error"),console.log(" showNotification called"),alert(ue),{recognized:!1,data:[]}}return console.log(` Data pattern validation passed for test type: ${Q}`),{recognized:!0,data:M}},[r]),tr=k.useCallback((M,Q)=>{var ie;if(Q==="multipleChoice")for(let ue=0;ue<M.length;ue++){const Se=M[ue];if(Se.length<4)return{matches:!1,issue:`Row ${ue+1} has ${Se.length} columns but needs at least 4`};if(!Se[0]||Se[0].toString().trim()==="")return{matches:!1,issue:`Row ${ue+1} has no question in column 1`};if(!Se[1]||Se[1].toString().trim()==="")return{matches:!1,issue:`Row ${ue+1} has no correct answer in column 2`}}else if(Q==="trueFalse")for(let ue=0;ue<M.length;ue++){const Se=M[ue];if(Se.length<2)return{matches:!1,issue:`Row ${ue+1} has ${Se.length} columns but needs at least 2`};if(!Se[0]||Se[0].toString().trim()==="")return{matches:!1,issue:`Row ${ue+1} has no question in column 1`};const Ie=(ie=Se[1])==null?void 0:ie.toString().trim().toLowerCase();if(!Ie||!["true","false","t","f"].includes(Ie))return{matches:!1,issue:`Row ${ue+1} has invalid correct answer in column 2 (must be True/False)`}}else if(Q==="input")for(let ue=0;ue<M.length;ue++){const Se=M[ue];if(Se.length<2)return{matches:!1,issue:`Row ${ue+1} has ${Se.length} columns but needs at least 2`};if(!Se[0]||Se[0].toString().trim()==="")return{matches:!1,issue:`Row ${ue+1} has no question in column 1`};if(!Se[1]||Se[1].toString().trim()==="")return{matches:!1,issue:`Row ${ue+1} has no correct answer in column 2`}}return{matches:!0}},[]),mr=k.useCallback(M=>{switch(M){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),Je=k.useCallback(M=>T.numQuestions||0,[T.numQuestions]),jt=k.useCallback(M=>{console.log(` Clearing file input for test type: ${M}`)},[]),vt=k.useCallback((M,Q)=>{switch(console.log(` populateFromExcelForTestType called with testType: ${Q}`),Q){case"multipleChoice":case"multiple-choice":me(M);break;case"trueFalse":case"true-false":be(M);break;case"input":_e(M);break;default:console.log(` Unknown test type: ${Q}`)}},[]),me=k.useCallback(M=>{console.log(" populateMultipleChoiceFromExcel called with:",M);const Q=Math.max(...M.map(Se=>Se.length-2)),ie=Math.min(Q,6);console.log(` Excel data has ${Q} option columns, using ${ie} options`),P(Se=>({...Se,numOptions:ie}));const ue={};M.forEach((Se,Ie)=>{const Te=Ie+1;console.log(` Row ${Ie+1} data:`,Se);const Ve={question:(Se[0]||"").toString().trim(),options:[],correctAnswer:(Se[1]||"").toString().trim().toUpperCase()};console.log(` Question ${Te} correctAnswer:`,Ve.correctAnswer),["A","B","C","D","E","F"].slice(0,ie).forEach((wt,rr)=>{const Yt=(Se[rr+2]||"").toString().trim();console.log(` Option ${rr} (${wt}):`,Yt),Ve.options.push(Yt)}),ue[Te]=Ve}),P(Se=>{const Ie={...Se,questions:ue};return console.log(" Updating form data with:",Ie),Ie}),console.log(" Populated multiple choice questions from Excel:",ue),r(`Successfully loaded ${M.length} questions from CSV file!`,"success"),Y(),Fe("multiple-choice")},[T.numOptions,Y,r]),be=k.useCallback(M=>{console.log(" populateTrueFalseFromExcel called with:",M);const Q={};M.forEach((ie,ue)=>{var Te;const Se=ue+1,Ie={question:(ie[0]||"").toString().trim(),correctAnswer:((Te=ie[1])==null?void 0:Te.toString().trim().toLowerCase())==="true"?"true":"false"};Q[Se]=Ie}),P(ie=>({...ie,questions:Q})),console.log(" Populated true/false questions from Excel:",Q),r(`Successfully loaded ${M.length} questions from CSV file!`,"success"),J(),Fe("true-false")},[J,r]),_e=k.useCallback(M=>{console.log(" populateInputFromExcel called with:",M);const Q={};M.forEach((ie,ue)=>{const Se=ue+1,Ie=[];for(let Ve=1;Ve<ie.length;Ve++){const et=(ie[Ve]||"").toString().trim();et&&Ie.push(et)}const Te={question:(ie[0]||"").toString().trim(),correctAnswer:Ie[0]||"",correct_answers:Ie};console.log(` Excel question ${Se} data:`,Te),Q[Se]=Te}),P(ie=>({...ie,questions:Q})),console.log(" Populated input questions from Excel:",Q),r(`Successfully loaded ${M.length} questions from Excel file!`,"success"),te(),Fe("input")},[te,r]),Fe=k.useCallback(M=>{switch(console.log(` Reattaching form event listeners for test type: ${M}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(ie=>{ie.removeEventListener("input",()=>{}),ie.removeAttribute("data-listener-attached")}),M){case"multiple-choice":Y();break;case"true-false":J();break;case"input":te();break;default:console.warn("Unknown test type for event listener reattachment:",M)}console.log(` Form event listeners reattached for test type: ${M}`)},[Y,J,te]),nt=k.useCallback(()=>{const M=localStorage.getItem("test_creation_state");if(!M)return console.log(" No test creation state found in localStorage"),!1;try{const Q=JSON.parse(M);console.log(" Found test creation state:",Q);const ie=Date.now()-Q.timestamp,ue=30*60*1e3;if(ie>ue)return console.log(" Test creation state is too old, clearing it"),L(),!1;switch(a(!0),console.log(" Restored isInTestCreation flag to true"),V(),Q.excelState&&Z(),Q.currentStep){case"testTypeSelection":console.log(" Restoring test type selection step"),u("typeSelection");break;case"multipleChoiceForm":console.log(" Restoring multiple choice form step"),x("multipleChoice"),u("formCreation");break;case"trueFalseForm":console.log(" Restoring true/false form step"),x("trueFalse"),u("formCreation");break;case"inputForm":console.log(" Restoring input form step"),x("input"),u("formCreation");break;case"testAssignment":case"assignment":console.log(" Restoring test assignment step"),console.log(" Cannot restore test assignment step without test data, going back to type selection"),u("typeSelection");break;default:console.log(" Unknown step in state, defaulting to type selection"),u("typeSelection")}return z(Q.currentStep),!0}catch(Q){return console.error(" Error restoring test creation state:",Q),L(),!1}},[L,V,Z,z]);k.useEffect(()=>{console.log(" Initializing Teacher Tests..."),le(),nt(),ye(),De()},[le,nt,ye,De]),k.useEffect(()=>{T.numQuestions>0&&m&&m!=="matching"&&m!=="drawing"&&(console.log(" Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{De()},100))},[T.numQuestions,m,De]);const Rt=M=>{console.log(" Test type selected:",M),console.log(" Setting testType to:",M),x(M),u("formCreation"),P({testName:"",numQuestions:0,numOptions:0,questions:{}}),U("formCreation"),setTimeout(()=>{De()},100)},ke=(M,Q)=>{P(ie=>({...ie,[M]:Q}))},Qe=(M,Q,ie)=>{P(ue=>({...ue,questions:{...ue.questions,[M]:{...ue.questions[M],[Q]:ie}}}))},qe=(M,Q,ie,ue=0)=>{const Se={};for(let Ie=1;Ie<=ie;Ie++)M==="multipleChoice"?Se[Ie]={question:"",options:Array.from({length:ue},()=>""),correctAnswer:""}:M==="trueFalse"?Se[Ie]={question:"",correctAnswer:"true"}:M==="input"&&(Se[Ie]={question:"",correct_answers:[""]});P(Ie=>({...Ie,questions:Se})),M==="multipleChoice"?(de("multiple-choice"),ee("multiple-choice")):M==="trueFalse"?(de("true-false"),ee("true-false")):M==="input"&&(de("input"),ee("input"))},yt=async()=>{if(!m||!T.testName||!T.numQuestions){r("Please fill in all required fields","error");return}console.log(" Test form completed, proceeding to assignment step"),U("testAssignment",T),u("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},Vt=(M,Q,ie,ue,Se)=>{R(ie?Ie=>[...Ie,{grade:M,class:Q,subject_id:ue,subject:Se}]:Ie=>Ie.filter(Te=>!(Te.grade===M&&Te.class===Q&&Te.subject_id===ue)))},zt=k.useCallback(async M=>{console.log(" [DEBUG] handleMatchingTestSave called"),console.log(" [DEBUG] Received testData:",M),console.log(" [DEBUG] Current formData:",T),console.log(" [DEBUG] Current testType:",m),console.log(" [DEBUG] Current user:",t),console.log(" [DEBUG] Current currentStep:",l),y(!0);try{const Q=M.blocks.map((Se,Ie)=>{var bt;const Te=((bt=M.words.find(wt=>wt.blockId===Se.id))==null?void 0:bt.word)||`Word ${Ie+1}`,Ve=M.arrows.some(wt=>wt.startBlock===Se.id),et=M.arrows.find(wt=>wt.startBlock===Se.id)||null;return{question_id:Ie+1,word:Te,block_coordinates:{x:Se.x,y:Se.y,width:Se.width,height:Se.height},has_arrow:Ve,arrow:et?{startX:et.startX,startY:et.startY,endX:et.endX,endY:et.endY,style:et.style||{}}:null}}),ie={teacher_id:t.teacher_id,test_name:T.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:M.imageUrl,num_blocks:M.blocks.length,questions:Q,assignments:[]};console.log(" Sending matching test payload:",ie);const ue={...T,testName:ie.test_name,numQuestions:ie.num_blocks,numOptions:0,questions:Q.reduce((Se,Ie,Te)=>(Se[Te+1]={question:Ie.word,correctAnswer:Ie.word,options:[]},Se),{}),matchingTestData:M};console.log(" Assignment form data:",ue),P(ue),U("testAssignment",ue),console.log(" Setting current step to testAssignment"),u("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(Q){console.error(" Error saving matching test:",Q),r("Failed to save matching test: "+Q.message,"error")}finally{y(!1)}},[t,T,m,r,U]),G=k.useCallback(()=>{console.log(" Cancelling matching test creation"),u("typeSelection"),P({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ce=k.useCallback(async M=>{console.log(" [DEBUG] handleWordMatchingTestSave called"),console.log(" [DEBUG] Received testData:",M),y(!0);try{P(Q=>{var ie;return{...Q,wordMatchingData:M,numQuestions:M.numQuestions||((ie=M.wordPairs)==null?void 0:ie.length)||0}}),u("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(Q){console.error("Error saving word matching test:",Q),r("Failed to save word matching test: "+Q.message,"error")}finally{y(!1)}},[r]),se=k.useCallback(()=>{console.log(" Cancelling word matching test creation"),u("typeSelection"),P({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),B=k.useCallback(async M=>{console.log(" [DEBUG] handleDrawingTestSave called"),console.log(" [DEBUG] Received testData:",M),y(!0);try{P(Q=>{var ie;return{...Q,drawingData:M,numQuestions:M.num_questions||((ie=M.questions)==null?void 0:ie.length)||0}}),u("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(Q){console.error(" Error saving drawing test:",Q),r("Error saving drawing test","error")}finally{y(!1)}},[r]),X=k.useCallback(()=>{console.log(" Cancelling drawing test creation"),u("typeSelection"),P({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]);return c.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[c.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs(ea,{mode:"wait",children:[l==="typeSelection"&&c.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs(Ge,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsx("span",{children:"Back to Main"})]}),c.jsx("div",{className:"flex-1"})]}),c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),c.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Matching",description:"Questions matching items together",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Students match word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"}].map(({type:M,title:Q,description:ie,icon:ue})=>c.jsx(Me.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>Rt(M),children:c.jsxs(at,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[c.jsx("div",{className:"mb-3 flex justify-center",children:c.jsx("img",{src:ue,alt:Q,className:"w-12 h-12 object-contain"})}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Q}),c.jsx("p",{className:"text-sm text-gray-600",children:ie})]})},M))})]}),l==="formCreation"&&c.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"flex space-x-2",children:c.jsx(Ge,{variant:"outline",onClick:q,children:" Back to Test Types"})}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",m==="multipleChoice"?"Multiple Choice":m==="trueFalse"?"True/False":m==="input"?"Input":m==="drawing"?"Drawing":m==="wordMatching"?"Word Matching":"Matching"," Test"]}),c.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),c.jsx(at,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),c.jsx("input",{type:"text",value:T.testName,onChange:M=>ke("testName",M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),m!=="matching"&&m!=="wordMatching"&&m!=="drawing"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),c.jsx("input",{type:"number",min:"1",max:"50",value:T.numQuestions,onChange:M=>{const Q=parseInt(M.target.value)||0;ke("numQuestions",Q),Q>0&&qe(m,T.testName,Q,T.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),m==="multipleChoice"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),c.jsx("input",{type:"number",min:"2",max:"6",value:T.numOptions,onChange:M=>{const Q=parseInt(M.target.value)||0;ke("numOptions",Q),Q>0&&Q<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),T.numQuestions>0&&qe(m,T.testName,T.numQuestions,Q)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]})]})}),m==="matching"&&c.jsx(at,{children:c.jsxs("div",{className:"space-y-4 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Matching Test"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),c.jsx(WQ,{testName:T.testName,onTestSaved:zt,onCancel:G,onBackToCabinet:Oe,isSaving:w,validationErrors:{}})]})}),m==="wordMatching"&&c.jsx(at,{children:c.jsxs("div",{className:"space-y-4 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),c.jsx(zte,{testName:T.testName,onTestSaved:ce,onCancel:se,onBackToCabinet:Oe,isSaving:w,validationErrors:{}})]})}),m==="drawing"&&c.jsxs("div",{className:"drawing-test-section",children:[console.log(" Rendering DrawingTestCreator, testType:",m),c.jsx(Lte,{testName:T.testName,onTestSaved:B,onCancel:X,onBackToCabinet:Oe,isSaving:w,validationErrors:{}})]}),m!=="matching"&&m!=="drawing"&&T.numQuestions>0&&c.jsx(at,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),c.jsxs("div",{className:"space-y-6",children:[m==="multipleChoice"&&((H=it.multipleChoice)==null?void 0:H.buttonVisible)&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:b,children:b?c.jsxs(c.Fragment,{children:[c.jsx(dr,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Multiple Choice Format:"}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[c.jsx("div",{children:"Column 1: Question"}),c.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),c.jsx("div",{children:"Column 3: Option A text"}),c.jsx("div",{children:"Column 4: Option B text"}),c.jsx("div",{children:"Column 5: Option C text"}),c.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),m==="trueFalse"&&((he=it.trueFalse)==null?void 0:he.buttonVisible)&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:b,children:b?c.jsxs(c.Fragment,{children:[c.jsx(dr,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-xs text-blue-800",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),c.jsxs("div",{className:"mt-1",children:[c.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),c.jsxs("div",{className:"mt-1",children:[c.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),m==="input"&&((Ne=it.input)==null?void 0:Ne.buttonVisible)&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:b,children:b?c.jsxs(c.Fragment,{children:[c.jsx(dr,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Input Test Format:"}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[c.jsx("div",{children:"Column 1: Question"}),c.jsx("div",{children:"Column 2: Answer 1"}),c.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),m!=="matching"&&m!=="drawing"&&T.numQuestions>0&&c.jsx(at,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),T.numQuestions>0&&c.jsx(at,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),c.jsx("div",{className:"space-y-6",children:Object.keys(T.questions).map(M=>{var Q,ie,ue,Se,Ie,Te,Ve,et,bt,wt,rr;return c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",M]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),c.jsx("textarea",{value:((Q=T.questions[M])==null?void 0:Q.question)||"",onChange:Yt=>Qe(M,"question",Yt.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text"})]}),m==="multipleChoice"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),c.jsx("div",{className:"space-y-2",children:(ue=(ie=T.questions[M])==null?void 0:ie.options)==null?void 0:ue.map((Yt,or)=>c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+or),":"]}),c.jsx("input",{type:"text",value:Yt,onChange:Jt=>{const It=[...T.questions[M].options];It[or]=Jt.target.value,Qe(M,"options",It)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+or)}`})]},or))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),m==="multipleChoice"?c.jsx("div",{children:c.jsxs("select",{value:((Se=T.questions[M])==null?void 0:Se.correctAnswer)||"",onChange:Yt=>Qe(M,"correctAnswer",Yt.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),(Te=(Ie=T.questions[M])==null?void 0:Ie.options)==null?void 0:Te.map((Yt,or)=>c.jsx("option",{value:String.fromCharCode(65+or),children:String.fromCharCode(65+or)},or))]})}):m==="trueFalse"?c.jsxs("select",{value:((Ve=T.questions[M])==null?void 0:Ve.correctAnswer)||"true",onChange:Yt=>Qe(M,"correctAnswer",Yt.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"true",children:"True"}),c.jsx("option",{value:"false",children:"False"})]}):c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("input",{type:"text",value:((bt=(et=T.questions[M])==null?void 0:et.correct_answers)==null?void 0:bt[0])||"",onChange:Yt=>{var It;const Jt=[...((It=T.questions[M])==null?void 0:It.correct_answers)||[""]];Jt[0]=Yt.target.value,Qe(M,"correct_answers",Jt)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer"}),((rr=(wt=T.questions[M])==null?void 0:wt.correct_answers)==null?void 0:rr.slice(1).map((Yt,or)=>c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"text",value:Yt,onChange:Jt=>{var ae;const It=[...((ae=T.questions[M])==null?void 0:ae.correct_answers)||[]];It[or+1]=Jt.target.value,Qe(M,"correct_answers",It)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${or+2}`}),c.jsx("button",{type:"button",onClick:()=>{var It;const Jt=[...((It=T.questions[M])==null?void 0:It.correct_answers)||[]];Jt.splice(or+1,1),Qe(M,"correct_answers",Jt)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},or)))||[],c.jsx("button",{type:"button",onClick:()=>{var Jt;const or=[...((Jt=T.questions[M])==null?void 0:Jt.correct_answers)||[""],""];Qe(M,"correct_answers",or)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),c.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},M)})})]})}),T.testName&&T.numQuestions>0&&c.jsx("div",{className:"flex justify-end",children:c.jsx(Ge,{onClick:yt,disabled:w,className:"px-8",children:w?c.jsxs(c.Fragment,{children:[c.jsx(dr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),l==="testAssignment"&&c.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs(Ge,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsx("span",{children:"Back to Main"})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),c.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),c.jsx(Ge,{variant:"outline",onClick:()=>u("formCreation"),children:" Back to Test Form"})]}),c.jsx(at,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),p.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),c.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),c.jsx("div",{className:"mt-4",children:c.jsx(Ge,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):c.jsx("div",{className:"space-y-6",children:p.map(M=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:M.subject}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:M.classes.map(Q=>c.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:D.some(ie=>ie.grade===Q.grade&&ie.class===Q.class&&ie.subject_id===M.subject_id),onChange:ie=>Vt(Q.grade,Q.class,ie.target.checked,M.subject_id,M.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),c.jsxs("span",{className:"text-sm text-gray-700",children:[Q.grade,"/",Q.class]})]},`${Q.grade}-${Q.class}-${M.subject_id}`))})]},M.subject_id))})]})}),D.length>0&&c.jsx("div",{className:"flex justify-end",children:c.jsx(Ge,{onClick:()=>we(m,null),disabled:_,className:"px-8",children:_?c.jsxs(c.Fragment,{children:[c.jsx(dr,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${D.length} Class${D.length>1?"es":""}`})})]})]})}),console.log(" Checking isAssigningTest:",N),N&&c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),w&&c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:e.map(M=>c.jsx(_o,{type:M.type,message:M.message,duration:M.duration,onClose:()=>n(M.id)},M.id))})]})},C0e=({onDataLoaded:t,onError:e})=>{const r=Ua(),{user:n,isAuthenticated:s}=Dn(),{teacherData:a,loadTeacherData:i}=iy(),[o,l]=k.useState(!0),[u,d]=k.useState(""),[h,m]=k.useState([]),[x,p]=k.useState(null),[v,_]=k.useState([]),[S,w]=k.useState([]),[y,b]=k.useState([]),[E,N]=k.useState(null),[F,T]=k.useState(0);k.useEffect(()=>{le()},[]),k.useCallback(async V=>{console.log(" Teacher login attempt...");try{const K=await Br.teacherLogin(V);if(K.success)return W("Login successful!","success"),await P(),K;throw new Error(K.error||"Login failed")}catch(K){throw console.error(" Teacher login error:",K),W("Login failed. Please check your credentials.","error"),K}},[]);const P=k.useCallback(async()=>{console.log(" Loading teacher data...");try{if(l(!0),d(""),!s||!n){console.log(" User not authenticated"),d("User not authenticated");return}if(n.role!==Zs.TEACHER){console.error(" Invalid user role for teacher data:",n.role),d("Access denied. Teacher role required.");return}console.log(" Fetching teacher data from service...");const V=await Br.getTeacherData();if(V&&V.success)console.log(" Teacher data loaded successfully:",V),p(V.teacher||n),V.subjects&&(_(V.subjects),console.log(" Teacher subjects loaded:",V.subjects.length)),V.grades&&w(V.grades),V.classes&&b(V.classes),N(new Date),T(K=>K+1),t&&t(V),W("Teacher data loaded successfully!","success");else throw new Error((V==null?void 0:V.error)||"Failed to load teacher data")}catch(V){console.error(" Error loading teacher data:",V);const K=V.message||"Failed to load teacher data";d(K),e&&e(V),W(K,"error")}finally{l(!1)}},[s,n,t,e]),D=k.useCallback(()=>{console.log(" Returning to main cabinet..."),r("/teacher/cabinet")},[r]);k.useCallback(V=>{console.log(" Showing main cabinet with subjects:",V),V&&_(V),r("/teacher/cabinet")},[r]);const R=k.useCallback(()=>(console.log(" Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(K=>({id:K,name:`Grade ${K}`,classes:I(K)}))),[]),I=k.useCallback(V=>Array.from({length:10},(U,L)=>L+1).map(U=>({id:`${V}-${U}`,name:`Class ${U}`,grade:V,classNumber:U})),[]),W=k.useCallback((V,K)=>{const U={id:Date.now(),message:V,type:K,timestamp:new Date};m(L=>[...L,U]),setTimeout(()=>{m(L=>L.filter(Z=>Z.id!==U.id))},cc.NOTIFICATION_DURATION)},[]),le=k.useCallback(async()=>{console.log(" Initializing teacher data..."),await P()},[P]),q=k.useCallback(async()=>{console.log(" Refreshing teacher data..."),await P()},[P]);return k.useCallback(async V=>{console.log(" Updating teacher profile:",V);try{const K=await Br.updateUserProfile(V);if(K.success)return p(U=>({...U,...V})),W("Profile updated successfully!","success"),K;throw new Error(K.error||"Failed to update profile")}catch(K){throw console.error(" Error updating teacher profile:",K),W("Failed to update profile","error"),K}},[]),k.useCallback(async V=>{console.log(" Changing teacher password...");try{const K=await Br.changePassword(V);if(K.success)return W("Password changed successfully!","success"),K;throw new Error(K.error||"Failed to change password")}catch(K){throw console.error(" Error changing teacher password:",K),W("Failed to change password","error"),K}},[]),o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(dr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):u?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:u}),c.jsxs("div",{className:"flex space-x-3 justify-center",children:[c.jsx(Ge,{variant:"primary",onClick:q,children:"Retry"}),c.jsx(Ge,{variant:"outline",onClick:D,children:"Go Back"})]})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",E?E.toLocaleString():"Never"," | Version: ",F]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx(Ge,{variant:"outline",onClick:q,children:"Refresh Data"}),c.jsx(Ge,{variant:"outline",onClick:D,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),x?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),c.jsx("p",{className:"text-sm text-gray-900",children:x.name||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),c.jsx("p",{className:"text-sm text-gray-900",children:x.username||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),c.jsx("p",{className:"text-sm text-gray-900",children:x.email||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),c.jsx("p",{className:"text-sm text-gray-900",children:x.role||"N/A"})]})]}):c.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",v.length,")"]}),v.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map((V,K)=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-medium text-gray-900",children:V.name}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:V.description||"No description"}),V.classes&&V.classes.length>0&&c.jsxs("div",{className:"mt-2",children:[c.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:V.classes.map((U,L)=>c.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[U.grade," - ",U.className]},L))})]})]},K))}):c.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R().map(V=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:V.name}),c.jsx("div",{className:"grid grid-cols-5 gap-1",children:V.classes.map(K=>c.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",K),children:K.classNumber},K.id))})]},V.id))})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:v.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-green-600",children:S.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:y.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:F}),c.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:h.map(V=>c.jsx(_o,{type:V.type,message:V.message,onClose:()=>m(K=>K.filter(U=>U.id!==V.id))},V.id))})]})},T0e=({onBackToCabinet:t})=>{var $t;const e=Ua(),{user:r,isAuthenticated:n}=Dn(),{teacherData:s}=iy(),[a,i]=k.useState(!0),[o,l]=k.useState(""),[u,d]=k.useState([]),[h,m]=k.useState([]),[x,p]=k.useState([]),[v,_]=k.useState([]),[S,w]=k.useState(null),[y,b]=k.useState([]),[E,N]=k.useState(!1),[F,T]=k.useState(!1),[P,D]=k.useState(!1),[R,I]=k.useState(!1),[W,le]=k.useState(null),[q,V]=k.useState(!0),[K,U]=k.useState(null);k.useEffect(()=>{Re()},[]),k.useCallback(Ae=>{console.log(" Rendering existing subjects:",Ae),m(Ae)},[]);const L=k.useCallback(()=>{console.log(" Showing subject selection prompt..."),N(!0),V(!1),Z()},[]),Z=k.useCallback(async()=>{console.log(" Loading existing subjects...");try{const Ae=await Br.getTeacherSubjects();Ae.success&&Ae.subjects&&Ae.subjects.length>0?(console.log(" Existing subjects found:",Ae.subjects),ne(Ae.subjects)):(console.log(" No existing subjects found"),_([]))}catch(Ae){console.error(" Error loading existing subjects:",Ae),Ze("Failed to load existing subjects","error")}},[]),ne=k.useCallback(Ae=>{console.log(" Rendering subject selection:",Ae);const Pe=[];Ae.forEach(Ue=>{Ue.classes&&Array.isArray(Ue.classes)&&Ue.classes.forEach(We=>{Pe.push({id:`${Ue.subject_id}-${We.grade}-${We.class}`,subjectId:Ue.subject_id,subjectName:Ue.subject,grade:We.grade,class:We.class,displayText:`${Ue.subject} - ${We.grade}/${We.class}`})})}),_(Pe),console.log(" Processed subjects for selection:",Pe)},[]),z=k.useCallback(async Ae=>{if(console.log(" Saving teacher subjects:",Ae),!Ae||Ae.length===0){Ze("Please select at least one subject and class combination.","warning");return}try{const Pe=Ae.reduce((We,Xe)=>{const ut=We.find(Ct=>Ct.subject_id===Xe.subjectId);return ut?ut.classes.push({grade:Xe.grade,class:Xe.class}):We.push({subject_id:Xe.subjectId,classes:[{grade:Xe.grade,class:Xe.class}]}),We},[]);console.log(" Transformed data for backend:",Pe);const Ue=await Br.saveTeacherSubjects(Pe);if(Ue.success)Ze("Subjects saved successfully!","success"),N(!1),V(!0),U(new Date),await Z();else throw new Error(Ue.error||"Failed to save subjects")}catch(Pe){console.error(" Error saving subjects:",Pe),Ze("Error saving subjects. Please try again.","error")}},[]),Y=k.useCallback(()=>{console.log(" Toggling subject dropdown..."),T(Ae=>!Ae),D(!1)},[]),J=k.useCallback(async()=>{var Ae;console.log(" Loading subjects for dropdown...");try{const Pe=await Br.getAllSubjects();if(Pe.success)p(Pe.subjects||[]),console.log(" Available subjects loaded:",((Ae=Pe.subjects)==null?void 0:Ae.length)||0);else throw new Error(Pe.error||"Failed to load subjects")}catch(Pe){console.error(" Error loading subjects for dropdown:",Pe),Ze("Failed to load subjects","error")}},[]),te=k.useCallback(Ae=>{console.log(" Subject selected:",Ae);const Pe=x.find(Ue=>Ue.subject_id===parseInt(Ae));Pe&&(w(Pe),D(!0),T(!1),de())},[x]),de=k.useCallback(()=>{console.log(" Loading grades and classes...")},[]),ee=k.useCallback((Ae,Pe)=>{console.log(" Saving classes for subject:",Ae,Pe);const Ue={id:`${Ae.subject_id}-${Date.now()}`,subjectId:Ae.subject_id,subjectName:Ae.subject,grade:Pe.grade,class:Pe.class,displayText:`${Ae.subject} - ${Pe.grade}/${Pe.class}`};_(We=>[...We,Ue]),w(null),b([]),D(!1),fe(`Added ${Ae.subject} for ${Pe.grade}/${Pe.class}`)},[]),ge=k.useCallback(()=>{console.log(" Resetting subject selection..."),w(null),b([]),T(!1),D(!1)},[]),fe=k.useCallback(Ae=>{console.log(" Showing message:",Ae),Ze(Ae,"success")},[]),ye=k.useCallback(Ae=>{console.log(" Showing confirmation modal:",Ae),le(Ae),I(!0)},[]),Ce=k.useCallback(()=>{console.log(" Hiding confirmation modal..."),I(!1),le(null)},[]),re=k.useCallback(()=>{console.log(" Confirming save subjects..."),Ce(),z(v)},[v,z,Ce]),ve=k.useCallback(()=>{console.log(" Cancelling save subjects..."),Ce()},[Ce]),we=k.useCallback(Ae=>{console.log(" Removing subject:",Ae),_(Pe=>Pe.filter(Ue=>Ue.id!==Ae)),Ze("Subject removed","info")},[]);k.useCallback(()=>{console.log(" Showing edit subjects button..."),V(!0)},[]),k.useCallback(()=>{console.log(" Hiding edit subjects button..."),V(!1)},[]);const Oe=k.useCallback(Ae=>{console.log(" Generating class buttons for grade:",Ae);let Pe;return Ae===1||Ae===2?Pe=["15","16"]:Ae===3?Pe=["15","16"]:Ae===4?Pe=["13","14"]:Ae===5||Ae===6?Pe=["13","14"]:Pe=[],Pe.map(Ue=>({id:`${Ae}-${Ue}`,grade:Ae,class:Ue,displayText:`${Ae}/${Ue}`}))},[]);k.useCallback((Ae,Pe)=>{console.log(" Showing class results:",Ae,Pe),e("/teacher/results")},[e]);const Ze=k.useCallback((Ae,Pe)=>{const Ue={id:Date.now(),message:Ae,type:Pe,timestamp:new Date};d(We=>[...We,Ue]),setTimeout(()=>{d(We=>We.filter(Xe=>Xe.id!==Ue.id))},cc.NOTIFICATION_DURATION)},[]),Re=k.useCallback(async()=>{console.log(" Initializing teacher subjects...");try{if(i(!0),l(""),!n||!r){console.log(" User not authenticated"),l("User not authenticated");return}if(r.role!==Zs.TEACHER){console.error(" Invalid user role for teacher subjects:",r.role),l("Access denied. Teacher role required.");return}await Z(),await J(),console.log(" Teacher subjects initialization complete!")}catch(Ae){console.error(" Error initializing teacher subjects:",Ae),l("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,Z,J]),xt=k.useCallback(()=>{t?t():e("/teacher/cabinet")},[t,e]);return a?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(dr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:o}),c.jsx(Ge,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",K?K.toLocaleString():"Never"]})]}),c.jsxs("div",{className:"flex space-x-3",children:[q&&c.jsx(Ge,{variant:"primary",onClick:L,children:"Edit Subjects"}),c.jsx(Ge,{variant:"outline",onClick:xt,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[!E&&c.jsxs("div",{className:`
              bg-white rounded-xl shadow-md border border-gray-200 p-6
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200
            `,children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),c.jsx("div",{className:"flex space-x-3",children:c.jsxs(Ge,{variant:"primary",onClick:L,className:"px-6 py-2",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),h.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map((Ae,Pe)=>c.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:Ae.subject}),Ae.classes&&Ae.classes.length>0&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:Ae.classes.map((Ue,We)=>c.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",Ue.grade," - Class ",Ue.class]},We))})]})]}),c.jsx("div",{className:"ml-4",children:c.jsx(Ge,{variant:"outline",size:"sm",onClick:()=>we(Ae.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},Pe))}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:c.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),c.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),c.jsxs(Ge,{variant:"primary",onClick:L,className:"px-6 py-3",children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),E&&c.jsxs("div",{className:`
              bg-white rounded-xl shadow-md border border-gray-200 p-6
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200
            `,children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),c.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),c.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs(Ge,{variant:"outline",onClick:Y,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[c.jsx("span",{className:"text-gray-900 font-medium",children:S?S.subject:"Select a subject"}),c.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),F&&c.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:x.map(Ae=>c.jsx("button",{onClick:()=>te(Ae.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:c.jsx("span",{className:"text-gray-900 font-medium",children:Ae.subject})},Ae.subject_id))})]})]}),P&&S&&c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-6",children:[c.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",S.subject]}),c.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(Ae=>c.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:c.jsx("span",{className:"text-white font-bold text-xs",children:Ae})}),c.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",Ae]})]}),c.jsx("div",{className:"space-y-3",children:Oe(Ae).map(Pe=>c.jsx(Ge,{variant:"outline",size:"sm",onClick:()=>ee(S,Pe),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:Pe.displayText},Pe.id))})]},Ae))})]}),v.length>0&&c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),c.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(Ae=>c.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex-1",children:c.jsx("span",{className:"text-sm font-semibold text-purple-900",children:Ae.displayText})}),c.jsx(Ge,{variant:"outline",size:"sm",onClick:()=>we(Ae.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Ae.id))})]}),c.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[c.jsx("div",{className:"text-sm text-gray-500",children:v.length>0?`${v.length} subject${v.length>1?"s":""} selected`:"No subjects selected"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs(Ge,{variant:"outline",onClick:()=>{N(!1),V(!0),ge()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),c.jsxs(Ge,{variant:"primary",onClick:()=>ye({type:"save",data:v}),disabled:v.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),P?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),R&&c.jsx(Ou,{isOpen:R,onClose:Ce,title:"Confirm Save",variant:"confirmation",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",(($t=W==null?void 0:W.data)==null?void 0:$t.length)||0," subject assignments?"]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx(Ge,{variant:"outline",onClick:ve,children:"Cancel"}),c.jsx(Ge,{variant:"primary",onClick:re,children:"Save"})]})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:u.map(Ae=>c.jsx(_o,{type:Ae.type,message:Ae.message,onClose:()=>d(Pe=>Pe.filter(Ue=>Ue.id!==Ae.id))},Ae.id))})]})},E0e=()=>{const{user:t,role:e,isAuthenticated:r,isLoading:n}=Dn(),[s,a]=k.useState("cabinet");return!r||e!=="teacher"?c.jsx(Ef,{to:"/login",replace:!0}):n?c.jsxs("div",{className:"teacher-app-loading",children:[c.jsx(dr,{}),c.jsx("p",{children:"Loading teacher interface..."})]}):c.jsx("div",{className:"teacher-app",children:c.jsxs(Lk,{children:[c.jsx(Fn,{path:"/",element:c.jsx(sF,{})}),c.jsx(Fn,{path:"/cabinet",element:c.jsx(sF,{})}),c.jsx(Fn,{path:"/tests",element:c.jsx(aF,{})}),c.jsx(Fn,{path:"/tests/create",element:c.jsx(aF,{})}),c.jsx(Fn,{path:"/data",element:c.jsx(C0e,{})}),c.jsx(Fn,{path:"/subjects",element:c.jsx(T0e,{})}),c.jsx(Fn,{path:"/results",element:c.jsx(wL,{})}),c.jsx(Fn,{path:"*",element:c.jsx(Ef,{to:"/teacher",replace:!0})})]})})},pe={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},N0e=()=>{var It;const{user:t,isAdmin:e,logout:r}=Dn(),{get:n,post:s}=fl(),[a,i]=k.useState(!1),[o,l]=k.useState(null),[u,d]=k.useState(null),[h,m]=k.useState(!1),[x,p]=k.useState(!1),[v,_]=k.useState(!1),[S,w]=k.useState(!1),[y,b]=k.useState(""),[E,N]=k.useState(null),[F,T]=k.useState({}),[P,D]=k.useState(null),[R,I]=k.useState({}),[W,le]=k.useState(null),[q,V]=k.useState({}),[K,U]=k.useState([]),[L,Z]=k.useState(""),[ne,z]=k.useState(""),[Y,J]=k.useState(""),[te,de]=k.useState(!0),[ee,ge]=k.useState(!1),[fe,ye]=k.useState([]),[Ce,re]=k.useState(""),[ve,we]=k.useState(""),[Oe,Ze]=k.useState(""),[Re,xt]=k.useState(!1),[$t,Ae]=k.useState(!1),[Pe,Ue]=k.useState([]),[We,Xe]=k.useState([]),[ut,Ct]=k.useState([]),[Mt,At]=k.useState([]),[Pt,it]=k.useState(!1),[rt,xe]=k.useState(!1),[De,Le]=k.useState(!1),[pt,ht]=k.useState(!1),[Tt,gr]=k.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[tr,mr]=k.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[Je,jt]=k.useState({subject_id:"",subject:"",description:"",is_active:!0}),[vt,me]=k.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});k.useEffect(()=>{console.log(" AdminCabinet component mounted - initializing..."),be()},[]),k.useEffect(()=>{const ae=Be=>{Re&&!Be.target.closest(".admin-menu")&&xt(!1)};return document.addEventListener("mousedown",ae),()=>{document.removeEventListener("mousedown",ae)}},[Re]);const be=k.useCallback(async()=>{try{i(!0),await Rt(),console.log("Admin app initialized")}catch(ae){l("Failed to initialize admin app"),console.error("Admin app initialization error:",ae)}finally{i(!1)}},[]),_e=k.useCallback(()=>{xt(ae=>!ae)},[]),Fe=k.useCallback(()=>{Ae(!0),xt(!1)},[]),nt=k.useCallback(()=>{Ae(!1)},[]),Rt=k.useCallback(async()=>{try{await Promise.all([ke(),Qe(),qe(),yt()])}catch(ae){console.error("Error loading admin data:",ae),l("Failed to load admin data")}},[]),ke=k.useCallback(async()=>{try{const ae="admin_users_",Be=wn(ae);if(Be){console.log(" Using cached users data"),Ue(Be);return}const lr=await n("/.netlify/functions/get-all-users");console.log(" Users response:",lr);const Ot=lr.users||[];Ue(Ot),Zr(ae,Ot,on.admin_users),console.log(" Users set to state:",Ot)}catch(ae){console.error("Error loading users:",ae)}},[n]),Qe=k.useCallback(async()=>{try{const ae="admin_teachers_",Be=wn(ae);if(Be){console.log(" Using cached teachers data"),Xe(Be);return}const lr=await n("/.netlify/functions/get-all-teachers");console.log(" Teachers response:",lr);const Ot=lr.teachers||[];Xe(Ot),Zr(ae,Ot,on.admin_teachers),console.log(" Teachers set to state:",Ot)}catch(ae){console.error("Error loading teachers:",ae)}},[n]),qe=k.useCallback(async()=>{try{const ae="admin_subjects_",Be=wn(ae);if(Be){console.log(" Using cached subjects data"),Ct(Be);return}const lr=await n("/.netlify/functions/get-all-subjects");console.log(" Subjects response:",lr);const Ot=lr.subjects||[];Ct(Ot),Zr(ae,Ot,on.admin_subjects),console.log(" Subjects set to state:",Ot)}catch(ae){console.error("Error loading subjects:",ae)}},[n]),yt=k.useCallback(async()=>{try{const ae="admin_academic_years_",Be=wn(ae);if(Be){console.log(" Using cached academic years data"),At(Be);return}const Ot=(await n("/.netlify/functions/get-academic-year")).academic_years||[];At(Ot),Zr(ae,Ot,on.admin_academic_years)}catch(ae){console.error("Error loading academic year:",ae)}},[n]),Vt=k.useCallback(async()=>{try{if(w(!S),!S){const[ae,Be]=await Promise.all([n("/.netlify/functions/get-all-tests"),n("/.netlify/functions/get-test-assignments")]);console.log(" Active tests response:",ae),console.log(" Assignments response:",Be);const lr=ae.tests||[],Xr=(Be.assignments||[]).reduce((Cn,Ln)=>{const wi=`${Ln.test_type}-${Ln.test_id}`;return Cn[wi]||(Cn[wi]=[]),Cn[wi].push(Ln),Cn},{}),Mn=lr.map(Cn=>{const Ln=`${Cn.test_type}-${Cn.test_id}`,wi=Xr[Ln]||[],mm=wi.some(pm=>pm.is_active);return{...Cn,is_active:mm,assignments:wi}});U(Mn),console.log(" All tests with status set to state:",Mn)}}catch(ae){console.error("Error loading tests:",ae),d({type:"error",message:"Failed to load tests"})}},[n,S]),zt=k.useCallback((ae,Be)=>{gr(lr=>({...lr,[ae]:Be}))},[]),G=k.useCallback((ae,Be)=>{mr(lr=>({...lr,[ae]:Be}))},[]),ce=k.useCallback((ae,Be)=>{jt(lr=>({...lr,[ae]:Be}))},[]);k.useCallback(()=>{console.log(" Testing local storage...");try{const ae={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(ae));const Be=JSON.parse(localStorage.getItem("test"));console.log(" Local storage test successful:",Be),d({type:"success",message:"Local storage test successful"})}catch(ae){console.error(" Local storage test failed:",ae),d({type:"error",message:"Local storage test failed"})}},[]),k.useCallback(()=>{console.log(" Clearing local storage...");try{localStorage.clear(),console.log(" Local storage cleared"),d({type:"success",message:"Local storage cleared"})}catch(ae){console.error(" Error clearing local storage:",ae),d({type:"error",message:"Error clearing local storage"})}},[]),k.useCallback(async()=>{console.log(" Checking teacher subjects...");try{const Be=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log(" Teachers data:",Be),d({type:"success",message:`Found ${Be.length} teachers`})}catch(ae){console.error(" Error checking teacher subjects:",ae),d({type:"error",message:"Error checking teacher subjects"})}},[n]);const se=k.useCallback(async ae=>{ae.preventDefault();try{console.log(" Submitting user:",Tt);const Be=await s("/.netlify/functions/add-user",Tt);Be.success?(d({type:"success",message:"User added successfully"}),it(!1),gr({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),ke()):d({type:"error",message:Be.message||"Failed to add user"})}catch(Be){console.error(" Error adding user:",Be),d({type:"error",message:"Error adding user"})}},[Tt,s,ke]),B=k.useCallback(async ae=>{ae.preventDefault();try{console.log(" Submitting teacher:",tr);const Be=await s("/.netlify/functions/add-teacher",tr);Be.success?(d({type:"success",message:"Teacher added successfully"}),xe(!1),mr({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),Qe()):d({type:"error",message:Be.message||"Failed to add teacher"})}catch(Be){console.error(" Error adding teacher:",Be),d({type:"error",message:"Error adding teacher"})}},[tr,s,Qe]),X=k.useCallback(async ae=>{ae.preventDefault();try{console.log(" Submitting subject:",Je);const Be=await s("/.netlify/functions/add-subject",Je);Be.success?(d({type:"success",message:"Subject added successfully"}),Le(!1),jt({subject_id:"",subject:"",description:"",is_active:!0}),qe()):d({type:"error",message:Be.message||"Failed to add subject"})}catch(Be){console.error(" Error adding subject:",Be),d({type:"error",message:"Error adding subject"})}},[Je,s,qe]),H=k.useCallback(ae=>{N(ae),T({name:ae.name||"",surname:ae.surname||"",grade:ae.grade||"",class:ae.class||"",student_id:ae.student_id||"",nickname:ae.nickname||"",password:ae.password||"",is_active:ae.is_active!==void 0?ae.is_active:!0})},[]),he=k.useCallback(async()=>{try{const ae=[];Object.keys(F).forEach(Be=>{Be!=="student_id"&&F[Be]!==E[Be]&&ae.push({fieldName:Be,newValue:F[Be]})});for(const Be of ae)await s("/.netlify/functions/update-user",{userId:E.student_id,fieldName:Be.fieldName,newValue:Be.newValue});d({type:"success",message:"User updated successfully!"}),N(null),T({}),ke()}catch{d({type:"error",message:"Failed to update user"})}},[F,E,s,ke]),Ne=k.useCallback(async ae=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:ae})).success&&(d({type:"success",message:"User deleted successfully!"}),ke())}catch{d({type:"error",message:"Failed to delete user"})}},[s,ke]),M=k.useCallback(ae=>{D(ae),I({teacher_id:ae.teacher_id||"",username:ae.username||"",password:ae.password||"",first_name:ae.first_name||"",last_name:ae.last_name||"",is_active:ae.is_active!==void 0?ae.is_active:!0})},[]),Q=k.useCallback(async()=>{try{const ae=[];Object.keys(R).forEach(Be=>{Be!=="teacher_id"&&R[Be]!==P[Be]&&ae.push({fieldName:Be,newValue:R[Be]})});for(const Be of ae)await s("/.netlify/functions/update-teacher",{teacherId:P.teacher_id,fieldName:Be.fieldName,newValue:Be.newValue});d({type:"success",message:"Teacher updated successfully!"}),D(null),I({}),Qe()}catch{d({type:"error",message:"Failed to update teacher"})}},[R,P,s,Qe]),ie=k.useCallback(async ae=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:ae})).success&&(d({type:"success",message:"Teacher deleted successfully!"}),Qe())}catch{d({type:"error",message:"Failed to delete teacher"})}},[s,Qe]),ue=k.useCallback(ae=>{le(ae),V({subject_id:ae.subject_id||"",subject:ae.subject||""})},[]),Se=k.useCallback(async()=>{try{const ae=[];Object.keys(q).forEach(Be=>{Be!=="subject_id"&&q[Be]!==W[Be]&&ae.push({fieldName:Be,newValue:q[Be]})});for(const Be of ae)await s("/.netlify/functions/update-subject",{subjectId:W.subject_id,fieldName:Be.fieldName,newValue:Be.newValue});d({type:"success",message:"Subject updated successfully!"}),le(null),V({}),qe()}catch{d({type:"error",message:"Failed to update subject"})}},[q,W,s,qe]),Ie=k.useCallback(async ae=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const Be=await s("/.netlify/functions/delete-subject",{subjectId:ae});Be.success?(d({type:"success",message:"Subject deleted successfully!"}),qe()):d({type:"error",message:Be.message||"Failed to delete subject"})}catch{d({type:"error",message:"Failed to delete subject"})}},[s,qe]),Te=k.useCallback((ae,Be)=>{me(lr=>({...lr,[ae]:Be}))},[]),Ve=k.useCallback(async ae=>{if(ae.preventDefault(),!vt.startDate||!vt.endDate||!vt.teacherId){d({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const Be=await s("/.netlify/functions/delete-test-data",vt);Be.success?(d({type:"success",message:`Successfully deleted ${Be.deletedCount} test records!`}),ht(!1),me({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):d({type:"error",message:Be.message||"Failed to delete test data"})}catch{d({type:"error",message:"Failed to delete test data"})}},[vt,s]),et=k.useCallback(async(ae,Be,lr)=>{try{const Ot=await n("/.netlify/functions/get-test-assignments");if(Ot.success&&Ot.assignments){const Xr=Ot.assignments.filter(Mn=>Mn.test_id===parseInt(ae)&&Mn.test_type===Be);if(Xr.length===0){d({type:"error",message:"No assignments found for this test"});return}for(const Mn of Xr){const Cn=await s("/.netlify/functions/remove-assignment",{teacher_id:lr,assignment_id:Mn.assignment_id,test_type:Be,test_id:ae});if(!Cn.success){d({type:"error",message:`Failed to complete test: ${Cn.message}`});return}}d({type:"success",message:"Test marked as complete successfully!"}),await Vt()}else d({type:"error",message:"Failed to get test assignments"})}catch(Ot){console.error("Error completing test:",Ot),d({type:"error",message:"Failed to complete test"})}},[s,n,Vt]),bt=k.useCallback(async(ae,Be,lr)=>{try{const Ot=await n("/.netlify/functions/get-test-assignments");if(Ot.success&&Ot.assignments){const Xr=Ot.assignments.filter(Mn=>Mn.test_id===parseInt(ae)&&Mn.test_type===Be);if(Xr.length===0){d({type:"error",message:"No assignments found for this test"});return}for(const Mn of Xr){const Cn=await s("/.netlify/functions/remove-assignment",{teacher_id:lr,assignment_id:Mn.assignment_id,test_type:Be,test_id:ae,mark_active:!0});if(!Cn.success){d({type:"error",message:`Failed to reactivate test: ${Cn.message}`});return}}d({type:"success",message:"Test marked as active successfully!"}),await Vt()}else d({type:"error",message:"Failed to get test assignments"})}catch(Ot){console.error("Error reactivating test:",Ot),d({type:"error",message:"Failed to reactivate test"})}},[s,n,Vt]),wt=k.useCallback(async()=>{try{if(ge(!ee),!ee){const ae=await n("/.netlify/functions/get-all-tests");console.log(" Actual tests response:",ae),ye(ae.tests||[]),console.log(" Actual tests set to state:",ae.tests||[])}}catch(ae){console.error("Error loading actual tests:",ae),d({type:"error",message:"Failed to load tests"})}},[n,ee]),rr=k.useCallback(async(ae,Be,lr)=>{try{const Ot=await s("/.netlify/functions/delete-test",{test_id:ae,test_type:Be,teacher_id:lr});Ot.success?(d({type:"success",message:"Test deleted successfully!"}),await wt()):d({type:"error",message:`Failed to delete test: ${Ot.message}`})}catch(Ot){console.error("Error deleting test:",Ot),d({type:"error",message:"Failed to delete test"})}},[s,wt]),Yt=y?Pe.filter(ae=>ae.grade.toString()===y):Pe,or=K.filter(ae=>{const Be=!L||ae.teacher_id===L,lr=!ne||new Date(ae.created_at)>=new Date(ne),Ot=!Y||new Date(ae.created_at)<=new Date(Y+"T23:59:59"),Xr=te?ae.is_active:!ae.is_active;return Be&&lr&&Ot&&Xr}),Jt=fe.filter(ae=>{const Be=!Ce||ae.teacher_id===Ce,lr=!ve||new Date(ae.created_at)>=new Date(ve),Ot=!Oe||new Date(ae.created_at)<=new Date(Oe+"T23:59:59");return Be&&lr&&Ot});return c.jsxs(Me.div,{id:"admin-cabinet-main",className:pe.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(Me.div,{className:pe.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:pe.headerContent,children:c.jsxs("div",{className:pe.headerFlex,children:[c.jsxs(Me.div,{className:pe.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Me.div,{className:pe.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:c.jsx("span",{className:"text-white font-semibold text-xl",children:((It=t==null?void 0:t.username)==null?void 0:It.charAt(0))||"A"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:pe.adminText,children:(t==null?void 0:t.username)||"Administrator"}),c.jsx("p",{className:pe.adminSubtext,children:"Administrator Dashboard"})]})]}),c.jsxs(Me.div,{className:pe.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsxs("button",{onClick:_e,className:pe.menuButton,style:{zIndex:1e3},children:[c.jsx("span",{className:"hidden sm:inline",children:"Menu"}),c.jsx(Me.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:Re?180:0},transition:{duration:.2},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),c.jsx(ea,{children:Re&&c.jsx(Me.div,{className:pe.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:c.jsxs("div",{className:"py-2",children:[c.jsx(Me.button,{onClick:Fe,className:pe.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),c.jsx(Me.button,{onClick:()=>{_e(),r()},className:pe.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),a&&c.jsx(dr,{text:"Loading..."}),o&&c.jsx(_o,{type:"error",message:o,onClose:()=>l(null)}),u&&c.jsx(_o,{type:u.type,message:u.message,onClose:()=>d(null)}),$t&&c.jsx("div",{className:pe.modalOverlay,children:c.jsxs("div",{className:pe.modalContent,children:[c.jsx("h2",{className:pe.modalTitle,children:"Change Password"}),c.jsxs("form",{className:"space-y-4",children:[c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{htmlFor:"currentPassword",className:pe.formLabel,children:"Current Password"}),c.jsx("input",{type:"password",id:"currentPassword",className:pe.formInput})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{htmlFor:"newPassword",className:pe.formLabel,children:"New Password"}),c.jsx("input",{type:"password",id:"newPassword",className:pe.formInput})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{htmlFor:"confirmPassword",className:pe.formLabel,children:"Confirm New Password"}),c.jsx("input",{type:"password",id:"confirmPassword",className:pe.formInput})]}),c.jsxs("div",{className:pe.modalActions,children:[c.jsx(Ge,{type:"button",variant:"secondary",onClick:nt,className:"flex-1",children:"Cancel"}),c.jsx(Ge,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),c.jsx(Me.div,{className:pe.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:c.jsxs("div",{className:"space-y-6",children:[c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:c.jsxs(at,{className:pe.cardContainer,children:[c.jsx(at.Header,{className:pe.cardHeader,children:c.jsx(at.Title,{className:pe.cardTitle,children:"User Management"})}),c.jsxs(at.Body,{className:pe.cardBody,children:[c.jsxs("div",{className:pe.buttonGroup,children:[c.jsx(Ge,{variant:"primary",onClick:()=>it(!0),className:pe.buttonPrimary,children:"Add User"}),c.jsx(Ge,{variant:"secondary",onClick:()=>{ke(),m(!h)},className:pe.buttonSecondary,children:h?"Hide Users Table":"Get All Users "})]}),c.jsx(ea,{children:Pt&&c.jsxs(Me.div,{className:pe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),c.jsxs("form",{onSubmit:se,className:"space-y-4",children:[c.jsxs("div",{className:pe.formGrid,children:[c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Grade"}),c.jsx("input",{type:"text",value:Tt.grade,onChange:ae=>zt("grade",ae.target.value),className:pe.formInput,placeholder:"Enter grade"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Class"}),c.jsx("input",{type:"text",value:Tt.class,onChange:ae=>zt("class",ae.target.value),className:pe.formInput,placeholder:"Enter class"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Number"}),c.jsx("input",{type:"text",value:Tt.number,onChange:ae=>zt("number",ae.target.value),className:pe.formInput,placeholder:"Enter number"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Student ID"}),c.jsx("input",{type:"text",value:Tt.student_id,onChange:ae=>zt("student_id",ae.target.value),className:pe.formInput,placeholder:"Enter student ID"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Name"}),c.jsx("input",{type:"text",value:Tt.name,onChange:ae=>zt("name",ae.target.value),className:pe.formInput,placeholder:"Enter name"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Surname"}),c.jsx("input",{type:"text",value:Tt.surname,onChange:ae=>zt("surname",ae.target.value),className:pe.formInput,placeholder:"Enter surname"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Nickname"}),c.jsx("input",{type:"text",value:Tt.nickname,onChange:ae=>zt("nickname",ae.target.value),className:pe.formInput,placeholder:"Enter nickname"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Password"}),c.jsx("input",{type:"password",value:Tt.password,onChange:ae=>zt("password",ae.target.value),className:pe.formInput,placeholder:"Enter password"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"userActive",checked:Tt.is_active,onChange:ae=>zt("is_active",ae.target.checked),className:pe.formCheckbox}),c.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),c.jsxs("div",{className:pe.formActions,children:[c.jsx(Ge,{type:"button",variant:"secondary",onClick:()=>it(!1),className:pe.buttonSecondary,children:"Cancel"}),c.jsx(Ge,{type:"submit",variant:"primary",className:pe.buttonPrimary,children:"Add User"})]})]})]})}),h&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",Yt.length," of ",Pe.length,")"]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),c.jsxs("select",{value:y,onChange:ae=>b(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Grades"}),[...new Set(Pe.map(ae=>ae.grade))].sort().map(ae=>c.jsxs("option",{value:ae,children:["Grade ",ae]},ae))]})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:c.jsxs("table",{className:pe.table,children:[c.jsx("thead",{className:pe.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:pe.tableHeaderCell,children:"Name"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Grade"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Class"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Student ID"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Number"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Nickname"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:pe.tableBody,children:Yt.map((ae,Be)=>c.jsxs("tr",{className:pe.tableRow,children:[c.jsxs("td",{className:pe.tableCell,children:[ae.name," ",ae.surname]}),c.jsx("td",{className:pe.tableCell,children:ae.grade}),c.jsx("td",{className:pe.tableCell,children:ae.class}),c.jsx("td",{className:pe.tableCell,children:ae.student_id}),c.jsx("td",{className:pe.tableCell,children:ae.number}),c.jsx("td",{className:pe.tableCell,children:ae.nickname}),c.jsx("td",{className:pe.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>H(ae),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>Ne(ae.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ae.id||Be))})]})})})]})]})]})}),c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:c.jsxs(at,{className:pe.cardContainer,children:[c.jsx(at.Header,{className:pe.cardHeader,children:c.jsx(at.Title,{className:pe.cardTitle,children:"Teacher Management"})}),c.jsxs(at.Body,{className:pe.cardBody,children:[c.jsxs("div",{className:pe.buttonGroup,children:[c.jsx(Ge,{variant:"primary",onClick:()=>xe(!0),className:pe.buttonPrimary,children:"Add Teacher"}),c.jsx(Ge,{variant:"secondary",onClick:()=>{Qe(),p(!x)},className:pe.buttonSecondary,children:x?"Hide Teachers Table":"Get All Teachers "})]}),c.jsx(ea,{children:rt&&c.jsxs(Me.div,{className:pe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),c.jsxs("form",{onSubmit:B,className:"space-y-4",children:[c.jsxs("div",{className:pe.formGrid,children:[c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Teacher ID"}),c.jsx("input",{type:"text",value:tr.teacher_id,onChange:ae=>G("teacher_id",ae.target.value),className:pe.formInput,placeholder:"Enter teacher ID"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Username"}),c.jsx("input",{type:"text",value:tr.username,onChange:ae=>G("username",ae.target.value),className:pe.formInput,placeholder:"Enter username"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Password"}),c.jsx("input",{type:"password",value:tr.password,onChange:ae=>G("password",ae.target.value),className:pe.formInput,placeholder:"Enter password"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"First Name"}),c.jsx("input",{type:"text",value:tr.first_name,onChange:ae=>G("first_name",ae.target.value),className:pe.formInput,placeholder:"Enter first name"})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Last Name"}),c.jsx("input",{type:"text",value:tr.last_name,onChange:ae=>G("last_name",ae.target.value),className:pe.formInput,placeholder:"Enter last name"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"teacherActive",checked:tr.is_active,onChange:ae=>G("is_active",ae.target.checked),className:pe.formCheckbox}),c.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),c.jsxs("div",{className:pe.formActions,children:[c.jsx(Ge,{type:"button",variant:"secondary",onClick:()=>xe(!1),className:pe.buttonSecondary,children:"Cancel"}),c.jsx(Ge,{type:"submit",variant:"primary",className:pe.buttonPrimary,children:"Add Teacher"})]})]})]})}),E&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),c.jsx("input",{type:"text",value:F.name,onChange:ae=>T({...F,name:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),c.jsx("input",{type:"text",value:F.surname,onChange:ae=>T({...F,surname:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),c.jsx("input",{type:"number",value:F.grade,onChange:ae=>T({...F,grade:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),c.jsx("input",{type:"number",value:F.class,onChange:ae=>T({...F,class:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),c.jsx("input",{type:"text",value:F.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),c.jsx("input",{type:"text",value:F.nickname,onChange:ae=>T({...F,nickname:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),c.jsx("input",{type:"text",value:F.password,onChange:ae=>T({...F,password:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"is_active",checked:F.is_active,onChange:ae=>T({...F,is_active:ae.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),c.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>{N(null),T({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),c.jsx("button",{onClick:he,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),x&&c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",We.length,")"]})}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:pe.table,children:[c.jsx("thead",{className:pe.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:pe.tableHeaderCell,children:"Teacher ID"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Name"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Username"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Password"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Status"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Created"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:pe.tableBody,children:We.map((ae,Be)=>c.jsxs("tr",{className:pe.tableRow,children:[c.jsx("td",{className:pe.tableCell,children:ae.teacher_id}),c.jsxs("td",{className:pe.tableCell,children:[ae.first_name," ",ae.last_name]}),c.jsx("td",{className:pe.tableCell,children:ae.username}),c.jsx("td",{className:pe.tableCell,children:ae.password}),c.jsx("td",{className:pe.tableCell,children:c.jsx("span",{className:ae.is_active?pe.statusActive:pe.statusInactive,children:ae.is_active?"Active":"Inactive"})}),c.jsx("td",{className:pe.tableCell,children:new Date(ae.created_at).toLocaleDateString()}),c.jsx("td",{className:pe.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>M(ae),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>ie(ae.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ae.teacher_id||Be))})]})})})]})]})]})}),c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:c.jsxs(at,{className:pe.cardContainer,children:[c.jsx(at.Header,{className:pe.cardHeader,children:c.jsx(at.Title,{className:pe.cardTitle,children:"Subject Management"})}),c.jsxs(at.Body,{className:pe.cardBody,children:[c.jsxs("div",{className:pe.buttonGroup,children:[c.jsx(Ge,{variant:"primary",onClick:()=>Le(!0),className:pe.buttonPrimary,children:"Add Subject"}),c.jsx(Ge,{variant:"secondary",onClick:()=>{qe(),_(!v)},className:pe.buttonSecondary,children:v?"Hide Subjects Table":"Get All Subjects "})]}),c.jsx(ea,{children:De&&c.jsxs(Me.div,{className:pe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),c.jsxs("form",{onSubmit:X,className:"space-y-4",children:[c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Subject Name"}),c.jsx("input",{type:"text",value:Je.subject,onChange:ae=>ce("subject",ae.target.value),className:pe.formInput,placeholder:"Enter subject name",required:!0}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),c.jsxs("div",{className:pe.formActions,children:[c.jsx(Ge,{type:"button",variant:"secondary",onClick:()=>Le(!1),className:pe.buttonSecondary,children:"Cancel"}),c.jsx(Ge,{type:"submit",variant:"primary",className:pe.buttonPrimary,children:"Add Subject"})]})]})]})}),P&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),c.jsx("input",{type:"text",value:R.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),c.jsx("input",{type:"text",value:R.username,onChange:ae=>I({...R,username:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),c.jsx("input",{type:"text",value:R.password,onChange:ae=>I({...R,password:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),c.jsx("input",{type:"text",value:R.first_name,onChange:ae=>I({...R,first_name:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),c.jsx("input",{type:"text",value:R.last_name,onChange:ae=>I({...R,last_name:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:R.is_active,onChange:ae=>I({...R,is_active:ae.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),c.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>{D(null),I({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),c.jsx("button",{onClick:Q,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),W&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),c.jsx("input",{type:"text",value:q.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),c.jsx("input",{type:"text",value:q.subject,onChange:ae=>V({...q,subject:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>le(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),c.jsx("button",{onClick:Se,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),v&&c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",ut.length,")"]})}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:pe.table,children:[c.jsx("thead",{className:pe.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:pe.tableHeaderCell,children:"Subject ID"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Subject Name"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:pe.tableBody,children:ut.map((ae,Be)=>c.jsxs("tr",{className:pe.tableRow,children:[c.jsx("td",{className:pe.tableCell,children:ae.subject_id}),c.jsx("td",{className:pe.tableCell,children:ae.subject}),c.jsx("td",{className:pe.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>ue(ae),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>Ie(ae.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ae.subject_id||Be))})]})})})]})]})]})}),c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:c.jsxs(at,{className:pe.cardContainer,children:[c.jsx(at.Header,{className:pe.cardHeader,children:c.jsx(at.Title,{className:pe.cardTitle,children:"Test Data Deletion"})}),c.jsxs(at.Body,{className:pe.cardBody,children:[c.jsx("div",{className:pe.buttonGroup,children:c.jsx(Ge,{variant:"danger",onClick:()=>ht(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),c.jsx(ea,{children:pt&&c.jsxs(Me.div,{className:pe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),c.jsxs("form",{onSubmit:Ve,className:"space-y-4",children:[c.jsxs("div",{className:pe.formGrid,children:[c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Start Date *"}),c.jsx("input",{type:"date",value:vt.startDate,onChange:ae=>Te("startDate",ae.target.value),className:pe.formInput,required:!0})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"End Date *"}),c.jsx("input",{type:"date",value:vt.endDate,onChange:ae=>Te("endDate",ae.target.value),className:pe.formInput,required:!0})]})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Teacher ID *"}),c.jsxs("select",{value:vt.teacherId,onChange:ae=>Te("teacherId",ae.target.value),className:pe.formInput,required:!0,children:[c.jsx("option",{value:"",children:"Select a teacher"}),We.map(ae=>c.jsxs("option",{value:ae.teacher_id,children:[ae.teacher_id," - ",ae.first_name," ",ae.last_name]},ae.teacher_id))]})]}),c.jsxs("div",{className:pe.formGroup,children:[c.jsx("label",{className:pe.formLabel,children:"Subject (Optional)"}),c.jsxs("select",{value:vt.subjectId,onChange:ae=>Te("subjectId",ae.target.value),className:pe.formInput,children:[c.jsx("option",{value:"",children:"All subjects"}),ut.map(ae=>c.jsx("option",{value:ae.subject_id,children:ae.subject},ae.subject_id))]})]}),c.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),c.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[c.jsx("p",{children:"This will permanently delete:"}),c.jsxs("ul",{className:"list-disc list-inside mt-1",children:[c.jsx("li",{children:"All test records within the date range"}),c.jsx("li",{children:"All test questions and answers"}),c.jsx("li",{children:"All test results and submissions"}),c.jsx("li",{children:"All test assignments"}),c.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),c.jsxs("div",{className:pe.formActions,children:[c.jsx(Ge,{type:"button",variant:"secondary",onClick:()=>ht(!1),className:pe.buttonSecondary,children:"Cancel"}),c.jsx(Ge,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:c.jsxs(at,{className:pe.cardContainer,children:[c.jsx(at.Header,{className:pe.cardHeader,children:c.jsx(at.Title,{className:pe.cardTitle,children:"Assignments Management"})}),c.jsxs(at.Body,{className:pe.cardBody,children:[c.jsx("div",{className:"mb-4",children:c.jsx(Ge,{variant:"primary",onClick:Vt,className:pe.buttonPrimary,children:S?"Hide Assignments Table":"Get All Assignments "})}),S&&c.jsx("div",{className:"mb-6",children:c.jsx("div",{className:"border-b border-gray-200",children:c.jsxs("nav",{className:"-mb-px flex space-x-8",children:[c.jsx("button",{onClick:()=>de(!0),className:`py-2 px-1 border-b-2 font-medium text-sm ${te?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Active Assignments"}),c.jsx("button",{onClick:()=>de(!1),className:`py-2 px-1 border-b-2 font-medium text-sm ${te?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-purple-500 text-purple-600"}`,children:"Inactive Assignments"})]})})}),S&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:[te?"Active":"Inactive"," Assignments (",or.length," of ",K.filter(ae=>te?ae.is_active:!ae.is_active).length,")"]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:L,onChange:ae=>Z(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Teachers"}),We.map(ae=>c.jsxs("option",{value:ae.teacher_id,children:[ae.first_name," ",ae.last_name]},ae.teacher_id))]}),c.jsx("input",{type:"date",value:ne,onChange:ae=>z(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),c.jsx("input",{type:"date",value:Y,onChange:ae=>J(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:pe.table,children:[c.jsx("thead",{className:pe.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:pe.tableHeaderCell,children:"Test Name"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Type"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Teacher"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Questions"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Created"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:pe.tableBody,children:or.map((ae,Be)=>c.jsxs("tr",{className:pe.tableRow,children:[c.jsx("td",{className:pe.tableCell,children:ae.test_name}),c.jsx("td",{className:pe.tableCell,children:c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:ae.test_type.replace("_"," ").toUpperCase()})}),c.jsx("td",{className:pe.tableCell,children:ae.teacher_name}),c.jsx("td",{className:pe.tableCell,children:ae.num_questions}),c.jsx("td",{className:pe.tableCell,children:new Date(ae.created_at).toLocaleDateString()}),c.jsx("td",{className:pe.tableCell,children:c.jsx("div",{className:"flex space-x-2",children:te?c.jsx("button",{onClick:()=>et(ae.test_id,ae.test_type,ae.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):c.jsx("button",{onClick:()=>bt(ae.test_id,ae.test_type,ae.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",children:"Mark Active"})})})]},`${ae.test_type}-${ae.test_id}-${Be}`))})]})})})]})]})]})}),c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:c.jsxs(at,{className:pe.cardContainer,children:[c.jsx(at.Header,{className:pe.cardHeader,children:c.jsx(at.Title,{className:pe.cardTitle,children:"Test Management"})}),c.jsxs(at.Body,{className:pe.cardBody,children:[c.jsx("div",{className:"mb-4",children:c.jsx(Ge,{variant:"primary",onClick:wt,className:pe.buttonPrimary,children:ee?"Hide Tests Table":"Get All Tests "})}),ee&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",Jt.length," of ",fe.length,")"]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:Ce,onChange:ae=>re(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Teachers"}),We.map(ae=>c.jsxs("option",{value:ae.teacher_id,children:[ae.first_name," ",ae.last_name]},ae.teacher_id))]}),c.jsx("input",{type:"date",value:ve,onChange:ae=>we(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),c.jsx("input",{type:"date",value:Oe,onChange:ae=>Ze(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:pe.table,children:[c.jsx("thead",{className:pe.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:pe.tableHeaderCell,children:"Test Name"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Type"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Teacher"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Questions"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Created"}),c.jsx("th",{className:pe.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:pe.tableBody,children:Jt.map((ae,Be)=>c.jsxs("tr",{className:pe.tableRow,children:[c.jsx("td",{className:pe.tableCell,children:ae.test_name}),c.jsx("td",{className:pe.tableCell,children:c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:ae.test_type.replace("_"," ").toUpperCase()})}),c.jsx("td",{className:pe.tableCell,children:ae.teacher_name}),c.jsx("td",{className:pe.tableCell,children:ae.num_questions}),c.jsx("td",{className:pe.tableCell,children:new Date(ae.created_at).toLocaleDateString()}),c.jsx("td",{className:pe.tableCell,children:c.jsx("div",{className:"flex space-x-2",children:c.jsx("button",{onClick:()=>rr(ae.test_id,ae.test_type,ae.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete Test"})})})]},`${ae.test_type}-${ae.test_id}-${Be}`))})]})})})]})]})]})}),c.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:c.jsxs(at,{className:pe.cardContainer,children:[c.jsx(at.Header,{className:pe.cardHeader,children:c.jsx(at.Title,{className:pe.cardTitle,children:"Debug & Testing"})}),c.jsx(at.Body,{className:pe.cardBody})]})})]})})]})},A0e=()=>{const{isAdmin:t,getCurrentAdminId:e,logout:r}=Dn(),{get:n}=fl(),{showNotification:s}=ka();k.useEffect(()=>{a()},[]);const a=k.useCallback(async()=>{if(console.log(" Initializing Admin Application..."),!t()){console.error(" User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await o(),l(),u(),console.log(" Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(d){console.error(" Error initializing admin app:",d),s("Failed to initialize admin dashboard","error")}},[t,e,r,s,n]),i=k.useCallback(()=>{console.log(" Initializing global event listeners...");const d=h=>{h.ctrlKey&&h.key==="k"&&(h.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[]),o=k.useCallback(async()=>{var d,h,m,x,p,v,_,S;try{console.log(" Loading admin data...");const[w,y,b,E]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),n("/.netlify/functions/get-academic-year")]);w.status==="fulfilled"&&((d=w.value)!=null&&d.success)&&console.log(" Users loaded:",((h=w.value.users)==null?void 0:h.length)||0),y.status==="fulfilled"&&((m=y.value)!=null&&m.success)&&console.log(" Teachers loaded:",((x=y.value.teachers)==null?void 0:x.length)||0),b.status==="fulfilled"&&((p=b.value)!=null&&p.success)&&console.log(" Subjects loaded:",((v=b.value.subjects)==null?void 0:v.length)||0),E.status==="fulfilled"&&((_=E.value)!=null&&_.success)&&console.log(" Academic years loaded:",((S=E.value.academic_years)==null?void 0:S.length)||0),console.log(" Admin data loading completed")}catch(w){throw console.error(" Error loading admin data:",w),w}},[n]),l=k.useCallback(()=>{console.log(" Initializing test deletion functionality..."),console.log(" Test deletion functionality initialized")},[]),u=k.useCallback(()=>{console.log(" Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const h=document.getElementById("allSubjectsContainer"),m=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!h){console.error(" allSubjectsContainer not found");return}if(!m){console.error(" Button not found");return}const x=h.style.display!=="none";h.style.display=x?"none":"block",m.textContent=x?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const h=document.getElementById("addSubjectForm");h&&(h.style.display="block")},window.hideAddSubjectForm=()=>{const h=document.getElementById("addSubjectForm"),m=document.getElementById("newSubjectForm");h&&(h.style.display="none"),m&&m.reset()},window.showAddAcademicYearForm=()=>{const h=document.getElementById("addAcademicYearForm");h&&(h.style.display="block")},window.hideAddAcademicYearForm=()=>{const h=document.getElementById("addAcademicYearForm"),m=document.getElementById("newAcademicYearForm");h&&(h.style.display="none"),m&&m.reset()},window.toggleUsersContent=()=>{const h=document.getElementById("allUsersContainer"),m=document.querySelector('button[onclick="toggleUsersContent()"]');if(!h){console.error(" allUsersContainer not found");return}if(!m){console.error(" Button not found");return}const x=h.style.display!=="none";h.style.display=x?"none":"block",m.textContent=x?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const h=document.getElementById("addUserForm");h&&(h.style.display="block")},window.hideAddUserForm=()=>{const h=document.getElementById("addUserForm"),m=document.getElementById("newUserForm");h&&(h.style.display="none"),m&&m.reset()},window.showAddTeacherForm=()=>{const h=document.getElementById("addTeacherForm");h&&(h.style.display="block")},window.hideAddTeacherForm=()=>{const h=document.getElementById("addTeacherForm"),m=document.getElementById("newTeacherForm");h&&(h.style.display="none"),m&&m.reset()},window.toggleTeachersContent=()=>{const h=document.getElementById("allTeachersContainer"),m=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!h){console.error(" allTeachersContainer not found");return}if(!m){console.error(" Button not found");return}const x=h.style.display!=="none";h.style.display=x?"none":"block",m.textContent=x?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const h=document.getElementById("allTestsContainer"),m=document.querySelector('button[onclick="toggleTestsContent()"]');if(!h){console.error(" allTestsContainer not found");return}if(!m){console.error(" Button not found");return}const x=h.style.display!=="none";h.style.display=x?"none":"block",m.textContent=x?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const h=document.getElementById("allAssignmentsContainer"),m=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!h){console.error(" allAssignmentsContainer not found");return}if(!m){console.error(" Button not found");return}const x=h.style.display!=="none";h.style.display=x?"none":"block",m.textContent=x?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const h=document.getElementById("allResultsContainer"),m=document.querySelector('button[onclick="toggleResultsContent()"]');if(!h){console.error(" allResultsContainer not found");return}if(!m){console.error(" Button not found");return}const x=h.style.display!=="none";h.style.display=x?"none":"block",m.textContent=x?"Show Results":"Hide Results"};const d={};window.toggleSection=h=>{console.log(` toggleSection called with sectionId: ${h}`);const m=Date.now();if(d[h]&&m-d[h]<300){console.log(` Ignoring rapid successive call for ${h}`);return}d[h]=m;const x=document.getElementById(h);if(!x){console.error(` Section with id '${h}' not found!`);return}const p=x.style.display!=="none";x.style.display=p?"none":"block";const v=document.querySelector(`button[onclick="toggleSection('${h}')"]`);v&&(v.textContent=p?"Show":"Hide")},window.addClickListeners=()=>{console.log(" Adding click listeners to section headers...");const h=document.querySelectorAll(".section-header");console.log(` Found ${h.length} section headers`),h.forEach((m,x)=>{const p=m.textContent.trim();if(console.log(` Processing header ${x+1}:`,p),m.dataset.listenerAdded==="true"){console.log(` Skipping header ${p} - listener already added`);return}m.addEventListener("click",()=>{const v=m.dataset.sectionId;v&&window.toggleSection(v)}),m.dataset.listenerAdded="true",console.log(` Added click listener to header: ${p}`)})},window.makeFieldEditable=h=>{const m=h.textContent;h.dataset.field;const x=document.createElement("input");x.type="text",x.value=m,x.className="editable-input";const p=document.createElement("button");p.textContent="Save",p.className="btn-save",p.onclick=()=>window.saveField(h,x,p,v);const v=document.createElement("button");v.textContent="Cancel",v.className="btn-cancel",v.onclick=()=>{h.textContent=m,h.style.display="block",x.remove(),p.remove(),v.remove()},h.style.display="none",h.parentNode.insertBefore(x,h),h.parentNode.insertBefore(p,h),h.parentNode.insertBefore(v,h)},window.saveField=(h,m,x,p)=>{const v=m.value.trim(),_=h.dataset.field,S=h.dataset.recordId;if(!v){alert("Field cannot be empty");return}console.log(`Saving field ${_} for record ${S} with value: ${v}`),h.textContent=v,h.style.display="block",m.remove(),x.remove(),p.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const h=localStorage.getItem("test");return localStorage.removeItem("test"),console.log(" localStorage is working"),!0}catch(h){return console.error(" localStorage error:",h),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log(" localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const h={};for(let v=0;v<localStorage.length;v++){const _=localStorage.key(v);h[_]=localStorage.getItem(_)}const m=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),x=URL.createObjectURL(m),p=document.createElement("a");p.href=x,p.download="localStorage-backup.json",p.click(),URL.revokeObjectURL(x)},console.log(" Admin functions exposed globally")},[]);return t()?c.jsx(N0e,{}):c.jsxs("div",{className:"admin-error",children:[c.jsx("h2",{children:"Access Denied"}),c.jsx("p",{children:"You don't have permission to access the admin dashboard."}),c.jsx("button",{onClick:r,children:"Return to Login"})]})},y_=({children:t,allowedRoles:e})=>{const{isAuthenticated:r,role:n,isLoading:s}=Dn();return s?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?e&&!e.includes(n)?c.jsx(Ef,{to:"/unauthorized",replace:!0}):t:c.jsx(Ef,{to:"/login",replace:!0})},F0e=()=>c.jsxs("div",{className:"unauthorized-page",children:[c.jsx("h1",{children:"Access Denied"}),c.jsx("p",{children:"You don't have permission to access this page."})]}),j0e=()=>c.jsx(O9,{children:c.jsx(I9,{children:c.jsx(U9,{children:c.jsx(P$,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:c.jsx("div",{className:"app",children:c.jsxs(Lk,{children:[c.jsx(Fn,{path:"/login",element:c.jsx(Xte,{})}),c.jsx(Fn,{path:"/unauthorized",element:c.jsx(F0e,{})}),c.jsx(Fn,{path:"/student/*",element:c.jsx(y_,{allowedRoles:["student"],children:c.jsx(Sre,{})})}),c.jsx(Fn,{path:"/teacher/*",element:c.jsx(y_,{allowedRoles:["teacher"],children:c.jsx(E0e,{})})}),c.jsx(Fn,{path:"/admin/*",element:c.jsx(y_,{allowedRoles:["admin"],children:c.jsx(A0e,{})})}),c.jsx(Fn,{path:"/",element:c.jsx(Ef,{to:"/login",replace:!0})}),c.jsx(Fn,{path:"*",element:c.jsx(Ef,{to:"/login",replace:!0})})]})})})})})});class P0e{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const e=localStorage.getItem(this.userKey);return e?JSON.parse(e):null}setToken(e){localStorage.setItem(this.tokenKey,e)}setRefreshToken(e){localStorage.setItem(this.refreshTokenKey,e)}setUserData(e){localStorage.setItem(this.userKey,JSON.stringify(e))}setTokens(e,r){this.setToken(e),this.setUserData({role:r}),localStorage.setItem("accessToken",e)}isAuthenticated(){const e=this.getToken();if(!e)return!1;try{const r=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const e=this.getUserData();return e?e.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const e=this.getToken();return e?`Bearer ${e}`:null}async makeAuthenticatedRequest(e,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(e,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(e,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const e=this.getRefreshToken();if(!e)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(r.ok){const n=await r.json();return this.setToken(n.token),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},50*60*1e3)}}const Ub=new P0e;window.tokenManager=Ub;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{Ub.init()}):Ub.init());class _L{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const e=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",e),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),e?(this.currentRole=e,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let e=!1;try{const r=window.tokenManager.getAccessToken();r&&(e=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),e=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${e?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(e,r){console.log(`Function ${e} already available in main script for ${r}`),this.loadedFunctions.add(e)}setupRoleBasedUI(){let e=!1;try{const r=window.tokenManager.getAccessToken();r&&(e=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),e=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!e&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(e){const r=`Access denied. This function requires ${e} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(e){return this.blockedFunctions.has(e)}isFunctionLoaded(e){return this.loadedFunctions.has(e)}getCurrentRole(){return this.currentRole}hasRole(e){return this.currentRole===e}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const e=window.tokenManager.getUserRole();return e?(console.log("[DEBUG] Setting role after login:",e),this.currentRole=e,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",e),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new _L;typeof Cx<"u"&&Cx.exports&&(Cx.exports=_L);const D0e=()=>{console.log("[DEBUG] Initializing application with new structure");const t={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(t)),console.log("[DEBUG] Application initialized with enhanced features")},R0e=()=>{console.log("[DEBUG] Starting main application"),D0e(),v_.createRoot(document.getElementById("root")).render(c.jsx(ls.StrictMode,{children:c.jsx(j0e,{})}))};R0e()});export default O0e();
