var ZV=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var z3e=ZV((_Ae,h_)=>{function _M(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var g_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ml(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var SS={exports:{}},nx={},kS={exports:{}},nn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $j;function eK(){if($j)return nn;$j=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;function g(W){return W===null||typeof W!="object"?null:(W=f&&W[f]||W["@@iterator"],typeof W=="function"?W:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,v={};function w(W,R,z){this.props=W,this.context=R,this.refs=v,this.updater=z||p}w.prototype.isReactComponent={},w.prototype.setState=function(W,R){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,R,"setState")},w.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function C(){}C.prototype=w.prototype;function k(W,R,z){this.props=W,this.context=R,this.refs=v,this.updater=z||p}var _=k.prototype=new C;_.constructor=k,x(_,w.prototype),_.isPureReactComponent=!0;var N=Array.isArray,E=Object.prototype.hasOwnProperty,P={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function A(W,R,z){var K,Q={},ae=null,X=null;if(R!=null)for(K in R.ref!==void 0&&(X=R.ref),R.key!==void 0&&(ae=""+R.key),R)E.call(R,K)&&!F.hasOwnProperty(K)&&(Q[K]=R[K]);var ie=arguments.length-2;if(ie===1)Q.children=z;else if(1<ie){for(var le=Array(ie),ce=0;ce<ie;ce++)le[ce]=arguments[ce+2];Q.children=le}if(W&&W.defaultProps)for(K in ie=W.defaultProps,ie)Q[K]===void 0&&(Q[K]=ie[K]);return{$$typeof:e,type:W,key:ae,ref:X,props:Q,_owner:P.current}}function j(W,R){return{$$typeof:e,type:W.type,key:R,ref:W.ref,props:W.props,_owner:W._owner}}function I(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function B(W){var R={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(z){return R[z]})}var Y=/\/+/g;function Z(W,R){return typeof W=="object"&&W!==null&&W.key!=null?B(""+W.key):R.toString(36)}function se(W,R,z,K,Q){var ae=typeof W;(ae==="undefined"||ae==="boolean")&&(W=null);var X=!1;if(W===null)X=!0;else switch(ae){case"string":case"number":X=!0;break;case"object":switch(W.$$typeof){case e:case t:X=!0}}if(X)return X=W,Q=Q(X),W=K===""?"."+Z(X,0):K,N(Q)?(z="",W!=null&&(z=W.replace(Y,"$&/")+"/"),se(Q,R,z,"",function(ce){return ce})):Q!=null&&(I(Q)&&(Q=j(Q,z+(!Q.key||X&&X.key===Q.key?"":(""+Q.key).replace(Y,"$&/")+"/")+W)),R.push(Q)),1;if(X=0,K=K===""?".":K+":",N(W))for(var ie=0;ie<W.length;ie++){ae=W[ie];var le=K+Z(ae,ie);X+=se(ae,R,z,le,Q)}else if(le=g(W),typeof le=="function")for(W=le.call(W),ie=0;!(ae=W.next()).done;)ae=ae.value,le=K+Z(ae,ie++),X+=se(ae,R,z,le,Q);else if(ae==="object")throw R=String(W),Error("Objects are not valid as a React child (found: "+(R==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":R)+"). If you meant to render a collection of children, use an array instead.");return X}function ee(W,R,z){if(W==null)return W;var K=[],Q=0;return se(W,K,"","",function(ae){return R.call(z,ae,Q++)}),K}function te(W){if(W._status===-1){var R=W._result;R=R(),R.then(function(z){(W._status===0||W._status===-1)&&(W._status=1,W._result=z)},function(z){(W._status===0||W._status===-1)&&(W._status=2,W._result=z)}),W._status===-1&&(W._status=0,W._result=R)}if(W._status===1)return W._result.default;throw W._result}var L={current:null},V={transition:null},M={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:V,ReactCurrentOwner:P};function H(){throw Error("act(...) is not supported in production builds of React.")}return nn.Children={map:ee,forEach:function(W,R,z){ee(W,function(){R.apply(this,arguments)},z)},count:function(W){var R=0;return ee(W,function(){R++}),R},toArray:function(W){return ee(W,function(R){return R})||[]},only:function(W){if(!I(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},nn.Component=w,nn.Fragment=r,nn.Profiler=s,nn.PureComponent=k,nn.StrictMode=n,nn.Suspense=c,nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,nn.act=H,nn.cloneElement=function(W,R,z){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var K=x({},W.props),Q=W.key,ae=W.ref,X=W._owner;if(R!=null){if(R.ref!==void 0&&(ae=R.ref,X=P.current),R.key!==void 0&&(Q=""+R.key),W.type&&W.type.defaultProps)var ie=W.type.defaultProps;for(le in R)E.call(R,le)&&!F.hasOwnProperty(le)&&(K[le]=R[le]===void 0&&ie!==void 0?ie[le]:R[le])}var le=arguments.length-2;if(le===1)K.children=z;else if(1<le){ie=Array(le);for(var ce=0;ce<le;ce++)ie[ce]=arguments[ce+2];K.children=ie}return{$$typeof:e,type:W.type,key:Q,ref:ae,props:K,_owner:X}},nn.createContext=function(W){return W={$$typeof:i,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:a,_context:W},W.Consumer=W},nn.createElement=A,nn.createFactory=function(W){var R=A.bind(null,W);return R.type=W,R},nn.createRef=function(){return{current:null}},nn.forwardRef=function(W){return{$$typeof:o,render:W}},nn.isValidElement=I,nn.lazy=function(W){return{$$typeof:d,_payload:{_status:-1,_result:W},_init:te}},nn.memo=function(W,R){return{$$typeof:u,type:W,compare:R===void 0?null:R}},nn.startTransition=function(W){var R=V.transition;V.transition={};try{W()}finally{V.transition=R}},nn.unstable_act=H,nn.useCallback=function(W,R){return L.current.useCallback(W,R)},nn.useContext=function(W){return L.current.useContext(W)},nn.useDebugValue=function(){},nn.useDeferredValue=function(W){return L.current.useDeferredValue(W)},nn.useEffect=function(W,R){return L.current.useEffect(W,R)},nn.useId=function(){return L.current.useId()},nn.useImperativeHandle=function(W,R,z){return L.current.useImperativeHandle(W,R,z)},nn.useInsertionEffect=function(W,R){return L.current.useInsertionEffect(W,R)},nn.useLayoutEffect=function(W,R){return L.current.useLayoutEffect(W,R)},nn.useMemo=function(W,R){return L.current.useMemo(W,R)},nn.useReducer=function(W,R,z){return L.current.useReducer(W,R,z)},nn.useRef=function(W){return L.current.useRef(W)},nn.useState=function(W){return L.current.useState(W)},nn.useSyncExternalStore=function(W,R,z){return L.current.useSyncExternalStore(W,R,z)},nn.useTransition=function(){return L.current.useTransition()},nn.version="18.3.1",nn}var Uj;function E0(){return Uj||(Uj=1,kS.exports=eK()),kS.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zj;function tK(){if(zj)return nx;zj=1;var e=E0(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(o,c,u){var d,f={},g=null,p=null;u!==void 0&&(g=""+u),c.key!==void 0&&(g=""+c.key),c.ref!==void 0&&(p=c.ref);for(d in c)n.call(c,d)&&!a.hasOwnProperty(d)&&(f[d]=c[d]);if(o&&o.defaultProps)for(d in c=o.defaultProps,c)f[d]===void 0&&(f[d]=c[d]);return{$$typeof:t,type:o,key:g,ref:p,props:f,_owner:s.current}}return nx.Fragment=r,nx.jsx=i,nx.jsxs=i,nx}var Wj;function rK(){return Wj||(Wj=1,SS.exports=tK()),SS.exports}var l=rK(),S=E0();const Is=Ml(S),bM=_M({__proto__:null,default:Is},[S]);var dw={},CS={exports:{}},wo={},TS={exports:{}},ES={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hj;function nK(){return Hj||(Hj=1,(function(e){function t(V,M){var H=V.length;V.push(M);e:for(;0<H;){var W=H-1>>>1,R=V[W];if(0<s(R,M))V[W]=M,V[H]=R,H=W;else break e}}function r(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var M=V[0],H=V.pop();if(H!==M){V[0]=H;e:for(var W=0,R=V.length,z=R>>>1;W<z;){var K=2*(W+1)-1,Q=V[K],ae=K+1,X=V[ae];if(0>s(Q,H))ae<R&&0>s(X,Q)?(V[W]=X,V[ae]=H,W=ae):(V[W]=Q,V[K]=H,W=K);else if(ae<R&&0>s(X,H))V[W]=X,V[ae]=H,W=ae;else break e}}return M}function s(V,M){var H=V.sortIndex-M.sortIndex;return H!==0?H:V.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,f=null,g=3,p=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(V){for(var M=r(u);M!==null;){if(M.callback===null)n(u);else if(M.startTime<=V)n(u),M.sortIndex=M.expirationTime,t(c,M);else break;M=r(u)}}function N(V){if(v=!1,_(V),!x)if(r(c)!==null)x=!0,te(E);else{var M=r(u);M!==null&&L(N,M.startTime-V)}}function E(V,M){x=!1,v&&(v=!1,C(A),A=-1),p=!0;var H=g;try{for(_(M),f=r(c);f!==null&&(!(f.expirationTime>M)||V&&!B());){var W=f.callback;if(typeof W=="function"){f.callback=null,g=f.priorityLevel;var R=W(f.expirationTime<=M);M=e.unstable_now(),typeof R=="function"?f.callback=R:f===r(c)&&n(c),_(M)}else n(c);f=r(c)}if(f!==null)var z=!0;else{var K=r(u);K!==null&&L(N,K.startTime-M),z=!1}return z}finally{f=null,g=H,p=!1}}var P=!1,F=null,A=-1,j=5,I=-1;function B(){return!(e.unstable_now()-I<j)}function Y(){if(F!==null){var V=e.unstable_now();I=V;var M=!0;try{M=F(!0,V)}finally{M?Z():(P=!1,F=null)}}else P=!1}var Z;if(typeof k=="function")Z=function(){k(Y)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,ee=se.port2;se.port1.onmessage=Y,Z=function(){ee.postMessage(null)}}else Z=function(){w(Y,0)};function te(V){F=V,P||(P=!0,Z())}function L(V,M){A=w(function(){V(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,te(E))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(V){switch(g){case 1:case 2:case 3:var M=3;break;default:M=g}var H=g;g=M;try{return V()}finally{g=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,M){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var H=g;g=V;try{return M()}finally{g=H}},e.unstable_scheduleCallback=function(V,M,H){var W=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?W+H:W):H=W,V){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=H+R,V={id:d++,callback:M,priorityLevel:V,startTime:H,expirationTime:R,sortIndex:-1},H>W?(V.sortIndex=H,t(u,V),r(c)===null&&V===r(u)&&(v?(C(A),A=-1):v=!0,L(N,H-W))):(V.sortIndex=R,t(c,V),x||p||(x=!0,te(E))),V},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(V){var M=g;return function(){var H=g;g=M;try{return V.apply(this,arguments)}finally{g=H}}}})(ES)),ES}var Gj;function pN(){return Gj||(Gj=1,TS.exports=nK()),TS.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vj;function sK(){if(Vj)return wo;Vj=1;var e=E0(),t=pN();function r(h){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+h,T=1;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(h,m){i(h,m),i(h+"Capture",m)}function i(h,m){for(s[h]=m,h=0;h<m.length;h++)n.add(m[h])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function g(h){return c.call(f,h)?!0:c.call(d,h)?!1:u.test(h)?f[h]=!0:(d[h]=!0,!1)}function p(h,m,T,D){if(T!==null&&T.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return D?!1:T!==null?!T.acceptsBooleans:(h=h.toLowerCase().slice(0,5),h!=="data-"&&h!=="aria-");default:return!1}}function x(h,m,T,D){if(m===null||typeof m>"u"||p(h,m,T,D))return!0;if(D)return!1;if(T!==null)switch(T.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function v(h,m,T,D,G,J,de){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=D,this.attributeNamespace=G,this.mustUseProperty=T,this.propertyName=h,this.type=m,this.sanitizeURL=J,this.removeEmptyString=de}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(h){w[h]=new v(h,0,!1,h,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(h){var m=h[0];w[m]=new v(m,1,!1,h[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(h){w[h]=new v(h,2,!1,h.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(h){w[h]=new v(h,2,!1,h,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(h){w[h]=new v(h,3,!1,h.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(h){w[h]=new v(h,3,!0,h,null,!1,!1)}),["capture","download"].forEach(function(h){w[h]=new v(h,4,!1,h,null,!1,!1)}),["cols","rows","size","span"].forEach(function(h){w[h]=new v(h,6,!1,h,null,!1,!1)}),["rowSpan","start"].forEach(function(h){w[h]=new v(h,5,!1,h.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function k(h){return h[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(h){var m=h.replace(C,k);w[m]=new v(m,1,!1,h,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(h){var m=h.replace(C,k);w[m]=new v(m,1,!1,h,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(h){var m=h.replace(C,k);w[m]=new v(m,1,!1,h,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(h){w[h]=new v(h,1,!1,h.toLowerCase(),null,!1,!1)}),w.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(h){w[h]=new v(h,1,!1,h.toLowerCase(),null,!0,!0)});function _(h,m,T,D){var G=w.hasOwnProperty(m)?w[m]:null;(G!==null?G.type!==0:D||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(x(m,T,G,D)&&(T=null),D||G===null?g(m)&&(T===null?h.removeAttribute(m):h.setAttribute(m,""+T)):G.mustUseProperty?h[G.propertyName]=T===null?G.type===3?!1:"":T:(m=G.attributeName,D=G.attributeNamespace,T===null?h.removeAttribute(m):(G=G.type,T=G===3||G===4&&T===!0?"":""+T,D?h.setAttributeNS(D,m,T):h.setAttribute(m,T))))}var N=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),P=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),B=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),te=Symbol.for("react.lazy"),L=Symbol.for("react.offscreen"),V=Symbol.iterator;function M(h){return h===null||typeof h!="object"?null:(h=V&&h[V]||h["@@iterator"],typeof h=="function"?h:null)}var H=Object.assign,W;function R(h){if(W===void 0)try{throw Error()}catch(T){var m=T.stack.trim().match(/\n( *(at )?)/);W=m&&m[1]||""}return`
`+W+h}var z=!1;function K(h,m){if(!h||z)return"";z=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(ft){var D=ft}Reflect.construct(h,[],m)}else{try{m.call()}catch(ft){D=ft}h.call(m.prototype)}else{try{throw Error()}catch(ft){D=ft}h()}}catch(ft){if(ft&&D&&typeof ft.stack=="string"){for(var G=ft.stack.split(`
`),J=D.stack.split(`
`),de=G.length-1,je=J.length-1;1<=de&&0<=je&&G[de]!==J[je];)je--;for(;1<=de&&0<=je;de--,je--)if(G[de]!==J[je]){if(de!==1||je!==1)do if(de--,je--,0>je||G[de]!==J[je]){var Me=`
`+G[de].replace(" at new "," at ");return h.displayName&&Me.includes("<anonymous>")&&(Me=Me.replace("<anonymous>",h.displayName)),Me}while(1<=de&&0<=je);break}}}finally{z=!1,Error.prepareStackTrace=T}return(h=h?h.displayName||h.name:"")?R(h):""}function Q(h){switch(h.tag){case 5:return R(h.type);case 16:return R("Lazy");case 13:return R("Suspense");case 19:return R("SuspenseList");case 0:case 2:case 15:return h=K(h.type,!1),h;case 11:return h=K(h.type.render,!1),h;case 1:return h=K(h.type,!0),h;default:return""}}function ae(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case F:return"Fragment";case P:return"Portal";case j:return"Profiler";case A:return"StrictMode";case Z:return"Suspense";case se:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case B:return(h.displayName||"Context")+".Consumer";case I:return(h._context.displayName||"Context")+".Provider";case Y:var m=h.render;return h=h.displayName,h||(h=m.displayName||m.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case ee:return m=h.displayName||null,m!==null?m:ae(h.type)||"Memo";case te:m=h._payload,h=h._init;try{return ae(h(m))}catch{}}return null}function X(h){var m=h.type;switch(h.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=m.render,h=h.displayName||h.name||"",m.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ae(m);case 8:return m===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function ie(h){switch(typeof h){case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function le(h){var m=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function ce(h){var m=le(h)?"checked":"value",T=Object.getOwnPropertyDescriptor(h.constructor.prototype,m),D=""+h[m];if(!h.hasOwnProperty(m)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var G=T.get,J=T.set;return Object.defineProperty(h,m,{configurable:!0,get:function(){return G.call(this)},set:function(de){D=""+de,J.call(this,de)}}),Object.defineProperty(h,m,{enumerable:T.enumerable}),{getValue:function(){return D},setValue:function(de){D=""+de},stopTracking:function(){h._valueTracker=null,delete h[m]}}}}function _e(h){h._valueTracker||(h._valueTracker=ce(h))}function ne(h){if(!h)return!1;var m=h._valueTracker;if(!m)return!0;var T=m.getValue(),D="";return h&&(D=le(h)?h.checked?"true":"false":h.value),h=D,h!==T?(m.setValue(h),!0):!1}function pe(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}function Ce(h,m){var T=m.checked;return H({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:T??h._wrapperState.initialChecked})}function Ae(h,m){var T=m.defaultValue==null?"":m.defaultValue,D=m.checked!=null?m.checked:m.defaultChecked;T=ie(m.value!=null?m.value:T),h._wrapperState={initialChecked:D,initialValue:T,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function Ge(h,m){m=m.checked,m!=null&&_(h,"checked",m,!1)}function Le(h,m){Ge(h,m);var T=ie(m.value),D=m.type;if(T!=null)D==="number"?(T===0&&h.value===""||h.value!=T)&&(h.value=""+T):h.value!==""+T&&(h.value=""+T);else if(D==="submit"||D==="reset"){h.removeAttribute("value");return}m.hasOwnProperty("value")?et(h,m.type,T):m.hasOwnProperty("defaultValue")&&et(h,m.type,ie(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(h.defaultChecked=!!m.defaultChecked)}function At(h,m,T){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var D=m.type;if(!(D!=="submit"&&D!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+h._wrapperState.initialValue,T||m===h.value||(h.value=m),h.defaultValue=m}T=h.name,T!==""&&(h.name=""),h.defaultChecked=!!h._wrapperState.initialChecked,T!==""&&(h.name=T)}function et(h,m,T){(m!=="number"||pe(h.ownerDocument)!==h)&&(T==null?h.defaultValue=""+h._wrapperState.initialValue:h.defaultValue!==""+T&&(h.defaultValue=""+T))}var pt=Array.isArray;function lt(h,m,T,D){if(h=h.options,m){m={};for(var G=0;G<T.length;G++)m["$"+T[G]]=!0;for(T=0;T<h.length;T++)G=m.hasOwnProperty("$"+h[T].value),h[T].selected!==G&&(h[T].selected=G),G&&D&&(h[T].defaultSelected=!0)}else{for(T=""+ie(T),m=null,G=0;G<h.length;G++){if(h[G].value===T){h[G].selected=!0,D&&(h[G].defaultSelected=!0);return}m!==null||h[G].disabled||(m=h[G])}m!==null&&(m.selected=!0)}}function rt(h,m){if(m.dangerouslySetInnerHTML!=null)throw Error(r(91));return H({},m,{value:void 0,defaultValue:void 0,children:""+h._wrapperState.initialValue})}function ht(h,m){var T=m.value;if(T==null){if(T=m.children,m=m.defaultValue,T!=null){if(m!=null)throw Error(r(92));if(pt(T)){if(1<T.length)throw Error(r(93));T=T[0]}m=T}m==null&&(m=""),T=m}h._wrapperState={initialValue:ie(T)}}function Lt(h,m){var T=ie(m.value),D=ie(m.defaultValue);T!=null&&(T=""+T,T!==h.value&&(h.value=T),m.defaultValue==null&&h.defaultValue!==T&&(h.defaultValue=T)),D!=null&&(h.defaultValue=""+D)}function zt(h){var m=h.textContent;m===h._wrapperState.initialValue&&m!==""&&m!==null&&(h.value=m)}function Dt(h){switch(h){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function De(h,m){return h==null||h==="http://www.w3.org/1999/xhtml"?Dt(m):h==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":h}var Ie,Ke=(function(h){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,T,D,G){MSApp.execUnsafeLocalFunction(function(){return h(m,T,D,G)})}:h})(function(h,m){if(h.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in h)h.innerHTML=m;else{for(Ie=Ie||document.createElement("div"),Ie.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=Ie.firstChild;h.firstChild;)h.removeChild(h.firstChild);for(;m.firstChild;)h.appendChild(m.firstChild)}});function Je(h,m){if(m){var T=h.firstChild;if(T&&T===h.lastChild&&T.nodeType===3){T.nodeValue=m;return}}h.textContent=m}var Ye={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tt=["Webkit","ms","Moz","O"];Object.keys(Ye).forEach(function(h){Tt.forEach(function(m){m=m+h.charAt(0).toUpperCase()+h.substring(1),Ye[m]=Ye[h]})});function Nt(h,m,T){return m==null||typeof m=="boolean"||m===""?"":T||typeof m!="number"||m===0||Ye.hasOwnProperty(h)&&Ye[h]?(""+m).trim():m+"px"}function Wt(h,m){h=h.style;for(var T in m)if(m.hasOwnProperty(T)){var D=T.indexOf("--")===0,G=Nt(T,m[T],D);T==="float"&&(T="cssFloat"),D?h.setProperty(T,G):h[T]=G}}var or=H({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dr(h,m){if(m){if(or[h]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(r(137,h));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(r(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(r(61))}if(m.style!=null&&typeof m.style!="object")throw Error(r(62))}}function Er(h,m){if(h.indexOf("-")===-1)return typeof m.is=="string";switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fr=null;function nr(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var me=null,Ne=null,Fe=null;function Re(h){if(h=lh(h)){if(typeof me!="function")throw Error(r(280));var m=h.stateNode;m&&(m=aa(m),me(h.stateNode,h.type,m))}}function bt(h){Ne?Fe?Fe.push(h):Fe=[h]:Ne=h}function Pe(){if(Ne){var h=Ne,m=Fe;if(Fe=Ne=null,Re(h),m)for(h=0;h<m.length;h++)Re(m[h])}}function ze(h,m){return h(m)}function ke(){}var $e=!1;function Be(h,m,T){if($e)return h(m,T);$e=!0;try{return ze(h,m,T)}finally{$e=!1,(Ne!==null||Fe!==null)&&(ke(),Pe())}}function Et(h,m){var T=h.stateNode;if(T===null)return null;var D=aa(T);if(D===null)return null;T=D[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(D=!D.disabled)||(h=h.type,D=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!D;break e;default:h=!1}if(h)return null;if(T&&typeof T!="function")throw Error(r(231,m,typeof T));return T}var It=!1;if(o)try{var Kt={};Object.defineProperty(Kt,"passive",{get:function(){It=!0}}),window.addEventListener("test",Kt,Kt),window.removeEventListener("test",Kt,Kt)}catch{It=!1}function wr(h,m,T,D,G,J,de,je,Me){var ft=Array.prototype.slice.call(arguments,3);try{m.apply(T,ft)}catch(Ut){this.onError(Ut)}}var lr=!1,Fr=null,ue=!1,be=null,xe={onError:function(h){lr=!0,Fr=h}};function he(h,m,T,D,G,J,de,je,Me){lr=!1,Fr=null,wr.apply(xe,arguments)}function we(h,m,T,D,G,J,de,je,Me){if(he.apply(this,arguments),lr){if(lr){var ft=Fr;lr=!1,Fr=null}else throw Error(r(198));ue||(ue=!0,be=ft)}}function Se(h){var m=h,T=h;if(h.alternate)for(;m.return;)m=m.return;else{h=m;do m=h,(m.flags&4098)!==0&&(T=m.return),h=m.return;while(h)}return m.tag===3?T:null}function He(h){if(h.tag===13){var m=h.memoizedState;if(m===null&&(h=h.alternate,h!==null&&(m=h.memoizedState)),m!==null)return m.dehydrated}return null}function ct(h){if(Se(h)!==h)throw Error(r(188))}function qe(h){var m=h.alternate;if(!m){if(m=Se(h),m===null)throw Error(r(188));return m!==h?null:h}for(var T=h,D=m;;){var G=T.return;if(G===null)break;var J=G.alternate;if(J===null){if(D=G.return,D!==null){T=D;continue}break}if(G.child===J.child){for(J=G.child;J;){if(J===T)return ct(G),h;if(J===D)return ct(G),m;J=J.sibling}throw Error(r(188))}if(T.return!==D.return)T=G,D=J;else{for(var de=!1,je=G.child;je;){if(je===T){de=!0,T=G,D=J;break}if(je===D){de=!0,D=G,T=J;break}je=je.sibling}if(!de){for(je=J.child;je;){if(je===T){de=!0,T=J,D=G;break}if(je===D){de=!0,D=J,T=G;break}je=je.sibling}if(!de)throw Error(r(189))}}if(T.alternate!==D)throw Error(r(190))}if(T.tag!==3)throw Error(r(188));return T.stateNode.current===T?h:m}function oe(h){return h=qe(h),h!==null?fe(h):null}function fe(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var m=fe(h);if(m!==null)return m;h=h.sibling}return null}var Te=t.unstable_scheduleCallback,Ee=t.unstable_cancelCallback,Xe=t.unstable_shouldYield,ot=t.unstable_requestPaint,xt=t.unstable_now,qt=t.unstable_getCurrentPriorityLevel,yt=t.unstable_ImmediatePriority,Yt=t.unstable_UserBlockingPriority,_r=t.unstable_NormalPriority,kr=t.unstable_LowPriority,xr=t.unstable_IdlePriority,Gr=null,un=null;function Xr(h){if(un&&typeof un.onCommitFiberRoot=="function")try{un.onCommitFiberRoot(Gr,h,void 0,(h.current.flags&128)===128)}catch{}}var cr=Math.clz32?Math.clz32:Gn,na=Math.log,hn=Math.LN2;function Gn(h){return h>>>=0,h===0?32:31-(na(h)/hn|0)|0}var Nn=64,Ws=4194304;function Sn(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function ye(h,m){var T=h.pendingLanes;if(T===0)return 0;var D=0,G=h.suspendedLanes,J=h.pingedLanes,de=T&268435455;if(de!==0){var je=de&~G;je!==0?D=Sn(je):(J&=de,J!==0&&(D=Sn(J)))}else de=T&~G,de!==0?D=Sn(de):J!==0&&(D=Sn(J));if(D===0)return 0;if(m!==0&&m!==D&&(m&G)===0&&(G=D&-D,J=m&-m,G>=J||G===16&&(J&4194240)!==0))return m;if((D&4)!==0&&(D|=T&16),m=h.entangledLanes,m!==0)for(h=h.entanglements,m&=D;0<m;)T=31-cr(m),G=1<<T,D|=h[T],m&=~G;return D}function wt(h,m){switch(h){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nr(h,m){for(var T=h.suspendedLanes,D=h.pingedLanes,G=h.expirationTimes,J=h.pendingLanes;0<J;){var de=31-cr(J),je=1<<de,Me=G[de];Me===-1?((je&T)===0||(je&D)!==0)&&(G[de]=wt(je,m)):Me<=m&&(h.expiredLanes|=je),J&=~je}}function Or(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function Vn(){var h=Nn;return Nn<<=1,(Nn&4194240)===0&&(Nn=64),h}function dn(h){for(var m=[],T=0;31>T;T++)m.push(h);return m}function Oe(h,m,T){h.pendingLanes|=m,m!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,m=31-cr(m),h[m]=T}function dt(h,m){var T=h.pendingLanes&~m;h.pendingLanes=m,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=m,h.mutableReadLanes&=m,h.entangledLanes&=m,m=h.entanglements;var D=h.eventTimes;for(h=h.expirationTimes;0<T;){var G=31-cr(T),J=1<<G;m[G]=0,D[G]=-1,h[G]=-1,T&=~J}}function Rt(h,m){var T=h.entangledLanes|=m;for(h=h.entanglements;T;){var D=31-cr(T),G=1<<D;G&m|h[D]&m&&(h[D]|=m),T&=~G}}var Pt=0;function mn(h){return h&=-h,1<h?4<h?(h&268435455)!==0?16:536870912:4:1}var tt,mt,Xt,Ct,Sr,Ft=!1,Hr=[],rn=null,nt=null,Jt=null,Bt=new Map,kn=new Map,Vr=[],Kr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qn(h,m){switch(h){case"focusin":case"focusout":rn=null;break;case"dragenter":case"dragleave":nt=null;break;case"mouseover":case"mouseout":Jt=null;break;case"pointerover":case"pointerout":Bt.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":kn.delete(m.pointerId)}}function Bn(h,m,T,D,G,J){return h===null||h.nativeEvent!==J?(h={blockedOn:m,domEventName:T,eventSystemFlags:D,nativeEvent:J,targetContainers:[G]},m!==null&&(m=lh(m),m!==null&&mt(m)),h):(h.eventSystemFlags|=D,m=h.targetContainers,G!==null&&m.indexOf(G)===-1&&m.push(G),h)}function Jn(h,m,T,D,G){switch(m){case"focusin":return rn=Bn(rn,h,m,T,D,G),!0;case"dragenter":return nt=Bn(nt,h,m,T,D,G),!0;case"mouseover":return Jt=Bn(Jt,h,m,T,D,G),!0;case"pointerover":var J=G.pointerId;return Bt.set(J,Bn(Bt.get(J)||null,h,m,T,D,G)),!0;case"gotpointercapture":return J=G.pointerId,kn.set(J,Bn(kn.get(J)||null,h,m,T,D,G)),!0}return!1}function fo(h){var m=jc(h.target);if(m!==null){var T=Se(m);if(T!==null){if(m=T.tag,m===13){if(m=He(T),m!==null){h.blockedOn=m,Sr(h.priority,function(){Xt(T)});return}}else if(m===3&&T.stateNode.current.memoizedState.isDehydrated){h.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}h.blockedOn=null}function wc(h){if(h.blockedOn!==null)return!1;for(var m=h.targetContainers;0<m.length;){var T=H0(h.domEventName,h.eventSystemFlags,m[0],h.nativeEvent);if(T===null){T=h.nativeEvent;var D=new T.constructor(T.type,T);fr=D,T.target.dispatchEvent(D),fr=null}else return m=lh(T),m!==null&&mt(m),h.blockedOn=T,!1;m.shift()}return!0}function z0(h,m,T){wc(h)&&T.delete(m)}function K2(){Ft=!1,rn!==null&&wc(rn)&&(rn=null),nt!==null&&wc(nt)&&(nt=null),Jt!==null&&wc(Jt)&&(Jt=null),Bt.forEach(z0),kn.forEach(z0)}function _c(h,m){h.blockedOn===m&&(h.blockedOn=null,Ft||(Ft=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,K2)))}function bi(h){function m(G){return _c(G,h)}if(0<Hr.length){_c(Hr[0],h);for(var T=1;T<Hr.length;T++){var D=Hr[T];D.blockedOn===h&&(D.blockedOn=null)}}for(rn!==null&&_c(rn,h),nt!==null&&_c(nt,h),Jt!==null&&_c(Jt,h),Bt.forEach(m),kn.forEach(m),T=0;T<Vr.length;T++)D=Vr[T],D.blockedOn===h&&(D.blockedOn=null);for(;0<Vr.length&&(T=Vr[0],T.blockedOn===null);)fo(T),T.blockedOn===null&&Vr.shift()}var Sd=N.ReactCurrentBatchConfig,W0=!0;function Oo(h,m,T,D){var G=Pt,J=Sd.transition;Sd.transition=null;try{Pt=1,kd(h,m,T,D)}finally{Pt=G,Sd.transition=J}}function zl(h,m,T,D){var G=Pt,J=Sd.transition;Sd.transition=null;try{Pt=4,kd(h,m,T,D)}finally{Pt=G,Sd.transition=J}}function kd(h,m,T,D){if(W0){var G=H0(h,m,T,D);if(G===null)ig(h,m,D,Cd,T),Qn(h,D);else if(Jn(G,h,m,T,D))D.stopPropagation();else if(Qn(h,D),m&4&&-1<Kr.indexOf(h)){for(;G!==null;){var J=lh(G);if(J!==null&&tt(J),J=H0(h,m,T,D),J===null&&ig(h,m,D,Cd,T),J===G)break;G=J}G!==null&&D.stopPropagation()}else ig(h,m,D,null,T)}}var Cd=null;function H0(h,m,T,D){if(Cd=null,h=nr(D),h=jc(h),h!==null)if(m=Se(h),m===null)h=null;else if(T=m.tag,T===13){if(h=He(m),h!==null)return h;h=null}else if(T===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;h=null}else m!==h&&(h=null);return Cd=h,null}function m1(h){switch(h){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qt()){case yt:return 1;case Yt:return 4;case _r:case kr:return 16;case xr:return 536870912;default:return 16}default:return 16}}var xa=null,bc=null,Wl=null;function Yf(){if(Wl)return Wl;var h,m=bc,T=m.length,D,G="value"in xa?xa.value:xa.textContent,J=G.length;for(h=0;h<T&&m[h]===G[h];h++);var de=T-h;for(D=1;D<=de&&m[T-D]===G[J-D];D++);return Wl=G.slice(h,1<D?1-D:void 0)}function uu(h){var m=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&m===13&&(h=13)):h=m,h===10&&(h=13),32<=h||h===13?h:0}function Qa(){return!0}function Wi(){return!1}function Hs(h){function m(T,D,G,J,de){this._reactName=T,this._targetInst=G,this.type=D,this.nativeEvent=J,this.target=de,this.currentTarget=null;for(var je in h)h.hasOwnProperty(je)&&(T=h[je],this[je]=T?T(J):J[je]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?Qa:Wi,this.isPropagationStopped=Wi,this}return H(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=Qa)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=Qa)},persist:function(){},isPersistent:Qa}),m}var Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Do=Hs(Si),Io=H({},Si,{view:0,detail:0}),p1=Hs(Io),Xf,Qf,ya,Ja=H({},Io,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fu,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==ya&&(ya&&h.type==="mousemove"?(Xf=h.screenX-ya.screenX,Qf=h.screenY-ya.screenY):Qf=Xf=0,ya=h),Xf)},movementY:function(h){return"movementY"in h?h.movementY:Qf}}),Kn=Hs(Ja),Jf=H({},Ja,{dataTransfer:0}),Ro=Hs(Jf),x1=H({},Io,{relatedTarget:0}),G0=Hs(x1),gp=H({},Si,{animationName:0,elapsedTime:0,pseudoElement:0}),mp=Hs(gp),y1=H({},Si,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),V0=Hs(y1),v1=H({},Si,{data:0}),du=Hs(v1),pp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},K0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Y2(h){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(h):(h=K0[h])?!!m[h]:!1}function fu(){return Y2}var q0=H({},Io,{key:function(h){if(h.key){var m=pp[h.key]||h.key;if(m!=="Unidentified")return m}return h.type==="keypress"?(h=uu(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?q2[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fu,charCode:function(h){return h.type==="keypress"?uu(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?uu(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),w1=Hs(q0),_1=H({},Ja,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hu=Hs(_1),b1=H({},Io,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fu}),Y0=Hs(b1),X0=H({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0}),Td=Hs(X0),xp=H({},Ja,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),yp=Hs(xp),S1=[9,13,27,32],Zf=o&&"CompositionEvent"in window,gu=null;o&&"documentMode"in document&&(gu=document.documentMode);var Ed=o&&"TextEvent"in window&&!gu,Hi=o&&(!Zf||gu&&8<gu&&11>=gu),Sc=" ",Q0=!1;function vp(h,m){switch(h){case"keyup":return S1.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mo(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var Gi=!1;function wp(h,m){switch(h){case"compositionend":return Mo(m);case"keypress":return m.which!==32?null:(Q0=!0,Sc);case"textInput":return h=m.data,h===Sc&&Q0?null:h;default:return null}}function k1(h,m){if(Gi)return h==="compositionend"||!Zf&&vp(h,m)?(h=Yf(),Wl=bc=xa=null,Gi=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Hi&&m.locale!=="ko"?null:m.data;default:return null}}var Hl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gl(h){var m=h&&h.nodeName&&h.nodeName.toLowerCase();return m==="input"?!!Hl[h.type]:m==="textarea"}function eh(h,m,T,D){bt(D),m=og(m,"onChange"),0<m.length&&(T=new Do("onChange","change",null,T,D),h.push({event:T,listeners:m}))}var Nd=null,kc=null;function C1(h){Pp(h,0)}function Cc(h){var m=Vs(h);if(ne(m))return h}function ho(h,m){if(h==="change")return m}var Ad=!1;if(o){var Tc;if(o){var go="oninput"in document;if(!go){var J0=document.createElement("div");J0.setAttribute("oninput","return;"),go=typeof J0.oninput=="function"}Tc=go}else Tc=!1;Ad=Tc&&(!document.documentMode||9<document.documentMode)}function mu(){Nd&&(Nd.detachEvent("onpropertychange",_p),kc=Nd=null)}function _p(h){if(h.propertyName==="value"&&Cc(kc)){var m=[];eh(m,kc,h,nr(h)),Be(C1,m)}}function bp(h,m,T){h==="focusin"?(mu(),Nd=m,kc=T,Nd.attachEvent("onpropertychange",_p)):h==="focusout"&&mu()}function ns(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return Cc(kc)}function Z0(h,m){if(h==="click")return Cc(m)}function Sp(h,m){if(h==="input"||h==="change")return Cc(m)}function kp(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var ki=typeof Object.is=="function"?Object.is:kp;function pu(h,m){if(ki(h,m))return!0;if(typeof h!="object"||h===null||typeof m!="object"||m===null)return!1;var T=Object.keys(h),D=Object.keys(m);if(T.length!==D.length)return!1;for(D=0;D<T.length;D++){var G=T[D];if(!c.call(m,G)||!ki(h[G],m[G]))return!1}return!0}function Ec(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function Zn(h,m){var T=Ec(h);h=0;for(var D;T;){if(T.nodeType===3){if(D=h+T.textContent.length,h<=m&&D>=m)return{node:T,offset:m-h};h=D}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=Ec(T)}}function Ts(h,m){return h&&m?h===m?!0:h&&h.nodeType===3?!1:m&&m.nodeType===3?Ts(h,m.parentNode):"contains"in h?h.contains(m):h.compareDocumentPosition?!!(h.compareDocumentPosition(m)&16):!1:!1}function Gs(){for(var h=window,m=pe();m instanceof h.HTMLIFrameElement;){try{var T=typeof m.contentWindow.location.href=="string"}catch{T=!1}if(T)h=m.contentWindow;else break;m=pe(h.document)}return m}function jd(h){var m=h&&h.nodeName&&h.nodeName.toLowerCase();return m&&(m==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||m==="textarea"||h.contentEditable==="true")}function th(h){var m=Gs(),T=h.focusedElem,D=h.selectionRange;if(m!==T&&T&&T.ownerDocument&&Ts(T.ownerDocument.documentElement,T)){if(D!==null&&jd(T)){if(m=D.start,h=D.end,h===void 0&&(h=m),"selectionStart"in T)T.selectionStart=m,T.selectionEnd=Math.min(h,T.value.length);else if(h=(m=T.ownerDocument||document)&&m.defaultView||window,h.getSelection){h=h.getSelection();var G=T.textContent.length,J=Math.min(D.start,G);D=D.end===void 0?J:Math.min(D.end,G),!h.extend&&J>D&&(G=D,D=J,J=G),G=Zn(T,J);var de=Zn(T,D);G&&de&&(h.rangeCount!==1||h.anchorNode!==G.node||h.anchorOffset!==G.offset||h.focusNode!==de.node||h.focusOffset!==de.offset)&&(m=m.createRange(),m.setStart(G.node,G.offset),h.removeAllRanges(),J>D?(h.addRange(m),h.extend(de.node,de.offset)):(m.setEnd(de.node,de.offset),h.addRange(m)))}}for(m=[],h=T;h=h.parentNode;)h.nodeType===1&&m.push({element:h,left:h.scrollLeft,top:h.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<m.length;T++)h=m[T],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}}var rh=o&&"documentMode"in document&&11>=document.documentMode,Pd=null,sa=null,xu=null,nh=!1;function eg(h,m,T){var D=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;nh||Pd==null||Pd!==pe(D)||(D=Pd,"selectionStart"in D&&jd(D)?D={start:D.selectionStart,end:D.selectionEnd}:(D=(D.ownerDocument&&D.ownerDocument.defaultView||window).getSelection(),D={anchorNode:D.anchorNode,anchorOffset:D.anchorOffset,focusNode:D.focusNode,focusOffset:D.focusOffset}),xu&&pu(xu,D)||(xu=D,D=og(sa,"onSelect"),0<D.length&&(m=new Do("onSelect","select",null,m,T),h.push({event:m,listeners:D}),m.target=Pd)))}function Vi(h,m){var T={};return T[h.toLowerCase()]=m.toLowerCase(),T["Webkit"+h]="webkit"+m,T["Moz"+h]="moz"+m,T}var va={animationend:Vi("Animation","AnimationEnd"),animationiteration:Vi("Animation","AnimationIteration"),animationstart:Vi("Animation","AnimationStart"),transitionend:Vi("Transition","TransitionEnd")},yu={},tg={};o&&(tg=document.createElement("div").style,"AnimationEvent"in window||(delete va.animationend.animation,delete va.animationiteration.animation,delete va.animationstart.animation),"TransitionEvent"in window||delete va.transitionend.transition);function Fd(h){if(yu[h])return yu[h];if(!va[h])return h;var m=va[h],T;for(T in m)if(m.hasOwnProperty(T)&&T in tg)return yu[h]=m[T];return h}var Cp=Fd("animationend"),Tp=Fd("animationiteration"),Ep=Fd("animationstart"),Np=Fd("transitionend"),Ap=new Map,jp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vl(h,m){Ap.set(h,m),a(m,[h])}for(var rg=0;rg<jp.length;rg++){var vu=jp[rg],T1=vu.toLowerCase(),ng=vu[0].toUpperCase()+vu.slice(1);Vl(T1,"on"+ng)}Vl(Cp,"onAnimationEnd"),Vl(Tp,"onAnimationIteration"),Vl(Ep,"onAnimationStart"),Vl("dblclick","onDoubleClick"),Vl("focusin","onFocus"),Vl("focusout","onBlur"),Vl(Np,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),E1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nc));function sg(h,m,T){var D=h.type||"unknown-event";h.currentTarget=T,we(D,m,void 0,h),h.currentTarget=null}function Pp(h,m){m=(m&4)!==0;for(var T=0;T<h.length;T++){var D=h[T],G=D.event;D=D.listeners;e:{var J=void 0;if(m)for(var de=D.length-1;0<=de;de--){var je=D[de],Me=je.instance,ft=je.currentTarget;if(je=je.listener,Me!==J&&G.isPropagationStopped())break e;sg(G,je,ft),J=Me}else for(de=0;de<D.length;de++){if(je=D[de],Me=je.instance,ft=je.currentTarget,je=je.listener,Me!==J&&G.isPropagationStopped())break e;sg(G,je,ft),J=Me}}}if(ue)throw h=be,ue=!1,be=null,h}function $n(h,m){var T=m[cg];T===void 0&&(T=m[cg]=new Set);var D=h+"__bubble";T.has(D)||(Fp(m,h,2,!1),T.add(D))}function ag(h,m,T){var D=0;m&&(D|=4),Fp(T,h,D,m)}var sh="_reactListening"+Math.random().toString(36).slice(2);function wu(h){if(!h[sh]){h[sh]=!0,n.forEach(function(T){T!=="selectionchange"&&(E1.has(T)||ag(T,!1,h),ag(T,!0,h))});var m=h.nodeType===9?h:h.ownerDocument;m===null||m[sh]||(m[sh]=!0,ag("selectionchange",!1,m))}}function Fp(h,m,T,D){switch(m1(m)){case 1:var G=Oo;break;case 4:G=zl;break;default:G=kd}T=G.bind(null,m,T,h),G=void 0,!It||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(G=!0),D?G!==void 0?h.addEventListener(m,T,{capture:!0,passive:G}):h.addEventListener(m,T,!0):G!==void 0?h.addEventListener(m,T,{passive:G}):h.addEventListener(m,T,!1)}function ig(h,m,T,D,G){var J=D;if((m&1)===0&&(m&2)===0&&D!==null)e:for(;;){if(D===null)return;var de=D.tag;if(de===3||de===4){var je=D.stateNode.containerInfo;if(je===G||je.nodeType===8&&je.parentNode===G)break;if(de===4)for(de=D.return;de!==null;){var Me=de.tag;if((Me===3||Me===4)&&(Me=de.stateNode.containerInfo,Me===G||Me.nodeType===8&&Me.parentNode===G))return;de=de.return}for(;je!==null;){if(de=jc(je),de===null)return;if(Me=de.tag,Me===5||Me===6){D=J=de;continue e}je=je.parentNode}}D=D.return}Be(function(){var ft=J,Ut=nr(T),Gt=[];e:{var $t=Ap.get(h);if($t!==void 0){var ur=Do,yr=h;switch(h){case"keypress":if(uu(T)===0)break e;case"keydown":case"keyup":ur=w1;break;case"focusin":yr="focus",ur=G0;break;case"focusout":yr="blur",ur=G0;break;case"beforeblur":case"afterblur":ur=G0;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ur=Kn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ur=Ro;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ur=Y0;break;case Cp:case Tp:case Ep:ur=mp;break;case Np:ur=Td;break;case"scroll":ur=p1;break;case"wheel":ur=yp;break;case"copy":case"cut":case"paste":ur=V0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ur=hu}var vr=(m&4)!==0,Xs=!vr&&h==="scroll",st=vr?$t!==null?$t+"Capture":null:$t;vr=[];for(var We=ft,it;We!==null;){it=We;var Qt=it.stateNode;if(it.tag===5&&Qt!==null&&(it=Qt,st!==null&&(Qt=Et(We,st),Qt!=null&&vr.push(Od(We,Qt,it)))),Xs)break;We=We.return}0<vr.length&&($t=new ur($t,yr,null,T,Ut),Gt.push({event:$t,listeners:vr}))}}if((m&7)===0){e:{if($t=h==="mouseover"||h==="pointerover",ur=h==="mouseout"||h==="pointerout",$t&&T!==fr&&(yr=T.relatedTarget||T.fromElement)&&(jc(yr)||yr[sl]))break e;if((ur||$t)&&($t=Ut.window===Ut?Ut:($t=Ut.ownerDocument)?$t.defaultView||$t.parentWindow:window,ur?(yr=T.relatedTarget||T.toElement,ur=ft,yr=yr?jc(yr):null,yr!==null&&(Xs=Se(yr),yr!==Xs||yr.tag!==5&&yr.tag!==6)&&(yr=null)):(ur=null,yr=ft),ur!==yr)){if(vr=Kn,Qt="onMouseLeave",st="onMouseEnter",We="mouse",(h==="pointerout"||h==="pointerover")&&(vr=hu,Qt="onPointerLeave",st="onPointerEnter",We="pointer"),Xs=ur==null?$t:Vs(ur),it=yr==null?$t:Vs(yr),$t=new vr(Qt,We+"leave",ur,T,Ut),$t.target=Xs,$t.relatedTarget=it,Qt=null,jc(Ut)===ft&&(vr=new vr(st,We+"enter",yr,T,Ut),vr.target=it,vr.relatedTarget=Xs,Qt=vr),Xs=Qt,ur&&yr)t:{for(vr=ur,st=yr,We=0,it=vr;it;it=_u(it))We++;for(it=0,Qt=st;Qt;Qt=_u(Qt))it++;for(;0<We-it;)vr=_u(vr),We--;for(;0<it-We;)st=_u(st),it--;for(;We--;){if(vr===st||st!==null&&vr===st.alternate)break t;vr=_u(vr),st=_u(st)}vr=null}else vr=null;ur!==null&&N1(Gt,$t,ur,vr,!1),yr!==null&&Xs!==null&&N1(Gt,Xs,yr,vr,!0)}}e:{if($t=ft?Vs(ft):window,ur=$t.nodeName&&$t.nodeName.toLowerCase(),ur==="select"||ur==="input"&&$t.type==="file")var br=ho;else if(Gl($t))if(Ad)br=Sp;else{br=ns;var Ar=bp}else(ur=$t.nodeName)&&ur.toLowerCase()==="input"&&($t.type==="checkbox"||$t.type==="radio")&&(br=Z0);if(br&&(br=br(h,ft))){eh(Gt,br,T,Ut);break e}Ar&&Ar(h,$t,ft),h==="focusout"&&(Ar=$t._wrapperState)&&Ar.controlled&&$t.type==="number"&&et($t,"number",$t.value)}switch(Ar=ft?Vs(ft):window,h){case"focusin":(Gl(Ar)||Ar.contentEditable==="true")&&(Pd=Ar,sa=ft,xu=null);break;case"focusout":xu=sa=Pd=null;break;case"mousedown":nh=!0;break;case"contextmenu":case"mouseup":case"dragend":nh=!1,eg(Gt,T,Ut);break;case"selectionchange":if(rh)break;case"keydown":case"keyup":eg(Gt,T,Ut)}var jr;if(Zf)e:{switch(h){case"compositionstart":var Br="onCompositionStart";break e;case"compositionend":Br="onCompositionEnd";break e;case"compositionupdate":Br="onCompositionUpdate";break e}Br=void 0}else Gi?vp(h,T)&&(Br="onCompositionEnd"):h==="keydown"&&T.keyCode===229&&(Br="onCompositionStart");Br&&(Hi&&T.locale!=="ko"&&(Gi||Br!=="onCompositionStart"?Br==="onCompositionEnd"&&Gi&&(jr=Yf()):(xa=Ut,bc="value"in xa?xa.value:xa.textContent,Gi=!0)),Ar=og(ft,Br),0<Ar.length&&(Br=new du(Br,h,null,T,Ut),Gt.push({event:Br,listeners:Ar}),jr?Br.data=jr:(jr=Mo(T),jr!==null&&(Br.data=jr)))),(jr=Ed?wp(h,T):k1(h,T))&&(ft=og(ft,"onBeforeInput"),0<ft.length&&(Ut=new du("onBeforeInput","beforeinput",null,T,Ut),Gt.push({event:Ut,listeners:ft}),Ut.data=jr))}Pp(Gt,m)})}function Od(h,m,T){return{instance:h,listener:m,currentTarget:T}}function og(h,m){for(var T=m+"Capture",D=[];h!==null;){var G=h,J=G.stateNode;G.tag===5&&J!==null&&(G=J,J=Et(h,T),J!=null&&D.unshift(Od(h,J,G)),J=Et(h,m),J!=null&&D.push(Od(h,J,G))),h=h.return}return D}function _u(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5);return h||null}function N1(h,m,T,D,G){for(var J=m._reactName,de=[];T!==null&&T!==D;){var je=T,Me=je.alternate,ft=je.stateNode;if(Me!==null&&Me===D)break;je.tag===5&&ft!==null&&(je=ft,G?(Me=Et(T,J),Me!=null&&de.unshift(Od(T,Me,je))):G||(Me=Et(T,J),Me!=null&&de.push(Od(T,Me,je)))),T=T.return}de.length!==0&&h.push({event:m,listeners:de})}var X2=/\r\n?/g,A1=/\u0000|\uFFFD/g;function Op(h){return(typeof h=="string"?h:""+h).replace(X2,`
`).replace(A1,"")}function ah(h,m,T){if(m=Op(m),Op(h)!==m&&T)throw Error(r(425))}function bu(){}var Dp=null,Ip=null;function Rp(h,m){return h==="textarea"||h==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var Ki=typeof setTimeout=="function"?setTimeout:void 0,Mp=typeof clearTimeout=="function"?clearTimeout:void 0,ih=typeof Promise=="function"?Promise:void 0,j1=typeof queueMicrotask=="function"?queueMicrotask:typeof ih<"u"?function(h){return ih.resolve(null).then(h).catch(P1)}:Ki;function P1(h){setTimeout(function(){throw h})}function lg(h,m){var T=m,D=0;do{var G=T.nextSibling;if(h.removeChild(T),G&&G.nodeType===8)if(T=G.data,T==="/$"){if(D===0){h.removeChild(G),bi(m);return}D--}else T!=="$"&&T!=="$?"&&T!=="$!"||D++;T=G}while(T);bi(m)}function nl(h){for(;h!=null;h=h.nextSibling){var m=h.nodeType;if(m===1||m===3)break;if(m===8){if(m=h.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return h}function Su(h){h=h.previousSibling;for(var m=0;h;){if(h.nodeType===8){var T=h.data;if(T==="$"||T==="$!"||T==="$?"){if(m===0)return h;m--}else T==="/$"&&m++}h=h.previousSibling}return null}var Ac=Math.random().toString(36).slice(2),mo="__reactFiber$"+Ac,oh="__reactProps$"+Ac,sl="__reactContainer$"+Ac,cg="__reactEvents$"+Ac,F1="__reactListeners$"+Ac,O1="__reactHandles$"+Ac;function jc(h){var m=h[mo];if(m)return m;for(var T=h.parentNode;T;){if(m=T[sl]||T[mo]){if(T=m.alternate,m.child!==null||T!==null&&T.child!==null)for(h=Su(h);h!==null;){if(T=h[mo])return T;h=Su(h)}return m}h=T,T=h.parentNode}return null}function lh(h){return h=h[mo]||h[sl],!h||h.tag!==5&&h.tag!==6&&h.tag!==13&&h.tag!==3?null:h}function Vs(h){if(h.tag===5||h.tag===6)return h.stateNode;throw Error(r(33))}function aa(h){return h[oh]||null}var ug=[],ku=-1;function Kl(h){return{current:h}}function Un(h){0>ku||(h.current=ug[ku],ug[ku]=null,ku--)}function Pn(h,m){ku++,ug[ku]=h.current,h.current=m}var al={},wa=Kl(al),Fa=Kl(!1),Pc=al;function Cu(h,m){var T=h.type.contextTypes;if(!T)return al;var D=h.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===m)return D.__reactInternalMemoizedMaskedChildContext;var G={},J;for(J in T)G[J]=m[J];return D&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=m,h.__reactInternalMemoizedMaskedChildContext=G),G}function Oa(h){return h=h.childContextTypes,h!=null}function Dd(){Un(Fa),Un(wa)}function Lp(h,m,T){if(wa.current!==al)throw Error(r(168));Pn(wa,m),Pn(Fa,T)}function dg(h,m,T){var D=h.stateNode;if(m=m.childContextTypes,typeof D.getChildContext!="function")return T;D=D.getChildContext();for(var G in D)if(!(G in m))throw Error(r(108,X(h)||"Unknown",G));return H({},T,D)}function Tu(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||al,Pc=wa.current,Pn(wa,h),Pn(Fa,Fa.current),!0}function D1(h,m,T){var D=h.stateNode;if(!D)throw Error(r(169));T?(h=dg(h,m,Pc),D.__reactInternalMemoizedMergedChildContext=h,Un(Fa),Un(wa),Pn(wa,h)):Un(Fa),Pn(Fa,T)}var il=null,Id=!1,fg=!1;function ch(h){il===null?il=[h]:il.push(h)}function ql(h){Id=!0,ch(h)}function Fc(){if(!fg&&il!==null){fg=!0;var h=0,m=Pt;try{var T=il;for(Pt=1;h<T.length;h++){var D=T[h];do D=D(!0);while(D!==null)}il=null,Id=!1}catch(G){throw il!==null&&(il=il.slice(h+1)),Te(yt,Fc),G}finally{Pt=m,fg=!1}}return null}var Za=[],Eu=0,Oc=null,Dc=0,ei=[],ti=0,Ic=null,qi=1,es="";function Nu(h,m){Za[Eu++]=Dc,Za[Eu++]=Oc,Oc=h,Dc=m}function I1(h,m,T){ei[ti++]=qi,ei[ti++]=es,ei[ti++]=Ic,Ic=h;var D=qi;h=es;var G=32-cr(D)-1;D&=~(1<<G),T+=1;var J=32-cr(m)+G;if(30<J){var de=G-G%5;J=(D&(1<<de)-1).toString(32),D>>=de,G-=de,qi=1<<32-cr(m)+G|T<<G|D,es=J+h}else qi=1<<J|T<<G|D,es=h}function Rd(h){h.return!==null&&(Nu(h,1),I1(h,1,0))}function ia(h){for(;h===Oc;)Oc=Za[--Eu],Za[Eu]=null,Dc=Za[--Eu],Za[Eu]=null;for(;h===Ic;)Ic=ei[--ti],ei[ti]=null,es=ei[--ti],ei[ti]=null,qi=ei[--ti],ei[ti]=null}var Yi=null,sr=null,Cn=!1,Xi=null;function Bp(h,m){var T=hl(5,null,null,0);T.elementType="DELETED",T.stateNode=m,T.return=h,m=h.deletions,m===null?(h.deletions=[T],h.flags|=16):m.push(T)}function R1(h,m){switch(h.tag){case 5:var T=h.type;return m=m.nodeType!==1||T.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(h.stateNode=m,Yi=h,sr=nl(m.firstChild),!0):!1;case 6:return m=h.pendingProps===""||m.nodeType!==3?null:m,m!==null?(h.stateNode=m,Yi=h,sr=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(T=Ic!==null?{id:qi,overflow:es}:null,h.memoizedState={dehydrated:m,treeContext:T,retryLane:1073741824},T=hl(18,null,null,0),T.stateNode=m,T.return=h,h.child=T,Yi=h,sr=null,!0):!1;default:return!1}}function Au(h){return(h.mode&1)!==0&&(h.flags&128)===0}function Md(h){if(Cn){var m=sr;if(m){var T=m;if(!R1(h,m)){if(Au(h))throw Error(r(418));m=nl(T.nextSibling);var D=Yi;m&&R1(h,m)?Bp(D,T):(h.flags=h.flags&-4097|2,Cn=!1,Yi=h)}}else{if(Au(h))throw Error(r(418));h.flags=h.flags&-4097|2,Cn=!1,Yi=h}}}function hg(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;Yi=h}function uh(h){if(h!==Yi)return!1;if(!Cn)return hg(h),Cn=!0,!1;var m;if((m=h.tag!==3)&&!(m=h.tag!==5)&&(m=h.type,m=m!=="head"&&m!=="body"&&!Rp(h.type,h.memoizedProps)),m&&(m=sr)){if(Au(h))throw $p(),Error(r(418));for(;m;)Bp(h,m),m=nl(m.nextSibling)}if(hg(h),h.tag===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));e:{for(h=h.nextSibling,m=0;h;){if(h.nodeType===8){var T=h.data;if(T==="/$"){if(m===0){sr=nl(h.nextSibling);break e}m--}else T!=="$"&&T!=="$!"&&T!=="$?"||m++}h=h.nextSibling}sr=null}}else sr=Yi?nl(h.stateNode.nextSibling):null;return!0}function $p(){for(var h=sr;h;)h=nl(h.nextSibling)}function ju(){sr=Yi=null,Cn=!1}function dh(h){Xi===null?Xi=[h]:Xi.push(h)}var Up=N.ReactCurrentBatchConfig;function vs(h,m,T){if(h=T.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(r(309));var D=T.stateNode}if(!D)throw Error(r(147,h));var G=D,J=""+h;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===J?m.ref:(m=function(de){var je=G.refs;de===null?delete je[J]:je[J]=de},m._stringRef=J,m)}if(typeof h!="string")throw Error(r(284));if(!T._owner)throw Error(r(290,h))}return h}function Ci(h,m){throw h=Object.prototype.toString.call(m),Error(r(31,h==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":h))}function Lo(h){var m=h._init;return m(h._payload)}function gg(h){function m(st,We){if(h){var it=st.deletions;it===null?(st.deletions=[We],st.flags|=16):it.push(We)}}function T(st,We){if(!h)return null;for(;We!==null;)m(st,We),We=We.sibling;return null}function D(st,We){for(st=new Map;We!==null;)We.key!==null?st.set(We.key,We):st.set(We.index,We),We=We.sibling;return st}function G(st,We){return st=nf(st,We),st.index=0,st.sibling=null,st}function J(st,We,it){return st.index=it,h?(it=st.alternate,it!==null?(it=it.index,it<We?(st.flags|=2,We):it):(st.flags|=2,We)):(st.flags|=1048576,We)}function de(st){return h&&st.alternate===null&&(st.flags|=2),st}function je(st,We,it,Qt){return We===null||We.tag!==6?(We=xS(it,st.mode,Qt),We.return=st,We):(We=G(We,it),We.return=st,We)}function Me(st,We,it,Qt){var br=it.type;return br===F?Ut(st,We,it.props.children,Qt,it.key):We!==null&&(We.elementType===br||typeof br=="object"&&br!==null&&br.$$typeof===te&&Lo(br)===We.type)?(Qt=G(We,it.props),Qt.ref=vs(st,We,it),Qt.return=st,Qt):(Qt=nw(it.type,it.key,it.props,null,st.mode,Qt),Qt.ref=vs(st,We,it),Qt.return=st,Qt)}function ft(st,We,it,Qt){return We===null||We.tag!==4||We.stateNode.containerInfo!==it.containerInfo||We.stateNode.implementation!==it.implementation?(We=yS(it,st.mode,Qt),We.return=st,We):(We=G(We,it.children||[]),We.return=st,We)}function Ut(st,We,it,Qt,br){return We===null||We.tag!==7?(We=bh(it,st.mode,Qt,br),We.return=st,We):(We=G(We,it),We.return=st,We)}function Gt(st,We,it){if(typeof We=="string"&&We!==""||typeof We=="number")return We=xS(""+We,st.mode,it),We.return=st,We;if(typeof We=="object"&&We!==null){switch(We.$$typeof){case E:return it=nw(We.type,We.key,We.props,null,st.mode,it),it.ref=vs(st,null,We),it.return=st,it;case P:return We=yS(We,st.mode,it),We.return=st,We;case te:var Qt=We._init;return Gt(st,Qt(We._payload),it)}if(pt(We)||M(We))return We=bh(We,st.mode,it,null),We.return=st,We;Ci(st,We)}return null}function $t(st,We,it,Qt){var br=We!==null?We.key:null;if(typeof it=="string"&&it!==""||typeof it=="number")return br!==null?null:je(st,We,""+it,Qt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case E:return it.key===br?Me(st,We,it,Qt):null;case P:return it.key===br?ft(st,We,it,Qt):null;case te:return br=it._init,$t(st,We,br(it._payload),Qt)}if(pt(it)||M(it))return br!==null?null:Ut(st,We,it,Qt,null);Ci(st,it)}return null}function ur(st,We,it,Qt,br){if(typeof Qt=="string"&&Qt!==""||typeof Qt=="number")return st=st.get(it)||null,je(We,st,""+Qt,br);if(typeof Qt=="object"&&Qt!==null){switch(Qt.$$typeof){case E:return st=st.get(Qt.key===null?it:Qt.key)||null,Me(We,st,Qt,br);case P:return st=st.get(Qt.key===null?it:Qt.key)||null,ft(We,st,Qt,br);case te:var Ar=Qt._init;return ur(st,We,it,Ar(Qt._payload),br)}if(pt(Qt)||M(Qt))return st=st.get(it)||null,Ut(We,st,Qt,br,null);Ci(We,Qt)}return null}function yr(st,We,it,Qt){for(var br=null,Ar=null,jr=We,Br=We=0,Ba=null;jr!==null&&Br<it.length;Br++){jr.index>Br?(Ba=jr,jr=null):Ba=jr.sibling;var vn=$t(st,jr,it[Br],Qt);if(vn===null){jr===null&&(jr=Ba);break}h&&jr&&vn.alternate===null&&m(st,jr),We=J(vn,We,Br),Ar===null?br=vn:Ar.sibling=vn,Ar=vn,jr=Ba}if(Br===it.length)return T(st,jr),Cn&&Nu(st,Br),br;if(jr===null){for(;Br<it.length;Br++)jr=Gt(st,it[Br],Qt),jr!==null&&(We=J(jr,We,Br),Ar===null?br=jr:Ar.sibling=jr,Ar=jr);return Cn&&Nu(st,Br),br}for(jr=D(st,jr);Br<it.length;Br++)Ba=ur(jr,st,Br,it[Br],Qt),Ba!==null&&(h&&Ba.alternate!==null&&jr.delete(Ba.key===null?Br:Ba.key),We=J(Ba,We,Br),Ar===null?br=Ba:Ar.sibling=Ba,Ar=Ba);return h&&jr.forEach(function(sf){return m(st,sf)}),Cn&&Nu(st,Br),br}function vr(st,We,it,Qt){var br=M(it);if(typeof br!="function")throw Error(r(150));if(it=br.call(it),it==null)throw Error(r(151));for(var Ar=br=null,jr=We,Br=We=0,Ba=null,vn=it.next();jr!==null&&!vn.done;Br++,vn=it.next()){jr.index>Br?(Ba=jr,jr=null):Ba=jr.sibling;var sf=$t(st,jr,vn.value,Qt);if(sf===null){jr===null&&(jr=Ba);break}h&&jr&&sf.alternate===null&&m(st,jr),We=J(sf,We,Br),Ar===null?br=sf:Ar.sibling=sf,Ar=sf,jr=Ba}if(vn.done)return T(st,jr),Cn&&Nu(st,Br),br;if(jr===null){for(;!vn.done;Br++,vn=it.next())vn=Gt(st,vn.value,Qt),vn!==null&&(We=J(vn,We,Br),Ar===null?br=vn:Ar.sibling=vn,Ar=vn);return Cn&&Nu(st,Br),br}for(jr=D(st,jr);!vn.done;Br++,vn=it.next())vn=ur(jr,st,Br,vn.value,Qt),vn!==null&&(h&&vn.alternate!==null&&jr.delete(vn.key===null?Br:vn.key),We=J(vn,We,Br),Ar===null?br=vn:Ar.sibling=vn,Ar=vn);return h&&jr.forEach(function(JV){return m(st,JV)}),Cn&&Nu(st,Br),br}function Xs(st,We,it,Qt){if(typeof it=="object"&&it!==null&&it.type===F&&it.key===null&&(it=it.props.children),typeof it=="object"&&it!==null){switch(it.$$typeof){case E:e:{for(var br=it.key,Ar=We;Ar!==null;){if(Ar.key===br){if(br=it.type,br===F){if(Ar.tag===7){T(st,Ar.sibling),We=G(Ar,it.props.children),We.return=st,st=We;break e}}else if(Ar.elementType===br||typeof br=="object"&&br!==null&&br.$$typeof===te&&Lo(br)===Ar.type){T(st,Ar.sibling),We=G(Ar,it.props),We.ref=vs(st,Ar,it),We.return=st,st=We;break e}T(st,Ar);break}else m(st,Ar);Ar=Ar.sibling}it.type===F?(We=bh(it.props.children,st.mode,Qt,it.key),We.return=st,st=We):(Qt=nw(it.type,it.key,it.props,null,st.mode,Qt),Qt.ref=vs(st,We,it),Qt.return=st,st=Qt)}return de(st);case P:e:{for(Ar=it.key;We!==null;){if(We.key===Ar)if(We.tag===4&&We.stateNode.containerInfo===it.containerInfo&&We.stateNode.implementation===it.implementation){T(st,We.sibling),We=G(We,it.children||[]),We.return=st,st=We;break e}else{T(st,We);break}else m(st,We);We=We.sibling}We=yS(it,st.mode,Qt),We.return=st,st=We}return de(st);case te:return Ar=it._init,Xs(st,We,Ar(it._payload),Qt)}if(pt(it))return yr(st,We,it,Qt);if(M(it))return vr(st,We,it,Qt);Ci(st,it)}return typeof it=="string"&&it!==""||typeof it=="number"?(it=""+it,We!==null&&We.tag===6?(T(st,We.sibling),We=G(We,it),We.return=st,st=We):(T(st,We),We=xS(it,st.mode,Qt),We.return=st,st=We),de(st)):T(st,We)}return Xs}var Pu=gg(!0),po=gg(!1),fh=Kl(null),Qi=null,Ld=null,mg=null;function pg(){mg=Ld=Qi=null}function xg(h){var m=fh.current;Un(fh),h._currentValue=m}function yg(h,m,T){for(;h!==null;){var D=h.alternate;if((h.childLanes&m)!==m?(h.childLanes|=m,D!==null&&(D.childLanes|=m)):D!==null&&(D.childLanes&m)!==m&&(D.childLanes|=m),h===T)break;h=h.return}}function Yl(h,m){Qi=h,mg=Ld=null,h=h.dependencies,h!==null&&h.firstContext!==null&&((h.lanes&m)!==0&&(re=!0),h.firstContext=null)}function ri(h){var m=h._currentValue;if(mg!==h)if(h={context:h,memoizedValue:m,next:null},Ld===null){if(Qi===null)throw Error(r(308));Ld=h,Qi.dependencies={lanes:0,firstContext:h}}else Ld=Ld.next=h;return m}var ol=null;function Bd(h){ol===null?ol=[h]:ol.push(h)}function hh(h,m,T,D){var G=m.interleaved;return G===null?(T.next=T,Bd(m)):(T.next=G.next,G.next=T),m.interleaved=T,Ji(h,D)}function Ji(h,m){h.lanes|=m;var T=h.alternate;for(T!==null&&(T.lanes|=m),T=h,h=h.return;h!==null;)h.childLanes|=m,T=h.alternate,T!==null&&(T.childLanes|=m),T=h,h=h.return;return T.tag===3?T.stateNode:null}var ll=!1;function gh(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vg(h,m){h=h.updateQueue,m.updateQueue===h&&(m.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function cl(h,m){return{eventTime:h,lane:m,tag:0,payload:null,callback:null,next:null}}function ul(h,m,T){var D=h.updateQueue;if(D===null)return null;if(D=D.shared,(pn&2)!==0){var G=D.pending;return G===null?m.next=m:(m.next=G.next,G.next=m),D.pending=m,Ji(h,T)}return G=D.interleaved,G===null?(m.next=m,Bd(D)):(m.next=G.next,G.next=m),D.interleaved=m,Ji(h,T)}function wg(h,m,T){if(m=m.updateQueue,m!==null&&(m=m.shared,(T&4194240)!==0)){var D=m.lanes;D&=h.pendingLanes,T|=D,m.lanes=T,Rt(h,T)}}function mh(h,m){var T=h.updateQueue,D=h.alternate;if(D!==null&&(D=D.updateQueue,T===D)){var G=null,J=null;if(T=T.firstBaseUpdate,T!==null){do{var de={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};J===null?G=J=de:J=J.next=de,T=T.next}while(T!==null);J===null?G=J=m:J=J.next=m}else G=J=m;T={baseState:D.baseState,firstBaseUpdate:G,lastBaseUpdate:J,shared:D.shared,effects:D.effects},h.updateQueue=T;return}h=T.lastBaseUpdate,h===null?T.firstBaseUpdate=m:h.next=m,T.lastBaseUpdate=m}function $d(h,m,T,D){var G=h.updateQueue;ll=!1;var J=G.firstBaseUpdate,de=G.lastBaseUpdate,je=G.shared.pending;if(je!==null){G.shared.pending=null;var Me=je,ft=Me.next;Me.next=null,de===null?J=ft:de.next=ft,de=Me;var Ut=h.alternate;Ut!==null&&(Ut=Ut.updateQueue,je=Ut.lastBaseUpdate,je!==de&&(je===null?Ut.firstBaseUpdate=ft:je.next=ft,Ut.lastBaseUpdate=Me))}if(J!==null){var Gt=G.baseState;de=0,Ut=ft=Me=null,je=J;do{var $t=je.lane,ur=je.eventTime;if((D&$t)===$t){Ut!==null&&(Ut=Ut.next={eventTime:ur,lane:0,tag:je.tag,payload:je.payload,callback:je.callback,next:null});e:{var yr=h,vr=je;switch($t=m,ur=T,vr.tag){case 1:if(yr=vr.payload,typeof yr=="function"){Gt=yr.call(ur,Gt,$t);break e}Gt=yr;break e;case 3:yr.flags=yr.flags&-65537|128;case 0:if(yr=vr.payload,$t=typeof yr=="function"?yr.call(ur,Gt,$t):yr,$t==null)break e;Gt=H({},Gt,$t);break e;case 2:ll=!0}}je.callback!==null&&je.lane!==0&&(h.flags|=64,$t=G.effects,$t===null?G.effects=[je]:$t.push(je))}else ur={eventTime:ur,lane:$t,tag:je.tag,payload:je.payload,callback:je.callback,next:null},Ut===null?(ft=Ut=ur,Me=Gt):Ut=Ut.next=ur,de|=$t;if(je=je.next,je===null){if(je=G.shared.pending,je===null)break;$t=je,je=$t.next,$t.next=null,G.lastBaseUpdate=$t,G.shared.pending=null}}while(!0);if(Ut===null&&(Me=Gt),G.baseState=Me,G.firstBaseUpdate=ft,G.lastBaseUpdate=Ut,m=G.shared.interleaved,m!==null){G=m;do de|=G.lane,G=G.next;while(G!==m)}else J===null&&(G.shared.lanes=0);yh|=de,h.lanes=de,h.memoizedState=Gt}}function hs(h,m,T){if(h=m.effects,m.effects=null,h!==null)for(m=0;m<h.length;m++){var D=h[m],G=D.callback;if(G!==null){if(D.callback=null,D=T,typeof G!="function")throw Error(r(191,G));G.call(D)}}}var qr={},Fn=Kl(qr),ts=Kl(qr),ws=Kl(qr);function Ks(h){if(h===qr)throw Error(r(174));return h}function Rc(h,m){switch(Pn(ws,m),Pn(ts,h),Pn(Fn,qr),h=m.nodeType,h){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:De(null,"");break;default:h=h===8?m.parentNode:m,m=h.namespaceURI||null,h=h.tagName,m=De(m,h)}Un(Fn),Pn(Fn,m)}function rs(){Un(Fn),Un(ts),Un(ws)}function Ud(h){Ks(ws.current);var m=Ks(Fn.current),T=De(m,h.type);m!==T&&(Pn(ts,h),Pn(Fn,T))}function Xl(h){ts.current===h&&(Un(Fn),Un(ts))}var zn=Kl(0);function zd(h){for(var m=h;m!==null;){if(m.tag===13){var T=m.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||T.data==="$?"||T.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var Fu=[];function Da(){for(var h=0;h<Fu.length;h++)Fu[h]._workInProgressVersionPrimary=null;Fu.length=0}var Wd=N.ReactCurrentDispatcher,ph=N.ReactCurrentBatchConfig,ni=0,An=null,gs=null,Es=null,Bo=!1,Mc=!1,xo=0,_g=0;function Ns(){throw Error(r(321))}function xh(h,m){if(m===null)return!1;for(var T=0;T<m.length&&T<h.length;T++)if(!ki(h[T],m[T]))return!1;return!0}function Hd(h,m,T,D,G,J){if(ni=J,An=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,Wd.current=h===null||h.memoizedState===null?J2:$c,h=T(D,G),Mc){J=0;do{if(Mc=!1,xo=0,25<=J)throw Error(r(301));J+=1,Es=gs=null,m.updateQueue=null,Wd.current=Tg,h=T(D,G)}while(Mc)}if(Wd.current=qd,m=gs!==null&&gs.next!==null,ni=0,Es=gs=An=null,Bo=!1,m)throw Error(r(300));return h}function Gd(){var h=xo!==0;return xo=0,h}function qn(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Es===null?An.memoizedState=Es=h:Es=Es.next=h,Es}function qs(){if(gs===null){var h=An.alternate;h=h!==null?h.memoizedState:null}else h=gs.next;var m=Es===null?An.memoizedState:Es.next;if(m!==null)Es=m,gs=h;else{if(h===null)throw Error(r(310));gs=h,h={memoizedState:gs.memoizedState,baseState:gs.baseState,baseQueue:gs.baseQueue,queue:gs.queue,next:null},Es===null?An.memoizedState=Es=h:Es=Es.next=h}return Es}function Ia(h,m){return typeof m=="function"?m(h):m}function Ra(h){var m=qs(),T=m.queue;if(T===null)throw Error(r(311));T.lastRenderedReducer=h;var D=gs,G=D.baseQueue,J=T.pending;if(J!==null){if(G!==null){var de=G.next;G.next=J.next,J.next=de}D.baseQueue=G=J,T.pending=null}if(G!==null){J=G.next,D=D.baseState;var je=de=null,Me=null,ft=J;do{var Ut=ft.lane;if((ni&Ut)===Ut)Me!==null&&(Me=Me.next={lane:0,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null}),D=ft.hasEagerState?ft.eagerState:h(D,ft.action);else{var Gt={lane:Ut,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null};Me===null?(je=Me=Gt,de=D):Me=Me.next=Gt,An.lanes|=Ut,yh|=Ut}ft=ft.next}while(ft!==null&&ft!==J);Me===null?de=D:Me.next=je,ki(D,m.memoizedState)||(re=!0),m.memoizedState=D,m.baseState=de,m.baseQueue=Me,T.lastRenderedState=D}if(h=T.interleaved,h!==null){G=h;do J=G.lane,An.lanes|=J,yh|=J,G=G.next;while(G!==h)}else G===null&&(T.lanes=0);return[m.memoizedState,T.dispatch]}function bg(h){var m=qs(),T=m.queue;if(T===null)throw Error(r(311));T.lastRenderedReducer=h;var D=T.dispatch,G=T.pending,J=m.memoizedState;if(G!==null){T.pending=null;var de=G=G.next;do J=h(J,de.action),de=de.next;while(de!==G);ki(J,m.memoizedState)||(re=!0),m.memoizedState=J,m.baseQueue===null&&(m.baseState=J),T.lastRenderedState=J}return[J,D]}function Sg(){}function kg(h,m){var T=An,D=qs(),G=m(),J=!ki(D.memoizedState,G);if(J&&(D.memoizedState=G,re=!0),D=D.queue,Gp(zp.bind(null,T,D,h),[h]),D.getSnapshot!==m||J||Es!==null&&Es.memoizedState.tag&1){if(T.flags|=2048,Vd(9,Ql.bind(null,T,D,G,m),void 0,null),La===null)throw Error(r(349));(ni&30)!==0||M1(T,m,G)}return G}function M1(h,m,T){h.flags|=16384,h={getSnapshot:m,value:T},m=An.updateQueue,m===null?(m={lastEffect:null,stores:null},An.updateQueue=m,m.stores=[h]):(T=m.stores,T===null?m.stores=[h]:T.push(h))}function Ql(h,m,T,D){m.value=T,m.getSnapshot=D,Wp(m)&&Cg(h)}function zp(h,m,T){return T(function(){Wp(m)&&Cg(h)})}function Wp(h){var m=h.getSnapshot;h=h.value;try{var T=m();return!ki(h,T)}catch{return!0}}function Cg(h){var m=Ji(h,1);m!==null&&tc(m,h,1,-1)}function Lc(h){var m=qn();return typeof h=="function"&&(h=h()),m.memoizedState=m.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:h},m.queue=h,h=h.dispatch=W1.bind(null,An,h),[m.memoizedState,h]}function Vd(h,m,T,D){return h={tag:h,create:m,destroy:T,deps:D,next:null},m=An.updateQueue,m===null?(m={lastEffect:null,stores:null},An.updateQueue=m,m.lastEffect=h.next=h):(T=m.lastEffect,T===null?m.lastEffect=h.next=h:(D=T.next,T.next=h,h.next=D,m.lastEffect=h)),h}function Hp(){return qs().memoizedState}function Kd(h,m,T,D){var G=qn();An.flags|=h,G.memoizedState=Vd(1|m,T,void 0,D===void 0?null:D)}function Ou(h,m,T,D){var G=qs();D=D===void 0?null:D;var J=void 0;if(gs!==null){var de=gs.memoizedState;if(J=de.destroy,D!==null&&xh(D,de.deps)){G.memoizedState=Vd(m,T,J,D);return}}An.flags|=h,G.memoizedState=Vd(1|m,T,J,D)}function L1(h,m){return Kd(8390656,8,h,m)}function Gp(h,m){return Ou(2048,8,h,m)}function Vp(h,m){return Ou(4,2,h,m)}function Kp(h,m){return Ou(4,4,h,m)}function Bc(h,m){if(typeof m=="function")return h=h(),m(h),function(){m(null)};if(m!=null)return h=h(),m.current=h,function(){m.current=null}}function B1(h,m,T){return T=T!=null?T.concat([h]):null,Ou(4,4,Bc.bind(null,m,h),T)}function Jl(){}function qp(h,m){var T=qs();m=m===void 0?null:m;var D=T.memoizedState;return D!==null&&m!==null&&xh(m,D[1])?D[0]:(T.memoizedState=[h,m],h)}function Yn(h,m){var T=qs();m=m===void 0?null:m;var D=T.memoizedState;return D!==null&&m!==null&&xh(m,D[1])?D[0]:(h=h(),T.memoizedState=[h,m],h)}function $1(h,m,T){return(ni&21)===0?(h.baseState&&(h.baseState=!1,re=!0),h.memoizedState=T):(ki(T,m)||(T=Vn(),An.lanes|=T,yh|=T,h.baseState=!0),m)}function U1(h,m){var T=Pt;Pt=T!==0&&4>T?T:4,h(!0);var D=ph.transition;ph.transition={};try{h(!1),m()}finally{Pt=T,ph.transition=D}}function z1(){return qs().memoizedState}function Q2(h,m,T){var D=tf(h);if(T={lane:D,action:T,hasEagerState:!1,eagerState:null,next:null},Yp(h))H1(m,T);else if(T=hh(h,m,T,D),T!==null){var G=eo();tc(T,h,D,G),Zi(T,m,D)}}function W1(h,m,T){var D=tf(h),G={lane:D,action:T,hasEagerState:!1,eagerState:null,next:null};if(Yp(h))H1(m,G);else{var J=h.alternate;if(h.lanes===0&&(J===null||J.lanes===0)&&(J=m.lastRenderedReducer,J!==null))try{var de=m.lastRenderedState,je=J(de,T);if(G.hasEagerState=!0,G.eagerState=je,ki(je,de)){var Me=m.interleaved;Me===null?(G.next=G,Bd(m)):(G.next=Me.next,Me.next=G),m.interleaved=G;return}}catch{}finally{}T=hh(h,m,G,D),T!==null&&(G=eo(),tc(T,h,D,G),Zi(T,m,D))}}function Yp(h){var m=h.alternate;return h===An||m!==null&&m===An}function H1(h,m){Mc=Bo=!0;var T=h.pending;T===null?m.next=m:(m.next=T.next,T.next=m),h.pending=m}function Zi(h,m,T){if((T&4194240)!==0){var D=m.lanes;D&=h.pendingLanes,T|=D,m.lanes=T,Rt(h,T)}}var qd={readContext:ri,useCallback:Ns,useContext:Ns,useEffect:Ns,useImperativeHandle:Ns,useInsertionEffect:Ns,useLayoutEffect:Ns,useMemo:Ns,useReducer:Ns,useRef:Ns,useState:Ns,useDebugValue:Ns,useDeferredValue:Ns,useTransition:Ns,useMutableSource:Ns,useSyncExternalStore:Ns,useId:Ns,unstable_isNewReconciler:!1},J2={readContext:ri,useCallback:function(h,m){return qn().memoizedState=[h,m===void 0?null:m],h},useContext:ri,useEffect:L1,useImperativeHandle:function(h,m,T){return T=T!=null?T.concat([h]):null,Kd(4194308,4,Bc.bind(null,m,h),T)},useLayoutEffect:function(h,m){return Kd(4194308,4,h,m)},useInsertionEffect:function(h,m){return Kd(4,2,h,m)},useMemo:function(h,m){var T=qn();return m=m===void 0?null:m,h=h(),T.memoizedState=[h,m],h},useReducer:function(h,m,T){var D=qn();return m=T!==void 0?T(m):m,D.memoizedState=D.baseState=m,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:m},D.queue=h,h=h.dispatch=Q2.bind(null,An,h),[D.memoizedState,h]},useRef:function(h){var m=qn();return h={current:h},m.memoizedState=h},useState:Lc,useDebugValue:Jl,useDeferredValue:function(h){return qn().memoizedState=h},useTransition:function(){var h=Lc(!1),m=h[0];return h=U1.bind(null,h[1]),qn().memoizedState=h,[m,h]},useMutableSource:function(){},useSyncExternalStore:function(h,m,T){var D=An,G=qn();if(Cn){if(T===void 0)throw Error(r(407));T=T()}else{if(T=m(),La===null)throw Error(r(349));(ni&30)!==0||M1(D,m,T)}G.memoizedState=T;var J={value:T,getSnapshot:m};return G.queue=J,L1(zp.bind(null,D,J,h),[h]),D.flags|=2048,Vd(9,Ql.bind(null,D,J,T,m),void 0,null),T},useId:function(){var h=qn(),m=La.identifierPrefix;if(Cn){var T=es,D=qi;T=(D&~(1<<32-cr(D)-1)).toString(32)+T,m=":"+m+"R"+T,T=xo++,0<T&&(m+="H"+T.toString(32)),m+=":"}else T=_g++,m=":"+m+"r"+T.toString(32)+":";return h.memoizedState=m},unstable_isNewReconciler:!1},$c={readContext:ri,useCallback:qp,useContext:ri,useEffect:Gp,useImperativeHandle:B1,useInsertionEffect:Vp,useLayoutEffect:Kp,useMemo:Yn,useReducer:Ra,useRef:Hp,useState:function(){return Ra(Ia)},useDebugValue:Jl,useDeferredValue:function(h){var m=qs();return $1(m,gs.memoizedState,h)},useTransition:function(){var h=Ra(Ia)[0],m=qs().memoizedState;return[h,m]},useMutableSource:Sg,useSyncExternalStore:kg,useId:z1,unstable_isNewReconciler:!1},Tg={readContext:ri,useCallback:qp,useContext:ri,useEffect:Gp,useImperativeHandle:B1,useInsertionEffect:Vp,useLayoutEffect:Kp,useMemo:Yn,useReducer:bg,useRef:Hp,useState:function(){return bg(Ia)},useDebugValue:Jl,useDeferredValue:function(h){var m=qs();return gs===null?m.memoizedState=h:$1(m,gs.memoizedState,h)},useTransition:function(){var h=bg(Ia)[0],m=qs().memoizedState;return[h,m]},useMutableSource:Sg,useSyncExternalStore:kg,useId:z1,unstable_isNewReconciler:!1};function _a(h,m){if(h&&h.defaultProps){m=H({},m),h=h.defaultProps;for(var T in h)m[T]===void 0&&(m[T]=h[T]);return m}return m}function Yd(h,m,T,D){m=h.memoizedState,T=T(D,m),T=T==null?m:H({},m,T),h.memoizedState=T,h.lanes===0&&(h.updateQueue.baseState=T)}var Xd={isMounted:function(h){return(h=h._reactInternals)?Se(h)===h:!1},enqueueSetState:function(h,m,T){h=h._reactInternals;var D=eo(),G=tf(h),J=cl(D,G);J.payload=m,T!=null&&(J.callback=T),m=ul(h,J,G),m!==null&&(tc(m,h,G,D),wg(m,h,G))},enqueueReplaceState:function(h,m,T){h=h._reactInternals;var D=eo(),G=tf(h),J=cl(D,G);J.tag=1,J.payload=m,T!=null&&(J.callback=T),m=ul(h,J,G),m!==null&&(tc(m,h,G,D),wg(m,h,G))},enqueueForceUpdate:function(h,m){h=h._reactInternals;var T=eo(),D=tf(h),G=cl(T,D);G.tag=2,m!=null&&(G.callback=m),m=ul(h,G,D),m!==null&&(tc(m,h,D,T),wg(m,h,D))}};function Eg(h,m,T,D,G,J,de){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(D,J,de):m.prototype&&m.prototype.isPureReactComponent?!pu(T,D)||!pu(G,J):!0}function G1(h,m,T){var D=!1,G=al,J=m.contextType;return typeof J=="object"&&J!==null?J=ri(J):(G=Oa(m)?Pc:wa.current,D=m.contextTypes,J=(D=D!=null)?Cu(h,G):al),m=new m(T,J),h.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Xd,h.stateNode=m,m._reactInternals=h,D&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=G,h.__reactInternalMemoizedMaskedChildContext=J),m}function Xp(h,m,T,D){h=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(T,D),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(T,D),m.state!==h&&Xd.enqueueReplaceState(m,m.state,null)}function Ng(h,m,T,D){var G=h.stateNode;G.props=T,G.state=h.memoizedState,G.refs={},gh(h);var J=m.contextType;typeof J=="object"&&J!==null?G.context=ri(J):(J=Oa(m)?Pc:wa.current,G.context=Cu(h,J)),G.state=h.memoizedState,J=m.getDerivedStateFromProps,typeof J=="function"&&(Yd(h,m,J,T),G.state=h.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof G.getSnapshotBeforeUpdate=="function"||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(m=G.state,typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount(),m!==G.state&&Xd.enqueueReplaceState(G,G.state,null),$d(h,T,G,D),G.state=h.memoizedState),typeof G.componentDidMount=="function"&&(h.flags|=4194308)}function Du(h,m){try{var T="",D=m;do T+=Q(D),D=D.return;while(D);var G=T}catch(J){G=`
Error generating stack: `+J.message+`
`+J.stack}return{value:h,source:m,stack:G,digest:null}}function Ag(h,m,T){return{value:h,source:null,stack:T??null,digest:m??null}}function Qd(h,m){try{console.error(m.value)}catch(T){setTimeout(function(){throw T})}}var Z2=typeof WeakMap=="function"?WeakMap:Map;function V1(h,m,T){T=cl(-1,T),T.tag=3,T.payload={element:null};var D=m.value;return T.callback=function(){Q1||(Q1=!0,cS=D),Qd(h,m)},T}function y(h,m,T){T=cl(-1,T),T.tag=3;var D=h.type.getDerivedStateFromError;if(typeof D=="function"){var G=m.value;T.payload=function(){return D(G)},T.callback=function(){Qd(h,m)}}var J=h.stateNode;return J!==null&&typeof J.componentDidCatch=="function"&&(T.callback=function(){Qd(h,m),typeof D!="function"&&(Zd===null?Zd=new Set([this]):Zd.add(this));var de=m.stack;this.componentDidCatch(m.value,{componentStack:de!==null?de:""})}),T}function b(h,m,T){var D=h.pingCache;if(D===null){D=h.pingCache=new Z2;var G=new Set;D.set(m,G)}else G=D.get(m),G===void 0&&(G=new Set,D.set(m,G));G.has(T)||(G.add(T),h=UV.bind(null,h,m,T),m.then(h,h))}function O(h){do{var m;if((m=h.tag===13)&&(m=h.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return h;h=h.return}while(h!==null);return null}function U(h,m,T,D,G){return(h.mode&1)===0?(h===m?h.flags|=65536:(h.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(m=cl(-1,1),m.tag=2,ul(T,m,1))),T.lanes|=1),h):(h.flags|=65536,h.lanes=G,h)}var q=N.ReactCurrentOwner,re=!1;function ve(h,m,T,D){m.child=h===null?po(m,null,T,D):Pu(m,h.child,T,D)}function Ve(h,m,T,D,G){T=T.render;var J=m.ref;return Yl(m,G),D=Hd(h,m,T,D,J,G),T=Gd(),h!==null&&!re?(m.updateQueue=h.updateQueue,m.flags&=-2053,h.lanes&=~G,Ma(h,m,G)):(Cn&&T&&Rd(m),m.flags|=1,ve(h,m,D,G),m.child)}function gt(h,m,T,D,G){if(h===null){var J=T.type;return typeof J=="function"&&!pS(J)&&J.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(m.tag=15,m.type=J,Vt(h,m,J,D,G)):(h=nw(T.type,null,D,m,m.mode,G),h.ref=m.ref,h.return=m,m.child=h)}if(J=h.child,(h.lanes&G)===0){var de=J.memoizedProps;if(T=T.compare,T=T!==null?T:pu,T(de,D)&&h.ref===m.ref)return Ma(h,m,G)}return m.flags|=1,h=nf(J,D),h.ref=m.ref,h.return=m,m.child=h}function Vt(h,m,T,D,G){if(h!==null){var J=h.memoizedProps;if(pu(J,D)&&h.ref===m.ref)if(re=!1,m.pendingProps=D=J,(h.lanes&G)!==0)(h.flags&131072)!==0&&(re=!0);else return m.lanes=h.lanes,Ma(h,m,G)}return ar(h,m,T,D,G)}function gr(h,m,T){var D=m.pendingProps,G=D.children,J=h!==null?h.memoizedState:null;if(D.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pn(Pg,$o),$o|=T;else{if((T&1073741824)===0)return h=J!==null?J.baseLanes|T:T,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:h,cachePool:null,transitions:null},m.updateQueue=null,Pn(Pg,$o),$o|=h,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},D=J!==null?J.baseLanes:T,Pn(Pg,$o),$o|=D}else J!==null?(D=J.baseLanes|T,m.memoizedState=null):D=T,Pn(Pg,$o),$o|=D;return ve(h,m,G,T),m.child}function Ur(h,m){var T=m.ref;(h===null&&T!==null||h!==null&&h.ref!==T)&&(m.flags|=512,m.flags|=2097152)}function ar(h,m,T,D,G){var J=Oa(T)?Pc:wa.current;return J=Cu(m,J),Yl(m,G),T=Hd(h,m,T,D,J,G),D=Gd(),h!==null&&!re?(m.updateQueue=h.updateQueue,m.flags&=-2053,h.lanes&=~G,Ma(h,m,G)):(Cn&&D&&Rd(m),m.flags|=1,ve(h,m,T,G),m.child)}function Wn(h,m,T,D,G){if(Oa(T)){var J=!0;Tu(m)}else J=!1;if(Yl(m,G),m.stateNode===null)an(h,m),G1(m,T,D),Ng(m,T,D,G),D=!0;else if(h===null){var de=m.stateNode,je=m.memoizedProps;de.props=je;var Me=de.context,ft=T.contextType;typeof ft=="object"&&ft!==null?ft=ri(ft):(ft=Oa(T)?Pc:wa.current,ft=Cu(m,ft));var Ut=T.getDerivedStateFromProps,Gt=typeof Ut=="function"||typeof de.getSnapshotBeforeUpdate=="function";Gt||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(je!==D||Me!==ft)&&Xp(m,de,D,ft),ll=!1;var $t=m.memoizedState;de.state=$t,$d(m,D,de,G),Me=m.memoizedState,je!==D||$t!==Me||Fa.current||ll?(typeof Ut=="function"&&(Yd(m,T,Ut,D),Me=m.memoizedState),(je=ll||Eg(m,T,je,D,$t,Me,ft))?(Gt||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount()),typeof de.componentDidMount=="function"&&(m.flags|=4194308)):(typeof de.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=D,m.memoizedState=Me),de.props=D,de.state=Me,de.context=ft,D=je):(typeof de.componentDidMount=="function"&&(m.flags|=4194308),D=!1)}else{de=m.stateNode,vg(h,m),je=m.memoizedProps,ft=m.type===m.elementType?je:_a(m.type,je),de.props=ft,Gt=m.pendingProps,$t=de.context,Me=T.contextType,typeof Me=="object"&&Me!==null?Me=ri(Me):(Me=Oa(T)?Pc:wa.current,Me=Cu(m,Me));var ur=T.getDerivedStateFromProps;(Ut=typeof ur=="function"||typeof de.getSnapshotBeforeUpdate=="function")||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(je!==Gt||$t!==Me)&&Xp(m,de,D,Me),ll=!1,$t=m.memoizedState,de.state=$t,$d(m,D,de,G);var yr=m.memoizedState;je!==Gt||$t!==yr||Fa.current||ll?(typeof ur=="function"&&(Yd(m,T,ur,D),yr=m.memoizedState),(ft=ll||Eg(m,T,ft,D,$t,yr,Me)||!1)?(Ut||typeof de.UNSAFE_componentWillUpdate!="function"&&typeof de.componentWillUpdate!="function"||(typeof de.componentWillUpdate=="function"&&de.componentWillUpdate(D,yr,Me),typeof de.UNSAFE_componentWillUpdate=="function"&&de.UNSAFE_componentWillUpdate(D,yr,Me)),typeof de.componentDidUpdate=="function"&&(m.flags|=4),typeof de.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof de.componentDidUpdate!="function"||je===h.memoizedProps&&$t===h.memoizedState||(m.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||je===h.memoizedProps&&$t===h.memoizedState||(m.flags|=1024),m.memoizedProps=D,m.memoizedState=yr),de.props=D,de.state=yr,de.context=Me,D=ft):(typeof de.componentDidUpdate!="function"||je===h.memoizedProps&&$t===h.memoizedState||(m.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||je===h.memoizedProps&&$t===h.memoizedState||(m.flags|=1024),D=!1)}return Tn(h,m,T,D,J,G)}function Tn(h,m,T,D,G,J){Ur(h,m);var de=(m.flags&128)!==0;if(!D&&!de)return G&&D1(m,T,!1),Ma(h,m,J);D=m.stateNode,q.current=m;var je=de&&typeof T.getDerivedStateFromError!="function"?null:D.render();return m.flags|=1,h!==null&&de?(m.child=Pu(m,h.child,null,J),m.child=Pu(m,null,je,J)):ve(h,m,je,J),m.memoizedState=D.state,G&&D1(m,T,!0),m.child}function si(h){var m=h.stateNode;m.pendingContext?Lp(h,m.pendingContext,m.pendingContext!==m.context):m.context&&Lp(h,m.context,!1),Rc(h,m.containerInfo)}function dl(h,m,T,D,G){return ju(),dh(G),m.flags|=256,ve(h,m,T,D),m.child}var ut={dehydrated:null,treeContext:null,retryLane:0};function Qe(h){return{baseLanes:h,cachePool:null,transitions:null}}function vt(h,m,T){var D=m.pendingProps,G=zn.current,J=!1,de=(m.flags&128)!==0,je;if((je=de)||(je=h!==null&&h.memoizedState===null?!1:(G&2)!==0),je?(J=!0,m.flags&=-129):(h===null||h.memoizedState!==null)&&(G|=1),Pn(zn,G&1),h===null)return Md(m),h=m.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?((m.mode&1)===0?m.lanes=1:h.data==="$!"?m.lanes=8:m.lanes=1073741824,null):(de=D.children,h=D.fallback,J?(D=m.mode,J=m.child,de={mode:"hidden",children:de},(D&1)===0&&J!==null?(J.childLanes=0,J.pendingProps=de):J=sw(de,D,0,null),h=bh(h,D,T,null),J.return=m,h.return=m,J.sibling=h,m.child=J,m.child.memoizedState=Qe(T),m.memoizedState=ut,h):ir(m,de));if(G=h.memoizedState,G!==null&&(je=G.dehydrated,je!==null))return Qr(h,m,de,D,je,G,T);if(J){J=D.fallback,de=m.mode,G=h.child,je=G.sibling;var Me={mode:"hidden",children:D.children};return(de&1)===0&&m.child!==G?(D=m.child,D.childLanes=0,D.pendingProps=Me,m.deletions=null):(D=nf(G,Me),D.subtreeFlags=G.subtreeFlags&14680064),je!==null?J=nf(je,J):(J=bh(J,de,T,null),J.flags|=2),J.return=m,D.return=m,D.sibling=J,m.child=D,D=J,J=m.child,de=h.child.memoizedState,de=de===null?Qe(T):{baseLanes:de.baseLanes|T,cachePool:null,transitions:de.transitions},J.memoizedState=de,J.childLanes=h.childLanes&~T,m.memoizedState=ut,D}return J=h.child,h=J.sibling,D=nf(J,{mode:"visible",children:D.children}),(m.mode&1)===0&&(D.lanes=T),D.return=m,D.sibling=null,h!==null&&(T=m.deletions,T===null?(m.deletions=[h],m.flags|=16):T.push(h)),m.child=D,m.memoizedState=null,D}function ir(h,m){return m=sw({mode:"visible",children:m},h.mode,0,null),m.return=h,h.child=m}function Cr(h,m,T,D){return D!==null&&dh(D),Pu(m,h.child,null,T),h=ir(m,m.pendingProps.children),h.flags|=2,m.memoizedState=null,h}function Qr(h,m,T,D,G,J,de){if(T)return m.flags&256?(m.flags&=-257,D=Ag(Error(r(422))),Cr(h,m,de,D)):m.memoizedState!==null?(m.child=h.child,m.flags|=128,null):(J=D.fallback,G=m.mode,D=sw({mode:"visible",children:D.children},G,0,null),J=bh(J,G,de,null),J.flags|=2,D.return=m,J.return=m,D.sibling=J,m.child=D,(m.mode&1)!==0&&Pu(m,h.child,null,de),m.child.memoizedState=Qe(de),m.memoizedState=ut,J);if((m.mode&1)===0)return Cr(h,m,de,null);if(G.data==="$!"){if(D=G.nextSibling&&G.nextSibling.dataset,D)var je=D.dgst;return D=je,J=Error(r(419)),D=Ag(J,D,void 0),Cr(h,m,de,D)}if(je=(de&h.childLanes)!==0,re||je){if(D=La,D!==null){switch(de&-de){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}G=(G&(D.suspendedLanes|de))!==0?0:G,G!==0&&G!==J.retryLane&&(J.retryLane=G,Ji(h,G),tc(D,h,G,-1))}return mS(),D=Ag(Error(r(421))),Cr(h,m,de,D)}return G.data==="$?"?(m.flags|=128,m.child=h.child,m=zV.bind(null,h),G._reactRetry=m,null):(h=J.treeContext,sr=nl(G.nextSibling),Yi=m,Cn=!0,Xi=null,h!==null&&(ei[ti++]=qi,ei[ti++]=es,ei[ti++]=Ic,qi=h.id,es=h.overflow,Ic=m),m=ir(m,D.children),m.flags|=4096,m)}function zr(h,m,T){h.lanes|=m;var D=h.alternate;D!==null&&(D.lanes|=m),yg(h.return,m,T)}function ln(h,m,T,D,G){var J=h.memoizedState;J===null?h.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:D,tail:T,tailMode:G}:(J.isBackwards=m,J.rendering=null,J.renderingStartTime=0,J.last=D,J.tail=T,J.tailMode=G)}function Ys(h,m,T){var D=m.pendingProps,G=D.revealOrder,J=D.tail;if(ve(h,m,D.children,T),D=zn.current,(D&2)!==0)D=D&1|2,m.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=m.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&zr(h,T,m);else if(h.tag===19)zr(h,T,m);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===m)break e;for(;h.sibling===null;){if(h.return===null||h.return===m)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}D&=1}if(Pn(zn,D),(m.mode&1)===0)m.memoizedState=null;else switch(G){case"forwards":for(T=m.child,G=null;T!==null;)h=T.alternate,h!==null&&zd(h)===null&&(G=T),T=T.sibling;T=G,T===null?(G=m.child,m.child=null):(G=T.sibling,T.sibling=null),ln(m,!1,G,T,J);break;case"backwards":for(T=null,G=m.child,m.child=null;G!==null;){if(h=G.alternate,h!==null&&zd(h)===null){m.child=G;break}h=G.sibling,G.sibling=T,T=G,G=h}ln(m,!0,T,null,J);break;case"together":ln(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function an(h,m){(m.mode&1)===0&&h!==null&&(h.alternate=null,m.alternate=null,m.flags|=2)}function Ma(h,m,T){if(h!==null&&(m.dependencies=h.dependencies),yh|=m.lanes,(T&m.childLanes)===0)return null;if(h!==null&&m.child!==h.child)throw Error(r(153));if(m.child!==null){for(h=m.child,T=nf(h,h.pendingProps),m.child=T,T.return=m;h.sibling!==null;)h=h.sibling,T=T.sibling=nf(h,h.pendingProps),T.return=m;T.sibling=null}return m.child}function eS(h,m,T){switch(m.tag){case 3:si(m),ju();break;case 5:Ud(m);break;case 1:Oa(m.type)&&Tu(m);break;case 4:Rc(m,m.stateNode.containerInfo);break;case 10:var D=m.type._context,G=m.memoizedProps.value;Pn(fh,D._currentValue),D._currentValue=G;break;case 13:if(D=m.memoizedState,D!==null)return D.dehydrated!==null?(Pn(zn,zn.current&1),m.flags|=128,null):(T&m.child.childLanes)!==0?vt(h,m,T):(Pn(zn,zn.current&1),h=Ma(h,m,T),h!==null?h.sibling:null);Pn(zn,zn.current&1);break;case 19:if(D=(T&m.childLanes)!==0,(h.flags&128)!==0){if(D)return Ys(h,m,T);m.flags|=128}if(G=m.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),Pn(zn,zn.current),D)break;return null;case 22:case 23:return m.lanes=0,gr(h,m,T)}return Ma(h,m,T)}var dj,tS,fj,hj;dj=function(h,m){for(var T=m.child;T!==null;){if(T.tag===5||T.tag===6)h.appendChild(T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===m)break;for(;T.sibling===null;){if(T.return===null||T.return===m)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},tS=function(){},fj=function(h,m,T,D){var G=h.memoizedProps;if(G!==D){h=m.stateNode,Ks(Fn.current);var J=null;switch(T){case"input":G=Ce(h,G),D=Ce(h,D),J=[];break;case"select":G=H({},G,{value:void 0}),D=H({},D,{value:void 0}),J=[];break;case"textarea":G=rt(h,G),D=rt(h,D),J=[];break;default:typeof G.onClick!="function"&&typeof D.onClick=="function"&&(h.onclick=bu)}dr(T,D);var de;T=null;for(ft in G)if(!D.hasOwnProperty(ft)&&G.hasOwnProperty(ft)&&G[ft]!=null)if(ft==="style"){var je=G[ft];for(de in je)je.hasOwnProperty(de)&&(T||(T={}),T[de]="")}else ft!=="dangerouslySetInnerHTML"&&ft!=="children"&&ft!=="suppressContentEditableWarning"&&ft!=="suppressHydrationWarning"&&ft!=="autoFocus"&&(s.hasOwnProperty(ft)?J||(J=[]):(J=J||[]).push(ft,null));for(ft in D){var Me=D[ft];if(je=G?.[ft],D.hasOwnProperty(ft)&&Me!==je&&(Me!=null||je!=null))if(ft==="style")if(je){for(de in je)!je.hasOwnProperty(de)||Me&&Me.hasOwnProperty(de)||(T||(T={}),T[de]="");for(de in Me)Me.hasOwnProperty(de)&&je[de]!==Me[de]&&(T||(T={}),T[de]=Me[de])}else T||(J||(J=[]),J.push(ft,T)),T=Me;else ft==="dangerouslySetInnerHTML"?(Me=Me?Me.__html:void 0,je=je?je.__html:void 0,Me!=null&&je!==Me&&(J=J||[]).push(ft,Me)):ft==="children"?typeof Me!="string"&&typeof Me!="number"||(J=J||[]).push(ft,""+Me):ft!=="suppressContentEditableWarning"&&ft!=="suppressHydrationWarning"&&(s.hasOwnProperty(ft)?(Me!=null&&ft==="onScroll"&&$n("scroll",h),J||je===Me||(J=[])):(J=J||[]).push(ft,Me))}T&&(J=J||[]).push("style",T);var ft=J;(m.updateQueue=ft)&&(m.flags|=4)}},hj=function(h,m,T,D){T!==D&&(m.flags|=4)};function Qp(h,m){if(!Cn)switch(h.tailMode){case"hidden":m=h.tail;for(var T=null;m!==null;)m.alternate!==null&&(T=m),m=m.sibling;T===null?h.tail=null:T.sibling=null;break;case"collapsed":T=h.tail;for(var D=null;T!==null;)T.alternate!==null&&(D=T),T=T.sibling;D===null?m||h.tail===null?h.tail=null:h.tail.sibling=null:D.sibling=null}}function Ti(h){var m=h.alternate!==null&&h.alternate.child===h.child,T=0,D=0;if(m)for(var G=h.child;G!==null;)T|=G.lanes|G.childLanes,D|=G.subtreeFlags&14680064,D|=G.flags&14680064,G.return=h,G=G.sibling;else for(G=h.child;G!==null;)T|=G.lanes|G.childLanes,D|=G.subtreeFlags,D|=G.flags,G.return=h,G=G.sibling;return h.subtreeFlags|=D,h.childLanes=T,m}function PV(h,m,T){var D=m.pendingProps;switch(ia(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ti(m),null;case 1:return Oa(m.type)&&Dd(),Ti(m),null;case 3:return D=m.stateNode,rs(),Un(Fa),Un(wa),Da(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(h===null||h.child===null)&&(uh(m)?m.flags|=4:h===null||h.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,Xi!==null&&(fS(Xi),Xi=null))),tS(h,m),Ti(m),null;case 5:Xl(m);var G=Ks(ws.current);if(T=m.type,h!==null&&m.stateNode!=null)fj(h,m,T,D,G),h.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!D){if(m.stateNode===null)throw Error(r(166));return Ti(m),null}if(h=Ks(Fn.current),uh(m)){D=m.stateNode,T=m.type;var J=m.memoizedProps;switch(D[mo]=m,D[oh]=J,h=(m.mode&1)!==0,T){case"dialog":$n("cancel",D),$n("close",D);break;case"iframe":case"object":case"embed":$n("load",D);break;case"video":case"audio":for(G=0;G<Nc.length;G++)$n(Nc[G],D);break;case"source":$n("error",D);break;case"img":case"image":case"link":$n("error",D),$n("load",D);break;case"details":$n("toggle",D);break;case"input":Ae(D,J),$n("invalid",D);break;case"select":D._wrapperState={wasMultiple:!!J.multiple},$n("invalid",D);break;case"textarea":ht(D,J),$n("invalid",D)}dr(T,J),G=null;for(var de in J)if(J.hasOwnProperty(de)){var je=J[de];de==="children"?typeof je=="string"?D.textContent!==je&&(J.suppressHydrationWarning!==!0&&ah(D.textContent,je,h),G=["children",je]):typeof je=="number"&&D.textContent!==""+je&&(J.suppressHydrationWarning!==!0&&ah(D.textContent,je,h),G=["children",""+je]):s.hasOwnProperty(de)&&je!=null&&de==="onScroll"&&$n("scroll",D)}switch(T){case"input":_e(D),At(D,J,!0);break;case"textarea":_e(D),zt(D);break;case"select":case"option":break;default:typeof J.onClick=="function"&&(D.onclick=bu)}D=G,m.updateQueue=D,D!==null&&(m.flags|=4)}else{de=G.nodeType===9?G:G.ownerDocument,h==="http://www.w3.org/1999/xhtml"&&(h=Dt(T)),h==="http://www.w3.org/1999/xhtml"?T==="script"?(h=de.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild)):typeof D.is=="string"?h=de.createElement(T,{is:D.is}):(h=de.createElement(T),T==="select"&&(de=h,D.multiple?de.multiple=!0:D.size&&(de.size=D.size))):h=de.createElementNS(h,T),h[mo]=m,h[oh]=D,dj(h,m,!1,!1),m.stateNode=h;e:{switch(de=Er(T,D),T){case"dialog":$n("cancel",h),$n("close",h),G=D;break;case"iframe":case"object":case"embed":$n("load",h),G=D;break;case"video":case"audio":for(G=0;G<Nc.length;G++)$n(Nc[G],h);G=D;break;case"source":$n("error",h),G=D;break;case"img":case"image":case"link":$n("error",h),$n("load",h),G=D;break;case"details":$n("toggle",h),G=D;break;case"input":Ae(h,D),G=Ce(h,D),$n("invalid",h);break;case"option":G=D;break;case"select":h._wrapperState={wasMultiple:!!D.multiple},G=H({},D,{value:void 0}),$n("invalid",h);break;case"textarea":ht(h,D),G=rt(h,D),$n("invalid",h);break;default:G=D}dr(T,G),je=G;for(J in je)if(je.hasOwnProperty(J)){var Me=je[J];J==="style"?Wt(h,Me):J==="dangerouslySetInnerHTML"?(Me=Me?Me.__html:void 0,Me!=null&&Ke(h,Me)):J==="children"?typeof Me=="string"?(T!=="textarea"||Me!=="")&&Je(h,Me):typeof Me=="number"&&Je(h,""+Me):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(s.hasOwnProperty(J)?Me!=null&&J==="onScroll"&&$n("scroll",h):Me!=null&&_(h,J,Me,de))}switch(T){case"input":_e(h),At(h,D,!1);break;case"textarea":_e(h),zt(h);break;case"option":D.value!=null&&h.setAttribute("value",""+ie(D.value));break;case"select":h.multiple=!!D.multiple,J=D.value,J!=null?lt(h,!!D.multiple,J,!1):D.defaultValue!=null&&lt(h,!!D.multiple,D.defaultValue,!0);break;default:typeof G.onClick=="function"&&(h.onclick=bu)}switch(T){case"button":case"input":case"select":case"textarea":D=!!D.autoFocus;break e;case"img":D=!0;break e;default:D=!1}}D&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return Ti(m),null;case 6:if(h&&m.stateNode!=null)hj(h,m,h.memoizedProps,D);else{if(typeof D!="string"&&m.stateNode===null)throw Error(r(166));if(T=Ks(ws.current),Ks(Fn.current),uh(m)){if(D=m.stateNode,T=m.memoizedProps,D[mo]=m,(J=D.nodeValue!==T)&&(h=Yi,h!==null))switch(h.tag){case 3:ah(D.nodeValue,T,(h.mode&1)!==0);break;case 5:h.memoizedProps.suppressHydrationWarning!==!0&&ah(D.nodeValue,T,(h.mode&1)!==0)}J&&(m.flags|=4)}else D=(T.nodeType===9?T:T.ownerDocument).createTextNode(D),D[mo]=m,m.stateNode=D}return Ti(m),null;case 13:if(Un(zn),D=m.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(Cn&&sr!==null&&(m.mode&1)!==0&&(m.flags&128)===0)$p(),ju(),m.flags|=98560,J=!1;else if(J=uh(m),D!==null&&D.dehydrated!==null){if(h===null){if(!J)throw Error(r(318));if(J=m.memoizedState,J=J!==null?J.dehydrated:null,!J)throw Error(r(317));J[mo]=m}else ju(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Ti(m),J=!1}else Xi!==null&&(fS(Xi),Xi=null),J=!0;if(!J)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=T,m):(D=D!==null,D!==(h!==null&&h.memoizedState!==null)&&D&&(m.child.flags|=8192,(m.mode&1)!==0&&(h===null||(zn.current&1)!==0?ba===0&&(ba=3):mS())),m.updateQueue!==null&&(m.flags|=4),Ti(m),null);case 4:return rs(),tS(h,m),h===null&&wu(m.stateNode.containerInfo),Ti(m),null;case 10:return xg(m.type._context),Ti(m),null;case 17:return Oa(m.type)&&Dd(),Ti(m),null;case 19:if(Un(zn),J=m.memoizedState,J===null)return Ti(m),null;if(D=(m.flags&128)!==0,de=J.rendering,de===null)if(D)Qp(J,!1);else{if(ba!==0||h!==null&&(h.flags&128)!==0)for(h=m.child;h!==null;){if(de=zd(h),de!==null){for(m.flags|=128,Qp(J,!1),D=de.updateQueue,D!==null&&(m.updateQueue=D,m.flags|=4),m.subtreeFlags=0,D=T,T=m.child;T!==null;)J=T,h=D,J.flags&=14680066,de=J.alternate,de===null?(J.childLanes=0,J.lanes=h,J.child=null,J.subtreeFlags=0,J.memoizedProps=null,J.memoizedState=null,J.updateQueue=null,J.dependencies=null,J.stateNode=null):(J.childLanes=de.childLanes,J.lanes=de.lanes,J.child=de.child,J.subtreeFlags=0,J.deletions=null,J.memoizedProps=de.memoizedProps,J.memoizedState=de.memoizedState,J.updateQueue=de.updateQueue,J.type=de.type,h=de.dependencies,J.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),T=T.sibling;return Pn(zn,zn.current&1|2),m.child}h=h.sibling}J.tail!==null&&xt()>Fg&&(m.flags|=128,D=!0,Qp(J,!1),m.lanes=4194304)}else{if(!D)if(h=zd(de),h!==null){if(m.flags|=128,D=!0,T=h.updateQueue,T!==null&&(m.updateQueue=T,m.flags|=4),Qp(J,!0),J.tail===null&&J.tailMode==="hidden"&&!de.alternate&&!Cn)return Ti(m),null}else 2*xt()-J.renderingStartTime>Fg&&T!==1073741824&&(m.flags|=128,D=!0,Qp(J,!1),m.lanes=4194304);J.isBackwards?(de.sibling=m.child,m.child=de):(T=J.last,T!==null?T.sibling=de:m.child=de,J.last=de)}return J.tail!==null?(m=J.tail,J.rendering=m,J.tail=m.sibling,J.renderingStartTime=xt(),m.sibling=null,T=zn.current,Pn(zn,D?T&1|2:T&1),m):(Ti(m),null);case 22:case 23:return gS(),D=m.memoizedState!==null,h!==null&&h.memoizedState!==null!==D&&(m.flags|=8192),D&&(m.mode&1)!==0?($o&1073741824)!==0&&(Ti(m),m.subtreeFlags&6&&(m.flags|=8192)):Ti(m),null;case 24:return null;case 25:return null}throw Error(r(156,m.tag))}function FV(h,m){switch(ia(m),m.tag){case 1:return Oa(m.type)&&Dd(),h=m.flags,h&65536?(m.flags=h&-65537|128,m):null;case 3:return rs(),Un(Fa),Un(wa),Da(),h=m.flags,(h&65536)!==0&&(h&128)===0?(m.flags=h&-65537|128,m):null;case 5:return Xl(m),null;case 13:if(Un(zn),h=m.memoizedState,h!==null&&h.dehydrated!==null){if(m.alternate===null)throw Error(r(340));ju()}return h=m.flags,h&65536?(m.flags=h&-65537|128,m):null;case 19:return Un(zn),null;case 4:return rs(),null;case 10:return xg(m.type._context),null;case 22:case 23:return gS(),null;case 24:return null;default:return null}}var K1=!1,Ei=!1,OV=typeof WeakSet=="function"?WeakSet:Set,mr=null;function jg(h,m){var T=h.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(D){As(h,m,D)}else T.current=null}function rS(h,m,T){try{T()}catch(D){As(h,m,D)}}var gj=!1;function DV(h,m){if(Dp=W0,h=Gs(),jd(h)){if("selectionStart"in h)var T={start:h.selectionStart,end:h.selectionEnd};else e:{T=(T=h.ownerDocument)&&T.defaultView||window;var D=T.getSelection&&T.getSelection();if(D&&D.rangeCount!==0){T=D.anchorNode;var G=D.anchorOffset,J=D.focusNode;D=D.focusOffset;try{T.nodeType,J.nodeType}catch{T=null;break e}var de=0,je=-1,Me=-1,ft=0,Ut=0,Gt=h,$t=null;t:for(;;){for(var ur;Gt!==T||G!==0&&Gt.nodeType!==3||(je=de+G),Gt!==J||D!==0&&Gt.nodeType!==3||(Me=de+D),Gt.nodeType===3&&(de+=Gt.nodeValue.length),(ur=Gt.firstChild)!==null;)$t=Gt,Gt=ur;for(;;){if(Gt===h)break t;if($t===T&&++ft===G&&(je=de),$t===J&&++Ut===D&&(Me=de),(ur=Gt.nextSibling)!==null)break;Gt=$t,$t=Gt.parentNode}Gt=ur}T=je===-1||Me===-1?null:{start:je,end:Me}}else T=null}T=T||{start:0,end:0}}else T=null;for(Ip={focusedElem:h,selectionRange:T},W0=!1,mr=m;mr!==null;)if(m=mr,h=m.child,(m.subtreeFlags&1028)!==0&&h!==null)h.return=m,mr=h;else for(;mr!==null;){m=mr;try{var yr=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(yr!==null){var vr=yr.memoizedProps,Xs=yr.memoizedState,st=m.stateNode,We=st.getSnapshotBeforeUpdate(m.elementType===m.type?vr:_a(m.type,vr),Xs);st.__reactInternalSnapshotBeforeUpdate=We}break;case 3:var it=m.stateNode.containerInfo;it.nodeType===1?it.textContent="":it.nodeType===9&&it.documentElement&&it.removeChild(it.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Qt){As(m,m.return,Qt)}if(h=m.sibling,h!==null){h.return=m.return,mr=h;break}mr=m.return}return yr=gj,gj=!1,yr}function Jp(h,m,T){var D=m.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var G=D=D.next;do{if((G.tag&h)===h){var J=G.destroy;G.destroy=void 0,J!==void 0&&rS(m,T,J)}G=G.next}while(G!==D)}}function q1(h,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var T=m=m.next;do{if((T.tag&h)===h){var D=T.create;T.destroy=D()}T=T.next}while(T!==m)}}function nS(h){var m=h.ref;if(m!==null){var T=h.stateNode;switch(h.tag){case 5:h=T;break;default:h=T}typeof m=="function"?m(h):m.current=h}}function mj(h){var m=h.alternate;m!==null&&(h.alternate=null,mj(m)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(m=h.stateNode,m!==null&&(delete m[mo],delete m[oh],delete m[cg],delete m[F1],delete m[O1])),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function pj(h){return h.tag===5||h.tag===3||h.tag===4}function xj(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||pj(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function sS(h,m,T){var D=h.tag;if(D===5||D===6)h=h.stateNode,m?T.nodeType===8?T.parentNode.insertBefore(h,m):T.insertBefore(h,m):(T.nodeType===8?(m=T.parentNode,m.insertBefore(h,T)):(m=T,m.appendChild(h)),T=T._reactRootContainer,T!=null||m.onclick!==null||(m.onclick=bu));else if(D!==4&&(h=h.child,h!==null))for(sS(h,m,T),h=h.sibling;h!==null;)sS(h,m,T),h=h.sibling}function aS(h,m,T){var D=h.tag;if(D===5||D===6)h=h.stateNode,m?T.insertBefore(h,m):T.appendChild(h);else if(D!==4&&(h=h.child,h!==null))for(aS(h,m,T),h=h.sibling;h!==null;)aS(h,m,T),h=h.sibling}var ai=null,Zl=!1;function Jd(h,m,T){for(T=T.child;T!==null;)yj(h,m,T),T=T.sibling}function yj(h,m,T){if(un&&typeof un.onCommitFiberUnmount=="function")try{un.onCommitFiberUnmount(Gr,T)}catch{}switch(T.tag){case 5:Ei||jg(T,m);case 6:var D=ai,G=Zl;ai=null,Jd(h,m,T),ai=D,Zl=G,ai!==null&&(Zl?(h=ai,T=T.stateNode,h.nodeType===8?h.parentNode.removeChild(T):h.removeChild(T)):ai.removeChild(T.stateNode));break;case 18:ai!==null&&(Zl?(h=ai,T=T.stateNode,h.nodeType===8?lg(h.parentNode,T):h.nodeType===1&&lg(h,T),bi(h)):lg(ai,T.stateNode));break;case 4:D=ai,G=Zl,ai=T.stateNode.containerInfo,Zl=!0,Jd(h,m,T),ai=D,Zl=G;break;case 0:case 11:case 14:case 15:if(!Ei&&(D=T.updateQueue,D!==null&&(D=D.lastEffect,D!==null))){G=D=D.next;do{var J=G,de=J.destroy;J=J.tag,de!==void 0&&((J&2)!==0||(J&4)!==0)&&rS(T,m,de),G=G.next}while(G!==D)}Jd(h,m,T);break;case 1:if(!Ei&&(jg(T,m),D=T.stateNode,typeof D.componentWillUnmount=="function"))try{D.props=T.memoizedProps,D.state=T.memoizedState,D.componentWillUnmount()}catch(je){As(T,m,je)}Jd(h,m,T);break;case 21:Jd(h,m,T);break;case 22:T.mode&1?(Ei=(D=Ei)||T.memoizedState!==null,Jd(h,m,T),Ei=D):Jd(h,m,T);break;default:Jd(h,m,T)}}function vj(h){var m=h.updateQueue;if(m!==null){h.updateQueue=null;var T=h.stateNode;T===null&&(T=h.stateNode=new OV),m.forEach(function(D){var G=WV.bind(null,h,D);T.has(D)||(T.add(D),D.then(G,G))})}}function ec(h,m){var T=m.deletions;if(T!==null)for(var D=0;D<T.length;D++){var G=T[D];try{var J=h,de=m,je=de;e:for(;je!==null;){switch(je.tag){case 5:ai=je.stateNode,Zl=!1;break e;case 3:ai=je.stateNode.containerInfo,Zl=!0;break e;case 4:ai=je.stateNode.containerInfo,Zl=!0;break e}je=je.return}if(ai===null)throw Error(r(160));yj(J,de,G),ai=null,Zl=!1;var Me=G.alternate;Me!==null&&(Me.return=null),G.return=null}catch(ft){As(G,m,ft)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)wj(m,h),m=m.sibling}function wj(h,m){var T=h.alternate,D=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:if(ec(m,h),Uc(h),D&4){try{Jp(3,h,h.return),q1(3,h)}catch(vr){As(h,h.return,vr)}try{Jp(5,h,h.return)}catch(vr){As(h,h.return,vr)}}break;case 1:ec(m,h),Uc(h),D&512&&T!==null&&jg(T,T.return);break;case 5:if(ec(m,h),Uc(h),D&512&&T!==null&&jg(T,T.return),h.flags&32){var G=h.stateNode;try{Je(G,"")}catch(vr){As(h,h.return,vr)}}if(D&4&&(G=h.stateNode,G!=null)){var J=h.memoizedProps,de=T!==null?T.memoizedProps:J,je=h.type,Me=h.updateQueue;if(h.updateQueue=null,Me!==null)try{je==="input"&&J.type==="radio"&&J.name!=null&&Ge(G,J),Er(je,de);var ft=Er(je,J);for(de=0;de<Me.length;de+=2){var Ut=Me[de],Gt=Me[de+1];Ut==="style"?Wt(G,Gt):Ut==="dangerouslySetInnerHTML"?Ke(G,Gt):Ut==="children"?Je(G,Gt):_(G,Ut,Gt,ft)}switch(je){case"input":Le(G,J);break;case"textarea":Lt(G,J);break;case"select":var $t=G._wrapperState.wasMultiple;G._wrapperState.wasMultiple=!!J.multiple;var ur=J.value;ur!=null?lt(G,!!J.multiple,ur,!1):$t!==!!J.multiple&&(J.defaultValue!=null?lt(G,!!J.multiple,J.defaultValue,!0):lt(G,!!J.multiple,J.multiple?[]:"",!1))}G[oh]=J}catch(vr){As(h,h.return,vr)}}break;case 6:if(ec(m,h),Uc(h),D&4){if(h.stateNode===null)throw Error(r(162));G=h.stateNode,J=h.memoizedProps;try{G.nodeValue=J}catch(vr){As(h,h.return,vr)}}break;case 3:if(ec(m,h),Uc(h),D&4&&T!==null&&T.memoizedState.isDehydrated)try{bi(m.containerInfo)}catch(vr){As(h,h.return,vr)}break;case 4:ec(m,h),Uc(h);break;case 13:ec(m,h),Uc(h),G=h.child,G.flags&8192&&(J=G.memoizedState!==null,G.stateNode.isHidden=J,!J||G.alternate!==null&&G.alternate.memoizedState!==null||(lS=xt())),D&4&&vj(h);break;case 22:if(Ut=T!==null&&T.memoizedState!==null,h.mode&1?(Ei=(ft=Ei)||Ut,ec(m,h),Ei=ft):ec(m,h),Uc(h),D&8192){if(ft=h.memoizedState!==null,(h.stateNode.isHidden=ft)&&!Ut&&(h.mode&1)!==0)for(mr=h,Ut=h.child;Ut!==null;){for(Gt=mr=Ut;mr!==null;){switch($t=mr,ur=$t.child,$t.tag){case 0:case 11:case 14:case 15:Jp(4,$t,$t.return);break;case 1:jg($t,$t.return);var yr=$t.stateNode;if(typeof yr.componentWillUnmount=="function"){D=$t,T=$t.return;try{m=D,yr.props=m.memoizedProps,yr.state=m.memoizedState,yr.componentWillUnmount()}catch(vr){As(D,T,vr)}}break;case 5:jg($t,$t.return);break;case 22:if($t.memoizedState!==null){Sj(Gt);continue}}ur!==null?(ur.return=$t,mr=ur):Sj(Gt)}Ut=Ut.sibling}e:for(Ut=null,Gt=h;;){if(Gt.tag===5){if(Ut===null){Ut=Gt;try{G=Gt.stateNode,ft?(J=G.style,typeof J.setProperty=="function"?J.setProperty("display","none","important"):J.display="none"):(je=Gt.stateNode,Me=Gt.memoizedProps.style,de=Me!=null&&Me.hasOwnProperty("display")?Me.display:null,je.style.display=Nt("display",de))}catch(vr){As(h,h.return,vr)}}}else if(Gt.tag===6){if(Ut===null)try{Gt.stateNode.nodeValue=ft?"":Gt.memoizedProps}catch(vr){As(h,h.return,vr)}}else if((Gt.tag!==22&&Gt.tag!==23||Gt.memoizedState===null||Gt===h)&&Gt.child!==null){Gt.child.return=Gt,Gt=Gt.child;continue}if(Gt===h)break e;for(;Gt.sibling===null;){if(Gt.return===null||Gt.return===h)break e;Ut===Gt&&(Ut=null),Gt=Gt.return}Ut===Gt&&(Ut=null),Gt.sibling.return=Gt.return,Gt=Gt.sibling}}break;case 19:ec(m,h),Uc(h),D&4&&vj(h);break;case 21:break;default:ec(m,h),Uc(h)}}function Uc(h){var m=h.flags;if(m&2){try{e:{for(var T=h.return;T!==null;){if(pj(T)){var D=T;break e}T=T.return}throw Error(r(160))}switch(D.tag){case 5:var G=D.stateNode;D.flags&32&&(Je(G,""),D.flags&=-33);var J=xj(h);aS(h,J,G);break;case 3:case 4:var de=D.stateNode.containerInfo,je=xj(h);sS(h,je,de);break;default:throw Error(r(161))}}catch(Me){As(h,h.return,Me)}h.flags&=-3}m&4096&&(h.flags&=-4097)}function IV(h,m,T){mr=h,_j(h)}function _j(h,m,T){for(var D=(h.mode&1)!==0;mr!==null;){var G=mr,J=G.child;if(G.tag===22&&D){var de=G.memoizedState!==null||K1;if(!de){var je=G.alternate,Me=je!==null&&je.memoizedState!==null||Ei;je=K1;var ft=Ei;if(K1=de,(Ei=Me)&&!ft)for(mr=G;mr!==null;)de=mr,Me=de.child,de.tag===22&&de.memoizedState!==null?kj(G):Me!==null?(Me.return=de,mr=Me):kj(G);for(;J!==null;)mr=J,_j(J),J=J.sibling;mr=G,K1=je,Ei=ft}bj(h)}else(G.subtreeFlags&8772)!==0&&J!==null?(J.return=G,mr=J):bj(h)}}function bj(h){for(;mr!==null;){var m=mr;if((m.flags&8772)!==0){var T=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:Ei||q1(5,m);break;case 1:var D=m.stateNode;if(m.flags&4&&!Ei)if(T===null)D.componentDidMount();else{var G=m.elementType===m.type?T.memoizedProps:_a(m.type,T.memoizedProps);D.componentDidUpdate(G,T.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var J=m.updateQueue;J!==null&&hs(m,J,D);break;case 3:var de=m.updateQueue;if(de!==null){if(T=null,m.child!==null)switch(m.child.tag){case 5:T=m.child.stateNode;break;case 1:T=m.child.stateNode}hs(m,de,T)}break;case 5:var je=m.stateNode;if(T===null&&m.flags&4){T=je;var Me=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":Me.autoFocus&&T.focus();break;case"img":Me.src&&(T.src=Me.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var ft=m.alternate;if(ft!==null){var Ut=ft.memoizedState;if(Ut!==null){var Gt=Ut.dehydrated;Gt!==null&&bi(Gt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Ei||m.flags&512&&nS(m)}catch($t){As(m,m.return,$t)}}if(m===h){mr=null;break}if(T=m.sibling,T!==null){T.return=m.return,mr=T;break}mr=m.return}}function Sj(h){for(;mr!==null;){var m=mr;if(m===h){mr=null;break}var T=m.sibling;if(T!==null){T.return=m.return,mr=T;break}mr=m.return}}function kj(h){for(;mr!==null;){var m=mr;try{switch(m.tag){case 0:case 11:case 15:var T=m.return;try{q1(4,m)}catch(Me){As(m,T,Me)}break;case 1:var D=m.stateNode;if(typeof D.componentDidMount=="function"){var G=m.return;try{D.componentDidMount()}catch(Me){As(m,G,Me)}}var J=m.return;try{nS(m)}catch(Me){As(m,J,Me)}break;case 5:var de=m.return;try{nS(m)}catch(Me){As(m,de,Me)}}}catch(Me){As(m,m.return,Me)}if(m===h){mr=null;break}var je=m.sibling;if(je!==null){je.return=m.return,mr=je;break}mr=m.return}}var RV=Math.ceil,Y1=N.ReactCurrentDispatcher,iS=N.ReactCurrentOwner,fl=N.ReactCurrentBatchConfig,pn=0,La=null,oa=null,ii=0,$o=0,Pg=Kl(0),ba=0,Zp=null,yh=0,X1=0,oS=0,ex=null,yo=null,lS=0,Fg=1/0,Iu=null,Q1=!1,cS=null,Zd=null,J1=!1,ef=null,Z1=0,tx=0,uS=null,ew=-1,tw=0;function eo(){return(pn&6)!==0?xt():ew!==-1?ew:ew=xt()}function tf(h){return(h.mode&1)===0?1:(pn&2)!==0&&ii!==0?ii&-ii:Up.transition!==null?(tw===0&&(tw=Vn()),tw):(h=Pt,h!==0||(h=window.event,h=h===void 0?16:m1(h.type)),h)}function tc(h,m,T,D){if(50<tx)throw tx=0,uS=null,Error(r(185));Oe(h,T,D),((pn&2)===0||h!==La)&&(h===La&&((pn&2)===0&&(X1|=T),ba===4&&rf(h,ii)),vo(h,D),T===1&&pn===0&&(m.mode&1)===0&&(Fg=xt()+500,Id&&Fc()))}function vo(h,m){var T=h.callbackNode;Nr(h,m);var D=ye(h,h===La?ii:0);if(D===0)T!==null&&Ee(T),h.callbackNode=null,h.callbackPriority=0;else if(m=D&-D,h.callbackPriority!==m){if(T!=null&&Ee(T),m===1)h.tag===0?ql(Tj.bind(null,h)):ch(Tj.bind(null,h)),j1(function(){(pn&6)===0&&Fc()}),T=null;else{switch(mn(D)){case 1:T=yt;break;case 4:T=Yt;break;case 16:T=_r;break;case 536870912:T=xr;break;default:T=_r}T=Dj(T,Cj.bind(null,h))}h.callbackPriority=m,h.callbackNode=T}}function Cj(h,m){if(ew=-1,tw=0,(pn&6)!==0)throw Error(r(327));var T=h.callbackNode;if(Og()&&h.callbackNode!==T)return null;var D=ye(h,h===La?ii:0);if(D===0)return null;if((D&30)!==0||(D&h.expiredLanes)!==0||m)m=rw(h,D);else{m=D;var G=pn;pn|=2;var J=Nj();(La!==h||ii!==m)&&(Iu=null,Fg=xt()+500,wh(h,m));do try{BV();break}catch(je){Ej(h,je)}while(!0);pg(),Y1.current=J,pn=G,oa!==null?m=0:(La=null,ii=0,m=ba)}if(m!==0){if(m===2&&(G=Or(h),G!==0&&(D=G,m=dS(h,G))),m===1)throw T=Zp,wh(h,0),rf(h,D),vo(h,xt()),T;if(m===6)rf(h,D);else{if(G=h.current.alternate,(D&30)===0&&!MV(G)&&(m=rw(h,D),m===2&&(J=Or(h),J!==0&&(D=J,m=dS(h,J))),m===1))throw T=Zp,wh(h,0),rf(h,D),vo(h,xt()),T;switch(h.finishedWork=G,h.finishedLanes=D,m){case 0:case 1:throw Error(r(345));case 2:_h(h,yo,Iu);break;case 3:if(rf(h,D),(D&130023424)===D&&(m=lS+500-xt(),10<m)){if(ye(h,0)!==0)break;if(G=h.suspendedLanes,(G&D)!==D){eo(),h.pingedLanes|=h.suspendedLanes&G;break}h.timeoutHandle=Ki(_h.bind(null,h,yo,Iu),m);break}_h(h,yo,Iu);break;case 4:if(rf(h,D),(D&4194240)===D)break;for(m=h.eventTimes,G=-1;0<D;){var de=31-cr(D);J=1<<de,de=m[de],de>G&&(G=de),D&=~J}if(D=G,D=xt()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*RV(D/1960))-D,10<D){h.timeoutHandle=Ki(_h.bind(null,h,yo,Iu),D);break}_h(h,yo,Iu);break;case 5:_h(h,yo,Iu);break;default:throw Error(r(329))}}}return vo(h,xt()),h.callbackNode===T?Cj.bind(null,h):null}function dS(h,m){var T=ex;return h.current.memoizedState.isDehydrated&&(wh(h,m).flags|=256),h=rw(h,m),h!==2&&(m=yo,yo=T,m!==null&&fS(m)),h}function fS(h){yo===null?yo=h:yo.push.apply(yo,h)}function MV(h){for(var m=h;;){if(m.flags&16384){var T=m.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var D=0;D<T.length;D++){var G=T[D],J=G.getSnapshot;G=G.value;try{if(!ki(J(),G))return!1}catch{return!1}}}if(T=m.child,m.subtreeFlags&16384&&T!==null)T.return=m,m=T;else{if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function rf(h,m){for(m&=~oS,m&=~X1,h.suspendedLanes|=m,h.pingedLanes&=~m,h=h.expirationTimes;0<m;){var T=31-cr(m),D=1<<T;h[T]=-1,m&=~D}}function Tj(h){if((pn&6)!==0)throw Error(r(327));Og();var m=ye(h,0);if((m&1)===0)return vo(h,xt()),null;var T=rw(h,m);if(h.tag!==0&&T===2){var D=Or(h);D!==0&&(m=D,T=dS(h,D))}if(T===1)throw T=Zp,wh(h,0),rf(h,m),vo(h,xt()),T;if(T===6)throw Error(r(345));return h.finishedWork=h.current.alternate,h.finishedLanes=m,_h(h,yo,Iu),vo(h,xt()),null}function hS(h,m){var T=pn;pn|=1;try{return h(m)}finally{pn=T,pn===0&&(Fg=xt()+500,Id&&Fc())}}function vh(h){ef!==null&&ef.tag===0&&(pn&6)===0&&Og();var m=pn;pn|=1;var T=fl.transition,D=Pt;try{if(fl.transition=null,Pt=1,h)return h()}finally{Pt=D,fl.transition=T,pn=m,(pn&6)===0&&Fc()}}function gS(){$o=Pg.current,Un(Pg)}function wh(h,m){h.finishedWork=null,h.finishedLanes=0;var T=h.timeoutHandle;if(T!==-1&&(h.timeoutHandle=-1,Mp(T)),oa!==null)for(T=oa.return;T!==null;){var D=T;switch(ia(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&Dd();break;case 3:rs(),Un(Fa),Un(wa),Da();break;case 5:Xl(D);break;case 4:rs();break;case 13:Un(zn);break;case 19:Un(zn);break;case 10:xg(D.type._context);break;case 22:case 23:gS()}T=T.return}if(La=h,oa=h=nf(h.current,null),ii=$o=m,ba=0,Zp=null,oS=X1=yh=0,yo=ex=null,ol!==null){for(m=0;m<ol.length;m++)if(T=ol[m],D=T.interleaved,D!==null){T.interleaved=null;var G=D.next,J=T.pending;if(J!==null){var de=J.next;J.next=G,D.next=de}T.pending=D}ol=null}return h}function Ej(h,m){do{var T=oa;try{if(pg(),Wd.current=qd,Bo){for(var D=An.memoizedState;D!==null;){var G=D.queue;G!==null&&(G.pending=null),D=D.next}Bo=!1}if(ni=0,Es=gs=An=null,Mc=!1,xo=0,iS.current=null,T===null||T.return===null){ba=1,Zp=m,oa=null;break}e:{var J=h,de=T.return,je=T,Me=m;if(m=ii,je.flags|=32768,Me!==null&&typeof Me=="object"&&typeof Me.then=="function"){var ft=Me,Ut=je,Gt=Ut.tag;if((Ut.mode&1)===0&&(Gt===0||Gt===11||Gt===15)){var $t=Ut.alternate;$t?(Ut.updateQueue=$t.updateQueue,Ut.memoizedState=$t.memoizedState,Ut.lanes=$t.lanes):(Ut.updateQueue=null,Ut.memoizedState=null)}var ur=O(de);if(ur!==null){ur.flags&=-257,U(ur,de,je,J,m),ur.mode&1&&b(J,ft,m),m=ur,Me=ft;var yr=m.updateQueue;if(yr===null){var vr=new Set;vr.add(Me),m.updateQueue=vr}else yr.add(Me);break e}else{if((m&1)===0){b(J,ft,m),mS();break e}Me=Error(r(426))}}else if(Cn&&je.mode&1){var Xs=O(de);if(Xs!==null){(Xs.flags&65536)===0&&(Xs.flags|=256),U(Xs,de,je,J,m),dh(Du(Me,je));break e}}J=Me=Du(Me,je),ba!==4&&(ba=2),ex===null?ex=[J]:ex.push(J),J=de;do{switch(J.tag){case 3:J.flags|=65536,m&=-m,J.lanes|=m;var st=V1(J,Me,m);mh(J,st);break e;case 1:je=Me;var We=J.type,it=J.stateNode;if((J.flags&128)===0&&(typeof We.getDerivedStateFromError=="function"||it!==null&&typeof it.componentDidCatch=="function"&&(Zd===null||!Zd.has(it)))){J.flags|=65536,m&=-m,J.lanes|=m;var Qt=y(J,je,m);mh(J,Qt);break e}}J=J.return}while(J!==null)}jj(T)}catch(br){m=br,oa===T&&T!==null&&(oa=T=T.return);continue}break}while(!0)}function Nj(){var h=Y1.current;return Y1.current=qd,h===null?qd:h}function mS(){(ba===0||ba===3||ba===2)&&(ba=4),La===null||(yh&268435455)===0&&(X1&268435455)===0||rf(La,ii)}function rw(h,m){var T=pn;pn|=2;var D=Nj();(La!==h||ii!==m)&&(Iu=null,wh(h,m));do try{LV();break}catch(G){Ej(h,G)}while(!0);if(pg(),pn=T,Y1.current=D,oa!==null)throw Error(r(261));return La=null,ii=0,ba}function LV(){for(;oa!==null;)Aj(oa)}function BV(){for(;oa!==null&&!Xe();)Aj(oa)}function Aj(h){var m=Oj(h.alternate,h,$o);h.memoizedProps=h.pendingProps,m===null?jj(h):oa=m,iS.current=null}function jj(h){var m=h;do{var T=m.alternate;if(h=m.return,(m.flags&32768)===0){if(T=PV(T,m,$o),T!==null){oa=T;return}}else{if(T=FV(T,m),T!==null){T.flags&=32767,oa=T;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{ba=6,oa=null;return}}if(m=m.sibling,m!==null){oa=m;return}oa=m=h}while(m!==null);ba===0&&(ba=5)}function _h(h,m,T){var D=Pt,G=fl.transition;try{fl.transition=null,Pt=1,$V(h,m,T,D)}finally{fl.transition=G,Pt=D}return null}function $V(h,m,T,D){do Og();while(ef!==null);if((pn&6)!==0)throw Error(r(327));T=h.finishedWork;var G=h.finishedLanes;if(T===null)return null;if(h.finishedWork=null,h.finishedLanes=0,T===h.current)throw Error(r(177));h.callbackNode=null,h.callbackPriority=0;var J=T.lanes|T.childLanes;if(dt(h,J),h===La&&(oa=La=null,ii=0),(T.subtreeFlags&2064)===0&&(T.flags&2064)===0||J1||(J1=!0,Dj(_r,function(){return Og(),null})),J=(T.flags&15990)!==0,(T.subtreeFlags&15990)!==0||J){J=fl.transition,fl.transition=null;var de=Pt;Pt=1;var je=pn;pn|=4,iS.current=null,DV(h,T),wj(T,h),th(Ip),W0=!!Dp,Ip=Dp=null,h.current=T,IV(T),ot(),pn=je,Pt=de,fl.transition=J}else h.current=T;if(J1&&(J1=!1,ef=h,Z1=G),J=h.pendingLanes,J===0&&(Zd=null),Xr(T.stateNode),vo(h,xt()),m!==null)for(D=h.onRecoverableError,T=0;T<m.length;T++)G=m[T],D(G.value,{componentStack:G.stack,digest:G.digest});if(Q1)throw Q1=!1,h=cS,cS=null,h;return(Z1&1)!==0&&h.tag!==0&&Og(),J=h.pendingLanes,(J&1)!==0?h===uS?tx++:(tx=0,uS=h):tx=0,Fc(),null}function Og(){if(ef!==null){var h=mn(Z1),m=fl.transition,T=Pt;try{if(fl.transition=null,Pt=16>h?16:h,ef===null)var D=!1;else{if(h=ef,ef=null,Z1=0,(pn&6)!==0)throw Error(r(331));var G=pn;for(pn|=4,mr=h.current;mr!==null;){var J=mr,de=J.child;if((mr.flags&16)!==0){var je=J.deletions;if(je!==null){for(var Me=0;Me<je.length;Me++){var ft=je[Me];for(mr=ft;mr!==null;){var Ut=mr;switch(Ut.tag){case 0:case 11:case 15:Jp(8,Ut,J)}var Gt=Ut.child;if(Gt!==null)Gt.return=Ut,mr=Gt;else for(;mr!==null;){Ut=mr;var $t=Ut.sibling,ur=Ut.return;if(mj(Ut),Ut===ft){mr=null;break}if($t!==null){$t.return=ur,mr=$t;break}mr=ur}}}var yr=J.alternate;if(yr!==null){var vr=yr.child;if(vr!==null){yr.child=null;do{var Xs=vr.sibling;vr.sibling=null,vr=Xs}while(vr!==null)}}mr=J}}if((J.subtreeFlags&2064)!==0&&de!==null)de.return=J,mr=de;else e:for(;mr!==null;){if(J=mr,(J.flags&2048)!==0)switch(J.tag){case 0:case 11:case 15:Jp(9,J,J.return)}var st=J.sibling;if(st!==null){st.return=J.return,mr=st;break e}mr=J.return}}var We=h.current;for(mr=We;mr!==null;){de=mr;var it=de.child;if((de.subtreeFlags&2064)!==0&&it!==null)it.return=de,mr=it;else e:for(de=We;mr!==null;){if(je=mr,(je.flags&2048)!==0)try{switch(je.tag){case 0:case 11:case 15:q1(9,je)}}catch(br){As(je,je.return,br)}if(je===de){mr=null;break e}var Qt=je.sibling;if(Qt!==null){Qt.return=je.return,mr=Qt;break e}mr=je.return}}if(pn=G,Fc(),un&&typeof un.onPostCommitFiberRoot=="function")try{un.onPostCommitFiberRoot(Gr,h)}catch{}D=!0}return D}finally{Pt=T,fl.transition=m}}return!1}function Pj(h,m,T){m=Du(T,m),m=V1(h,m,1),h=ul(h,m,1),m=eo(),h!==null&&(Oe(h,1,m),vo(h,m))}function As(h,m,T){if(h.tag===3)Pj(h,h,T);else for(;m!==null;){if(m.tag===3){Pj(m,h,T);break}else if(m.tag===1){var D=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(Zd===null||!Zd.has(D))){h=Du(T,h),h=y(m,h,1),m=ul(m,h,1),h=eo(),m!==null&&(Oe(m,1,h),vo(m,h));break}}m=m.return}}function UV(h,m,T){var D=h.pingCache;D!==null&&D.delete(m),m=eo(),h.pingedLanes|=h.suspendedLanes&T,La===h&&(ii&T)===T&&(ba===4||ba===3&&(ii&130023424)===ii&&500>xt()-lS?wh(h,0):oS|=T),vo(h,m)}function Fj(h,m){m===0&&((h.mode&1)===0?m=1:(m=Ws,Ws<<=1,(Ws&130023424)===0&&(Ws=4194304)));var T=eo();h=Ji(h,m),h!==null&&(Oe(h,m,T),vo(h,T))}function zV(h){var m=h.memoizedState,T=0;m!==null&&(T=m.retryLane),Fj(h,T)}function WV(h,m){var T=0;switch(h.tag){case 13:var D=h.stateNode,G=h.memoizedState;G!==null&&(T=G.retryLane);break;case 19:D=h.stateNode;break;default:throw Error(r(314))}D!==null&&D.delete(m),Fj(h,T)}var Oj;Oj=function(h,m,T){if(h!==null)if(h.memoizedProps!==m.pendingProps||Fa.current)re=!0;else{if((h.lanes&T)===0&&(m.flags&128)===0)return re=!1,eS(h,m,T);re=(h.flags&131072)!==0}else re=!1,Cn&&(m.flags&1048576)!==0&&I1(m,Dc,m.index);switch(m.lanes=0,m.tag){case 2:var D=m.type;an(h,m),h=m.pendingProps;var G=Cu(m,wa.current);Yl(m,T),G=Hd(null,m,D,h,G,T);var J=Gd();return m.flags|=1,typeof G=="object"&&G!==null&&typeof G.render=="function"&&G.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,Oa(D)?(J=!0,Tu(m)):J=!1,m.memoizedState=G.state!==null&&G.state!==void 0?G.state:null,gh(m),G.updater=Xd,m.stateNode=G,G._reactInternals=m,Ng(m,D,h,T),m=Tn(null,m,D,!0,J,T)):(m.tag=0,Cn&&J&&Rd(m),ve(null,m,G,T),m=m.child),m;case 16:D=m.elementType;e:{switch(an(h,m),h=m.pendingProps,G=D._init,D=G(D._payload),m.type=D,G=m.tag=GV(D),h=_a(D,h),G){case 0:m=ar(null,m,D,h,T);break e;case 1:m=Wn(null,m,D,h,T);break e;case 11:m=Ve(null,m,D,h,T);break e;case 14:m=gt(null,m,D,_a(D.type,h),T);break e}throw Error(r(306,D,""))}return m;case 0:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:_a(D,G),ar(h,m,D,G,T);case 1:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:_a(D,G),Wn(h,m,D,G,T);case 3:e:{if(si(m),h===null)throw Error(r(387));D=m.pendingProps,J=m.memoizedState,G=J.element,vg(h,m),$d(m,D,null,T);var de=m.memoizedState;if(D=de.element,J.isDehydrated)if(J={element:D,isDehydrated:!1,cache:de.cache,pendingSuspenseBoundaries:de.pendingSuspenseBoundaries,transitions:de.transitions},m.updateQueue.baseState=J,m.memoizedState=J,m.flags&256){G=Du(Error(r(423)),m),m=dl(h,m,D,T,G);break e}else if(D!==G){G=Du(Error(r(424)),m),m=dl(h,m,D,T,G);break e}else for(sr=nl(m.stateNode.containerInfo.firstChild),Yi=m,Cn=!0,Xi=null,T=po(m,null,D,T),m.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(ju(),D===G){m=Ma(h,m,T);break e}ve(h,m,D,T)}m=m.child}return m;case 5:return Ud(m),h===null&&Md(m),D=m.type,G=m.pendingProps,J=h!==null?h.memoizedProps:null,de=G.children,Rp(D,G)?de=null:J!==null&&Rp(D,J)&&(m.flags|=32),Ur(h,m),ve(h,m,de,T),m.child;case 6:return h===null&&Md(m),null;case 13:return vt(h,m,T);case 4:return Rc(m,m.stateNode.containerInfo),D=m.pendingProps,h===null?m.child=Pu(m,null,D,T):ve(h,m,D,T),m.child;case 11:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:_a(D,G),Ve(h,m,D,G,T);case 7:return ve(h,m,m.pendingProps,T),m.child;case 8:return ve(h,m,m.pendingProps.children,T),m.child;case 12:return ve(h,m,m.pendingProps.children,T),m.child;case 10:e:{if(D=m.type._context,G=m.pendingProps,J=m.memoizedProps,de=G.value,Pn(fh,D._currentValue),D._currentValue=de,J!==null)if(ki(J.value,de)){if(J.children===G.children&&!Fa.current){m=Ma(h,m,T);break e}}else for(J=m.child,J!==null&&(J.return=m);J!==null;){var je=J.dependencies;if(je!==null){de=J.child;for(var Me=je.firstContext;Me!==null;){if(Me.context===D){if(J.tag===1){Me=cl(-1,T&-T),Me.tag=2;var ft=J.updateQueue;if(ft!==null){ft=ft.shared;var Ut=ft.pending;Ut===null?Me.next=Me:(Me.next=Ut.next,Ut.next=Me),ft.pending=Me}}J.lanes|=T,Me=J.alternate,Me!==null&&(Me.lanes|=T),yg(J.return,T,m),je.lanes|=T;break}Me=Me.next}}else if(J.tag===10)de=J.type===m.type?null:J.child;else if(J.tag===18){if(de=J.return,de===null)throw Error(r(341));de.lanes|=T,je=de.alternate,je!==null&&(je.lanes|=T),yg(de,T,m),de=J.sibling}else de=J.child;if(de!==null)de.return=J;else for(de=J;de!==null;){if(de===m){de=null;break}if(J=de.sibling,J!==null){J.return=de.return,de=J;break}de=de.return}J=de}ve(h,m,G.children,T),m=m.child}return m;case 9:return G=m.type,D=m.pendingProps.children,Yl(m,T),G=ri(G),D=D(G),m.flags|=1,ve(h,m,D,T),m.child;case 14:return D=m.type,G=_a(D,m.pendingProps),G=_a(D.type,G),gt(h,m,D,G,T);case 15:return Vt(h,m,m.type,m.pendingProps,T);case 17:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:_a(D,G),an(h,m),m.tag=1,Oa(D)?(h=!0,Tu(m)):h=!1,Yl(m,T),G1(m,D,G),Ng(m,D,G,T),Tn(null,m,D,!0,h,T);case 19:return Ys(h,m,T);case 22:return gr(h,m,T)}throw Error(r(156,m.tag))};function Dj(h,m){return Te(h,m)}function HV(h,m,T,D){this.tag=h,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hl(h,m,T,D){return new HV(h,m,T,D)}function pS(h){return h=h.prototype,!(!h||!h.isReactComponent)}function GV(h){if(typeof h=="function")return pS(h)?1:0;if(h!=null){if(h=h.$$typeof,h===Y)return 11;if(h===ee)return 14}return 2}function nf(h,m){var T=h.alternate;return T===null?(T=hl(h.tag,m,h.key,h.mode),T.elementType=h.elementType,T.type=h.type,T.stateNode=h.stateNode,T.alternate=h,h.alternate=T):(T.pendingProps=m,T.type=h.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=h.flags&14680064,T.childLanes=h.childLanes,T.lanes=h.lanes,T.child=h.child,T.memoizedProps=h.memoizedProps,T.memoizedState=h.memoizedState,T.updateQueue=h.updateQueue,m=h.dependencies,T.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},T.sibling=h.sibling,T.index=h.index,T.ref=h.ref,T}function nw(h,m,T,D,G,J){var de=2;if(D=h,typeof h=="function")pS(h)&&(de=1);else if(typeof h=="string")de=5;else e:switch(h){case F:return bh(T.children,G,J,m);case A:de=8,G|=8;break;case j:return h=hl(12,T,m,G|2),h.elementType=j,h.lanes=J,h;case Z:return h=hl(13,T,m,G),h.elementType=Z,h.lanes=J,h;case se:return h=hl(19,T,m,G),h.elementType=se,h.lanes=J,h;case L:return sw(T,G,J,m);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case I:de=10;break e;case B:de=9;break e;case Y:de=11;break e;case ee:de=14;break e;case te:de=16,D=null;break e}throw Error(r(130,h==null?h:typeof h,""))}return m=hl(de,T,m,G),m.elementType=h,m.type=D,m.lanes=J,m}function bh(h,m,T,D){return h=hl(7,h,D,m),h.lanes=T,h}function sw(h,m,T,D){return h=hl(22,h,D,m),h.elementType=L,h.lanes=T,h.stateNode={isHidden:!1},h}function xS(h,m,T){return h=hl(6,h,null,m),h.lanes=T,h}function yS(h,m,T){return m=hl(4,h.children!==null?h.children:[],h.key,m),m.lanes=T,m.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},m}function VV(h,m,T,D,G){this.tag=m,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dn(0),this.expirationTimes=dn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dn(0),this.identifierPrefix=D,this.onRecoverableError=G,this.mutableSourceEagerHydrationData=null}function vS(h,m,T,D,G,J,de,je,Me){return h=new VV(h,m,T,je,Me),m===1?(m=1,J===!0&&(m|=8)):m=0,J=hl(3,null,null,m),h.current=J,J.stateNode=h,J.memoizedState={element:D,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},gh(J),h}function KV(h,m,T){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:D==null?null:""+D,children:h,containerInfo:m,implementation:T}}function Ij(h){if(!h)return al;h=h._reactInternals;e:{if(Se(h)!==h||h.tag!==1)throw Error(r(170));var m=h;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(Oa(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(r(171))}if(h.tag===1){var T=h.type;if(Oa(T))return dg(h,T,m)}return m}function Rj(h,m,T,D,G,J,de,je,Me){return h=vS(T,D,!0,h,G,J,de,je,Me),h.context=Ij(null),T=h.current,D=eo(),G=tf(T),J=cl(D,G),J.callback=m??null,ul(T,J,G),h.current.lanes=G,Oe(h,G,D),vo(h,D),h}function aw(h,m,T,D){var G=m.current,J=eo(),de=tf(G);return T=Ij(T),m.context===null?m.context=T:m.pendingContext=T,m=cl(J,de),m.payload={element:h},D=D===void 0?null:D,D!==null&&(m.callback=D),h=ul(G,m,de),h!==null&&(tc(h,G,de,J),wg(h,G,de)),de}function iw(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 5:return h.child.stateNode;default:return h.child.stateNode}}function Mj(h,m){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var T=h.retryLane;h.retryLane=T!==0&&T<m?T:m}}function wS(h,m){Mj(h,m),(h=h.alternate)&&Mj(h,m)}function qV(){return null}var Lj=typeof reportError=="function"?reportError:function(h){console.error(h)};function _S(h){this._internalRoot=h}ow.prototype.render=_S.prototype.render=function(h){var m=this._internalRoot;if(m===null)throw Error(r(409));aw(h,m,null,null)},ow.prototype.unmount=_S.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var m=h.containerInfo;vh(function(){aw(null,h,null,null)}),m[sl]=null}};function ow(h){this._internalRoot=h}ow.prototype.unstable_scheduleHydration=function(h){if(h){var m=Ct();h={blockedOn:null,target:h,priority:m};for(var T=0;T<Vr.length&&m!==0&&m<Vr[T].priority;T++);Vr.splice(T,0,h),T===0&&fo(h)}};function bS(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function lw(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11&&(h.nodeType!==8||h.nodeValue!==" react-mount-point-unstable "))}function Bj(){}function YV(h,m,T,D,G){if(G){if(typeof D=="function"){var J=D;D=function(){var ft=iw(de);J.call(ft)}}var de=Rj(m,D,h,0,null,!1,!1,"",Bj);return h._reactRootContainer=de,h[sl]=de.current,wu(h.nodeType===8?h.parentNode:h),vh(),de}for(;G=h.lastChild;)h.removeChild(G);if(typeof D=="function"){var je=D;D=function(){var ft=iw(Me);je.call(ft)}}var Me=vS(h,0,!1,null,null,!1,!1,"",Bj);return h._reactRootContainer=Me,h[sl]=Me.current,wu(h.nodeType===8?h.parentNode:h),vh(function(){aw(m,Me,T,D)}),Me}function cw(h,m,T,D,G){var J=T._reactRootContainer;if(J){var de=J;if(typeof G=="function"){var je=G;G=function(){var Me=iw(de);je.call(Me)}}aw(m,de,h,G)}else de=YV(T,m,h,G,D);return iw(de)}tt=function(h){switch(h.tag){case 3:var m=h.stateNode;if(m.current.memoizedState.isDehydrated){var T=Sn(m.pendingLanes);T!==0&&(Rt(m,T|1),vo(m,xt()),(pn&6)===0&&(Fg=xt()+500,Fc()))}break;case 13:vh(function(){var D=Ji(h,1);if(D!==null){var G=eo();tc(D,h,1,G)}}),wS(h,1)}},mt=function(h){if(h.tag===13){var m=Ji(h,134217728);if(m!==null){var T=eo();tc(m,h,134217728,T)}wS(h,134217728)}},Xt=function(h){if(h.tag===13){var m=tf(h),T=Ji(h,m);if(T!==null){var D=eo();tc(T,h,m,D)}wS(h,m)}},Ct=function(){return Pt},Sr=function(h,m){var T=Pt;try{return Pt=h,m()}finally{Pt=T}},me=function(h,m,T){switch(m){case"input":if(Le(h,T),m=T.name,T.type==="radio"&&m!=null){for(T=h;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<T.length;m++){var D=T[m];if(D!==h&&D.form===h.form){var G=aa(D);if(!G)throw Error(r(90));ne(D),Le(D,G)}}}break;case"textarea":Lt(h,T);break;case"select":m=T.value,m!=null&&lt(h,!!T.multiple,m,!1)}},ze=hS,ke=vh;var XV={usingClientEntryPoint:!1,Events:[lh,Vs,aa,bt,Pe,hS]},rx={findFiberByHostInstance:jc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QV={bundleType:rx.bundleType,version:rx.version,rendererPackageName:rx.rendererPackageName,rendererConfig:rx.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(h){return h=oe(h),h===null?null:h.stateNode},findFiberByHostInstance:rx.findFiberByHostInstance||qV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uw.isDisabled&&uw.supportsFiber)try{Gr=uw.inject(QV),un=uw}catch{}}return wo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XV,wo.createPortal=function(h,m){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bS(m))throw Error(r(200));return KV(h,m,null,T)},wo.createRoot=function(h,m){if(!bS(h))throw Error(r(299));var T=!1,D="",G=Lj;return m!=null&&(m.unstable_strictMode===!0&&(T=!0),m.identifierPrefix!==void 0&&(D=m.identifierPrefix),m.onRecoverableError!==void 0&&(G=m.onRecoverableError)),m=vS(h,1,!1,null,null,T,!1,D,G),h[sl]=m.current,wu(h.nodeType===8?h.parentNode:h),new _S(m)},wo.findDOMNode=function(h){if(h==null)return null;if(h.nodeType===1)return h;var m=h._reactInternals;if(m===void 0)throw typeof h.render=="function"?Error(r(188)):(h=Object.keys(h).join(","),Error(r(268,h)));return h=oe(m),h=h===null?null:h.stateNode,h},wo.flushSync=function(h){return vh(h)},wo.hydrate=function(h,m,T){if(!lw(m))throw Error(r(200));return cw(null,h,m,!0,T)},wo.hydrateRoot=function(h,m,T){if(!bS(h))throw Error(r(405));var D=T!=null&&T.hydratedSources||null,G=!1,J="",de=Lj;if(T!=null&&(T.unstable_strictMode===!0&&(G=!0),T.identifierPrefix!==void 0&&(J=T.identifierPrefix),T.onRecoverableError!==void 0&&(de=T.onRecoverableError)),m=Rj(m,null,h,1,T??null,G,!1,J,de),h[sl]=m.current,wu(h),D)for(h=0;h<D.length;h++)T=D[h],G=T._getVersion,G=G(T._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[T,G]:m.mutableSourceEagerHydrationData.push(T,G);return new ow(m)},wo.render=function(h,m,T){if(!lw(m))throw Error(r(200));return cw(null,h,m,!1,T)},wo.unmountComponentAtNode=function(h){if(!lw(h))throw Error(r(40));return h._reactRootContainer?(vh(function(){cw(null,null,h,!1,function(){h._reactRootContainer=null,h[sl]=null})}),!0):!1},wo.unstable_batchedUpdates=hS,wo.unstable_renderSubtreeIntoContainer=function(h,m,T,D){if(!lw(T))throw Error(r(200));if(h==null||h._reactInternals===void 0)throw Error(r(38));return cw(h,m,T,!1,D)},wo.version="18.3.1-next-f1338f8080-20240426",wo}var Kj;function SM(){if(Kj)return CS.exports;Kj=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),CS.exports=sK(),CS.exports}var qj;function aK(){if(qj)return dw;qj=1;var e=SM();return dw.createRoot=e.createRoot,dw.hydrateRoot=e.hydrateRoot,dw}var iK=aK();const oK=Ml(iK);var dT=SM();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function My(){return My=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},My.apply(this,arguments)}var gf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(gf||(gf={}));const Yj="popstate";function lK(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return fT("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:CM(s)}return uK(t,r,null,e)}function ga(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function kM(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function cK(){return Math.random().toString(36).substr(2,8)}function Xj(e,t){return{usr:e.state,key:e.key,idx:t}}function fT(e,t,r,n){return r===void 0&&(r=null),My({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Mm(t):t,{state:r,key:t&&t.key||n||cK()})}function CM(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Mm(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function uK(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=gf.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(My({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function f(){o=gf.Pop;let w=d(),C=w==null?null:w-u;u=w,c&&c({action:o,location:v.location,delta:C})}function g(w,C){o=gf.Push;let k=fT(v.location,w,C);u=d()+1;let _=Xj(k,u),N=v.createHref(k);try{i.pushState(_,"",N)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(N)}a&&c&&c({action:o,location:v.location,delta:1})}function p(w,C){o=gf.Replace;let k=fT(v.location,w,C);u=d();let _=Xj(k,u),N=v.createHref(k);i.replaceState(_,"",N),a&&c&&c({action:o,location:v.location,delta:0})}function x(w){let C=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof w=="string"?w:CM(w);return k=k.replace(/ $/,"%20"),ga(C,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,C)}let v={get action(){return o},get location(){return e(s,i)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Yj,f),c=w,()=>{s.removeEventListener(Yj,f),c=null}},createHref(w){return t(s,w)},createURL:x,encodeLocation(w){let C=x(w);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:g,replace:p,go(w){return i.go(w)}};return v}var Qj;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Qj||(Qj={}));function dK(e,t,r){return r===void 0&&(r="/"),fK(e,t,r)}function fK(e,t,r,n){let s=typeof t=="string"?Mm(t):t,a=NM(s.pathname||"/",r);if(a==null)return null;let i=TM(e);hK(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let u=CK(a);o=bK(i[c],u)}return o}function TM(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(ga(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=zh([n,c.relativePath]),d=r.concat(c);a.children&&a.children.length>0&&(ga(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),TM(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:wK(u,a.index),routesMeta:d})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of EM(a.path))s(a,i,c)}),t}function EM(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=EM(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function hK(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:_K(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const gK=/^:[\w-]+$/,mK=3,pK=2,xK=1,yK=10,vK=-2,Jj=e=>e==="*";function wK(e,t){let r=e.split("/"),n=r.length;return r.some(Jj)&&(n+=vK),t&&(n+=pK),r.filter(s=>!Jj(s)).reduce((s,a)=>s+(gK.test(a)?mK:a===""?xK:yK),n)}function _K(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function bK(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",f=SK({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),g=c.route;if(!f)return null;Object.assign(s,f.params),i.push({params:s,pathname:zh([a,f.pathname]),pathnameBase:AK(zh([a,f.pathnameBase])),route:g}),f.pathnameBase!=="/"&&(a=zh([a,f.pathnameBase]))}return i}function SK(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=kK(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:g,isOptional:p}=d;if(g==="*"){let v=o[f]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[f];return p&&!x?u[g]=void 0:u[g]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function kK(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),kM(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function CK(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return kM(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function NM(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function TK(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Mm(e):e;return{pathname:r?r.startsWith("/")?r:EK(r,t):t,search:jK(n),hash:PK(s)}}function EK(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function NS(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function NK(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function AM(e,t){let r=NK(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function jM(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Mm(e):(s=My({},e),ga(!s.pathname||!s.pathname.includes("?"),NS("?","pathname","search",s)),ga(!s.pathname||!s.pathname.includes("#"),NS("#","pathname","hash",s)),ga(!s.search||!s.search.includes("#"),NS("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let f=t.length-1;if(!n&&i.startsWith("..")){let g=i.split("/");for(;g[0]==="..";)g.shift(),f-=1;s.pathname=g.join("/")}o=f>=0?t[f]:"/"}let c=TK(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const zh=e=>e.join("/").replace(/\/\/+/g,"/"),AK=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),jK=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,PK=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function FK(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const PM=["post","put","patch","delete"];new Set(PM);const OK=["get",...PM];new Set(OK);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ly(){return Ly=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ly.apply(this,arguments)}const xN=S.createContext(null),DK=S.createContext(null),Ev=S.createContext(null),Ib=S.createContext(null),If=S.createContext({outlet:null,matches:[],isDataRoute:!1}),FM=S.createContext(null);function Nv(){return S.useContext(Ib)!=null}function Rb(){return Nv()||ga(!1),S.useContext(Ib).location}function OM(e){S.useContext(Ev).static||S.useLayoutEffect(e)}function Po(){let{isDataRoute:e}=S.useContext(If);return e?KK():IK()}function IK(){Nv()||ga(!1);let e=S.useContext(xN),{basename:t,future:r,navigator:n}=S.useContext(Ev),{matches:s}=S.useContext(If),{pathname:a}=Rb(),i=JSON.stringify(AM(s,r.v7_relativeSplatPath)),o=S.useRef(!1);return OM(()=>{o.current=!0}),S.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let f=jM(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:zh([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,i,a,e])}function Mb(){let{matches:e}=S.useContext(If),t=e[e.length-1];return t?t.params:{}}function RK(e,t){return MK(e,t)}function MK(e,t,r,n){Nv()||ga(!1);let{navigator:s}=S.useContext(Ev),{matches:a}=S.useContext(If),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=Rb(),d;if(t){var f;let w=typeof t=="string"?Mm(t):t;c==="/"||(f=w.pathname)!=null&&f.startsWith(c)||ga(!1),d=w}else d=u;let g=d.pathname||"/",p=g;if(c!=="/"){let w=c.replace(/^\//,"").split("/");p="/"+g.replace(/^\//,"").split("/").slice(w.length).join("/")}let x=dK(e,{pathname:p}),v=zK(x&&x.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:zh([c,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:zh([c,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return t&&v?S.createElement(Ib.Provider,{value:{location:Ly({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:gf.Pop}},v):v}function LK(){let e=VK(),t=FK(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),r?S.createElement("pre",{style:s},r):null,null)}const BK=S.createElement(LK,null);class $K extends S.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?S.createElement(If.Provider,{value:this.props.routeContext},S.createElement(FM.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function UK(e){let{routeContext:t,match:r,children:n}=e,s=S.useContext(xN);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),S.createElement(If.Provider,{value:t},n)}function zK(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);d>=0||ga(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let f=i[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:g,errors:p}=r,x=f.route.loader&&g[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||x){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,f,g)=>{let p,x=!1,v=null,w=null;r&&(p=o&&f.route.id?o[f.route.id]:void 0,v=f.route.errorElement||BK,c&&(u<0&&g===0?(qK("route-fallback"),x=!0,w=null):u===g&&(x=!0,w=f.route.hydrateFallbackElement||null)));let C=t.concat(i.slice(0,g+1)),k=()=>{let _;return p?_=v:x?_=w:f.route.Component?_=S.createElement(f.route.Component,null):f.route.element?_=f.route.element:_=d,S.createElement(UK,{match:f,routeContext:{outlet:d,matches:C,isDataRoute:r!=null},children:_})};return r&&(f.route.ErrorBoundary||f.route.errorElement||g===0)?S.createElement($K,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:k(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):k()},null)}var DM=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(DM||{}),IM=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(IM||{});function WK(e){let t=S.useContext(xN);return t||ga(!1),t}function HK(e){let t=S.useContext(DK);return t||ga(!1),t}function GK(e){let t=S.useContext(If);return t||ga(!1),t}function RM(e){let t=GK(),r=t.matches[t.matches.length-1];return r.route.id||ga(!1),r.route.id}function VK(){var e;let t=S.useContext(FM),r=HK(),n=RM();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function KK(){let{router:e}=WK(DM.UseNavigateStable),t=RM(IM.UseNavigateStable),r=S.useRef(!1);return OM(()=>{r.current=!0}),S.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Ly({fromRouteId:t},a)))},[e,t])}const Zj={};function qK(e,t,r){Zj[e]||(Zj[e]=!0)}function YK(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function ym(e){let{to:t,replace:r,state:n,relative:s}=e;Nv()||ga(!1);let{future:a,static:i}=S.useContext(Ev),{matches:o}=S.useContext(If),{pathname:c}=Rb(),u=Po(),d=jM(t,AM(o,a.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(d);return S.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:s}),[u,f,s,r,n]),null}function Rs(e){ga(!1)}function XK(e){let{basename:t="/",children:r=null,location:n,navigationType:s=gf.Pop,navigator:a,static:i=!1,future:o}=e;Nv()&&ga(!1);let c=t.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:c,navigator:a,static:i,future:Ly({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=Mm(n));let{pathname:d="/",search:f="",hash:g="",state:p=null,key:x="default"}=n,v=S.useMemo(()=>{let w=NM(d,c);return w==null?null:{location:{pathname:w,search:f,hash:g,state:p,key:x},navigationType:s}},[c,d,f,g,p,x,s]);return v==null?null:S.createElement(Ev.Provider,{value:u},S.createElement(Ib.Provider,{children:r,value:v}))}function yN(e){let{children:t,location:r}=e;return RK(hT(t),r)}new Promise(()=>{});function hT(e,t){t===void 0&&(t=[]);let r=[];return S.Children.forEach(e,(n,s)=>{if(!S.isValidElement(n))return;let a=[...t,s];if(n.type===S.Fragment){r.push.apply(r,hT(n.props.children,a));return}n.type!==Rs&&ga(!1),!n.props.index||!n.props.children||ga(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=hT(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const QK="6";try{window.__reactRouterVersion=QK}catch{}const JK="startTransition",e5=bM[JK];function ZK(e){let{basename:t,children:r,future:n,window:s}=e,a=S.useRef();a.current==null&&(a.current=lK({window:s,v5Compat:!0}));let i=a.current,[o,c]=S.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=S.useCallback(f=>{u&&e5?e5(()=>c(f)):c(f)},[c,u]);return S.useLayoutEffect(()=>i.listen(d),[i,d]),S.useEffect(()=>YK(n),[n]),S.createElement(XK,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var t5;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(t5||(t5={}));var r5;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(r5||(r5={}));const Ls={student_subjects:1800*1e3,student_active_tests:600*1e3,student_results_table:600*1e3,teacher_subjects:900*1e3,teacher_classes:900*1e3,teacher_tests:600*1e3,teacher_results_table:600*1e3,admin_users:1200*1e3,admin_teachers:1200*1e3,admin_subjects:1800*1e3,admin_academic_years:3600*1e3,admin_tests:900*1e3,admin_results_table:null,admin_teacher_id:3600*1e3,all_tests:1200*1e3,subjects_dropdown:1800*1e3,grades_classes:3600*1e3,test_progress:120*1e3,anti_cheating:120*1e3,word_matching_test:600*1e3,speaking_test_data:3600*1e3},Bs=e=>{try{const t=localStorage.getItem(e);if(!t)return console.log(" Cache: No data found for key:",e),null;const{data:r,timestamp:n,ttl:s}=JSON.parse(t),a=Date.now()-n;return a>s?(console.log(" Cache: Data expired for key:",e,"age:",a,"ttl:",s),localStorage.removeItem(e),null):(console.log(" Cache: Data found for key:",e,"age:",a,"ttl:",s),r)}catch(t){return console.log(" Cache: Corrupted data for key:",e,t),localStorage.removeItem(e),null}},_s=(e,t,r)=>{try{console.log(" Cache: Setting data for key:",e,"ttl:",r),localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached successfully for key:",e)}catch{console.log(" Cache: Storage full, cleaning old data for key:",e),MM();try{localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached after cleanup for key:",e)}catch{console.warn("Storage full, cannot cache data")}}},MM=()=>{const e=Date.now(),t=Object.keys(localStorage);t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:o}=JSON.parse(a);e-i>o&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=e-10080*60*1e3;t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const o=localStorage.getItem(i);if(o){const{timestamp:c}=JSON.parse(o);return{key:i,timestamp:c}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,o)=>i.timestamp-o.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},vN=e=>{Object.keys(localStorage).forEach(r=>{r.includes(e)&&localStorage.removeItem(r)})},Lm=(e,t,r)=>{const n=`test_progress_${e}_${t}_${r}`,s=`anti_cheating_${e}_${t}_${r}`;if(localStorage.removeItem(n),localStorage.removeItem(s),t==="speaking_test_data"){const a=`speaking_test_data_${e}_${r}`;localStorage.removeItem(a),console.log(`Cleared speaking test data cache for ${r}`)}console.log(`Cleared test data for ${t}_${r}`)},qg=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:Ls,cleanupOldData:MM,clearTestData:Lm,clearUserData:vN,getCachedData:Bs,setCachedData:_s},Symbol.toStringTag,{value:"Module"}));let rc=null,sx=null;function e_(){if(sx!==null)return sx;try{const e="_test";localStorage.setItem(e,"test");const t=localStorage.getItem(e);localStorage.removeItem(e),sx=t==="test"}catch(e){console.warn("localStorage unavailable, falling back to sessionStorage",e),sx=!1}return sx}function By(){return e_()?localStorage:sessionStorage}async function wN(e){try{const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}catch(t){return console.warn("Hash computation failed",t),btoa(e).replace(/[^a-zA-Z0-9]/g,"").substring(0,64)}}async function eq(e,t){try{const r=By();return r.setItem(e,t),r.getItem(e)===t}catch(r){return console.warn("Storage write failed",r),!1}}async function tq(e,t){try{const r=By(),n=await wN(t);return r.setItem(`${e}_hash`,n),await eq(e,t)}catch(r){return console.warn("Failed to store with hash",r),!1}}async function rq(e){try{const t=By(),r=t.getItem(e),n=t.getItem(`${e}_hash`);return!r||!n?!1:await wN(r)===n}catch(t){return console.warn("Hash verification failed",t),!1}}async function nq(e,t=3,r=200){for(let n=0;n<t;n++){if(await e())return!0;await new Promise(a=>setTimeout(a,r))}return!1}const Fs={async set(e){const t=e_(),r=By();if(!t){console.warn(" localStorage unavailable - using sessionStorage (less persistent)");try{r.setItem("auth_token",e);const a=r.getItem("auth_token")===e;return a&&(rc=e),a}catch(s){return console.error("sessionStorage fallback failed",s),!1}}const n=await nq(()=>tq("auth_token",e));return n&&(rc=e),n},async get(){if(rc)return rc;const e=By();if(!e_())try{const t=e.getItem("auth_token");return rc=t,t}catch(t){return console.error("sessionStorage fallback read failed",t),null}try{const t=e.getItem("auth_token");if(!t)return rc=null,null;if(e.getItem("auth_token_hash")){if(!await rq("auth_token"))return rc=null,null}else{console.log("Migrating legacy token to secure storage format...");try{const n=await wN(t);if(e.setItem("auth_token_hash",n),e.getItem("auth_token_hash")!==n)return console.warn("Failed to store hash during migration"),t}catch(n){console.warn("Failed to migrate token hash:",n)}}return rc=t,t}catch(t){return console.warn("Failed to get token",t),rc=null,null}},async clear(){try{e_()&&(localStorage.removeItem("auth_token"),localStorage.removeItem("auth_token_hash"))}catch{}try{sessionStorage.removeItem("auth_token"),sessionStorage.removeItem("auth_token_hash")}catch{}rc=null},clearCache(){rc=null}},n5=Object.freeze(Object.defineProperty({__proto__:null,SecureToken:Fs},Symbol.toStringTag,{value:"Module"})),LM=S.createContext(),BM=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState(null),[a,i]=S.useState(null),[o,c]=S.useState(!1),[u,d]=S.useState(!0),[f,g]=S.useState(null);S.useEffect(()=>{console.log("[AUTH] Initializing application session..."),w()},[]),S.useEffect(()=>{if(o&&a){console.log("[AUTH] Setting up proactive token refresh...");let W=!1;const R=setInterval(async()=>{if(o&&a&&!W){W=!0;try{const z=a||await(window.tokenManager?.getToken()||Fs.get());if(z&&p(z))console.log("[AUTH] Token expired, attempting refresh..."),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(z)try{const Q=JSON.parse(atob(z.split(".")[1])).exp*1e3,ae=Date.now(),X=Q-ae;X<300*1e3&&X>0&&(console.log(`[AUTH] Token expires in ${Math.round(X/1e3)} seconds, refreshing...`),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(K){console.error("[AUTH] Error parsing token for expiration check:",K)}}catch(z){console.error("[AUTH] Error in proactive refresh:",z)}finally{W=!1}}},300*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(R)}}},[o,a]);const p=W=>{if(!W)return!0;try{if(typeof W!="string"||!W.includes("."))return console.warn("[AUTH] Invalid token format - not a JWT"),!0;const R=W.split(".");if(R.length!==3)return console.warn("[AUTH] Invalid token format - not 3 parts"),!0;const z=JSON.parse(atob(R[1])),K=Date.now()/1e3;return z.exp<=K}catch(R){if(console.error("[AUTH] Error decoding token:",R),console.warn("[AUTH] Token appears to be corrupted - clearing authentication"),Fs.clear().catch(()=>{}),localStorage.removeItem("accessToken"),localStorage.removeItem("refresh_token"),localStorage.removeItem("userData"),window.tokenManager)try{window.tokenManager.clearAuth()}catch(z){console.warn("[AUTH] Error clearing token manager:",z)}return!0}},x=async()=>{const W=localStorage.getItem("refresh_token");if(!W)return console.log("[AUTH] No refresh token found"),!1;try{const R=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:W})});if(R.ok){const z=await R.json();console.log("[AUTH] Token refresh successful"),await Fs.set(z.accessToken),localStorage.setItem("refresh_token",z.refreshToken),localStorage.setItem("accessToken",z.accessToken);try{window.tokenManager&&(await window.tokenManager.setToken(z.accessToken),z.refreshToken&&window.tokenManager.setRefreshToken(z.refreshToken))}catch{}return i(z.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",R.status),!1}catch(R){return console.error("[AUTH] Token refresh error:",R),!1}},v=async(W,R={})=>{const z=a||await(window.tokenManager?.getToken()||Fs.get());if(!z)throw new Error("No authentication token found");const K={"Content-Type":"application/json",Authorization:`Bearer ${z}`,...R.headers},Q=await fetch(W,{...R,headers:K});if(Q.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await x()){const X=await(window.tokenManager?.getToken()||Fs.get());return K.Authorization=`Bearer ${X}`,fetch(W,{...R,headers:K})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return Q},w=async()=>{try{console.log("[AUTH] Starting session initialization..."),d(!0);const W=await(window.tokenManager?.getToken()||Fs.get())||localStorage.getItem("accessToken")||localStorage.getItem("token"),R=localStorage.getItem("user_data")||localStorage.getItem("userData"),z=R?JSON.parse(R).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!W,hasUser:!!R,role:z}),W&&z&&R)try{const K=JSON.parse(R);if(p(W))if(console.log("[AUTH] Token expired, attempting refresh..."),await x()){console.log("[AUTH] Token refreshed successfully");const ae=await(window.tokenManager?.getToken()||Fs.get());i(ae)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(W);else i(W);s(z),r(K);try{if(window.tokenManager&&W){await window.tokenManager.setToken(W);const Q=localStorage.getItem("refresh_token");Q&&window.tokenManager.setRefreshToken(Q)}}catch{}c(!0),await _(K,z)}catch(K){console.error("[AUTH] Error parsing stored user data:",K),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),c(!1)}}catch(W){console.error("[AUTH] Session initialization error:",W),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),c(!1)}finally{console.log("[AUTH] Session initialization complete"),d(!1)}},C=async W=>{try{if(d(!0),g(null),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),g("Please wait for the logout process to complete.");return}console.log("Attempting login with:",W.username);let R,z;W.username==="admin"?(R={ok:!0,json:()=>({success:!0,token:"test-token"})},z="admin"):(R=await authService.teacherLogin(W),z="teacher");const K=await R.json();await k(R,z,K)}catch(R){A(R)}finally{d(!1)}},k=async(W,R,z)=>{try{if(W.ok&&z.success&&z.token){i(z.token),s(R),r(z),c(!0);const K=z.accessToken||z.token;await Fs.set(K),localStorage.setItem("refresh_token",z.refreshToken),localStorage.setItem("user_data",JSON.stringify(z)),localStorage.setItem("accessToken",K);try{window.tokenManager&&(await window.tokenManager.setToken(K),z.refreshToken&&window.tokenManager.setRefreshToken(z.refreshToken))}catch{}try{const Q=Date.now(),ae=10080*60*1e3,X=[];for(let ie=0;ie<localStorage.length;ie++){const le=localStorage.key(ie);if(!(!le||!(le.startsWith("test_progress_")||le.startsWith("test_timer_")||le.startsWith("test_shuffle_order_")||le.startsWith("student_results_table_")||le.startsWith("anti_cheating_"))))try{const _e=localStorage.getItem(le);if(!_e){X.push(le);continue}let ne=null;if(_e.startsWith("{")||_e.startsWith("[")){const pe=JSON.parse(_e),Ce=pe.timestamp||pe.lastSaved||pe.lastTickAt||pe.createdAt||pe.updatedAt||pe.startedAt||pe.started_at;Ce&&(ne=new Date(Ce).getTime())}if(!ne){const pe=`${le}__ts`,Ce=localStorage.getItem(pe);Ce&&(ne=parseInt(Ce)||null)}if(!ne)continue;Q-ne>ae&&X.push(le)}catch{}}X.forEach(ie=>{try{localStorage.removeItem(ie)}catch{}})}catch(Q){console.warn("LocalStorage cleanup skipped:",Q)}return await _(z,R),!0}else{const K=z.message||W.statusText||"Login failed";return A(new Error(K)),!1}}catch(K){return A(K),!1}},_=async(W,R)=>{try{switch(R){case"admin":console.log("Admin login successful, role:",W.role),console.log("Admin logged in:",W);break;case"teacher":console.log("Teacher login successful, role:",W.role),console.log("Teacher data:",W.teacher),await E(W),await F();break;case"student":console.log("Student login successful"),N(W);break;default:console.warn("Unknown user role:",R)}}catch(z){console.error("Post-login actions error:",z)}},N=W=>{r(W),console.log("Student info populated:",W)},E=async W=>{r(W),console.log("Teacher info populated:",W)},P=async()=>{try{console.log("Initializing teacher cabinet...")}catch(W){console.error("Error initializing teacher cabinet:",W)}},F=async()=>{try{console.log("Checking teacher subjects...")}catch(W){console.error("Error checking teacher subjects:",W)}},A=W=>{g(W.message||"Login failed"),j()},j=()=>{g(null),d(!1)},I=S.useCallback(()=>{B()},[]),B=async()=>{r(null),s(null),i(null),c(!1),g(null);const W=t?.student_id||t?.teacher_id||t?.admin_id||t?.id;W&&vN(W),await Fs.clear(),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("refresh_token"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&await window.tokenManager.clearAuth(),setTimeout(()=>{Y()},100)},Y=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},Z=()=>t?.id||null,se=()=>n==="admin"?t:null,ee=()=>n==="admin",te=()=>ee()?t?.admin_id:null,L=()=>n==="teacher"?t?.username:null,V=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof C,logout:typeof I,getCurrentTeacherId:typeof Z,isAdmin:typeof ee,getCurrentAdmin:typeof se,getCurrentAdminId:typeof te,getCurrentTeacherUsername:typeof L})};S.useEffect(()=>(window.logout=I,window.getCurrentTeacherId=Z,window.getCurrentAdmin=se,window.isAdmin=ee,window.getCurrentAdminId=te,window.getCurrentTeacherUsername=L,window.checkFunctionAvailability=V,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[I]);const M=S.useCallback(W=>{console.log("Setting user data from external auth:",W),r(W),s(W.role),i(W.token),c(!0),d(!1),g(null),Fs.set(W.token).catch(R=>{console.error("[AUTH] Failed to store token securely:",R)}),localStorage.setItem("user_data",JSON.stringify(W)),localStorage.setItem("accessToken",W.token),window.tokenManager&&window.tokenManager.setToken(W.token).catch(()=>{})},[]),H={user:t,role:n,token:a,isAuthenticated:o,isLoading:u,error:f,login:C,setUserData:M,logout:I,resetLoginForm:j,forceCompleteLogout:B,initializeApplicationSession:w,makeAuthenticatedRequest:v,populateStudentInfo:N,populateTeacherInfo:E,initializeTeacherCabinet:P,checkTeacherSubjects:F,getCurrentTeacherId:Z,getCurrentAdmin:se,isAdmin:ee,getCurrentAdminId:te,getCurrentTeacherUsername:L,handleLoginResponse:k,handlePostLoginActions:_,handleLoginFailure:A,resetInterfaceAfterSessionClear:Y,checkFunctionAvailability:V};return l.jsx(LM.Provider,{value:H,children:e})},ds=()=>{const e=S.useContext(LM);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};class sq{constructor(){this.baseURL="https://mathayomwatsing.netlify.app/.netlify/functions.",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}async getHeaders(){const t=await(window.tokenManager?.getToken()||Fs.get())||localStorage.getItem("token");return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}async sendRequest(t,r){try{return await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error(" Network error:",n),n}}async request(t,r={}){const n=`${this.baseURL}${t}`,a={method:"GET",headers:await this.getHeaders(),timeout:this.timeout,...r};let i;for(let o=0;o<this.retryCount;o++)try{const c=new AbortController,u=setTimeout(()=>c.abort(),this.timeout),d=await fetch(n,{...a,signal:c.signal});if(clearTimeout(u),!d.ok)throw new Error(`HTTP error! status: ${d.status}`);return await d.json()}catch(c){if(i=c,c.name==="AbortError")throw new Error("Request timeout");o<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${o+1}/${this.retryCount})`),await new Promise(u=>setTimeout(u,this.retryDelay*Math.pow(2,o))))}throw i}async get(t,r={}){return this.request(t,{...r,method:"GET"})}async post(t,r,n={}){return this.request(t,{...n,method:"POST",body:JSON.stringify(r)})}async put(t,r,n={}){return this.request(t,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(t,r={}){return this.request(t,{...r,method:"DELETE"})}async patch(t,r,n={}){return this.request(t,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(t,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${t}`,i=await(window.tokenManager?.getToken()||Fs.get())||localStorage.getItem("token"),o={method:"POST",headers:{...i&&{Authorization:`Bearer ${i}`}},body:s,...n};try{const c=await fetch(a,o);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);return await c.json()}catch(c){throw c}}async downloadFile(t,r,n={}){const s=`${this.baseURL}${t}`,i={method:"GET",headers:await this.getHeaders(),...n};try{const o=await fetch(s,i);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const c=await o.blob(),u=window.URL.createObjectURL(c),d=document.createElement("a");d.href=u,d.download=r,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(u)}catch(o){throw o}}ensureDebugOutput(){let t=document.getElementById("debug-output");return t||(t=document.createElement("div"),t.id="debug-output",t.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",t.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(t)),t}async testDbConnection(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,message:"Database connection failed",error:t.message}}}async testStudentLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testTeacherLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testAdminLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetTeacherSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetClassResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentTestResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testEndpoints(){const t=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of t)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(t){const r=this.ensureDebugOutput();try{let n;switch(t){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${t}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${t}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${t}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const t=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;t.innerHTML=r}}const js=new sq,_N=S.createContext({});function bN(e){const t=S.useRef(null);return t.current===null&&(t.current=e()),t.current}const SN=typeof window<"u",$M=SN?S.useLayoutEffect:S.useEffect,Lb=S.createContext(null);function kN(e,t){e.indexOf(t)===-1&&e.push(t)}function CN(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const nd=(e,t,r)=>r>t?t:r<e?e:r;let TN=()=>{};const sd={},UM=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function zM(e){return typeof e=="object"&&e!==null}const WM=e=>/^0[^.\s]+$/u.test(e);function EN(e){let t;return()=>(t===void 0&&(t=e()),t)}const Al=e=>e,aq=(e,t)=>r=>t(e(r)),Av=(...e)=>e.reduce(aq),$y=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class NN{constructor(){this.subscriptions=[]}add(t){return kN(this.subscriptions,t),()=>CN(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Jc=e=>e*1e3,Zc=e=>e/1e3;function HM(e,t){return t?e*(1e3/t):0}const GM=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,iq=1e-7,oq=12;function lq(e,t,r,n,s){let a,i,o=0;do i=t+(r-t)/2,a=GM(i,n,s)-e,a>0?r=i:t=i;while(Math.abs(a)>iq&&++o<oq);return i}function jv(e,t,r,n){if(e===t&&r===n)return Al;const s=a=>lq(a,0,1,e,r);return a=>a===0||a===1?a:GM(s(a),t,n)}const VM=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,KM=e=>t=>1-e(1-t),qM=jv(.33,1.53,.69,.99),AN=KM(qM),YM=VM(AN),XM=e=>(e*=2)<1?.5*AN(e):.5*(2-Math.pow(2,-10*(e-1))),jN=e=>1-Math.sin(Math.acos(e)),QM=KM(jN),JM=VM(jN),cq=jv(.42,0,1,1),uq=jv(0,0,.58,1),ZM=jv(.42,0,.58,1),dq=e=>Array.isArray(e)&&typeof e[0]!="number",e7=e=>Array.isArray(e)&&typeof e[0]=="number",fq={linear:Al,easeIn:cq,easeInOut:ZM,easeOut:uq,circIn:jN,circInOut:JM,circOut:QM,backIn:AN,backInOut:YM,backOut:qM,anticipate:XM},hq=e=>typeof e=="string",s5=e=>{if(e7(e)){TN(e.length===4);const[t,r,n,s]=e;return jv(t,r,n,s)}else if(hq(e))return fq[e];return e},fw=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function gq(e,t){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(d){i.has(d)&&(u.schedule(d),e()),d(o)}const u={schedule:(d,f=!1,g=!1)=>{const x=g&&s?r:n;return f&&i.add(d),x.has(d)||x.add(d),d},cancel:d=>{n.delete(d),i.delete(d)},process:d=>{if(o=d,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(c),r.clear(),s=!1,a&&(a=!1,u.process(d))}};return u}const mq=40;function t7(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=fw.reduce((_,N)=>(_[N]=gq(a),_),{}),{setup:o,read:c,resolveKeyframes:u,preUpdate:d,update:f,preRender:g,render:p,postRender:x}=i,v=()=>{const _=sd.useManualTiming?s.timestamp:performance.now();r=!1,sd.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(_-s.timestamp,mq),1)),s.timestamp=_,s.isProcessing=!0,o.process(s),c.process(s),u.process(s),d.process(s),f.process(s),g.process(s),p.process(s),x.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(v))},w=()=>{r=!0,n=!0,s.isProcessing||e(v)};return{schedule:fw.reduce((_,N)=>{const E=i[N];return _[N]=(P,F=!1,A=!1)=>(r||w(),E.schedule(P,F,A)),_},{}),cancel:_=>{for(let N=0;N<fw.length;N++)i[fw[N]].cancel(_)},state:s,steps:i}}const{schedule:ps,cancel:Tf,state:ci,steps:AS}=t7(typeof requestAnimationFrame<"u"?requestAnimationFrame:Al,!0);let t_;function pq(){t_=void 0}const Co={now:()=>(t_===void 0&&Co.set(ci.isProcessing||sd.useManualTiming?ci.timestamp:performance.now()),t_),set:e=>{t_=e,queueMicrotask(pq)}},r7=e=>t=>typeof t=="string"&&t.startsWith(e),PN=r7("--"),xq=r7("var(--"),FN=e=>xq(e)?yq.test(e.split("/*")[0].trim()):!1,yq=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Bm={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Uy={...Bm,transform:e=>nd(0,1,e)},hw={...Bm,default:1},xy=e=>Math.round(e*1e5)/1e5,ON=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function vq(e){return e==null}const wq=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,DN=(e,t)=>r=>!!(typeof r=="string"&&wq.test(r)&&r.startsWith(e)||t&&!vq(r)&&Object.prototype.hasOwnProperty.call(r,t)),n7=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(ON);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},_q=e=>nd(0,255,e),jS={...Bm,transform:e=>Math.round(_q(e))},Dh={test:DN("rgb","red"),parse:n7("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+jS.transform(e)+", "+jS.transform(t)+", "+jS.transform(r)+", "+xy(Uy.transform(n))+")"};function bq(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const gT={test:DN("#"),parse:bq,transform:Dh.transform},Pv=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),cf=Pv("deg"),eu=Pv("%"),Mr=Pv("px"),Sq=Pv("vh"),kq=Pv("vw"),a5={...eu,parse:e=>eu.parse(e)/100,transform:e=>eu.transform(e*100)},Yg={test:DN("hsl","hue"),parse:n7("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+eu.transform(xy(t))+", "+eu.transform(xy(r))+", "+xy(Uy.transform(n))+")"},da={test:e=>Dh.test(e)||gT.test(e)||Yg.test(e),parse:e=>Dh.test(e)?Dh.parse(e):Yg.test(e)?Yg.parse(e):gT.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Dh.transform(e):Yg.transform(e),getAnimatableNone:e=>{const t=da.parse(e);return t.alpha=0,da.transform(t)}},Cq=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Tq(e){return isNaN(e)&&typeof e=="string"&&(e.match(ON)?.length||0)+(e.match(Cq)?.length||0)>0}const s7="number",a7="color",Eq="var",Nq="var(",i5="${}",Aq=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function zy(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=t.replace(Aq,c=>(da.test(c)?(n.color.push(a),s.push(a7),r.push(da.parse(c))):c.startsWith(Nq)?(n.var.push(a),s.push(Eq),r.push(c)):(n.number.push(a),s.push(s7),r.push(parseFloat(c))),++a,i5)).split(i5);return{values:r,split:o,indexes:n,types:s}}function i7(e){return zy(e).values}function o7(e){const{split:t,types:r}=zy(e),n=t.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=t[i],s[i]!==void 0){const o=r[i];o===s7?a+=xy(s[i]):o===a7?a+=da.transform(s[i]):a+=s[i]}return a}}const jq=e=>typeof e=="number"?0:da.test(e)?da.getAnimatableNone(e):e;function Pq(e){const t=i7(e);return o7(e)(t.map(jq))}const Ef={test:Tq,parse:i7,createTransformer:o7,getAnimatableNone:Pq};function PS(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Fq({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,i=0;if(!t)s=a=i=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;s=PS(c,o,e+1/3),a=PS(c,o,e),i=PS(c,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function m_(e,t){return r=>r>0?t:e}const bs=(e,t,r)=>e+(t-e)*r,FS=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},Oq=[gT,Dh,Yg],Dq=e=>Oq.find(t=>t.test(e));function o5(e){const t=Dq(e);if(!t)return!1;let r=t.parse(e);return t===Yg&&(r=Fq(r)),r}const l5=(e,t)=>{const r=o5(e),n=o5(t);if(!r||!n)return m_(e,t);const s={...r};return a=>(s.red=FS(r.red,n.red,a),s.green=FS(r.green,n.green,a),s.blue=FS(r.blue,n.blue,a),s.alpha=bs(r.alpha,n.alpha,a),Dh.transform(s))},mT=new Set(["none","hidden"]);function Iq(e,t){return mT.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function Rq(e,t){return r=>bs(e,t,r)}function IN(e){return typeof e=="number"?Rq:typeof e=="string"?FN(e)?m_:da.test(e)?l5:Bq:Array.isArray(e)?l7:typeof e=="object"?da.test(e)?l5:Mq:m_}function l7(e,t){const r=[...e],n=r.length,s=e.map((a,i)=>IN(a)(a,t[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function Mq(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=IN(e[s])(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function Lq(e,t){const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],i=e.indexes[a][n[a]],o=e.values[i]??0;r[s]=o,n[a]++}return r}const Bq=(e,t)=>{const r=Ef.createTransformer(t),n=zy(e),s=zy(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?mT.has(e)&&!s.values.length||mT.has(t)&&!n.values.length?Iq(e,t):Av(l7(Lq(n,s),s.values),r):m_(e,t)};function c7(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?bs(e,t,r):IN(e)(e,t)}const $q=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>ps.update(t,r),stop:()=>Tf(t),now:()=>ci.isProcessing?ci.timestamp:Co.now()}},u7=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let a=0;a<s;a++)n+=Math.round(e(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},p_=2e4;function RN(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<p_;)t+=r,n=e.next(t);return t>=p_?1/0:t}function Uq(e,t=100,r){const n=r({...e,keyframes:[0,t]}),s=Math.min(RN(n),p_);return{type:"keyframes",ease:a=>n.next(s*a).value/t,duration:Zc(s)}}const zq=5;function d7(e,t,r){const n=Math.max(t-zq,0);return HM(r-e(n),t-n)}const Os={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},OS=.001;function Wq({duration:e=Os.duration,bounce:t=Os.bounce,velocity:r=Os.velocity,mass:n=Os.mass}){let s,a,i=1-t;i=nd(Os.minDamping,Os.maxDamping,i),e=nd(Os.minDuration,Os.maxDuration,Zc(e)),i<1?(s=u=>{const d=u*i,f=d*e,g=d-r,p=pT(u,i),x=Math.exp(-f);return OS-g/p*x},a=u=>{const f=u*i*e,g=f*r+r,p=Math.pow(i,2)*Math.pow(u,2)*e,x=Math.exp(-f),v=pT(Math.pow(u,2),i);return(-s(u)+OS>0?-1:1)*((g-p)*x)/v}):(s=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-OS+d*f},a=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const o=5/e,c=Gq(s,a,o);if(e=Jc(e),isNaN(c))return{stiffness:Os.stiffness,damping:Os.damping,duration:e};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:i*2*Math.sqrt(n*u),duration:e}}}const Hq=12;function Gq(e,t,r){let n=r;for(let s=1;s<Hq;s++)n=n-e(n)/t(n);return n}function pT(e,t){return e*Math.sqrt(1-t*t)}const Vq=["duration","bounce"],Kq=["stiffness","damping","mass"];function c5(e,t){return t.some(r=>e[r]!==void 0)}function qq(e){let t={velocity:Os.velocity,stiffness:Os.stiffness,damping:Os.damping,mass:Os.mass,isResolvedFromDuration:!1,...e};if(!c5(e,Kq)&&c5(e,Vq))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*nd(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:Os.mass,stiffness:s,damping:a}}else{const r=Wq(e);t={...t,...r,mass:Os.mass},t.isResolvedFromDuration=!0}return t}function x_(e=Os.visualDuration,t=Os.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:c,damping:u,mass:d,duration:f,velocity:g,isResolvedFromDuration:p}=qq({...r,velocity:-Zc(r.velocity||0)}),x=g||0,v=u/(2*Math.sqrt(c*d)),w=i-a,C=Zc(Math.sqrt(c/d)),k=Math.abs(w)<5;n||(n=k?Os.restSpeed.granular:Os.restSpeed.default),s||(s=k?Os.restDelta.granular:Os.restDelta.default);let _;if(v<1){const E=pT(C,v);_=P=>{const F=Math.exp(-v*C*P);return i-F*((x+v*C*w)/E*Math.sin(E*P)+w*Math.cos(E*P))}}else if(v===1)_=E=>i-Math.exp(-C*E)*(w+(x+C*w)*E);else{const E=C*Math.sqrt(v*v-1);_=P=>{const F=Math.exp(-v*C*P),A=Math.min(E*P,300);return i-F*((x+v*C*w)*Math.sinh(A)+E*w*Math.cosh(A))/E}}const N={calculatedDuration:p&&f||null,next:E=>{const P=_(E);if(p)o.done=E>=f;else{let F=E===0?x:0;v<1&&(F=E===0?Jc(x):d7(_,E,P));const A=Math.abs(F)<=n,j=Math.abs(i-P)<=s;o.done=A&&j}return o.value=o.done?i:P,o},toString:()=>{const E=Math.min(RN(N),p_),P=u7(F=>N.next(E*F).value,E,30);return E+"ms "+P},toTransition:()=>{}};return N}x_.applyToOptions=e=>{const t=Uq(e,100,x_);return e.ease=t.ease,e.duration=Jc(t.duration),e.type="keyframes",e};function xT({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],g={done:!1,value:f},p=A=>o!==void 0&&A<o||c!==void 0&&A>c,x=A=>o===void 0?c:c===void 0||Math.abs(o-A)<Math.abs(c-A)?o:c;let v=r*t;const w=f+v,C=i===void 0?w:i(w);C!==w&&(v=C-f);const k=A=>-v*Math.exp(-A/n),_=A=>C+k(A),N=A=>{const j=k(A),I=_(A);g.done=Math.abs(j)<=u,g.value=g.done?C:I};let E,P;const F=A=>{p(g.value)&&(E=A,P=x_({keyframes:[g.value,x(g.value)],velocity:d7(_,A,g.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return F(0),{calculatedDuration:null,next:A=>{let j=!1;return!P&&E===void 0&&(j=!0,N(A),F(A)),E!==void 0&&A>=E?P.next(A-E):(!j&&N(A),g)}}}function Yq(e,t,r){const n=[],s=r||sd.mix||c7,a=e.length-1;for(let i=0;i<a;i++){let o=s(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||Al:t;o=Av(c,o)}n.push(o)}return n}function Xq(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(TN(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=Yq(t,n,s),c=o.length,u=d=>{if(i&&d<e[0])return t[0];let f=0;if(c>1)for(;f<e.length-2&&!(d<e[f+1]);f++);const g=$y(e[f],e[f+1],d);return o[f](g)};return r?d=>u(nd(e[0],e[a-1],d)):u}function Qq(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=$y(0,t,n);e.push(bs(r,1,s))}}function Jq(e){const t=[0];return Qq(t,e.length-1),t}function Zq(e,t){return e.map(r=>r*t)}function eY(e,t){return e.map(()=>t||ZM).splice(0,e.length-1)}function yy({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=dq(n)?n.map(s5):s5(n),a={done:!1,value:t[0]},i=Zq(r&&r.length===t.length?r:Jq(t),e),o=Xq(i,t,{ease:Array.isArray(s)?s:eY(t,s)});return{calculatedDuration:e,next:c=>(a.value=o(c),a.done=c>=e,a)}}const tY=e=>e!==null;function MN(e,{repeat:t,repeatType:r="loop"},n,s=1){const a=e.filter(tY),o=s<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const rY={decay:xT,inertia:xT,tween:yy,keyframes:yy,spring:x_};function f7(e){typeof e.type=="string"&&(e.type=rY[e.type])}class LN{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const nY=e=>e/100;class BN extends LN{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==Co.now()&&this.tick(Co.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;f7(t);const{type:r=yy,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=t;let{keyframes:o}=t;const c=r||yy;c!==yy&&typeof o[0]!="number"&&(this.mixKeyframes=Av(nY,c7(o[0],o[1])),o=[0,100]);const u=c({...t,keyframes:o});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...o].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=RN(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=u}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:d,repeat:f,repeatType:g,repeatDelay:p,type:x,onUpdate:v,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const C=this.currentTime-u*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?C<0:C>s;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let _=this.currentTime,N=n;if(f){const A=Math.min(this.currentTime,s)/o;let j=Math.floor(A),I=A%1;!I&&A>=1&&(I=1),I===1&&j--,j=Math.min(j,f+1),!!(j%2)&&(g==="reverse"?(I=1-I,p&&(I-=p/o)):g==="mirror"&&(N=i)),_=nd(0,1,I)*o}const E=k?{done:!1,value:d[0]}:N.next(_);a&&(E.value=a(E.value));let{done:P}=E;!k&&c!==null&&(P=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const F=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return F&&x!==xT&&(E.value=MN(d,this.options,w,this.speed)),v&&v(E.value),F&&this.finish(),E}then(t,r){return this.finished.then(t,r)}get duration(){return Zc(this.calculatedDuration)}get time(){return Zc(this.currentTime)}set time(t){t=Jc(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Co.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Zc(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=$q,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Co.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function sY(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Ih=e=>e*180/Math.PI,yT=e=>{const t=Ih(Math.atan2(e[1],e[0]));return vT(t)},aY={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:yT,rotateZ:yT,skewX:e=>Ih(Math.atan(e[1])),skewY:e=>Ih(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},vT=e=>(e=e%360,e<0&&(e+=360),e),u5=yT,d5=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),f5=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),iY={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:d5,scaleY:f5,scale:e=>(d5(e)+f5(e))/2,rotateX:e=>vT(Ih(Math.atan2(e[6],e[5]))),rotateY:e=>vT(Ih(Math.atan2(-e[2],e[0]))),rotateZ:u5,rotate:u5,skewX:e=>Ih(Math.atan(e[4])),skewY:e=>Ih(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function wT(e){return e.includes("scale")?1:0}function _T(e,t){if(!e||e==="none")return wT(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=iY,s=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=aY,s=o}if(!s)return wT(t);const a=n[t],i=s[1].split(",").map(lY);return typeof a=="function"?a(i):i[a]}const oY=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return _T(r,t)};function lY(e){return parseFloat(e.trim())}const $m=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Um=new Set($m),h5=e=>e===Bm||e===Mr,cY=new Set(["x","y","z"]),uY=$m.filter(e=>!cY.has(e));function dY(e){const t=[];return uY.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const Wh={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>_T(t,"x"),y:(e,{transform:t})=>_T(t,"y")};Wh.translateX=Wh.x;Wh.translateY=Wh.y;const Hh=new Set;let bT=!1,ST=!1,kT=!1;function h7(){if(ST){const e=Array.from(Hh).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=dY(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{n.getValue(a)?.set(i)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}ST=!1,bT=!1,Hh.forEach(e=>e.complete(kT)),Hh.clear()}function g7(){Hh.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(ST=!0)})}function fY(){kT=!0,g7(),h7(),kT=!1}class $N{constructor(t,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Hh.add(this),bT||(bT=!0,ps.read(g7),ps.resolveKeyframes(h7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;if(t[0]===null){const a=s?.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(n&&r){const o=n.readValue(r,i);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=i),s&&a===void 0&&s.set(t[0])}sY(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Hh.delete(this)}cancel(){this.state==="scheduled"&&(Hh.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const hY=e=>e.startsWith("--");function gY(e,t,r){hY(t)?e.style.setProperty(t,r):e.style[t]=r}const mY=EN(()=>window.ScrollTimeline!==void 0),pY={};function xY(e,t){const r=EN(e);return()=>pY[t]??r()}const m7=xY(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ly=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,g5={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ly([0,.65,.55,1]),circOut:ly([.55,0,1,.45]),backIn:ly([.31,.01,.66,-.59]),backOut:ly([.33,1.53,.69,.99])};function p7(e,t){if(e)return typeof e=="function"?m7()?u7(e,t):"ease-out":e7(e)?ly(e):Array.isArray(e)?e.map(r=>p7(r,t)||g5.easeOut):g5[e]}function yY(e,t,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:c}={},u=void 0){const d={[t]:r};c&&(d.offset=c);const f=p7(o,s);Array.isArray(f)&&(d.easing=f);const g={delay:n,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(g.pseudoElement=u),e.animate(d,g)}function x7(e){return typeof e=="function"&&"applyToOptions"in e}function vY({type:e,...t}){return x7(e)&&m7()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class wY extends LN{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,TN(typeof t.type!="string");const u=vY(t);this.animation=yY(r,n,s,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=MN(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):gY(r,n,d),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return Zc(Number(t))}get time(){return Zc(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Jc(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&mY()?(this.animation.timeline=t,Al):r(this)}}const y7={anticipate:XM,backInOut:YM,circInOut:JM};function _Y(e){return e in y7}function bY(e){typeof e.ease=="string"&&_Y(e.ease)&&(e.ease=y7[e.ease])}const m5=10;class SY extends wY{constructor(t){bY(t),f7(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new BN({...i,autoplay:!1}),c=Jc(this.finishedTime??this.time);r.setWithVelocity(o.sample(c-m5).value,o.sample(c).value,m5),o.stop()}}const p5=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Ef.test(e)||e==="0")&&!e.startsWith("url("));function kY(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function CY(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=p5(s,t),o=p5(a,t);return!i||!o?!1:kY(e)||(r==="spring"||x7(r))&&n}function CT(e){e.duration=0,e.type}const TY=new Set(["opacity","clipPath","filter","transform"]),EY=EN(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function NY(e){const{motionValue:t,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=t.owner.getProps();return EY()&&r&&TY.has(r)&&(r!=="transform"||!u)&&!c&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const AY=40;class jY extends LN{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:c,motionValue:u,element:d,...f}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Co.now();const g={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:c,motionValue:u,element:d,...f},p=d?.KeyframeResolver||$N;this.keyframeResolver=new p(o,(x,v,w)=>this.onKeyframesResolved(x,v,g,!w),c,u,d),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:c,isHandoff:u,onUpdate:d}=n;this.resolvedAt=Co.now(),CY(t,a,i,o)||((sd.instantAnimations||!c)&&d?.(MN(t,n,r)),t[0]=t[t.length-1],CT(n),n.repeat=0);const g={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>AY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},p=!u&&NY(g)?new SY({...g,element:g.motionValue.owner.current}):new BN(g);p.finished.then(()=>this.notifyFinished()).catch(Al),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),fY()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const PY=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function FY(e){const t=PY.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function v7(e,t,r=1){const[n,s]=FY(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const i=a.trim();return UM(i)?parseFloat(i):i}return FN(s)?v7(s,t,r+1):s}function UN(e,t){return e?.[t]??e?.default??e}const w7=new Set(["width","height","top","left","right","bottom",...$m]),OY={test:e=>e==="auto",parse:e=>e},_7=e=>t=>t.test(e),b7=[Bm,Mr,eu,cf,kq,Sq,OY],x5=e=>b7.find(_7(e));function DY(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||WM(e):!0}const IY=new Set(["brightness","contrast","saturate","opacity"]);function RY(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(ON)||[];if(!n)return e;const s=r.replace(n,"");let a=IY.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const MY=/\b([a-z-]*)\(.*?\)/gu,TT={...Ef,getAnimatableNone:e=>{const t=e.match(MY);return t?t.map(RY).join(" "):e}},y5={...Bm,transform:Math.round},LY={rotate:cf,rotateX:cf,rotateY:cf,rotateZ:cf,scale:hw,scaleX:hw,scaleY:hw,scaleZ:hw,skew:cf,skewX:cf,skewY:cf,distance:Mr,translateX:Mr,translateY:Mr,translateZ:Mr,x:Mr,y:Mr,z:Mr,perspective:Mr,transformPerspective:Mr,opacity:Uy,originX:a5,originY:a5,originZ:Mr},zN={borderWidth:Mr,borderTopWidth:Mr,borderRightWidth:Mr,borderBottomWidth:Mr,borderLeftWidth:Mr,borderRadius:Mr,radius:Mr,borderTopLeftRadius:Mr,borderTopRightRadius:Mr,borderBottomRightRadius:Mr,borderBottomLeftRadius:Mr,width:Mr,maxWidth:Mr,height:Mr,maxHeight:Mr,top:Mr,right:Mr,bottom:Mr,left:Mr,padding:Mr,paddingTop:Mr,paddingRight:Mr,paddingBottom:Mr,paddingLeft:Mr,margin:Mr,marginTop:Mr,marginRight:Mr,marginBottom:Mr,marginLeft:Mr,backgroundPositionX:Mr,backgroundPositionY:Mr,...LY,zIndex:y5,fillOpacity:Uy,strokeOpacity:Uy,numOctaves:y5},BY={...zN,color:da,backgroundColor:da,outlineColor:da,fill:da,stroke:da,borderColor:da,borderTopColor:da,borderRightColor:da,borderBottomColor:da,borderLeftColor:da,filter:TT,WebkitFilter:TT},S7=e=>BY[e];function k7(e,t){let r=S7(e);return r!==TT&&(r=Ef),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const $Y=new Set(["auto","none","0"]);function UY(e,t,r){let n=0,s;for(;n<e.length&&!s;){const a=e[n];typeof a=="string"&&!$Y.has(a)&&zy(a).values.length&&(s=e[n]),n++}if(s&&r)for(const a of t)e[a]=k7(r,s)}class zY extends $N{constructor(t,r,n,s,a){super(t,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let u=t[c];if(typeof u=="string"&&(u=u.trim(),FN(u))){const d=v7(u,r.current);d!==void 0&&(t[c]=d),c===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!w7.has(n)||t.length!==2)return;const[s,a]=t,i=x5(s),o=x5(a);if(i!==o)if(h5(i)&&h5(o))for(let c=0;c<t.length;c++){const u=t[c];typeof u=="string"&&(t[c]=parseFloat(u))}else Wh[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||DY(t[s]))&&n.push(s);n.length&&UY(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Wh[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=Wh[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,c])=>{t.getValue(o).set(c)}),this.resolveNoneKeyframes()}}function WY(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const s=r?.[e]??n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const C7=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function T7(e){return zM(e)&&"offsetHeight"in e}const v5=30,HY=e=>!isNaN(parseFloat(e));class GY{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=Co.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Co.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=HY(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new NN);const n=this.events[t].add(r);return t==="change"?()=>{n(),ps.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Co.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>v5)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,v5);return HM(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function vm(e,t){return new GY(e,t)}const{schedule:WN}=t7(queueMicrotask,!1),ac={x:!1,y:!1};function E7(){return ac.x||ac.y}function VY(e){return e==="x"||e==="y"?ac[e]?null:(ac[e]=!0,()=>{ac[e]=!1}):ac.x||ac.y?null:(ac.x=ac.y=!0,()=>{ac.x=ac.y=!1})}function N7(e,t){const r=WY(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function w5(e){return!(e.pointerType==="touch"||E7())}function KY(e,t,r={}){const[n,s,a]=N7(e,r),i=o=>{if(!w5(o))return;const{target:c}=o,u=t(c,o);if(typeof u!="function"||!c)return;const d=f=>{w5(f)&&(u(f),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,s)};return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const A7=(e,t)=>t?e===t?!0:A7(e,t.parentElement):!1,HN=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,qY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function YY(e){return qY.has(e.tagName)||e.tabIndex!==-1}const r_=new WeakSet;function _5(e){return t=>{t.key==="Enter"&&e(t)}}function DS(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const XY=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=_5(()=>{if(r_.has(r))return;DS(r,"down");const s=_5(()=>{DS(r,"up")}),a=()=>DS(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function b5(e){return HN(e)&&!E7()}function QY(e,t,r={}){const[n,s,a]=N7(e,r),i=o=>{const c=o.currentTarget;if(!b5(o))return;r_.add(c);const u=t(c,o),d=(p,x)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",g),r_.has(c)&&r_.delete(c),b5(p)&&typeof u=="function"&&u(p,{success:x})},f=p=>{d(p,c===window||c===document||r.useGlobalTarget||A7(c,p.target))},g=p=>{d(p,!1)};window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",g,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),T7(o)&&(o.addEventListener("focus",u=>XY(u,s)),!YY(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function j7(e){return zM(e)&&"ownerSVGElement"in e}function JY(e){return j7(e)&&e.tagName==="svg"}const Ri=e=>!!(e&&e.getVelocity),ZY=[...b7,da,Ef],eX=e=>ZY.find(_7(e)),GN=S.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class tX extends S.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=T7(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function rX({children:e,isPresent:t,anchorX:r,root:n}){const s=S.useId(),a=S.useRef(null),i=S.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=S.useContext(GN);return S.useInsertionEffect(()=>{const{width:c,height:u,top:d,left:f,right:g}=i.current;if(t||!a.current||!c||!u)return;const p=r==="left"?`left: ${f}`:`right: ${g}`;a.current.dataset.motionPopId=s;const x=document.createElement("style");o&&(x.nonce=o);const v=n??document.head;return v.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${u}px !important;
            ${p}px !important;
            top: ${d}px !important;
          }
        `),()=>{v.contains(x)&&v.removeChild(x)}},[t]),l.jsx(tX,{isPresent:t,childRef:a,sizeRef:i,children:S.cloneElement(e,{ref:a})})}const nX=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:o,root:c})=>{const u=bN(sX),d=S.useId();let f=!0,g=S.useMemo(()=>(f=!1,{id:d,initial:t,isPresent:r,custom:s,onExitComplete:p=>{u.set(p,!0);for(const x of u.values())if(!x)return;n&&n()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[r,u,n]);return a&&f&&(g={...g}),S.useMemo(()=>{u.forEach((p,x)=>u.set(x,!1))},[r]),S.useEffect(()=>{!r&&!u.size&&n&&n()},[r]),i==="popLayout"&&(e=l.jsx(rX,{isPresent:r,anchorX:o,root:c,children:e})),l.jsx(Lb.Provider,{value:g,children:e})};function sX(){return new Map}function P7(e=!0){const t=S.useContext(Lb);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,a=S.useId();S.useEffect(()=>{if(e)return s(a)},[e]);const i=S.useCallback(()=>e&&n&&n(a),[a,n,e]);return!r&&n?[!1,i]:[!0]}const gw=e=>e.key||"";function S5(e){const t=[];return S.Children.forEach(e,r=>{S.isValidElement(r)&&t.push(r)}),t}const ko=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:c})=>{const[u,d]=P7(i),f=S.useMemo(()=>S5(e),[e]),g=i&&!u?[]:f.map(gw),p=S.useRef(!0),x=S.useRef(f),v=bN(()=>new Map),[w,C]=S.useState(f),[k,_]=S.useState(f);$M(()=>{p.current=!1,x.current=f;for(let P=0;P<k.length;P++){const F=gw(k[P]);g.includes(F)?v.delete(F):v.get(F)!==!0&&v.set(F,!1)}},[k,g.length,g.join("-")]);const N=[];if(f!==w){let P=[...f];for(let F=0;F<k.length;F++){const A=k[F],j=gw(A);g.includes(j)||(P.splice(F,0,A),N.push(A))}return a==="wait"&&N.length&&(P=N),_(S5(P)),C(f),null}const{forceRender:E}=S.useContext(_N);return l.jsx(l.Fragment,{children:k.map(P=>{const F=gw(P),A=i&&!u?!1:f===k||g.includes(F),j=()=>{if(v.has(F))v.set(F,!0);else return;let I=!0;v.forEach(B=>{B||(I=!1)}),I&&(E?.(),_(x.current),i&&d?.(),n&&n())};return l.jsx(nX,{isPresent:A,initial:!p.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:a,root:c,onExitComplete:A?void 0:j,anchorX:o,children:P},F)})})},F7=S.createContext({strict:!1}),k5={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},wm={};for(const e in k5)wm[e]={isEnabled:t=>k5[e].some(r=>!!t[r])};function aX(e){for(const t in e)wm[t]={...wm[t],...e[t]}}const iX=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function y_(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||iX.has(e)}let O7=e=>!y_(e);function oX(e){typeof e=="function"&&(O7=t=>t.startsWith("on")?!y_(t):e(t))}try{oX(require("@emotion/is-prop-valid").default)}catch{}function lX(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(O7(s)||r===!0&&y_(s)||!t&&!y_(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}const Bb=S.createContext({});function $b(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Wy(e){return typeof e=="string"||Array.isArray(e)}const VN=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],KN=["initial",...VN];function Ub(e){return $b(e.animate)||KN.some(t=>Wy(e[t]))}function D7(e){return!!(Ub(e)||e.variants)}function cX(e,t){if(Ub(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Wy(r)?r:void 0,animate:Wy(n)?n:void 0}}return e.inherit!==!1?t:{}}function uX(e){const{initial:t,animate:r}=cX(e,S.useContext(Bb));return S.useMemo(()=>({initial:t,animate:r}),[C5(t),C5(r)])}function C5(e){return Array.isArray(e)?e.join(" "):e}const Hy={};function dX(e){for(const t in e)Hy[t]=e[t],PN(t)&&(Hy[t].isCSSVariable=!0)}function I7(e,{layout:t,layoutId:r}){return Um.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Hy[e]||e==="opacity")}const fX={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},hX=$m.length;function gX(e,t,r){let n="",s=!0;for(let a=0;a<hX;a++){const i=$m[a],o=e[i];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(i.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||r){const u=C7(o,zN[i]);if(!c){s=!1;const d=fX[i]||i;n+=`${d}(${u}) `}r&&(t[i]=u)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function qN(e,t,r){const{style:n,vars:s,transformOrigin:a}=e;let i=!1,o=!1;for(const c in t){const u=t[c];if(Um.has(c)){i=!0;continue}else if(PN(c)){s[c]=u;continue}else{const d=C7(u,zN[c]);c.startsWith("origin")?(o=!0,a[c]=d):n[c]=d}}if(t.transform||(i||r?n.transform=gX(t,e.transform,r):n.transform&&(n.transform="none")),o){const{originX:c="50%",originY:u="50%",originZ:d=0}=a;n.transformOrigin=`${c} ${u} ${d}`}}const YN=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function R7(e,t,r){for(const n in t)!Ri(t[n])&&!I7(n,r)&&(e[n]=t[n])}function mX({transformTemplate:e},t){return S.useMemo(()=>{const r=YN();return qN(r,t,e),Object.assign({},r.vars,r.style)},[t])}function pX(e,t){const r=e.style||{},n={};return R7(n,r,e),Object.assign(n,mX(e,t)),n}function xX(e,t){const r={},n=pX(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const yX={offset:"stroke-dashoffset",array:"stroke-dasharray"},vX={offset:"strokeDashoffset",array:"strokeDasharray"};function wX(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?yX:vX;e[a.offset]=Mr.transform(-n);const i=Mr.transform(t),o=Mr.transform(r);e[a.array]=`${i} ${o}`}function M7(e,{attrX:t,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...o},c,u,d){if(qN(e,o,u),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:g}=e;f.transform&&(g.transform=f.transform,delete f.transform),(g.transform||f.transformOrigin)&&(g.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),g.transform&&(g.transformBox=d?.transformBox??"fill-box",delete f.transformBox),t!==void 0&&(f.x=t),r!==void 0&&(f.y=r),n!==void 0&&(f.scale=n),s!==void 0&&wX(f,s,a,i,!1)}const L7=()=>({...YN(),attrs:{}}),B7=e=>typeof e=="string"&&e.toLowerCase()==="svg";function _X(e,t,r,n){const s=S.useMemo(()=>{const a=L7();return M7(a,t,B7(n),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};R7(a,e.style,e),s.style={...a,...s.style}}return s}const bX=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function XN(e){return typeof e!="string"||e.includes("-")?!1:!!(bX.indexOf(e)>-1||/[A-Z]/u.test(e))}function SX(e,t,r,{latestValues:n},s,a=!1){const o=(XN(e)?_X:xX)(t,n,s,e),c=lX(t,typeof e=="string",a),u=e!==S.Fragment?{...c,...o,ref:r}:{},{children:d}=t,f=S.useMemo(()=>Ri(d)?d.get():d,[d]);return S.createElement(e,{...u,children:f})}function T5(e){const t=[{},{}];return e?.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function QN(e,t,r,n){if(typeof t=="function"){const[s,a]=T5(n);t=t(r!==void 0?r:e.custom,s,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,a]=T5(n);t=t(r!==void 0?r:e.custom,s,a)}return t}function n_(e){return Ri(e)?e.get():e}function kX({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,s){return{latestValues:CX(r,n,s,e),renderState:t()}}function CX(e,t,r,n){const s={},a=n(e,{});for(const g in a)s[g]=n_(a[g]);let{initial:i,animate:o}=e;const c=Ub(e),u=D7(e);t&&u&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const f=d?o:i;if(f&&typeof f!="boolean"&&!$b(f)){const g=Array.isArray(f)?f:[f];for(let p=0;p<g.length;p++){const x=QN(e,g[p]);if(x){const{transitionEnd:v,transition:w,...C}=x;for(const k in C){let _=C[k];if(Array.isArray(_)){const N=d?_.length-1:0;_=_[N]}_!==null&&(s[k]=_)}for(const k in v)s[k]=v[k]}}}return s}const $7=e=>(t,r)=>{const n=S.useContext(Bb),s=S.useContext(Lb),a=()=>kX(e,t,n,s);return r?a():bN(a)};function JN(e,t,r){const{style:n}=e,s={};for(const a in n)(Ri(n[a])||t.style&&Ri(t.style[a])||I7(a,e)||r?.getValue(a)?.liveStyle!==void 0)&&(s[a]=n[a]);return s}const TX=$7({scrapeMotionValuesFromProps:JN,createRenderState:YN});function U7(e,t,r){const n=JN(e,t,r);for(const s in e)if(Ri(e[s])||Ri(t[s])){const a=$m.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=e[s]}return n}const EX=$7({scrapeMotionValuesFromProps:U7,createRenderState:L7}),NX=Symbol.for("motionComponentSymbol");function Xg(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function AX(e,t,r){return S.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Xg(r)&&(r.current=n))},[t])}const ZN=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),jX="framerAppearId",z7="data-"+ZN(jX),W7=S.createContext({});function PX(e,t,r,n,s){const{visualElement:a}=S.useContext(Bb),i=S.useContext(F7),o=S.useContext(Lb),c=S.useContext(GN).reducedMotion,u=S.useRef(null);n=n||i.renderer,!u.current&&n&&(u.current=n(e,{visualState:t,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,f=S.useContext(W7);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&FX(u.current,r,s,f);const g=S.useRef(!1);S.useInsertionEffect(()=>{d&&g.current&&d.update(r,o)});const p=r[z7],x=S.useRef(!!p&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return $M(()=>{d&&(g.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),x.current&&d.animationState&&d.animationState.animateChanges())}),S.useEffect(()=>{d&&(!x.current&&d.animationState&&d.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),x.current=!1),d.enteringChildren=void 0)}),d}function FX(e,t,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:H7(e.parent)),e.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&Xg(o),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:c,layoutRoot:u})}function H7(e){if(e)return e.options.allowProjection!==!1?e.projection:H7(e.parent)}function IS(e,{forwardMotionProps:t=!1}={},r,n){r&&aX(r);const s=XN(e)?EX:TX;function a(o,c){let u;const d={...S.useContext(GN),...o,layoutId:OX(o)},{isStatic:f}=d,g=uX(o),p=s(o,f);if(!f&&SN){DX();const x=IX(d);u=x.MeasureLayout,g.visualElement=PX(e,p,d,n,x.ProjectionNode)}return l.jsxs(Bb.Provider,{value:g,children:[u&&g.visualElement?l.jsx(u,{visualElement:g.visualElement,...d}):null,SX(e,o,AX(p,g.visualElement,c),p,f,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=S.forwardRef(a);return i[NX]=e,i}function OX({layoutId:e}){const t=S.useContext(_N).id;return t&&e!==void 0?t+"-"+e:e}function DX(e,t){S.useContext(F7).strict}function IX(e){const{drag:t,layout:r}=wm;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function RX(e,t){if(typeof Proxy>"u")return IS;const r=new Map,n=(a,i)=>IS(a,i,e,t),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,IS(i,void 0,e,t)),r.get(i))})}function G7({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function MX({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function LX(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function RS(e){return e===void 0||e===1}function ET({scale:e,scaleX:t,scaleY:r}){return!RS(e)||!RS(t)||!RS(r)}function Nh(e){return ET(e)||V7(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function V7(e){return E5(e.x)||E5(e.y)}function E5(e){return e&&e!=="0%"}function v_(e,t,r){const n=e-r,s=t*n;return r+s}function N5(e,t,r,n,s){return s!==void 0&&(e=v_(e,s,n)),v_(e,r,n)+t}function NT(e,t=0,r=1,n,s){e.min=N5(e.min,t,r,n,s),e.max=N5(e.max,t,r,n,s)}function K7(e,{x:t,y:r}){NT(e.x,t.translate,t.scale,t.originPoint),NT(e.y,r.translate,r.scale,r.originPoint)}const A5=.999999999999,j5=1.0000000000001;function BX(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Jg(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,K7(e,i)),n&&Nh(a.latestValues)&&Jg(e,a.latestValues))}t.x<j5&&t.x>A5&&(t.x=1),t.y<j5&&t.y>A5&&(t.y=1)}function Qg(e,t){e.min=e.min+t,e.max=e.max+t}function P5(e,t,r,n,s=.5){const a=bs(e.min,e.max,s);NT(e,t,r,a,n)}function Jg(e,t){P5(e.x,t.x,t.scaleX,t.scale,t.originX),P5(e.y,t.y,t.scaleY,t.scale,t.originY)}function q7(e,t){return G7(LX(e.getBoundingClientRect(),t))}function $X(e,t,r){const n=q7(e,r),{scroll:s}=t;return s&&(Qg(n.x,s.offset.x),Qg(n.y,s.offset.y)),n}const F5=()=>({translate:0,scale:1,origin:0,originPoint:0}),Zg=()=>({x:F5(),y:F5()}),O5=()=>({min:0,max:0}),Zs=()=>({x:O5(),y:O5()}),AT={current:null},Y7={current:!1};function UX(){if(Y7.current=!0,!!SN)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>AT.current=e.matches;e.addEventListener("change",t),t()}else AT.current=!1}const zX=new WeakMap;function WX(e,t,r){for(const n in t){const s=t[n],a=r[n];if(Ri(s))e.addValue(n,s);else if(Ri(a))e.addValue(n,vm(s,{owner:e}));else if(a!==s)if(e.hasValue(n)){const i=e.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=e.getStaticValue(n);e.addValue(n,vm(i!==void 0?i:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const D5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class HX{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=$N,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=Co.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,ps.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=Ub(r),this.isVariantNode=D7(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(r,{},this);for(const g in f){const p=f[g];c[g]!==void 0&&Ri(p)&&p.set(c[g])}}mount(t){this.current=t,zX.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),Y7.current||UX(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:AT.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Tf(this.notifyUpdate),Tf(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Um.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&ps.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in wm){const r=wm[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Zs()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<D5.length;n++){const s=D5[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=t[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=WX(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=vm(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(UM(n)||WM(n))?n=parseFloat(n):!eX(n)&&Ef.test(r)&&(n=k7(t,r)),this.setBaseTarget(t,Ri(n)?n.get():n)),Ri(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=QN(this.props,r,this.presenceContext?.custom);a&&(n=a[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Ri(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new NN),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){WN.render(this.render)}}class X7 extends HX{constructor(){super(...arguments),this.KeyframeResolver=zY}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Ri(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function Q7(e,{style:t,vars:r},n,s){const a=e.style;let i;for(i in t)a[i]=t[i];s?.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function GX(e){return window.getComputedStyle(e)}class VX extends X7{constructor(){super(...arguments),this.type="html",this.renderInstance=Q7}readValueFromInstance(t,r){if(Um.has(r))return this.projection?.isProjecting?wT(r):oY(t,r);{const n=GX(t),s=(PN(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return q7(t,r)}build(t,r,n){qN(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return JN(t,r,n)}}const J7=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function KX(e,t,r,n){Q7(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(J7.has(s)?s:ZN(s),t.attrs[s])}class qX extends X7{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Zs}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Um.has(r)){const n=S7(r);return n&&n.default||0}return r=J7.has(r)?r:ZN(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return U7(t,r,n)}build(t,r,n){M7(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,s){KX(t,r,n,s)}mount(t){this.isSVGTag=B7(t.tagName),super.mount(t)}}const YX=(e,t)=>XN(e)?new qX(t):new VX(t,{allowProjection:e!==S.Fragment});function am(e,t,r){const n=e.getProps();return QN(n,t,r!==void 0?r:n.custom,e)}const jT=e=>Array.isArray(e);function XX(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,vm(r))}function QX(e){return jT(e)?e[e.length-1]||0:e}function JX(e,t){const r=am(e,t);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=QX(a[i]);XX(e,i,o)}}function ZX(e){return!!(Ri(e)&&e.add)}function PT(e,t){const r=e.getValue("willChange");if(ZX(r))return r.add(t);if(!r&&sd.WillChange){const n=new sd.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function Z7(e){return e.props[z7]}const eQ=e=>e!==null;function tQ(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(eQ),a=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[a]}const rQ={type:"spring",stiffness:500,damping:25,restSpeed:10},nQ=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),sQ={type:"keyframes",duration:.8},aQ={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},iQ=(e,{keyframes:t})=>t.length>2?sQ:Um.has(e)?e.startsWith("scale")?nQ(t[1]):rQ:aQ;function oQ({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const e4=(e,t,r,n={},s,a)=>i=>{const o=UN(n,e)||{},c=o.delay||n.delay||0;let{elapsed:u=0}=n;u=u-Jc(c);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:g=>{t.set(g),o.onUpdate&&o.onUpdate(g)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:a?void 0:s};oQ(o)||Object.assign(d,iQ(e,d)),d.duration&&(d.duration=Jc(d.duration)),d.repeatDelay&&(d.repeatDelay=Jc(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(CT(d),d.delay===0&&(f=!0)),(sd.instantAnimations||sd.skipAnimations)&&(f=!0,CT(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,f&&!a&&t.get()!==void 0){const g=tQ(d.keyframes,o);if(g!==void 0){ps.update(()=>{d.onUpdate(g),d.onComplete()});return}}return o.isSync?new BN(d):new jY(d)};function lQ({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function eL(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...o}=t;n&&(a=n);const c=[],u=s&&e.animationState&&e.animationState.getState()[s];for(const d in o){const f=e.getValue(d,e.latestValues[d]??null),g=o[d];if(g===void 0||u&&lQ(u,d))continue;const p={delay:r,...UN(a||{},d)},x=f.get();if(x!==void 0&&!f.isAnimating&&!Array.isArray(g)&&g===x&&!p.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const C=Z7(e);if(C){const k=window.MotionHandoffAnimation(C,d,ps);k!==null&&(p.startTime=k,v=!0)}}PT(e,d),f.start(e4(d,f,g,e.shouldReduceMotion&&w7.has(d)?{type:!1}:p,e,v));const w=f.animation;w&&c.push(w)}return i&&Promise.all(c).then(()=>{ps.update(()=>{i&&JX(e,i)})}),c}function tL(e,t,r,n=0,s=1){const a=Array.from(e).sort((u,d)=>u.sortNodePosition(d)).indexOf(t),i=e.size,o=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:o-a*n}function FT(e,t,r={}){const n=am(e,t,r.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(eL(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:f}=s;return cQ(e,t,c,u,d,f,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[a,i]:[i,a];return c().then(()=>u())}else return Promise.all([a(),i(r.delay)])}function cQ(e,t,r=0,n=0,s=0,a=1,i){const o=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),o.push(FT(c,t,{...i,delay:r+(typeof n=="function"?0:n)+tL(e.variantChildren,c,n,s,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(o)}function uQ(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>FT(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=FT(e,t,r);else{const s=typeof t=="function"?am(e,t,r.custom):t;n=Promise.all(eL(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function rL(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const dQ=KN.length;function nL(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?nL(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<dQ;r++){const n=KN[r],s=e.props[n];(Wy(s)||s===!1)&&(t[n]=s)}return t}const fQ=[...VN].reverse(),hQ=VN.length;function gQ(e){return t=>Promise.all(t.map(({animation:r,options:n})=>uQ(e,r,n)))}function mQ(e){let t=gQ(e),r=I5(),n=!0;const s=c=>(u,d)=>{const f=am(e,d,c==="exit"?e.presenceContext?.custom:void 0);if(f){const{transition:g,transitionEnd:p,...x}=f;u={...u,...x,...p}}return u};function a(c){t=c(e)}function i(c){const{props:u}=e,d=nL(e.parent)||{},f=[],g=new Set;let p={},x=1/0;for(let w=0;w<hQ;w++){const C=fQ[w],k=r[C],_=u[C]!==void 0?u[C]:d[C],N=Wy(_),E=C===c?k.isActive:null;E===!1&&(x=w);let P=_===d[C]&&_!==u[C]&&N;if(P&&n&&e.manuallyAnimateOnMount&&(P=!1),k.protectedKeys={...p},!k.isActive&&E===null||!_&&!k.prevProp||$b(_)||typeof _=="boolean")continue;const F=pQ(k.prevProp,_);let A=F||C===c&&k.isActive&&!P&&N||w>x&&N,j=!1;const I=Array.isArray(_)?_:[_];let B=I.reduce(s(C),{});E===!1&&(B={});const{prevResolvedValues:Y={}}=k,Z={...Y,...B},se=L=>{A=!0,g.has(L)&&(j=!0,g.delete(L)),k.needsAnimating[L]=!0;const V=e.getValue(L);V&&(V.liveStyle=!1)};for(const L in Z){const V=B[L],M=Y[L];if(p.hasOwnProperty(L))continue;let H=!1;jT(V)&&jT(M)?H=!rL(V,M):H=V!==M,H?V!=null?se(L):g.add(L):V!==void 0&&g.has(L)?se(L):k.protectedKeys[L]=!0}k.prevProp=_,k.prevResolvedValues=B,k.isActive&&(p={...p,...B}),n&&e.blockInitialAnimation&&(A=!1);const ee=P&&F;A&&(!ee||j)&&f.push(...I.map(L=>{const V={type:C};if(typeof L=="string"&&n&&!ee&&e.manuallyAnimateOnMount&&e.parent){const{parent:M}=e,H=am(M,L);if(M.enteringChildren&&H){const{delayChildren:W}=H.transition||{};V.delay=tL(M.enteringChildren,e,W)}}return{animation:L,options:V}}))}if(g.size){const w={};if(typeof u.initial!="boolean"){const C=am(e,Array.isArray(u.initial)?u.initial[0]:u.initial);C&&C.transition&&(w.transition=C.transition)}g.forEach(C=>{const k=e.getBaseTarget(C),_=e.getValue(C);_&&(_.liveStyle=!0),w[C]=k??null}),f.push({animation:w})}let v=!!f.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(v=!1),n=!1,v?t(f):Promise.resolve()}function o(c,u){if(r[c].isActive===u)return Promise.resolve();e.variantChildren?.forEach(f=>f.animationState?.setActive(c,u)),r[c].isActive=u;const d=i(c);for(const f in r)r[f].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=I5(),n=!0}}}function pQ(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!rL(t,e):!1}function Sh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function I5(){return{animate:Sh(!0),whileInView:Sh(),whileHover:Sh(),whileTap:Sh(),whileDrag:Sh(),whileFocus:Sh(),exit:Sh()}}class Rf{constructor(t){this.isMounted=!1,this.node=t}update(){}}class xQ extends Rf{constructor(t){super(t),t.animationState||(t.animationState=mQ(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();$b(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let yQ=0;class vQ extends Rf{constructor(){super(...arguments),this.id=yQ++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const wQ={animation:{Feature:xQ},exit:{Feature:vQ}};function Gy(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function Fv(e){return{point:{x:e.pageX,y:e.pageY}}}const _Q=e=>t=>HN(t)&&e(t,Fv(t));function vy(e,t,r,n){return Gy(e,t,_Q(r),n)}const sL=1e-4,bQ=1-sL,SQ=1+sL,aL=.01,kQ=0-aL,CQ=0+aL;function so(e){return e.max-e.min}function TQ(e,t,r){return Math.abs(e-t)<=r}function R5(e,t,r,n=.5){e.origin=n,e.originPoint=bs(t.min,t.max,e.origin),e.scale=so(r)/so(t),e.translate=bs(r.min,r.max,e.origin)-e.originPoint,(e.scale>=bQ&&e.scale<=SQ||isNaN(e.scale))&&(e.scale=1),(e.translate>=kQ&&e.translate<=CQ||isNaN(e.translate))&&(e.translate=0)}function wy(e,t,r,n){R5(e.x,t.x,r.x,n?n.originX:void 0),R5(e.y,t.y,r.y,n?n.originY:void 0)}function M5(e,t,r){e.min=r.min+t.min,e.max=e.min+so(t)}function EQ(e,t,r){M5(e.x,t.x,r.x),M5(e.y,t.y,r.y)}function L5(e,t,r){e.min=t.min-r.min,e.max=e.min+so(t)}function _y(e,t,r){L5(e.x,t.x,r.x),L5(e.y,t.y,r.y)}function _l(e){return[e("x"),e("y")]}const iL=({current:e})=>e?e.ownerDocument.defaultView:null,B5=(e,t)=>Math.abs(e-t);function NQ(e,t){const r=B5(e.x,t.x),n=B5(e.y,t.y);return Math.sqrt(r**2+n**2)}class oL{constructor(t,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=LS(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=NQ(g.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!x)return;const{point:v}=g,{timestamp:w}=ci;this.history.push({...v,timestamp:w});const{onStart:C,onMove:k}=this.handlers;p||(C&&C(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,g)},this.handlePointerMove=(g,p)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=MS(p,this.transformPagePoint),ps.update(this.updatePoint,!0)},this.handlePointerUp=(g,p)=>{this.end();const{onEnd:x,onSessionEnd:v,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=LS(g.type==="pointercancel"?this.lastMoveEventInfo:MS(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(g,C),v&&v(g,C)},!HN(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const o=Fv(t),c=MS(o,this.transformPagePoint),{point:u}=c,{timestamp:d}=ci;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=r;f&&f(t,LS(c,this.history)),this.removeListeners=Av(vy(this.contextWindow,"pointermove",this.handlePointerMove),vy(this.contextWindow,"pointerup",this.handlePointerUp),vy(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Tf(this.updatePoint)}}function MS(e,t){return t?{point:t(e.point)}:e}function $5(e,t){return{x:e.x-t.x,y:e.y-t.y}}function LS({point:e},t){return{point:e,delta:$5(e,lL(t)),offset:$5(e,AQ(t)),velocity:jQ(t,.1)}}function AQ(e){return e[0]}function lL(e){return e[e.length-1]}function jQ(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=lL(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>Jc(t)));)r--;if(!n)return{x:0,y:0};const a=Zc(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function PQ(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?bs(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?bs(r,e,n.max):Math.min(e,r)),e}function U5(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function FQ(e,{top:t,left:r,bottom:n,right:s}){return{x:U5(e.x,r,s),y:U5(e.y,t,n)}}function z5(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function OQ(e,t){return{x:z5(e.x,t.x),y:z5(e.y,t.y)}}function DQ(e,t){let r=.5;const n=so(e),s=so(t);return s>n?r=$y(t.min,t.max-n,e.min):n>s&&(r=$y(e.min,e.max-s,t.min)),nd(0,1,r)}function IQ(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const OT=.35;function RQ(e=OT){return e===!1?e=0:e===!0&&(e=OT),{x:W5(e,"left","right"),y:W5(e,"top","bottom")}}function W5(e,t,r){return{min:H5(e,t),max:H5(e,r)}}function H5(e,t){return typeof e=="number"?e:e[t]||0}const MQ=new WeakMap;class LQ{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Zs(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=f=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Fv(f).point)},i=(f,g)=>{const{drag:p,dragPropagation:x,onDragStart:v}=this.getProps();if(p&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=VY(p),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_l(C=>{let k=this.getAxisMotionValue(C).get()||0;if(eu.test(k)){const{projection:_}=this.visualElement;if(_&&_.layout){const N=_.layout.layoutBox[C];N&&(k=so(N)*(parseFloat(k)/100))}}this.originPoint[C]=k}),v&&ps.postRender(()=>v(f,g)),PT(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},o=(f,g)=>{this.latestPointerEvent=f,this.latestPanInfo=g;const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:v,onDrag:w}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:C}=g;if(x&&this.currentDirection===null){this.currentDirection=BQ(C),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",g.point,C),this.updateAxis("y",g.point,C),this.visualElement.render(),w&&w(f,g)},c=(f,g)=>{this.latestPointerEvent=f,this.latestPanInfo=g,this.stop(f,g),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>_l(f=>this.getAnimationState(f)==="paused"&&this.getAxisMotionValue(f).animation?.play()),{dragSnapToOrigin:d}=this.getProps();this.panSession=new oL(t,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:iL(this.visualElement)})}stop(t,r){const n=t||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&ps.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!mw(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=PQ(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&Xg(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=FQ(n.layoutBox,t):this.constraints=!1,this.elastic=RQ(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&_l(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=IQ(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Xg(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=$X(n,s.root,this.visualElement.getTransformPagePoint());let i=OQ(s.layout.layoutBox,a);if(r){const o=r(MX(i));this.hasMutatedConstraints=!!o,o&&(i=G7(o))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=_l(d=>{if(!mw(d,r,this.currentDirection))return;let f=c&&c[d]||{};i&&(f={min:0,max:0});const g=s?200:1e6,p=s?40:1e7,x={type:"inertia",velocity:n?t[d]:0,bounceStiffness:g,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,x)});return Promise.all(u).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return PT(this.visualElement,t),n.start(e4(t,n,0,r,this.visualElement,!1))}stopAnimation(){_l(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){_l(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){_l(r=>{const{drag:n}=this.getProps();if(!mw(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(t[r]-bs(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Xg(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};_l(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();s[i]=DQ({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),_l(i=>{if(!mw(i,t,null))return;const o=this.getAxisMotionValue(i),{min:c,max:u}=this.constraints[i];o.set(bs(c,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;MQ.set(this.visualElement,this);const t=this.visualElement.current,r=vy(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();Xg(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ps.read(n);const i=Gy(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(_l(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())}));return()=>{i(),r(),a(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=OT,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function mw(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function BQ(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class $Q extends Rf{constructor(t){super(t),this.removeGroupControls=Al,this.removeListeners=Al,this.controls=new LQ(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Al}unmount(){this.removeGroupControls(),this.removeListeners()}}const G5=e=>(t,r)=>{e&&ps.postRender(()=>e(t,r))};class UQ extends Rf{constructor(){super(...arguments),this.removePointerDownListener=Al}onPointerDown(t){this.session=new oL(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:iL(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:G5(t),onStart:G5(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&ps.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=vy(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const s_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function V5(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ax={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Mr.test(e))e=parseFloat(e);else return e;const r=V5(e,t.target.x),n=V5(e,t.target.y);return`${r}% ${n}%`}},zQ={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Ef.parse(e);if(s.length>5)return n;const a=Ef.createTransformer(e),i=typeof s[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;s[0+i]/=o,s[1+i]/=c;const u=bs(o,c,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),a(s)}};let BS=!1;class WQ extends S.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;dX(HQ),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),BS&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),s_.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,BS=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||ps.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),WN.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;BS=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function cL(e){const[t,r]=P7(),n=S.useContext(_N);return l.jsx(WQ,{...e,layoutGroup:n,switchLayoutGroup:S.useContext(W7),isPresent:t,safeToRemove:r})}const HQ={borderRadius:{...ax,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ax,borderTopRightRadius:ax,borderBottomLeftRadius:ax,borderBottomRightRadius:ax,boxShadow:zQ};function GQ(e,t,r){const n=Ri(e)?e:vm(e);return n.start(e4("",n,t,r)),n.animation}const VQ=(e,t)=>e.depth-t.depth;class KQ{constructor(){this.children=[],this.isDirty=!1}add(t){kN(this.children,t),this.isDirty=!0}remove(t){CN(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(VQ),this.isDirty=!1,this.children.forEach(t)}}function qQ(e,t){const r=Co.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(Tf(n),e(a-t))};return ps.setup(n,!0),()=>Tf(n)}const uL=["TopLeft","TopRight","BottomLeft","BottomRight"],YQ=uL.length,K5=e=>typeof e=="string"?parseFloat(e):e,q5=e=>typeof e=="number"||Mr.test(e);function XQ(e,t,r,n,s,a){s?(e.opacity=bs(0,r.opacity??1,QQ(n)),e.opacityExit=bs(t.opacity??1,0,JQ(n))):a&&(e.opacity=bs(t.opacity??1,r.opacity??1,n));for(let i=0;i<YQ;i++){const o=`border${uL[i]}Radius`;let c=Y5(t,o),u=Y5(r,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||q5(c)===q5(u)?(e[o]=Math.max(bs(K5(c),K5(u),n),0),(eu.test(u)||eu.test(c))&&(e[o]+="%")):e[o]=u}(t.rotate||r.rotate)&&(e.rotate=bs(t.rotate||0,r.rotate||0,n))}function Y5(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const QQ=dL(0,.5,QM),JQ=dL(.5,.95,Al);function dL(e,t,r){return n=>n<e?0:n>t?1:r($y(e,t,n))}function X5(e,t){e.min=t.min,e.max=t.max}function gl(e,t){X5(e.x,t.x),X5(e.y,t.y)}function Q5(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function J5(e,t,r,n,s){return e-=t,e=v_(e,1/r,n),s!==void 0&&(e=v_(e,1/s,n)),e}function ZQ(e,t=0,r=1,n=.5,s,a=e,i=e){if(eu.test(t)&&(t=parseFloat(t),t=bs(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=bs(a.min,a.max,n);e===a&&(o-=t),e.min=J5(e.min,t,r,o,s),e.max=J5(e.max,t,r,o,s)}function Z5(e,t,[r,n,s],a,i){ZQ(e,t[r],t[n],t[s],t.scale,a,i)}const eJ=["x","scaleX","originX"],tJ=["y","scaleY","originY"];function e6(e,t,r,n){Z5(e.x,t,eJ,r?r.x:void 0,n?n.x:void 0),Z5(e.y,t,tJ,r?r.y:void 0,n?n.y:void 0)}function t6(e){return e.translate===0&&e.scale===1}function fL(e){return t6(e.x)&&t6(e.y)}function r6(e,t){return e.min===t.min&&e.max===t.max}function rJ(e,t){return r6(e.x,t.x)&&r6(e.y,t.y)}function n6(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function hL(e,t){return n6(e.x,t.x)&&n6(e.y,t.y)}function s6(e){return so(e.x)/so(e.y)}function a6(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class nJ{constructor(){this.members=[]}add(t){kN(this.members,t),t.scheduleRender()}remove(t){if(CN(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function sJ(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y,i=r?.z||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:g,skewX:p,skewY:x}=r;u&&(n=`perspective(${u}px) ${n}`),d&&(n+=`rotate(${d}deg) `),f&&(n+=`rotateX(${f}deg) `),g&&(n+=`rotateY(${g}deg) `),p&&(n+=`skewX(${p}deg) `),x&&(n+=`skewY(${x}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(n+=`scale(${o}, ${c})`),n||"none"}const $S=["","X","Y","Z"],aJ=1e3;let iJ=0;function US(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function gL(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=Z7(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",ps,!(s||a))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&gL(n)}function mL({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=t?.()){this.id=iJ++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(cJ),this.nodes.forEach(hJ),this.nodes.forEach(gJ),this.nodes.forEach(uJ)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new KQ)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new NN),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=j7(i)&&!JY(i),this.instance=i;const{layoutId:o,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),e){let d,f=0;const g=()=>this.root.updateBlockedByResize=!1;ps.read(()=>{f=window.innerWidth}),e(i,()=>{const p=window.innerWidth;p!==f&&(f=p,this.root.updateBlockedByResize=!0,d&&d(),d=qQ(g,250),s_.hasAnimatedSinceResize&&(s_.hasAnimatedSinceResize=!1,this.nodes.forEach(l6)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:g,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||vJ,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=u.getProps(),C=!this.targetLayout||!hL(this.targetLayout,p),k=!f&&g;if(this.options.layoutRoot||this.resumeFrom||k||f&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...UN(x,"layout"),onPlay:v,onComplete:w};(u.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(d,k)}else f||l6(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Tf(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(mJ),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&gL(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(i6);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(o6);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(fJ),this.nodes.forEach(oJ),this.nodes.forEach(lJ)):this.nodes.forEach(o6),this.clearAllSnapshots();const o=Co.now();ci.delta=nd(0,1e3/60,o-ci.timestamp),ci.timestamp=o,ci.isProcessing=!0,AS.update.process(ci),AS.preRender.process(ci),AS.render.process(ci),ci.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,WN.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(dJ),this.sharedNodes.forEach(pJ)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ps.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ps.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!so(this.snapshot.measuredBox.x)&&!so(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Zs(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!fL(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(o||Nh(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),wJ(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return Zs();const o=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(_J))){const{scroll:u}=this.root;u&&(Qg(o.x,u.offset.x),Qg(o.y,u.offset.y))}return o}removeElementScroll(i){const o=Zs();if(gl(o,i),this.scroll?.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:f}=u;u!==this.root&&d&&f.layoutScroll&&(d.wasRoot&&gl(o,i),Qg(o.x,d.offset.x),Qg(o.y,d.offset.y))}return o}applyTransform(i,o=!1){const c=Zs();gl(c,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Jg(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Nh(d.latestValues)&&Jg(c,d.latestValues)}return Nh(this.latestValues)&&Jg(c,this.latestValues),c}removeTransform(i){const o=Zs();gl(o,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Nh(u.latestValues))continue;ET(u.latestValues)&&u.updateSnapshot();const d=Zs(),f=u.measurePageBox();gl(d,f),e6(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Nh(this.latestValues)&&e6(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ci.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!(!this.layout||!(d||f))){if(this.resolvedRelativeTargetAt=ci.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Zs(),this.relativeTargetOrigin=Zs(),_y(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),gl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Zs(),this.targetWithTransforms=Zs()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),EQ(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):gl(this.target,this.layout.layoutBox),K7(this.target,this.targetDelta)):gl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Zs(),this.relativeTargetOrigin=Zs(),_y(this.relativeTargetOrigin,this.target,g.target),gl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||ET(this.parent.latestValues)||V7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const i=this.getLead(),o=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ci.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;gl(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,g=this.treeScale.y;BX(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Zs());const{target:p}=i;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Q5(this.prevProjectionDelta.x,this.projectionDelta.x),Q5(this.prevProjectionDelta.y,this.projectionDelta.y)),wy(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==g||!a6(this.projectionDelta.x,this.prevProjectionDelta.x)||!a6(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Zg(),this.projectionDelta=Zg(),this.projectionDeltaWithTransform=Zg()}setAnimationOrigin(i,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=Zg();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const g=Zs(),p=c?c.source:void 0,x=this.layout?this.layout.source:void 0,v=p!==x,w=this.getStack(),C=!w||w.members.length<=1,k=!!(v&&!C&&this.options.crossfade===!0&&!this.path.some(yJ));this.animationProgress=0;let _;this.mixTargetDelta=N=>{const E=N/1e3;c6(f.x,i.x,E),c6(f.y,i.y,E),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(_y(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),xJ(this.relativeTarget,this.relativeTargetOrigin,g,E),_&&rJ(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=Zs()),gl(_,this.relativeTarget)),v&&(this.animationValues=d,XQ(d,u,this.latestValues,E,k,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Tf(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ps.update(()=>{s_.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=vm(0)),this.currentAnimation=GQ(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(aJ),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=i;if(!(!o||!c||!u)){if(this!==i&&this.layout&&u&&pL(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Zs();const f=so(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const g=so(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+g}gl(o,c),Jg(o,d),wy(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new nJ),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const u={};c.z&&US("z",i,u,this.animationValues);for(let d=0;d<$S.length;d++)US(`rotate${$S[d]}`,i,u,this.animationValues),US(`skew${$S[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=n_(o?.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=n_(o?.pointerEvents)||""),this.hasProjected&&!Nh(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=sJ(this.projectionDeltaWithTransform,this.treeScale,d);c&&(f=c(d,f)),i.transform=f;const{x:g,y:p}=this.projectionDelta;i.transformOrigin=`${g.origin*100}% ${p.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const x in Hy){if(d[x]===void 0)continue;const{correct:v,applyTo:w,isCSSVariable:C}=Hy[x],k=f==="none"?d[x]:v(d[x],u);if(w){const _=w.length;for(let N=0;N<_;N++)i[w[N]]=k}else C?this.options.visualElement.renderState.vars[x]=k:i[x]=k}this.options.layoutId&&(i.pointerEvents=u===this?n_(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(i6),this.root.sharedNodes.clear()}}}function oJ(e){e.updateLayout()}function lJ(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:n}=e.layout,{animationType:s}=e.options,a=t.source!==e.layout.source;s==="size"?_l(d=>{const f=a?t.measuredBox[d]:t.layoutBox[d],g=so(f);f.min=r[d].min,f.max=f.min+g}):pL(s,t.layoutBox,r)&&_l(d=>{const f=a?t.measuredBox[d]:t.layoutBox[d],g=so(r[d]);f.max=f.min+g,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+g)});const i=Zg();wy(i,r,t.layoutBox);const o=Zg();a?wy(o,e.applyTransform(n,!0),t.measuredBox):wy(o,r,t.layoutBox);const c=!fL(i);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:f,layout:g}=d;if(f&&g){const p=Zs();_y(p,t.layoutBox,f.layoutBox);const x=Zs();_y(x,r,g.layoutBox),hL(p,x)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=p,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:i,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function cJ(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function uJ(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function dJ(e){e.clearSnapshot()}function i6(e){e.clearMeasurements()}function o6(e){e.isLayoutDirty=!1}function fJ(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function l6(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function hJ(e){e.resolveTargetDelta()}function gJ(e){e.calcProjection()}function mJ(e){e.resetSkewAndRotation()}function pJ(e){e.removeLeadSnapshot()}function c6(e,t,r){e.translate=bs(t.translate,0,r),e.scale=bs(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function u6(e,t,r,n){e.min=bs(t.min,r.min,n),e.max=bs(t.max,r.max,n)}function xJ(e,t,r,n){u6(e.x,t.x,r.x,n),u6(e.y,t.y,r.y,n)}function yJ(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const vJ={duration:.45,ease:[.4,0,.1,1]},d6=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),f6=d6("applewebkit/")&&!d6("chrome/")?Math.round:Al;function h6(e){e.min=f6(e.min),e.max=f6(e.max)}function wJ(e){h6(e.x),h6(e.y)}function pL(e,t,r){return e==="position"||e==="preserve-aspect"&&!TQ(s6(t),s6(r),.2)}function _J(e){return e!==e.root&&e.scroll?.wasRoot}const bJ=mL({attachResizeListener:(e,t)=>Gy(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),zS={current:void 0},xL=mL({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!zS.current){const e=new bJ({});e.mount(window),e.setOptions({layoutScroll:!0}),zS.current=e}return zS.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),SJ={pan:{Feature:UQ},drag:{Feature:$Q,ProjectionNode:xL,MeasureLayout:cL}};function g6(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&ps.postRender(()=>a(t,Fv(t)))}class kJ extends Rf{mount(){const{current:t}=this.node;t&&(this.unmount=KY(t,(r,n)=>(g6(this.node,n,"Start"),s=>g6(this.node,s,"End"))))}unmount(){}}class CJ extends Rf{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Av(Gy(this.node.current,"focus",()=>this.onFocus()),Gy(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function m6(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&ps.postRender(()=>a(t,Fv(t)))}class TJ extends Rf{mount(){const{current:t}=this.node;t&&(this.unmount=QY(t,(r,n)=>(m6(this.node,n,"Start"),(s,{success:a})=>m6(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const DT=new WeakMap,WS=new WeakMap,EJ=e=>{const t=DT.get(e.target);t&&t(e)},NJ=e=>{e.forEach(EJ)};function AJ({root:e,...t}){const r=e||document;WS.has(r)||WS.set(r,{});const n=WS.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(NJ,{root:e,...t})),n[s]}function jJ(e,t,r){const n=AJ(t);return DT.set(e,r),n.observe(e),()=>{DT.delete(e),n.unobserve(e)}}const PJ={some:0,all:1};class FJ extends Rf{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:PJ[s]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),g=u?d:f;g&&g(c)};return jJ(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(OJ(t,r))&&this.startObserver()}unmount(){}}function OJ({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const DJ={inView:{Feature:FJ},tap:{Feature:TJ},focus:{Feature:CJ},hover:{Feature:kJ}},IJ={layout:{ProjectionNode:xL,MeasureLayout:cL}},RJ={...wQ,...DJ,...SJ,...IJ},at=RX(RJ,YX),Ze=({children:e,variant:t="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const o="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",c={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},u={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg",icon:"p-0 flex items-center justify-center"},d=s?"opacity-50 cursor-not-allowed":"";return l.jsx(at.button,{className:`${o} ${c[t]} ${u[r]} ${d} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:e})},Wr=({size:e="md",color:t="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return l.jsx(at.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[e]} ${s[t]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},mc=({type:e="info",message:t="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[o,c]=S.useState(!0),[u,d]=S.useState(!1),f=S.useRef(null),g=S.useRef(null);S.useEffect(()=>{if(r>0)return g.current=setTimeout(()=>{p()},r),()=>{g.current&&clearTimeout(g.current)}},[r]);const p=S.useCallback(()=>{u||(d(!0),g.current&&clearTimeout(g.current),setTimeout(()=>{c(!1),s&&s()},300))},[u,s]),x=S.useCallback(C=>{C.key==="Escape"&&p()},[p]);if(!o)return null;const v=["notification",`notification-${e}`,o?"notification-visible":"",u?"notification-exiting":"",a].filter(Boolean).join(" "),w=()=>{switch(e){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}};return l.jsx("div",{ref:f,className:v,role:"alert","aria-live":"polite",onKeyDown:x,tabIndex:-1,...i,children:l.jsxs("div",{className:"notification-content",children:[l.jsx("div",{className:"notification-icon","aria-hidden":"true",children:w()}),l.jsx("div",{className:"notification-body",children:l.jsx("div",{className:"notification-message",children:t})}),n&&l.jsx("button",{className:"notification-close",onClick:p,type:"button","aria-label":"Close notification",children:""})]})})},Aa=()=>{const[e,t]=S.useState([]),r=S.useCallback((a,i="info",o={})=>{const c=Date.now()+Math.random(),u={id:c,message:a,type:i,...o};return t(d=>[...d,u]),o.duration!==0&&setTimeout(()=>{n(c)},o.duration||3e3),c},[]),n=S.useCallback(a=>{t(i=>i.filter(o=>o.id!==a))},[]),s=S.useCallback(()=>{t([])},[]);return{notifications:e,showNotification:r,removeNotification:n,clearAllNotifications:s}},tl=()=>{const[e,t]=S.useState(!1),[r,n]=S.useState(null),[s,a]=S.useState(null),i=S.useRef(null);S.useRef(new Map);const o=S.useRef(0),c=3,u=1e3,d=S.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);S.useEffect(()=>d,[d]);const f=S.useCallback(async(R,z={})=>{try{t(!0),n(null),i.current=new AbortController;const K=z.method||"POST",Q={method:K,headers:{"Content-Type":"application/json",...z.headers},signal:i.current.signal,...z};K!=="GET"&&K!=="HEAD"&&(Q.body=JSON.stringify(z.data||{})),console.log(`[API] Making request to: ${R}`,Q);const ae=await fetch(R,Q);if(!ae.ok)throw new Error(`HTTP error! status: ${ae.status}`);const X=await ae.json();if(console.log("[API] Response received:",X),X.success)return a(X),o.current=0,X;throw new Error(X.error||X.message||"Request failed")}catch(K){if(K.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",K),n(K.message||"Request failed"),o.current<c){o.current++;const Q=u*Math.pow(2,o.current-1);return console.log(`[API] Retrying in ${Q}ms (attempt ${o.current}/${c})`),await new Promise(ae=>setTimeout(ae,Q)),f(R,z)}throw K}finally{t(!1),i.current=null}},[]),g=S.useCallback(async(R,z={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(R,z)}catch(K){throw console.error("[API] Authenticated request failed:",K),K}},[]),p=S.useCallback(async(R,z)=>{try{const K=`/.netlify/functions/get-test-questions?test_type=${R}&test_id=${z}`;console.log(`[API] Getting test info for ${R}_${z}`);const ae=await(await g(K)).json();if(ae.success)return console.log("[API] Test info retrieved successfully:",ae.test_info),ae.test_info;throw new Error(ae.error||"Failed to get test info")}catch(K){throw console.error("[API] Failed to get test info:",K),K}},[g]),x=S.useCallback(async(R,z)=>{try{const K=`/.netlify/functions/get-test-questions?test_type=${R}&test_id=${z}`;console.log(`[API] Getting test questions for ${R}_${z}`);const ae=await(await g(K)).json();if(ae.success)return console.log("[API] Test questions retrieved successfully:",ae.questions),ae.questions;throw new Error(ae.error||"Failed to get test questions")}catch(K){throw console.error("[API] Failed to get test questions:",K),K}},[g]),v=S.useCallback(async()=>{try{const R="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const K=await(await g(R)).json();if(K.success)return console.log("[API] Student active tests loaded successfully:",K.tests),K.tests;throw new Error(K.error||"Failed to load student active tests")}catch(R){throw console.error("[API] Failed to load student active tests:",R),R}},[g]),w=S.useCallback(async(R,z,K)=>{try{let Q;switch(R){case"true_false":Q="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":Q="/.netlify/functions/submit-multiple-choice-test";break;case"input":Q="/.netlify/functions/submit-input-test";break;case"matching_type":Q="/.netlify/functions/submit-matching-type-test";break;case"speaking":Q="/.netlify/functions/submit-speaking-test";break;default:throw new Error(`Unknown test type: ${R}`)}console.log(`[API] Submitting ${R} test:`,K);const X=await(await g(Q,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)})).json();if(X.success)return console.log("[API] Test submitted successfully:",X),X;throw new Error(X.error||"Failed to submit test")}catch(Q){throw console.error("[API] Failed to submit test:",Q),Q}},[g]),C=S.useCallback(async R=>{try{const z="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",R);const Q=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] Multiple choice test saved successfully:",Q),Q;throw new Error(Q.error||"Failed to save multiple choice test")}catch(z){throw console.error("[API] Failed to save multiple choice test:",z),z}},[g]),k=S.useCallback(async R=>{try{const z="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",R);const Q=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] True/false test saved successfully:",Q),Q;throw new Error(Q.error||"Failed to save true/false test")}catch(z){throw console.error("[API] Failed to save true/false test:",z),z}},[g]),_=S.useCallback(async R=>{try{const z="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",R);const Q=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] Input test saved successfully:",Q),Q;throw new Error(Q.error||"Failed to save input test")}catch(z){throw console.error("[API] Failed to save input test:",z),z}},[g]),N=S.useCallback(async R=>{try{const z="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",R);const Q=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] Test assigned successfully:",Q),Q;throw new Error(Q.error||"Failed to assign test")}catch(z){throw console.error("[API] Failed to assign test:",z),z}},[g]),E=S.useCallback(async()=>{try{const R="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const K=await(await g(R)).json();if(K.success)return console.log("[API] Teacher active tests loaded successfully:",K.tests),K.tests;throw new Error(K.error||"Failed to load teacher active tests")}catch(R){throw console.error("[API] Failed to load teacher active tests:",R),R}},[g]),P=S.useCallback(async()=>{try{const R="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const K=await(await g(R)).json();if(K.success)return console.log("[API] All users loaded successfully:",K.users),K.users;throw new Error(K.error||"Failed to get all users")}catch(R){throw console.error("[API] Failed to get all users:",R),R}},[g]),F=S.useCallback(async()=>{try{const R="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const K=await(await g(R)).json();if(K.success)return console.log("[API] All teachers loaded successfully:",K.teachers),K.teachers;throw new Error(K.error||"Failed to get all teachers")}catch(R){throw console.error("[API] Failed to get all teachers:",R),R}},[g]),A=S.useCallback(async()=>{try{const R="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const K=await(await g(R)).json();if(K.success)return console.log("[API] All subjects loaded successfully:",K.subjects),K.subjects;throw new Error(K.error||"Failed to get all subjects")}catch(R){throw console.error("[API] Failed to get all subjects:",R),R}},[g]),j=S.useCallback(()=>{n(null)},[]),I=S.useCallback(()=>{a(null)},[]),B=S.useCallback(()=>{t(!1),n(null),a(null),o.current=0,d()},[d]),Y=S.useCallback(async(R,z={})=>{const Q=await(await g(R,{...z,method:"GET"})).json();if(Q.success)return Q;throw new Error(Q.error||"Request failed")},[g]),Z=S.useCallback(async(R,z,K={})=>{const ae=await(await g(R,{...K,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(ae.success)return ae;throw new Error(ae.error||"Request failed")},[g]),se=S.useCallback(async(R,z,K={})=>{const ae=await(await g(R,{...K,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(ae.success)return ae;throw new Error(ae.error||"Request failed")},[g]),ee=S.useCallback(async(R,z={})=>{const Q=await(await g(R,{...z,method:"DELETE"})).json();if(Q.success)return Q;throw new Error(Q.error||"Request failed")},[g]),te=S.useCallback(async R=>{try{const z="/.netlify/functions/submit-speaking-test";console.log("[API] Submitting speaking test:",R);const Q=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] Speaking test submitted successfully:",Q),Q;throw new Error(Q.error||"Failed to submit speaking test")}catch(z){throw console.error("[API] Failed to submit speaking test:",z),z}},[g]),L=S.useCallback(async R=>{try{const z=`/.netlify/functions/get-speaking-test-new?action=test&test_id=${R}`;console.log("[API] Getting speaking test:",R);const Q=await(await g(z,{method:"GET"})).json();if(Q.success)return console.log("[API] Speaking test loaded successfully:",Q),Q;throw new Error(Q.error||"Failed to load speaking test")}catch(z){throw console.error("[API] Failed to load speaking test:",z),z}},[g]),V=S.useCallback(async R=>{try{const z=`/.netlify/functions/get-speaking-test-new?action=questions&test_id=${R}`;console.log("[API] Getting speaking test questions:",R);const Q=await(await g(z,{method:"GET"})).json();if(Q.success)return console.log("[API] Speaking test questions loaded successfully:",Q),Q;throw new Error(Q.error||"Failed to load speaking test questions")}catch(z){throw console.error("[API] Failed to load speaking test questions:",z),z}},[g]),M=S.useCallback(async R=>{try{const z="/.netlify/functions/upload-speaking-audio";console.log("[API] Uploading speaking audio");const Q=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] Audio uploaded successfully:",Q),Q;throw new Error(Q.error||"Failed to upload audio")}catch(z){throw console.error("[API] Failed to upload audio:",z),z}},[g]),H=S.useCallback(async R=>{try{const z=`/.netlify/functions/get-speaking-test-new?action=audio&file_path=${encodeURIComponent(R)}`;console.log("[API] Getting speaking audio:",R);const Q=await(await g(z,{method:"GET"})).json();if(Q.success)return console.log("[API] Audio URL retrieved successfully:",Q),Q;throw new Error(Q.error||"Failed to get audio")}catch(z){throw console.error("[API] Failed to get audio:",z),z}},[g]),W=S.useCallback(async(R,z)=>{try{const K=`/.netlify/functions/check-test-completion?test_id=${R}&test_type=${z}`;console.log("[API] Checking test completion:",R,z);const ae=await(await g(K,{method:"GET"})).json();if(ae.success)return console.log("[API] Test completion status:",ae),ae;throw new Error(ae.error||"Failed to check test completion")}catch(K){throw console.error("[API] Failed to check test completion:",K),K}},[g]);return{loading:e,error:r,data:s,sendRequest:f,makeAuthenticatedRequest:g,get:Y,post:Z,put:se,delete:ee,getTestInfo:p,getTestQuestions:x,loadStudentActiveTests:v,submitTest:w,submitSpeakingTest:te,getSpeakingTest:L,getSpeakingTestQuestions:V,uploadSpeakingAudio:M,getSpeakingAudio:H,checkTestCompletion:W,saveMultipleChoiceTest:C,saveTrueFalseTest:k,saveInputTest:_,assignTestToClasses:N,loadTeacherActiveTests:E,getAllUsers:P,getAllTeachers:F,getAllSubjects:A,clearError:j,clearData:I,reset:B,cleanup:d}},MJ="modulepreload",LJ=function(e){return"/"+e},p6={},mi=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let u=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};var i=u;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");s=u(r.map(d=>{if(d=LJ(d),d in p6)return;p6[d]=!0;const f=d.endsWith(".css"),g=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const p=document.createElement("link");if(p.rel=f?"stylesheet":MJ,f||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),f)return new Promise((x,v)=>{p.addEventListener("load",x),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})};var a_={exports:{}},ix={},HS={},GS={},x6;function tn(){return x6||(x6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof g_<"u"?g_:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return e.Konva.angleDeg?s*t:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var s;return(s=e.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(s){e.glob.Konva=s}};const n=s=>{e.Konva[s.prototype.getClassName()]=s};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})(GS)),GS}var VS={},y6;function zs(){return y6||(y6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=tn();class r{constructor(N=[1,0,0,1,0,0]){this.dirty=!1,this.m=N&&N.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(N){N.m[0]=this.m[0],N.m[1]=this.m[1],N.m[2]=this.m[2],N.m[3]=this.m[3],N.m[4]=this.m[4],N.m[5]=this.m[5]}point(N){const E=this.m;return{x:E[0]*N.x+E[2]*N.y+E[4],y:E[1]*N.x+E[3]*N.y+E[5]}}translate(N,E){return this.m[4]+=this.m[0]*N+this.m[2]*E,this.m[5]+=this.m[1]*N+this.m[3]*E,this}scale(N,E){return this.m[0]*=N,this.m[1]*=N,this.m[2]*=E,this.m[3]*=E,this}rotate(N){const E=Math.cos(N),P=Math.sin(N),F=this.m[0]*E+this.m[2]*P,A=this.m[1]*E+this.m[3]*P,j=this.m[0]*-P+this.m[2]*E,I=this.m[1]*-P+this.m[3]*E;return this.m[0]=F,this.m[1]=A,this.m[2]=j,this.m[3]=I,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(N,E){const P=this.m[0]+this.m[2]*E,F=this.m[1]+this.m[3]*E,A=this.m[2]+this.m[0]*N,j=this.m[3]+this.m[1]*N;return this.m[0]=P,this.m[1]=F,this.m[2]=A,this.m[3]=j,this}multiply(N){const E=this.m[0]*N.m[0]+this.m[2]*N.m[1],P=this.m[1]*N.m[0]+this.m[3]*N.m[1],F=this.m[0]*N.m[2]+this.m[2]*N.m[3],A=this.m[1]*N.m[2]+this.m[3]*N.m[3],j=this.m[0]*N.m[4]+this.m[2]*N.m[5]+this.m[4],I=this.m[1]*N.m[4]+this.m[3]*N.m[5]+this.m[5];return this.m[0]=E,this.m[1]=P,this.m[2]=F,this.m[3]=A,this.m[4]=j,this.m[5]=I,this}invert(){const N=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),E=this.m[3]*N,P=-this.m[1]*N,F=-this.m[2]*N,A=this.m[0]*N,j=N*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),I=N*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=E,this.m[1]=P,this.m[2]=F,this.m[3]=A,this.m[4]=j,this.m[5]=I,this}getMatrix(){return this.m}decompose(){const N=this.m[0],E=this.m[1],P=this.m[2],F=this.m[3],A=this.m[4],j=this.m[5],I=N*F-E*P,B={x:A,y:j,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(N!=0||E!=0){const Y=Math.sqrt(N*N+E*E);B.rotation=E>0?Math.acos(N/Y):-Math.acos(N/Y),B.scaleX=Y,B.scaleY=I/Y,B.skewX=(N*P+E*F)/I,B.skewY=0}else if(P!=0||F!=0){const Y=Math.sqrt(P*P+F*F);B.rotation=Math.PI/2-(F>0?Math.acos(-P/Y):-Math.acos(P/Y)),B.scaleX=I/Y,B.scaleY=Y,B.skewX=0,B.skewY=(N*P+E*F)/I}return B.rotation=e.Util._getRotation(B.rotation),B}}e.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",o=Math.PI/180,c=180/Math.PI,u="#",d="",f="0",g="Konva warning: ",p="Konva error: ",x="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},w=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const k=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(_){setTimeout(_,60)};e.Util={_isElement(_){return!!(_&&_.nodeType==1)},_isFunction(_){return!!(_&&_.constructor&&_.call&&_.apply)},_isPlainObject(_){return!!_&&_.constructor===Object},_isArray(_){return Object.prototype.toString.call(_)===n},_isNumber(_){return Object.prototype.toString.call(_)===s&&!isNaN(_)&&isFinite(_)},_isString(_){return Object.prototype.toString.call(_)===a},_isBoolean(_){return Object.prototype.toString.call(_)===i},isObject(_){return _ instanceof Object},isValidSelector(_){if(typeof _!="string")return!1;const N=_[0];return N==="#"||N==="."||N===N.toUpperCase()},_sign(_){return _===0||_>0?1:-1},requestAnimFrame(_){C.push(_),C.length===1&&k(function(){const N=C;C=[],N.forEach(function(E){E()})})},createCanvasElement(){const _=document.createElement("canvas");try{_.style=_.style||{}}catch{}return _},createImageElement(){return document.createElement("img")},_isInDocument(_){for(;_=_.parentNode;)if(_==document)return!0;return!1},_urlToImage(_,N){const E=e.Util.createImageElement();E.onload=function(){N(E)},E.src=_},_rgbToHex(_,N,E){return((1<<24)+(_<<16)+(N<<8)+E).toString(16).slice(1)},_hexToRgb(_){_=_.replace(u,d);const N=parseInt(_,16);return{r:N>>16&255,g:N>>8&255,b:N&255}},getRandomColor(){let _=(Math.random()*16777215<<0).toString(16);for(;_.length<6;)_=f+_;return u+_},getRGB(_){let N;return _ in v?(N=v[_],{r:N[0],g:N[1],b:N[2]}):_[0]===u?this._hexToRgb(_.substring(1)):_.substr(0,4)===x?(N=w.exec(_.replace(/ /g,"")),{r:parseInt(N[1],10),g:parseInt(N[2],10),b:parseInt(N[3],10)}):{r:0,g:0,b:0}},colorToRGBA(_){return _=_||"black",e.Util._namedColorToRBA(_)||e.Util._hex3ColorToRGBA(_)||e.Util._hex4ColorToRGBA(_)||e.Util._hex6ColorToRGBA(_)||e.Util._hex8ColorToRGBA(_)||e.Util._rgbColorToRGBA(_)||e.Util._rgbaColorToRGBA(_)||e.Util._hslColorToRGBA(_)},_namedColorToRBA(_){const N=v[_.toLowerCase()];return N?{r:N[0],g:N[1],b:N[2],a:1}:null},_rgbColorToRGBA(_){if(_.indexOf("rgb(")===0){_=_.match(/rgb\(([^)]+)\)/)[1];const N=_.split(/ *, */).map(Number);return{r:N[0],g:N[1],b:N[2],a:1}}},_rgbaColorToRGBA(_){if(_.indexOf("rgba(")===0){_=_.match(/rgba\(([^)]+)\)/)[1];const N=_.split(/ *, */).map((E,P)=>E.slice(-1)==="%"?P===3?parseInt(E)/100:parseInt(E)/100*255:Number(E));return{r:N[0],g:N[1],b:N[2],a:N[3]}}},_hex8ColorToRGBA(_){if(_[0]==="#"&&_.length===9)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:parseInt(_.slice(7,9),16)/255}},_hex6ColorToRGBA(_){if(_[0]==="#"&&_.length===7)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:1}},_hex4ColorToRGBA(_){if(_[0]==="#"&&_.length===5)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:parseInt(_[4]+_[4],16)/255}},_hex3ColorToRGBA(_){if(_[0]==="#"&&_.length===4)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:1}},_hslColorToRGBA(_){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(_)){const[N,...E]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(_),P=Number(E[0])/360,F=Number(E[1])/100,A=Number(E[2])/100;let j,I,B;if(F===0)return B=A*255,{r:Math.round(B),g:Math.round(B),b:Math.round(B),a:1};A<.5?j=A*(1+F):j=A+F-A*F;const Y=2*A-j,Z=[0,0,0];for(let se=0;se<3;se++)I=P+1/3*-(se-1),I<0&&I++,I>1&&I--,6*I<1?B=Y+(j-Y)*6*I:2*I<1?B=j:3*I<2?B=Y+(j-Y)*(2/3-I)*6:B=Y,Z[se]=B*255;return{r:Math.round(Z[0]),g:Math.round(Z[1]),b:Math.round(Z[2]),a:1}}},haveIntersection(_,N){return!(N.x>_.x+_.width||N.x+N.width<_.x||N.y>_.y+_.height||N.y+N.height<_.y)},cloneObject(_){const N={};for(const E in _)this._isPlainObject(_[E])?N[E]=this.cloneObject(_[E]):this._isArray(_[E])?N[E]=this.cloneArray(_[E]):N[E]=_[E];return N},cloneArray(_){return _.slice(0)},degToRad(_){return _*o},radToDeg(_){return _*c},_degToRad(_){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(_)},_radToDeg(_){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(_)},_getRotation(_){return t.Konva.angleDeg?e.Util.radToDeg(_):_},_capitalize(_){return _.charAt(0).toUpperCase()+_.slice(1)},throw(_){throw new Error(p+_)},error(_){console.error(p+_)},warn(_){t.Konva.showWarnings&&console.warn(g+_)},each(_,N){for(const E in _)N(E,_[E])},_inRange(_,N,E){return N<=_&&_<E},_getProjectionToSegment(_,N,E,P,F,A){let j,I,B;const Y=(_-E)*(_-E)+(N-P)*(N-P);if(Y==0)j=_,I=N,B=(F-E)*(F-E)+(A-P)*(A-P);else{const Z=((F-_)*(E-_)+(A-N)*(P-N))/Y;Z<0?(j=_,I=N,B=(_-F)*(_-F)+(N-A)*(N-A)):Z>1?(j=E,I=P,B=(E-F)*(E-F)+(P-A)*(P-A)):(j=_+Z*(E-_),I=N+Z*(P-N),B=(j-F)*(j-F)+(I-A)*(I-A))}return[j,I,B]},_getProjectionToLine(_,N,E){const P=e.Util.cloneObject(_);let F=Number.MAX_VALUE;return N.forEach(function(A,j){if(!E&&j===N.length-1)return;const I=N[(j+1)%N.length],B=e.Util._getProjectionToSegment(A.x,A.y,I.x,I.y,_.x,_.y),Y=B[0],Z=B[1],se=B[2];se<F&&(P.x=Y,P.y=Z,F=se)}),P},_prepareArrayForTween(_,N,E){const P=[],F=[];if(_.length>N.length){const j=N;N=_,_=j}for(let j=0;j<_.length;j+=2)P.push({x:_[j],y:_[j+1]});for(let j=0;j<N.length;j+=2)F.push({x:N[j],y:N[j+1]});const A=[];return F.forEach(function(j){const I=e.Util._getProjectionToLine(j,P,E);A.push(I.x),A.push(I.y)}),A},_prepareToStringify(_){let N;_.visitedByCircularReferenceRemoval=!0;for(const E in _)if(_.hasOwnProperty(E)&&_[E]&&typeof _[E]=="object"){if(N=Object.getOwnPropertyDescriptor(_,E),_[E].visitedByCircularReferenceRemoval||e.Util._isElement(_[E]))if(N.configurable)delete _[E];else return null;else if(e.Util._prepareToStringify(_[E])===null)if(N.configurable)delete _[E];else return null}return delete _.visitedByCircularReferenceRemoval,_},_assign(_,N){for(const E in N)_[E]=N[E];return _},_getFirstPointerId(_){return _.touches?_.changedTouches[0].identifier:_.pointerId||999},releaseCanvas(..._){t.Konva.releaseCanvasOnDestroy&&_.forEach(N=>{N.width=0,N.height=0})},drawRoundedRectPath(_,N,E,P){let F=0,A=0,j=0,I=0;typeof P=="number"?F=A=j=I=Math.min(P,N/2,E/2):(F=Math.min(P[0]||0,N/2,E/2),A=Math.min(P[1]||0,N/2,E/2),I=Math.min(P[2]||0,N/2,E/2),j=Math.min(P[3]||0,N/2,E/2)),_.moveTo(F,0),_.lineTo(N-A,0),_.arc(N-A,A,A,Math.PI*3/2,0,!1),_.lineTo(N,E-I),_.arc(N-I,E-I,I,0,Math.PI/2,!1),_.lineTo(j,E),_.arc(j,E-j,j,Math.PI/2,Math.PI,!1),_.lineTo(0,F),_.arc(F,F,F,Math.PI,Math.PI*3/2,!1)}}})(VS)),VS}var ox={},Ru={},Mu={},v6;function yL(){if(v6)return Mu;v6=1,Object.defineProperty(Mu,"__esModule",{value:!0}),Mu.HitContext=Mu.SceneContext=Mu.Context=void 0;const e=zs(),t=tn();function r(C){const k=[],_=C.length,N=e.Util;for(let E=0;E<_;E++){let P=C[E];N._isNumber(P)?P=Math.round(P*1e3)/1e3:N._isString(P)||(P=P+""),k.push(P)}return k}const n=",",s="(",a=")",i="([",o="])",c=";",u="()",d="=",f=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],p=100;let x=class{constructor(k){this.canvas=k,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(k){k.fillEnabled()&&this._fill(k)}_fill(k){}strokeShape(k){k.hasStroke()&&this._stroke(k)}_stroke(k){}fillStrokeShape(k){k.attrs.fillAfterStrokeEnabled?(this.strokeShape(k),this.fillShape(k)):(this.fillShape(k),this.strokeShape(k))}getTrace(k,_){let N=this.traceArr,E=N.length,P="",F,A,j,I;for(F=0;F<E;F++)A=N[F],j=A.method,j?(I=A.args,P+=j,k?P+=u:e.Util._isArray(I[0])?P+=i+I.join(n)+o:(_&&(I=I.map(B=>typeof B=="number"?Math.floor(B):B)),P+=s+I.join(n)+a)):(P+=A.property,k||(P+=d+A.val)),P+=c;return P}clearTrace(){this.traceArr=[]}_trace(k){let _=this.traceArr,N;_.push(k),N=_.length,N>=p&&_.shift()}reset(){const k=this.getCanvas().getPixelRatio();this.setTransform(1*k,0,0,1*k,0,0)}getCanvas(){return this.canvas}clear(k){const _=this.getCanvas();k?this.clearRect(k.x||0,k.y||0,k.width||0,k.height||0):this.clearRect(0,0,_.getWidth()/_.pixelRatio,_.getHeight()/_.pixelRatio)}_applyLineCap(k){const _=k.attrs.lineCap;_&&this.setAttr("lineCap",_)}_applyOpacity(k){const _=k.getAbsoluteOpacity();_!==1&&this.setAttr("globalAlpha",_)}_applyLineJoin(k){const _=k.attrs.lineJoin;_&&this.setAttr("lineJoin",_)}setAttr(k,_){this._context[k]=_}arc(k,_,N,E,P,F){this._context.arc(k,_,N,E,P,F)}arcTo(k,_,N,E,P){this._context.arcTo(k,_,N,E,P)}beginPath(){this._context.beginPath()}bezierCurveTo(k,_,N,E,P,F){this._context.bezierCurveTo(k,_,N,E,P,F)}clearRect(k,_,N,E){this._context.clearRect(k,_,N,E)}clip(...k){this._context.clip.apply(this._context,k)}closePath(){this._context.closePath()}createImageData(k,_){const N=arguments;if(N.length===2)return this._context.createImageData(k,_);if(N.length===1)return this._context.createImageData(k)}createLinearGradient(k,_,N,E){return this._context.createLinearGradient(k,_,N,E)}createPattern(k,_){return this._context.createPattern(k,_)}createRadialGradient(k,_,N,E,P,F){return this._context.createRadialGradient(k,_,N,E,P,F)}drawImage(k,_,N,E,P,F,A,j,I){const B=arguments,Y=this._context;B.length===3?Y.drawImage(k,_,N):B.length===5?Y.drawImage(k,_,N,E,P):B.length===9&&Y.drawImage(k,_,N,E,P,F,A,j,I)}ellipse(k,_,N,E,P,F,A,j){this._context.ellipse(k,_,N,E,P,F,A,j)}isPointInPath(k,_,N,E){return N?this._context.isPointInPath(N,k,_,E):this._context.isPointInPath(k,_,E)}fill(...k){this._context.fill.apply(this._context,k)}fillRect(k,_,N,E){this._context.fillRect(k,_,N,E)}strokeRect(k,_,N,E){this._context.strokeRect(k,_,N,E)}fillText(k,_,N,E){E?this._context.fillText(k,_,N,E):this._context.fillText(k,_,N)}measureText(k){return this._context.measureText(k)}getImageData(k,_,N,E){return this._context.getImageData(k,_,N,E)}lineTo(k,_){this._context.lineTo(k,_)}moveTo(k,_){this._context.moveTo(k,_)}rect(k,_,N,E){this._context.rect(k,_,N,E)}roundRect(k,_,N,E,P){this._context.roundRect(k,_,N,E,P)}putImageData(k,_,N){this._context.putImageData(k,_,N)}quadraticCurveTo(k,_,N,E){this._context.quadraticCurveTo(k,_,N,E)}restore(){this._context.restore()}rotate(k){this._context.rotate(k)}save(){this._context.save()}scale(k,_){this._context.scale(k,_)}setLineDash(k){this._context.setLineDash?this._context.setLineDash(k):"mozDash"in this._context?this._context.mozDash=k:"webkitLineDash"in this._context&&(this._context.webkitLineDash=k)}getLineDash(){return this._context.getLineDash()}setTransform(k,_,N,E,P,F){this._context.setTransform(k,_,N,E,P,F)}stroke(k){k?this._context.stroke(k):this._context.stroke()}strokeText(k,_,N,E){this._context.strokeText(k,_,N,E)}transform(k,_,N,E,P,F){this._context.transform(k,_,N,E,P,F)}translate(k,_){this._context.translate(k,_)}_enableTrace(){let k=this,_=f.length,N=this.setAttr,E,P;const F=function(A){let j=k[A],I;k[A]=function(){return P=r(Array.prototype.slice.call(arguments,0)),I=j.apply(k,arguments),k._trace({method:A,args:P}),I}};for(E=0;E<_;E++)F(f[E]);k.setAttr=function(){N.apply(k,arguments);const A=arguments[0];let j=arguments[1];(A==="shadowOffsetX"||A==="shadowOffsetY"||A==="shadowBlur")&&(j=j/this.canvas.getPixelRatio()),k._trace({property:A,val:j})}}_applyGlobalCompositeOperation(k){const _=k.attrs.globalCompositeOperation;!_||_==="source-over"||this.setAttr("globalCompositeOperation",_)}};Mu.Context=x,g.forEach(function(C){Object.defineProperty(x.prototype,C,{get(){return this._context[C]},set(k){this._context[C]=k}})});class v extends x{constructor(k,{willReadFrequently:_=!1}={}){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:_})}_fillColor(k){const _=k.fill();this.setAttr("fillStyle",_),k._fillFunc(this)}_fillPattern(k){this.setAttr("fillStyle",k._getFillPattern()),k._fillFunc(this)}_fillLinearGradient(k){const _=k._getLinearGradient();_&&(this.setAttr("fillStyle",_),k._fillFunc(this))}_fillRadialGradient(k){const _=k._getRadialGradient();_&&(this.setAttr("fillStyle",_),k._fillFunc(this))}_fill(k){const _=k.fill(),N=k.getFillPriority();if(_&&N==="color"){this._fillColor(k);return}const E=k.getFillPatternImage();if(E&&N==="pattern"){this._fillPattern(k);return}const P=k.getFillLinearGradientColorStops();if(P&&N==="linear-gradient"){this._fillLinearGradient(k);return}const F=k.getFillRadialGradientColorStops();if(F&&N==="radial-gradient"){this._fillRadialGradient(k);return}_?this._fillColor(k):E?this._fillPattern(k):P?this._fillLinearGradient(k):F&&this._fillRadialGradient(k)}_strokeLinearGradient(k){const _=k.getStrokeLinearGradientStartPoint(),N=k.getStrokeLinearGradientEndPoint(),E=k.getStrokeLinearGradientColorStops(),P=this.createLinearGradient(_.x,_.y,N.x,N.y);if(E){for(let F=0;F<E.length;F+=2)P.addColorStop(E[F],E[F+1]);this.setAttr("strokeStyle",P)}}_stroke(k){const _=k.dash(),N=k.getStrokeScaleEnabled();if(k.hasStroke()){if(!N){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(k),_&&k.dashEnabled()&&(this.setLineDash(_),this.setAttr("lineDashOffset",k.dashOffset())),this.setAttr("lineWidth",k.strokeWidth()),k.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),k.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(k):this.setAttr("strokeStyle",k.stroke()),k._strokeFunc(this),N||this.restore()}}_applyShadow(k){var _,N,E;const P=(_=k.getShadowRGBA())!==null&&_!==void 0?_:"black",F=(N=k.getShadowBlur())!==null&&N!==void 0?N:5,A=(E=k.getShadowOffset())!==null&&E!==void 0?E:{x:0,y:0},j=k.getAbsoluteScale(),I=this.canvas.getPixelRatio(),B=j.x*I,Y=j.y*I;this.setAttr("shadowColor",P),this.setAttr("shadowBlur",F*Math.min(Math.abs(B),Math.abs(Y))),this.setAttr("shadowOffsetX",A.x*B),this.setAttr("shadowOffsetY",A.y*Y)}}Mu.SceneContext=v;class w extends x{constructor(k){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:!0})}_fill(k){this.save(),this.setAttr("fillStyle",k.colorKey),k._fillFuncHit(this),this.restore()}strokeShape(k){k.hasHitStroke()&&this._stroke(k)}_stroke(k){if(k.hasHitStroke()){const _=k.getStrokeScaleEnabled();if(!_){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(k);const N=k.hitStrokeWidth(),E=N==="auto"?k.strokeWidth():N;this.setAttr("lineWidth",E),this.setAttr("strokeStyle",k.colorKey),k._strokeFuncHit(this),_||this.restore()}}}return Mu.HitContext=w,Mu}var w6;function zb(){if(w6)return Ru;w6=1,Object.defineProperty(Ru,"__esModule",{value:!0}),Ru.HitCanvas=Ru.SceneCanvas=Ru.Canvas=void 0;const e=zs(),t=yL(),r=tn();let n;function s(){if(n)return n;const c=e.Util.createCanvasElement(),u=c.getContext("2d");return n=(function(){const d=r.Konva._global.devicePixelRatio||1,f=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1;return d/f})(),e.Util.releaseCanvas(c),n}let a=class{constructor(u){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const f=(u||{}).pixelRatio||r.Konva.pixelRatio||s();this.pixelRatio=f,this._canvas=e.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(u){const d=this.pixelRatio;this.pixelRatio=u,this.setSize(this.getWidth()/d,this.getHeight()/d)}setWidth(u){this.width=this._canvas.width=u*this.pixelRatio,this._canvas.style.width=u+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}setHeight(u){this.height=this._canvas.height=u*this.pixelRatio,this._canvas.style.height=u+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}getWidth(){return this.width}getHeight(){return this.height}setSize(u,d){this.setWidth(u||0),this.setHeight(d||0)}toDataURL(u,d){try{return this._canvas.toDataURL(u,d)}catch{try{return this._canvas.toDataURL()}catch(g){return e.Util.error("Unable to get data URL. "+g.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Ru.Canvas=a;class i extends a{constructor(u={width:0,height:0,willReadFrequently:!1}){super(u),this.context=new t.SceneContext(this,{willReadFrequently:u.willReadFrequently}),this.setSize(u.width,u.height)}}Ru.SceneCanvas=i;class o extends a{constructor(u={width:0,height:0}){super(u),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(u.width,u.height)}}return Ru.HitCanvas=o,Ru}var KS={},_6;function t4(){return _6||(_6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=tn(),r=zs();e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];e.DD._dragElements.forEach((a,i)=>{const{node:o}=a,c=o.getStage();c.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=c._changedPointerPositions.find(d=>d.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),s.push(o)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];e.DD._dragElements.forEach(a=>{const{node:i}=a,o=i.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;u&&s.indexOf(u)===-1&&s.push(u)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(KS)),KS}var qS={},_o={},b6;function cn(){if(b6)return _o;b6=1,Object.defineProperty(_o,"__esModule",{value:!0}),_o.RGBComponent=n,_o.alphaComponent=s,_o.getNumberValidator=a,_o.getNumberOrArrayOfNumbersValidator=i,_o.getNumberOrAutoValidator=o,_o.getStringValidator=c,_o.getStringOrGradientValidator=u,_o.getFunctionValidator=d,_o.getNumberArrayValidator=f,_o.getBooleanValidator=g,_o.getComponentValidator=p;const e=tn(),t=zs();function r(x){return t.Util._isString(x)?'"'+x+'"':Object.prototype.toString.call(x)==="[object Number]"||t.Util._isBoolean(x)?x:Object.prototype.toString.call(x)}function n(x){return x>255?255:x<0?0:Math.round(x)}function s(x){return x>1?1:x<1e-4?1e-4:x}function a(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isNumber(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a number.'),x}}function i(x){if(e.Konva.isUnminified)return function(v,w){let C=t.Util._isNumber(v),k=t.Util._isArray(v)&&v.length==x;return!C&&!k&&t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a number or Array<number>('+x+")"),v}}function o(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isNumber(x)||x==="auto"||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a number or "auto".'),x}}function c(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isString(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a string.'),x}}function u(){if(e.Konva.isUnminified)return function(x,v){const w=t.Util._isString(x),C=Object.prototype.toString.call(x)==="[object CanvasGradient]"||x&&x.addColorStop;return w||C||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a string or a native gradient.'),x}}function d(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isFunction(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a function.'),x}}function f(){if(e.Konva.isUnminified)return function(x,v){const w=Int8Array?Object.getPrototypeOf(Int8Array):null;return w&&x instanceof w||(t.Util._isArray(x)?x.forEach(function(C){t.Util._isNumber(C)||t.Util.warn('"'+v+'" attribute has non numeric element '+C+". Make sure that all elements are numbers.")}):t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a array of numbers.')),x}}function g(){if(e.Konva.isUnminified)return function(x,v){return x===!0||x===!1||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a boolean.'),x}}function p(x){if(e.Konva.isUnminified)return function(v,w){return v==null||t.Util.isObject(v)||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be an object with properties '+x),v}}return _o}var S6;function on(){return S6||(S6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=zs(),r=cn(),n="get",s="set";e.Factory={addGetterSetter(a,i,o,c,u){e.Factory.addGetter(a,i,o),e.Factory.addSetter(a,i,c,u),e.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,o){const c=n+t.Util._capitalize(i);a.prototype[c]=a.prototype[c]||function(){const u=this.attrs[i];return u===void 0?o:u}},addSetter(a,i,o,c){const u=s+t.Util._capitalize(i);a.prototype[u]||e.Factory.overWriteSetter(a,i,o,c)},overWriteSetter(a,i,o,c){const u=s+t.Util._capitalize(i);a.prototype[u]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,i)),this._setAttr(i,d),c&&c.call(this),this}},addComponentsGetterSetter(a,i,o,c,u){const d=o.length,f=t.Util._capitalize,g=n+f(i),p=s+f(i);a.prototype[g]=function(){const v={};for(let w=0;w<d;w++){const C=o[w];v[C]=this.getAttr(i+f(C))}return v};const x=(0,r.getComponentValidator)(o);a.prototype[p]=function(v){const w=this.attrs[i];c&&(v=c.call(this,v,i)),x&&x.call(this,v,i);for(const C in v)v.hasOwnProperty(C)&&this._setAttr(i+f(C),v[C]);return v||o.forEach(C=>{this._setAttr(i+f(C),void 0)}),this._fireChangeEvent(i,w,v),u&&u.call(this),this},e.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const o=t.Util._capitalize(i),c=s+o,u=n+o;a.prototype[i]=function(){return arguments.length?(this[c](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,i,o,c){t.Util.error("Adding deprecated "+i);const u=n+t.Util._capitalize(i),d=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){t.Util.error(d);const f=this.attrs[i];return f===void 0?o:f},e.Factory.addSetter(a,i,c,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){t.Util.each(i,function(o,c){const u=a.prototype[c],d=n+t.Util._capitalize(o),f=s+t.Util._capitalize(o);function g(){u.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}a.prototype[o]=g,a.prototype[d]=g,a.prototype[f]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(qS)),qS}var k6;function ta(){if(k6)return ox;k6=1,Object.defineProperty(ox,"__esModule",{value:!0}),ox.Node=void 0;const e=zb(),t=t4(),r=on(),n=tn(),s=zs(),a=cn(),i="absoluteOpacity",o="allEventListeners",c="absoluteTransform",u="absoluteScale",d="canvas",f="Change",g="children",p="konva",x="listening",v="mouseenter",w="mouseleave",C="pointerenter",k="pointerleave",_="touchenter",N="touchleave",E="set",P="Shape",F=" ",A="stage",j="transform",I="Stage",B="visible",Y=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(F);let Z=1,se=class IT{constructor(L){this._id=Z++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(L),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(L){(L===j||L===c)&&this._cache.get(L)?this._cache.get(L).dirty=!0:L?this._cache.delete(L):this._cache.clear()}_getCache(L,V){let M=this._cache.get(L);return(M===void 0||(L===j||L===c)&&M.dirty===!0)&&(M=V.call(this),this._cache.set(L,M)),M}_calculate(L,V,M){if(!this._attachedDepsListeners.get(L)){const H=V.map(W=>W+"Change.konva").join(F);this.on(H,()=>{this._clearCache(L)}),this._attachedDepsListeners.set(L,!0)}return this._getCache(L,M)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(L){this._clearCache(L),L===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(d)){const{scene:L,filter:V,hit:M,buffer:H}=this._cache.get(d);s.Util.releaseCanvas(L,V,M,H),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(L){const V=L||{};let M={};(V.x===void 0||V.y===void 0||V.width===void 0||V.height===void 0)&&(M=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let H=Math.ceil(V.width||M.width),W=Math.ceil(V.height||M.height),R=V.pixelRatio,z=V.x===void 0?Math.floor(M.x):V.x,K=V.y===void 0?Math.floor(M.y):V.y,Q=V.offset||0,ae=V.drawBorder||!1,X=V.hitCanvasPixelRatio||1;if(!H||!W){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const ie=Math.abs(Math.round(M.x)-z)>.5?1:0,le=Math.abs(Math.round(M.y)-K)>.5?1:0;H+=Q*2+ie,W+=Q*2+le,z-=Q,K-=Q;const ce=new e.SceneCanvas({pixelRatio:R,width:H,height:W}),_e=new e.SceneCanvas({pixelRatio:R,width:0,height:0,willReadFrequently:!0}),ne=new e.HitCanvas({pixelRatio:X,width:H,height:W}),pe=ce.getContext(),Ce=ne.getContext(),Ae=new e.SceneCanvas({width:ce.width/ce.pixelRatio+Math.abs(z),height:ce.height/ce.pixelRatio+Math.abs(K),pixelRatio:ce.pixelRatio}),Ge=Ae.getContext();return ne.isCache=!0,ce.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,V.imageSmoothingEnabled===!1&&(ce.getContext()._context.imageSmoothingEnabled=!1,_e.getContext()._context.imageSmoothingEnabled=!1),pe.save(),Ce.save(),Ge.save(),pe.translate(-z,-K),Ce.translate(-z,-K),Ge.translate(-z,-K),Ae.x=z,Ae.y=K,this._isUnderCache=!0,this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(u),this.drawScene(ce,this,Ae),this.drawHit(ne,this),this._isUnderCache=!1,pe.restore(),Ce.restore(),ae&&(pe.save(),pe.beginPath(),pe.rect(0,0,H,W),pe.closePath(),pe.setAttr("strokeStyle","red"),pe.setAttr("lineWidth",5),pe.stroke(),pe.restore()),this._cache.set(d,{scene:ce,filter:_e,hit:ne,buffer:Ae,x:z,y:K}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(L){throw new Error('abstract "getClientRect" method call')}_transformedRect(L,V){const M=[{x:L.x,y:L.y},{x:L.x+L.width,y:L.y},{x:L.x+L.width,y:L.y+L.height},{x:L.x,y:L.y+L.height}];let H=1/0,W=1/0,R=-1/0,z=-1/0;const K=this.getAbsoluteTransform(V);return M.forEach(function(Q){const ae=K.point(Q);H===void 0&&(H=R=ae.x,W=z=ae.y),H=Math.min(H,ae.x),W=Math.min(W,ae.y),R=Math.max(R,ae.x),z=Math.max(z,ae.y)}),{x:H,y:W,width:R-H,height:z-W}}_drawCachedSceneCanvas(L){L.save(),L._applyOpacity(this),L._applyGlobalCompositeOperation(this);const V=this._getCanvasCache();L.translate(V.x,V.y);const M=this._getCachedSceneCanvas(),H=M.pixelRatio;L.drawImage(M._canvas,0,0,M.width/H,M.height/H),L.restore()}_drawCachedHitCanvas(L){const V=this._getCanvasCache(),M=V.hit;L.save(),L.translate(V.x,V.y),L.drawImage(M._canvas,0,0,M.width/M.pixelRatio,M.height/M.pixelRatio),L.restore()}_getCachedSceneCanvas(){let L=this.filters(),V=this._getCanvasCache(),M=V.scene,H=V.filter,W=H.getContext(),R,z,K,Q;if(L){if(!this._filterUpToDate){const ae=M.pixelRatio;H.setSize(M.width/M.pixelRatio,M.height/M.pixelRatio);try{for(R=L.length,W.clear(),W.drawImage(M._canvas,0,0,M.getWidth()/ae,M.getHeight()/ae),z=W.getImageData(0,0,H.getWidth(),H.getHeight()),K=0;K<R;K++){if(Q=L[K],typeof Q!="function"){s.Util.error("Filter should be type of function, but got "+typeof Q+" instead. Please check correct filters");continue}Q.call(this,z),W.putImageData(z,0,0)}}catch(X){s.Util.error("Unable to apply filter. "+X.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return H}return M}on(L,V){if(this._cache&&this._cache.delete(o),arguments.length===3)return this._delegate.apply(this,arguments);const M=L.split(F);for(let H=0;H<M.length;H++){const R=M[H].split("."),z=R[0],K=R[1]||"";this.eventListeners[z]||(this.eventListeners[z]=[]),this.eventListeners[z].push({name:K,handler:V})}return this}off(L,V){let M=(L||"").split(F),H=M.length,W,R,z,K,Q,ae;if(this._cache&&this._cache.delete(o),!L)for(R in this.eventListeners)this._off(R);for(W=0;W<H;W++)if(z=M[W],K=z.split("."),Q=K[0],ae=K[1],Q)this.eventListeners[Q]&&this._off(Q,ae,V);else for(R in this.eventListeners)this._off(R,ae,V);return this}dispatchEvent(L){const V={target:this,type:L.type,evt:L};return this.fire(L.type,V),this}addEventListener(L,V){return this.on(L,function(M){V.call(this,M.evt)}),this}removeEventListener(L){return this.off(L),this}_delegate(L,V,M){const H=this;this.on(L,function(W){const R=W.target.findAncestors(V,!0,H);for(let z=0;z<R.length;z++)W=s.Util.cloneObject(W),W.currentTarget=R[z],M.call(R[z],W)})}remove(){return this.isDragging()&&this.stopDrag(),t.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(A),this._clearSelfAndDescendantCache(B),this._clearSelfAndDescendantCache(x)}_remove(){this._clearCaches();const L=this.getParent();L&&L.children&&(L.children.splice(this.index,1),L._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(L){const V="get"+s.Util._capitalize(L);return s.Util._isFunction(this[V])?this[V]():this.attrs[L]}getAncestors(){let L=this.getParent(),V=[];for(;L;)V.push(L),L=L.getParent();return V}getAttrs(){return this.attrs||{}}setAttrs(L){return this._batchTransformChanges(()=>{let V,M;if(!L)return this;for(V in L)V!==g&&(M=E+s.Util._capitalize(V),s.Util._isFunction(this[M])?this[M](L[V]):this._setAttr(V,L[V]))}),this}isListening(){return this._getCache(x,this._isListening)}_isListening(L){if(!this.listening())return!1;const M=this.getParent();return M&&M!==L&&this!==L?M._isListening(L):!0}isVisible(){return this._getCache(B,this._isVisible)}_isVisible(L){if(!this.visible())return!1;const M=this.getParent();return M&&M!==L&&this!==L?M._isVisible(L):!0}shouldDrawHit(L,V=!1){if(L)return this._isVisible(L)&&this._isListening(L);const M=this.getLayer();let H=!1;t.DD._dragElements.forEach(R=>{R.dragStatus==="dragging"&&(R.node.nodeType==="Stage"||R.node.getLayer()===M)&&(H=!0)});const W=!V&&!n.Konva.hitOnDragEnabled&&(H||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!W}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let L=this.getDepth(),V=this,M=0,H,W,R,z;function K(ae){for(H=[],W=ae.length,R=0;R<W;R++)z=ae[R],M++,z.nodeType!==P&&(H=H.concat(z.getChildren().slice())),z._id===V._id&&(R=W);H.length>0&&H[0].getDepth()<=L&&K(H)}const Q=this.getStage();return V.nodeType!==I&&Q&&K(Q.getChildren()),M}getDepth(){let L=0,V=this.parent;for(;V;)L++,V=V.parent;return L}_batchTransformChanges(L){this._batchingTransformChange=!0,L(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(j),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(L){return this._batchTransformChanges(()=>{this.x(L.x),this.y(L.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const L=this.getStage();if(!L)return null;const V=L.getPointerPosition();if(!V)return null;const M=this.getAbsoluteTransform().copy();return M.invert(),M.point(V)}getAbsolutePosition(L){let V=!1,M=this.parent;for(;M;){if(M.isCached()){V=!0;break}M=M.parent}V&&!L&&(L=!0);const H=this.getAbsoluteTransform(L).getMatrix(),W=new s.Transform,R=this.offset();return W.m=H.slice(),W.translate(R.x,R.y),W.getTranslation()}setAbsolutePosition(L){const{x:V,y:M,...H}=this._clearTransform();this.attrs.x=V,this.attrs.y=M,this._clearCache(j);const W=this._getAbsoluteTransform().copy();return W.invert(),W.translate(L.x,L.y),L={x:this.attrs.x+W.getTranslation().x,y:this.attrs.y+W.getTranslation().y},this._setTransform(H),this.setPosition({x:L.x,y:L.y}),this._clearCache(j),this._clearSelfAndDescendantCache(c),this}_setTransform(L){let V;for(V in L)this.attrs[V]=L[V]}_clearTransform(){const L={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,L}move(L){let V=L.x,M=L.y,H=this.x(),W=this.y();return V!==void 0&&(H+=V),M!==void 0&&(W+=M),this.setPosition({x:H,y:W}),this}_eachAncestorReverse(L,V){let M=[],H=this.getParent(),W,R;if(!(V&&V._id===this._id)){for(M.unshift(this);H&&(!V||H._id!==V._id);)M.unshift(H),H=H.parent;for(W=M.length,R=0;R<W;R++)L(M[R])}}rotate(L){return this.rotation(this.rotation()+L),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const L=this.index,V=this.parent.getChildren().length;return L<V-1?(this.parent.children.splice(L,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const L=this.index,V=this.parent.getChildren().length;return L<V-1?(this.parent.children.splice(L,1),this.parent.children.splice(L+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const L=this.index;return L>0?(this.parent.children.splice(L,1),this.parent.children.splice(L-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const L=this.index;return L>0?(this.parent.children.splice(L,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(L){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(L<0||L>=this.parent.children.length)&&s.Util.warn("Unexpected value "+L+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const V=this.index;return this.parent.children.splice(V,1),this.parent.children.splice(L,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(i,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let L=this.opacity();const V=this.getParent();return V&&!V._isUnderCache&&(L*=V.getAbsoluteOpacity()),L}moveTo(L){return this.getParent()!==L&&(this._remove(),L.add(this)),this}toObject(){let L=this.getAttrs(),V,M,H,W,R;const z={attrs:{},className:this.getClassName()};for(V in L)M=L[V],R=s.Util.isObject(M)&&!s.Util._isPlainObject(M)&&!s.Util._isArray(M),!R&&(H=typeof this[V]=="function"&&this[V],delete L[V],W=H?H.call(this):null,L[V]=M,W!==M&&(z.attrs[V]=M));return s.Util._prepareToStringify(z)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(L,V,M){const H=[];V&&this._isMatch(L)&&H.push(this);let W=this.parent;for(;W;){if(W===M)return H;W._isMatch(L)&&H.push(W),W=W.parent}return H}isAncestorOf(L){return!1}findAncestor(L,V,M){return this.findAncestors(L,V,M)[0]}_isMatch(L){if(!L)return!1;if(typeof L=="function")return L(this);let V=L.replace(/ /g,"").split(","),M=V.length,H,W;for(H=0;H<M;H++)if(W=V[H],s.Util.isValidSelector(W)||(s.Util.warn('Selector "'+W+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),W.charAt(0)==="#"){if(this.id()===W.slice(1))return!0}else if(W.charAt(0)==="."){if(this.hasName(W.slice(1)))return!0}else if(this.className===W||this.nodeType===W)return!0;return!1}getLayer(){const L=this.getParent();return L?L.getLayer():null}getStage(){return this._getCache(A,this._getStage)}_getStage(){const L=this.getParent();return L?L.getStage():null}fire(L,V={},M){return V.target=V.target||this,M?this._fireAndBubble(L,V):this._fire(L,V),this}getAbsoluteTransform(L){return L?this._getAbsoluteTransform(L):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(L){let V;if(L)return V=new s.Transform,this._eachAncestorReverse(function(M){const H=M.transformsEnabled();H==="all"?V.multiply(M.getTransform()):H==="position"&&V.translate(M.x()-M.offsetX(),M.y()-M.offsetY())},L),V;{V=this._cache.get(c)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(V):V.reset();const M=this.transformsEnabled();if(M==="all")V.multiply(this.getTransform());else if(M==="position"){const H=this.attrs.x||0,W=this.attrs.y||0,R=this.attrs.offsetX||0,z=this.attrs.offsetY||0;V.translate(H-R,W-z)}return V.dirty=!1,V}}getAbsoluteScale(L){let V=this;for(;V;)V._isUnderCache&&(L=V),V=V.getParent();const H=this.getAbsoluteTransform(L).decompose();return{x:H.scaleX,y:H.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(j,this._getTransform)}_getTransform(){var L,V;const M=this._cache.get(j)||new s.Transform;M.reset();const H=this.x(),W=this.y(),R=n.Konva.getAngle(this.rotation()),z=(L=this.attrs.scaleX)!==null&&L!==void 0?L:1,K=(V=this.attrs.scaleY)!==null&&V!==void 0?V:1,Q=this.attrs.skewX||0,ae=this.attrs.skewY||0,X=this.attrs.offsetX||0,ie=this.attrs.offsetY||0;return(H!==0||W!==0)&&M.translate(H,W),R!==0&&M.rotate(R),(Q!==0||ae!==0)&&M.skew(Q,ae),(z!==1||K!==1)&&M.scale(z,K),(X!==0||ie!==0)&&M.translate(-1*X,-1*ie),M.dirty=!1,M}clone(L){let V=s.Util.cloneObject(this.attrs),M,H,W,R,z;for(M in L)V[M]=L[M];const K=new this.constructor(V);for(M in this.eventListeners)for(H=this.eventListeners[M],W=H.length,R=0;R<W;R++)z=H[R],z.name.indexOf(p)<0&&(K.eventListeners[M]||(K.eventListeners[M]=[]),K.eventListeners[M].push(z));return K}_toKonvaCanvas(L){L=L||{};const V=this.getClientRect(),M=this.getStage(),H=L.x!==void 0?L.x:Math.floor(V.x),W=L.y!==void 0?L.y:Math.floor(V.y),R=L.pixelRatio||1,z=new e.SceneCanvas({width:L.width||Math.ceil(V.width)||(M?M.width():0),height:L.height||Math.ceil(V.height)||(M?M.height():0),pixelRatio:R}),K=z.getContext(),Q=new e.SceneCanvas({width:z.width/z.pixelRatio+Math.abs(H),height:z.height/z.pixelRatio+Math.abs(W),pixelRatio:z.pixelRatio});return L.imageSmoothingEnabled===!1&&(K._context.imageSmoothingEnabled=!1),K.save(),(H||W)&&K.translate(-1*H,-1*W),this.drawScene(z,void 0,Q),K.restore(),z}toCanvas(L){return this._toKonvaCanvas(L)._canvas}toDataURL(L){L=L||{};const V=L.mimeType||null,M=L.quality||null,H=this._toKonvaCanvas(L).toDataURL(V,M);return L.callback&&L.callback(H),H}toImage(L){return new Promise((V,M)=>{try{const H=L?.callback;H&&delete L.callback,s.Util._urlToImage(this.toDataURL(L),function(W){V(W),H?.(W)})}catch(H){M(H)}})}toBlob(L){return new Promise((V,M)=>{try{const H=L?.callback;H&&delete L.callback,this.toCanvas(L).toBlob(W=>{V(W),H?.(W)},L?.mimeType,L?.quality)}catch(H){M(H)}})}setSize(L){return this.width(L.width),this.height(L.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(L,V,M){let H=this.eventListeners[L],W,R,z;for(W=0;W<H.length;W++)if(R=H[W].name,z=H[W].handler,(R!=="konva"||V==="konva")&&(!V||R===V)&&(!M||M===z)){if(H.splice(W,1),H.length===0){delete this.eventListeners[L];break}W--}}_fireChangeEvent(L,V,M){this._fire(L+f,{oldVal:V,newVal:M})}addName(L){if(!this.hasName(L)){const V=this.name(),M=V?V+" "+L:L;this.name(M)}return this}hasName(L){if(!L)return!1;const V=this.name();return V?(V||"").split(/\s/g).indexOf(L)!==-1:!1}removeName(L){const V=(this.name()||"").split(/\s/g),M=V.indexOf(L);return M!==-1&&(V.splice(M,1),this.name(V.join(" "))),this}setAttr(L,V){const M=this[E+s.Util._capitalize(L)];return s.Util._isFunction(M)?M.call(this,V):this._setAttr(L,V),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const L=this.getLayer()||this.getStage();L?.batchDraw()}}_setAttr(L,V){const M=this.attrs[L];M===V&&!s.Util.isObject(V)||(V==null?delete this.attrs[L]:this.attrs[L]=V,this._shouldFireChangeEvents&&this._fireChangeEvent(L,M,V),this._requestDraw())}_setComponentAttr(L,V,M){let H;M!==void 0&&(H=this.attrs[L],H||(this.attrs[L]=this.getAttr(L)),this.attrs[L][V]=M,this._fireChangeEvent(L,H,M))}_fireAndBubble(L,V,M){V&&this.nodeType===P&&(V.target=this);const H=[v,w,C,k,_,N];if(!(H.indexOf(L)!==-1&&(M&&(this===M||this.isAncestorOf&&this.isAncestorOf(M))||this.nodeType==="Stage"&&!M))){this._fire(L,V);const R=H.indexOf(L)!==-1&&M&&M.isAncestorOf&&M.isAncestorOf(this)&&!M.isAncestorOf(this.parent);(V&&!V.cancelBubble||!V)&&this.parent&&this.parent.isListening()&&!R&&(M&&M.parent?this._fireAndBubble.call(this.parent,L,V,M):this._fireAndBubble.call(this.parent,L,V))}}_getProtoListeners(L){var V,M,H;const W=(V=this._cache.get(o))!==null&&V!==void 0?V:{};let R=W?.[L];if(R===void 0){R=[];let z=Object.getPrototypeOf(this);for(;z;){const K=(H=(M=z.eventListeners)===null||M===void 0?void 0:M[L])!==null&&H!==void 0?H:[];R.push(...K),z=Object.getPrototypeOf(z)}W[L]=R,this._cache.set(o,W)}return R}_fire(L,V){V=V||{},V.currentTarget=this,V.type=L;const M=this._getProtoListeners(L);if(M)for(let W=0;W<M.length;W++)M[W].handler.call(this,V);const H=this.eventListeners[L];if(H)for(let W=0;W<H.length;W++)H[W].handler.call(this,V)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(L){const V=L?L.pointerId:void 0,M=this.getStage(),H=this.getAbsolutePosition();if(!M)return;const W=M._getPointerById(V)||M._changedPointerPositions[0]||H;t.DD._dragElements.set(this._id,{node:this,startPointerPos:W,offset:{x:W.x-H.x,y:W.y-H.y},dragStatus:"ready",pointerId:V})}startDrag(L,V=!0){t.DD._dragElements.has(this._id)||this._createDragElement(L);const M=t.DD._dragElements.get(this._id);M.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:L&&L.evt},V)}_setDragPosition(L,V){const M=this.getStage()._getPointerById(V.pointerId);if(!M)return;let H={x:M.x-V.offset.x,y:M.y-V.offset.y};const W=this.dragBoundFunc();if(W!==void 0){const R=W.call(this,H,L);R?H=R:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==H.x||this._lastPos.y!==H.y)&&(this.setAbsolutePosition(H),this._requestDraw()),this._lastPos=H}stopDrag(L){const V=t.DD._dragElements.get(this._id);V&&(V.dragStatus="stopped"),t.DD._endDragBefore(L),t.DD._endDragAfter(L)}setDraggable(L){this._setAttr("draggable",L),this._dragChange()}isDragging(){const L=t.DD._dragElements.get(this._id);return L?L.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(L){if(!(!(L.evt.button!==void 0)||n.Konva.dragButtons.indexOf(L.evt.button)>=0)||this.isDragging())return;let H=!1;t.DD._dragElements.forEach(W=>{this.isAncestorOf(W.node)&&(H=!0)}),H||this._createDragElement(L)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const V=t.DD._dragElements.get(this._id),M=V&&V.dragStatus==="dragging",H=V&&V.dragStatus==="ready";M?this.stopDrag():H&&t.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(L={x:0,y:0}){const V=this.getStage();if(!V)return!1;const M={x:-L.x,y:-L.y,width:V.width()+2*L.x,height:V.height()+2*L.y};return s.Util.haveIntersection(M,this.getClientRect())}static create(L,V){return s.Util._isString(L)&&(L=JSON.parse(L)),this._createNode(L,V)}static _createNode(L,V){let M=IT.prototype.getClassName.call(L),H=L.children,W,R,z;V&&(L.attrs.container=V),n.Konva[M]||(s.Util.warn('Can not find a node with class name "'+M+'". Fallback to "Shape".'),M="Shape");const K=n.Konva[M];if(W=new K(L.attrs),H)for(R=H.length,z=0;z<R;z++)W.add(IT._createNode(H[z]));return W}};ox.Node=se,se.prototype.nodeType="Node",se.prototype._attrsAffectingSize=[],se.prototype.eventListeners={},se.prototype.on.call(se.prototype,Y,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(j),this._clearSelfAndDescendantCache(c)}),se.prototype.on.call(se.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(B)}),se.prototype.on.call(se.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(x)}),se.prototype.on.call(se.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(i)});const ee=r.Factory.addGetterSetter;return ee(se,"zIndex"),ee(se,"absolutePosition"),ee(se,"position"),ee(se,"x",0,(0,a.getNumberValidator)()),ee(se,"y",0,(0,a.getNumberValidator)()),ee(se,"globalCompositeOperation","source-over",(0,a.getStringValidator)()),ee(se,"opacity",1,(0,a.getNumberValidator)()),ee(se,"name","",(0,a.getStringValidator)()),ee(se,"id","",(0,a.getStringValidator)()),ee(se,"rotation",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(se,"scale",["x","y"]),ee(se,"scaleX",1,(0,a.getNumberValidator)()),ee(se,"scaleY",1,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(se,"skew",["x","y"]),ee(se,"skewX",0,(0,a.getNumberValidator)()),ee(se,"skewY",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(se,"offset",["x","y"]),ee(se,"offsetX",0,(0,a.getNumberValidator)()),ee(se,"offsetY",0,(0,a.getNumberValidator)()),ee(se,"dragDistance",void 0,(0,a.getNumberValidator)()),ee(se,"width",0,(0,a.getNumberValidator)()),ee(se,"height",0,(0,a.getNumberValidator)()),ee(se,"listening",!0,(0,a.getBooleanValidator)()),ee(se,"preventDefault",!0,(0,a.getBooleanValidator)()),ee(se,"filters",void 0,function(te){return this._filterUpToDate=!1,te}),ee(se,"visible",!0,(0,a.getBooleanValidator)()),ee(se,"transformsEnabled","all",(0,a.getStringValidator)()),ee(se,"size"),ee(se,"dragBoundFunc"),ee(se,"draggable",!1,(0,a.getBooleanValidator)()),r.Factory.backCompat(se,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),ox}var lx={},C6;function Wb(){if(C6)return lx;C6=1,Object.defineProperty(lx,"__esModule",{value:!0}),lx.Container=void 0;const e=on(),t=ta(),r=cn();let n=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(a){const i=this.children||[];return a?i.filter(a):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.destroy()}),this.children=[],this._requestDraw(),this}add(...a){if(a.length===0)return this;if(a.length>1){for(let o=0;o<a.length;o++)this.add(a[o]);return this}const i=a[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(a){return this._generalFind(a,!1)}findOne(a){const i=this._generalFind(a,!0);return i.length>0?i[0]:void 0}_generalFind(a,i){const o=[];return this._descendants(c=>{const u=c._isMatch(a);return u&&o.push(c),!!(u&&i)}),o}_descendants(a){let i=!1;const o=this.getChildren();for(const c of o){if(i=a(c),i)return!0;if(c.hasChildren()&&(i=c._descendants(a),i))return!0}return!1}toObject(){const a=t.Node.prototype.toObject.call(this);return a.children=[],this.getChildren().forEach(i=>{a.children.push(i.toObject())}),a}isAncestorOf(a){let i=a.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(a){const i=t.Node.prototype.clone.call(this,a);return this.getChildren().forEach(function(o){i.add(o.clone())}),i}getAllIntersections(a){const i=[];return this.find("Shape").forEach(o=>{o.isVisible()&&o.intersects(a)&&i.push(o)}),i}_clearSelfAndDescendantCache(a){var i;super._clearSelfAndDescendantCache(a),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(o){o._clearSelfAndDescendantCache(a)}))}_setChildrenIndices(){var a;(a=this.children)===null||a===void 0||a.forEach(function(i,o){i.index=o}),this._requestDraw()}drawScene(a,i,o){const c=this.getLayer(),u=a||c&&c.getCanvas(),d=u&&u.getContext(),f=this._getCanvasCache(),g=f&&f.scene,p=u&&u.isCache;if(!this.isVisible()&&!p)return this;if(g){d.save();const x=this.getAbsoluteTransform(i).getMatrix();d.transform(x[0],x[1],x[2],x[3],x[4],x[5]),this._drawCachedSceneCanvas(d),d.restore()}else this._drawChildren("drawScene",u,i,o);return this}drawHit(a,i){if(!this.shouldDrawHit(i))return this;const o=this.getLayer(),c=a||o&&o.hitCanvas,u=c&&c.getContext(),d=this._getCanvasCache();if(d&&d.hit){u.save();const g=this.getAbsoluteTransform(i).getMatrix();u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(u),u.restore()}else this._drawChildren("drawHit",c,i);return this}_drawChildren(a,i,o,c){var u;const d=i&&i.getContext(),f=this.clipWidth(),g=this.clipHeight(),p=this.clipFunc(),x=typeof f=="number"&&typeof g=="number"||p,v=o===this;if(x){d.save();const C=this.getAbsoluteTransform(o);let k=C.getMatrix();d.transform(k[0],k[1],k[2],k[3],k[4],k[5]),d.beginPath();let _;if(p)_=p.call(this,d,this);else{const N=this.clipX(),E=this.clipY();d.rect(N||0,E||0,f,g)}d.clip.apply(d,_),k=C.copy().invert().getMatrix(),d.transform(k[0],k[1],k[2],k[3],k[4],k[5])}const w=!v&&this.globalCompositeOperation()!=="source-over"&&a==="drawScene";w&&(d.save(),d._applyGlobalCompositeOperation(this)),(u=this.children)===null||u===void 0||u.forEach(function(C){C[a](i,o,c)}),w&&d.restore(),x&&d.restore()}getClientRect(a={}){var i;const o=a.skipTransform,c=a.relativeTo;let u,d,f,g,p={x:1/0,y:1/0,width:0,height:0};const x=this;(i=this.children)===null||i===void 0||i.forEach(function(C){if(!C.visible())return;const k=C.getClientRect({relativeTo:x,skipShadow:a.skipShadow,skipStroke:a.skipStroke});k.width===0&&k.height===0||(u===void 0?(u=k.x,d=k.y,f=k.x+k.width,g=k.y+k.height):(u=Math.min(u,k.x),d=Math.min(d,k.y),f=Math.max(f,k.x+k.width),g=Math.max(g,k.y+k.height)))});const v=this.find("Shape");let w=!1;for(let C=0;C<v.length;C++)if(v[C]._isVisible(this)){w=!0;break}return w&&u!==void 0?p={x:u,y:d,width:f-u,height:g-d}:p={x:0,y:0,width:0,height:0},o?p:this._transformedRect(p,c)}};return lx.Container=n,e.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),e.Factory.addGetterSetter(n,"clipX",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipY",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipWidth",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipHeight",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipFunc"),lx}var YS={},af={},T6;function vL(){if(T6)return af;T6=1,Object.defineProperty(af,"__esModule",{value:!0}),af.getCapturedShape=n,af.createEvent=s,af.hasPointerCapture=a,af.setPointerCapture=i,af.releaseCapture=o;const e=tn(),t=new Map,r=e.Konva._global.PointerEvent!==void 0;function n(c){return t.get(c)}function s(c){return{evt:c,pointerId:c.pointerId}}function a(c,u){return t.get(c)===u}function i(c,u){o(c),u.getStage()&&(t.set(c,u),r&&u._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function o(c,u){const d=t.get(c);if(!d)return;const f=d.getStage();f&&f.content,t.delete(c),r&&d._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return af}var E6;function BJ(){return E6||(E6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=zs(),r=on(),n=Wb(),s=tn(),a=zb(),i=t4(),o=tn(),c=vL(),u="Stage",d="string",f="px",g="mouseout",p="mouseleave",x="mouseover",v="mouseenter",w="mousemove",C="mousedown",k="mouseup",_="pointermove",N="pointerdown",E="pointerup",P="pointercancel",F="lostpointercapture",A="pointerout",j="pointerleave",I="pointerover",B="pointerenter",Y="contextmenu",Z="touchstart",se="touchend",ee="touchmove",te="touchcancel",L="wheel",V=5,M=[[v,"_pointerenter"],[C,"_pointerdown"],[w,"_pointermove"],[k,"_pointerup"],[p,"_pointerleave"],[Z,"_pointerdown"],[ee,"_pointermove"],[se,"_pointerup"],[te,"_pointercancel"],[x,"_pointerover"],[L,"_wheel"],[Y,"_contextmenu"],[N,"_pointerdown"],[_,"_pointermove"],[E,"_pointerup"],[P,"_pointercancel"],[j,"_pointerleave"],[F,"_lostpointercapture"]],H={mouse:{[A]:g,[j]:p,[I]:x,[B]:v,[_]:w,[N]:C,[E]:k,[P]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[A]:"touchout",[j]:"touchleave",[I]:"touchover",[B]:"touchenter",[_]:ee,[N]:Z,[E]:se,[P]:te,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[A]:A,[j]:j,[I]:I,[B]:B,[_]:_,[N]:N,[E]:E,[P]:P,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},W=ae=>ae.indexOf("pointer")>=0?"pointer":ae.indexOf("touch")>=0?"touch":"mouse",R=ae=>{const X=W(ae);if(X==="pointer")return s.Konva.pointerEventsEnabled&&H.pointer;if(X==="touch")return H.touch;if(X==="mouse")return H.mouse};function z(ae={}){return(ae.clipFunc||ae.clipWidth||ae.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ae}const K="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class Q extends n.Container{constructor(X){super(z(X)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{z(this.attrs)}),this._checkVisibility()}_validateAdd(X){const ie=X.getType()==="Layer",le=X.getType()==="FastLayer";ie||le||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const X=this.visible()?"":"none";this.content.style.display=X}setContainer(X){if(typeof X===d){let ie;if(X.charAt(0)==="."){const le=X.slice(1);X=document.getElementsByClassName(le)[0]}else X.charAt(0)!=="#"?ie=X:ie=X.slice(1),X=document.getElementById(ie);if(!X)throw"Can not find container in document with id "+ie}return this._setAttr("container",X),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),X.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const X=this.children,ie=X.length;for(let le=0;le<ie;le++)X[le].clear();return this}clone(X){return X||(X={}),X.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,X)}destroy(){super.destroy();const X=this.content;X&&t.Util._isInDocument(X)&&this.container().removeChild(X);const ie=e.stages.indexOf(this);return ie>-1&&e.stages.splice(ie,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const X=this._pointerPositions[0]||this._changedPointerPositions[0];return X?{x:X.x,y:X.y}:(t.Util.warn(K),null)}_getPointerById(X){return this._pointerPositions.find(ie=>ie.id===X)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(X){X=X||{},X.x=X.x||0,X.y=X.y||0,X.width=X.width||this.width(),X.height=X.height||this.height();const ie=new a.SceneCanvas({width:X.width,height:X.height,pixelRatio:X.pixelRatio||1}),le=ie.getContext()._context,ce=this.children;return(X.x||X.y)&&le.translate(-1*X.x,-1*X.y),ce.forEach(function(_e){if(!_e.isVisible())return;const ne=_e._toKonvaCanvas(X);le.drawImage(ne._canvas,X.x,X.y,ne.getWidth()/ne.getPixelRatio(),ne.getHeight()/ne.getPixelRatio())}),ie}getIntersection(X){if(!X)return null;const ie=this.children,le=ie.length,ce=le-1;for(let _e=ce;_e>=0;_e--){const ne=ie[_e].getIntersection(X);if(ne)return ne}return null}_resizeDOM(){const X=this.width(),ie=this.height();this.content&&(this.content.style.width=X+f,this.content.style.height=ie+f),this.bufferCanvas.setSize(X,ie),this.bufferHitCanvas.setSize(X,ie),this.children.forEach(le=>{le.setSize({width:X,height:ie}),le.draw()})}add(X,...ie){if(arguments.length>1){for(let ce=0;ce<arguments.length;ce++)this.add(arguments[ce]);return this}super.add(X);const le=this.children.length;return le>V&&t.Util.warn("The stage has "+le+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),X.setSize({width:this.width(),height:this.height()}),X.draw(),s.Konva.isBrowser&&this.content.appendChild(X.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(X){return c.hasPointerCapture(X,this)}setPointerCapture(X){c.setPointerCapture(X,this)}releaseCapture(X){c.releaseCapture(X,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&M.forEach(([X,ie])=>{this.content.addEventListener(X,le=>{this[ie](le)},{passive:!1})})}_pointerenter(X){this.setPointersPositions(X);const ie=R(X.type);ie&&this._fire(ie.pointerenter,{evt:X,target:this,currentTarget:this})}_pointerover(X){this.setPointersPositions(X);const ie=R(X.type);ie&&this._fire(ie.pointerover,{evt:X,target:this,currentTarget:this})}_getTargetShape(X){let ie=this[X+"targetShape"];return ie&&!ie.getStage()&&(ie=null),ie}_pointerleave(X){const ie=R(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);const ce=this._getTargetShape(le),_e=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;ce&&_e?(ce._fireAndBubble(ie.pointerout,{evt:X}),ce._fireAndBubble(ie.pointerleave,{evt:X}),this._fire(ie.pointerleave,{evt:X,target:this,currentTarget:this}),this[le+"targetShape"]=null):_e&&(this._fire(ie.pointerleave,{evt:X,target:this,currentTarget:this}),this._fire(ie.pointerout,{evt:X,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(X){const ie=R(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);let ce=!1;this._changedPointerPositions.forEach(_e=>{const ne=this.getIntersection(_e);if(i.DD.justDragged=!1,s.Konva["_"+le+"ListenClick"]=!0,!ne||!ne.isListening()){this[le+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&ne.setPointerCapture(_e.id),this[le+"ClickStartShape"]=ne,ne._fireAndBubble(ie.pointerdown,{evt:X,pointerId:_e.id}),ce=!0;const pe=X.type.indexOf("touch")>=0;ne.preventDefault()&&X.cancelable&&pe&&X.preventDefault()}),ce||this._fire(ie.pointerdown,{evt:X,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(X){const ie=R(X.type),le=W(X.type);if(!ie||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&X.cancelable&&X.preventDefault(),this.setPointersPositions(X),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const _e={};let ne=!1;const pe=this._getTargetShape(le);this._changedPointerPositions.forEach(Ce=>{const Ae=c.getCapturedShape(Ce.id)||this.getIntersection(Ce),Ge=Ce.id,Le={evt:X,pointerId:Ge},At=pe!==Ae;if(At&&pe&&(pe._fireAndBubble(ie.pointerout,{...Le},Ae),pe._fireAndBubble(ie.pointerleave,{...Le},Ae)),Ae){if(_e[Ae._id])return;_e[Ae._id]=!0}Ae&&Ae.isListening()?(ne=!0,At&&(Ae._fireAndBubble(ie.pointerover,{...Le},pe),Ae._fireAndBubble(ie.pointerenter,{...Le},pe),this[le+"targetShape"]=Ae),Ae._fireAndBubble(ie.pointermove,{...Le})):pe&&(this._fire(ie.pointerover,{evt:X,target:this,currentTarget:this,pointerId:Ge}),this[le+"targetShape"]=null)}),ne||this._fire(ie.pointermove,{evt:X,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(X){const ie=R(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);const ce=this[le+"ClickStartShape"],_e=this[le+"ClickEndShape"],ne={};let pe=!1;this._changedPointerPositions.forEach(Ce=>{const Ae=c.getCapturedShape(Ce.id)||this.getIntersection(Ce);if(Ae){if(Ae.releaseCapture(Ce.id),ne[Ae._id])return;ne[Ae._id]=!0}const Ge=Ce.id,Le={evt:X,pointerId:Ge};let At=!1;s.Konva["_"+le+"InDblClickWindow"]?(At=!0,clearTimeout(this[le+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+le+"InDblClickWindow"]=!0,clearTimeout(this[le+"DblTimeout"])),this[le+"DblTimeout"]=setTimeout(function(){s.Konva["_"+le+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),Ae&&Ae.isListening()?(pe=!0,this[le+"ClickEndShape"]=Ae,Ae._fireAndBubble(ie.pointerup,{...Le}),s.Konva["_"+le+"ListenClick"]&&ce&&ce===Ae&&(Ae._fireAndBubble(ie.pointerclick,{...Le}),At&&_e&&_e===Ae&&Ae._fireAndBubble(ie.pointerdblclick,{...Le}))):(this[le+"ClickEndShape"]=null,s.Konva["_"+le+"ListenClick"]&&this._fire(ie.pointerclick,{evt:X,target:this,currentTarget:this,pointerId:Ge}),At&&this._fire(ie.pointerdblclick,{evt:X,target:this,currentTarget:this,pointerId:Ge}))}),pe||this._fire(ie.pointerup,{evt:X,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+le+"ListenClick"]=!1,X.cancelable&&le!=="touch"&&le!=="pointer"&&X.preventDefault()}_contextmenu(X){this.setPointersPositions(X);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(Y,{evt:X}):this._fire(Y,{evt:X,target:this,currentTarget:this})}_wheel(X){this.setPointersPositions(X);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(L,{evt:X}):this._fire(L,{evt:X,target:this,currentTarget:this})}_pointercancel(X){this.setPointersPositions(X);const ie=c.getCapturedShape(X.pointerId)||this.getIntersection(this.getPointerPosition());ie&&ie._fireAndBubble(E,c.createEvent(X)),c.releaseCapture(X.pointerId)}_lostpointercapture(X){c.releaseCapture(X.pointerId)}setPointersPositions(X){const ie=this._getContentPosition();let le=null,ce=null;X=X||window.event,X.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(X.touches,_e=>{this._pointerPositions.push({id:_e.identifier,x:(_e.clientX-ie.left)/ie.scaleX,y:(_e.clientY-ie.top)/ie.scaleY})}),Array.prototype.forEach.call(X.changedTouches||X.touches,_e=>{this._changedPointerPositions.push({id:_e.identifier,x:(_e.clientX-ie.left)/ie.scaleX,y:(_e.clientY-ie.top)/ie.scaleY})})):(le=(X.clientX-ie.left)/ie.scaleX,ce=(X.clientY-ie.top)/ie.scaleY,this.pointerPos={x:le,y:ce},this._pointerPositions=[{x:le,y:ce,id:t.Util._getFirstPointerId(X)}],this._changedPointerPositions=[{x:le,y:ce,id:t.Util._getFirstPointerId(X)}])}_setPointerPosition(X){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(X)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const X=this.content.getBoundingClientRect();return{top:X.top,left:X.left,scaleX:X.width/this.content.clientWidth||1,scaleY:X.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const X=this.container();if(!X)throw"Stage has no container. A container is required.";X.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),X.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(X){X.batchDraw()}),this}}e.Stage=Q,Q.prototype.nodeType=u,(0,o._registerNode)(Q),r.Factory.addGetterSetter(Q,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(ae=>{ae.batchDraw()})})})(YS)),YS}var cx={},XS={},N6;function qa(){return N6||(N6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=tn(),r=zs(),n=on(),s=ta(),a=cn(),i=tn(),o=vL(),c="hasShadow",u="shadowRGBA",d="patternImage",f="linearGradient",g="radialGradient";let p;function x(){return p||(p=r.Util.createCanvasElement().getContext("2d"),p)}e.shapes={};function v(j){const I=this.attrs.fillRule;I?j.fill(I):j.fill()}function w(j){j.stroke()}function C(j){const I=this.attrs.fillRule;I?j.fill(I):j.fill()}function k(j){j.stroke()}function _(){this._clearCache(c)}function N(){this._clearCache(u)}function E(){this._clearCache(d)}function P(){this._clearCache(f)}function F(){this._clearCache(g)}class A extends s.Node{constructor(I){super(I);let B;for(;B=r.Util.getRandomColor(),!(B&&!(B in e.shapes)););this.colorKey=B,e.shapes[B]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const B=x().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(B&&B.setTransform){const Y=new r.Transform;Y.translate(this.fillPatternX(),this.fillPatternY()),Y.rotate(t.Konva.getAngle(this.fillPatternRotation())),Y.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),Y.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const Z=Y.getMatrix(),se=typeof DOMMatrix>"u"?{a:Z[0],b:Z[1],c:Z[2],d:Z[3],e:Z[4],f:Z[5]}:new DOMMatrix(Z);B.setTransform(se)}return B}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){const I=this.fillLinearGradientColorStops();if(I){const B=x(),Y=this.fillLinearGradientStartPoint(),Z=this.fillLinearGradientEndPoint(),se=B.createLinearGradient(Y.x,Y.y,Z.x,Z.y);for(let ee=0;ee<I.length;ee+=2)se.addColorStop(I[ee],I[ee+1]);return se}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const I=this.fillRadialGradientColorStops();if(I){const B=x(),Y=this.fillRadialGradientStartPoint(),Z=this.fillRadialGradientEndPoint(),se=B.createRadialGradient(Y.x,Y.y,this.fillRadialGradientStartRadius(),Z.x,Z.y,this.fillRadialGradientEndRadius());for(let ee=0;ee<I.length;ee+=2)se.addColorStop(I[ee],I[ee+1]);return se}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const I=r.Util.colorToRGBA(this.shadowColor());if(I)return"rgba("+I.r+","+I.g+","+I.b+","+I.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const I=this.hitStrokeWidth();return I==="auto"?this.hasStroke():this.strokeEnabled()&&!!I}intersects(I){const B=this.getStage();if(!B)return!1;const Y=B.bufferHitCanvas;return Y.getContext().clear(),this.drawHit(Y,void 0,!0),Y.context.getImageData(Math.round(I.x),Math.round(I.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(I){var B;if(!((B=this.attrs.perfectDrawEnabled)!==null&&B!==void 0?B:!0))return!1;const Z=I||this.hasFill(),se=this.hasStroke(),ee=this.getAbsoluteOpacity()!==1;if(Z&&se&&ee)return!0;const te=this.hasShadow(),L=this.shadowForStrokeEnabled();return!!(Z&&se&&te&&L)}setStrokeHitEnabled(I){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),I?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const I=this.size();return{x:this._centroid?-I.width/2:0,y:this._centroid?-I.height/2:0,width:I.width,height:I.height}}getClientRect(I={}){let B=!1,Y=this.getParent();for(;Y;){if(Y.isCached()){B=!0;break}Y=Y.getParent()}const Z=I.skipTransform,se=I.relativeTo||B&&this.getStage()||void 0,ee=this.getSelfRect(),L=!I.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,V=ee.width+L,M=ee.height+L,H=!I.skipShadow&&this.hasShadow(),W=H?this.shadowOffsetX():0,R=H?this.shadowOffsetY():0,z=V+Math.abs(W),K=M+Math.abs(R),Q=H&&this.shadowBlur()||0,ae=z+Q*2,X=K+Q*2,ie={width:ae,height:X,x:-(L/2+Q)+Math.min(W,0)+ee.x,y:-(L/2+Q)+Math.min(R,0)+ee.y};return Z?ie:this._transformedRect(ie,se)}drawScene(I,B,Y){const Z=this.getLayer(),se=I||Z.getCanvas(),ee=se.getContext(),te=this._getCanvasCache(),L=this.getSceneFunc(),V=this.hasShadow();let M;const H=B===this;if(!this.isVisible()&&!H)return this;if(te){ee.save();const W=this.getAbsoluteTransform(B).getMatrix();return ee.transform(W[0],W[1],W[2],W[3],W[4],W[5]),this._drawCachedSceneCanvas(ee),ee.restore(),this}if(!L)return this;if(ee.save(),this._useBufferCanvas()){M=this.getStage();const W=Y||M.bufferCanvas,R=W.getContext();R.clear(),R.save(),R._applyLineJoin(this);const z=this.getAbsoluteTransform(B).getMatrix();R.transform(z[0],z[1],z[2],z[3],z[4],z[5]),L.call(this,R,this),R.restore();const K=W.pixelRatio;V&&ee._applyShadow(this),ee._applyOpacity(this),ee._applyGlobalCompositeOperation(this),ee.drawImage(W._canvas,W.x||0,W.y||0,W.width/K,W.height/K)}else{if(ee._applyLineJoin(this),!H){const W=this.getAbsoluteTransform(B).getMatrix();ee.transform(W[0],W[1],W[2],W[3],W[4],W[5]),ee._applyOpacity(this),ee._applyGlobalCompositeOperation(this)}V&&ee._applyShadow(this),L.call(this,ee,this)}return ee.restore(),this}drawHit(I,B,Y=!1){if(!this.shouldDrawHit(B,Y))return this;const Z=this.getLayer(),se=I||Z.hitCanvas,ee=se&&se.getContext(),te=this.hitFunc()||this.sceneFunc(),L=this._getCanvasCache(),V=L&&L.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),V){ee.save();const H=this.getAbsoluteTransform(B).getMatrix();return ee.transform(H[0],H[1],H[2],H[3],H[4],H[5]),this._drawCachedHitCanvas(ee),ee.restore(),this}if(!te)return this;if(ee.save(),ee._applyLineJoin(this),!(this===B)){const H=this.getAbsoluteTransform(B).getMatrix();ee.transform(H[0],H[1],H[2],H[3],H[4],H[5])}return te.call(this,ee,this),ee.restore(),this}drawHitFromCache(I=0){const B=this._getCanvasCache(),Y=this._getCachedSceneCanvas(),Z=B.hit,se=Z.getContext(),ee=Z.getWidth(),te=Z.getHeight();se.clear(),se.drawImage(Y._canvas,0,0,ee,te);try{const L=se.getImageData(0,0,ee,te),V=L.data,M=V.length,H=r.Util._hexToRgb(this.colorKey);for(let W=0;W<M;W+=4)V[W+3]>I?(V[W]=H.r,V[W+1]=H.g,V[W+2]=H.b,V[W+3]=255):V[W+3]=0;se.putImageData(L,0,0)}catch(L){r.Util.error("Unable to draw hit graph from cached scene canvas. "+L.message)}return this}hasPointerCapture(I){return o.hasPointerCapture(I,this)}setPointerCapture(I){o.setPointerCapture(I,this)}releaseCapture(I){o.releaseCapture(I,this)}}e.Shape=A,A.prototype._fillFunc=v,A.prototype._strokeFunc=w,A.prototype._fillFuncHit=C,A.prototype._strokeFuncHit=k,A.prototype._centroid=!1,A.prototype.nodeType="Shape",(0,i._registerNode)(A),A.prototype.eventListeners={},A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",N),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",E),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",P),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",F),n.Factory.addGetterSetter(A,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(A,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(A,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(A,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"lineJoin"),n.Factory.addGetterSetter(A,"lineCap"),n.Factory.addGetterSetter(A,"sceneFunc"),n.Factory.addGetterSetter(A,"hitFunc"),n.Factory.addGetterSetter(A,"dash"),n.Factory.addGetterSetter(A,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(A,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(A,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternImage"),n.Factory.addGetterSetter(A,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(A,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(A,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(A,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(A,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(A,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(A,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(A,"fillEnabled",!0),n.Factory.addGetterSetter(A,"strokeEnabled",!0),n.Factory.addGetterSetter(A,"shadowEnabled",!0),n.Factory.addGetterSetter(A,"dashEnabled",!0),n.Factory.addGetterSetter(A,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(A,"fillPriority","color"),n.Factory.addComponentsGetterSetter(A,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(A,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(A,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(A,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(A,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(A,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(A,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(A,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(A,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(A,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(A,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(A,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(A,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(A,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(A,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(A,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(A,"fillPatternRotation",0),n.Factory.addGetterSetter(A,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(A,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(XS)),XS}var A6;function wL(){if(A6)return cx;A6=1,Object.defineProperty(cx,"__esModule",{value:!0}),cx.Layer=void 0;const e=zs(),t=Wb(),r=ta(),n=on(),s=zb(),a=cn(),i=qa(),o=tn(),c="#",u="beforeDraw",d="draw",f=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=f.length;class p extends t.Container{constructor(v){super(v),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(v){return this.getContext().clear(v),this.getHitCanvas().getContext().clear(v),this}setZIndex(v){super.setZIndex(v);const w=this.getStage();return w&&w.content&&(w.content.removeChild(this.getNativeCanvasElement()),v<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[v+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!r.Node.prototype.moveUp.call(this))return!1;const w=this.getStage();return!w||!w.content?!1:(w.content.removeChild(this.getNativeCanvasElement()),this.index<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[this.index+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const v=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),v&&v.parentNode&&e.Util._isInDocument(v)&&v.parentNode.removeChild(v),this}getStage(){return this.parent}setSize({width:v,height:w}){return this.canvas.setSize(v,w),this.hitCanvas.setSize(v,w),this._setSmoothEnabled(),this}_validateAdd(v){const w=v.getType();w!=="Group"&&w!=="Shape"&&e.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(v){return v=v||{},v.width=v.width||this.getWidth(),v.height=v.height||this.getHeight(),v.x=v.x!==void 0?v.x:this.x(),v.y=v.y!==void 0?v.y:this.y(),r.Node.prototype._toKonvaCanvas.call(this,v)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){e.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){e.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,e.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(v){if(!this.isListening()||!this.isVisible())return null;let w=1,C=!1;for(;;){for(let k=0;k<g;k++){const _=f[k],N=this._getIntersection({x:v.x+_.x*w,y:v.y+_.y*w}),E=N.shape;if(E)return E;if(C=!!N.antialiased,!N.antialiased)break}if(C)w+=1;else return null}}_getIntersection(v){const w=this.hitCanvas.pixelRatio,C=this.hitCanvas.context.getImageData(Math.round(v.x*w),Math.round(v.y*w),1,1).data,k=C[3];if(k===255){const _=e.Util._rgbToHex(C[0],C[1],C[2]),N=i.shapes[c+_];return N?{shape:N}:{antialiased:!0}}else if(k>0)return{antialiased:!0};return{}}drawScene(v,w,C){const k=this.getLayer(),_=v||k&&k.getCanvas();return this._fire(u,{node:this}),this.clearBeforeDraw()&&_.getContext().clear(),t.Container.prototype.drawScene.call(this,_,w,C),this._fire(d,{node:this}),this}drawHit(v,w){const C=this.getLayer(),k=v||C&&C.hitCanvas;return C&&C.clearBeforeDraw()&&C.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,k,w),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(v){e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(v)}getHitGraphEnabled(v){return e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const v=this.parent;!!this.hitCanvas._canvas.parentNode?v.content.removeChild(this.hitCanvas._canvas):v.content.appendChild(this.hitCanvas._canvas)}destroy(){return e.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return cx.Layer=p,p.prototype.nodeType="Layer",(0,o._registerNode)(p),n.Factory.addGetterSetter(p,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(p,"clearBeforeDraw",!0),n.Factory.addGetterSetter(p,"hitGraphEnabled",!0,(0,a.getBooleanValidator)()),cx}var ux={},j6;function $J(){if(j6)return ux;j6=1,Object.defineProperty(ux,"__esModule",{value:!0}),ux.FastLayer=void 0;const e=zs(),t=wL(),r=tn();class n extends t.Layer{constructor(a){super(a),this.listening(!1),e.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}return ux.FastLayer=n,n.prototype.nodeType="FastLayer",(0,r._registerNode)(n),ux}var dx={},P6;function r4(){if(P6)return dx;P6=1,Object.defineProperty(dx,"__esModule",{value:!0}),dx.Group=void 0;const e=zs(),t=Wb(),r=tn();class n extends t.Container{_validateAdd(a){const i=a.getType();i!=="Group"&&i!=="Shape"&&e.Util.throw("You may only add groups and shapes to groups.")}}return dx.Group=n,n.prototype.nodeType="Group",(0,r._registerNode)(n),dx}var fx={},F6;function n4(){if(F6)return fx;F6=1,Object.defineProperty(fx,"__esModule",{value:!0}),fx.Animation=void 0;const e=tn(),t=zs(),r=(function(){return e.glob.performance&&e.glob.performance.now?function(){return e.glob.performance.now()}:function(){return new Date().getTime()}})();let n=class Ug{constructor(a,i){this.id=Ug.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=a,this.setLayers(i)}setLayers(a){let i=[];return a&&(i=Array.isArray(a)?a:[a]),this.layers=i,this}getLayers(){return this.layers}addLayer(a){const i=this.layers,o=i.length;for(let c=0;c<o;c++)if(i[c]._id===a._id)return!1;return this.layers.push(a),!0}isRunning(){const i=Ug.animations,o=i.length;for(let c=0;c<o;c++)if(i[c].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),Ug._addAnimation(this),this}stop(){return Ug._removeAnimation(this),this}_updateFrameObject(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(a){this.animations.push(a),this._handleAnimation()}static _removeAnimation(a){const i=a.id,o=this.animations,c=o.length;for(let u=0;u<c;u++)if(o[u].id===i){this.animations.splice(u,1);break}}static _runFrames(){const a={},i=this.animations;for(let o=0;o<i.length;o++){const c=i[o],u=c.layers,d=c.func;c._updateFrameObject(r());const f=u.length;let g;if(d?g=d.call(c,c.frame)!==!1:g=!0,!!g)for(let p=0;p<f;p++){const x=u[p];x._id!==void 0&&(a[x._id]=x)}}for(const o in a)a.hasOwnProperty(o)&&a[o].batchDraw()}static _animationLoop(){const a=Ug;a.animations.length?(a._runFrames(),t.Util.requestAnimFrame(a._animationLoop)):a.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return fx.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,fx}var QS={},O6;function UJ(){return O6||(O6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=zs(),r=n4(),n=ta(),s=tn(),a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,o=2,c=3,u=["fill","stroke","shadowColor"];let d=0;class f{constructor(x,v,w,C,k,_,N){this.prop=x,this.propFunc=v,this.begin=C,this._pos=C,this.duration=_,this._change=0,this.prevPos=0,this.yoyo=N,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=w,this._change=k-this.begin,this.pause()}fire(x){const v=this[x];v&&v()}setTime(x){x>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():x<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=x,this.update())}getTime(){return this._time}setPosition(x){this.prevPos=this._pos,this.propFunc(x),this._pos=x}getPosition(x){return x===void 0&&(x=this._time),this.func(x,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(x){this.pause(),this._time=x,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const x=this.getTimer()-this._startTime;this.state===o?this.setTime(x):this.state===c&&this.setTime(this.duration-x)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(x){const v=this,w=x.node,C=w._id,k=x.easing||e.Easings.Linear,_=!!x.yoyo;let N,E;typeof x.duration>"u"?N=.3:x.duration===0?N=.001:N=x.duration,this.node=w,this._id=d++;const P=w.getLayer()||(w instanceof s.Konva.Stage?w.getLayers():null);P||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){v.tween.onEnterFrame()},P),this.tween=new f(E,function(F){v._tweenFunc(F)},k,0,1,N*1e3,_),this._addListeners(),g.attrs[C]||(g.attrs[C]={}),g.attrs[C][this._id]||(g.attrs[C][this._id]={}),g.tweens[C]||(g.tweens[C]={});for(E in x)a[E]===void 0&&this._addAttr(E,x[E]);this.reset(),this.onFinish=x.onFinish,this.onReset=x.onReset,this.onUpdate=x.onUpdate}_addAttr(x,v){const w=this.node,C=w._id;let k,_,N,E,P;const F=g.tweens[C][x];F&&delete g.attrs[C][F][x];let A=w.getAttr(x);if(t.Util._isArray(v))if(k=[],_=Math.max(v.length,A.length),x==="points"&&v.length!==A.length&&(v.length>A.length?(E=A,A=t.Util._prepareArrayForTween(A,v,w.closed())):(N=v,v=t.Util._prepareArrayForTween(v,A,w.closed()))),x.indexOf("fill")===0)for(let j=0;j<_;j++)if(j%2===0)k.push(v[j]-A[j]);else{const I=t.Util.colorToRGBA(A[j]);P=t.Util.colorToRGBA(v[j]),A[j]=I,k.push({r:P.r-I.r,g:P.g-I.g,b:P.b-I.b,a:P.a-I.a})}else for(let j=0;j<_;j++)k.push(v[j]-A[j]);else u.indexOf(x)!==-1?(A=t.Util.colorToRGBA(A),P=t.Util.colorToRGBA(v),k={r:P.r-A.r,g:P.g-A.g,b:P.b-A.b,a:P.a-A.a}):k=v-A;g.attrs[C][this._id][x]={start:A,diff:k,end:v,trueEnd:N,trueStart:E},g.tweens[C][x]=this._id}_tweenFunc(x){const v=this.node,w=g.attrs[v._id][this._id];let C,k,_,N,E,P,F,A;for(C in w){if(k=w[C],_=k.start,N=k.diff,A=k.end,t.Util._isArray(_))if(E=[],F=Math.max(_.length,A.length),C.indexOf("fill")===0)for(P=0;P<F;P++)P%2===0?E.push((_[P]||0)+N[P]*x):E.push("rgba("+Math.round(_[P].r+N[P].r*x)+","+Math.round(_[P].g+N[P].g*x)+","+Math.round(_[P].b+N[P].b*x)+","+(_[P].a+N[P].a*x)+")");else for(P=0;P<F;P++)E.push((_[P]||0)+N[P]*x);else u.indexOf(C)!==-1?E="rgba("+Math.round(_.r+N.r*x)+","+Math.round(_.g+N.g*x)+","+Math.round(_.b+N.b*x)+","+(_.a+N.a*x)+")":E=_+N*x;v.setAttr(C,E)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const x=this.node,v=g.attrs[x._id][this._id];v.points&&v.points.trueEnd&&x.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const x=this.node,v=g.attrs[x._id][this._id];v.points&&v.points.trueStart&&x.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(x){return this.tween.seek(x*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const x=this.node._id,v=this._id,w=g.tweens[x];this.pause(),this.anim&&this.anim.stop();for(const C in w)delete g.tweens[x][C];delete g.attrs[x][v],g.tweens[x]&&(Object.keys(g.tweens[x]).length===0&&delete g.tweens[x],Object.keys(g.attrs[x]).length===0&&delete g.attrs[x])}}e.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(p){const x=p.onFinish;p.node=this,p.onFinish=function(){this.destroy(),x&&x()},new g(p).play()},e.Easings={BackEaseIn(p,x,v,w){return v*(p/=w)*p*((1.70158+1)*p-1.70158)+x},BackEaseOut(p,x,v,w){return v*((p=p/w-1)*p*((1.70158+1)*p+1.70158)+1)+x},BackEaseInOut(p,x,v,w){let C=1.70158;return(p/=w/2)<1?v/2*(p*p*(((C*=1.525)+1)*p-C))+x:v/2*((p-=2)*p*(((C*=1.525)+1)*p+C)+2)+x},ElasticEaseIn(p,x,v,w,C,k){let _=0;return p===0?x:(p/=w)===1?x+v:(k||(k=w*.3),!C||C<Math.abs(v)?(C=v,_=k/4):_=k/(2*Math.PI)*Math.asin(v/C),-(C*Math.pow(2,10*(p-=1))*Math.sin((p*w-_)*(2*Math.PI)/k))+x)},ElasticEaseOut(p,x,v,w,C,k){let _=0;return p===0?x:(p/=w)===1?x+v:(k||(k=w*.3),!C||C<Math.abs(v)?(C=v,_=k/4):_=k/(2*Math.PI)*Math.asin(v/C),C*Math.pow(2,-10*p)*Math.sin((p*w-_)*(2*Math.PI)/k)+v+x)},ElasticEaseInOut(p,x,v,w,C,k){let _=0;return p===0?x:(p/=w/2)===2?x+v:(k||(k=w*(.3*1.5)),!C||C<Math.abs(v)?(C=v,_=k/4):_=k/(2*Math.PI)*Math.asin(v/C),p<1?-.5*(C*Math.pow(2,10*(p-=1))*Math.sin((p*w-_)*(2*Math.PI)/k))+x:C*Math.pow(2,-10*(p-=1))*Math.sin((p*w-_)*(2*Math.PI)/k)*.5+v+x)},BounceEaseOut(p,x,v,w){return(p/=w)<1/2.75?v*(7.5625*p*p)+x:p<2/2.75?v*(7.5625*(p-=1.5/2.75)*p+.75)+x:p<2.5/2.75?v*(7.5625*(p-=2.25/2.75)*p+.9375)+x:v*(7.5625*(p-=2.625/2.75)*p+.984375)+x},BounceEaseIn(p,x,v,w){return v-e.Easings.BounceEaseOut(w-p,0,v,w)+x},BounceEaseInOut(p,x,v,w){return p<w/2?e.Easings.BounceEaseIn(p*2,0,v,w)*.5+x:e.Easings.BounceEaseOut(p*2-w,0,v,w)*.5+v*.5+x},EaseIn(p,x,v,w){return v*(p/=w)*p+x},EaseOut(p,x,v,w){return-v*(p/=w)*(p-2)+x},EaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p+x:-v/2*(--p*(p-2)-1)+x},StrongEaseIn(p,x,v,w){return v*(p/=w)*p*p*p*p+x},StrongEaseOut(p,x,v,w){return v*((p=p/w-1)*p*p*p*p+1)+x},StrongEaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p*p*p*p+x:v/2*((p-=2)*p*p*p*p+2)+x},Linear(p,x,v,w){return v*p/w+x}}})(QS)),QS}var D6;function RT(){return D6||(D6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=tn(),r=zs(),n=ta(),s=Wb(),a=BJ(),i=wL(),o=$J(),c=r4(),u=t4(),d=qa(),f=n4(),g=UJ(),p=yL(),x=zb();e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:o.FastLayer,Group:c.Group,DD:u.DD,Shape:d.Shape,shapes:d.shapes,Animation:f.Animation,Tween:g.Tween,Easings:g.Easings,Context:p.Context,Canvas:x.Canvas}),e.default=e.Konva})(HS)),HS}var hx={},I6;function zJ(){if(I6)return hx;I6=1,Object.defineProperty(hx,"__esModule",{value:!0}),hx.Arc=void 0;const e=on(),t=qa(),r=tn(),n=cn(),s=tn();class a extends t.Shape{_sceneFunc(o){const c=r.Konva.getAngle(this.angle()),u=this.clockwise();o.beginPath(),o.arc(0,0,this.outerRadius(),0,c,u),o.arc(0,0,this.innerRadius(),c,0,!u),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}getSelfRect(){const o=this.innerRadius(),c=this.outerRadius(),u=this.clockwise(),d=r.Konva.getAngle(u?360-this.angle():this.angle()),f=Math.cos(Math.min(d,Math.PI)),g=1,p=Math.sin(Math.min(Math.max(Math.PI,d),3*Math.PI/2)),x=Math.sin(Math.min(d,Math.PI/2)),v=f*(f>0?o:c),w=g*c,C=p*(p>0?o:c),k=x*(x>0?c:o);return{x:v,y:u?-1*k:C,width:w-v,height:k-C}}}return hx.Arc=a,a.prototype._centroid=!0,a.prototype.className="Arc",a.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1,(0,n.getBooleanValidator)()),hx}var gx={},mx={},R6;function _L(){if(R6)return mx;R6=1,Object.defineProperty(mx,"__esModule",{value:!0}),mx.Line=void 0;const e=on(),t=tn(),r=qa(),n=cn();function s(o,c,u,d,f,g,p){const x=Math.sqrt(Math.pow(u-o,2)+Math.pow(d-c,2)),v=Math.sqrt(Math.pow(f-u,2)+Math.pow(g-d,2)),w=p*x/(x+v),C=p*v/(x+v),k=u-w*(f-o),_=d-w*(g-c),N=u+C*(f-o),E=d+C*(g-c);return[k,_,N,E]}function a(o,c){const u=o.length,d=[];for(let f=2;f<u-2;f+=2){const g=s(o[f-2],o[f-1],o[f],o[f+1],o[f+2],o[f+3],c);isNaN(g[0])||(d.push(g[0]),d.push(g[1]),d.push(o[f]),d.push(o[f+1]),d.push(g[2]),d.push(g[3]))}return d}class i extends r.Shape{constructor(c){super(c),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(c){const u=this.points(),d=u.length,f=this.tension(),g=this.closed(),p=this.bezier();if(!d)return;let x=0;if(c.beginPath(),c.moveTo(u[0],u[1]),f!==0&&d>4){const v=this.getTensionPoints(),w=v.length;for(x=g?0:4,g||c.quadraticCurveTo(v[0],v[1],v[2],v[3]);x<w-2;)c.bezierCurveTo(v[x++],v[x++],v[x++],v[x++],v[x++],v[x++]);g||c.quadraticCurveTo(v[w-2],v[w-1],u[d-2],u[d-1])}else if(p)for(x=2;x<d;)c.bezierCurveTo(u[x++],u[x++],u[x++],u[x++],u[x++],u[x++]);else for(x=2;x<d;x+=2)c.lineTo(u[x],u[x+1]);g?(c.closePath(),c.fillStrokeShape(this)):c.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():a(this.points(),this.tension())}_getTensionPointsClosed(){const c=this.points(),u=c.length,d=this.tension(),f=s(c[u-2],c[u-1],c[0],c[1],c[2],c[3],d),g=s(c[u-4],c[u-3],c[u-2],c[u-1],c[0],c[1],d),p=a(c,d);return[f[2],f[3]].concat(p).concat([g[0],g[1],c[u-2],c[u-1],g[2],g[3],f[0],f[1],c[0],c[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let c=this.points();if(c.length<4)return{x:c[0]||0,y:c[1]||0,width:0,height:0};this.tension()!==0?c=[c[0],c[1],...this._getTensionPoints(),c[c.length-2],c[c.length-1]]:c=this.points();let u=c[0],d=c[0],f=c[1],g=c[1],p,x;for(let v=0;v<c.length/2;v++)p=c[v*2],x=c[v*2+1],u=Math.min(u,p),d=Math.max(d,p),f=Math.min(f,x),g=Math.max(g,x);return{x:u,y:f,width:d-u,height:g-f}}}return mx.Line=i,i.prototype.className="Line",i.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(i),e.Factory.addGetterSetter(i,"closed",!1),e.Factory.addGetterSetter(i,"bezier",!1),e.Factory.addGetterSetter(i,"tension",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"points",[],(0,n.getNumberArrayValidator)()),mx}var px={},JS={},M6;function WJ(){return M6||(M6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(i,o,c)=>{let u,d;const g=c/2;u=0;for(let p=0;p<20;p++)d=g*e.tValues[20][p]+g,u+=e.cValues[20][p]*n(i,o,d);return g*u};e.getCubicArcLength=t;const r=(i,o,c)=>{c===void 0&&(c=1);const u=i[0]-2*i[1]+i[2],d=o[0]-2*o[1]+o[2],f=2*i[1]-2*i[0],g=2*o[1]-2*o[0],p=4*(u*u+d*d),x=4*(u*f+d*g),v=f*f+g*g;if(p===0)return c*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(o[2]-o[0],2));const w=x/(2*p),C=v/p,k=c+w,_=C-w*w,N=k*k+_>0?Math.sqrt(k*k+_):0,E=w*w+_>0?Math.sqrt(w*w+_):0,P=w+Math.sqrt(w*w+_)!==0?_*Math.log(Math.abs((k+N)/(w+E))):0;return Math.sqrt(p)/2*(k*N-w*E+P)};e.getQuadraticArcLength=r;function n(i,o,c){const u=s(1,c,i),d=s(1,c,o),f=u*u+d*d;return Math.sqrt(f)}const s=(i,o,c)=>{const u=c.length-1;let d,f;if(u===0)return 0;if(i===0){f=0;for(let g=0;g<=u;g++)f+=e.binomialCoefficients[u][g]*Math.pow(1-o,u-g)*Math.pow(o,g)*c[g];return f}else{d=new Array(u);for(let g=0;g<u;g++)d[g]=u*(c[g+1]-c[g]);return s(i-1,o,d)}},a=(i,o,c)=>{let u=1,d=i/o,f=(i-c(d))/o,g=0;for(;u>.001;){const p=c(d+f),x=Math.abs(i-p)/o;if(x<u)u=x,d+=f;else{const v=c(d-f),w=Math.abs(i-v)/o;w<u?(u=w,d-=f):f/=2}if(g++,g>500)break}return d};e.t2length=a})(JS)),JS}var L6;function s4(){if(L6)return px;L6=1,Object.defineProperty(px,"__esModule",{value:!0}),px.Path=void 0;const e=on(),t=tn(),r=qa(),n=WJ();class s extends r.Shape{constructor(i){super(i),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=s.parsePathData(this.data()),this.pathLength=s.getPathLength(this.dataArray)}_sceneFunc(i){const o=this.dataArray;i.beginPath();let c=!1;for(let u=0;u<o.length;u++){const d=o[u].command,f=o[u].points;switch(d){case"L":i.lineTo(f[0],f[1]);break;case"M":i.moveTo(f[0],f[1]);break;case"C":i.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":i.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":const g=f[0],p=f[1],x=f[2],v=f[3],w=f[4],C=f[5],k=f[6],_=f[7],N=x>v?x:v,E=x>v?1:x/v,P=x>v?v/x:1;i.translate(g,p),i.rotate(k),i.scale(E,P),i.arc(0,0,N,w,w+C,1-_),i.scale(1/E,1/P),i.rotate(-k),i.translate(-g,-p);break;case"z":c=!0,i.closePath();break}}!c&&!this.hasFill()?i.strokeShape(this):i.fillStrokeShape(this)}getSelfRect(){let i=[];this.dataArray.forEach(function(p){if(p.command==="A"){const x=p.points[4],v=p.points[5],w=p.points[4]+v;let C=Math.PI/180;if(Math.abs(x-w)<C&&(C=Math.abs(x-w)),v<0)for(let k=x-C;k>w;k-=C){const _=s.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],k,0);i.push(_.x,_.y)}else for(let k=x+C;k<w;k+=C){const _=s.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],k,0);i.push(_.x,_.y)}}else if(p.command==="C")for(let x=0;x<=1;x+=.01){const v=s.getPointOnCubicBezier(x,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3],p.points[4],p.points[5]);i.push(v.x,v.y)}else i=i.concat(p.points)});let o=i[0],c=i[0],u=i[1],d=i[1],f,g;for(let p=0;p<i.length/2;p++)f=i[p*2],g=i[p*2+1],isNaN(f)||(o=Math.min(o,f),c=Math.max(c,f)),isNaN(g)||(u=Math.min(u,g),d=Math.max(d,g));return{x:o,y:u,width:c-o,height:d-u}}getLength(){return this.pathLength}getPointAtLength(i){return s.getPointAtLengthOfDataArray(i,this.dataArray)}static getLineLength(i,o,c,u){return Math.sqrt((c-i)*(c-i)+(u-o)*(u-o))}static getPathLength(i){let o=0;for(let c=0;c<i.length;++c)o+=i[c].pathLength;return o}static getPointAtLengthOfDataArray(i,o){let c,u=0,d=o.length;if(!d)return null;for(;u<d&&i>o[u].pathLength;)i-=o[u].pathLength,++u;if(u===d)return c=o[u-1].points.slice(-2),{x:c[0],y:c[1]};if(i<.01)return o[u].command==="M"?(c=o[u].points.slice(0,2),{x:c[0],y:c[1]}):{x:o[u].start.x,y:o[u].start.y};const f=o[u],g=f.points;switch(f.command){case"L":return s.getPointOnLine(i,f.start.x,f.start.y,g[0],g[1]);case"C":return s.getPointOnCubicBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getCubicArcLength)([f.start.x,g[0],g[2],g[4]],[f.start.y,g[1],g[3],g[5]],N)),f.start.x,f.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return s.getPointOnQuadraticBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getQuadraticArcLength)([f.start.x,g[0],g[2]],[f.start.y,g[1],g[3]],N)),f.start.x,f.start.y,g[0],g[1],g[2],g[3]);case"A":const p=g[0],x=g[1],v=g[2],w=g[3],C=g[5],k=g[6];let _=g[4];return _+=C*i/f.pathLength,s.getPointOnEllipticalArc(p,x,v,w,_,k)}return null}static getPointOnLine(i,o,c,u,d,f,g){f=f??o,g=g??c;const p=this.getLineLength(o,c,u,d);if(p<1e-10)return{x:o,y:c};if(u===o)return{x:f,y:g+(d>c?i:-i)};const x=(d-c)/(u-o),v=Math.sqrt(i*i/(1+x*x))*(u<o?-1:1),w=x*v;if(Math.abs(g-c-x*(f-o))<1e-10)return{x:f+v,y:g+w};const C=((f-o)*(u-o)+(g-c)*(d-c))/(p*p),k=o+C*(u-o),_=c+C*(d-c),N=this.getLineLength(f,g,k,_),E=Math.sqrt(i*i-N*N),P=Math.sqrt(E*E/(1+x*x))*(u<o?-1:1),F=x*P;return{x:k+P,y:_+F}}static getPointOnCubicBezier(i,o,c,u,d,f,g,p,x){function v(E){return E*E*E}function w(E){return 3*E*E*(1-E)}function C(E){return 3*E*(1-E)*(1-E)}function k(E){return(1-E)*(1-E)*(1-E)}const _=p*v(i)+f*w(i)+u*C(i)+o*k(i),N=x*v(i)+g*w(i)+d*C(i)+c*k(i);return{x:_,y:N}}static getPointOnQuadraticBezier(i,o,c,u,d,f,g){function p(k){return k*k}function x(k){return 2*k*(1-k)}function v(k){return(1-k)*(1-k)}const w=f*p(i)+u*x(i)+o*v(i),C=g*p(i)+d*x(i)+c*v(i);return{x:w,y:C}}static getPointOnEllipticalArc(i,o,c,u,d,f){const g=Math.cos(f),p=Math.sin(f),x={x:c*Math.cos(d),y:u*Math.sin(d)};return{x:i+(x.x*g-x.y*p),y:o+(x.x*p+x.y*g)}}static parsePathData(i){if(!i)return[];let o=i;const c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];o=o.replace(new RegExp(" ","g"),",");for(let w=0;w<c.length;w++)o=o.replace(new RegExp(c[w],"g"),"|"+c[w]);const u=o.split("|"),d=[],f=[];let g=0,p=0;const x=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let v;for(let w=1;w<u.length;w++){let C=u[w],k=C.charAt(0);for(C=C.slice(1),f.length=0;v=x.exec(C);)f.push(v[0]);const _=[];for(let N=0,E=f.length;N<E;N++){if(f[N]==="00"){_.push(0,0);continue}const P=parseFloat(f[N]);isNaN(P)?_.push(0):_.push(P)}for(;_.length>0&&!isNaN(_[0]);){let N="",E=[];const P=g,F=p;let A,j,I,B,Y,Z,se,ee,te,L;switch(k){case"l":g+=_.shift(),p+=_.shift(),N="L",E.push(g,p);break;case"L":g=_.shift(),p=_.shift(),E.push(g,p);break;case"m":const V=_.shift(),M=_.shift();if(g+=V,p+=M,N="M",d.length>2&&d[d.length-1].command==="z"){for(let H=d.length-2;H>=0;H--)if(d[H].command==="M"){g=d[H].points[0]+V,p=d[H].points[1]+M;break}}E.push(g,p),k="l";break;case"M":g=_.shift(),p=_.shift(),N="M",E.push(g,p),k="L";break;case"h":g+=_.shift(),N="L",E.push(g,p);break;case"H":g=_.shift(),N="L",E.push(g,p);break;case"v":p+=_.shift(),N="L",E.push(g,p);break;case"V":p=_.shift(),N="L",E.push(g,p);break;case"C":E.push(_.shift(),_.shift(),_.shift(),_.shift()),g=_.shift(),p=_.shift(),E.push(g,p);break;case"c":E.push(g+_.shift(),p+_.shift(),g+_.shift(),p+_.shift()),g+=_.shift(),p+=_.shift(),N="C",E.push(g,p);break;case"S":j=g,I=p,A=d[d.length-1],A.command==="C"&&(j=g+(g-A.points[2]),I=p+(p-A.points[3])),E.push(j,I,_.shift(),_.shift()),g=_.shift(),p=_.shift(),N="C",E.push(g,p);break;case"s":j=g,I=p,A=d[d.length-1],A.command==="C"&&(j=g+(g-A.points[2]),I=p+(p-A.points[3])),E.push(j,I,g+_.shift(),p+_.shift()),g+=_.shift(),p+=_.shift(),N="C",E.push(g,p);break;case"Q":E.push(_.shift(),_.shift()),g=_.shift(),p=_.shift(),E.push(g,p);break;case"q":E.push(g+_.shift(),p+_.shift()),g+=_.shift(),p+=_.shift(),N="Q",E.push(g,p);break;case"T":j=g,I=p,A=d[d.length-1],A.command==="Q"&&(j=g+(g-A.points[0]),I=p+(p-A.points[1])),g=_.shift(),p=_.shift(),N="Q",E.push(j,I,g,p);break;case"t":j=g,I=p,A=d[d.length-1],A.command==="Q"&&(j=g+(g-A.points[0]),I=p+(p-A.points[1])),g+=_.shift(),p+=_.shift(),N="Q",E.push(j,I,g,p);break;case"A":B=_.shift(),Y=_.shift(),Z=_.shift(),se=_.shift(),ee=_.shift(),te=g,L=p,g=_.shift(),p=_.shift(),N="A",E=this.convertEndpointToCenterParameterization(te,L,g,p,se,ee,B,Y,Z);break;case"a":B=_.shift(),Y=_.shift(),Z=_.shift(),se=_.shift(),ee=_.shift(),te=g,L=p,g+=_.shift(),p+=_.shift(),N="A",E=this.convertEndpointToCenterParameterization(te,L,g,p,se,ee,B,Y,Z);break}d.push({command:N||k,points:E,start:{x:P,y:F},pathLength:this.calcLength(P,F,N||k,E)})}(k==="z"||k==="Z")&&d.push({command:"z",points:[],start:void 0,pathLength:0})}return d}static calcLength(i,o,c,u){let d,f,g,p;const x=s;switch(c){case"L":return x.getLineLength(i,o,u[0],u[1]);case"C":return(0,n.getCubicArcLength)([i,u[0],u[2],u[4]],[o,u[1],u[3],u[5]],1);case"Q":return(0,n.getQuadraticArcLength)([i,u[0],u[2]],[o,u[1],u[3]],1);case"A":d=0;const v=u[4],w=u[5],C=u[4]+w;let k=Math.PI/180;if(Math.abs(v-C)<k&&(k=Math.abs(v-C)),f=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],v,0),w<0)for(p=v-k;p>C;p-=k)g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],p,0),d+=x.getLineLength(f.x,f.y,g.x,g.y),f=g;else for(p=v+k;p<C;p+=k)g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],p,0),d+=x.getLineLength(f.x,f.y,g.x,g.y),f=g;return g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],C,0),d+=x.getLineLength(f.x,f.y,g.x,g.y),d}return 0}static convertEndpointToCenterParameterization(i,o,c,u,d,f,g,p,x){const v=x*(Math.PI/180),w=Math.cos(v)*(i-c)/2+Math.sin(v)*(o-u)/2,C=-1*Math.sin(v)*(i-c)/2+Math.cos(v)*(o-u)/2,k=w*w/(g*g)+C*C/(p*p);k>1&&(g*=Math.sqrt(k),p*=Math.sqrt(k));let _=Math.sqrt((g*g*(p*p)-g*g*(C*C)-p*p*(w*w))/(g*g*(C*C)+p*p*(w*w)));d===f&&(_*=-1),isNaN(_)&&(_=0);const N=_*g*C/p,E=_*-p*w/g,P=(i+c)/2+Math.cos(v)*N-Math.sin(v)*E,F=(o+u)/2+Math.sin(v)*N+Math.cos(v)*E,A=function(ee){return Math.sqrt(ee[0]*ee[0]+ee[1]*ee[1])},j=function(ee,te){return(ee[0]*te[0]+ee[1]*te[1])/(A(ee)*A(te))},I=function(ee,te){return(ee[0]*te[1]<ee[1]*te[0]?-1:1)*Math.acos(j(ee,te))},B=I([1,0],[(w-N)/g,(C-E)/p]),Y=[(w-N)/g,(C-E)/p],Z=[(-1*w-N)/g,(-1*C-E)/p];let se=I(Y,Z);return j(Y,Z)<=-1&&(se=Math.PI),j(Y,Z)>=1&&(se=0),f===0&&se>0&&(se=se-2*Math.PI),f===1&&se<0&&(se=se+2*Math.PI),[P,F,g,p,B,se,v,f]}}return px.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,t._registerNode)(s),e.Factory.addGetterSetter(s,"data"),px}var B6;function HJ(){if(B6)return gx;B6=1,Object.defineProperty(gx,"__esModule",{value:!0}),gx.Arrow=void 0;const e=on(),t=_L(),r=cn(),n=tn(),s=s4();class a extends t.Line{_sceneFunc(o){super._sceneFunc(o);const c=Math.PI*2,u=this.points();let d=u;const f=this.tension()!==0&&u.length>4;f&&(d=this.getTensionPoints());const g=this.pointerLength(),p=u.length;let x,v;if(f){const k=[d[d.length-4],d[d.length-3],d[d.length-2],d[d.length-1],u[p-2],u[p-1]],_=s.Path.calcLength(d[d.length-4],d[d.length-3],"C",k),N=s.Path.getPointOnQuadraticBezier(Math.min(1,1-g/_),k[0],k[1],k[2],k[3],k[4],k[5]);x=u[p-2]-N.x,v=u[p-1]-N.y}else x=u[p-2]-u[p-4],v=u[p-1]-u[p-3];const w=(Math.atan2(v,x)+c)%c,C=this.pointerWidth();this.pointerAtEnding()&&(o.save(),o.beginPath(),o.translate(u[p-2],u[p-1]),o.rotate(w),o.moveTo(0,0),o.lineTo(-g,C/2),o.lineTo(-g,-C/2),o.closePath(),o.restore(),this.__fillStroke(o)),this.pointerAtBeginning()&&(o.save(),o.beginPath(),o.translate(u[0],u[1]),f?(x=(d[0]+d[2])/2-u[0],v=(d[1]+d[3])/2-u[1]):(x=u[2]-u[0],v=u[3]-u[1]),o.rotate((Math.atan2(-v,-x)+c)%c),o.moveTo(0,0),o.lineTo(-g,C/2),o.lineTo(-g,-C/2),o.closePath(),o.restore(),this.__fillStroke(o))}__fillStroke(o){const c=this.dashEnabled();c&&(this.attrs.dashEnabled=!1,o.setLineDash([])),o.fillStrokeShape(this),c&&(this.attrs.dashEnabled=!0)}getSelfRect(){const o=super.getSelfRect(),c=this.pointerWidth()/2;return{x:o.x,y:o.y-c,width:o.width,height:o.height+c*2}}}return gx.Arrow=a,a.prototype.className="Arrow",(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"pointerLength",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerWidth",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerAtBeginning",!1),e.Factory.addGetterSetter(a,"pointerAtEnding",!0),gx}var xx={},$6;function GJ(){if($6)return xx;$6=1,Object.defineProperty(xx,"__esModule",{value:!0}),xx.Circle=void 0;const e=on(),t=qa(),r=cn(),n=tn();class s extends t.Shape{_sceneFunc(i){i.beginPath(),i.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius()!==i/2&&this.radius(i/2)}setHeight(i){this.radius()!==i/2&&this.radius(i/2)}}return xx.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),xx}var yx={},U6;function VJ(){if(U6)return yx;U6=1,Object.defineProperty(yx,"__esModule",{value:!0}),yx.Ellipse=void 0;const e=on(),t=qa(),r=cn(),n=tn();class s extends t.Shape{_sceneFunc(i){const o=this.radiusX(),c=this.radiusY();i.beginPath(),i.save(),o!==c&&i.scale(1,c/o),i.arc(0,0,o,0,Math.PI*2,!1),i.restore(),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(i){this.radiusX(i/2)}setHeight(i){this.radiusY(i/2)}}return yx.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(s),e.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),e.Factory.addGetterSetter(s,"radiusX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"radiusY",0,(0,r.getNumberValidator)()),yx}var vx={},z6;function KJ(){if(z6)return vx;z6=1,Object.defineProperty(vx,"__esModule",{value:!0}),vx.Image=void 0;const e=zs(),t=on(),r=qa(),n=tn(),s=cn();class a extends r.Shape{constructor(o){super(o),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",c=>{this._removeImageLoad(c.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const o=this.image();o&&o.complete||o&&o.readyState===4||o&&o.addEventListener&&o.addEventListener("load",this._loadListener)}_removeImageLoad(o){o&&o.removeEventListener&&o.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const o=!!this.cornerRadius(),c=this.hasShadow();return o&&c?!0:super._useBufferCanvas(!0)}_sceneFunc(o){const c=this.getWidth(),u=this.getHeight(),d=this.cornerRadius(),f=this.attrs.image;let g;if(f){const p=this.attrs.cropWidth,x=this.attrs.cropHeight;p&&x?g=[f,this.cropX(),this.cropY(),p,x,0,0,c,u]:g=[f,0,0,c,u]}(this.hasFill()||this.hasStroke()||d)&&(o.beginPath(),d?e.Util.drawRoundedRectPath(o,c,u,d):o.rect(0,0,c,u),o.closePath(),o.fillStrokeShape(this)),f&&(d&&o.clip(),o.drawImage.apply(o,g))}_hitFunc(o){const c=this.width(),u=this.height(),d=this.cornerRadius();o.beginPath(),d?e.Util.drawRoundedRectPath(o,c,u,d):o.rect(0,0,c,u),o.closePath(),o.fillStrokeShape(this)}getWidth(){var o,c;return(o=this.attrs.width)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.width}getHeight(){var o,c;return(o=this.attrs.height)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.height}static fromURL(o,c,u=null){const d=e.Util.createImageElement();d.onload=function(){const f=new a({image:d});c(f)},d.onerror=u,d.crossOrigin="Anonymous",d.src=o}}return vx.Image=a,a.prototype.className="Image",(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(a,"image"),t.Factory.addComponentsGetterSetter(a,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(a,"cropX",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropY",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropWidth",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropHeight",0,(0,s.getNumberValidator)()),vx}var kh={},W6;function qJ(){if(W6)return kh;W6=1,Object.defineProperty(kh,"__esModule",{value:!0}),kh.Tag=kh.Label=void 0;const e=on(),t=qa(),r=r4(),n=cn(),s=tn(),a=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],i="Change.konva",o="none",c="up",u="right",d="down",f="left",g=a.length;class p extends r.Group{constructor(w){super(w),this.on("add.konva",function(C){this._addListeners(C.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(w){let C=this,k;const _=function(){C._sync()};for(k=0;k<g;k++)w.on(a[k]+i,_)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let w=this.getText(),C=this.getTag(),k,_,N,E,P,F,A;if(w&&C){switch(k=w.width(),_=w.height(),N=C.pointerDirection(),E=C.pointerWidth(),A=C.pointerHeight(),P=0,F=0,N){case c:P=k/2,F=-1*A;break;case u:P=k+E,F=_/2;break;case d:P=k/2,F=_+A;break;case f:P=-1*E,F=_/2;break}C.setAttrs({x:-1*P,y:-1*F,width:k,height:_}),w.setAttrs({x:-1*P,y:-1*F})}}}kh.Label=p,p.prototype.className="Label",(0,s._registerNode)(p);class x extends t.Shape{_sceneFunc(w){const C=this.width(),k=this.height(),_=this.pointerDirection(),N=this.pointerWidth(),E=this.pointerHeight(),P=this.cornerRadius();let F=0,A=0,j=0,I=0;typeof P=="number"?F=A=j=I=Math.min(P,C/2,k/2):(F=Math.min(P[0]||0,C/2,k/2),A=Math.min(P[1]||0,C/2,k/2),I=Math.min(P[2]||0,C/2,k/2),j=Math.min(P[3]||0,C/2,k/2)),w.beginPath(),w.moveTo(F,0),_===c&&(w.lineTo((C-N)/2,0),w.lineTo(C/2,-1*E),w.lineTo((C+N)/2,0)),w.lineTo(C-A,0),w.arc(C-A,A,A,Math.PI*3/2,0,!1),_===u&&(w.lineTo(C,(k-E)/2),w.lineTo(C+N,k/2),w.lineTo(C,(k+E)/2)),w.lineTo(C,k-I),w.arc(C-I,k-I,I,0,Math.PI/2,!1),_===d&&(w.lineTo((C+N)/2,k),w.lineTo(C/2,k+E),w.lineTo((C-N)/2,k)),w.lineTo(j,k),w.arc(j,k-j,j,Math.PI/2,Math.PI,!1),_===f&&(w.lineTo(0,(k+E)/2),w.lineTo(-1*N,k/2),w.lineTo(0,(k-E)/2)),w.lineTo(0,F),w.arc(F,F,F,Math.PI,Math.PI*3/2,!1),w.closePath(),w.fillStrokeShape(this)}getSelfRect(){let w=0,C=0,k=this.pointerWidth(),_=this.pointerHeight(),N=this.pointerDirection(),E=this.width(),P=this.height();return N===c?(C-=_,P+=_):N===d?P+=_:N===f?(w-=k*1.5,E+=k):N===u&&(E+=k*1.5),{x:w,y:C,width:E,height:P}}}return kh.Tag=x,x.prototype.className="Tag",(0,s._registerNode)(x),e.Factory.addGetterSetter(x,"pointerDirection",o),e.Factory.addGetterSetter(x,"pointerWidth",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(x,"pointerHeight",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(x,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),kh}var wx={},H6;function bL(){if(H6)return wx;H6=1,Object.defineProperty(wx,"__esModule",{value:!0}),wx.Rect=void 0;const e=on(),t=qa(),r=tn(),n=zs(),s=cn();class a extends t.Shape{_sceneFunc(o){const c=this.cornerRadius(),u=this.width(),d=this.height();o.beginPath(),c?n.Util.drawRoundedRectPath(o,u,d,c):o.rect(0,0,u,d),o.closePath(),o.fillStrokeShape(this)}}return wx.Rect=a,a.prototype.className="Rect",(0,r._registerNode)(a),e.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),wx}var _x={},G6;function YJ(){if(G6)return _x;G6=1,Object.defineProperty(_x,"__esModule",{value:!0}),_x.RegularPolygon=void 0;const e=on(),t=qa(),r=cn(),n=tn();class s extends t.Shape{_sceneFunc(i){const o=this._getPoints();i.beginPath(),i.moveTo(o[0].x,o[0].y);for(let c=1;c<o.length;c++)i.lineTo(o[c].x,o[c].y);i.closePath(),i.fillStrokeShape(this)}_getPoints(){const i=this.attrs.sides,o=this.attrs.radius||0,c=[];for(let u=0;u<i;u++)c.push({x:o*Math.sin(u*2*Math.PI/i),y:-1*o*Math.cos(u*2*Math.PI/i)});return c}getSelfRect(){const i=this._getPoints();let o=i[0].x,c=i[0].y,u=i[0].x,d=i[0].y;return i.forEach(f=>{o=Math.min(o,f.x),c=Math.max(c,f.x),u=Math.min(u,f.y),d=Math.max(d,f.y)}),{x:o,y:u,width:c-o,height:d-u}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius(i/2)}setHeight(i){this.radius(i/2)}}return _x.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"sides",0,(0,r.getNumberValidator)()),_x}var bx={},V6;function XJ(){if(V6)return bx;V6=1,Object.defineProperty(bx,"__esModule",{value:!0}),bx.Ring=void 0;const e=on(),t=qa(),r=cn(),n=tn(),s=Math.PI*2;class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.innerRadius(),0,s,!1),o.moveTo(this.outerRadius(),0),o.arc(0,0,this.outerRadius(),s,0,!0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}}return bx.Ring=a,a.prototype.className="Ring",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,r.getNumberValidator)()),bx}var Sx={},K6;function QJ(){if(K6)return Sx;K6=1,Object.defineProperty(Sx,"__esModule",{value:!0}),Sx.Sprite=void 0;const e=on(),t=qa(),r=n4(),n=cn(),s=tn();class a extends t.Shape{constructor(o){super(o),this._updated=!0,this.anim=new r.Animation(()=>{const c=this._updated;return this._updated=!1,c}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(o){const c=this.animation(),u=this.frameIndex(),d=u*4,f=this.animations()[c],g=this.frameOffsets(),p=f[d+0],x=f[d+1],v=f[d+2],w=f[d+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(o.beginPath(),o.rect(0,0,v,w),o.closePath(),o.fillStrokeShape(this)),C)if(g){const k=g[c],_=u*2;o.drawImage(C,p,x,v,w,k[_+0],k[_+1],v,w)}else o.drawImage(C,p,x,v,w,0,0,v,w)}_hitFunc(o){const c=this.animation(),u=this.frameIndex(),d=u*4,f=this.animations()[c],g=this.frameOffsets(),p=f[d+2],x=f[d+3];if(o.beginPath(),g){const v=g[c],w=u*2;o.rect(v[w+0],v[w+1],p,x)}else o.rect(0,0,p,x);o.closePath(),o.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const o=this;this.interval=setInterval(function(){o._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const o=this.getLayer();this.anim.setLayers(o),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const o=this.frameIndex(),c=this.animation(),u=this.animations(),d=u[c],f=d.length/4;o<f-1?this.frameIndex(o+1):this.frameIndex(0)}}return Sx.Sprite=a,a.prototype.className="Sprite",(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"animation"),e.Factory.addGetterSetter(a,"animations"),e.Factory.addGetterSetter(a,"frameOffsets"),e.Factory.addGetterSetter(a,"image"),e.Factory.addGetterSetter(a,"frameIndex",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"frameRate",17,(0,n.getNumberValidator)()),e.Factory.backCompat(a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Sx}var kx={},q6;function JJ(){if(q6)return kx;q6=1,Object.defineProperty(kx,"__esModule",{value:!0}),kx.Star=void 0;const e=on(),t=qa(),r=cn(),n=tn();class s extends t.Shape{_sceneFunc(i){const o=this.innerRadius(),c=this.outerRadius(),u=this.numPoints();i.beginPath(),i.moveTo(0,0-c);for(let d=1;d<u*2;d++){const f=d%2===0?c:o,g=f*Math.sin(d*Math.PI/u),p=-1*f*Math.cos(d*Math.PI/u);i.lineTo(g,p)}i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(i){this.outerRadius(i/2)}setHeight(i){this.outerRadius(i/2)}}return kx.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"numPoints",5,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"outerRadius",0,(0,r.getNumberValidator)()),kx}var Dg={},Y6;function SL(){if(Y6)return Dg;Y6=1,Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.Text=void 0,Dg.stringToArray=i;const e=zs(),t=on(),r=qa(),n=tn(),s=cn(),a=tn();function i(R){return[...R].reduce((z,K,Q,ae)=>{if(new RegExp("\\p{Emoji}","u").test(K)){const X=ae[Q+1];X&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(X)?(z.push(K+X),ae[Q+1]=""):z.push(K)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(K+(ae[Q+1]||""))?z.push(K+ae[Q+1]):Q>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(K)?z[z.length-1]+=K:K&&z.push(K);return z},[])}const o="auto",c="center",u="inherit",d="justify",f="Change.konva",g="2d",p="-",x="left",v="text",w="Text",C="top",k="bottom",_="middle",N="normal",E="px ",P=" ",F="right",A="rtl",j="word",I="char",B="none",Y="",Z=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],se=Z.length;function ee(R){return R.split(",").map(z=>{z=z.trim();const K=z.indexOf(" ")>=0,Q=z.indexOf('"')>=0||z.indexOf("'")>=0;return K&&!Q&&(z=`"${z}"`),z}).join(", ")}let te;function L(){return te||(te=e.Util.createCanvasElement().getContext(g),te)}function V(R){R.fillText(this._partialText,this._partialTextX,this._partialTextY)}function M(R){R.setAttr("miterLimit",2),R.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function H(R){return R=R||{},!R.fillLinearGradientColorStops&&!R.fillRadialGradientColorStops&&!R.fillPatternImage&&(R.fill=R.fill||"black"),R}class W extends r.Shape{constructor(z){super(H(z)),this._partialTextX=0,this._partialTextY=0;for(let K=0;K<se;K++)this.on(Z[K]+f,this._setTextData);this._setTextData()}_sceneFunc(z){const K=this.textArr,Q=K.length;if(!this.text())return;let ae=this.padding(),X=this.fontSize(),ie=this.lineHeight()*X,le=this.verticalAlign(),ce=this.direction(),_e=0,ne=this.align(),pe=this.getWidth(),Ce=this.letterSpacing(),Ae=this.fill(),Ge=this.textDecoration(),Le=Ge.indexOf("underline")!==-1,At=Ge.indexOf("line-through")!==-1,et;ce=ce===u?z.direction:ce;let pt=ie/2,lt=_;if(n.Konva._fixTextRendering){const rt=this.measureSize("M");lt="alphabetic",pt=(rt.fontBoundingBoxAscent-rt.fontBoundingBoxDescent)/2+ie/2}for(ce===A&&z.setAttr("direction",ce),z.setAttr("font",this._getContextFont()),z.setAttr("textBaseline",lt),z.setAttr("textAlign",x),le===_?_e=(this.getHeight()-Q*ie-ae*2)/2:le===k&&(_e=this.getHeight()-Q*ie-ae*2),z.translate(ae,_e+ae),et=0;et<Q;et++){let rt=0,ht=0;const Lt=K[et],zt=Lt.text,Dt=Lt.width,De=Lt.lastInParagraph;if(z.save(),ne===F?rt+=pe-Dt-ae*2:ne===c&&(rt+=(pe-Dt-ae*2)/2),Le){z.save(),z.beginPath();const Ie=n.Konva._fixTextRendering?Math.round(X/4):Math.round(X/2),Ke=rt,Je=pt+ht+Ie;z.moveTo(Ke,Je);const Ye=ne===d&&!De?pe-ae*2:Dt;z.lineTo(Ke+Math.round(Ye),Je),z.lineWidth=X/15;const Tt=this._getLinearGradient();z.strokeStyle=Tt||Ae,z.stroke(),z.restore()}if(At){z.save(),z.beginPath();const Ie=n.Konva._fixTextRendering?-Math.round(X/4):0;z.moveTo(rt,pt+ht+Ie);const Ke=ne===d&&!De?pe-ae*2:Dt;z.lineTo(rt+Math.round(Ke),pt+ht+Ie),z.lineWidth=X/15;const Je=this._getLinearGradient();z.strokeStyle=Je||Ae,z.stroke(),z.restore()}if(ce!==A&&(Ce!==0||ne===d)){const Ie=zt.split(" ").length-1,Ke=i(zt);for(let Je=0;Je<Ke.length;Je++){const Ye=Ke[Je];Ye===" "&&!De&&ne===d&&(rt+=(pe-ae*2-Dt)/Ie),this._partialTextX=rt,this._partialTextY=pt+ht,this._partialText=Ye,z.fillStrokeShape(this),rt+=this.measureSize(Ye).width+Ce}}else Ce!==0&&z.setAttr("letterSpacing",`${Ce}px`),this._partialTextX=rt,this._partialTextY=pt+ht,this._partialText=zt,z.fillStrokeShape(this);z.restore(),Q>1&&(pt+=ie)}}_hitFunc(z){const K=this.getWidth(),Q=this.getHeight();z.beginPath(),z.rect(0,0,K,Q),z.closePath(),z.fillStrokeShape(this)}setText(z){const K=e.Util._isString(z)?z:z==null?"":z+"";return this._setAttr(v,K),this}getWidth(){return this.attrs.width===o||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===o||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(z){var K,Q,ae,X,ie,le,ce,_e,ne,pe,Ce;let Ae=L(),Ge=this.fontSize(),Le;Ae.save(),Ae.font=this._getContextFont(),Le=Ae.measureText(z),Ae.restore();const At=Ge/100;return{actualBoundingBoxAscent:(K=Le.actualBoundingBoxAscent)!==null&&K!==void 0?K:71.58203125*At,actualBoundingBoxDescent:(Q=Le.actualBoundingBoxDescent)!==null&&Q!==void 0?Q:0,actualBoundingBoxLeft:(ae=Le.actualBoundingBoxLeft)!==null&&ae!==void 0?ae:-7.421875*At,actualBoundingBoxRight:(X=Le.actualBoundingBoxRight)!==null&&X!==void 0?X:75.732421875*At,alphabeticBaseline:(ie=Le.alphabeticBaseline)!==null&&ie!==void 0?ie:0,emHeightAscent:(le=Le.emHeightAscent)!==null&&le!==void 0?le:100*At,emHeightDescent:(ce=Le.emHeightDescent)!==null&&ce!==void 0?ce:-20*At,fontBoundingBoxAscent:(_e=Le.fontBoundingBoxAscent)!==null&&_e!==void 0?_e:91*At,fontBoundingBoxDescent:(ne=Le.fontBoundingBoxDescent)!==null&&ne!==void 0?ne:21*At,hangingBaseline:(pe=Le.hangingBaseline)!==null&&pe!==void 0?pe:72.80000305175781*At,ideographicBaseline:(Ce=Le.ideographicBaseline)!==null&&Ce!==void 0?Ce:-21*At,width:Le.width,height:Ge}}_getContextFont(){return this.fontStyle()+P+this.fontVariant()+P+(this.fontSize()+E)+ee(this.fontFamily())}_addTextLine(z){this.align()===d&&(z=z.trim());const Q=this._getTextWidth(z);return this.textArr.push({text:z,width:Q,lastInParagraph:!1})}_getTextWidth(z){const K=this.letterSpacing(),Q=z.length;return L().measureText(z).width+K*Q}_setTextData(){let z=this.text().split(`
`),K=+this.fontSize(),Q=0,ae=this.lineHeight()*K,X=this.attrs.width,ie=this.attrs.height,le=X!==o&&X!==void 0,ce=ie!==o&&ie!==void 0,_e=this.padding(),ne=X-_e*2,pe=ie-_e*2,Ce=0,Ae=this.wrap(),Ge=Ae!==B,Le=Ae!==I&&Ge,At=this.ellipsis();this.textArr=[],L().font=this._getContextFont();const et=At?this._getTextWidth(Y):0;for(let pt=0,lt=z.length;pt<lt;++pt){let rt=z[pt],ht=this._getTextWidth(rt);if(le&&ht>ne)for(;rt.length>0;){let Lt=0,zt=i(rt).length,Dt="",De=0;for(;Lt<zt;){const Ie=Lt+zt>>>1,Ke=i(rt),Je=Ke.slice(0,Ie+1).join(""),Ye=this._getTextWidth(Je);(At&&ce&&Ce+ae>pe?Ye+et:Ye)<=ne?(Lt=Ie+1,Dt=Je,De=Ye):zt=Ie}if(Dt){if(Le){const Je=i(rt),Ye=i(Dt),Tt=Je[Ye.length],Nt=Tt===P||Tt===p;let Wt;if(Nt&&De<=ne)Wt=Ye.length;else{const or=Ye.lastIndexOf(P),dr=Ye.lastIndexOf(p);Wt=Math.max(or,dr)+1}Wt>0&&(Lt=Wt,Dt=Je.slice(0,Lt).join(""),De=this._getTextWidth(Dt))}if(Dt=Dt.trimRight(),this._addTextLine(Dt),Q=Math.max(Q,De),Ce+=ae,this._shouldHandleEllipsis(Ce)){this._tryToAddEllipsisToLastLine();break}if(rt=i(rt).slice(Lt).join("").trimLeft(),rt.length>0&&(ht=this._getTextWidth(rt),ht<=ne)){this._addTextLine(rt),Ce+=ae,Q=Math.max(Q,ht);break}}else break}else this._addTextLine(rt),Ce+=ae,Q=Math.max(Q,ht),this._shouldHandleEllipsis(Ce)&&pt<lt-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),ce&&Ce+ae>pe)break}this.textHeight=K,this.textWidth=Q}_shouldHandleEllipsis(z){const K=+this.fontSize(),Q=this.lineHeight()*K,ae=this.attrs.height,X=ae!==o&&ae!==void 0,ie=this.padding(),le=ae-ie*2;return!(this.wrap()!==B)||X&&z+Q>le}_tryToAddEllipsisToLastLine(){const z=this.attrs.width,K=z!==o&&z!==void 0,Q=this.padding(),ae=z-Q*2,X=this.ellipsis(),ie=this.textArr[this.textArr.length-1];!ie||!X||(K&&(this._getTextWidth(ie.text+Y)<ae||(ie.text=ie.text.slice(0,ie.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(ie.text+Y))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const z=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,K=this.hasShadow();return z&&K?!0:super._useBufferCanvas()}}return Dg.Text=W,W.prototype._fillFunc=V,W.prototype._strokeFunc=M,W.prototype.className=w,W.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,a._registerNode)(W),t.Factory.overWriteSetter(W,"width",(0,s.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(W,"height",(0,s.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(W,"direction",u),t.Factory.addGetterSetter(W,"fontFamily","Arial"),t.Factory.addGetterSetter(W,"fontSize",12,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"fontStyle",N),t.Factory.addGetterSetter(W,"fontVariant",N),t.Factory.addGetterSetter(W,"padding",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"align",x),t.Factory.addGetterSetter(W,"verticalAlign",C),t.Factory.addGetterSetter(W,"lineHeight",1,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"wrap",j),t.Factory.addGetterSetter(W,"ellipsis",!1,(0,s.getBooleanValidator)()),t.Factory.addGetterSetter(W,"letterSpacing",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"text","",(0,s.getStringValidator)()),t.Factory.addGetterSetter(W,"textDecoration",""),Dg}var Cx={},X6;function ZJ(){if(X6)return Cx;X6=1,Object.defineProperty(Cx,"__esModule",{value:!0}),Cx.TextPath=void 0;const e=zs(),t=on(),r=qa(),n=s4(),s=SL(),a=cn(),i=tn(),o="",c="normal";function u(g){g.fillText(this.partialText,0,0)}function d(g){g.strokeText(this.partialText,0,0)}class f extends r.Shape{constructor(p){super(p),this.dummyCanvas=e.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(p){if(!this.attrs.data)return null;const x=this.pathLength;return p-1>x?null:n.Path.getPointAtLengthOfDataArray(p,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(p){p.setAttr("font",this._getContextFont()),p.setAttr("textBaseline",this.textBaseline()),p.setAttr("textAlign","left"),p.save();const x=this.textDecoration(),v=this.fill(),w=this.fontSize(),C=this.glyphInfo;x==="underline"&&p.beginPath();for(let k=0;k<C.length;k++){p.save();const _=C[k].p0;p.translate(_.x,_.y),p.rotate(C[k].rotation),this.partialText=C[k].text,p.fillStrokeShape(this),x==="underline"&&(k===0&&p.moveTo(0,w/2+1),p.lineTo(w,w/2+1)),p.restore()}x==="underline"&&(p.strokeStyle=v,p.lineWidth=w/20,p.stroke()),p.restore()}_hitFunc(p){p.beginPath();const x=this.glyphInfo;if(x.length>=1){const v=x[0].p0;p.moveTo(v.x,v.y)}for(let v=0;v<x.length;v++){const w=x[v].p1;p.lineTo(w.x,w.y)}p.setAttr("lineWidth",this.fontSize()),p.setAttr("strokeStyle",this.colorKey),p.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(p){return s.Text.prototype.setText.call(this,p)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(p){const v=this.dummyCanvas.getContext("2d");v.save(),v.font=this._getContextFont();const w=v.measureText(p);return v.restore(),{width:w.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:p,height:x}=this._getTextSize(this.attrs.text);if(this.textWidth=p,this.textHeight=x,this.glyphInfo=[],!this.attrs.data)return null;const v=this.letterSpacing(),w=this.align(),C=this.kerningFunc(),k=Math.max(this.textWidth+((this.attrs.text||"").length-1)*v,0);let _=0;w==="center"&&(_=Math.max(0,this.pathLength/2-k/2)),w==="right"&&(_=Math.max(0,this.pathLength-k));const N=(0,s.stringToArray)(this.text());let E=_;for(let P=0;P<N.length;P++){const F=this._getPointAtLength(E);if(!F)return;let A=this._getTextSize(N[P]).width+v;if(N[P]===" "&&w==="justify"){const se=this.text().split(" ").length-1;A+=(this.pathLength-k)/se}const j=this._getPointAtLength(E+A);if(!j)return;const I=n.Path.getLineLength(F.x,F.y,j.x,j.y);let B=0;if(C)try{B=C(N[P-1],N[P])*this.fontSize()}catch{B=0}F.x+=B,j.x+=B,this.textWidth+=B;const Y=n.Path.getPointOnLine(B+I/2,F.x,F.y,j.x,j.y),Z=Math.atan2(j.y-F.y,j.x-F.x);this.glyphInfo.push({transposeX:Y.x,transposeY:Y.y,text:N[P],rotation:Z,p0:F,p1:j}),E+=A}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const p=[];this.glyphInfo.forEach(function(E){p.push(E.p0.x),p.push(E.p0.y),p.push(E.p1.x),p.push(E.p1.y)});let x=p[0]||0,v=p[0]||0,w=p[1]||0,C=p[1]||0,k,_;for(let E=0;E<p.length/2;E++)k=p[E*2],_=p[E*2+1],x=Math.min(x,k),v=Math.max(v,k),w=Math.min(w,_),C=Math.max(C,_);const N=this.fontSize();return{x:x-N/2,y:w-N/2,width:v-x+N,height:C-w+N}}destroy(){return e.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}return Cx.TextPath=f,f.prototype._fillFunc=u,f.prototype._strokeFunc=d,f.prototype._fillFuncHit=u,f.prototype._strokeFuncHit=d,f.prototype.className="TextPath",f.prototype._attrsAffectingSize=["text","fontSize","data"],(0,i._registerNode)(f),t.Factory.addGetterSetter(f,"data"),t.Factory.addGetterSetter(f,"fontFamily","Arial"),t.Factory.addGetterSetter(f,"fontSize",12,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(f,"fontStyle",c),t.Factory.addGetterSetter(f,"align","left"),t.Factory.addGetterSetter(f,"letterSpacing",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(f,"textBaseline","middle"),t.Factory.addGetterSetter(f,"fontVariant",c),t.Factory.addGetterSetter(f,"text",o),t.Factory.addGetterSetter(f,"textDecoration",""),t.Factory.addGetterSetter(f,"kerningFunc",void 0),Cx}var Tx={},Q6;function eZ(){if(Q6)return Tx;Q6=1,Object.defineProperty(Tx,"__esModule",{value:!0}),Tx.Transformer=void 0;const e=zs(),t=on(),r=ta(),n=qa(),s=bL(),a=r4(),i=tn(),o=cn(),c=tn(),u="tr-konva",d=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(A=>A+`.${u}`).join(" "),f="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],p={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},x="ontouchstart"in i.Konva._global;function v(A,j,I){if(A==="rotater")return I;j+=e.Util.degToRad(p[A]||0);const B=(e.Util.radToDeg(j)%360+360)%360;return e.Util._inRange(B,315+22.5,360)||e.Util._inRange(B,0,22.5)?"ns-resize":e.Util._inRange(B,45-22.5,45+22.5)?"nesw-resize":e.Util._inRange(B,90-22.5,90+22.5)?"ew-resize":e.Util._inRange(B,135-22.5,135+22.5)?"nwse-resize":e.Util._inRange(B,180-22.5,180+22.5)?"ns-resize":e.Util._inRange(B,225-22.5,225+22.5)?"nesw-resize":e.Util._inRange(B,270-22.5,270+22.5)?"ew-resize":e.Util._inRange(B,315-22.5,315+22.5)?"nwse-resize":(e.Util.error("Transformer has unknown angle for cursor detection: "+B),"pointer")}const w=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function C(A){return{x:A.x+A.width/2*Math.cos(A.rotation)+A.height/2*Math.sin(-A.rotation),y:A.y+A.height/2*Math.cos(A.rotation)+A.width/2*Math.sin(A.rotation)}}function k(A,j,I){const B=I.x+(A.x-I.x)*Math.cos(j)-(A.y-I.y)*Math.sin(j),Y=I.y+(A.x-I.x)*Math.sin(j)+(A.y-I.y)*Math.cos(j);return{...A,rotation:A.rotation+j,x:B,y:Y}}function _(A,j){const I=C(A);return k(A,j,I)}function N(A,j,I){let B=j;for(let Y=0;Y<A.length;Y++){const Z=i.Konva.getAngle(A[Y]),se=Math.abs(Z-j)%(Math.PI*2);Math.min(se,Math.PI*2-se)<I&&(B=Z)}return B}let E=0;class P extends a.Group{constructor(j){super(j),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(j){return this.setNode(j),this}setNode(j){return e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([j])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return u+this._id}setNodes(j=[]){this._nodes&&this._nodes.length&&this.detach();const I=j.filter(Y=>Y.isAncestorOf(this)?(e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=j=I,j.length===1&&this.useSingleNodeRotation()?this.rotation(j[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(Y=>{const Z=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(Y._attrsAffectingSize.length){const se=Y._attrsAffectingSize.map(ee=>ee+"Change."+this._getEventNamespace()).join(" ");Y.on(se,Z)}Y.on(g.map(se=>se+`.${this._getEventNamespace()}`).join(" "),Z),Y.on(`absoluteTransformChange.${this._getEventNamespace()}`,Z),this._proxyDrag(Y)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(j){let I;j.on(`dragstart.${this._getEventNamespace()}`,B=>{I=j.getAbsolutePosition(),!this.isDragging()&&j!==this.findOne(".back")&&this.startDrag(B,!1)}),j.on(`dragmove.${this._getEventNamespace()}`,B=>{if(!I)return;const Y=j.getAbsolutePosition(),Z=Y.x-I.x,se=Y.y-I.y;this.nodes().forEach(ee=>{if(ee===j||ee.isDragging())return;const te=ee.getAbsolutePosition();ee.setAbsolutePosition({x:te.x+Z,y:te.y+se}),ee.startDrag(B)}),I=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(j=>{j.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(f),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(f,this.__getNodeRect)}__getNodeShape(j,I=this.rotation(),B){const Y=j.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),Z=j.getAbsoluteScale(B),se=j.getAbsolutePosition(B),ee=Y.x*Z.x-j.offsetX()*Z.x,te=Y.y*Z.y-j.offsetY()*Z.y,L=(i.Konva.getAngle(j.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),V={x:se.x+ee*Math.cos(L)+te*Math.sin(-L),y:se.y+te*Math.cos(L)+ee*Math.sin(L),width:Y.width*Z.x,height:Y.height*Z.y,rotation:L};return k(V,-i.Konva.getAngle(I),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const I=[];this.nodes().map(L=>{const V=L.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),M=[{x:V.x,y:V.y},{x:V.x+V.width,y:V.y},{x:V.x+V.width,y:V.y+V.height},{x:V.x,y:V.y+V.height}],H=L.getAbsoluteTransform();M.forEach(function(W){const R=H.point(W);I.push(R)})});const B=new e.Transform;B.rotate(-i.Konva.getAngle(this.rotation()));let Y=1/0,Z=1/0,se=-1/0,ee=-1/0;I.forEach(function(L){const V=B.point(L);Y===void 0&&(Y=se=V.x,Z=ee=V.y),Y=Math.min(Y,V.x),Z=Math.min(Z,V.y),se=Math.max(se,V.x),ee=Math.max(ee,V.y)}),B.invert();const te=B.point({x:Y,y:Z});return{x:te.x,y:te.y,width:se-Y,height:ee-Z,rotation:i.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),w.forEach(j=>{this._createAnchor(j)}),this._createAnchor("rotater")}_createAnchor(j){const I=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:j+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:x?10:"auto"}),B=this;I.on("mousedown touchstart",function(Y){B._handleMouseDown(Y)}),I.on("dragstart",Y=>{I.stopDrag(),Y.cancelBubble=!0}),I.on("dragend",Y=>{Y.cancelBubble=!0}),I.on("mouseenter",()=>{const Y=i.Konva.getAngle(this.rotation()),Z=this.rotateAnchorCursor(),se=v(j,Y,Z);I.getStage().content&&(I.getStage().content.style.cursor=se),this._cursorChange=!0}),I.on("mouseout",()=>{I.getStage().content&&(I.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(I)}_createBack(){const j=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(I,B){const Y=B.getParent(),Z=Y.padding();I.beginPath(),I.rect(-Z,-Z,B.width()+Z*2,B.height()+Z*2),I.moveTo(B.width()/2,-Z),Y.rotateEnabled()&&Y.rotateLineVisible()&&I.lineTo(B.width()/2,-Y.rotateAnchorOffset()*e.Util._sign(B.height())-Z),I.fillStrokeShape(B)},hitFunc:(I,B)=>{if(!this.shouldOverdrawWholeArea())return;const Y=this.padding();I.beginPath(),I.rect(-Y,-Y,B.width()+Y*2,B.height()+Y*2),I.fillStrokeShape(B)}});this.add(j),this._proxyDrag(j),j.on("dragstart",I=>{I.cancelBubble=!0}),j.on("dragmove",I=>{I.cancelBubble=!0}),j.on("dragend",I=>{I.cancelBubble=!0}),this.on("dragmove",I=>{this.update()})}_handleMouseDown(j){if(this._transforming)return;this._movingAnchorName=j.target.name().split(" ")[0];const I=this._getNodeRect(),B=I.width,Y=I.height,Z=Math.sqrt(Math.pow(B,2)+Math.pow(Y,2));this.sin=Math.abs(Y/Z),this.cos=Math.abs(B/Z),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const se=j.target.getAbsolutePosition(),ee=j.target.getStage().getPointerPosition();this._anchorDragOffset={x:ee.x-se.x,y:ee.y-se.y},E++,this._fire("transformstart",{evt:j.evt,target:this.getNode()}),this._nodes.forEach(te=>{te._fire("transformstart",{evt:j.evt,target:te})})}_handleMouseMove(j){let I,B,Y;const Z=this.findOne("."+this._movingAnchorName),se=Z.getStage();se.setPointersPositions(j);const ee=se.getPointerPosition();let te={x:ee.x-this._anchorDragOffset.x,y:ee.y-this._anchorDragOffset.y};const L=Z.getAbsolutePosition();this.anchorDragBoundFunc()&&(te=this.anchorDragBoundFunc()(L,te,j)),Z.setAbsolutePosition(te);const V=Z.getAbsolutePosition();if(L.x===V.x&&L.y===V.y)return;if(this._movingAnchorName==="rotater"){const ae=this._getNodeRect();I=Z.x()-ae.width/2,B=-Z.y()+ae.height/2;let X=Math.atan2(-B,I)+Math.PI/2;ae.height<0&&(X-=Math.PI);const le=i.Konva.getAngle(this.rotation())+X,ce=i.Konva.getAngle(this.rotationSnapTolerance()),ne=N(this.rotationSnaps(),le,ce)-ae.rotation,pe=_(ae,ne);this._fitNodesInto(pe,j);return}const M=this.shiftBehavior();let H;M==="inverted"?H=this.keepRatio()&&!j.shiftKey:M==="none"?H=this.keepRatio():H=this.keepRatio()||j.shiftKey;let W=this.centeredScaling()||j.altKey;if(this._movingAnchorName==="top-left"){if(H){const ae=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};Y=Math.sqrt(Math.pow(ae.x-Z.x(),2)+Math.pow(ae.y-Z.y(),2));const X=this.findOne(".top-left").x()>ae.x?-1:1,ie=this.findOne(".top-left").y()>ae.y?-1:1;I=Y*this.cos*X,B=Y*this.sin*ie,this.findOne(".top-left").x(ae.x-I),this.findOne(".top-left").y(ae.y-B)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(Z.y());else if(this._movingAnchorName==="top-right"){if(H){const ae=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};Y=Math.sqrt(Math.pow(Z.x()-ae.x,2)+Math.pow(ae.y-Z.y(),2));const X=this.findOne(".top-right").x()<ae.x?-1:1,ie=this.findOne(".top-right").y()>ae.y?-1:1;I=Y*this.cos*X,B=Y*this.sin*ie,this.findOne(".top-right").x(ae.x+I),this.findOne(".top-right").y(ae.y-B)}var R=Z.position();this.findOne(".top-left").y(R.y),this.findOne(".bottom-right").x(R.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(Z.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(Z.x());else if(this._movingAnchorName==="bottom-left"){if(H){const ae=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};Y=Math.sqrt(Math.pow(ae.x-Z.x(),2)+Math.pow(Z.y()-ae.y,2));const X=ae.x<Z.x()?-1:1,ie=Z.y()<ae.y?-1:1;I=Y*this.cos*X,B=Y*this.sin*ie,Z.x(ae.x-I),Z.y(ae.y+B)}R=Z.position(),this.findOne(".top-left").x(R.x),this.findOne(".bottom-right").y(R.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(Z.y());else if(this._movingAnchorName==="bottom-right"){if(H){const ae=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};Y=Math.sqrt(Math.pow(Z.x()-ae.x,2)+Math.pow(Z.y()-ae.y,2));const X=this.findOne(".bottom-right").x()<ae.x?-1:1,ie=this.findOne(".bottom-right").y()<ae.y?-1:1;I=Y*this.cos*X,B=Y*this.sin*ie,this.findOne(".bottom-right").x(ae.x+I),this.findOne(".bottom-right").y(ae.y+B)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(W=this.centeredScaling()||j.altKey,W){const ae=this.findOne(".top-left"),X=this.findOne(".bottom-right"),ie=ae.x(),le=ae.y(),ce=this.getWidth()-X.x(),_e=this.getHeight()-X.y();X.move({x:-ie,y:-le}),ae.move({x:ce,y:_e})}const z=this.findOne(".top-left").getAbsolutePosition();I=z.x,B=z.y;const K=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),Q=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:I,y:B,width:K,height:Q,rotation:i.Konva.getAngle(this.rotation())},j)}_handleMouseUp(j){this._removeEvents(j)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(j){var I;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const B=this.getNode();E--,this._fire("transformend",{evt:j,target:B}),(I=this.getLayer())===null||I===void 0||I.batchDraw(),B&&this._nodes.forEach(Y=>{var Z;Y._fire("transformend",{evt:j,target:Y}),(Z=Y.getLayer())===null||Z===void 0||Z.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(j,I){const B=this._getNodeRect(),Y=1;if(e.Util._inRange(j.width,-this.padding()*2-Y,Y)){this.update();return}if(e.Util._inRange(j.height,-this.padding()*2-Y,Y)){this.update();return}const Z=new e.Transform;if(Z.rotate(i.Konva.getAngle(this.rotation())),this._movingAnchorName&&j.width<0&&this._movingAnchorName.indexOf("left")>=0){const H=Z.point({x:-this.padding()*2,y:0});j.x+=H.x,j.y+=H.y,j.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=H.x,this._anchorDragOffset.y-=H.y}else if(this._movingAnchorName&&j.width<0&&this._movingAnchorName.indexOf("right")>=0){const H=Z.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=H.x,this._anchorDragOffset.y-=H.y,j.width+=this.padding()*2}if(this._movingAnchorName&&j.height<0&&this._movingAnchorName.indexOf("top")>=0){const H=Z.point({x:0,y:-this.padding()*2});j.x+=H.x,j.y+=H.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=H.x,this._anchorDragOffset.y-=H.y,j.height+=this.padding()*2}else if(this._movingAnchorName&&j.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const H=Z.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=H.x,this._anchorDragOffset.y-=H.y,j.height+=this.padding()*2}if(this.boundBoxFunc()){const H=this.boundBoxFunc()(B,j);H?j=H:e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const se=1e7,ee=new e.Transform;ee.translate(B.x,B.y),ee.rotate(B.rotation),ee.scale(B.width/se,B.height/se);const te=new e.Transform,L=j.width/se,V=j.height/se;this.flipEnabled()===!1?(te.translate(j.x,j.y),te.rotate(j.rotation),te.translate(j.width<0?j.width:0,j.height<0?j.height:0),te.scale(Math.abs(L),Math.abs(V))):(te.translate(j.x,j.y),te.rotate(j.rotation),te.scale(L,V));const M=te.multiply(ee.invert());this._nodes.forEach(H=>{var W;const R=H.getParent().getAbsoluteTransform(),z=H.getTransform().copy();z.translate(H.offsetX(),H.offsetY());const K=new e.Transform;K.multiply(R.copy().invert()).multiply(M).multiply(R).multiply(z);const Q=K.decompose();H.setAttrs(Q),(W=H.getLayer())===null||W===void 0||W.batchDraw()}),this.rotation(e.Util._getRotation(j.rotation)),this._nodes.forEach(H=>{this._fire("transform",{evt:I,target:H}),H._fire("transform",{evt:I,target:H})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(j,I){this.findOne(j).setAttrs(I)}update(){var j;const I=this._getNodeRect();this.rotation(e.Util._getRotation(I.rotation));const B=I.width,Y=I.height,Z=this.enabledAnchors(),se=this.resizeEnabled(),ee=this.padding(),te=this.anchorSize(),L=this.find("._anchor");L.forEach(M=>{M.setAttrs({width:te,height:te,offsetX:te/2,offsetY:te/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:te/2+ee,offsetY:te/2+ee,visible:se&&Z.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:B/2,y:0,offsetY:te/2+ee,visible:se&&Z.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:B,y:0,offsetX:te/2-ee,offsetY:te/2+ee,visible:se&&Z.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:Y/2,offsetX:te/2+ee,visible:se&&Z.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:B,y:Y/2,offsetX:te/2-ee,visible:se&&Z.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:Y,offsetX:te/2+ee,offsetY:te/2-ee,visible:se&&Z.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:B/2,y:Y,offsetY:te/2-ee,visible:se&&Z.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:B,y:Y,offsetX:te/2-ee,offsetY:te/2-ee,visible:se&&Z.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:B/2,y:-this.rotateAnchorOffset()*e.Util._sign(Y)-ee,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:B,height:Y,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const V=this.anchorStyleFunc();V&&L.forEach(M=>{V(M)}),(j=this.getLayer())===null||j===void 0||j.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const j=this.findOne("."+this._movingAnchorName);j&&j.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),a.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(j){return r.Node.prototype.clone.call(this,j)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Tx.Transformer=P,P.isTransforming=()=>E>0;function F(A){return A instanceof Array||e.Util.warn("enabledAnchors value should be an array"),A instanceof Array&&A.forEach(function(j){w.indexOf(j)===-1&&e.Util.warn("Unknown anchor name: "+j+". Available names are: "+w.join(", "))}),A||[]}return P.prototype.className="Transformer",(0,c._registerNode)(P),t.Factory.addGetterSetter(P,"enabledAnchors",w,F),t.Factory.addGetterSetter(P,"flipEnabled",!0,(0,o.getBooleanValidator)()),t.Factory.addGetterSetter(P,"resizeEnabled",!0),t.Factory.addGetterSetter(P,"anchorSize",10,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateEnabled",!0),t.Factory.addGetterSetter(P,"rotateLineVisible",!0),t.Factory.addGetterSetter(P,"rotationSnaps",[]),t.Factory.addGetterSetter(P,"rotateAnchorOffset",50,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(P,"rotationSnapTolerance",5,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderEnabled",!0),t.Factory.addGetterSetter(P,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"anchorStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"anchorFill","white"),t.Factory.addGetterSetter(P,"anchorCornerRadius",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"borderStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderDash"),t.Factory.addGetterSetter(P,"keepRatio",!0),t.Factory.addGetterSetter(P,"shiftBehavior","default"),t.Factory.addGetterSetter(P,"centeredScaling",!1),t.Factory.addGetterSetter(P,"ignoreStroke",!1),t.Factory.addGetterSetter(P,"padding",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"nodes"),t.Factory.addGetterSetter(P,"node"),t.Factory.addGetterSetter(P,"boundBoxFunc"),t.Factory.addGetterSetter(P,"anchorDragBoundFunc"),t.Factory.addGetterSetter(P,"anchorStyleFunc"),t.Factory.addGetterSetter(P,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(P,"useSingleNodeRotation",!0),t.Factory.backCompat(P,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Tx}var Ex={},J6;function tZ(){if(J6)return Ex;J6=1,Object.defineProperty(Ex,"__esModule",{value:!0}),Ex.Wedge=void 0;const e=on(),t=qa(),r=tn(),n=cn(),s=tn();class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),o.lineTo(0,0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}}return Ex.Wedge=a,a.prototype.className="Wedge",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1),e.Factory.backCompat(a,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Ex}var Nx={},Z6;function rZ(){if(Z6)return Nx;Z6=1,Object.defineProperty(Nx,"__esModule",{value:!0}),Nx.Blur=void 0;const e=on(),t=ta(),r=cn();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function i(c,u){const d=c.data,f=c.width,g=c.height;let p,x,v,w,C,k,_,N,E,P,F,A,j,I,B,Y,Z,se,ee,te;const L=u+u+1,V=f-1,M=g-1,H=u+1,W=H*(H+1)/2,R=new n,z=s[u],K=a[u];let Q=null,ae=R,X=null,ie=null;for(let le=1;le<L;le++)ae=ae.next=new n,le===H&&(Q=ae);ae.next=R,v=x=0;for(let le=0;le<g;le++){A=j=I=B=w=C=k=_=0,N=H*(Y=d[x]),E=H*(Z=d[x+1]),P=H*(se=d[x+2]),F=H*(ee=d[x+3]),w+=W*Y,C+=W*Z,k+=W*se,_+=W*ee,ae=R;for(let ce=0;ce<H;ce++)ae.r=Y,ae.g=Z,ae.b=se,ae.a=ee,ae=ae.next;for(let ce=1;ce<H;ce++)p=x+((V<ce?V:ce)<<2),w+=(ae.r=Y=d[p])*(te=H-ce),C+=(ae.g=Z=d[p+1])*te,k+=(ae.b=se=d[p+2])*te,_+=(ae.a=ee=d[p+3])*te,A+=Y,j+=Z,I+=se,B+=ee,ae=ae.next;X=R,ie=Q;for(let ce=0;ce<f;ce++)d[x+3]=ee=_*z>>K,ee!==0?(ee=255/ee,d[x]=(w*z>>K)*ee,d[x+1]=(C*z>>K)*ee,d[x+2]=(k*z>>K)*ee):d[x]=d[x+1]=d[x+2]=0,w-=N,C-=E,k-=P,_-=F,N-=X.r,E-=X.g,P-=X.b,F-=X.a,p=v+((p=ce+u+1)<V?p:V)<<2,A+=X.r=d[p],j+=X.g=d[p+1],I+=X.b=d[p+2],B+=X.a=d[p+3],w+=A,C+=j,k+=I,_+=B,X=X.next,N+=Y=ie.r,E+=Z=ie.g,P+=se=ie.b,F+=ee=ie.a,A-=Y,j-=Z,I-=se,B-=ee,ie=ie.next,x+=4;v+=f}for(let le=0;le<f;le++){j=I=B=A=C=k=_=w=0,x=le<<2,N=H*(Y=d[x]),E=H*(Z=d[x+1]),P=H*(se=d[x+2]),F=H*(ee=d[x+3]),w+=W*Y,C+=W*Z,k+=W*se,_+=W*ee,ae=R;for(let _e=0;_e<H;_e++)ae.r=Y,ae.g=Z,ae.b=se,ae.a=ee,ae=ae.next;let ce=f;for(let _e=1;_e<=u;_e++)x=ce+le<<2,w+=(ae.r=Y=d[x])*(te=H-_e),C+=(ae.g=Z=d[x+1])*te,k+=(ae.b=se=d[x+2])*te,_+=(ae.a=ee=d[x+3])*te,A+=Y,j+=Z,I+=se,B+=ee,ae=ae.next,_e<M&&(ce+=f);x=le,X=R,ie=Q;for(let _e=0;_e<g;_e++)p=x<<2,d[p+3]=ee=_*z>>K,ee>0?(ee=255/ee,d[p]=(w*z>>K)*ee,d[p+1]=(C*z>>K)*ee,d[p+2]=(k*z>>K)*ee):d[p]=d[p+1]=d[p+2]=0,w-=N,C-=E,k-=P,_-=F,N-=X.r,E-=X.g,P-=X.b,F-=X.a,p=le+((p=_e+H)<M?p:M)*f<<2,w+=A+=X.r=d[p],C+=j+=X.g=d[p+1],k+=I+=X.b=d[p+2],_+=B+=X.a=d[p+3],X=X.next,N+=Y=ie.r,E+=Z=ie.g,P+=se=ie.b,F+=ee=ie.a,A-=Y,j-=Z,I-=se,B-=ee,ie=ie.next,x+=f}}const o=function(u){const d=Math.round(this.blurRadius());d>0&&i(u,d)};return Nx.Blur=o,e.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Nx}var Ax={},eP;function nZ(){if(eP)return Ax;eP=1,Object.defineProperty(Ax,"__esModule",{value:!0}),Ax.Brighten=void 0;const e=on(),t=ta(),r=cn(),n=function(s){const a=this.brightness()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=4)i[c]+=a,i[c+1]+=a,i[c+2]+=a};return Ax.Brighten=n,e.Factory.addGetterSetter(t.Node,"brightness",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ax}var jx={},tP;function sZ(){if(tP)return jx;tP=1,Object.defineProperty(jx,"__esModule",{value:!0}),jx.Contrast=void 0;const e=on(),t=ta(),r=cn(),n=function(s){const a=Math.pow((this.contrast()+100)/100,2),i=s.data,o=i.length;let c=150,u=150,d=150;for(let f=0;f<o;f+=4)c=i[f],u=i[f+1],d=i[f+2],c/=255,c-=.5,c*=a,c+=.5,c*=255,u/=255,u-=.5,u*=a,u+=.5,u*=255,d/=255,d-=.5,d*=a,d+=.5,d*=255,c=c<0?0:c>255?255:c,u=u<0?0:u>255?255:u,d=d<0?0:d>255?255:d,i[f]=c,i[f+1]=u,i[f+2]=d};return jx.Contrast=n,e.Factory.addGetterSetter(t.Node,"contrast",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),jx}var Px={},rP;function aZ(){if(rP)return Px;rP=1,Object.defineProperty(Px,"__esModule",{value:!0}),Px.Emboss=void 0;const e=on(),t=ta(),r=zs(),n=cn(),s=function(a){const i=this.embossStrength()*10,o=this.embossWhiteLevel()*255,c=this.embossDirection(),u=this.embossBlend(),d=a.data,f=a.width,g=a.height,p=f*4;let x=0,v=0,w=g;switch(c){case"top-left":x=-1,v=-1;break;case"top":x=-1,v=0;break;case"top-right":x=-1,v=1;break;case"right":x=0,v=1;break;case"bottom-right":x=1,v=1;break;case"bottom":x=1,v=0;break;case"bottom-left":x=1,v=-1;break;case"left":x=0,v=-1;break;default:r.Util.error("Unknown emboss direction: "+c)}do{const C=(w-1)*p;let k=x;w+k<1&&(k=0),w+k>g&&(k=0);const _=(w-1+k)*f*4;let N=f;do{const E=C+(N-1)*4;let P=v;N+P<1&&(P=0),N+P>f&&(P=0);const F=_+(N-1+P)*4,A=d[E]-d[F],j=d[E+1]-d[F+1],I=d[E+2]-d[F+2];let B=A;const Y=B>0?B:-B,Z=j>0?j:-j,se=I>0?I:-I;if(Z>Y&&(B=j),se>Y&&(B=I),B*=i,u){const ee=d[E]+B,te=d[E+1]+B,L=d[E+2]+B;d[E]=ee>255?255:ee<0?0:ee,d[E+1]=te>255?255:te<0?0:te,d[E+2]=L>255?255:L<0?0:L}else{let ee=o-B;ee<0?ee=0:ee>255&&(ee=255),d[E]=d[E+1]=d[E+2]=ee}}while(--N)}while(--w)};return Px.Emboss=s,e.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,e.Factory.afterSetFilter),Px}var Fx={},nP;function iZ(){if(nP)return Fx;nP=1,Object.defineProperty(Fx,"__esModule",{value:!0}),Fx.Enhance=void 0;const e=on(),t=ta(),r=cn();function n(a,i,o,c,u){const d=o-i,f=u-c;if(d===0)return c+f/2;if(f===0)return c;let g=(a-i)/d;return g=f*g+c,g}const s=function(a){const i=a.data,o=i.length;let c=i[0],u=c,d,f=i[1],g=f,p,x=i[2],v=x,w;const C=this.enhance();if(C===0)return;for(let A=0;A<o;A+=4)d=i[A+0],d<c?c=d:d>u&&(u=d),p=i[A+1],p<f?f=p:p>g&&(g=p),w=i[A+2],w<x?x=w:w>v&&(v=w);u===c&&(u=255,c=0),g===f&&(g=255,f=0),v===x&&(v=255,x=0);let k,_,N,E,P,F;if(C>0)k=u+C*(255-u),_=c-C*(c-0),N=g+C*(255-g),E=f-C*(f-0),P=v+C*(255-v),F=x-C*(x-0);else{const A=(u+c)*.5;k=u+C*(u-A),_=c+C*(c-A);const j=(g+f)*.5;N=g+C*(g-j),E=f+C*(f-j);const I=(v+x)*.5;P=v+C*(v-I),F=x+C*(x-I)}for(let A=0;A<o;A+=4)i[A+0]=n(i[A+0],c,u,_,k),i[A+1]=n(i[A+1],f,g,E,N),i[A+2]=n(i[A+2],x,v,F,P)};return Fx.Enhance=s,e.Factory.addGetterSetter(t.Node,"enhance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Fx}var Ox={},sP;function oZ(){if(sP)return Ox;sP=1,Object.defineProperty(Ox,"__esModule",{value:!0}),Ox.Grayscale=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=.34*r[s]+.5*r[s+1]+.16*r[s+2];r[s]=a,r[s+1]=a,r[s+2]=a}};return Ox.Grayscale=e,Ox}var Dx={},aP;function lZ(){if(aP)return Dx;aP=1,Object.defineProperty(Dx,"__esModule",{value:!0}),Dx.HSL=void 0;const e=on(),t=ta(),r=cn();e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"luminance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter);const n=function(s){const a=s.data,i=a.length,o=1,c=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,d=this.luminance()*127,f=o*c*Math.cos(u*Math.PI/180),g=o*c*Math.sin(u*Math.PI/180),p=.299*o+.701*f+.167*g,x=.587*o-.587*f+.33*g,v=.114*o-.114*f-.497*g,w=.299*o-.299*f-.328*g,C=.587*o+.413*f+.035*g,k=.114*o-.114*f+.293*g,_=.299*o-.3*f+1.25*g,N=.587*o-.586*f-1.05*g,E=.114*o+.886*f-.2*g;let P,F,A,j;for(let I=0;I<i;I+=4)P=a[I+0],F=a[I+1],A=a[I+2],j=a[I+3],a[I+0]=p*P+x*F+v*A+d,a[I+1]=w*P+C*F+k*A+d,a[I+2]=_*P+N*F+E*A+d,a[I+3]=j};return Dx.HSL=n,Dx}var Ix={},iP;function cZ(){if(iP)return Ix;iP=1,Object.defineProperty(Ix,"__esModule",{value:!0}),Ix.HSV=void 0;const e=on(),t=ta(),r=cn(),n=function(s){const a=s.data,i=a.length,o=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,d=o*c*Math.cos(u*Math.PI/180),f=o*c*Math.sin(u*Math.PI/180),g=.299*o+.701*d+.167*f,p=.587*o-.587*d+.33*f,x=.114*o-.114*d-.497*f,v=.299*o-.299*d-.328*f,w=.587*o+.413*d+.035*f,C=.114*o-.114*d+.293*f,k=.299*o-.3*d+1.25*f,_=.587*o-.586*d-1.05*f,N=.114*o+.886*d-.2*f;for(let E=0;E<i;E+=4){const P=a[E+0],F=a[E+1],A=a[E+2],j=a[E+3];a[E+0]=g*P+p*F+x*A,a[E+1]=v*P+w*F+C*A,a[E+2]=k*P+_*F+N*A,a[E+3]=j}};return Ix.HSV=n,e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"value",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ix}var Rx={},oP;function uZ(){if(oP)return Rx;oP=1,Object.defineProperty(Rx,"__esModule",{value:!0}),Rx.Invert=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]=255-r[s],r[s+1]=255-r[s+1],r[s+2]=255-r[s+2]};return Rx.Invert=e,Rx}var Mx={},lP;function dZ(){if(lP)return Mx;lP=1,Object.defineProperty(Mx,"__esModule",{value:!0}),Mx.Kaleidoscope=void 0;const e=on(),t=ta(),r=zs(),n=cn(),s=function(o,c,u){const d=o.data,f=c.data,g=o.width,p=o.height,x=u.polarCenterX||g/2,v=u.polarCenterY||p/2;let w=Math.sqrt(x*x+v*v),C=g-x,k=p-v;const _=Math.sqrt(C*C+k*k);w=_>w?_:w;const N=p,E=g,P=360/E*Math.PI/180;for(let F=0;F<E;F+=1){const A=Math.sin(F*P),j=Math.cos(F*P);for(let I=0;I<N;I+=1){C=Math.floor(x+w*I/N*j),k=Math.floor(v+w*I/N*A);let B=(k*g+C)*4;const Y=d[B+0],Z=d[B+1],se=d[B+2],ee=d[B+3];B=(F+I*g)*4,f[B+0]=Y,f[B+1]=Z,f[B+2]=se,f[B+3]=ee}}},a=function(o,c,u){const d=o.data,f=c.data,g=o.width,p=o.height,x=u.polarCenterX||g/2,v=u.polarCenterY||p/2;let w=Math.sqrt(x*x+v*v),C=g-x,k=p-v;const _=Math.sqrt(C*C+k*k);w=_>w?_:w;const N=p,E=g,P=0;let F,A;for(C=0;C<g;C+=1)for(k=0;k<p;k+=1){const j=C-x,I=k-v,B=Math.sqrt(j*j+I*I)*N/w;let Y=(Math.atan2(I,j)*180/Math.PI+360+P)%360;Y=Y*E/360,F=Math.floor(Y),A=Math.floor(B);let Z=(A*g+F)*4;const se=d[Z+0],ee=d[Z+1],te=d[Z+2],L=d[Z+3];Z=(k*g+C)*4,f[Z+0]=se,f[Z+1]=ee,f[Z+2]=te,f[Z+3]=L}},i=function(o){const c=o.width,u=o.height;let d,f,g,p,x,v,w,C,k,_,N=Math.round(this.kaleidoscopePower());const E=Math.round(this.kaleidoscopeAngle()),P=Math.floor(c*(E%360)/360);if(N<1)return;const F=r.Util.createCanvasElement();F.width=c,F.height=u;const A=F.getContext("2d").getImageData(0,0,c,u);r.Util.releaseCanvas(F),s(o,A,{polarCenterX:c/2,polarCenterY:u/2});let j=c/Math.pow(2,N);for(;j<=8;)j=j*2,N-=1;j=Math.ceil(j);let I=j,B=0,Y=I,Z=1;for(P+j>c&&(B=I,Y=0,Z=-1),f=0;f<u;f+=1)for(d=B;d!==Y;d+=Z)g=Math.round(d+P)%c,k=(c*f+g)*4,x=A.data[k+0],v=A.data[k+1],w=A.data[k+2],C=A.data[k+3],_=(c*f+d)*4,A.data[_+0]=x,A.data[_+1]=v,A.data[_+2]=w,A.data[_+3]=C;for(f=0;f<u;f+=1)for(I=Math.floor(j),p=0;p<N;p+=1){for(d=0;d<I+1;d+=1)k=(c*f+d)*4,x=A.data[k+0],v=A.data[k+1],w=A.data[k+2],C=A.data[k+3],_=(c*f+I*2-d-1)*4,A.data[_+0]=x,A.data[_+1]=v,A.data[_+2]=w,A.data[_+3]=C;I*=2}a(A,o,{})};return Mx.Kaleidoscope=i,e.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Mx}var Lx={},cP;function fZ(){if(cP)return Lx;cP=1,Object.defineProperty(Lx,"__esModule",{value:!0}),Lx.Mask=void 0;const e=on(),t=ta(),r=cn();function n(g,p,x){let v=(x*g.width+p)*4;const w=[];return w.push(g.data[v++],g.data[v++],g.data[v++],g.data[v++]),w}function s(g,p){return Math.sqrt(Math.pow(g[0]-p[0],2)+Math.pow(g[1]-p[1],2)+Math.pow(g[2]-p[2],2))}function a(g){const p=[0,0,0];for(let x=0;x<g.length;x++)p[0]+=g[x][0],p[1]+=g[x][1],p[2]+=g[x][2];return p[0]/=g.length,p[1]/=g.length,p[2]/=g.length,p}function i(g,p){const x=n(g,0,0),v=n(g,g.width-1,0),w=n(g,0,g.height-1),C=n(g,g.width-1,g.height-1),k=p||10;if(s(x,v)<k&&s(v,C)<k&&s(C,w)<k&&s(w,x)<k){const _=a([v,x,C,w]),N=[];for(let E=0;E<g.width*g.height;E++){const P=s(_,[g.data[E*4],g.data[E*4+1],g.data[E*4+2]]);N[E]=P<k?0:255}return N}}function o(g,p){for(let x=0;x<g.width*g.height;x++)g.data[4*x+3]=p[x]}function c(g,p,x){const v=[1,1,1,1,0,1,1,1,1],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let _=0;_<x;_++)for(let N=0;N<p;N++){const E=_*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=_+F-C,I=N+A-C;if(j>=0&&j<x&&I>=0&&I<p){const B=j*p+I,Y=v[F*w+A];P+=g[B]*Y}}k[E]=P===2040?255:0}return k}function u(g,p,x){const v=[1,1,1,1,1,1,1,1,1],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let _=0;_<x;_++)for(let N=0;N<p;N++){const E=_*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=_+F-C,I=N+A-C;if(j>=0&&j<x&&I>=0&&I<p){const B=j*p+I,Y=v[F*w+A];P+=g[B]*Y}}k[E]=P>=1020?255:0}return k}function d(g,p,x){const v=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let _=0;_<x;_++)for(let N=0;N<p;N++){const E=_*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=_+F-C,I=N+A-C;if(j>=0&&j<x&&I>=0&&I<p){const B=j*p+I,Y=v[F*w+A];P+=g[B]*Y}}k[E]=P}return k}const f=function(g){const p=this.threshold();let x=i(g,p);return x&&(x=c(x,g.width,g.height),x=u(x,g.width,g.height),x=d(x,g.width,g.height),o(g,x)),g};return Lx.Mask=f,e.Factory.addGetterSetter(t.Node,"threshold",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Lx}var Bx={},uP;function hZ(){if(uP)return Bx;uP=1,Object.defineProperty(Bx,"__esModule",{value:!0}),Bx.Noise=void 0;const e=on(),t=ta(),r=cn(),n=function(s){const a=this.noise()*255,i=s.data,o=i.length,c=a/2;for(let u=0;u<o;u+=4)i[u+0]+=c-2*c*Math.random(),i[u+1]+=c-2*c*Math.random(),i[u+2]+=c-2*c*Math.random()};return Bx.Noise=n,e.Factory.addGetterSetter(t.Node,"noise",.2,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Bx}var $x={},dP;function gZ(){if(dP)return $x;dP=1,Object.defineProperty($x,"__esModule",{value:!0}),$x.Pixelate=void 0;const e=on(),t=zs(),r=ta(),n=cn(),s=function(a){let i=Math.ceil(this.pixelSize()),o=a.width,c=a.height,u=Math.ceil(o/i),d=Math.ceil(c/i),f=a.data;if(i<=0){t.Util.error("pixelSize value can not be <= 0");return}for(let g=0;g<u;g+=1)for(let p=0;p<d;p+=1){let x=0,v=0,w=0,C=0;const k=g*i,_=k+i,N=p*i,E=N+i;let P=0;for(let F=k;F<_;F+=1)if(!(F>=o))for(let A=N;A<E;A+=1){if(A>=c)continue;const j=(o*A+F)*4;x+=f[j+0],v+=f[j+1],w+=f[j+2],C+=f[j+3],P+=1}x=x/P,v=v/P,w=w/P,C=C/P;for(let F=k;F<_;F+=1)if(!(F>=o))for(let A=N;A<E;A+=1){if(A>=c)continue;const j=(o*A+F)*4;f[j+0]=x,f[j+1]=v,f[j+2]=w,f[j+3]=C}}};return $x.Pixelate=s,e.Factory.addGetterSetter(r.Node,"pixelSize",8,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),$x}var Ux={},fP;function mZ(){if(fP)return Ux;fP=1,Object.defineProperty(Ux,"__esModule",{value:!0}),Ux.Posterize=void 0;const e=on(),t=ta(),r=cn(),n=function(s){const a=Math.round(this.levels()*254)+1,i=s.data,o=i.length,c=255/a;for(let u=0;u<o;u+=1)i[u]=Math.floor(i[u]/c)*c};return Ux.Posterize=n,e.Factory.addGetterSetter(t.Node,"levels",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ux}var zx={},hP;function pZ(){if(hP)return zx;hP=1,Object.defineProperty(zx,"__esModule",{value:!0}),zx.RGB=void 0;const e=on(),t=ta(),r=cn(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),u=this.blue();for(let d=0;d<i;d+=4){const f=(.34*a[d]+.5*a[d+1]+.16*a[d+2])/255;a[d]=f*o,a[d+1]=f*c,a[d+2]=f*u,a[d+3]=a[d+3]}};return zx.RGB=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),zx}var Wx={},gP;function xZ(){if(gP)return Wx;gP=1,Object.defineProperty(Wx,"__esModule",{value:!0}),Wx.RGBA=void 0;const e=on(),t=ta(),r=cn(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),u=this.blue(),d=this.alpha();for(let f=0;f<i;f+=4){const g=1-d;a[f]=o*d+a[f]*g,a[f+1]=c*d+a[f+1]*g,a[f+2]=u*d+a[f+2]*g}};return Wx.RGBA=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),Wx}var Hx={},mP;function yZ(){if(mP)return Hx;mP=1,Object.defineProperty(Hx,"__esModule",{value:!0}),Hx.Sepia=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=r[s+0],i=r[s+1],o=r[s+2];r[s+0]=Math.min(255,a*.393+i*.769+o*.189),r[s+1]=Math.min(255,a*.349+i*.686+o*.168),r[s+2]=Math.min(255,a*.272+i*.534+o*.131)}};return Hx.Sepia=e,Hx}var Gx={},pP;function vZ(){if(pP)return Gx;pP=1,Object.defineProperty(Gx,"__esModule",{value:!0}),Gx.Solarize=void 0;const e=function(t){const r=t.data,n=t.width,s=t.height,a=n*4;let i=s;do{const o=(i-1)*a;let c=n;do{const u=o+(c-1)*4;let d=r[u],f=r[u+1],g=r[u+2];d>127&&(d=255-d),f>127&&(f=255-f),g>127&&(g=255-g),r[u]=d,r[u+1]=f,r[u+2]=g}while(--c)}while(--i)};return Gx.Solarize=e,Gx}var Vx={},xP;function wZ(){if(xP)return Vx;xP=1,Object.defineProperty(Vx,"__esModule",{value:!0}),Vx.Threshold=void 0;const e=on(),t=ta(),r=cn(),n=function(s){const a=this.threshold()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=1)i[c]=i[c]<a?0:255};return Vx.Threshold=n,e.Factory.addGetterSetter(t.Node,"threshold",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Vx}var yP;function _Z(){if(yP)return ix;yP=1,Object.defineProperty(ix,"__esModule",{value:!0}),ix.Konva=void 0;const e=RT(),t=zJ(),r=HJ(),n=GJ(),s=VJ(),a=KJ(),i=qJ(),o=_L(),c=s4(),u=bL(),d=YJ(),f=XJ(),g=QJ(),p=JJ(),x=SL(),v=ZJ(),w=eZ(),C=tZ(),k=rZ(),_=nZ(),N=sZ(),E=aZ(),P=iZ(),F=oZ(),A=lZ(),j=cZ(),I=uZ(),B=dZ(),Y=fZ(),Z=hZ(),se=gZ(),ee=mZ(),te=pZ(),L=xZ(),V=yZ(),M=vZ(),H=wZ();return ix.Konva=e.Konva.Util._assign(e.Konva,{Arc:t.Arc,Arrow:r.Arrow,Circle:n.Circle,Ellipse:s.Ellipse,Image:a.Image,Label:i.Label,Tag:i.Tag,Line:o.Line,Path:c.Path,Rect:u.Rect,RegularPolygon:d.RegularPolygon,Ring:f.Ring,Sprite:g.Sprite,Star:p.Star,Text:x.Text,TextPath:v.TextPath,Transformer:w.Transformer,Wedge:C.Wedge,Filters:{Blur:k.Blur,Brighten:_.Brighten,Contrast:N.Contrast,Emboss:E.Emboss,Enhance:P.Enhance,Grayscale:F.Grayscale,HSL:A.HSL,HSV:j.HSV,Invert:I.Invert,Kaleidoscope:B.Kaleidoscope,Mask:Y.Mask,Noise:Z.Noise,Pixelate:se.Pixelate,Posterize:ee.Posterize,RGB:te.RGB,RGBA:L.RGBA,Sepia:V.Sepia,Solarize:M.Solarize,Threshold:H.Threshold}}),ix}var bZ=a_.exports,vP;function SZ(){if(vP)return a_.exports;vP=1,Object.defineProperty(bZ,"__esModule",{value:!0});const e=_Z();return a_.exports=e.Konva,a_.exports}var kL=SZ();const kZ=Ml(kL),CZ=_M({__proto__:null,default:kZ},[kL]);var pw={exports:{}},wP;function TZ(){return wP||(wP=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=RT();Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=RT();e.exports=n.Konva})(pw,pw.exports)),pw.exports}var EZ=TZ();const Vy=Ml(EZ);var ZS={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ek,_P;function NZ(){return _P||(_P=1,ek=function(t){var r={},n=E0(),s=pN(),a=Object.assign;function i(y){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+y,O=1;O<arguments.length;O++)b+="&args[]="+encodeURIComponent(arguments[O]);return"Minified React error #"+y+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),x=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),N=Symbol.for("react.offscreen"),E=Symbol.iterator;function P(y){return y===null||typeof y!="object"?null:(y=E&&y[E]||y["@@iterator"],typeof y=="function"?y:null)}function F(y){if(y==null)return null;if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y;switch(y){case d:return"Fragment";case u:return"Portal";case g:return"Profiler";case f:return"StrictMode";case w:return"Suspense";case C:return"SuspenseList"}if(typeof y=="object")switch(y.$$typeof){case x:return(y.displayName||"Context")+".Consumer";case p:return(y._context.displayName||"Context")+".Provider";case v:var b=y.render;return y=y.displayName,y||(y=b.displayName||b.name||"",y=y!==""?"ForwardRef("+y+")":"ForwardRef"),y;case k:return b=y.displayName||null,b!==null?b:F(y.type)||"Memo";case _:b=y._payload,y=y._init;try{return F(y(b))}catch{}}return null}function A(y){var b=y.type;switch(y.tag){case 24:return"Cache";case 9:return(b.displayName||"Context")+".Consumer";case 10:return(b._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return y=b.render,y=y.displayName||y.name||"",b.displayName||(y!==""?"ForwardRef("+y+")":"ForwardRef");case 7:return"Fragment";case 5:return b;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(b);case 8:return b===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b}return null}function j(y){var b=y,O=y;if(y.alternate)for(;b.return;)b=b.return;else{y=b;do b=y,(b.flags&4098)!==0&&(O=b.return),y=b.return;while(y)}return b.tag===3?O:null}function I(y){if(j(y)!==y)throw Error(i(188))}function B(y){var b=y.alternate;if(!b){if(b=j(y),b===null)throw Error(i(188));return b!==y?null:y}for(var O=y,U=b;;){var q=O.return;if(q===null)break;var re=q.alternate;if(re===null){if(U=q.return,U!==null){O=U;continue}break}if(q.child===re.child){for(re=q.child;re;){if(re===O)return I(q),y;if(re===U)return I(q),b;re=re.sibling}throw Error(i(188))}if(O.return!==U.return)O=q,U=re;else{for(var ve=!1,Ve=q.child;Ve;){if(Ve===O){ve=!0,O=q,U=re;break}if(Ve===U){ve=!0,U=q,O=re;break}Ve=Ve.sibling}if(!ve){for(Ve=re.child;Ve;){if(Ve===O){ve=!0,O=re,U=q;break}if(Ve===U){ve=!0,U=re,O=q;break}Ve=Ve.sibling}if(!ve)throw Error(i(189))}}if(O.alternate!==U)throw Error(i(190))}if(O.tag!==3)throw Error(i(188));return O.stateNode.current===O?y:b}function Y(y){return y=B(y),y!==null?Z(y):null}function Z(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){var b=Z(y);if(b!==null)return b;y=y.sibling}return null}function se(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){if(y.tag!==4){var b=se(y);if(b!==null)return b}y=y.sibling}return null}var ee=Array.isArray,te=t.getPublicInstance,L=t.getRootHostContext,V=t.getChildHostContext,M=t.prepareForCommit,H=t.resetAfterCommit,W=t.createInstance,R=t.appendInitialChild,z=t.finalizeInitialChildren,K=t.prepareUpdate,Q=t.shouldSetTextContent,ae=t.createTextInstance,X=t.scheduleTimeout,ie=t.cancelTimeout,le=t.noTimeout,ce=t.isPrimaryRenderer,_e=t.supportsMutation,ne=t.supportsPersistence,pe=t.supportsHydration,Ce=t.getInstanceFromNode,Ae=t.preparePortalMount,Ge=t.getCurrentEventPriority,Le=t.detachDeletedInstance,At=t.supportsMicrotasks,et=t.scheduleMicrotask,pt=t.supportsTestSelectors,lt=t.findFiberRoot,rt=t.getBoundingRect,ht=t.getTextContent,Lt=t.isHiddenSubtree,zt=t.matchAccessibilityRole,Dt=t.setFocusIfFocusable,De=t.setupIntersectionObserver,Ie=t.appendChild,Ke=t.appendChildToContainer,Je=t.commitTextUpdate,Ye=t.commitMount,Tt=t.commitUpdate,Nt=t.insertBefore,Wt=t.insertInContainerBefore,or=t.removeChild,dr=t.removeChildFromContainer,Er=t.resetTextContent,fr=t.hideInstance,nr=t.hideTextInstance,me=t.unhideInstance,Ne=t.unhideTextInstance,Fe=t.clearContainer,Re=t.cloneInstance,bt=t.createContainerChildSet,Pe=t.appendChildToContainerChildSet,ze=t.finalizeContainerChildren,ke=t.replaceContainerChildren,$e=t.cloneHiddenInstance,Be=t.cloneHiddenTextInstance,Et=t.canHydrateInstance,It=t.canHydrateTextInstance,Kt=t.canHydrateSuspenseInstance,wr=t.isSuspenseInstancePending,lr=t.isSuspenseInstanceFallback,Fr=t.getSuspenseInstanceFallbackErrorDetails,ue=t.registerSuspenseInstanceRetry,be=t.getNextHydratableSibling,xe=t.getFirstHydratableChild,he=t.getFirstHydratableChildWithinContainer,we=t.getFirstHydratableChildWithinSuspenseInstance,Se=t.hydrateInstance,He=t.hydrateTextInstance,ct=t.hydrateSuspenseInstance,qe=t.getNextHydratableInstanceAfterSuspenseInstance,oe=t.commitHydratedContainer,fe=t.commitHydratedSuspenseInstance,Te=t.clearSuspenseBoundary,Ee=t.clearSuspenseBoundaryFromContainer,Xe=t.shouldDeleteUnhydratedTailInstances,ot=t.didNotMatchHydratedContainerTextInstance,xt=t.didNotMatchHydratedTextInstance,qt;function yt(y){if(qt===void 0)try{throw Error()}catch(O){var b=O.stack.trim().match(/\n( *(at )?)/);qt=b&&b[1]||""}return`
`+qt+y}var Yt=!1;function _r(y,b){if(!y||Yt)return"";Yt=!0;var O=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error()},Object.defineProperty(b.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(b,[])}catch(Vt){var U=Vt}Reflect.construct(y,[],b)}else{try{b.call()}catch(Vt){U=Vt}y.call(b.prototype)}else{try{throw Error()}catch(Vt){U=Vt}y()}}catch(Vt){if(Vt&&U&&typeof Vt.stack=="string"){for(var q=Vt.stack.split(`
`),re=U.stack.split(`
`),ve=q.length-1,Ve=re.length-1;1<=ve&&0<=Ve&&q[ve]!==re[Ve];)Ve--;for(;1<=ve&&0<=Ve;ve--,Ve--)if(q[ve]!==re[Ve]){if(ve!==1||Ve!==1)do if(ve--,Ve--,0>Ve||q[ve]!==re[Ve]){var gt=`
`+q[ve].replace(" at new "," at ");return y.displayName&&gt.includes("<anonymous>")&&(gt=gt.replace("<anonymous>",y.displayName)),gt}while(1<=ve&&0<=Ve);break}}}finally{Yt=!1,Error.prepareStackTrace=O}return(y=y?y.displayName||y.name:"")?yt(y):""}var kr=Object.prototype.hasOwnProperty,xr=[],Gr=-1;function un(y){return{current:y}}function Xr(y){0>Gr||(y.current=xr[Gr],xr[Gr]=null,Gr--)}function cr(y,b){Gr++,xr[Gr]=y.current,y.current=b}var na={},hn=un(na),Gn=un(!1),Nn=na;function Ws(y,b){var O=y.type.contextTypes;if(!O)return na;var U=y.stateNode;if(U&&U.__reactInternalMemoizedUnmaskedChildContext===b)return U.__reactInternalMemoizedMaskedChildContext;var q={},re;for(re in O)q[re]=b[re];return U&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=b,y.__reactInternalMemoizedMaskedChildContext=q),q}function Sn(y){return y=y.childContextTypes,y!=null}function ye(){Xr(Gn),Xr(hn)}function wt(y,b,O){if(hn.current!==na)throw Error(i(168));cr(hn,b),cr(Gn,O)}function Nr(y,b,O){var U=y.stateNode;if(b=b.childContextTypes,typeof U.getChildContext!="function")return O;U=U.getChildContext();for(var q in U)if(!(q in b))throw Error(i(108,A(y)||"Unknown",q));return a({},O,U)}function Or(y){return y=(y=y.stateNode)&&y.__reactInternalMemoizedMergedChildContext||na,Nn=hn.current,cr(hn,y),cr(Gn,Gn.current),!0}function Vn(y,b,O){var U=y.stateNode;if(!U)throw Error(i(169));O?(y=Nr(y,b,Nn),U.__reactInternalMemoizedMergedChildContext=y,Xr(Gn),Xr(hn),cr(hn,y)):Xr(Gn),cr(Gn,O)}var dn=Math.clz32?Math.clz32:Rt,Oe=Math.log,dt=Math.LN2;function Rt(y){return y>>>=0,y===0?32:31-(Oe(y)/dt|0)|0}var Pt=64,mn=4194304;function tt(y){switch(y&-y){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return y&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return y}}function mt(y,b){var O=y.pendingLanes;if(O===0)return 0;var U=0,q=y.suspendedLanes,re=y.pingedLanes,ve=O&268435455;if(ve!==0){var Ve=ve&~q;Ve!==0?U=tt(Ve):(re&=ve,re!==0&&(U=tt(re)))}else ve=O&~q,ve!==0?U=tt(ve):re!==0&&(U=tt(re));if(U===0)return 0;if(b!==0&&b!==U&&(b&q)===0&&(q=U&-U,re=b&-b,q>=re||q===16&&(re&4194240)!==0))return b;if((U&4)!==0&&(U|=O&16),b=y.entangledLanes,b!==0)for(y=y.entanglements,b&=U;0<b;)O=31-dn(b),q=1<<O,U|=y[O],b&=~q;return U}function Xt(y,b){switch(y){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ct(y,b){for(var O=y.suspendedLanes,U=y.pingedLanes,q=y.expirationTimes,re=y.pendingLanes;0<re;){var ve=31-dn(re),Ve=1<<ve,gt=q[ve];gt===-1?((Ve&O)===0||(Ve&U)!==0)&&(q[ve]=Xt(Ve,b)):gt<=b&&(y.expiredLanes|=Ve),re&=~Ve}}function Sr(y){return y=y.pendingLanes&-1073741825,y!==0?y:y&1073741824?1073741824:0}function Ft(){var y=Pt;return Pt<<=1,(Pt&4194240)===0&&(Pt=64),y}function Hr(y){for(var b=[],O=0;31>O;O++)b.push(y);return b}function rn(y,b,O){y.pendingLanes|=b,b!==536870912&&(y.suspendedLanes=0,y.pingedLanes=0),y=y.eventTimes,b=31-dn(b),y[b]=O}function nt(y,b){var O=y.pendingLanes&~b;y.pendingLanes=b,y.suspendedLanes=0,y.pingedLanes=0,y.expiredLanes&=b,y.mutableReadLanes&=b,y.entangledLanes&=b,b=y.entanglements;var U=y.eventTimes;for(y=y.expirationTimes;0<O;){var q=31-dn(O),re=1<<q;b[q]=0,U[q]=-1,y[q]=-1,O&=~re}}function Jt(y,b){var O=y.entangledLanes|=b;for(y=y.entanglements;O;){var U=31-dn(O),q=1<<U;q&b|y[U]&b&&(y[U]|=b),O&=~q}}var Bt=0;function kn(y){return y&=-y,1<y?4<y?(y&268435455)!==0?16:536870912:4:1}var Vr=s.unstable_scheduleCallback,Kr=s.unstable_cancelCallback,Qn=s.unstable_shouldYield,Bn=s.unstable_requestPaint,Jn=s.unstable_now,fo=s.unstable_ImmediatePriority,wc=s.unstable_UserBlockingPriority,z0=s.unstable_NormalPriority,K2=s.unstable_IdlePriority,_c=null,bi=null;function Sd(y){if(bi&&typeof bi.onCommitFiberRoot=="function")try{bi.onCommitFiberRoot(_c,y,void 0,(y.current.flags&128)===128)}catch{}}function W0(y,b){return y===b&&(y!==0||1/y===1/b)||y!==y&&b!==b}var Oo=typeof Object.is=="function"?Object.is:W0,zl=null,kd=!1,Cd=!1;function H0(y){zl===null?zl=[y]:zl.push(y)}function m1(y){kd=!0,H0(y)}function xa(){if(!Cd&&zl!==null){Cd=!0;var y=0,b=Bt;try{var O=zl;for(Bt=1;y<O.length;y++){var U=O[y];do U=U(!0);while(U!==null)}zl=null,kd=!1}catch(q){throw zl!==null&&(zl=zl.slice(y+1)),Vr(fo,xa),q}finally{Bt=b,Cd=!1}}return null}var bc=[],Wl=0,Yf=null,uu=0,Qa=[],Wi=0,Hs=null,Si=1,Do="";function Io(y,b){bc[Wl++]=uu,bc[Wl++]=Yf,Yf=y,uu=b}function p1(y,b,O){Qa[Wi++]=Si,Qa[Wi++]=Do,Qa[Wi++]=Hs,Hs=y;var U=Si;y=Do;var q=32-dn(U)-1;U&=~(1<<q),O+=1;var re=32-dn(b)+q;if(30<re){var ve=q-q%5;re=(U&(1<<ve)-1).toString(32),U>>=ve,q-=ve,Si=1<<32-dn(b)+q|O<<q|U,Do=re+y}else Si=1<<re|O<<q|U,Do=y}function Xf(y){y.return!==null&&(Io(y,1),p1(y,1,0))}function Qf(y){for(;y===Yf;)Yf=bc[--Wl],bc[Wl]=null,uu=bc[--Wl],bc[Wl]=null;for(;y===Hs;)Hs=Qa[--Wi],Qa[Wi]=null,Do=Qa[--Wi],Qa[Wi]=null,Si=Qa[--Wi],Qa[Wi]=null}var ya=null,Ja=null,Kn=!1,Jf=!1,Ro=null;function x1(y,b){var O=Zi(5,null,null,0);O.elementType="DELETED",O.stateNode=b,O.return=y,b=y.deletions,b===null?(y.deletions=[O],y.flags|=16):b.push(O)}function G0(y,b){switch(y.tag){case 5:return b=Et(b,y.type,y.pendingProps),b!==null?(y.stateNode=b,ya=y,Ja=xe(b),!0):!1;case 6:return b=It(b,y.pendingProps),b!==null?(y.stateNode=b,ya=y,Ja=null,!0):!1;case 13:if(b=Kt(b),b!==null){var O=Hs!==null?{id:Si,overflow:Do}:null;return y.memoizedState={dehydrated:b,treeContext:O,retryLane:1073741824},O=Zi(18,null,null,0),O.stateNode=b,O.return=y,y.child=O,ya=y,Ja=null,!0}return!1;default:return!1}}function gp(y){return(y.mode&1)!==0&&(y.flags&128)===0}function mp(y){if(Kn){var b=Ja;if(b){var O=b;if(!G0(y,b)){if(gp(y))throw Error(i(418));b=be(O);var U=ya;b&&G0(y,b)?x1(U,O):(y.flags=y.flags&-4097|2,Kn=!1,ya=y)}}else{if(gp(y))throw Error(i(418));y.flags=y.flags&-4097|2,Kn=!1,ya=y}}}function y1(y){for(y=y.return;y!==null&&y.tag!==5&&y.tag!==3&&y.tag!==13;)y=y.return;ya=y}function V0(y){if(!pe||y!==ya)return!1;if(!Kn)return y1(y),Kn=!0,!1;if(y.tag!==3&&(y.tag!==5||Xe(y.type)&&!Q(y.type,y.memoizedProps))){var b=Ja;if(b){if(gp(y))throw v1(),Error(i(418));for(;b;)x1(y,b),b=be(b)}}if(y1(y),y.tag===13){if(!pe)throw Error(i(316));if(y=y.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));Ja=qe(y)}else Ja=ya?be(y.stateNode):null;return!0}function v1(){for(var y=Ja;y;)y=be(y)}function du(){pe&&(Ja=ya=null,Jf=Kn=!1)}function pp(y){Ro===null?Ro=[y]:Ro.push(y)}var q2=o.ReactCurrentBatchConfig;function K0(y,b){if(Oo(y,b))return!0;if(typeof y!="object"||y===null||typeof b!="object"||b===null)return!1;var O=Object.keys(y),U=Object.keys(b);if(O.length!==U.length)return!1;for(U=0;U<O.length;U++){var q=O[U];if(!kr.call(b,q)||!Oo(y[q],b[q]))return!1}return!0}function Y2(y){switch(y.tag){case 5:return yt(y.type);case 16:return yt("Lazy");case 13:return yt("Suspense");case 19:return yt("SuspenseList");case 0:case 2:case 15:return y=_r(y.type,!1),y;case 11:return y=_r(y.type.render,!1),y;case 1:return y=_r(y.type,!0),y;default:return""}}function fu(y,b,O){if(y=O.ref,y!==null&&typeof y!="function"&&typeof y!="object"){if(O._owner){if(O=O._owner,O){if(O.tag!==1)throw Error(i(309));var U=O.stateNode}if(!U)throw Error(i(147,y));var q=U,re=""+y;return b!==null&&b.ref!==null&&typeof b.ref=="function"&&b.ref._stringRef===re?b.ref:(b=function(ve){var Ve=q.refs;ve===null?delete Ve[re]:Ve[re]=ve},b._stringRef=re,b)}if(typeof y!="string")throw Error(i(284));if(!O._owner)throw Error(i(290,y))}return y}function q0(y,b){throw y=Object.prototype.toString.call(b),Error(i(31,y==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":y))}function w1(y){var b=y._init;return b(y._payload)}function _1(y){function b(ut,Qe){if(y){var vt=ut.deletions;vt===null?(ut.deletions=[Qe],ut.flags|=16):vt.push(Qe)}}function O(ut,Qe){if(!y)return null;for(;Qe!==null;)b(ut,Qe),Qe=Qe.sibling;return null}function U(ut,Qe){for(ut=new Map;Qe!==null;)Qe.key!==null?ut.set(Qe.key,Qe):ut.set(Qe.index,Qe),Qe=Qe.sibling;return ut}function q(ut,Qe){return ut=$c(ut,Qe),ut.index=0,ut.sibling=null,ut}function re(ut,Qe,vt){return ut.index=vt,y?(vt=ut.alternate,vt!==null?(vt=vt.index,vt<Qe?(ut.flags|=2,Qe):vt):(ut.flags|=2,Qe)):(ut.flags|=1048576,Qe)}function ve(ut){return y&&ut.alternate===null&&(ut.flags|=2),ut}function Ve(ut,Qe,vt,ir){return Qe===null||Qe.tag!==6?(Qe=Xd(vt,ut.mode,ir),Qe.return=ut,Qe):(Qe=q(Qe,vt),Qe.return=ut,Qe)}function gt(ut,Qe,vt,ir){var Cr=vt.type;return Cr===d?gr(ut,Qe,vt.props.children,ir,vt.key):Qe!==null&&(Qe.elementType===Cr||typeof Cr=="object"&&Cr!==null&&Cr.$$typeof===_&&w1(Cr)===Qe.type)?(ir=q(Qe,vt.props),ir.ref=fu(ut,Qe,vt),ir.return=ut,ir):(ir=Tg(vt.type,vt.key,vt.props,null,ut.mode,ir),ir.ref=fu(ut,Qe,vt),ir.return=ut,ir)}function Vt(ut,Qe,vt,ir){return Qe===null||Qe.tag!==4||Qe.stateNode.containerInfo!==vt.containerInfo||Qe.stateNode.implementation!==vt.implementation?(Qe=Eg(vt,ut.mode,ir),Qe.return=ut,Qe):(Qe=q(Qe,vt.children||[]),Qe.return=ut,Qe)}function gr(ut,Qe,vt,ir,Cr){return Qe===null||Qe.tag!==7?(Qe=_a(vt,ut.mode,ir,Cr),Qe.return=ut,Qe):(Qe=q(Qe,vt),Qe.return=ut,Qe)}function Ur(ut,Qe,vt){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number")return Qe=Xd(""+Qe,ut.mode,vt),Qe.return=ut,Qe;if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case c:return vt=Tg(Qe.type,Qe.key,Qe.props,null,ut.mode,vt),vt.ref=fu(ut,null,Qe),vt.return=ut,vt;case u:return Qe=Eg(Qe,ut.mode,vt),Qe.return=ut,Qe;case _:var ir=Qe._init;return Ur(ut,ir(Qe._payload),vt)}if(ee(Qe)||P(Qe))return Qe=_a(Qe,ut.mode,vt,null),Qe.return=ut,Qe;q0(ut,Qe)}return null}function ar(ut,Qe,vt,ir){var Cr=Qe!==null?Qe.key:null;if(typeof vt=="string"&&vt!==""||typeof vt=="number")return Cr!==null?null:Ve(ut,Qe,""+vt,ir);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case c:return vt.key===Cr?gt(ut,Qe,vt,ir):null;case u:return vt.key===Cr?Vt(ut,Qe,vt,ir):null;case _:return Cr=vt._init,ar(ut,Qe,Cr(vt._payload),ir)}if(ee(vt)||P(vt))return Cr!==null?null:gr(ut,Qe,vt,ir,null);q0(ut,vt)}return null}function Wn(ut,Qe,vt,ir,Cr){if(typeof ir=="string"&&ir!==""||typeof ir=="number")return ut=ut.get(vt)||null,Ve(Qe,ut,""+ir,Cr);if(typeof ir=="object"&&ir!==null){switch(ir.$$typeof){case c:return ut=ut.get(ir.key===null?vt:ir.key)||null,gt(Qe,ut,ir,Cr);case u:return ut=ut.get(ir.key===null?vt:ir.key)||null,Vt(Qe,ut,ir,Cr);case _:var Qr=ir._init;return Wn(ut,Qe,vt,Qr(ir._payload),Cr)}if(ee(ir)||P(ir))return ut=ut.get(vt)||null,gr(Qe,ut,ir,Cr,null);q0(Qe,ir)}return null}function Tn(ut,Qe,vt,ir){for(var Cr=null,Qr=null,zr=Qe,ln=Qe=0,Ys=null;zr!==null&&ln<vt.length;ln++){zr.index>ln?(Ys=zr,zr=null):Ys=zr.sibling;var an=ar(ut,zr,vt[ln],ir);if(an===null){zr===null&&(zr=Ys);break}y&&zr&&an.alternate===null&&b(ut,zr),Qe=re(an,Qe,ln),Qr===null?Cr=an:Qr.sibling=an,Qr=an,zr=Ys}if(ln===vt.length)return O(ut,zr),Kn&&Io(ut,ln),Cr;if(zr===null){for(;ln<vt.length;ln++)zr=Ur(ut,vt[ln],ir),zr!==null&&(Qe=re(zr,Qe,ln),Qr===null?Cr=zr:Qr.sibling=zr,Qr=zr);return Kn&&Io(ut,ln),Cr}for(zr=U(ut,zr);ln<vt.length;ln++)Ys=Wn(zr,ut,ln,vt[ln],ir),Ys!==null&&(y&&Ys.alternate!==null&&zr.delete(Ys.key===null?ln:Ys.key),Qe=re(Ys,Qe,ln),Qr===null?Cr=Ys:Qr.sibling=Ys,Qr=Ys);return y&&zr.forEach(function(Ma){return b(ut,Ma)}),Kn&&Io(ut,ln),Cr}function si(ut,Qe,vt,ir){var Cr=P(vt);if(typeof Cr!="function")throw Error(i(150));if(vt=Cr.call(vt),vt==null)throw Error(i(151));for(var Qr=Cr=null,zr=Qe,ln=Qe=0,Ys=null,an=vt.next();zr!==null&&!an.done;ln++,an=vt.next()){zr.index>ln?(Ys=zr,zr=null):Ys=zr.sibling;var Ma=ar(ut,zr,an.value,ir);if(Ma===null){zr===null&&(zr=Ys);break}y&&zr&&Ma.alternate===null&&b(ut,zr),Qe=re(Ma,Qe,ln),Qr===null?Cr=Ma:Qr.sibling=Ma,Qr=Ma,zr=Ys}if(an.done)return O(ut,zr),Kn&&Io(ut,ln),Cr;if(zr===null){for(;!an.done;ln++,an=vt.next())an=Ur(ut,an.value,ir),an!==null&&(Qe=re(an,Qe,ln),Qr===null?Cr=an:Qr.sibling=an,Qr=an);return Kn&&Io(ut,ln),Cr}for(zr=U(ut,zr);!an.done;ln++,an=vt.next())an=Wn(zr,ut,ln,an.value,ir),an!==null&&(y&&an.alternate!==null&&zr.delete(an.key===null?ln:an.key),Qe=re(an,Qe,ln),Qr===null?Cr=an:Qr.sibling=an,Qr=an);return y&&zr.forEach(function(eS){return b(ut,eS)}),Kn&&Io(ut,ln),Cr}function dl(ut,Qe,vt,ir){if(typeof vt=="object"&&vt!==null&&vt.type===d&&vt.key===null&&(vt=vt.props.children),typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case c:e:{for(var Cr=vt.key,Qr=Qe;Qr!==null;){if(Qr.key===Cr){if(Cr=vt.type,Cr===d){if(Qr.tag===7){O(ut,Qr.sibling),Qe=q(Qr,vt.props.children),Qe.return=ut,ut=Qe;break e}}else if(Qr.elementType===Cr||typeof Cr=="object"&&Cr!==null&&Cr.$$typeof===_&&w1(Cr)===Qr.type){O(ut,Qr.sibling),Qe=q(Qr,vt.props),Qe.ref=fu(ut,Qr,vt),Qe.return=ut,ut=Qe;break e}O(ut,Qr);break}else b(ut,Qr);Qr=Qr.sibling}vt.type===d?(Qe=_a(vt.props.children,ut.mode,ir,vt.key),Qe.return=ut,ut=Qe):(ir=Tg(vt.type,vt.key,vt.props,null,ut.mode,ir),ir.ref=fu(ut,Qe,vt),ir.return=ut,ut=ir)}return ve(ut);case u:e:{for(Qr=vt.key;Qe!==null;){if(Qe.key===Qr)if(Qe.tag===4&&Qe.stateNode.containerInfo===vt.containerInfo&&Qe.stateNode.implementation===vt.implementation){O(ut,Qe.sibling),Qe=q(Qe,vt.children||[]),Qe.return=ut,ut=Qe;break e}else{O(ut,Qe);break}else b(ut,Qe);Qe=Qe.sibling}Qe=Eg(vt,ut.mode,ir),Qe.return=ut,ut=Qe}return ve(ut);case _:return Qr=vt._init,dl(ut,Qe,Qr(vt._payload),ir)}if(ee(vt))return Tn(ut,Qe,vt,ir);if(P(vt))return si(ut,Qe,vt,ir);q0(ut,vt)}return typeof vt=="string"&&vt!==""||typeof vt=="number"?(vt=""+vt,Qe!==null&&Qe.tag===6?(O(ut,Qe.sibling),Qe=q(Qe,vt),Qe.return=ut,ut=Qe):(O(ut,Qe),Qe=Xd(vt,ut.mode,ir),Qe.return=ut,ut=Qe),ve(ut)):O(ut,Qe)}return dl}var hu=_1(!0),b1=_1(!1),Y0=un(null),X0=null,Td=null,xp=null;function yp(){xp=Td=X0=null}function S1(y,b,O){ce?(cr(Y0,b._currentValue),b._currentValue=O):(cr(Y0,b._currentValue2),b._currentValue2=O)}function Zf(y){var b=Y0.current;Xr(Y0),ce?y._currentValue=b:y._currentValue2=b}function gu(y,b,O){for(;y!==null;){var U=y.alternate;if((y.childLanes&b)!==b?(y.childLanes|=b,U!==null&&(U.childLanes|=b)):U!==null&&(U.childLanes&b)!==b&&(U.childLanes|=b),y===O)break;y=y.return}}function Ed(y,b){X0=y,xp=Td=null,y=y.dependencies,y!==null&&y.firstContext!==null&&((y.lanes&b)!==0&&(Vs=!0),y.firstContext=null)}function Hi(y){var b=ce?y._currentValue:y._currentValue2;if(xp!==y)if(y={context:y,memoizedValue:b,next:null},Td===null){if(X0===null)throw Error(i(308));Td=y,X0.dependencies={lanes:0,firstContext:y}}else Td=Td.next=y;return b}var Sc=null;function Q0(y){Sc===null?Sc=[y]:Sc.push(y)}function vp(y,b,O,U){var q=b.interleaved;return q===null?(O.next=O,Q0(b)):(O.next=q.next,q.next=O),b.interleaved=O,Mo(y,U)}function Mo(y,b){y.lanes|=b;var O=y.alternate;for(O!==null&&(O.lanes|=b),O=y,y=y.return;y!==null;)y.childLanes|=b,O=y.alternate,O!==null&&(O.childLanes|=b),O=y,y=y.return;return O.tag===3?O.stateNode:null}var Gi=!1;function wp(y){y.updateQueue={baseState:y.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function k1(y,b){y=y.updateQueue,b.updateQueue===y&&(b.updateQueue={baseState:y.baseState,firstBaseUpdate:y.firstBaseUpdate,lastBaseUpdate:y.lastBaseUpdate,shared:y.shared,effects:y.effects})}function Hl(y,b){return{eventTime:y,lane:b,tag:0,payload:null,callback:null,next:null}}function Gl(y,b,O){var U=y.updateQueue;if(U===null)return null;if(U=U.shared,(qr&2)!==0){var q=U.pending;return q===null?b.next=b:(b.next=q.next,q.next=b),U.pending=b,Mo(y,O)}return q=U.interleaved,q===null?(b.next=b,Q0(U)):(b.next=q.next,q.next=b),U.interleaved=b,Mo(y,O)}function eh(y,b,O){if(b=b.updateQueue,b!==null&&(b=b.shared,(O&4194240)!==0)){var U=b.lanes;U&=y.pendingLanes,O|=U,b.lanes=O,Jt(y,O)}}function Nd(y,b){var O=y.updateQueue,U=y.alternate;if(U!==null&&(U=U.updateQueue,O===U)){var q=null,re=null;if(O=O.firstBaseUpdate,O!==null){do{var ve={eventTime:O.eventTime,lane:O.lane,tag:O.tag,payload:O.payload,callback:O.callback,next:null};re===null?q=re=ve:re=re.next=ve,O=O.next}while(O!==null);re===null?q=re=b:re=re.next=b}else q=re=b;O={baseState:U.baseState,firstBaseUpdate:q,lastBaseUpdate:re,shared:U.shared,effects:U.effects},y.updateQueue=O;return}y=O.lastBaseUpdate,y===null?O.firstBaseUpdate=b:y.next=b,O.lastBaseUpdate=b}function kc(y,b,O,U){var q=y.updateQueue;Gi=!1;var re=q.firstBaseUpdate,ve=q.lastBaseUpdate,Ve=q.shared.pending;if(Ve!==null){q.shared.pending=null;var gt=Ve,Vt=gt.next;gt.next=null,ve===null?re=Vt:ve.next=Vt,ve=gt;var gr=y.alternate;gr!==null&&(gr=gr.updateQueue,Ve=gr.lastBaseUpdate,Ve!==ve&&(Ve===null?gr.firstBaseUpdate=Vt:Ve.next=Vt,gr.lastBaseUpdate=gt))}if(re!==null){var Ur=q.baseState;ve=0,gr=Vt=gt=null,Ve=re;do{var ar=Ve.lane,Wn=Ve.eventTime;if((U&ar)===ar){gr!==null&&(gr=gr.next={eventTime:Wn,lane:0,tag:Ve.tag,payload:Ve.payload,callback:Ve.callback,next:null});e:{var Tn=y,si=Ve;switch(ar=b,Wn=O,si.tag){case 1:if(Tn=si.payload,typeof Tn=="function"){Ur=Tn.call(Wn,Ur,ar);break e}Ur=Tn;break e;case 3:Tn.flags=Tn.flags&-65537|128;case 0:if(Tn=si.payload,ar=typeof Tn=="function"?Tn.call(Wn,Ur,ar):Tn,ar==null)break e;Ur=a({},Ur,ar);break e;case 2:Gi=!0}}Ve.callback!==null&&Ve.lane!==0&&(y.flags|=64,ar=q.effects,ar===null?q.effects=[Ve]:ar.push(Ve))}else Wn={eventTime:Wn,lane:ar,tag:Ve.tag,payload:Ve.payload,callback:Ve.callback,next:null},gr===null?(Vt=gr=Wn,gt=Ur):gr=gr.next=Wn,ve|=ar;if(Ve=Ve.next,Ve===null){if(Ve=q.shared.pending,Ve===null)break;ar=Ve,Ve=ar.next,ar.next=null,q.lastBaseUpdate=ar,q.shared.pending=null}}while(!0);if(gr===null&&(gt=Ur),q.baseState=gt,q.firstBaseUpdate=Vt,q.lastBaseUpdate=gr,b=q.shared.interleaved,b!==null){q=b;do ve|=q.lane,q=q.next;while(q!==b)}else re===null&&(q.shared.lanes=0);Xl|=ve,y.lanes=ve,y.memoizedState=Ur}}function C1(y,b,O){if(y=b.effects,b.effects=null,y!==null)for(b=0;b<y.length;b++){var U=y[b],q=U.callback;if(q!==null){if(U.callback=null,U=O,typeof q!="function")throw Error(i(191,q));q.call(U)}}}var Cc={},ho=un(Cc),Ad=un(Cc),Tc=un(Cc);function go(y){if(y===Cc)throw Error(i(174));return y}function J0(y,b){cr(Tc,b),cr(Ad,y),cr(ho,Cc),y=L(b),Xr(ho),cr(ho,y)}function mu(){Xr(ho),Xr(Ad),Xr(Tc)}function _p(y){var b=go(Tc.current),O=go(ho.current);b=V(O,y.type,b),O!==b&&(cr(Ad,y),cr(ho,b))}function bp(y){Ad.current===y&&(Xr(ho),Xr(Ad))}var ns=un(0);function Z0(y){for(var b=y;b!==null;){if(b.tag===13){var O=b.memoizedState;if(O!==null&&(O=O.dehydrated,O===null||wr(O)||lr(O)))return b}else if(b.tag===19&&b.memoizedProps.revealOrder!==void 0){if((b.flags&128)!==0)return b}else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===y)break;for(;b.sibling===null;){if(b.return===null||b.return===y)return null;b=b.return}b.sibling.return=b.return,b=b.sibling}return null}var Sp=[];function kp(){for(var y=0;y<Sp.length;y++){var b=Sp[y];ce?b._workInProgressVersionPrimary=null:b._workInProgressVersionSecondary=null}Sp.length=0}var ki=o.ReactCurrentDispatcher,pu=o.ReactCurrentBatchConfig,Ec=0,Zn=null,Ts=null,Gs=null,jd=!1,th=!1,rh=0,Pd=0;function sa(){throw Error(i(321))}function xu(y,b){if(b===null)return!1;for(var O=0;O<b.length&&O<y.length;O++)if(!Oo(y[O],b[O]))return!1;return!0}function nh(y,b,O,U,q,re){if(Ec=re,Zn=b,b.memoizedState=null,b.updateQueue=null,b.lanes=0,ki.current=y===null||y.memoizedState===null?Dp:Ip,y=O(U,q),th){re=0;do{if(th=!1,rh=0,25<=re)throw Error(i(301));re+=1,Gs=Ts=null,b.updateQueue=null,ki.current=Rp,y=O(U,q)}while(th)}if(ki.current=bu,b=Ts!==null&&Ts.next!==null,Ec=0,Gs=Ts=Zn=null,jd=!1,b)throw Error(i(300));return y}function eg(){var y=rh!==0;return rh=0,y}function Vi(){var y={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gs===null?Zn.memoizedState=Gs=y:Gs=Gs.next=y,Gs}function va(){if(Ts===null){var y=Zn.alternate;y=y!==null?y.memoizedState:null}else y=Ts.next;var b=Gs===null?Zn.memoizedState:Gs.next;if(b!==null)Gs=b,Ts=y;else{if(y===null)throw Error(i(310));Ts=y,y={memoizedState:Ts.memoizedState,baseState:Ts.baseState,baseQueue:Ts.baseQueue,queue:Ts.queue,next:null},Gs===null?Zn.memoizedState=Gs=y:Gs=Gs.next=y}return Gs}function yu(y,b){return typeof b=="function"?b(y):b}function tg(y){var b=va(),O=b.queue;if(O===null)throw Error(i(311));O.lastRenderedReducer=y;var U=Ts,q=U.baseQueue,re=O.pending;if(re!==null){if(q!==null){var ve=q.next;q.next=re.next,re.next=ve}U.baseQueue=q=re,O.pending=null}if(q!==null){re=q.next,U=U.baseState;var Ve=ve=null,gt=null,Vt=re;do{var gr=Vt.lane;if((Ec&gr)===gr)gt!==null&&(gt=gt.next={lane:0,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null}),U=Vt.hasEagerState?Vt.eagerState:y(U,Vt.action);else{var Ur={lane:gr,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null};gt===null?(Ve=gt=Ur,ve=U):gt=gt.next=Ur,Zn.lanes|=gr,Xl|=gr}Vt=Vt.next}while(Vt!==null&&Vt!==re);gt===null?ve=U:gt.next=Ve,Oo(U,b.memoizedState)||(Vs=!0),b.memoizedState=U,b.baseState=ve,b.baseQueue=gt,O.lastRenderedState=U}if(y=O.interleaved,y!==null){q=y;do re=q.lane,Zn.lanes|=re,Xl|=re,q=q.next;while(q!==y)}else q===null&&(O.lanes=0);return[b.memoizedState,O.dispatch]}function Fd(y){var b=va(),O=b.queue;if(O===null)throw Error(i(311));O.lastRenderedReducer=y;var U=O.dispatch,q=O.pending,re=b.memoizedState;if(q!==null){O.pending=null;var ve=q=q.next;do re=y(re,ve.action),ve=ve.next;while(ve!==q);Oo(re,b.memoizedState)||(Vs=!0),b.memoizedState=re,b.baseQueue===null&&(b.baseState=re),O.lastRenderedState=re}return[re,U]}function Cp(){}function Tp(y,b){var O=Zn,U=va(),q=b(),re=!Oo(U.memoizedState,q);if(re&&(U.memoizedState=q,Vs=!0),U=U.queue,sg(Ap.bind(null,O,U,y),[y]),U.getSnapshot!==b||re||Gs!==null&&Gs.memoizedState.tag&1){if(O.flags|=2048,vu(9,Np.bind(null,O,U,q,b),void 0,null),Fn===null)throw Error(i(349));(Ec&30)!==0||Ep(O,b,q)}return q}function Ep(y,b,O){y.flags|=16384,y={getSnapshot:b,value:O},b=Zn.updateQueue,b===null?(b={lastEffect:null,stores:null},Zn.updateQueue=b,b.stores=[y]):(O=b.stores,O===null?b.stores=[y]:O.push(y))}function Np(y,b,O,U){b.value=O,b.getSnapshot=U,jp(b)&&Vl(y)}function Ap(y,b,O){return O(function(){jp(b)&&Vl(y)})}function jp(y){var b=y.getSnapshot;y=y.value;try{var O=b();return!Oo(y,O)}catch{return!0}}function Vl(y){var b=Mo(y,1);b!==null&&Ia(b,y,1,-1)}function rg(y){var b=Vi();return typeof y=="function"&&(y=y()),b.memoizedState=b.baseState=y,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yu,lastRenderedState:y},b.queue=y,y=y.dispatch=X2.bind(null,Zn,y),[b.memoizedState,y]}function vu(y,b,O,U){return y={tag:y,create:b,destroy:O,deps:U,next:null},b=Zn.updateQueue,b===null?(b={lastEffect:null,stores:null},Zn.updateQueue=b,b.lastEffect=y.next=y):(O=b.lastEffect,O===null?b.lastEffect=y.next=y:(U=O.next,O.next=y,y.next=U,b.lastEffect=y)),y}function T1(){return va().memoizedState}function ng(y,b,O,U){var q=Vi();Zn.flags|=y,q.memoizedState=vu(1|b,O,void 0,U===void 0?null:U)}function Nc(y,b,O,U){var q=va();U=U===void 0?null:U;var re=void 0;if(Ts!==null){var ve=Ts.memoizedState;if(re=ve.destroy,U!==null&&xu(U,ve.deps)){q.memoizedState=vu(b,O,re,U);return}}Zn.flags|=y,q.memoizedState=vu(1|b,O,re,U)}function E1(y,b){return ng(8390656,8,y,b)}function sg(y,b){return Nc(2048,8,y,b)}function Pp(y,b){return Nc(4,2,y,b)}function $n(y,b){return Nc(4,4,y,b)}function ag(y,b){if(typeof b=="function")return y=y(),b(y),function(){b(null)};if(b!=null)return y=y(),b.current=y,function(){b.current=null}}function sh(y,b,O){return O=O!=null?O.concat([y]):null,Nc(4,4,ag.bind(null,b,y),O)}function wu(){}function Fp(y,b){var O=va();b=b===void 0?null:b;var U=O.memoizedState;return U!==null&&b!==null&&xu(b,U[1])?U[0]:(O.memoizedState=[y,b],y)}function ig(y,b){var O=va();b=b===void 0?null:b;var U=O.memoizedState;return U!==null&&b!==null&&xu(b,U[1])?U[0]:(y=y(),O.memoizedState=[y,b],y)}function Od(y,b,O){return(Ec&21)===0?(y.baseState&&(y.baseState=!1,Vs=!0),y.memoizedState=O):(Oo(O,b)||(O=Ft(),Zn.lanes|=O,Xl|=O,y.baseState=!0),b)}function og(y,b){var O=Bt;Bt=O!==0&&4>O?O:4,y(!0);var U=pu.transition;pu.transition={};try{y(!1),b()}finally{Bt=O,pu.transition=U}}function _u(){return va().memoizedState}function N1(y,b,O){var U=qs(y);if(O={lane:U,action:O,hasEagerState:!1,eagerState:null,next:null},A1(y))Op(b,O);else if(O=vp(y,b,O,U),O!==null){var q=qn();Ia(O,y,U,q),ah(O,b,U)}}function X2(y,b,O){var U=qs(y),q={lane:U,action:O,hasEagerState:!1,eagerState:null,next:null};if(A1(y))Op(b,q);else{var re=y.alternate;if(y.lanes===0&&(re===null||re.lanes===0)&&(re=b.lastRenderedReducer,re!==null))try{var ve=b.lastRenderedState,Ve=re(ve,O);if(q.hasEagerState=!0,q.eagerState=Ve,Oo(Ve,ve)){var gt=b.interleaved;gt===null?(q.next=q,Q0(b)):(q.next=gt.next,gt.next=q),b.interleaved=q;return}}catch{}finally{}O=vp(y,b,q,U),O!==null&&(q=qn(),Ia(O,y,U,q),ah(O,b,U))}}function A1(y){var b=y.alternate;return y===Zn||b!==null&&b===Zn}function Op(y,b){th=jd=!0;var O=y.pending;O===null?b.next=b:(b.next=O.next,O.next=b),y.pending=b}function ah(y,b,O){if((O&4194240)!==0){var U=b.lanes;U&=y.pendingLanes,O|=U,b.lanes=O,Jt(y,O)}}var bu={readContext:Hi,useCallback:sa,useContext:sa,useEffect:sa,useImperativeHandle:sa,useInsertionEffect:sa,useLayoutEffect:sa,useMemo:sa,useReducer:sa,useRef:sa,useState:sa,useDebugValue:sa,useDeferredValue:sa,useTransition:sa,useMutableSource:sa,useSyncExternalStore:sa,useId:sa,unstable_isNewReconciler:!1},Dp={readContext:Hi,useCallback:function(y,b){return Vi().memoizedState=[y,b===void 0?null:b],y},useContext:Hi,useEffect:E1,useImperativeHandle:function(y,b,O){return O=O!=null?O.concat([y]):null,ng(4194308,4,ag.bind(null,b,y),O)},useLayoutEffect:function(y,b){return ng(4194308,4,y,b)},useInsertionEffect:function(y,b){return ng(4,2,y,b)},useMemo:function(y,b){var O=Vi();return b=b===void 0?null:b,y=y(),O.memoizedState=[y,b],y},useReducer:function(y,b,O){var U=Vi();return b=O!==void 0?O(b):b,U.memoizedState=U.baseState=b,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:y,lastRenderedState:b},U.queue=y,y=y.dispatch=N1.bind(null,Zn,y),[U.memoizedState,y]},useRef:function(y){var b=Vi();return y={current:y},b.memoizedState=y},useState:rg,useDebugValue:wu,useDeferredValue:function(y){return Vi().memoizedState=y},useTransition:function(){var y=rg(!1),b=y[0];return y=og.bind(null,y[1]),Vi().memoizedState=y,[b,y]},useMutableSource:function(){},useSyncExternalStore:function(y,b,O){var U=Zn,q=Vi();if(Kn){if(O===void 0)throw Error(i(407));O=O()}else{if(O=b(),Fn===null)throw Error(i(349));(Ec&30)!==0||Ep(U,b,O)}q.memoizedState=O;var re={value:O,getSnapshot:b};return q.queue=re,E1(Ap.bind(null,U,re,y),[y]),U.flags|=2048,vu(9,Np.bind(null,U,re,O,b),void 0,null),O},useId:function(){var y=Vi(),b=Fn.identifierPrefix;if(Kn){var O=Do,U=Si;O=(U&~(1<<32-dn(U)-1)).toString(32)+O,b=":"+b+"R"+O,O=rh++,0<O&&(b+="H"+O.toString(32)),b+=":"}else O=Pd++,b=":"+b+"r"+O.toString(32)+":";return y.memoizedState=b},unstable_isNewReconciler:!1},Ip={readContext:Hi,useCallback:Fp,useContext:Hi,useEffect:sg,useImperativeHandle:sh,useInsertionEffect:Pp,useLayoutEffect:$n,useMemo:ig,useReducer:tg,useRef:T1,useState:function(){return tg(yu)},useDebugValue:wu,useDeferredValue:function(y){var b=va();return Od(b,Ts.memoizedState,y)},useTransition:function(){var y=tg(yu)[0],b=va().memoizedState;return[y,b]},useMutableSource:Cp,useSyncExternalStore:Tp,useId:_u,unstable_isNewReconciler:!1},Rp={readContext:Hi,useCallback:Fp,useContext:Hi,useEffect:sg,useImperativeHandle:sh,useInsertionEffect:Pp,useLayoutEffect:$n,useMemo:ig,useReducer:Fd,useRef:T1,useState:function(){return Fd(yu)},useDebugValue:wu,useDeferredValue:function(y){var b=va();return Ts===null?b.memoizedState=y:Od(b,Ts.memoizedState,y)},useTransition:function(){var y=Fd(yu)[0],b=va().memoizedState;return[y,b]},useMutableSource:Cp,useSyncExternalStore:Tp,useId:_u,unstable_isNewReconciler:!1};function Ki(y,b){if(y&&y.defaultProps){b=a({},b),y=y.defaultProps;for(var O in y)b[O]===void 0&&(b[O]=y[O]);return b}return b}function Mp(y,b,O,U){b=y.memoizedState,O=O(U,b),O=O==null?b:a({},b,O),y.memoizedState=O,y.lanes===0&&(y.updateQueue.baseState=O)}var ih={isMounted:function(y){return(y=y._reactInternals)?j(y)===y:!1},enqueueSetState:function(y,b,O){y=y._reactInternals;var U=qn(),q=qs(y),re=Hl(U,q);re.payload=b,O!=null&&(re.callback=O),b=Gl(y,re,q),b!==null&&(Ia(b,y,q,U),eh(b,y,q))},enqueueReplaceState:function(y,b,O){y=y._reactInternals;var U=qn(),q=qs(y),re=Hl(U,q);re.tag=1,re.payload=b,O!=null&&(re.callback=O),b=Gl(y,re,q),b!==null&&(Ia(b,y,q,U),eh(b,y,q))},enqueueForceUpdate:function(y,b){y=y._reactInternals;var O=qn(),U=qs(y),q=Hl(O,U);q.tag=2,b!=null&&(q.callback=b),b=Gl(y,q,U),b!==null&&(Ia(b,y,U,O),eh(b,y,U))}};function j1(y,b,O,U,q,re,ve){return y=y.stateNode,typeof y.shouldComponentUpdate=="function"?y.shouldComponentUpdate(U,re,ve):b.prototype&&b.prototype.isPureReactComponent?!K0(O,U)||!K0(q,re):!0}function P1(y,b,O){var U=!1,q=na,re=b.contextType;return typeof re=="object"&&re!==null?re=Hi(re):(q=Sn(b)?Nn:hn.current,U=b.contextTypes,re=(U=U!=null)?Ws(y,q):na),b=new b(O,re),y.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=ih,y.stateNode=b,b._reactInternals=y,U&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=q,y.__reactInternalMemoizedMaskedChildContext=re),b}function lg(y,b,O,U){y=b.state,typeof b.componentWillReceiveProps=="function"&&b.componentWillReceiveProps(O,U),typeof b.UNSAFE_componentWillReceiveProps=="function"&&b.UNSAFE_componentWillReceiveProps(O,U),b.state!==y&&ih.enqueueReplaceState(b,b.state,null)}function nl(y,b,O,U){var q=y.stateNode;q.props=O,q.state=y.memoizedState,q.refs={},wp(y);var re=b.contextType;typeof re=="object"&&re!==null?q.context=Hi(re):(re=Sn(b)?Nn:hn.current,q.context=Ws(y,re)),q.state=y.memoizedState,re=b.getDerivedStateFromProps,typeof re=="function"&&(Mp(y,b,re,O),q.state=y.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(b=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),b!==q.state&&ih.enqueueReplaceState(q,q.state,null),kc(y,O,q,U),q.state=y.memoizedState),typeof q.componentDidMount=="function"&&(y.flags|=4194308)}function Su(y,b){try{var O="",U=b;do O+=Y2(U),U=U.return;while(U);var q=O}catch(re){q=`
Error generating stack: `+re.message+`
`+re.stack}return{value:y,source:b,stack:q,digest:null}}function Ac(y,b,O){return{value:y,source:null,stack:O??null,digest:b??null}}function mo(y,b){try{console.error(b.value)}catch(O){setTimeout(function(){throw O})}}var oh=typeof WeakMap=="function"?WeakMap:Map;function sl(y,b,O){O=Hl(-1,O),O.tag=3,O.payload={element:null};var U=b.value;return O.callback=function(){gs||(gs=!0,Es=U),mo(y,b)},O}function cg(y,b,O){O=Hl(-1,O),O.tag=3;var U=y.type.getDerivedStateFromError;if(typeof U=="function"){var q=b.value;O.payload=function(){return U(q)},O.callback=function(){mo(y,b)}}var re=y.stateNode;return re!==null&&typeof re.componentDidCatch=="function"&&(O.callback=function(){mo(y,b),typeof U!="function"&&(Bo===null?Bo=new Set([this]):Bo.add(this));var ve=b.stack;this.componentDidCatch(b.value,{componentStack:ve!==null?ve:""})}),O}function F1(y,b,O){var U=y.pingCache;if(U===null){U=y.pingCache=new oh;var q=new Set;U.set(b,q)}else q=U.get(b),q===void 0&&(q=new Set,U.set(b,q));q.has(O)||(q.add(O),y=$1.bind(null,y,b,O),b.then(y,y))}function O1(y){do{var b;if((b=y.tag===13)&&(b=y.memoizedState,b=b!==null?b.dehydrated!==null:!0),b)return y;y=y.return}while(y!==null);return null}function jc(y,b,O,U,q){return(y.mode&1)===0?(y===b?y.flags|=65536:(y.flags|=128,O.flags|=131072,O.flags&=-52805,O.tag===1&&(O.alternate===null?O.tag=17:(b=Hl(-1,1),b.tag=2,Gl(O,b,1))),O.lanes|=1),y):(y.flags|=65536,y.lanes=q,y)}var lh=o.ReactCurrentOwner,Vs=!1;function aa(y,b,O,U){b.child=y===null?b1(b,null,O,U):hu(b,y.child,O,U)}function ug(y,b,O,U,q){O=O.render;var re=b.ref;return Ed(b,q),U=nh(y,b,O,U,re,q),O=eg(),y!==null&&!Vs?(b.updateQueue=y.updateQueue,b.flags&=-2053,y.lanes&=~q,ql(y,b,q)):(Kn&&O&&Xf(b),b.flags|=1,aa(y,b,U,q),b.child)}function ku(y,b,O,U,q){if(y===null){var re=O.type;return typeof re=="function"&&!qd(re)&&re.defaultProps===void 0&&O.compare===null&&O.defaultProps===void 0?(b.tag=15,b.type=re,Kl(y,b,re,U,q)):(y=Tg(O.type,null,U,b,b.mode,q),y.ref=b.ref,y.return=b,b.child=y)}if(re=y.child,(y.lanes&q)===0){var ve=re.memoizedProps;if(O=O.compare,O=O!==null?O:K0,O(ve,U)&&y.ref===b.ref)return ql(y,b,q)}return b.flags|=1,y=$c(re,U),y.ref=b.ref,y.return=b,b.child=y}function Kl(y,b,O,U,q){if(y!==null){var re=y.memoizedProps;if(K0(re,U)&&y.ref===b.ref)if(Vs=!1,b.pendingProps=U=re,(y.lanes&q)!==0)(y.flags&131072)!==0&&(Vs=!0);else return b.lanes=y.lanes,ql(y,b,q)}return al(y,b,O,U,q)}function Un(y,b,O){var U=b.pendingProps,q=U.children,re=y!==null?y.memoizedState:null;if(U.mode==="hidden")if((b.mode&1)===0)b.memoizedState={baseLanes:0,cachePool:null,transitions:null},cr(Rc,Ks),Ks|=O;else{if((O&1073741824)===0)return y=re!==null?re.baseLanes|O:O,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:y,cachePool:null,transitions:null},b.updateQueue=null,cr(Rc,Ks),Ks|=y,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null},U=re!==null?re.baseLanes:O,cr(Rc,Ks),Ks|=U}else re!==null?(U=re.baseLanes|O,b.memoizedState=null):U=O,cr(Rc,Ks),Ks|=U;return aa(y,b,q,O),b.child}function Pn(y,b){var O=b.ref;(y===null&&O!==null||y!==null&&y.ref!==O)&&(b.flags|=512,b.flags|=2097152)}function al(y,b,O,U,q){var re=Sn(O)?Nn:hn.current;return re=Ws(b,re),Ed(b,q),O=nh(y,b,O,U,re,q),U=eg(),y!==null&&!Vs?(b.updateQueue=y.updateQueue,b.flags&=-2053,y.lanes&=~q,ql(y,b,q)):(Kn&&U&&Xf(b),b.flags|=1,aa(y,b,O,q),b.child)}function wa(y,b,O,U,q){if(Sn(O)){var re=!0;Or(b)}else re=!1;if(Ed(b,q),b.stateNode===null)ch(y,b),P1(b,O,U),nl(b,O,U,q),U=!0;else if(y===null){var ve=b.stateNode,Ve=b.memoizedProps;ve.props=Ve;var gt=ve.context,Vt=O.contextType;typeof Vt=="object"&&Vt!==null?Vt=Hi(Vt):(Vt=Sn(O)?Nn:hn.current,Vt=Ws(b,Vt));var gr=O.getDerivedStateFromProps,Ur=typeof gr=="function"||typeof ve.getSnapshotBeforeUpdate=="function";Ur||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(Ve!==U||gt!==Vt)&&lg(b,ve,U,Vt),Gi=!1;var ar=b.memoizedState;ve.state=ar,kc(b,U,ve,q),gt=b.memoizedState,Ve!==U||ar!==gt||Gn.current||Gi?(typeof gr=="function"&&(Mp(b,O,gr,U),gt=b.memoizedState),(Ve=Gi||j1(b,O,Ve,U,ar,gt,Vt))?(Ur||typeof ve.UNSAFE_componentWillMount!="function"&&typeof ve.componentWillMount!="function"||(typeof ve.componentWillMount=="function"&&ve.componentWillMount(),typeof ve.UNSAFE_componentWillMount=="function"&&ve.UNSAFE_componentWillMount()),typeof ve.componentDidMount=="function"&&(b.flags|=4194308)):(typeof ve.componentDidMount=="function"&&(b.flags|=4194308),b.memoizedProps=U,b.memoizedState=gt),ve.props=U,ve.state=gt,ve.context=Vt,U=Ve):(typeof ve.componentDidMount=="function"&&(b.flags|=4194308),U=!1)}else{ve=b.stateNode,k1(y,b),Ve=b.memoizedProps,Vt=b.type===b.elementType?Ve:Ki(b.type,Ve),ve.props=Vt,Ur=b.pendingProps,ar=ve.context,gt=O.contextType,typeof gt=="object"&&gt!==null?gt=Hi(gt):(gt=Sn(O)?Nn:hn.current,gt=Ws(b,gt));var Wn=O.getDerivedStateFromProps;(gr=typeof Wn=="function"||typeof ve.getSnapshotBeforeUpdate=="function")||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(Ve!==Ur||ar!==gt)&&lg(b,ve,U,gt),Gi=!1,ar=b.memoizedState,ve.state=ar,kc(b,U,ve,q);var Tn=b.memoizedState;Ve!==Ur||ar!==Tn||Gn.current||Gi?(typeof Wn=="function"&&(Mp(b,O,Wn,U),Tn=b.memoizedState),(Vt=Gi||j1(b,O,Vt,U,ar,Tn,gt)||!1)?(gr||typeof ve.UNSAFE_componentWillUpdate!="function"&&typeof ve.componentWillUpdate!="function"||(typeof ve.componentWillUpdate=="function"&&ve.componentWillUpdate(U,Tn,gt),typeof ve.UNSAFE_componentWillUpdate=="function"&&ve.UNSAFE_componentWillUpdate(U,Tn,gt)),typeof ve.componentDidUpdate=="function"&&(b.flags|=4),typeof ve.getSnapshotBeforeUpdate=="function"&&(b.flags|=1024)):(typeof ve.componentDidUpdate!="function"||Ve===y.memoizedProps&&ar===y.memoizedState||(b.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||Ve===y.memoizedProps&&ar===y.memoizedState||(b.flags|=1024),b.memoizedProps=U,b.memoizedState=Tn),ve.props=U,ve.state=Tn,ve.context=gt,U=Vt):(typeof ve.componentDidUpdate!="function"||Ve===y.memoizedProps&&ar===y.memoizedState||(b.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||Ve===y.memoizedProps&&ar===y.memoizedState||(b.flags|=1024),U=!1)}return Fa(y,b,O,U,re,q)}function Fa(y,b,O,U,q,re){Pn(y,b);var ve=(b.flags&128)!==0;if(!U&&!ve)return q&&Vn(b,O,!1),ql(y,b,re);U=b.stateNode,lh.current=b;var Ve=ve&&typeof O.getDerivedStateFromError!="function"?null:U.render();return b.flags|=1,y!==null&&ve?(b.child=hu(b,y.child,null,re),b.child=hu(b,null,Ve,re)):aa(y,b,Ve,re),b.memoizedState=U.state,q&&Vn(b,O,!0),b.child}function Pc(y){var b=y.stateNode;b.pendingContext?wt(y,b.pendingContext,b.pendingContext!==b.context):b.context&&wt(y,b.context,!1),J0(y,b.containerInfo)}function Cu(y,b,O,U,q){return du(),pp(q),b.flags|=256,aa(y,b,O,U),b.child}var Oa={dehydrated:null,treeContext:null,retryLane:0};function Dd(y){return{baseLanes:y,cachePool:null,transitions:null}}function Lp(y,b,O){var U=b.pendingProps,q=ns.current,re=!1,ve=(b.flags&128)!==0,Ve;if((Ve=ve)||(Ve=y!==null&&y.memoizedState===null?!1:(q&2)!==0),Ve?(re=!0,b.flags&=-129):(y===null||y.memoizedState!==null)&&(q|=1),cr(ns,q&1),y===null)return mp(b),y=b.memoizedState,y!==null&&(y=y.dehydrated,y!==null)?((b.mode&1)===0?b.lanes=1:lr(y)?b.lanes=8:b.lanes=1073741824,null):(ve=U.children,y=U.fallback,re?(U=b.mode,re=b.child,ve={mode:"hidden",children:ve},(U&1)===0&&re!==null?(re.childLanes=0,re.pendingProps=ve):re=Yd(ve,U,0,null),y=_a(y,U,O,null),re.return=b,y.return=b,re.sibling=y,b.child=re,b.child.memoizedState=Dd(O),b.memoizedState=Oa,y):dg(b,ve));if(q=y.memoizedState,q!==null&&(Ve=q.dehydrated,Ve!==null))return D1(y,b,ve,U,Ve,q,O);if(re){re=U.fallback,ve=b.mode,q=y.child,Ve=q.sibling;var gt={mode:"hidden",children:U.children};return(ve&1)===0&&b.child!==q?(U=b.child,U.childLanes=0,U.pendingProps=gt,b.deletions=null):(U=$c(q,gt),U.subtreeFlags=q.subtreeFlags&14680064),Ve!==null?re=$c(Ve,re):(re=_a(re,ve,O,null),re.flags|=2),re.return=b,U.return=b,U.sibling=re,b.child=U,U=re,re=b.child,ve=y.child.memoizedState,ve=ve===null?Dd(O):{baseLanes:ve.baseLanes|O,cachePool:null,transitions:ve.transitions},re.memoizedState=ve,re.childLanes=y.childLanes&~O,b.memoizedState=Oa,U}return re=y.child,y=re.sibling,U=$c(re,{mode:"visible",children:U.children}),(b.mode&1)===0&&(U.lanes=O),U.return=b,U.sibling=null,y!==null&&(O=b.deletions,O===null?(b.deletions=[y],b.flags|=16):O.push(y)),b.child=U,b.memoizedState=null,U}function dg(y,b){return b=Yd({mode:"visible",children:b},y.mode,0,null),b.return=y,y.child=b}function Tu(y,b,O,U){return U!==null&&pp(U),hu(b,y.child,null,O),y=dg(b,b.pendingProps.children),y.flags|=2,b.memoizedState=null,y}function D1(y,b,O,U,q,re,ve){if(O)return b.flags&256?(b.flags&=-257,U=Ac(Error(i(422))),Tu(y,b,ve,U)):b.memoizedState!==null?(b.child=y.child,b.flags|=128,null):(re=U.fallback,q=b.mode,U=Yd({mode:"visible",children:U.children},q,0,null),re=_a(re,q,ve,null),re.flags|=2,U.return=b,re.return=b,U.sibling=re,b.child=U,(b.mode&1)!==0&&hu(b,y.child,null,ve),b.child.memoizedState=Dd(ve),b.memoizedState=Oa,re);if((b.mode&1)===0)return Tu(y,b,ve,null);if(lr(q))return U=Fr(q).digest,re=Error(i(419)),U=Ac(re,U,void 0),Tu(y,b,ve,U);if(O=(ve&y.childLanes)!==0,Vs||O){if(U=Fn,U!==null){switch(ve&-ve){case 4:q=2;break;case 16:q=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:q=32;break;case 536870912:q=268435456;break;default:q=0}q=(q&(U.suspendedLanes|ve))!==0?0:q,q!==0&&q!==re.retryLane&&(re.retryLane=q,Mo(y,q),Ia(U,y,q,-1))}return Kd(),U=Ac(Error(i(421))),Tu(y,b,ve,U)}return wr(q)?(b.flags|=128,b.child=y.child,b=z1.bind(null,y),ue(q,b),null):(y=re.treeContext,pe&&(Ja=we(q),ya=b,Kn=!0,Ro=null,Jf=!1,y!==null&&(Qa[Wi++]=Si,Qa[Wi++]=Do,Qa[Wi++]=Hs,Si=y.id,Do=y.overflow,Hs=b)),b=dg(b,U.children),b.flags|=4096,b)}function il(y,b,O){y.lanes|=b;var U=y.alternate;U!==null&&(U.lanes|=b),gu(y.return,b,O)}function Id(y,b,O,U,q){var re=y.memoizedState;re===null?y.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:U,tail:O,tailMode:q}:(re.isBackwards=b,re.rendering=null,re.renderingStartTime=0,re.last=U,re.tail=O,re.tailMode=q)}function fg(y,b,O){var U=b.pendingProps,q=U.revealOrder,re=U.tail;if(aa(y,b,U.children,O),U=ns.current,(U&2)!==0)U=U&1|2,b.flags|=128;else{if(y!==null&&(y.flags&128)!==0)e:for(y=b.child;y!==null;){if(y.tag===13)y.memoizedState!==null&&il(y,O,b);else if(y.tag===19)il(y,O,b);else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===b)break e;for(;y.sibling===null;){if(y.return===null||y.return===b)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}U&=1}if(cr(ns,U),(b.mode&1)===0)b.memoizedState=null;else switch(q){case"forwards":for(O=b.child,q=null;O!==null;)y=O.alternate,y!==null&&Z0(y)===null&&(q=O),O=O.sibling;O=q,O===null?(q=b.child,b.child=null):(q=O.sibling,O.sibling=null),Id(b,!1,q,O,re);break;case"backwards":for(O=null,q=b.child,b.child=null;q!==null;){if(y=q.alternate,y!==null&&Z0(y)===null){b.child=q;break}y=q.sibling,q.sibling=O,O=q,q=y}Id(b,!0,O,null,re);break;case"together":Id(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}function ch(y,b){(b.mode&1)===0&&y!==null&&(y.alternate=null,b.alternate=null,b.flags|=2)}function ql(y,b,O){if(y!==null&&(b.dependencies=y.dependencies),Xl|=b.lanes,(O&b.childLanes)===0)return null;if(y!==null&&b.child!==y.child)throw Error(i(153));if(b.child!==null){for(y=b.child,O=$c(y,y.pendingProps),b.child=O,O.return=b;y.sibling!==null;)y=y.sibling,O=O.sibling=$c(y,y.pendingProps),O.return=b;O.sibling=null}return b.child}function Fc(y,b,O){switch(b.tag){case 3:Pc(b),du();break;case 5:_p(b);break;case 1:Sn(b.type)&&Or(b);break;case 4:J0(b,b.stateNode.containerInfo);break;case 10:S1(b,b.type._context,b.memoizedProps.value);break;case 13:var U=b.memoizedState;if(U!==null)return U.dehydrated!==null?(cr(ns,ns.current&1),b.flags|=128,null):(O&b.child.childLanes)!==0?Lp(y,b,O):(cr(ns,ns.current&1),y=ql(y,b,O),y!==null?y.sibling:null);cr(ns,ns.current&1);break;case 19:if(U=(O&b.childLanes)!==0,(y.flags&128)!==0){if(U)return fg(y,b,O);b.flags|=128}var q=b.memoizedState;if(q!==null&&(q.rendering=null,q.tail=null,q.lastEffect=null),cr(ns,ns.current),U)break;return null;case 22:case 23:return b.lanes=0,Un(y,b,O)}return ql(y,b,O)}function Za(y){y.flags|=4}function Eu(y,b){if(y!==null&&y.child===b.child)return!0;if((b.flags&16)!==0)return!1;for(y=b.child;y!==null;){if((y.flags&12854)!==0||(y.subtreeFlags&12854)!==0)return!1;y=y.sibling}return!0}var Oc,Dc,ei,ti;if(_e)Oc=function(y,b){for(var O=b.child;O!==null;){if(O.tag===5||O.tag===6)R(y,O.stateNode);else if(O.tag!==4&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===b)break;for(;O.sibling===null;){if(O.return===null||O.return===b)return;O=O.return}O.sibling.return=O.return,O=O.sibling}},Dc=function(){},ei=function(y,b,O,U,q){if(y=y.memoizedProps,y!==U){var re=b.stateNode,ve=go(ho.current);O=K(re,O,y,U,q,ve),(b.updateQueue=O)&&Za(b)}},ti=function(y,b,O,U){O!==U&&Za(b)};else if(ne){Oc=function(y,b,O,U){for(var q=b.child;q!==null;){if(q.tag===5){var re=q.stateNode;O&&U&&(re=$e(re,q.type,q.memoizedProps,q)),R(y,re)}else if(q.tag===6)re=q.stateNode,O&&U&&(re=Be(re,q.memoizedProps,q)),R(y,re);else if(q.tag!==4){if(q.tag===22&&q.memoizedState!==null)re=q.child,re!==null&&(re.return=q),Oc(y,q,!0,!0);else if(q.child!==null){q.child.return=q,q=q.child;continue}}if(q===b)break;for(;q.sibling===null;){if(q.return===null||q.return===b)return;q=q.return}q.sibling.return=q.return,q=q.sibling}};var Ic=function(y,b,O,U){for(var q=b.child;q!==null;){if(q.tag===5){var re=q.stateNode;O&&U&&(re=$e(re,q.type,q.memoizedProps,q)),Pe(y,re)}else if(q.tag===6)re=q.stateNode,O&&U&&(re=Be(re,q.memoizedProps,q)),Pe(y,re);else if(q.tag!==4){if(q.tag===22&&q.memoizedState!==null)re=q.child,re!==null&&(re.return=q),Ic(y,q,!0,!0);else if(q.child!==null){q.child.return=q,q=q.child;continue}}if(q===b)break;for(;q.sibling===null;){if(q.return===null||q.return===b)return;q=q.return}q.sibling.return=q.return,q=q.sibling}};Dc=function(y,b){var O=b.stateNode;if(!Eu(y,b)){y=O.containerInfo;var U=bt(y);Ic(U,b,!1,!1),O.pendingChildren=U,Za(b),ze(y,U)}},ei=function(y,b,O,U,q){var re=y.stateNode,ve=y.memoizedProps;if((y=Eu(y,b))&&ve===U)b.stateNode=re;else{var Ve=b.stateNode,gt=go(ho.current),Vt=null;ve!==U&&(Vt=K(Ve,O,ve,U,q,gt)),y&&Vt===null?b.stateNode=re:(re=Re(re,Vt,O,ve,U,b,y,Ve),z(re,O,U,q,gt)&&Za(b),b.stateNode=re,y?Za(b):Oc(re,b,!1,!1))}},ti=function(y,b,O,U){O!==U?(y=go(Tc.current),O=go(ho.current),b.stateNode=ae(U,y,O,b),Za(b)):b.stateNode=y.stateNode}}else Dc=function(){},ei=function(){},ti=function(){};function qi(y,b){if(!Kn)switch(y.tailMode){case"hidden":b=y.tail;for(var O=null;b!==null;)b.alternate!==null&&(O=b),b=b.sibling;O===null?y.tail=null:O.sibling=null;break;case"collapsed":O=y.tail;for(var U=null;O!==null;)O.alternate!==null&&(U=O),O=O.sibling;U===null?b||y.tail===null?y.tail=null:y.tail.sibling=null:U.sibling=null}}function es(y){var b=y.alternate!==null&&y.alternate.child===y.child,O=0,U=0;if(b)for(var q=y.child;q!==null;)O|=q.lanes|q.childLanes,U|=q.subtreeFlags&14680064,U|=q.flags&14680064,q.return=y,q=q.sibling;else for(q=y.child;q!==null;)O|=q.lanes|q.childLanes,U|=q.subtreeFlags,U|=q.flags,q.return=y,q=q.sibling;return y.subtreeFlags|=U,y.childLanes=O,b}function Nu(y,b,O){var U=b.pendingProps;switch(Qf(b),b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return es(b),null;case 1:return Sn(b.type)&&ye(),es(b),null;case 3:return O=b.stateNode,mu(),Xr(Gn),Xr(hn),kp(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(y===null||y.child===null)&&(V0(b)?Za(b):y===null||y.memoizedState.isDehydrated&&(b.flags&256)===0||(b.flags|=1024,Ro!==null&&(kg(Ro),Ro=null))),Dc(y,b),es(b),null;case 5:bp(b),O=go(Tc.current);var q=b.type;if(y!==null&&b.stateNode!=null)ei(y,b,q,U,O),y.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!U){if(b.stateNode===null)throw Error(i(166));return es(b),null}if(y=go(ho.current),V0(b)){if(!pe)throw Error(i(175));y=Se(b.stateNode,b.type,b.memoizedProps,O,y,b,!Jf),b.updateQueue=y,y!==null&&Za(b)}else{var re=W(q,U,O,y,b);Oc(re,b,!1,!1),b.stateNode=re,z(re,q,U,O,y)&&Za(b)}b.ref!==null&&(b.flags|=512,b.flags|=2097152)}return es(b),null;case 6:if(y&&b.stateNode!=null)ti(y,b,y.memoizedProps,U);else{if(typeof U!="string"&&b.stateNode===null)throw Error(i(166));if(y=go(Tc.current),O=go(ho.current),V0(b)){if(!pe)throw Error(i(176));if(y=b.stateNode,O=b.memoizedProps,(U=He(y,O,b,!Jf))&&(q=ya,q!==null))switch(q.tag){case 3:ot(q.stateNode.containerInfo,y,O,(q.mode&1)!==0);break;case 5:xt(q.type,q.memoizedProps,q.stateNode,y,O,(q.mode&1)!==0)}U&&Za(b)}else b.stateNode=ae(U,y,O,b)}return es(b),null;case 13:if(Xr(ns),U=b.memoizedState,y===null||y.memoizedState!==null&&y.memoizedState.dehydrated!==null){if(Kn&&Ja!==null&&(b.mode&1)!==0&&(b.flags&128)===0)v1(),du(),b.flags|=98560,q=!1;else if(q=V0(b),U!==null&&U.dehydrated!==null){if(y===null){if(!q)throw Error(i(318));if(!pe)throw Error(i(344));if(q=b.memoizedState,q=q!==null?q.dehydrated:null,!q)throw Error(i(317));ct(q,b)}else du(),(b.flags&128)===0&&(b.memoizedState=null),b.flags|=4;es(b),q=!1}else Ro!==null&&(kg(Ro),Ro=null),q=!0;if(!q)return b.flags&65536?b:null}return(b.flags&128)!==0?(b.lanes=O,b):(O=U!==null,O!==(y!==null&&y.memoizedState!==null)&&O&&(b.child.flags|=8192,(b.mode&1)!==0&&(y===null||(ns.current&1)!==0?rs===0&&(rs=3):Kd())),b.updateQueue!==null&&(b.flags|=4),es(b),null);case 4:return mu(),Dc(y,b),y===null&&Ae(b.stateNode.containerInfo),es(b),null;case 10:return Zf(b.type._context),es(b),null;case 17:return Sn(b.type)&&ye(),es(b),null;case 19:if(Xr(ns),q=b.memoizedState,q===null)return es(b),null;if(U=(b.flags&128)!==0,re=q.rendering,re===null)if(U)qi(q,!1);else{if(rs!==0||y!==null&&(y.flags&128)!==0)for(y=b.child;y!==null;){if(re=Z0(y),re!==null){for(b.flags|=128,qi(q,!1),y=re.updateQueue,y!==null&&(b.updateQueue=y,b.flags|=4),b.subtreeFlags=0,y=O,O=b.child;O!==null;)U=O,q=y,U.flags&=14680066,re=U.alternate,re===null?(U.childLanes=0,U.lanes=q,U.child=null,U.subtreeFlags=0,U.memoizedProps=null,U.memoizedState=null,U.updateQueue=null,U.dependencies=null,U.stateNode=null):(U.childLanes=re.childLanes,U.lanes=re.lanes,U.child=re.child,U.subtreeFlags=0,U.deletions=null,U.memoizedProps=re.memoizedProps,U.memoizedState=re.memoizedState,U.updateQueue=re.updateQueue,U.type=re.type,q=re.dependencies,U.dependencies=q===null?null:{lanes:q.lanes,firstContext:q.firstContext}),O=O.sibling;return cr(ns,ns.current&1|2),b.child}y=y.sibling}q.tail!==null&&Jn()>ph&&(b.flags|=128,U=!0,qi(q,!1),b.lanes=4194304)}else{if(!U)if(y=Z0(re),y!==null){if(b.flags|=128,U=!0,y=y.updateQueue,y!==null&&(b.updateQueue=y,b.flags|=4),qi(q,!0),q.tail===null&&q.tailMode==="hidden"&&!re.alternate&&!Kn)return es(b),null}else 2*Jn()-q.renderingStartTime>ph&&O!==1073741824&&(b.flags|=128,U=!0,qi(q,!1),b.lanes=4194304);q.isBackwards?(re.sibling=b.child,b.child=re):(y=q.last,y!==null?y.sibling=re:b.child=re,q.last=re)}return q.tail!==null?(b=q.tail,q.rendering=b,q.tail=b.sibling,q.renderingStartTime=Jn(),b.sibling=null,y=ns.current,cr(ns,U?y&1|2:y&1),b):(es(b),null);case 22:case 23:return Cg(),O=b.memoizedState!==null,y!==null&&y.memoizedState!==null!==O&&(b.flags|=8192),O&&(b.mode&1)!==0?(Ks&1073741824)!==0&&(es(b),_e&&b.subtreeFlags&6&&(b.flags|=8192)):es(b),null;case 24:return null;case 25:return null}throw Error(i(156,b.tag))}function I1(y,b){switch(Qf(b),b.tag){case 1:return Sn(b.type)&&ye(),y=b.flags,y&65536?(b.flags=y&-65537|128,b):null;case 3:return mu(),Xr(Gn),Xr(hn),kp(),y=b.flags,(y&65536)!==0&&(y&128)===0?(b.flags=y&-65537|128,b):null;case 5:return bp(b),null;case 13:if(Xr(ns),y=b.memoizedState,y!==null&&y.dehydrated!==null){if(b.alternate===null)throw Error(i(340));du()}return y=b.flags,y&65536?(b.flags=y&-65537|128,b):null;case 19:return Xr(ns),null;case 4:return mu(),null;case 10:return Zf(b.type._context),null;case 22:case 23:return Cg(),null;case 24:return null;default:return null}}var Rd=!1,ia=!1,Yi=typeof WeakSet=="function"?WeakSet:Set,sr=null;function Cn(y,b){var O=y.ref;if(O!==null)if(typeof O=="function")try{O(null)}catch(U){Yn(y,b,U)}else O.current=null}function Xi(y,b,O){try{O()}catch(U){Yn(y,b,U)}}var Bp=!1;function R1(y,b){for(M(y.containerInfo),sr=b;sr!==null;)if(y=sr,b=y.child,(y.subtreeFlags&1028)!==0&&b!==null)b.return=y,sr=b;else for(;sr!==null;){y=sr;try{var O=y.alternate;if((y.flags&1024)!==0)switch(y.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var U=O.memoizedProps,q=O.memoizedState,re=y.stateNode,ve=re.getSnapshotBeforeUpdate(y.elementType===y.type?U:Ki(y.type,U),q);re.__reactInternalSnapshotBeforeUpdate=ve}break;case 3:_e&&Fe(y.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(Ve){Yn(y,y.return,Ve)}if(b=y.sibling,b!==null){b.return=y.return,sr=b;break}sr=y.return}return O=Bp,Bp=!1,O}function Au(y,b,O){var U=b.updateQueue;if(U=U!==null?U.lastEffect:null,U!==null){var q=U=U.next;do{if((q.tag&y)===y){var re=q.destroy;q.destroy=void 0,re!==void 0&&Xi(b,O,re)}q=q.next}while(q!==U)}}function Md(y,b){if(b=b.updateQueue,b=b!==null?b.lastEffect:null,b!==null){var O=b=b.next;do{if((O.tag&y)===y){var U=O.create;O.destroy=U()}O=O.next}while(O!==b)}}function hg(y){var b=y.ref;if(b!==null){var O=y.stateNode;switch(y.tag){case 5:y=te(O);break;default:y=O}typeof b=="function"?b(y):b.current=y}}function uh(y){var b=y.alternate;b!==null&&(y.alternate=null,uh(b)),y.child=null,y.deletions=null,y.sibling=null,y.tag===5&&(b=y.stateNode,b!==null&&Le(b)),y.stateNode=null,y.return=null,y.dependencies=null,y.memoizedProps=null,y.memoizedState=null,y.pendingProps=null,y.stateNode=null,y.updateQueue=null}function $p(y){return y.tag===5||y.tag===3||y.tag===4}function ju(y){e:for(;;){for(;y.sibling===null;){if(y.return===null||$p(y.return))return null;y=y.return}for(y.sibling.return=y.return,y=y.sibling;y.tag!==5&&y.tag!==6&&y.tag!==18;){if(y.flags&2||y.child===null||y.tag===4)continue e;y.child.return=y,y=y.child}if(!(y.flags&2))return y.stateNode}}function dh(y,b,O){var U=y.tag;if(U===5||U===6)y=y.stateNode,b?Wt(O,y,b):Ke(O,y);else if(U!==4&&(y=y.child,y!==null))for(dh(y,b,O),y=y.sibling;y!==null;)dh(y,b,O),y=y.sibling}function Up(y,b,O){var U=y.tag;if(U===5||U===6)y=y.stateNode,b?Nt(O,y,b):Ie(O,y);else if(U!==4&&(y=y.child,y!==null))for(Up(y,b,O),y=y.sibling;y!==null;)Up(y,b,O),y=y.sibling}var vs=null,Ci=!1;function Lo(y,b,O){for(O=O.child;O!==null;)gg(y,b,O),O=O.sibling}function gg(y,b,O){if(bi&&typeof bi.onCommitFiberUnmount=="function")try{bi.onCommitFiberUnmount(_c,O)}catch{}switch(O.tag){case 5:ia||Cn(O,b);case 6:if(_e){var U=vs,q=Ci;vs=null,Lo(y,b,O),vs=U,Ci=q,vs!==null&&(Ci?dr(vs,O.stateNode):or(vs,O.stateNode))}else Lo(y,b,O);break;case 18:_e&&vs!==null&&(Ci?Ee(vs,O.stateNode):Te(vs,O.stateNode));break;case 4:_e?(U=vs,q=Ci,vs=O.stateNode.containerInfo,Ci=!0,Lo(y,b,O),vs=U,Ci=q):(ne&&(U=O.stateNode.containerInfo,q=bt(U),ke(U,q)),Lo(y,b,O));break;case 0:case 11:case 14:case 15:if(!ia&&(U=O.updateQueue,U!==null&&(U=U.lastEffect,U!==null))){q=U=U.next;do{var re=q,ve=re.destroy;re=re.tag,ve!==void 0&&((re&2)!==0||(re&4)!==0)&&Xi(O,b,ve),q=q.next}while(q!==U)}Lo(y,b,O);break;case 1:if(!ia&&(Cn(O,b),U=O.stateNode,typeof U.componentWillUnmount=="function"))try{U.props=O.memoizedProps,U.state=O.memoizedState,U.componentWillUnmount()}catch(Ve){Yn(O,b,Ve)}Lo(y,b,O);break;case 21:Lo(y,b,O);break;case 22:O.mode&1?(ia=(U=ia)||O.memoizedState!==null,Lo(y,b,O),ia=U):Lo(y,b,O);break;default:Lo(y,b,O)}}function Pu(y){var b=y.updateQueue;if(b!==null){y.updateQueue=null;var O=y.stateNode;O===null&&(O=y.stateNode=new Yi),b.forEach(function(U){var q=Q2.bind(null,y,U);O.has(U)||(O.add(U),U.then(q,q))})}}function po(y,b){var O=b.deletions;if(O!==null)for(var U=0;U<O.length;U++){var q=O[U];try{var re=y,ve=b;if(_e){var Ve=ve;e:for(;Ve!==null;){switch(Ve.tag){case 5:vs=Ve.stateNode,Ci=!1;break e;case 3:vs=Ve.stateNode.containerInfo,Ci=!0;break e;case 4:vs=Ve.stateNode.containerInfo,Ci=!0;break e}Ve=Ve.return}if(vs===null)throw Error(i(160));gg(re,ve,q),vs=null,Ci=!1}else gg(re,ve,q);var gt=q.alternate;gt!==null&&(gt.return=null),q.return=null}catch(Vt){Yn(q,b,Vt)}}if(b.subtreeFlags&12854)for(b=b.child;b!==null;)fh(b,y),b=b.sibling}function fh(y,b){var O=y.alternate,U=y.flags;switch(y.tag){case 0:case 11:case 14:case 15:if(po(b,y),Qi(y),U&4){try{Au(3,y,y.return),Md(3,y)}catch(ar){Yn(y,y.return,ar)}try{Au(5,y,y.return)}catch(ar){Yn(y,y.return,ar)}}break;case 1:po(b,y),Qi(y),U&512&&O!==null&&Cn(O,O.return);break;case 5:if(po(b,y),Qi(y),U&512&&O!==null&&Cn(O,O.return),_e){if(y.flags&32){var q=y.stateNode;try{Er(q)}catch(ar){Yn(y,y.return,ar)}}if(U&4&&(q=y.stateNode,q!=null)){var re=y.memoizedProps;if(O=O!==null?O.memoizedProps:re,U=y.type,b=y.updateQueue,y.updateQueue=null,b!==null)try{Tt(q,b,U,O,re,y)}catch(ar){Yn(y,y.return,ar)}}}break;case 6:if(po(b,y),Qi(y),U&4&&_e){if(y.stateNode===null)throw Error(i(162));q=y.stateNode,re=y.memoizedProps,O=O!==null?O.memoizedProps:re;try{Je(q,O,re)}catch(ar){Yn(y,y.return,ar)}}break;case 3:if(po(b,y),Qi(y),U&4){if(_e&&pe&&O!==null&&O.memoizedState.isDehydrated)try{oe(b.containerInfo)}catch(ar){Yn(y,y.return,ar)}if(ne){q=b.containerInfo,re=b.pendingChildren;try{ke(q,re)}catch(ar){Yn(y,y.return,ar)}}}break;case 4:if(po(b,y),Qi(y),U&4&&ne){re=y.stateNode,q=re.containerInfo,re=re.pendingChildren;try{ke(q,re)}catch(ar){Yn(y,y.return,ar)}}break;case 13:po(b,y),Qi(y),q=y.child,q.flags&8192&&(re=q.memoizedState!==null,q.stateNode.isHidden=re,!re||q.alternate!==null&&q.alternate.memoizedState!==null||(Wd=Jn())),U&4&&Pu(y);break;case 22:var ve=O!==null&&O.memoizedState!==null;if(y.mode&1?(ia=(O=ia)||ve,po(b,y),ia=O):po(b,y),Qi(y),U&8192){if(O=y.memoizedState!==null,(y.stateNode.isHidden=O)&&!ve&&(y.mode&1)!==0)for(sr=y,U=y.child;U!==null;){for(b=sr=U;sr!==null;){ve=sr;var Ve=ve.child;switch(ve.tag){case 0:case 11:case 14:case 15:Au(4,ve,ve.return);break;case 1:Cn(ve,ve.return);var gt=ve.stateNode;if(typeof gt.componentWillUnmount=="function"){var Vt=ve,gr=ve.return;try{var Ur=Vt;gt.props=Ur.memoizedProps,gt.state=Ur.memoizedState,gt.componentWillUnmount()}catch(ar){Yn(Vt,gr,ar)}}break;case 5:Cn(ve,ve.return);break;case 22:if(ve.memoizedState!==null){xg(b);continue}}Ve!==null?(Ve.return=ve,sr=Ve):xg(b)}U=U.sibling}if(_e){e:if(U=null,_e)for(b=y;;){if(b.tag===5){if(U===null){U=b;try{q=b.stateNode,O?fr(q):me(b.stateNode,b.memoizedProps)}catch(ar){Yn(y,y.return,ar)}}}else if(b.tag===6){if(U===null)try{re=b.stateNode,O?nr(re):Ne(re,b.memoizedProps)}catch(ar){Yn(y,y.return,ar)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===y)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===y)break e;for(;b.sibling===null;){if(b.return===null||b.return===y)break e;U===b&&(U=null),b=b.return}U===b&&(U=null),b.sibling.return=b.return,b=b.sibling}}}break;case 19:po(b,y),Qi(y),U&4&&Pu(y);break;case 21:break;default:po(b,y),Qi(y)}}function Qi(y){var b=y.flags;if(b&2){try{if(_e){e:{for(var O=y.return;O!==null;){if($p(O)){var U=O;break e}O=O.return}throw Error(i(160))}switch(U.tag){case 5:var q=U.stateNode;U.flags&32&&(Er(q),U.flags&=-33);var re=ju(y);Up(y,re,q);break;case 3:case 4:var ve=U.stateNode.containerInfo,Ve=ju(y);dh(y,Ve,ve);break;default:throw Error(i(161))}}}catch(gt){Yn(y,y.return,gt)}y.flags&=-3}b&4096&&(y.flags&=-4097)}function Ld(y,b,O){sr=y,mg(y)}function mg(y,b,O){for(var U=(y.mode&1)!==0;sr!==null;){var q=sr,re=q.child;if(q.tag===22&&U){var ve=q.memoizedState!==null||Rd;if(!ve){var Ve=q.alternate,gt=Ve!==null&&Ve.memoizedState!==null||ia;Ve=Rd;var Vt=ia;if(Rd=ve,(ia=gt)&&!Vt)for(sr=q;sr!==null;)ve=sr,gt=ve.child,ve.tag===22&&ve.memoizedState!==null?yg(q):gt!==null?(gt.return=ve,sr=gt):yg(q);for(;re!==null;)sr=re,mg(re),re=re.sibling;sr=q,Rd=Ve,ia=Vt}pg(y)}else(q.subtreeFlags&8772)!==0&&re!==null?(re.return=q,sr=re):pg(y)}}function pg(y){for(;sr!==null;){var b=sr;if((b.flags&8772)!==0){var O=b.alternate;try{if((b.flags&8772)!==0)switch(b.tag){case 0:case 11:case 15:ia||Md(5,b);break;case 1:var U=b.stateNode;if(b.flags&4&&!ia)if(O===null)U.componentDidMount();else{var q=b.elementType===b.type?O.memoizedProps:Ki(b.type,O.memoizedProps);U.componentDidUpdate(q,O.memoizedState,U.__reactInternalSnapshotBeforeUpdate)}var re=b.updateQueue;re!==null&&C1(b,re,U);break;case 3:var ve=b.updateQueue;if(ve!==null){if(O=null,b.child!==null)switch(b.child.tag){case 5:O=te(b.child.stateNode);break;case 1:O=b.child.stateNode}C1(b,ve,O)}break;case 5:var Ve=b.stateNode;O===null&&b.flags&4&&Ye(Ve,b.type,b.memoizedProps,b);break;case 6:break;case 4:break;case 12:break;case 13:if(pe&&b.memoizedState===null){var gt=b.alternate;if(gt!==null){var Vt=gt.memoizedState;if(Vt!==null){var gr=Vt.dehydrated;gr!==null&&fe(gr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}ia||b.flags&512&&hg(b)}catch(Ur){Yn(b,b.return,Ur)}}if(b===y){sr=null;break}if(O=b.sibling,O!==null){O.return=b.return,sr=O;break}sr=b.return}}function xg(y){for(;sr!==null;){var b=sr;if(b===y){sr=null;break}var O=b.sibling;if(O!==null){O.return=b.return,sr=O;break}sr=b.return}}function yg(y){for(;sr!==null;){var b=sr;try{switch(b.tag){case 0:case 11:case 15:var O=b.return;try{Md(4,b)}catch(gt){Yn(b,O,gt)}break;case 1:var U=b.stateNode;if(typeof U.componentDidMount=="function"){var q=b.return;try{U.componentDidMount()}catch(gt){Yn(b,q,gt)}}var re=b.return;try{hg(b)}catch(gt){Yn(b,re,gt)}break;case 5:var ve=b.return;try{hg(b)}catch(gt){Yn(b,ve,gt)}}}catch(gt){Yn(b,b.return,gt)}if(b===y){sr=null;break}var Ve=b.sibling;if(Ve!==null){Ve.return=b.return,sr=Ve;break}sr=b.return}}var Yl=0,ri=1,ol=2,Bd=3,hh=4;if(typeof Symbol=="function"&&Symbol.for){var Ji=Symbol.for;Yl=Ji("selector.component"),ri=Ji("selector.has_pseudo_class"),ol=Ji("selector.role"),Bd=Ji("selector.test_id"),hh=Ji("selector.text")}function ll(y){var b=Ce(y);if(b!=null){if(typeof b.memoizedProps["data-testname"]!="string")throw Error(i(364));return b}if(y=lt(y),y===null)throw Error(i(362));return y.stateNode.current}function gh(y,b){switch(b.$$typeof){case Yl:if(y.type===b.value)return!0;break;case ri:e:{b=b.value,y=[y,0];for(var O=0;O<y.length;){var U=y[O++],q=y[O++],re=b[q];if(U.tag!==5||!Lt(U)){for(;re!=null&&gh(U,re);)q++,re=b[q];if(q===b.length){b=!0;break e}else for(U=U.child;U!==null;)y.push(U,q),U=U.sibling}}b=!1}return b;case ol:if(y.tag===5&&zt(y.stateNode,b.value))return!0;break;case hh:if((y.tag===5||y.tag===6)&&(y=ht(y),y!==null&&0<=y.indexOf(b.value)))return!0;break;case Bd:if(y.tag===5&&(y=y.memoizedProps["data-testname"],typeof y=="string"&&y.toLowerCase()===b.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function vg(y){switch(y.$$typeof){case Yl:return"<"+(F(y.value)||"Unknown")+">";case ri:return":has("+(vg(y)||"")+")";case ol:return'[role="'+y.value+'"]';case hh:return'"'+y.value+'"';case Bd:return'[data-testname="'+y.value+'"]';default:throw Error(i(365))}}function cl(y,b){var O=[];y=[y,0];for(var U=0;U<y.length;){var q=y[U++],re=y[U++],ve=b[re];if(q.tag!==5||!Lt(q)){for(;ve!=null&&gh(q,ve);)re++,ve=b[re];if(re===b.length)O.push(q);else for(q=q.child;q!==null;)y.push(q,re),q=q.sibling}}return O}function ul(y,b){if(!pt)throw Error(i(363));y=ll(y),y=cl(y,b),b=[],y=Array.from(y);for(var O=0;O<y.length;){var U=y[O++];if(U.tag===5)Lt(U)||b.push(U.stateNode);else for(U=U.child;U!==null;)y.push(U),U=U.sibling}return b}var wg=Math.ceil,mh=o.ReactCurrentDispatcher,$d=o.ReactCurrentOwner,hs=o.ReactCurrentBatchConfig,qr=0,Fn=null,ts=null,ws=0,Ks=0,Rc=un(0),rs=0,Ud=null,Xl=0,zn=0,zd=0,Fu=null,Da=null,Wd=0,ph=1/0,ni=null;function An(){ph=Jn()+500}var gs=!1,Es=null,Bo=null,Mc=!1,xo=null,_g=0,Ns=0,xh=null,Hd=-1,Gd=0;function qn(){return(qr&6)!==0?Jn():Hd!==-1?Hd:Hd=Jn()}function qs(y){return(y.mode&1)===0?1:(qr&2)!==0&&ws!==0?ws&-ws:q2.transition!==null?(Gd===0&&(Gd=Ft()),Gd):(y=Bt,y!==0?y:Ge())}function Ia(y,b,O,U){if(50<Ns)throw Ns=0,xh=null,Error(i(185));rn(y,O,U),((qr&2)===0||y!==Fn)&&(y===Fn&&((qr&2)===0&&(zn|=O),rs===4&&Ql(y,ws)),Ra(y,U),O===1&&qr===0&&(b.mode&1)===0&&(An(),kd&&xa()))}function Ra(y,b){var O=y.callbackNode;Ct(y,b);var U=mt(y,y===Fn?ws:0);if(U===0)O!==null&&Kr(O),y.callbackNode=null,y.callbackPriority=0;else if(b=U&-U,y.callbackPriority!==b){if(O!=null&&Kr(O),b===1)y.tag===0?m1(zp.bind(null,y)):H0(zp.bind(null,y)),At?et(function(){(qr&6)===0&&xa()}):Vr(fo,xa),O=null;else{switch(kn(U)){case 1:O=fo;break;case 4:O=wc;break;case 16:O=z0;break;case 536870912:O=K2;break;default:O=z0}O=Yp(O,bg.bind(null,y))}y.callbackPriority=b,y.callbackNode=O}}function bg(y,b){if(Hd=-1,Gd=0,(qr&6)!==0)throw Error(i(327));var O=y.callbackNode;if(Jl()&&y.callbackNode!==O)return null;var U=mt(y,y===Fn?ws:0);if(U===0)return null;if((U&30)!==0||(U&y.expiredLanes)!==0||b)b=Ou(y,U);else{b=U;var q=qr;qr|=2;var re=Hp();(Fn!==y||ws!==b)&&(ni=null,An(),Lc(y,b));do try{Gp();break}catch(Ve){Vd(y,Ve)}while(!0);yp(),mh.current=re,qr=q,ts!==null?b=0:(Fn=null,ws=0,b=rs)}if(b!==0){if(b===2&&(q=Sr(y),q!==0&&(U=q,b=Sg(y,q))),b===1)throw O=Ud,Lc(y,0),Ql(y,U),Ra(y,Jn()),O;if(b===6)Ql(y,U);else{if(q=y.current.alternate,(U&30)===0&&!M1(q)&&(b=Ou(y,U),b===2&&(re=Sr(y),re!==0&&(U=re,b=Sg(y,re))),b===1))throw O=Ud,Lc(y,0),Ql(y,U),Ra(y,Jn()),O;switch(y.finishedWork=q,y.finishedLanes=U,b){case 0:case 1:throw Error(i(345));case 2:Bc(y,Da,ni);break;case 3:if(Ql(y,U),(U&130023424)===U&&(b=Wd+500-Jn(),10<b)){if(mt(y,0)!==0)break;if(q=y.suspendedLanes,(q&U)!==U){qn(),y.pingedLanes|=y.suspendedLanes&q;break}y.timeoutHandle=X(Bc.bind(null,y,Da,ni),b);break}Bc(y,Da,ni);break;case 4:if(Ql(y,U),(U&4194240)===U)break;for(b=y.eventTimes,q=-1;0<U;){var ve=31-dn(U);re=1<<ve,ve=b[ve],ve>q&&(q=ve),U&=~re}if(U=q,U=Jn()-U,U=(120>U?120:480>U?480:1080>U?1080:1920>U?1920:3e3>U?3e3:4320>U?4320:1960*wg(U/1960))-U,10<U){y.timeoutHandle=X(Bc.bind(null,y,Da,ni),U);break}Bc(y,Da,ni);break;case 5:Bc(y,Da,ni);break;default:throw Error(i(329))}}}return Ra(y,Jn()),y.callbackNode===O?bg.bind(null,y):null}function Sg(y,b){var O=Fu;return y.current.memoizedState.isDehydrated&&(Lc(y,b).flags|=256),y=Ou(y,b),y!==2&&(b=Da,Da=O,b!==null&&kg(b)),y}function kg(y){Da===null?Da=y:Da.push.apply(Da,y)}function M1(y){for(var b=y;;){if(b.flags&16384){var O=b.updateQueue;if(O!==null&&(O=O.stores,O!==null))for(var U=0;U<O.length;U++){var q=O[U],re=q.getSnapshot;q=q.value;try{if(!Oo(re(),q))return!1}catch{return!1}}}if(O=b.child,b.subtreeFlags&16384&&O!==null)O.return=b,b=O;else{if(b===y)break;for(;b.sibling===null;){if(b.return===null||b.return===y)return!0;b=b.return}b.sibling.return=b.return,b=b.sibling}}return!0}function Ql(y,b){for(b&=~zd,b&=~zn,y.suspendedLanes|=b,y.pingedLanes&=~b,y=y.expirationTimes;0<b;){var O=31-dn(b),U=1<<O;y[O]=-1,b&=~U}}function zp(y){if((qr&6)!==0)throw Error(i(327));Jl();var b=mt(y,0);if((b&1)===0)return Ra(y,Jn()),null;var O=Ou(y,b);if(y.tag!==0&&O===2){var U=Sr(y);U!==0&&(b=U,O=Sg(y,U))}if(O===1)throw O=Ud,Lc(y,0),Ql(y,b),Ra(y,Jn()),O;if(O===6)throw Error(i(345));return y.finishedWork=y.current.alternate,y.finishedLanes=b,Bc(y,Da,ni),Ra(y,Jn()),null}function Wp(y){xo!==null&&xo.tag===0&&(qr&6)===0&&Jl();var b=qr;qr|=1;var O=hs.transition,U=Bt;try{if(hs.transition=null,Bt=1,y)return y()}finally{Bt=U,hs.transition=O,qr=b,(qr&6)===0&&xa()}}function Cg(){Ks=Rc.current,Xr(Rc)}function Lc(y,b){y.finishedWork=null,y.finishedLanes=0;var O=y.timeoutHandle;if(O!==le&&(y.timeoutHandle=le,ie(O)),ts!==null)for(O=ts.return;O!==null;){var U=O;switch(Qf(U),U.tag){case 1:U=U.type.childContextTypes,U!=null&&ye();break;case 3:mu(),Xr(Gn),Xr(hn),kp();break;case 5:bp(U);break;case 4:mu();break;case 13:Xr(ns);break;case 19:Xr(ns);break;case 10:Zf(U.type._context);break;case 22:case 23:Cg()}O=O.return}if(Fn=y,ts=y=$c(y.current,null),ws=Ks=b,rs=0,Ud=null,zd=zn=Xl=0,Da=Fu=null,Sc!==null){for(b=0;b<Sc.length;b++)if(O=Sc[b],U=O.interleaved,U!==null){O.interleaved=null;var q=U.next,re=O.pending;if(re!==null){var ve=re.next;re.next=q,U.next=ve}O.pending=U}Sc=null}return y}function Vd(y,b){do{var O=ts;try{if(yp(),ki.current=bu,jd){for(var U=Zn.memoizedState;U!==null;){var q=U.queue;q!==null&&(q.pending=null),U=U.next}jd=!1}if(Ec=0,Gs=Ts=Zn=null,th=!1,rh=0,$d.current=null,O===null||O.return===null){rs=1,Ud=b,ts=null;break}e:{var re=y,ve=O.return,Ve=O,gt=b;if(b=ws,Ve.flags|=32768,gt!==null&&typeof gt=="object"&&typeof gt.then=="function"){var Vt=gt,gr=Ve,Ur=gr.tag;if((gr.mode&1)===0&&(Ur===0||Ur===11||Ur===15)){var ar=gr.alternate;ar?(gr.updateQueue=ar.updateQueue,gr.memoizedState=ar.memoizedState,gr.lanes=ar.lanes):(gr.updateQueue=null,gr.memoizedState=null)}var Wn=O1(ve);if(Wn!==null){Wn.flags&=-257,jc(Wn,ve,Ve,re,b),Wn.mode&1&&F1(re,Vt,b),b=Wn,gt=Vt;var Tn=b.updateQueue;if(Tn===null){var si=new Set;si.add(gt),b.updateQueue=si}else Tn.add(gt);break e}else{if((b&1)===0){F1(re,Vt,b),Kd();break e}gt=Error(i(426))}}else if(Kn&&Ve.mode&1){var dl=O1(ve);if(dl!==null){(dl.flags&65536)===0&&(dl.flags|=256),jc(dl,ve,Ve,re,b),pp(Su(gt,Ve));break e}}re=gt=Su(gt,Ve),rs!==4&&(rs=2),Fu===null?Fu=[re]:Fu.push(re),re=ve;do{switch(re.tag){case 3:re.flags|=65536,b&=-b,re.lanes|=b;var ut=sl(re,gt,b);Nd(re,ut);break e;case 1:Ve=gt;var Qe=re.type,vt=re.stateNode;if((re.flags&128)===0&&(typeof Qe.getDerivedStateFromError=="function"||vt!==null&&typeof vt.componentDidCatch=="function"&&(Bo===null||!Bo.has(vt)))){re.flags|=65536,b&=-b,re.lanes|=b;var ir=cg(re,Ve,b);Nd(re,ir);break e}}re=re.return}while(re!==null)}Kp(O)}catch(Cr){b=Cr,ts===O&&O!==null&&(ts=O=O.return);continue}break}while(!0)}function Hp(){var y=mh.current;return mh.current=bu,y===null?bu:y}function Kd(){(rs===0||rs===3||rs===2)&&(rs=4),Fn===null||(Xl&268435455)===0&&(zn&268435455)===0||Ql(Fn,ws)}function Ou(y,b){var O=qr;qr|=2;var U=Hp();(Fn!==y||ws!==b)&&(ni=null,Lc(y,b));do try{L1();break}catch(q){Vd(y,q)}while(!0);if(yp(),qr=O,mh.current=U,ts!==null)throw Error(i(261));return Fn=null,ws=0,rs}function L1(){for(;ts!==null;)Vp(ts)}function Gp(){for(;ts!==null&&!Qn();)Vp(ts)}function Vp(y){var b=W1(y.alternate,y,Ks);y.memoizedProps=y.pendingProps,b===null?Kp(y):ts=b,$d.current=null}function Kp(y){var b=y;do{var O=b.alternate;if(y=b.return,(b.flags&32768)===0){if(O=Nu(O,b,Ks),O!==null){ts=O;return}}else{if(O=I1(O,b),O!==null){O.flags&=32767,ts=O;return}if(y!==null)y.flags|=32768,y.subtreeFlags=0,y.deletions=null;else{rs=6,ts=null;return}}if(b=b.sibling,b!==null){ts=b;return}ts=b=y}while(b!==null);rs===0&&(rs=5)}function Bc(y,b,O){var U=Bt,q=hs.transition;try{hs.transition=null,Bt=1,B1(y,b,O,U)}finally{hs.transition=q,Bt=U}return null}function B1(y,b,O,U){do Jl();while(xo!==null);if((qr&6)!==0)throw Error(i(327));O=y.finishedWork;var q=y.finishedLanes;if(O===null)return null;if(y.finishedWork=null,y.finishedLanes=0,O===y.current)throw Error(i(177));y.callbackNode=null,y.callbackPriority=0;var re=O.lanes|O.childLanes;if(nt(y,re),y===Fn&&(ts=Fn=null,ws=0),(O.subtreeFlags&2064)===0&&(O.flags&2064)===0||Mc||(Mc=!0,Yp(z0,function(){return Jl(),null})),re=(O.flags&15990)!==0,(O.subtreeFlags&15990)!==0||re){re=hs.transition,hs.transition=null;var ve=Bt;Bt=1;var Ve=qr;qr|=4,$d.current=null,R1(y,O),fh(O,y),H(y.containerInfo),y.current=O,Ld(O),Bn(),qr=Ve,Bt=ve,hs.transition=re}else y.current=O;if(Mc&&(Mc=!1,xo=y,_g=q),re=y.pendingLanes,re===0&&(Bo=null),Sd(O.stateNode),Ra(y,Jn()),b!==null)for(U=y.onRecoverableError,O=0;O<b.length;O++)q=b[O],U(q.value,{componentStack:q.stack,digest:q.digest});if(gs)throw gs=!1,y=Es,Es=null,y;return(_g&1)!==0&&y.tag!==0&&Jl(),re=y.pendingLanes,(re&1)!==0?y===xh?Ns++:(Ns=0,xh=y):Ns=0,xa(),null}function Jl(){if(xo!==null){var y=kn(_g),b=hs.transition,O=Bt;try{if(hs.transition=null,Bt=16>y?16:y,xo===null)var U=!1;else{if(y=xo,xo=null,_g=0,(qr&6)!==0)throw Error(i(331));var q=qr;for(qr|=4,sr=y.current;sr!==null;){var re=sr,ve=re.child;if((sr.flags&16)!==0){var Ve=re.deletions;if(Ve!==null){for(var gt=0;gt<Ve.length;gt++){var Vt=Ve[gt];for(sr=Vt;sr!==null;){var gr=sr;switch(gr.tag){case 0:case 11:case 15:Au(8,gr,re)}var Ur=gr.child;if(Ur!==null)Ur.return=gr,sr=Ur;else for(;sr!==null;){gr=sr;var ar=gr.sibling,Wn=gr.return;if(uh(gr),gr===Vt){sr=null;break}if(ar!==null){ar.return=Wn,sr=ar;break}sr=Wn}}}var Tn=re.alternate;if(Tn!==null){var si=Tn.child;if(si!==null){Tn.child=null;do{var dl=si.sibling;si.sibling=null,si=dl}while(si!==null)}}sr=re}}if((re.subtreeFlags&2064)!==0&&ve!==null)ve.return=re,sr=ve;else e:for(;sr!==null;){if(re=sr,(re.flags&2048)!==0)switch(re.tag){case 0:case 11:case 15:Au(9,re,re.return)}var ut=re.sibling;if(ut!==null){ut.return=re.return,sr=ut;break e}sr=re.return}}var Qe=y.current;for(sr=Qe;sr!==null;){ve=sr;var vt=ve.child;if((ve.subtreeFlags&2064)!==0&&vt!==null)vt.return=ve,sr=vt;else e:for(ve=Qe;sr!==null;){if(Ve=sr,(Ve.flags&2048)!==0)try{switch(Ve.tag){case 0:case 11:case 15:Md(9,Ve)}}catch(Cr){Yn(Ve,Ve.return,Cr)}if(Ve===ve){sr=null;break e}var ir=Ve.sibling;if(ir!==null){ir.return=Ve.return,sr=ir;break e}sr=Ve.return}}if(qr=q,xa(),bi&&typeof bi.onPostCommitFiberRoot=="function")try{bi.onPostCommitFiberRoot(_c,y)}catch{}U=!0}return U}finally{Bt=O,hs.transition=b}}return!1}function qp(y,b,O){b=Su(O,b),b=sl(y,b,1),y=Gl(y,b,1),b=qn(),y!==null&&(rn(y,1,b),Ra(y,b))}function Yn(y,b,O){if(y.tag===3)qp(y,y,O);else for(;b!==null;){if(b.tag===3){qp(b,y,O);break}else if(b.tag===1){var U=b.stateNode;if(typeof b.type.getDerivedStateFromError=="function"||typeof U.componentDidCatch=="function"&&(Bo===null||!Bo.has(U))){y=Su(O,y),y=cg(b,y,1),b=Gl(b,y,1),y=qn(),b!==null&&(rn(b,1,y),Ra(b,y));break}}b=b.return}}function $1(y,b,O){var U=y.pingCache;U!==null&&U.delete(b),b=qn(),y.pingedLanes|=y.suspendedLanes&O,Fn===y&&(ws&O)===O&&(rs===4||rs===3&&(ws&130023424)===ws&&500>Jn()-Wd?Lc(y,0):zd|=O),Ra(y,b)}function U1(y,b){b===0&&((y.mode&1)===0?b=1:(b=mn,mn<<=1,(mn&130023424)===0&&(mn=4194304)));var O=qn();y=Mo(y,b),y!==null&&(rn(y,b,O),Ra(y,O))}function z1(y){var b=y.memoizedState,O=0;b!==null&&(O=b.retryLane),U1(y,O)}function Q2(y,b){var O=0;switch(y.tag){case 13:var U=y.stateNode,q=y.memoizedState;q!==null&&(O=q.retryLane);break;case 19:U=y.stateNode;break;default:throw Error(i(314))}U!==null&&U.delete(b),U1(y,O)}var W1;W1=function(y,b,O){if(y!==null)if(y.memoizedProps!==b.pendingProps||Gn.current)Vs=!0;else{if((y.lanes&O)===0&&(b.flags&128)===0)return Vs=!1,Fc(y,b,O);Vs=(y.flags&131072)!==0}else Vs=!1,Kn&&(b.flags&1048576)!==0&&p1(b,uu,b.index);switch(b.lanes=0,b.tag){case 2:var U=b.type;ch(y,b),y=b.pendingProps;var q=Ws(b,hn.current);Ed(b,O),q=nh(null,b,U,y,q,O);var re=eg();return b.flags|=1,typeof q=="object"&&q!==null&&typeof q.render=="function"&&q.$$typeof===void 0?(b.tag=1,b.memoizedState=null,b.updateQueue=null,Sn(U)?(re=!0,Or(b)):re=!1,b.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,wp(b),q.updater=ih,b.stateNode=q,q._reactInternals=b,nl(b,U,y,O),b=Fa(null,b,U,!0,re,O)):(b.tag=0,Kn&&re&&Xf(b),aa(null,b,q,O),b=b.child),b;case 16:U=b.elementType;e:{switch(ch(y,b),y=b.pendingProps,q=U._init,U=q(U._payload),b.type=U,q=b.tag=J2(U),y=Ki(U,y),q){case 0:b=al(null,b,U,y,O);break e;case 1:b=wa(null,b,U,y,O);break e;case 11:b=ug(null,b,U,y,O);break e;case 14:b=ku(null,b,U,Ki(U.type,y),O);break e}throw Error(i(306,U,""))}return b;case 0:return U=b.type,q=b.pendingProps,q=b.elementType===U?q:Ki(U,q),al(y,b,U,q,O);case 1:return U=b.type,q=b.pendingProps,q=b.elementType===U?q:Ki(U,q),wa(y,b,U,q,O);case 3:e:{if(Pc(b),y===null)throw Error(i(387));U=b.pendingProps,re=b.memoizedState,q=re.element,k1(y,b),kc(b,U,null,O);var ve=b.memoizedState;if(U=ve.element,pe&&re.isDehydrated)if(re={element:U,isDehydrated:!1,cache:ve.cache,pendingSuspenseBoundaries:ve.pendingSuspenseBoundaries,transitions:ve.transitions},b.updateQueue.baseState=re,b.memoizedState=re,b.flags&256){q=Su(Error(i(423)),b),b=Cu(y,b,U,O,q);break e}else if(U!==q){q=Su(Error(i(424)),b),b=Cu(y,b,U,O,q);break e}else for(pe&&(Ja=he(b.stateNode.containerInfo),ya=b,Kn=!0,Ro=null,Jf=!1),O=b1(b,null,U,O),b.child=O;O;)O.flags=O.flags&-3|4096,O=O.sibling;else{if(du(),U===q){b=ql(y,b,O);break e}aa(y,b,U,O)}b=b.child}return b;case 5:return _p(b),y===null&&mp(b),U=b.type,q=b.pendingProps,re=y!==null?y.memoizedProps:null,ve=q.children,Q(U,q)?ve=null:re!==null&&Q(U,re)&&(b.flags|=32),Pn(y,b),aa(y,b,ve,O),b.child;case 6:return y===null&&mp(b),null;case 13:return Lp(y,b,O);case 4:return J0(b,b.stateNode.containerInfo),U=b.pendingProps,y===null?b.child=hu(b,null,U,O):aa(y,b,U,O),b.child;case 11:return U=b.type,q=b.pendingProps,q=b.elementType===U?q:Ki(U,q),ug(y,b,U,q,O);case 7:return aa(y,b,b.pendingProps,O),b.child;case 8:return aa(y,b,b.pendingProps.children,O),b.child;case 12:return aa(y,b,b.pendingProps.children,O),b.child;case 10:e:{if(U=b.type._context,q=b.pendingProps,re=b.memoizedProps,ve=q.value,S1(b,U,ve),re!==null)if(Oo(re.value,ve)){if(re.children===q.children&&!Gn.current){b=ql(y,b,O);break e}}else for(re=b.child,re!==null&&(re.return=b);re!==null;){var Ve=re.dependencies;if(Ve!==null){ve=re.child;for(var gt=Ve.firstContext;gt!==null;){if(gt.context===U){if(re.tag===1){gt=Hl(-1,O&-O),gt.tag=2;var Vt=re.updateQueue;if(Vt!==null){Vt=Vt.shared;var gr=Vt.pending;gr===null?gt.next=gt:(gt.next=gr.next,gr.next=gt),Vt.pending=gt}}re.lanes|=O,gt=re.alternate,gt!==null&&(gt.lanes|=O),gu(re.return,O,b),Ve.lanes|=O;break}gt=gt.next}}else if(re.tag===10)ve=re.type===b.type?null:re.child;else if(re.tag===18){if(ve=re.return,ve===null)throw Error(i(341));ve.lanes|=O,Ve=ve.alternate,Ve!==null&&(Ve.lanes|=O),gu(ve,O,b),ve=re.sibling}else ve=re.child;if(ve!==null)ve.return=re;else for(ve=re;ve!==null;){if(ve===b){ve=null;break}if(re=ve.sibling,re!==null){re.return=ve.return,ve=re;break}ve=ve.return}re=ve}aa(y,b,q.children,O),b=b.child}return b;case 9:return q=b.type,U=b.pendingProps.children,Ed(b,O),q=Hi(q),U=U(q),b.flags|=1,aa(y,b,U,O),b.child;case 14:return U=b.type,q=Ki(U,b.pendingProps),q=Ki(U.type,q),ku(y,b,U,q,O);case 15:return Kl(y,b,b.type,b.pendingProps,O);case 17:return U=b.type,q=b.pendingProps,q=b.elementType===U?q:Ki(U,q),ch(y,b),b.tag=1,Sn(U)?(y=!0,Or(b)):y=!1,Ed(b,O),P1(b,U,q),nl(b,U,q,O),Fa(null,b,U,!0,y,O);case 19:return fg(y,b,O);case 22:return Un(y,b,O)}throw Error(i(156,b.tag))};function Yp(y,b){return Vr(y,b)}function H1(y,b,O,U){this.tag=y,this.key=O,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=b,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=U,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zi(y,b,O,U){return new H1(y,b,O,U)}function qd(y){return y=y.prototype,!(!y||!y.isReactComponent)}function J2(y){if(typeof y=="function")return qd(y)?1:0;if(y!=null){if(y=y.$$typeof,y===v)return 11;if(y===k)return 14}return 2}function $c(y,b){var O=y.alternate;return O===null?(O=Zi(y.tag,b,y.key,y.mode),O.elementType=y.elementType,O.type=y.type,O.stateNode=y.stateNode,O.alternate=y,y.alternate=O):(O.pendingProps=b,O.type=y.type,O.flags=0,O.subtreeFlags=0,O.deletions=null),O.flags=y.flags&14680064,O.childLanes=y.childLanes,O.lanes=y.lanes,O.child=y.child,O.memoizedProps=y.memoizedProps,O.memoizedState=y.memoizedState,O.updateQueue=y.updateQueue,b=y.dependencies,O.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext},O.sibling=y.sibling,O.index=y.index,O.ref=y.ref,O}function Tg(y,b,O,U,q,re){var ve=2;if(U=y,typeof y=="function")qd(y)&&(ve=1);else if(typeof y=="string")ve=5;else e:switch(y){case d:return _a(O.children,q,re,b);case f:ve=8,q|=8;break;case g:return y=Zi(12,O,b,q|2),y.elementType=g,y.lanes=re,y;case w:return y=Zi(13,O,b,q),y.elementType=w,y.lanes=re,y;case C:return y=Zi(19,O,b,q),y.elementType=C,y.lanes=re,y;case N:return Yd(O,q,re,b);default:if(typeof y=="object"&&y!==null)switch(y.$$typeof){case p:ve=10;break e;case x:ve=9;break e;case v:ve=11;break e;case k:ve=14;break e;case _:ve=16,U=null;break e}throw Error(i(130,y==null?y:typeof y,""))}return b=Zi(ve,O,b,q),b.elementType=y,b.type=U,b.lanes=re,b}function _a(y,b,O,U){return y=Zi(7,y,U,b),y.lanes=O,y}function Yd(y,b,O,U){return y=Zi(22,y,U,b),y.elementType=N,y.lanes=O,y.stateNode={isHidden:!1},y}function Xd(y,b,O){return y=Zi(6,y,null,b),y.lanes=O,y}function Eg(y,b,O){return b=Zi(4,y.children!==null?y.children:[],y.key,b),b.lanes=O,b.stateNode={containerInfo:y.containerInfo,pendingChildren:null,implementation:y.implementation},b}function G1(y,b,O,U,q){this.tag=b,this.containerInfo=y,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=le,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hr(0),this.expirationTimes=Hr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hr(0),this.identifierPrefix=U,this.onRecoverableError=q,pe&&(this.mutableSourceEagerHydrationData=null)}function Xp(y,b,O,U,q,re,ve,Ve,gt){return y=new G1(y,b,O,Ve,gt),b===1?(b=1,re===!0&&(b|=8)):b=0,re=Zi(3,null,null,b),y.current=re,re.stateNode=y,re.memoizedState={element:U,isDehydrated:O,cache:null,transitions:null,pendingSuspenseBoundaries:null},wp(re),y}function Ng(y){if(!y)return na;y=y._reactInternals;e:{if(j(y)!==y||y.tag!==1)throw Error(i(170));var b=y;do{switch(b.tag){case 3:b=b.stateNode.context;break e;case 1:if(Sn(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break e}}b=b.return}while(b!==null);throw Error(i(171))}if(y.tag===1){var O=y.type;if(Sn(O))return Nr(y,O,b)}return b}function Du(y){var b=y._reactInternals;if(b===void 0)throw typeof y.render=="function"?Error(i(188)):(y=Object.keys(y).join(","),Error(i(268,y)));return y=Y(b),y===null?null:y.stateNode}function Ag(y,b){if(y=y.memoizedState,y!==null&&y.dehydrated!==null){var O=y.retryLane;y.retryLane=O!==0&&O<b?O:b}}function Qd(y,b){Ag(y,b),(y=y.alternate)&&Ag(y,b)}function Z2(y){return y=Y(y),y===null?null:y.stateNode}function V1(){return null}return r.attemptContinuousHydration=function(y){if(y.tag===13){var b=Mo(y,134217728);if(b!==null){var O=qn();Ia(b,y,134217728,O)}Qd(y,134217728)}},r.attemptDiscreteHydration=function(y){if(y.tag===13){var b=Mo(y,1);if(b!==null){var O=qn();Ia(b,y,1,O)}Qd(y,1)}},r.attemptHydrationAtCurrentPriority=function(y){if(y.tag===13){var b=qs(y),O=Mo(y,b);if(O!==null){var U=qn();Ia(O,y,b,U)}Qd(y,b)}},r.attemptSynchronousHydration=function(y){switch(y.tag){case 3:var b=y.stateNode;if(b.current.memoizedState.isDehydrated){var O=tt(b.pendingLanes);O!==0&&(Jt(b,O|1),Ra(b,Jn()),(qr&6)===0&&(An(),xa()))}break;case 13:Wp(function(){var U=Mo(y,1);if(U!==null){var q=qn();Ia(U,y,1,q)}}),Qd(y,1)}},r.batchedUpdates=function(y,b){var O=qr;qr|=1;try{return y(b)}finally{qr=O,qr===0&&(An(),kd&&xa())}},r.createComponentSelector=function(y){return{$$typeof:Yl,value:y}},r.createContainer=function(y,b,O,U,q,re,ve){return Xp(y,b,!1,null,O,U,q,re,ve)},r.createHasPseudoClassSelector=function(y){return{$$typeof:ri,value:y}},r.createHydrationContainer=function(y,b,O,U,q,re,ve,Ve,gt){return y=Xp(O,U,!0,y,q,re,ve,Ve,gt),y.context=Ng(null),O=y.current,U=qn(),q=qs(O),re=Hl(U,q),re.callback=b??null,Gl(O,re,q),y.current.lanes=q,rn(y,q,U),Ra(y,U),y},r.createPortal=function(y,b,O){var U=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:U==null?null:""+U,children:y,containerInfo:b,implementation:O}},r.createRoleSelector=function(y){return{$$typeof:ol,value:y}},r.createTestNameSelector=function(y){return{$$typeof:Bd,value:y}},r.createTextSelector=function(y){return{$$typeof:hh,value:y}},r.deferredUpdates=function(y){var b=Bt,O=hs.transition;try{return hs.transition=null,Bt=16,y()}finally{Bt=b,hs.transition=O}},r.discreteUpdates=function(y,b,O,U,q){var re=Bt,ve=hs.transition;try{return hs.transition=null,Bt=1,y(b,O,U,q)}finally{Bt=re,hs.transition=ve,qr===0&&An()}},r.findAllNodes=ul,r.findBoundingRects=function(y,b){if(!pt)throw Error(i(363));b=ul(y,b),y=[];for(var O=0;O<b.length;O++)y.push(rt(b[O]));for(b=y.length-1;0<b;b--){O=y[b];for(var U=O.x,q=U+O.width,re=O.y,ve=re+O.height,Ve=b-1;0<=Ve;Ve--)if(b!==Ve){var gt=y[Ve],Vt=gt.x,gr=Vt+gt.width,Ur=gt.y,ar=Ur+gt.height;if(U>=Vt&&re>=Ur&&q<=gr&&ve<=ar){y.splice(b,1);break}else if(U!==Vt||O.width!==gt.width||ar<re||Ur>ve){if(!(re!==Ur||O.height!==gt.height||gr<U||Vt>q)){Vt>U&&(gt.width+=Vt-U,gt.x=U),gr<q&&(gt.width=q-Vt),y.splice(b,1);break}}else{Ur>re&&(gt.height+=Ur-re,gt.y=re),ar<ve&&(gt.height=ve-Ur),y.splice(b,1);break}}}return y},r.findHostInstance=Du,r.findHostInstanceWithNoPortals=function(y){return y=B(y),y=y!==null?se(y):null,y===null?null:y.stateNode},r.findHostInstanceWithWarning=function(y){return Du(y)},r.flushControlled=function(y){var b=qr;qr|=1;var O=hs.transition,U=Bt;try{hs.transition=null,Bt=1,y()}finally{Bt=U,hs.transition=O,qr=b,qr===0&&(An(),xa())}},r.flushPassiveEffects=Jl,r.flushSync=Wp,r.focusWithin=function(y,b){if(!pt)throw Error(i(363));for(y=ll(y),b=cl(y,b),b=Array.from(b),y=0;y<b.length;){var O=b[y++];if(!Lt(O)){if(O.tag===5&&Dt(O.stateNode))return!0;for(O=O.child;O!==null;)b.push(O),O=O.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Bt},r.getFindAllNodesFailureDescription=function(y,b){if(!pt)throw Error(i(363));var O=0,U=[];y=[ll(y),0];for(var q=0;q<y.length;){var re=y[q++],ve=y[q++],Ve=b[ve];if((re.tag!==5||!Lt(re))&&(gh(re,Ve)&&(U.push(vg(Ve)),ve++,ve>O&&(O=ve)),ve<b.length))for(re=re.child;re!==null;)y.push(re,ve),re=re.sibling}if(O<b.length){for(y=[];O<b.length;O++)y.push(vg(b[O]));return`findAllNodes was able to match part of the selector:
  `+(U.join(" > ")+`

No matching component was found for:
  `)+y.join(" > ")}return null},r.getPublicRootInstance=function(y){if(y=y.current,!y.child)return null;switch(y.child.tag){case 5:return te(y.child.stateNode);default:return y.child.stateNode}},r.injectIntoDevTools=function(y){if(y={bundleType:y.bundleType,version:y.version,rendererPackageName:y.rendererPackageName,rendererConfig:y.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:Z2,findFiberByHostInstance:y.findFiberByHostInstance||V1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")y=!1;else{var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)y=!0;else{try{_c=b.inject(y),bi=b}catch{}y=!!b.checkDCE}}return y},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(y,b,O,U){if(!pt)throw Error(i(363));y=ul(y,b);var q=De(y,O,U).disconnect;return{disconnect:function(){q()}}},r.registerMutableSourceForHydration=function(y,b){var O=b._getVersion;O=O(b._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[b,O]:y.mutableSourceEagerHydrationData.push(b,O)},r.runWithPriority=function(y,b){var O=Bt;try{return Bt=y,b()}finally{Bt=O}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(y,b,O,U){var q=b.current,re=qn(),ve=qs(q);return O=Ng(O),b.context===null?b.context=O:b.pendingContext=O,b=Hl(re,ve),b.payload={element:y},U=U===void 0?null:U,U!==null&&(b.callback=U),y=Gl(q,b,ve),y!==null&&(Ia(y,q,ve,re),eh(y,q,ve)),ve},r}),ek}var bP;function AZ(){return bP||(bP=1,ZS.exports=NZ()),ZS.exports}var jZ=AZ();const PZ=Ml(jZ);var tk={exports:{}},of={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SP;function FZ(){return SP||(SP=1,of.ConcurrentRoot=1,of.ContinuousEventPriority=4,of.DefaultEventPriority=16,of.DiscreteEventPriority=1,of.IdleEventPriority=536870912,of.LegacyRoot=0),of}var kP;function OZ(){return kP||(kP=1,tk.exports=FZ()),tk.exports}var CL=OZ(),DZ=tn();const CP={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let TP=!1,EP=!1;const a4=".react-konva-event";let TL=!1;function IZ(e){TL=e}const RZ=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,MZ=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,LZ={};function Hb(e,t,r=LZ){if(!TP&&"zIndex"in t&&(console.warn(MZ),TP=!0),!EP&&t.draggable){var n=t.x!==void 0||t.y!==void 0,s=t.onDragEnd||t.onDragMove;n&&!s&&(console.warn(RZ),EP=!0)}for(var a in r)if(!CP[a]){var i=a.slice(0,2)==="on",o=r[a]!==t[a];if(i&&o){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e.off(c,r[a])}var u=!t.hasOwnProperty(a);u&&e.setAttr(a,void 0)}var d=TL||t._useStrictMode,f={},g=!1;const p={};for(var a in t)if(!CP[a]){var i=a.slice(0,2)==="on",x=r[a]!==t[a];if(i&&x){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),t[a]&&(p[c]=t[a])}!i&&(t[a]!==r[a]||d&&t[a]!==e.getAttr(a))&&(g=!0,f[a]=t[a])}g&&(e.setAttrs(f),Mf(e));for(var c in p)e.on(c+a4,p[c])}function Mf(e){if(!DZ.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}var rk=pN();const EL={},BZ={};Vy.Node.prototype._applyProps=Hb;function $Z(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),Mf(e)}function UZ(e,t,r){let n=Vy[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=Vy.Group);const s={},a={};for(var i in t){var o=i.slice(0,2)==="on";o?a[i]=t[i]:s[i]=t[i]}const c=new n(s);return Hb(c,a),c}function zZ(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function WZ(e,t,r){return!1}function HZ(e){return e}function GZ(){return null}function VZ(){return null}function KZ(e,t,r,n){return BZ}function qZ(){}function YZ(e){}function XZ(e,t){return!1}function QZ(){return EL}function JZ(){return EL}const ZZ=setTimeout,eee=clearTimeout,tee=-1;function ree(e,t){return!1}const nee=!1,see=!0,aee=!0;function iee(e,t){t.parent===e?t.moveToTop():e.add(t),Mf(e)}function oee(e,t){t.parent===e?t.moveToTop():e.add(t),Mf(e)}function NL(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),Mf(e)}function lee(e,t,r){NL(e,t,r)}function cee(e,t){t.destroy(),t.off(a4),Mf(e)}function uee(e,t){t.destroy(),t.off(a4),Mf(e)}function dee(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function fee(e,t,r){}function hee(e,t,r,n,s){Hb(e,s,n)}function gee(e){e.hide(),Mf(e)}function mee(e){}function pee(e,t){(t.visible==null||t.visible)&&e.show()}function xee(e,t){}function yee(e){}function vee(){}const wee=()=>CL.DefaultEventPriority,_ee=Object.freeze(Object.defineProperty({__proto__:null,appendChild:iee,appendChildToContainer:oee,appendInitialChild:$Z,cancelTimeout:eee,clearContainer:yee,commitMount:fee,commitTextUpdate:dee,commitUpdate:hee,createInstance:UZ,createTextInstance:zZ,detachDeletedInstance:vee,finalizeInitialChildren:WZ,getChildHostContext:JZ,getCurrentEventPriority:wee,getPublicInstance:HZ,getRootHostContext:QZ,hideInstance:gee,hideTextInstance:mee,idlePriority:rk.unstable_IdlePriority,insertBefore:NL,insertInContainerBefore:lee,isPrimaryRenderer:nee,noTimeout:tee,now:rk.unstable_now,prepareForCommit:GZ,preparePortalMount:VZ,prepareUpdate:KZ,removeChild:cee,removeChildFromContainer:uee,resetAfterCommit:qZ,resetTextContent:YZ,run:rk.unstable_runWithPriority,scheduleTimeout:ZZ,shouldDeprioritizeSubtree:XZ,shouldSetTextContent:ree,supportsMutation:aee,unhideInstance:pee,unhideTextInstance:xee,warnsIfNotActing:see},Symbol.toStringTag,{value:"Module"}));var bee=Object.defineProperty,See=Object.defineProperties,kee=Object.getOwnPropertyDescriptors,NP=Object.getOwnPropertySymbols,Cee=Object.prototype.hasOwnProperty,Tee=Object.prototype.propertyIsEnumerable,AP=(e,t,r)=>t in e?bee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,jP=(e,t)=>{for(var r in t||(t={}))Cee.call(t,r)&&AP(e,r,t[r]);if(NP)for(var r of NP(t))Tee.call(t,r)&&AP(e,r,t[r]);return e},Eee=(e,t)=>See(e,kee(t)),PP,FP;typeof window<"u"&&((PP=window.document)!=null&&PP.createElement||((FP=window.navigator)==null?void 0:FP.product)==="ReactNative")?S.useLayoutEffect:S.useEffect;function AL(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=e.child;for(;n;){const s=AL(n,t,r);if(s)return s;n=n.sibling}}function jL(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const OP=console.error;console.error=function(){const e=[...arguments].join("");if(e?.startsWith("Warning:")&&e.includes("useContext")){console.error=OP;return}return OP.apply(this,arguments)};const i4=jL(S.createContext(null));class PL extends S.Component{render(){return S.createElement(i4.Provider,{value:this._reactInternals},this.props.children)}}function Nee(){const e=S.useContext(i4);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=S.useId();return S.useMemo(()=>{for(const n of[e,e?.alternate]){if(!n)continue;const s=AL(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===t)return!0;i=i.next}});if(s)return s}},[e,t])}function Aee(){const e=Nee(),[t]=S.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==i4&&!t.has(s)&&t.set(s,S.useContext(jL(s)))}r=r.return}return t}function FL(){const e=Aee();return S.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>S.createElement(t,null,S.createElement(r.Provider,Eee(jP({},n),{value:e.get(r)}))),t=>S.createElement(PL,jP({},t))),[e])}function jee(e){const t=Is.useRef({});return Is.useLayoutEffect(()=>{t.current=e}),Is.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const Pee=e=>{const t=Is.useRef(null),r=Is.useRef(null),n=Is.useRef(null),s=jee(e),a=FL(),i=o=>{const{forwardedRef:c}=e;c&&(typeof c=="function"?c(o):c.current=o)};return Is.useLayoutEffect(()=>(r.current=new Vy.Stage({width:e.width,height:e.height,container:t.current}),i(r.current),n.current=em.createContainer(r.current,CL.LegacyRoot,!1,null),em.updateContainer(Is.createElement(a,{},e.children),n.current),()=>{Vy.isBrowser&&(i(null),em.updateContainer(null,n.current,null),r.current.destroy())}),[]),Is.useLayoutEffect(()=>{i(r.current),Hb(r.current,e,s),em.updateContainer(Is.createElement(a,{},e.children),n.current,null)}),Is.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},r0="Layer",Fee="FastLayer",cc="Group",Oee="Label",Ga="Rect",wf="Circle",Dee="Ellipse",Iee="Wedge",ui="Line",Ree="Sprite",OL="Image",qc="Text",Mee="TextPath",Lee="Star",Bee="Ring",$ee="Arc",Uee="Tag",zee="Path",Wee="RegularPolygon",MT="Arrow",Hee="Shape",DL="Transformer",Gee="18.2.13",em=PZ(_ee);em.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Is.version,rendererPackageName:"react-konva"});const n0=Is.forwardRef((e,t)=>Is.createElement(PL,{},Is.createElement(Pee,{...e,forwardedRef:t}))),Vee=IZ,Kee=Object.freeze(Object.defineProperty({__proto__:null,Arc:$ee,Arrow:MT,Circle:wf,Ellipse:Dee,FastLayer:Fee,Group:cc,Image:OL,KonvaRenderer:em,Label:Oee,Layer:r0,Line:ui,Path:zee,Rect:Ga,RegularPolygon:Wee,Ring:Bee,Shape:Hee,Sprite:Ree,Stage:n0,Star:Lee,Tag:Uee,Text:qc,TextPath:Mee,Transformer:DL,Wedge:Iee,useContextBridge:FL,useStrictMode:Vee,version:Gee},Symbol.toStringTag,{value:"Module"})),jt=({children:e,hover:t=!0,className:r="",paddingClass:n="p-6",...s})=>{const a=`
    bg-white rounded-xl shadow-md border border-gray-200 ${n}
    ${t?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return l.jsx(at.div,{className:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...s,children:e})},qee=({children:e,className:t=""})=>l.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${t}`,children:e}),Yee=({children:e,className:t=""})=>l.jsx("h3",{className:`text-xl font-semibold text-gray-800 ${t}`,children:e}),Xee=({children:e,className:t=""})=>l.jsx("div",{className:`py-4 ${t}`,children:e}),Qee=({children:e,className:t=""})=>l.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${t}`,children:e});jt.Header=qee;jt.Title=Yee;jt.Body=Xee;jt.Footer=Qee;const fa=({isOpen:e=!1,onClose:t,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:o="",...c})=>{const u=f=>{i&&f.target===f.currentTarget&&t()};Is.useEffect(()=>{const f=x=>{x.key==="Escape"&&t()},g=window;g.__modalOpenCount||(g.__modalOpenCount=0);let p;return e&&(document.addEventListener("keydown",f),p=document.body.style.overflow,g.__modalOpenCount===0&&(document.body.style.overflow="hidden"),g.__modalOpenCount+=1),()=>{document.removeEventListener("keydown",f),g.__modalOpenCount&&g.__modalOpenCount>0&&(g.__modalOpenCount-=1),g.__modalOpenCount===0&&(p!==void 0?document.body.style.overflow=p||"":document.body.style.overflow="")}},[e,t]);const d={small:"max-w-md",medium:"max-w-lg",large:"max-w-4xl"};return e?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:u,role:"dialog","aria-modal":"true","aria-label":r,...c,children:l.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-8
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${d[s]} mx-auto
          ${o}
        `,onClick:f=>f.stopPropagation(),children:[(r||a)&&l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&l.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&l.jsx("button",{onClick:t,className:"text-red-500 hover:text-red-700 hover:bg-red-50 transition-all duration-200 rounded-full p-2 text-2xl font-bold leading-none","aria-label":"Close modal",children:""})]}),l.jsx("div",{className:"space-y-6",children:n})]})}):null},Jee=e=>{const[t,r]=S.useState({width:800,height:600}),n=S.useRef(null),s=S.useCallback(()=>{if(e.current){e.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),o=4/3;let c=a,u=c/o;u>i&&(u=i,c=u*o),r({width:c,height:u})}},[e]);return S.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:t,stageRef:n,updateCanvasSize:s}},Zee=e=>{const[t,r]=S.useState({width:800,height:600}),[n,s]=S.useState({}),a=S.useCallback(()=>{if(e.current){const o=e.current.getBoundingClientRect();r({width:o.width,height:Math.max(400,o.height)})}},[e]),i=S.useCallback(o=>o<480?{stageHeight:300,blockMinSize:50,fontSize:12,padding:10,touchTargetSize:44,arrowThickness:4}:o<768?{stageHeight:400,blockMinSize:60,fontSize:14,padding:15,touchTargetSize:44,arrowThickness:4}:o<1024?{stageHeight:500,blockMinSize:70,fontSize:16,padding:20,touchTargetSize:40,arrowThickness:3}:{stageHeight:600,blockMinSize:80,fontSize:18,padding:25,touchTargetSize:32,arrowThickness:2},[]);return S.useEffect(()=>{const o=i(t.width);s(o)},[t.width,i]),S.useEffect(()=>{a();const o=()=>{a()};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[a]),{containerSize:t,responsiveSettings:n,updateSize:a}},DP={convertToOriginal:(e,t,r)=>r?{x:Number(((e-r.x)/r.scale).toFixed(4)),y:Number(((t-r.y)/r.scale).toFixed(4))}:{x:e,y:t},convertToCanvas:(e,t,r)=>r?{x:Number((r.x+e*r.scale).toFixed(4)),y:Number((r.y+t*r.scale).toFixed(4))}:{x:e,y:t},isPointInImage:(e,t)=>t?e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height:!1,calculateImageScale:(e,t)=>{if(!e||!t)return 1;const r=40,n=t.width-r,s=t.height-r;return Math.min(n/e.width,s/e.height)},calculateImageInfo:(e,t)=>{if(!e||!t)return null;const r=40,n=t.width-r,s=t.height-r,a=Math.min(n/e.width,s/e.height),i=e.width*a,o=e.height*a,c=(t.width-i)/2,u=(t.height-o)/2;return{x:c,y:u,width:i,height:o,scale:a,originalWidth:e.width,originalHeight:e.height}}},ete=e=>{const t=S.useCallback((n,s)=>DP.convertToOriginal(n,s,e),[e]),r=S.useCallback((n,s)=>DP.convertToCanvas(n,s,e),[e]);return{convertToOriginal:t,convertToCanvas:r}},Kx={create:(e,t,r,n,s)=>({id:s,x:e-r/2,y:t-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:e=>e.width>0&&e.height>0,findAtPosition:(e,t,r)=>e.find(n=>t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},zg={create:(e,t,r,n,s,a,i)=>({id:i,startX:e,startY:t,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(e,t,r,n=60)=>{let s=null,a=1/0;for(const i of r){const o=i.x+i.width/2,c=i.y+i.height/2,u=Math.sqrt(Math.pow(e-o,2)+Math.pow(t-c,2));u<=n&&u<a&&(a=u,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(e,t,r,n,s)=>zg.snapToNearestBlock(e,t,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},nk={create:(e,t,r)=>({id:r,blockId:e,word:t}),update:(e,t,r)=>e.map(n=>n.blockId===t?{...n,word:r}:n),delete:(e,t)=>e.filter(r=>r.blockId!==t),generateId:e=>`word_${e}`,validate:e=>e&&e.trim().length>0},tte=async e=>{const t=[];if(e.size>512e3){const n=(e.size/1024).toFixed(1);t.push(`Image is too large (${n}KB). Maximum allowed size is 500KB. Please compress or resize your image.`)}return new Promise(n=>{const s=new Image;s.onload=()=>{(s.width>4e3||s.height>4e3)&&t.push(`Image is too large (${s.width}x${s.height} pixels). Maximum allowed dimensions are 4000x4000 pixels. Please resize your image.`),n({valid:t.length===0,errors:t,dimensions:{width:s.width,height:s.height}})},s.onerror=()=>{t.push("Invalid image file"),n({valid:!1,errors:t})},s.src=URL.createObjectURL(e)})},rte=(e,t=500)=>new Promise(r=>{const n=document.createElement("canvas"),s=n.getContext("2d"),a=new Image;a.onload=()=>{let{width:i,height:o}=a;const c=2e3;if(i>c||o>c){const f=Math.min(c/i,c/o);i*=f,o*=f}n.width=i,n.height=o,s.drawImage(a,0,0,i,o);let u=.8;const d=()=>{n.toBlob(f=>{f.size<=t*1024||u<=.1?r(f):(u-=.1,d())},"image/jpeg",u)};d()},a.onerror=()=>{r(e)},a.src=URL.createObjectURL(e)}),nte=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=s=>t(s.target.result),n.onerror=s=>r(s),n.readAsDataURL(e)}),ste=()=>{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return{blockMinSize:e?60:40,arrowThickness:e?4:2,touchTargetSize:e?44:32,doubleTapDelay:e?300:200,isMobile:e}},ate={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null,showImageSizeModal:!1,imageSizeError:null}},ite=(e,t)=>{switch(t.type){case"SET_CANVAS_SIZE":return{...e,canvas:{...e.canvas,size:t.payload}};case"SET_IMAGE":return{...e,canvas:{...e.canvas,image:t.payload}};case"SET_IMAGE_INFO":return{...e,canvas:{...e.canvas,imageInfo:t.payload}};case"SET_SELECTED_TOOL":return{...e,canvas:{...e.canvas,selectedTool:t.payload}};case"ADD_BLOCK":return{...e,testData:{...e.testData,blocks:[...e.testData.blocks,t.payload]}};case"ADD_WORD":return{...e,testData:{...e.testData,words:[...e.testData.words,t.payload]}};case"ADD_ARROW":return{...e,testData:{...e.testData,arrows:[...e.testData.arrows,t.payload]}};case"UPDATE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.map(r=>r.id===t.payload.id?{...r,...t.payload.updates}:r)}};case"DELETE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.filter(r=>r.id!==t.payload),words:e.testData.words.filter(r=>r.blockId!==t.payload),arrows:e.testData.arrows.filter(r=>r.startBlock!==t.payload&&r.endBlock!==t.payload)}};case"UPDATE_WORDS":return{...e,testData:{...e.testData,words:t.payload}};case"SET_CREATION_STATE":return{...e,creation:{...e.creation,...t.payload}};case"SET_UI_STATE":return{...e,ui:{...e.ui,...t.payload}};case"SET_LOADING":return{...e,ui:{...e.ui,isLoading:t.payload}};case"SET_ERROR":return{...e,ui:{...e.ui,error:t.payload}};case"SHOW_IMAGE_SIZE_MODAL":return{...e,ui:{...e.ui,showImageSizeModal:!0,imageSizeError:t.payload}};case"HIDE_IMAGE_SIZE_MODAL":return{...e,ui:{...e.ui,showImageSizeModal:!1,imageSizeError:null}};case"RESET_TESTDATA":return{...e,testData:{blocks:[],words:[],arrows:[],imageUrl:e.testData.imageUrl}};default:return e}},ote=({testName:e="",showQuestionCount:t=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[o,c]=S.useReducer(ite,ate),{showNotification:u}=Aa(),{makeAuthenticatedRequest:d}=tl(),{user:f}=ds(),g=S.useRef(null),p=S.useRef(null),x=S.useRef(null),v=S.useRef({}),w=S.useRef({}),{canvasSize:C,stageRef:k}=Jee(g),{containerSize:_,responsiveSettings:N}=Zee(g),[E,P]=S.useState(null);S.useEffect(()=>{if(!o.canvas.image||!g.current)return;const W=g.current?.clientWidth||800,R=g.current?.clientHeight||600,z=W/o.canvas.image.width,K=R/o.canvas.image.height,Q=Math.min(z,K,1),ae=o.canvas.image.width*Q,X=o.canvas.image.height*Q,ie=(W-ae)/2,le=(R-X)/2;P({x:ie,y:le,width:ae,height:X,scaleX:Q,scaleY:Q,scale:Q,image:o.canvas.image})},[o.canvas.image,g.current?.clientWidth,g.current?.clientHeight]);const{convertToOriginal:F}=ete(E);S.useEffect(()=>{c({type:"SET_CANVAS_SIZE",payload:C})},[C]),S.useEffect(()=>{E&&c({type:"SET_IMAGE_INFO",payload:E})},[E]),S.useEffect(()=>{const W=x.current;if(!W)return;const R=o.ui.selectedBlock?.id?v.current[o.ui.selectedBlock.id]:null;R?(W.nodes([R]),W.getLayer()?.batchDraw()):(W.nodes([]),W.getLayer()?.batchDraw())},[o.ui.selectedBlock]);const A=S.useCallback(()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:null}}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),c({type:"RESET_TESTDATA"}),c({type:"SET_ERROR",payload:null})},[]),j=S.useCallback(async W=>{const R=W.target.files[0];if(!R){u("Please select a file","error");return}try{c({type:"SET_LOADING",payload:!0});const z=await tte(R);if(!z.valid){c({type:"SHOW_IMAGE_SIZE_MODAL",payload:{errors:z.errors,fileSize:(R.size/1024).toFixed(1),dimensions:z.dimensions}});return}let K=R;if(R.size>500*1024){u("Image is large, compressing to meet size requirements...","info");try{K=await rte(R,500);const X=(R.size/1024).toFixed(1),ie=(K.size/1024).toFixed(1);u(`Image compressed from ${X}KB to ${ie}KB`,"success")}catch{u("Failed to compress image. Please try a smaller image.","error");return}}const Q=await nte(K),ae=new Image;ae.crossOrigin="anonymous",ae.onload=()=>{c({type:"SET_IMAGE",payload:ae}),c({type:"SET_UI_STATE",payload:{imageUrl:Q}}),u("Image uploaded successfully!","success")},ae.onerror=()=>{u("Failed to load image","error")},ae.src=Q}catch(z){console.error("Image upload error:",z),u("Error processing image","error")}finally{c({type:"SET_LOADING",payload:!1})}},[u]),I=S.useCallback(W=>{const R=k.current;if(!R)return;const z=R.getPointerPosition();if(z){if(o.canvas.selectedTool==="create"){const K=Kx.findAtPosition(o.testData.blocks,z.x,z.y);if(K){c({type:"SET_UI_STATE",payload:{selectedBlock:K}});return}c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:z.x,y:z.y}}})}else if(o.canvas.selectedTool==="edit"){const K=Kx.findAtPosition(o.testData.blocks,z.x,z.y);c(K?{type:"SET_UI_STATE",payload:{selectedBlock:K}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(o.canvas.selectedTool==="arrow"){const K=W.target===R,Q=Kx.findAtPosition(o.testData.blocks,z.x,z.y);(K||!Q)&&c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:z.x,y:z.y}}})}}},[o.canvas.selectedTool,E,o.testData.blocks]),B=S.useCallback(W=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const R=k.current;if(!R)return;const z=R.getPointerPosition();if(!z)return;const K=Math.abs(z.x-o.creation.blockCreationStart.x),Q=Math.abs(z.y-o.creation.blockCreationStart.y),ae=10,X=Math.max(K,ae),ie=Math.max(Q,ae);c({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(z.x,o.creation.blockCreationStart.x),y:Math.min(z.y,o.creation.blockCreationStart.y),width:X,height:ie,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const R=k.current;if(!R)return;const z=R.getPointerPosition();if(!z)return;c({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:o.creation.arrowStart.x,startY:o.creation.arrowStart.y,endX:z.x,endY:z.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[o.creation]),Y=S.useCallback(W=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const R=k.current;if(!R)return;const z=R.getPointerPosition();if(!z)return;const K=Math.abs(z.x-o.creation.blockCreationStart.x),Q=Math.abs(z.y-o.creation.blockCreationStart.y),ae=10,X=Math.max(K,ae),ie=Math.max(Q,ae),le=Math.min(z.x,o.creation.blockCreationStart.x)+X/2,ce=Math.min(z.y,o.creation.blockCreationStart.y)+ie/2,_e=Kx.generateId(),ne=Kx.create(le,ce,X,ie,_e),pe=nk.create(_e,`Word ${o.testData.blocks.length+1}`,nk.generateId(_e));c({type:"ADD_BLOCK",payload:ne}),c({type:"ADD_WORD",payload:pe}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),o.testData.blocks.length===0&&c({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const R=k.current;if(!R)return;const z=R.getPointerPosition();if(!z)return;if(zg.validate(o.creation.arrowStart.x,o.creation.arrowStart.y,z.x,z.y,o.testData.blocks)){const K=zg.snapToNearestBlock(o.creation.arrowStart.x,o.creation.arrowStart.y,o.testData.blocks),Q=zg.snapToNearestBlock(z.x,z.y,o.testData.blocks),ae=K?K.x:o.creation.arrowStart.x,X=K?K.y:o.creation.arrowStart.y,ie=Q?Q.x:z.x,le=Q?Q.y:z.y,ce=zg.generateId(),_e=ste(),ne=zg.create(ae,X,ie,le,K?K.blockId:null,Q?Q.blockId:null,ce,{strokeWidth:_e.arrowThickness,isMobile:_e.isMobile});c({type:"ADD_ARROW",payload:ne}),u("Arrow created successfully!","success")}else u("Arrow must start near a block!","error");c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[o.creation,o.testData.blocks,u]),Z=S.useCallback(W=>{W.evt.preventDefault(),I(W)},[I]),se=S.useCallback(W=>{W.evt.preventDefault(),B(W)},[B]),ee=S.useCallback(W=>{W.evt.preventDefault(),Y(W)},[Y]),te=S.useCallback(async()=>{console.log(" [MatchingTestCreator] handleSaveTest clicked");const W=L();if(Object.keys(W).length>0){console.warn(" [MatchingTestCreator] Validation errors:",W),u("Please fix validation errors before saving","error");return}try{console.log(" [MatchingTestCreator] Preparing data to save...",{blocks:o.testData.blocks.length,words:o.testData.words.length,arrows:o.testData.arrows.length,imageUrl:o.ui.imageUrl?"present":"missing"}),c({type:"SET_LOADING",payload:!0});let R=o.ui.imageUrl;if(o.ui.imageUrl&&o.ui.imageUrl.startsWith("data:")){const K=await d("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:o.ui.imageUrl,folder:"matching_tests"})}),Q=await K.json();if(K.ok&&Q.success&&Q.url)R=Q.url;else throw new Error(Q.message||"Upload failed")}const z=o.testData.blocks.map((K,Q)=>{let ae;if(E){const le=F(K.x,K.y),ce=F(K.x+K.width,K.y+K.height);ae={x:le.x,y:le.y,width:Number((ce.x-le.x).toFixed(4)),height:Number((ce.y-le.y).toFixed(4))}}else ae={x:Number(K.x.toFixed(4)),y:Number(K.y.toFixed(4)),width:Number(K.width.toFixed(4)),height:Number(K.height.toFixed(4))};const X=o.testData.words.find(le=>le.blockId===K.id),ie=o.testData.arrows.find(le=>le.startBlock===K.id);return{question_id:Q+1,word:X?.word||`Word ${Q+1}`,block_coordinates:ae,has_arrow:!!ie,arrow:ie&&E?(()=>{const le=F(ie.startX,ie.startY),ce=F(ie.endX,ie.endY),_e=le.x/E.originalWidth*100,ne=le.y/E.originalHeight*100,pe=ce.x/E.originalWidth*100,Ce=ce.y/E.originalHeight*100;return{start_x:Number(le.x.toFixed(4)),start_y:Number(le.y.toFixed(4)),end_x:Number(ce.x.toFixed(4)),end_y:Number(ce.y.toFixed(4)),rel_start_x:Number(_e.toFixed(4)),rel_start_y:Number(ne.toFixed(4)),rel_end_x:Number(pe.toFixed(4)),rel_end_y:Number(Ce.toFixed(4)),image_width:E.originalWidth,image_height:E.originalHeight,style:ie.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log(" [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:o.testData.blocks,words:o.testData.words,arrows:o.testData.arrows,imageUrl:R,processedQuestions:z}))}catch(R){console.error("Save error:",R),u(`Error saving test: ${R.message}`,"error")}finally{c({type:"SET_LOADING",payload:!1})}},[o.testData,o.ui.imageUrl,E,F,d,r,u,e,f]),L=S.useCallback(()=>{const W={};return e.trim()||(W.testName="Test name is required"),o.testData.blocks.length===0&&(W.blocks="At least one block is required"),W},[e,o.testData.blocks.length]),V=()=>l.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[l.jsx(Ze,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"create"}),variant:o.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:" Create Blocks"}),l.jsx(Ze,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:o.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:" Edit Blocks"}),l.jsx(Ze,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:o.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:" Draw Arrows"}),l.jsx(Ze,{onClick:A,variant:"secondary",size:"sm",children:" Reset"}),l.jsx(Ze,{onClick:()=>p.current?.click(),variant:"secondary",size:"sm",children:" Upload Image"}),l.jsx("div",{className:"text-xs text-gray-500 text-center col-span-full",children:"Max size: 500KB  Max dimensions: 4000x4000px"})]}),M=()=>l.jsx(n0,{width:_.width,height:N.stageHeight,ref:k,onMouseDown:I,onMouseMove:B,onMouseUp:Y,onTouchStart:Z,onTouchMove:se,onTouchEnd:ee,className:o.canvas.selectedTool==="arrow"||o.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:l.jsxs(r0,{children:[o.canvas.image&&E&&l.jsx(OL,{image:o.canvas.image,x:E.x,y:E.y,width:E.width,height:E.height}),o.testData.blocks.map(W=>l.jsxs(cc,{ref:R=>{R&&(w.current[W.id]=R)},draggable:o.canvas.selectedTool==="edit",x:W.x,y:W.y,onMouseEnter:R=>{const z=R.target.getStage()?.container();z&&(z.style.cursor=o.ui.selectedBlock?.id===W.id?"nwse-resize":"move")},onMouseLeave:R=>{const z=R.target.getStage()?.container();z&&(z.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:W}})},onDragEnd:R=>{const{x:z,y:K}=R.target.position();c({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{x:z,y:K}}})},onClick:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:W}})},onTap:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:W}})},children:[l.jsx(Ga,{ref:R=>{R&&(v.current[W.id]=R)},width:W.width,height:W.height,fill:W.fill,stroke:W.stroke,strokeWidth:W.strokeWidth,cornerRadius:W.cornerRadius,shadowColor:W.shadowColor,shadowBlur:W.shadowBlur,shadowOffset:W.shadowOffset,shadowOpacity:W.shadowOpacity,draggable:o.canvas.selectedTool==="edit",onDragEnd:R=>{const{x:z,y:K}=R.target.getParent().position();c({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{x:z,y:K}}})},onMouseEnter:R=>{const z=R.target.getStage()?.container();z&&(z.style.cursor=o.ui.selectedBlock?.id===W.id?"nwse-resize":"move")},onMouseLeave:R=>{const z=R.target.getStage()?.container();z&&(z.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:R=>{const z=v.current[W.id];if(!z)return;const K=Math.max(10,z.width()*z.scaleX()),Q=Math.max(10,z.height()*z.scaleY());z.scaleX(1),z.scaleY(1),c({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{width:K,height:Q}}})}}),l.jsx(qc,{x:2,y:2,text:`${o.testData.blocks.indexOf(W)+1}`,fontSize:Math.min(N.fontSize,Math.max(8,W.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},W.id)),l.jsx(DL,{ref:x,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(W,R)=>({...R,width:Math.max(R.width,10),height:Math.max(R.height,10)})}),o.testData.arrows.map(W=>l.jsx(MT,{points:[W.startX,W.startY,W.endX,W.endY],stroke:W.stroke,fill:W.fill,strokeWidth:W.strokeWidth||N.arrowThickness,pointerLength:W.pointerLength,pointerWidth:W.pointerWidth},W.id)),o.creation.previewBlock&&l.jsx(Ga,{x:o.creation.previewBlock.x,y:o.creation.previewBlock.y,width:o.creation.previewBlock.width,height:o.creation.previewBlock.height,fill:o.creation.previewBlock.fill,stroke:o.creation.previewBlock.stroke,strokeWidth:o.creation.previewBlock.strokeWidth,dash:o.creation.previewBlock.dash,opacity:o.creation.previewBlock.opacity}),o.creation.previewArrow&&l.jsx(MT,{points:[o.creation.previewArrow.startX,o.creation.previewArrow.startY,o.creation.previewArrow.endX,o.creation.previewArrow.endY],stroke:o.creation.previewArrow.stroke,fill:o.creation.previewArrow.fill,strokeWidth:o.creation.previewArrow.strokeWidth,dash:o.creation.previewArrow.dash,opacity:o.creation.previewArrow.opacity})]})}),H=S.useMemo(()=>o.testData.blocks.length===0?null:l.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full",style:{height:"min(400px, 40vh)",overflowY:"auto"},children:[l.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),l.jsx("div",{className:"space-y-2",children:o.testData.words.map(W=>{const R=o.testData.blocks.find(z=>z.id===W.blockId);return l.jsxs("div",{className:"p-2 bg-white rounded border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",o.testData.blocks.indexOf(R)+1]}),l.jsx("button",{onClick:()=>c({type:"DELETE_BLOCK",payload:R.id}),className:"text-red-500 hover:text-red-700 text-xs",children:""})]}),l.jsx("input",{type:"text",value:W.word,onChange:z=>{const K=nk.update(o.testData.words,W.blockId,z.target.value);c({type:"UPDATE_WORDS",payload:K})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},W.blockId)})})]}),[o.testData.words,o.testData.blocks]);return l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[l.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("div",{children:l.jsx("div",{className:"mt-2 text-sm text-gray-600",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Questions:"})," ",o.testData.blocks.length," (auto-generated from blocks)"]})]})})})})}),V(),l.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[l.jsx("div",{ref:g,className:"bg-white border overflow-auto",style:{minHeight:`${N.stageHeight}px`,maxHeight:"calc(100vh - 200px)",height:"auto",padding:`${N.padding}px`},children:M()}),H]}),l.jsx("div",{className:"bg-white border-t p-4",children:l.jsx("div",{className:"flex justify-center",children:l.jsx(Ze,{onClick:te,disabled:a||o.ui.isLoading,variant:"primary",size:"lg",children:a||o.ui.isLoading?l.jsx(Wr,{size:"sm"}):"Save Test"})})}),l.jsx("input",{ref:p,type:"file",accept:"image/*,application/pdf",onChange:j,className:"hidden"}),l.jsx(fa,{isOpen:o.ui.showImageSizeModal,onClose:()=>c({type:"HIDE_IMAGE_SIZE_MODAL"}),title:" Image Too Large",size:"medium",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("span",{className:"text-red-600 text-2xl mr-2",children:""}),l.jsx("h4",{className:"text-lg font-semibold text-red-800",children:"Image Size Issues"})]}),l.jsx("div",{className:"text-red-700",children:o.ui.imageSizeError?.errors.map((W,R)=>l.jsxs("div",{className:"mb-2",children:[" ",W]},R))})]}),l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Current Image Details:"}),l.jsxs("div",{className:"text-blue-700 space-y-1",children:[l.jsxs("div",{children:[" File size: ",o.ui.imageSizeError?.fileSize,"KB"]}),o.ui.imageSizeError?.dimensions&&l.jsxs("div",{children:[" Dimensions: ",o.ui.imageSizeError.dimensions.width,"  ",o.ui.imageSizeError.dimensions.height," pixels"]})]})]}),l.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-green-800 mb-2",children:" Requirements:"}),l.jsxs("div",{className:"text-green-700 space-y-1",children:[l.jsx("div",{children:" Maximum file size: 500KB"}),l.jsx("div",{children:" Maximum dimensions: 4000  4000 pixels"}),l.jsx("div",{children:" Supported formats: All image formats (JPEG, PNG, WebP, etc.)"})]})]}),l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-yellow-800 mb-2",children:" How to Fix:"}),l.jsxs("div",{className:"text-yellow-700 space-y-1",children:[l.jsx("div",{children:" Use an image editor to resize your image"}),l.jsx("div",{children:" Compress the image using online tools"}),l.jsx("div",{children:" Try a different image with smaller dimensions"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx(Ze,{onClick:()=>c({type:"HIDE_IMAGE_SIZE_MODAL"}),variant:"secondary",children:"Close"}),l.jsx(Ze,{onClick:()=>{c({type:"HIDE_IMAGE_SIZE_MODAL"}),p.current?.click()},variant:"primary",children:"Try Another Image"})]})]})})]})},zm=S.createContext(null);function lte(e,t){return{getTheme:function(){return t??null}}}function ou(){const e=S.useContext(zm);return e==null&&(function(t,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",t);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(8),e}function Ht(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const vc=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,cte=vc&&"documentMode"in document?document.documentMode:null,Kc=vc&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),s0=vc&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),w_=!(!vc||!("InputEvent"in window)||cte)&&"getTargetRanges"in new window.InputEvent("input"),Ky=vc&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),_m=vc&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,ute=vc&&/Android/.test(navigator.userAgent),IL=vc&&/^(?=.*Chrome).*/i.test(navigator.userAgent),IP=vc&&ute&&IL,__=vc&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!IL;function RL(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}const dte=1,fte=3,hte=9,gte=11,a0=0,ML=1,bm=2,mte=0,pte=1,xte=2,b_=4,S_=8,o4=128,yte=1792|(112|(3|b_|S_)|o4),l4=1,c4=2,u4=3,d4=4,f4=5,h4=6,Gb=Ky||_m||__?"":"",ad=`

`,vte=s0?"":Gb,i0={bold:1,capitalize:1024,code:16,highlight:o4,italic:2,lowercase:256,strikethrough:b_,subscript:32,superscript:64,underline:S_,uppercase:512},wte={directionless:1,unmergeable:2},RP={center:c4,end:h4,justify:d4,left:l4,right:u4,start:f4},_te={[c4]:"center",[h4]:"end",[d4]:"justify",[l4]:"left",[u4]:"right",[f4]:"start"},bte={normal:0,segmented:2,token:1},Ste={[mte]:"normal",[xte]:"segmented",[pte]:"token"},MP="$config";function LL(e,t,r,n,s,a){let i=e.getFirstChild();for(;i!==null;){const o=i.__key;i.__parent===t&&(_t(i)&&LL(i,o,r,n,s,a),r.has(o)||a.delete(o),s.push(o)),i=i.getNextSibling()}}const kte=100;let LT=!1,g4=0;function Cte(e){g4=e.timeStamp}function sk(e,t,r){const n=e.nodeName==="BR",s=t.__lexicalLineBreak;return s&&(e===s||n&&e.previousSibling===s)||n&&t2(e,r)!==void 0}function Tte(e,t,r){const n=pc(Pl(r));let s=null,a=null;n!==null&&n.anchorNode===e&&(s=n.anchorOffset,a=n.focusOffset);const i=e.nodeValue;i!==null&&D4(t,i,s,a,!1)}function Ete(e,t,r){if(Mt(e)){const n=e.anchor.getNode();if(n.is(r)&&e.format!==n.getFormat())return!1}return fd(t)&&r.isAttached()}function Nte(e,t,r,n){for(let s=e;s&&!Nre(s);s=Bv(s)){const a=t2(s,t);if(a!==void 0){const i=ha(a,r);if(i)return _n(i)||!os(s)?void 0:[s,i]}else if(s===n)return[n,D9(r)]}}function BL(e,t,r){LT=!0;const n=performance.now()-g4>kte;try{Ho(e,(()=>{const s=tr()||(function(g){return g.getEditorState().read((()=>{const p=tr();return p!==null?p.clone():null}))})(e),a=new Map,i=e.getRootElement(),o=e._editorState,c=e._blockCursorElement;let u=!1,d="";for(let g=0;g<t.length;g++){const p=t[g],x=p.type,v=p.target,w=Nte(v,e,o,i);if(!w)continue;const[C,k]=w;if(x==="characterData")n&&rr(k)&&fd(v)&&Ete(s,v,k)&&Tte(v,k,e);else if(x==="childList"){u=!0;const _=p.addedNodes;for(let P=0;P<_.length;P++){const F=_[P],A=F9(F),j=F.parentNode;if(j!=null&&F!==c&&A===null&&!sk(F,j,e)){if(s0){const I=(os(F)?F.innerText:null)||F.nodeValue;I&&(d+=I)}j.removeChild(F)}}const N=p.removedNodes,E=N.length;if(E>0){let P=0;for(let F=0;F<E;F++){const A=N[F];(sk(A,v,e)||c===A)&&(v.appendChild(A),P++)}E!==P&&a.set(C,k)}}}if(a.size>0)for(const[g,p]of a)p.reconcileObservedMutation(g,e);const f=r.takeRecords();if(f.length>0){for(let g=0;g<f.length;g++){const p=f[g],x=p.addedNodes,v=p.target;for(let w=0;w<x.length;w++){const C=x[w],k=C.parentNode;k==null||C.nodeName!=="BR"||sk(C,v,e)||k.removeChild(C)}}r.takeRecords()}s!==null&&(u&&vi(s),s0&&L9(e)&&s.insertRawText(d))}))}finally{LT=!1}}function $L(e){const t=e._observer;t!==null&&BL(e,t.takeRecords(),t)}function UL(e){(function(t){g4===0&&Pl(t).addEventListener("textInput",Cte,!0)})(e),e._observer=new MutationObserver(((t,r)=>{BL(e,t,r)}))}function Ate(e){const t=new Map,r=new Set;for(let n=typeof e=="function"?e:e.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=B4(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,t.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:t}}let jte=class zL{constructor(t,r,n=void 0,s=new Map,a=void 0){this.node=t,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,o=a!==void 0?a:(function(c,u,d){let f=d.size;if(u)for(const g in u){const p=c.get(g);p&&d.has(p)||f++}return f})(i,n,s);this.size=o}getValue(t){const r=this.knownState.get(t);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(t.key,t);let n=t.defaultValue;if(this.unknownState&&t.key in this.unknownState){const s=this.unknownState[t.key];s!==void 0&&(n=t.parse(s)),this.updateFromKnown(t,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const t={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete t[n.key]:t[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in t&&(r[n]=t[n],delete t[n]);return LP(t)&&(r.$=t),r}getWritable(t){if(this.node===t)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new zL(t,r,(function(a,i,o){let c;if(o)for(const[u,d]of Object.entries(o)){const f=a.get(u);f?i.has(f)||i.set(f,f.parse(d)):(c=c||{},c[u]=d)}return c})(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(t,r){const n=t.key;this.sharedNodeState.sharedConfigMap.set(n,t);const{knownState:s,unknownState:a}=this;s.has(t)||a&&n in a||(a&&(delete a[n],this.unknownState=LP(a)),this.size++),s.set(t,r)}updateFromUnknown(t,r){const n=this.sharedNodeState.sharedConfigMap.get(t);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},t in this.unknownState||this.size++,this.unknownState[t]=r)}updateFromJSON(t){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,t)for(const[n,s]of Object.entries(t))this.updateFromUnknown(n,s)}};function Pte(e){const t=e.getWritable(),r=t.__state?t.__state.getWritable(t):new jte(t,WL(t));return t.__state=r,r}function WL(e){return e.__state?e.__state.sharedNodeState:A9($v(),e.getType()).sharedNodeState}function LP(e){if(e)for(const t in e)return e}function BP(e,t,r){for(const[n,s]of t.knownState){if(e.has(n.key))continue;e.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function $P(e,t,r){const{unknownState:n}=t,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!e.has(a)&&(e.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function UP(e,t){const r=e.__state;return r&&r.node===e?r.getWritable(t):r}function zP(e,t){const r=e.__mode,n=e.__format,s=e.__style,a=t.__mode,i=t.__format,o=t.__style,c=e.__state,u=t.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===o)&&(e.__state===null||c===u||(function(d,f){if(d===f)return!0;if(d&&f&&d.size!==f.size)return!1;const g=new Set;return!(d&&BP(g,d,f)||f&&BP(g,f,d)||d&&$P(g,d,f)||f&&$P(g,f,d))})(c,u))}function WP(e,t){const r=e.mergeWithSibling(t),n=Cs()._normalizedNodes;return n.add(e.__key),n.add(t.__key),r}function HP(e){let t,r,n=e;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(t=n.getPreviousSibling())!==null&&rr(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(t.__text!==""){if(zP(t,n)){n=WP(t,n);break}break}t.remove()}for(;(r=n.getNextSibling())!==null&&rr(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(zP(n,r)){n=WP(n,r);break}break}r.remove()}}else n.remove()}function k_(e){return GP(e.anchor),GP(e.focus),e}function GP(e){for(;e.type==="element";){const t=e.getNode(),r=e.offset;let n,s;if(r===t.getChildrenSize()?(n=t.getChildAtIndex(r-1),s=!0):(n=t.getChildAtIndex(r),s=!1),rr(n)){e.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!_t(n))break;e.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let o0,Li,qy,Vb,BT,$T,l0,fc,UT,Yy,ka="",Gc=null,Vc="",zu="",Wg=!1,C_=!1;function T_(e,t){const r=l0.get(e);if(t!==null){const n=GT(e);n.parentNode===t&&t.removeChild(n)}if(fc.has(e)||Li._keyToDOMMap.delete(e),_t(r)){const n=N_(r,l0);zT(n,0,n.length-1,null)}r!==void 0&&I4(Yy,qy,Vb,r,"destroyed")}function zT(e,t,r,n){let s=t;for(;s<=r;++s){const a=e[s];a!==void 0&&T_(a,n)}}function Ch(e,t){e.setProperty("text-align",t)}const Fte="40px";function HL(e,t){const r=o0.theme.indent;if(typeof r=="string"){const s=e.classList.contains(r);t>0&&!s?e.classList.add(r):t<1&&s&&e.classList.remove(r)}const n=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||Fte;e.style.setProperty("padding-inline-start",t===0?"":`calc(${t} * ${n})`)}function GL(e,t){const r=e.style;t===0?Ch(r,""):t===l4?Ch(r,"left"):t===c4?Ch(r,"center"):t===u4?Ch(r,"right"):t===d4?Ch(r,"justify"):t===f4?Ch(r,"start"):t===h4&&Ch(r,"end")}function WT(e,t){const r=(function(n){const s=n.__dir;if(s!==null)return s;if(Ea(n))return null;const a=n.getParentOrThrow();return Ea(a)&&a.__dir===null?"auto":null})(t);r!==null?e.dir=r:e.removeAttribute("dir")}function E_(e,t){const r=fc.get(e);r===void 0&&Ht(60);const n=r.createDOM(o0,Li);if((function(s,a,i){const o=i._keyToDOMMap;(function(c,u,d){const f=`__lexicalKey_${u._key}`;c[f]=d})(a,i,s),o.set(s,a)})(e,n,Li),rr(r)?n.setAttribute("data-lexical-text","true"):_n(r)&&n.setAttribute("data-lexical-decorator","true"),_t(r)){const s=r.__indent,a=r.__size;if(WT(n,r),s!==0&&HL(n,s),a!==0){const o=a-1;HT(N_(r,fc),r,0,o,r.getDOMSlot(n))}const i=r.__format;i!==0&&GL(n,i),r.isInline()||VL(null,r,n),r2(r)&&(ka+=ad,zu+=ad)}else{const s=r.getTextContent();if(_n(r)){const a=r.decorate(Li,o0);a!==null&&KL(e,a),n.contentEditable="false"}ka+=s,zu+=s}return t!==null&&t.insertChild(n),I4(Yy,qy,Vb,r,"created"),n}function HT(e,t,r,n,s){const a=ka;ka="";let i=r;for(;i<=n;++i){E_(e[i],s);const o=fc.get(e[i]);o!==null&&rr(o)&&(Gc===null&&(Gc=o.getFormat()),Vc===""&&(Vc=o.getStyle()))}r2(t)&&(ka+=ad),s.element.__lexicalTextContent=ka,ka=a+ka}function VP(e,t){if(e){const r=e.__last;if(r){const n=t.get(r);if(n)return Qu(n)?"line-break":_n(n)&&n.isInline()?"decorator":null}return"empty"}return null}function VL(e,t,r){const n=VP(e,l0),s=VP(t,fc);n!==s&&t.getDOMSlot(r).setManagedLineBreak(s)}function Ote(e,t,r){var n;Gc=null,Vc="",(function(s,a,i){const o=ka,c=s.__size,u=a.__size;ka="";const d=i.element;if(c===1&&u===1){const f=s.__first,g=a.__first;if(f===g)cy(f,d);else{const x=GT(f),v=E_(g,null);try{d.replaceChild(v,x)}catch(w){if(typeof w=="object"&&w!=null){const C=`${w.toString()} Parent: ${d.tagName}, new child: {tag: ${v.tagName} key: ${g}}, old child: {tag: ${x.tagName}, key: ${f}}.`;throw new Error(C)}throw w}T_(f,null)}const p=fc.get(g);rr(p)&&(Gc===null&&(Gc=p.getFormat()),Vc===""&&(Vc=p.getStyle()))}else{const f=N_(s,l0),g=N_(a,fc);if(f.length!==c&&Ht(227),g.length!==u&&Ht(228),c===0)u!==0&&HT(g,a,0,u-1,i);else if(u===0){if(c!==0){const p=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;zT(f,0,c-1,p?null:d),p&&(d.textContent="")}}else(function(p,x,v,w,C,k){const _=w-1,N=C-1;let E,P,F=k.getFirstChild(),A=0,j=0;for(;A<=_&&j<=N;){const Y=x[A],Z=v[j];if(Y===Z)F=ak(cy(Z,k.element)),A++,j++;else{E===void 0&&(E=new Set(x)),P===void 0&&(P=new Set(v));const ee=P.has(Y),te=E.has(Z);if(ee)if(te){const L=c0(Li,Z);L===F?F=ak(cy(Z,k.element)):(k.withBefore(F).insertChild(L),cy(Z,k.element)),A++,j++}else E_(Z,k.withBefore(F)),j++;else F=ak(GT(Y)),T_(Y,k.element),A++}const se=fc.get(Z);se!==null&&rr(se)&&(Gc===null&&(Gc=se.getFormat()),Vc===""&&(Vc=se.getStyle()))}const I=A>_,B=j>N;if(I&&!B){const Y=v[N+1],Z=Y===void 0?null:Li.getElementByKey(Y);HT(v,p,j,N,k.withBefore(Z))}else B&&!I&&zT(x,A,_,k.element)})(a,f,g,c,u,i)}r2(a)&&(ka+=ad),d.__lexicalTextContent=ka,ka=o+ka})(e,t,t.getDOMSlot(r)),n=t,Gc==null||Gc===n.__textFormat||C_||n.setTextFormat(Gc),(function(s){Vc===""||Vc===s.__textStyle||C_||s.setTextStyle(Vc)})(t)}function N_(e,t){const r=[];let n=e.__first;for(;n!==null;){const s=t.get(n);s===void 0&&Ht(101),r.push(n),n=s.__next}return r}function cy(e,t){const r=l0.get(e);let n=fc.get(e);r!==void 0&&n!==void 0||Ht(61);const s=Wg||$T.has(e)||BT.has(e),a=c0(Li,e);if(r===n&&!s){if(_t(r)){const i=a.__lexicalTextContent;i!==void 0&&(ka+=i,zu+=i)}else{const i=r.getTextContent();zu+=i,ka+=i}return a}if(r!==n&&s&&I4(Yy,qy,Vb,n,"updated"),n.updateDOM(r,a,o0)){const i=E_(e,null);return t===null&&Ht(62),t.replaceChild(i,a),T_(e,null),i}if(_t(r)&&_t(n)){const i=n.__indent;(Wg||i!==r.__indent)&&HL(a,i);const o=n.__format;if((Wg||o!==r.__format)&&GL(a,o),s&&(Ote(r,n,a),Ea(n)||n.isInline()||VL(r,n,a)),r2(n)&&(ka+=ad,zu+=ad),(Wg||n.__dir!==r.__dir)&&(WT(a,n),Ea(n)&&!Wg))for(const c of n.getChildren())_t(c)&&WT(c0(Li,c.getKey()),c)}else{const i=n.getTextContent();if(_n(n)){const o=n.decorate(Li,o0);o!==null&&KL(e,o)}ka+=i,zu+=i}if(!C_&&Ea(n)&&n.__cachedText!==zu){const i=n.getWritable();i.__cachedText=zu,n=i}return a}function KL(e,t){let r=Li._pendingDecorators;const n=Li._decorators;if(r===null){if(n[e]===t)return;r=O9(Li)}r[e]=t}function ak(e){let t=e.nextSibling;return t!==null&&t===Li._blockCursorElement&&(t=t.nextSibling),t}function Dte(e,t,r,n,s,a){ka="",zu="",Wg=n===bm,Li=r,o0=r._config,qy=r._nodes,Vb=Li._listeners.mutation,BT=s,$T=a,l0=e._nodeMap,fc=t._nodeMap,C_=t._readOnly,UT=new Map(r._keyToDOMMap);const i=new Map;return Yy=i,cy("root",null),Li=void 0,qy=void 0,BT=void 0,$T=void 0,l0=void 0,fc=void 0,o0=void 0,UT=void 0,Yy=void 0,i}function GT(e){const t=UT.get(e);return t===void 0&&Ht(75,e),t}function Ir(e){return{type:e}}const qL=Ir("SELECTION_CHANGE_COMMAND"),Ite=Ir("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),m4=Ir("CLICK_COMMAND"),Gh=Ir("DELETE_CHARACTER_COMMAND"),im=Ir("INSERT_LINE_BREAK_COMMAND"),Xy=Ir("INSERT_PARAGRAPH_COMMAND"),om=Ir("CONTROLLED_TEXT_INSERTION_COMMAND"),p4=Ir("PASTE_COMMAND"),VT=Ir("REMOVE_TEXT_COMMAND"),Qy=Ir("DELETE_WORD_COMMAND"),Jy=Ir("DELETE_LINE_COMMAND"),Mi=Ir("FORMAT_TEXT_COMMAND"),x4=Ir("UNDO_COMMAND"),y4=Ir("REDO_COMMAND"),Rte=Ir("KEYDOWN_COMMAND"),YL=Ir("KEY_ARROW_RIGHT_COMMAND"),Mte=Ir("MOVE_TO_END"),XL=Ir("KEY_ARROW_LEFT_COMMAND"),Lte=Ir("MOVE_TO_START"),QL=Ir("KEY_ARROW_UP_COMMAND"),JL=Ir("KEY_ARROW_DOWN_COMMAND"),A_=Ir("KEY_ENTER_COMMAND"),ZL=Ir("KEY_SPACE_COMMAND"),e9=Ir("KEY_BACKSPACE_COMMAND"),t9=Ir("KEY_ESCAPE_COMMAND"),r9=Ir("KEY_DELETE_COMMAND"),n9=Ir("KEY_TAB_COMMAND"),Bte=Ir("INSERT_TAB_COMMAND"),$te=Ir("INDENT_CONTENT_COMMAND"),KP=Ir("OUTDENT_CONTENT_COMMAND"),s9=Ir("DROP_COMMAND"),a9=Ir("FORMAT_ELEMENT_COMMAND"),i9=Ir("DRAGSTART_COMMAND"),o9=Ir("DRAGOVER_COMMAND"),Ute=Ir("DRAGEND_COMMAND"),Kb=Ir("COPY_COMMAND"),v4=Ir("CUT_COMMAND"),KT=Ir("SELECT_ALL_COMMAND"),zte=Ir("CLEAR_EDITOR_COMMAND"),Wte=Ir("CLEAR_HISTORY_COMMAND"),xw=Ir("CAN_REDO_COMMAND"),yw=Ir("CAN_UNDO_COMMAND"),Hte=Ir("FOCUS_COMMAND"),Gte=Ir("BLUR_COMMAND"),Vte=Ir("KEY_MODIFIER_COMMAND"),Lu=Object.freeze({}),qT=30,YT=[["keydown",function(e,t){if(by=e.timeStamp,l9=e.key,!t.isComposing()&&!hr(t,Rte,e)&&e.key!=null){if(ik&&_8(e))return Ho(t,(()=>{vw(t,ok)})),ik=!1,void(ok="");if((function(r){return On(r,"ArrowRight",{shiftKey:"any"})})(e))hr(t,YL,e);else if((function(r){return On(r,"ArrowRight",$u)})(e))hr(t,Mte,e);else if((function(r){return On(r,"ArrowLeft",{shiftKey:"any"})})(e))hr(t,XL,e);else if((function(r){return On(r,"ArrowLeft",$u)})(e))hr(t,Lte,e);else if((function(r){return On(r,"ArrowUp",{altKey:"any",shiftKey:"any"})})(e))hr(t,QL,e);else if((function(r){return On(r,"ArrowDown",{altKey:"any",shiftKey:"any"})})(e))hr(t,JL,e);else if((function(r){return On(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})})(e))Sy=!0,hr(t,A_,e);else if((function(r){return r.key===" "})(e))hr(t,ZL,e);else if((function(r){return Kc&&On(r,"o",{ctrlKey:!0})})(e))e.preventDefault(),Sy=!0,hr(t,im,!0);else if((function(r){return On(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})})(e))Sy=!1,hr(t,A_,e);else if((function(r){return On(r,"Backspace",{shiftKey:"any"})||Kc&&On(r,"h",{ctrlKey:!0})})(e))_8(e)?hr(t,e9,e):(e.preventDefault(),hr(t,Gh,!0));else if((function(r){return r.key==="Escape"})(e))hr(t,t9,e);else if((function(r){return On(r,"Delete",{})||Kc&&On(r,"d",{ctrlKey:!0})})(e))(function(r){return r.key==="Delete"})(e)?hr(t,r9,e):(e.preventDefault(),hr(t,Gh,!1));else if((function(r){return On(r,"Backspace",w8)})(e))e.preventDefault(),hr(t,Qy,!0);else if((function(r){return On(r,"Delete",w8)})(e))e.preventDefault(),hr(t,Qy,!1);else if((function(r){return Kc&&On(r,"Backspace",{metaKey:!0})})(e))e.preventDefault(),hr(t,Jy,!0);else if((function(r){return Kc&&(On(r,"Delete",{metaKey:!0})||On(r,"k",{ctrlKey:!0}))})(e))e.preventDefault(),hr(t,Jy,!1);else if((function(r){return On(r,"b",$u)})(e))e.preventDefault(),hr(t,Mi,"bold");else if((function(r){return On(r,"u",$u)})(e))e.preventDefault(),hr(t,Mi,"underline");else if((function(r){return On(r,"i",$u)})(e))e.preventDefault(),hr(t,Mi,"italic");else if((function(r){return On(r,"Tab",{shiftKey:"any"})})(e))hr(t,n9,e);else if((function(r){return On(r,"z",$u)})(e))e.preventDefault(),hr(t,x4,void 0);else if((function(r){return Kc?On(r,"z",{metaKey:!0,shiftKey:!0}):On(r,"y",{ctrlKey:!0})||On(r,"z",{ctrlKey:!0,shiftKey:!0})})(e))e.preventDefault(),hr(t,y4,void 0);else{const r=t._editorState._selection;r===null||Mt(r)?b8(e)&&(e.preventDefault(),hr(t,KT,e)):(function(n){return On(n,"c",$u)})(e)?(e.preventDefault(),hr(t,Kb,e)):(function(n){return On(n,"x",$u)})(e)?(e.preventDefault(),hr(t,v4,e)):b8(e)&&(e.preventDefault(),hr(t,KT,e))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(e)&&hr(t,Vte,e)}}],["pointerdown",function(e,t){const r=e.target,n=e.pointerType;Vm(r)&&n!=="touch"&&n!=="pen"&&e.button===0&&Ho(t,(()=>{x8(r)||(QT=!0)}))}],["compositionstart",function(e,t){Ho(t,(()=>{const r=tr();if(Mt(r)&&!t.isComposing()){const n=r.anchor,s=r.anchor.getNode();gi(n.key),(e.timeStamp<by+qT||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||rr(s)&&s.getStyle()!==r.style)&&hr(t,om,vte)}}))}],["compositionend",function(e,t){s0?qx=!0:_m||!Ky&&!__?Ho(t,(()=>{vw(t,e.data)})):(ik=!0,ok=e.data)}],["input",function(e,t){e.stopPropagation(),Ho(t,(()=>{if(os(e.target)&&x8(e.target))return;const r=tr(),n=e.data,s=h9(e);if(n!=null&&Mt(r)&&d9(r,s,n,e.timeStamp,!1)){qx&&(vw(t,n),qx=!1);const a=r.anchor.getNode(),i=pc(Pl(t));if(i===null)return;const o=r.isBackward(),c=o?r.anchor.offset:r.focus.offset,u=o?r.focus.offset:r.anchor.offset;w_&&!r.isCollapsed()&&rr(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,c)+n+a.getTextContent().slice(c+u)===M9(i.anchorNode)||hr(t,om,n);const d=n.length;s0&&d>1&&e.inputType==="insertCompositionText"&&!t.isComposing()&&(r.anchor.offset-=d),Ky||_m||__||!t.isComposing()||(by=0,gi(null))}else O4(!1,t,n!==null?n:void 0),qx&&(vw(t,n||void 0),qx=!1);(function(){hi();const a=Cs();$L(a)})()}),{event:e}),Hg=null}],["click",function(e,t){Ho(t,(()=>{const r=tr(),n=pc(Pl(t)),s=Gm();if(n){if(Mt(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!Ea(i)&&ys().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(e.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const o=(function(c,u){let d=c;for(;d!==ys()&&d!=null;){if(u(d))return d;d=d.getParent()}return null})(i,(c=>_t(c)&&!c.isInline()));_t(o)&&o.select(0)}}else if(e.pointerType==="touch"||e.pointerType==="pen"){const a=n.anchorNode;(os(a)||fd(a))&&vi(b4(s,n,t,e))}}hr(t,m4,e)}))}],["cut",Lu],["copy",Lu],["dragstart",Lu],["dragover",Lu],["dragend",Lu],["paste",Lu],["focus",Lu],["blur",Lu],["drop",Lu]];w_&&YT.push(["beforeinput",(e,t)=>(function(r,n){const s=r.inputType,a=h9(r);s==="deleteCompositionText"||s0&&L9(n)||s!=="insertCompositionText"&&Ho(n,(()=>{const i=tr();if(s==="deleteContentBackward"){if(i===null){const p=Gm();if(!Mt(p))return;vi(p.clone())}if(Mt(i)){const p=i.anchor.key===i.focus.key;if(o=r.timeStamp,l9==="MediaLast"&&o<by+qT&&n.isComposing()&&p){if(gi(null),by=0,setTimeout((()=>{Ho(n,(()=>{gi(null)}))}),qT),Mt(i)){const x=i.anchor.getNode();x.markDirty(),rr(x)||Ht(142),f9(i,x)}}else{gi(null),r.preventDefault();const x=i.anchor.getNode(),v=x.getTextContent(),w=x.canInsertTextAfter(),C=i.anchor.offset===0&&i.focus.offset===v.length;let k=IP&&p&&!C&&w;if(k&&i.isCollapsed()&&(k=!_n(rE(i.anchor,!0))),!k){hr(n,Gh,!0);const _=tr();IP&&Mt(_)&&_.isCollapsed()&&(Fh=_,setTimeout((()=>Fh=null)))}}return}}var o;if(!Mt(i))return;const c=r.data;Hg!==null&&O4(!1,n,Hg),i.dirty&&Hg===null||!i.isCollapsed()||Ea(i.anchor.getNode())||a===null||i.applyDOMRange(a),Hg=null;const u=i.anchor,d=i.focus,f=u.getNode(),g=d.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":hr(n,om,r);break;case"insertFromComposition":gi(null),hr(n,om,r);break;case"insertLineBreak":gi(null),hr(n,im,!1);break;case"insertParagraph":gi(null),Sy&&!_m?(Sy=!1,hr(n,im,!1)):hr(n,Xy,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":hr(n,p4,r);break;case"deleteByComposition":(function(p,x){return p!==x||_t(p)||_t(x)||!Vh(p)||!Vh(x)})(f,g)&&hr(n,VT,r);break;case"deleteByDrag":case"deleteByCut":hr(n,VT,r);break;case"deleteContent":hr(n,Gh,!1);break;case"deleteWordBackward":hr(n,Qy,!0);break;case"deleteWordForward":hr(n,Qy,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":hr(n,Jy,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":hr(n,Jy,!1);break;case"formatStrikeThrough":hr(n,Mi,"strikethrough");break;case"formatBold":hr(n,Mi,"bold");break;case"formatItalic":hr(n,Mi,"italic");break;case"formatUnderline":hr(n,Mi,"underline");break;case"historyUndo":hr(n,x4,void 0);break;case"historyRedo":hr(n,y4,void 0)}else{if(c===`
`)r.preventDefault(),hr(n,im,!1);else if(c===ad)r.preventDefault(),hr(n,Xy,void 0);else if(c==null&&r.dataTransfer){const p=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(p)}else c!=null&&d9(i,a,c,r.timeStamp,!0)?(r.preventDefault(),hr(n,om,c)):Hg=c;c9=r.timeStamp}}))})(e,t)]);let by=0,l9=null,c9=0,Hg=null;const j_=new WeakMap;let XT=!1,QT=!1,Sy=!1,qx=!1,ik=!1,ok="",Fh=null,u9=[0,"",0,"root",0];function d9(e,t,r,n,s){const a=e.anchor,i=e.focus,o=a.getNode(),c=Cs(),u=pc(Pl(c)),d=u!==null?u.anchorNode:null,f=a.key,g=c.getElementByKey(f),p=r.length;return f!==i.key||!rr(o)||(!s&&(!w_||c9<n+50)||o.isDirty()&&p<2||I9(r))&&a.offset!==i.offset&&!o.isComposing()||Uu(o)||o.isDirty()&&p>1||(s||!w_)&&g!==null&&!o.isComposing()&&d!==Sm(g)||u!==null&&t!==null&&(!t.collapsed||t.startContainer!==u.anchorNode||t.startOffset!==u.anchorOffset)||o.getFormat()!==e.format||o.getStyle()!==e.style||(function(x,v){if(v.isSegmented())return!0;if(!x.isCollapsed())return!1;const w=x.anchor.offset,C=v.getParentOrThrow(),k=Vh(v);return w===0?!v.canInsertTextBefore()||!C.canInsertTextBefore()&&!v.isComposing()||k||(function(_){const N=_.getPreviousSibling();return(rr(N)||_t(N)&&N.isInline())&&!N.canInsertTextAfter()})(v):w===v.getTextContentSize()&&(!v.canInsertTextAfter()||!C.canInsertTextAfter()&&!v.isComposing()||k)})(e,o)}function qP(e,t){return fd(e)&&e.nodeValue!==null&&t!==0&&t!==e.nodeValue.length}function YP(e,t,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=e;XT&&(XT=!1,qP(n,s)&&qP(a,i)&&!Fh)||Ho(t,(()=>{if(!r)return void vi(null);if(!Lv(t,n,a))return;let o=tr();if(Fh&&Mt(o)&&o.isCollapsed()){const c=o.anchor,u=Fh.anchor;(c.key===u.key&&c.offset===u.offset+1||c.offset===1&&u.getNode().is(c.getNode().getPreviousSibling()))&&(o=Fh.clone(),vi(o))}if(Fh=null,Mt(o)){const c=o.anchor,u=c.getNode();if(o.isCollapsed()){e.type==="Range"&&e.anchorNode===e.focusNode&&(o.dirty=!0);const d=Pl(t).event,f=d?d.timeStamp:performance.now(),[g,p,x,v,w]=u9,C=ys(),k=t.isComposing()===!1&&C.getTextContent()==="";if(f<w+200&&c.offset===x&&c.key===v)i_(o,g,p);else if(c.type==="text")rr(u)||Ht(141),f9(o,u);else if(c.type==="element"&&!k){_t(u)||Ht(259);const _=c.getNode();_.isEmpty()?(function(N,E){const P=E.getTextFormat(),F=E.getTextStyle();i_(N,P,F)})(o,_):i_(o,0,"")}}else{const d=c.key,f=o.focus.key,g=o.getNodes(),p=g.length,x=o.isBackward(),v=x?i:s,w=x?s:i,C=x?f:d,k=x?d:f;let _=yte,N=!1;for(let E=0;E<p;E++){const P=g[E],F=P.getTextContentSize();if(rr(P)&&F!==0&&!(E===0&&P.__key===C&&v===F||E===p-1&&P.__key===k&&w===0)&&(N=!0,_&=P.getFormat(),_===0))break}o.format=N?_:0}}hr(t,qL,void 0)}))}function i_(e,t,r){e.format===t&&e.style===r||(e.format=t,e.style=r,e.dirty=!0)}function f9(e,t){i_(e,t.getFormat(),t.getStyle())}function h9(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return t.length===0?null:t[0]}function vw(e,t){const r=e._compositionKey;if(gi(null),r!==null&&t!=null){if(t===""){const n=ha(r),s=Sm(e.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&rr(n)&&D4(n,s.nodeValue,null,null,!0))}if(t[t.length-1]===`
`){const n=tr();if(Mt(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void hr(e,A_,null)}}}O4(!0,e,t)}function g9(e){let t=e.__lexicalEventHandles;return t===void 0&&(t=[],e.__lexicalEventHandles=t),t}const lm=new Map;function m9(e){const t=Cre(e.target);if(t===null)return;const r=j9(t.anchorNode);if(r===null)return;QT&&(QT=!1,Ho(r,(()=>{const c=Gm(),u=t.anchorNode;(os(u)||fd(u))&&vi(b4(c,t,r,e))})));const n=F4(r),s=n[n.length-1],a=s._key,i=lm.get(a),o=i||s;o!==r&&YP(t,o,!1),YP(t,r,!0),r!==s?lm.set(a,r):i&&lm.delete(a)}function XP(e){e._lexicalHandled=!0}function QP(e){return e._lexicalHandled===!0}function Kte(e){const t=e.ownerDocument,r=j_.get(t);if(r===void 0)return;const n=r-1;n>=0||Ht(164),j_.set(t,n),n===0&&t.removeEventListener("selectionchange",m9);const s=e2(e);P4(s)?((function(i){if(i._parentEditor!==null){const o=F4(i),c=o[o.length-1]._key;lm.get(c)===i&&lm.delete(c)}else lm.delete(i._key)})(s),e.__lexicalEditor=null):s&&Ht(198);const a=g9(e);for(let i=0;i<a.length;i++)a[i]();e.__lexicalEventHandles=[]}function JT(e,t,r){hi();const n=e.__key,s=e.getParent();if(s===null)return;const a=(function(o){const c=tr();if(!Mt(c)||!_t(o))return c;const{anchor:u,focus:d}=c,f=u.getNode(),g=d.getNode();return nE(f,o)&&u.set(o.__key,0,"element"),nE(g,o)&&d.set(o.__key,0,"element"),c})(e);let i=!1;if(Mt(a)&&t){const o=a.anchor,c=a.focus;o.key===n&&(F_(o,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0),c.key===n&&(F_(c,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0)}else Ai(a)&&t&&e.isSelected()&&e.selectPrevious();if(Mt(a)&&t&&!i){const o=e.getIndexWithinParent();Kh(e),P_(a,s,o,-1)}else Kh(e);r||io(s)||s.canBeEmpty()||!s.isEmpty()||JT(s,t),t&&a&&Ea(s)&&s.isEmpty()&&s.selectEnd()}class Wm{static getType(){const{ownNodeType:t}=B4(this);return t===void 0&&Ht(64,this.name),t}static clone(t){Ht(65,this.name)}$config(){return{}}config(t,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:t}),{[t]:r}}afterCloneFrom(t){this.__key===t.__key?(this.__parent=t.__parent,this.__next=t.__next,this.__prev=t.__prev,this.__state=t.__state):t.__state&&(this.__state=t.__state.getWritable(this))}constructor(t){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),xre(this,t)}getType(){return this.__type}isInline(){Ht(137,this.constructor.name)}isAttached(){let t=this.__key;for(;t!==null;){if(t==="root")return!0;const r=ha(t);if(r===null)break;t=r.__parent}return!1}isSelected(t){const r=t||tr();if(r==null)return!1;const n=r.getNodes().some((s=>s.__key===this.__key));if(rr(this))return n;if(Mt(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(_n(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const t=this.getParent();if(t===null)return-1;let r=t.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const t=this.getLatest().__parent;return t===null?null:ha(t)}getParentOrThrow(){const t=this.getParent();return t===null&&Ht(66,this.__key),t}getTopLevelElement(){let t=this;for(;t!==null;){const r=t.getParent();if(io(r))return _t(t)||t===this&&_n(t)||Ht(194),t;t=r}return null}getTopLevelElementOrThrow(){const t=this.getTopLevelElement();return t===null&&Ht(67,this.__key),t}getParents(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r),r=r.getParent();return t}getParentKeys(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r.__key),r=r.getParent();return t}getPreviousSibling(){const t=this.getLatest().__prev;return t===null?null:ha(t)}getPreviousSiblings(){const t=[],r=this.getParent();if(r===null)return t;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)t.push(n),n=n.getNextSibling();return t}getNextSibling(){const t=this.getLatest().__next;return t===null?null:ha(t)}getNextSiblings(){const t=[];let r=this.getNextSibling();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getCommonAncestor(t){const r=_t(this)?this:this.getParent(),n=_t(t)?t:t.getParent(),s=r&&n?l_(r,n):null;return s?s.commonAncestor:null}is(t){return t!=null&&this.__key===t.__key}isBefore(t){const r=l_(this,t);return r!==null&&(r.type==="descendant"||(r.type==="branch"?z9(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&Ht(279),!1)))}isParentOf(t){const r=l_(this,t);return r!==null&&r.type==="ancestor"}getNodesBetween(t){const r=this.isBefore(t),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===t)break;const o=_t(a)?r?a.getFirstChild():a.getLastChild():null;if(o!==null){a=o;continue}const c=r?a.getNextSibling():a.getPreviousSibling();if(c!==null){a=c;continue}const u=a.getParentOrThrow();if(s.has(u.__key)||n.push(u),u===t)break;let d=null,f=u;do{if(f===null&&Ht(68),d=r?f.getNextSibling():f.getPreviousSibling(),f=f.getParent(),f===null)break;d!==null||s.has(f.__key)||n.push(f)}while(d===null);a=d}return r||n.reverse(),n}isDirty(){const t=Cs()._dirtyLeaves;return t!==null&&t.has(this.__key)}getLatest(){const t=ha(this.__key);return t===null&&Ht(113),t}getWritable(){hi();const t=Bf(),r=Cs(),n=t._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,o=tr();if(o!==null&&o.setCachedNodes(null),i.has(s))return I_(a),a;const c=M4(a);return i.add(s),I_(c),n.set(s,c),c}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(t,r){Ht(70)}updateDOM(t,r,n){Ht(71)}exportDOM(t){return{element:this.createDOM(t._config,t)}}exportJSON(){const t=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...t}}static importJSON(t){Ht(18,this.name)}updateFromJSON(t){return(function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const o of WL(s).flatKeys)o in n&&(i!==void 0&&i!==a||(i={...a}),i[o]=n[o]);return(s.__state||i)&&Pte(r).updateFromJSON(i),s})(this,t)}static transform(){return null}remove(t){JT(this,!0,t)}replace(t,r){hi();let n=tr();n!==null&&(n=n.clone()),hk(this,t);const s=this.getLatest(),a=this.__key,i=t.__key,o=t.getWritable(),c=this.getParentOrThrow().getWritable(),u=c.__size;Kh(o);const d=s.getPreviousSibling(),f=s.getNextSibling(),g=s.__prev,p=s.__next,x=s.__parent;if(JT(s,!1,!0),d===null?c.__first=i:d.getWritable().__next=i,o.__prev=g,f===null?c.__last=i:f.getWritable().__prev=i,o.__next=p,o.__parent=x,c.__size=u,r&&(_t(this)&&_t(o)||Ht(139),this.getChildren().forEach((v=>{o.append(v)}))),Mt(n)){vi(n);const v=n.anchor,w=n.focus;v.key===a&&t8(v,o),w.key===a&&t8(w,o)}return mf()===a&&gi(i),o}insertAfter(t,r=!0){hi(),hk(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.getParent(),i=tr();let o=!1,c=!1;if(a!==null){const p=t.getIndexWithinParent();if(Kh(s),Mt(i)){const x=a.__key,v=i.anchor,w=i.focus;o=v.type==="element"&&v.key===x&&v.offset===p+1,c=w.type==="element"&&w.key===x&&w.offset===p+1}}const u=this.getNextSibling(),d=this.getParentOrThrow().getWritable(),f=s.__key,g=n.__next;if(u===null?d.__last=f:u.getWritable().__prev=f,d.__size++,n.__next=f,s.__next=g,s.__prev=n.__key,s.__parent=n.__parent,r&&Mt(i)){const p=this.getIndexWithinParent();P_(i,d,p+1);const x=d.__key;o&&i.anchor.set(x,p+2,"element"),c&&i.focus.set(x,p+2,"element")}return t}insertBefore(t,r=!0){hi(),hk(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.__key;Kh(s);const i=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),c=n.__prev,u=this.getIndexWithinParent();i===null?o.__first=a:i.getWritable().__next=a,o.__size++,n.__prev=a,s.__prev=c,s.__next=n.__key,s.__parent=n.__parent;const d=tr();return r&&Mt(d)&&P_(d,this.getParentOrThrow(),u),t}isParentRequired(){return!1}createParentElementNode(){return is()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(t,r){hi();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(_t(n))return n.select();if(!rr(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(t,r)}selectNext(t,r){hi();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(_t(n))return n.select(0,0);if(!rr(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(t,r)}markDirty(){this.getWritable()}reconcileObservedMutation(t,r){this.markDirty()}}class Ov extends Wm{static getType(){return"linebreak"}static clone(t){return new Ov(t.__key)}constructor(t){super(t)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:t=>(function(r){const n=r.parentElement;if(n!==null&&R_(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&ww(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&ww(a))return!0}}return!1})(t)||(function(r){const n=r.parentElement;if(n!==null&&R_(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&ww(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&ww(a))return!0}return!1})(t)?null:{conversion:qte,priority:0}}}static importJSON(t){return nu().updateFromJSON(t)}}function qte(e){return{node:nu()}}function nu(){return co(new Ov)}function Qu(e){return e instanceof Ov}function ww(e){return fd(e)&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function lk(e,t){return 16&t?"code":t&o4?"mark":32&t?"sub":64&t?"sup":null}function ck(e,t){return 1&t?"strong":2&t?"em":"span"}function p9(e,t,r,n,s){const a=n.classList;let i=cm(s,"base");i!==void 0&&a.add(...i),i=cm(s,"underlineStrikethrough");let o=!1;const c=t&S_&&t&b_;i!==void 0&&(r&S_&&r&b_?(o=!0,c||a.add(...i)):c&&a.remove(...i));for(const u in i0){const d=i0[u];if(i=cm(s,u),i!==void 0)if(r&d){if(o&&(u==="underline"||u==="strikethrough")){t&d&&a.remove(...i);continue}t&d&&(!c||u!=="underline")&&u!=="strikethrough"||a.add(...i)}else t&d&&a.remove(...i)}}function x9(e,t,r){const n=t.firstChild,s=r.isComposing(),a=e+(s?Gb:"");if(n==null)t.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||s0){const[o,c,u]=(function(d,f){const g=d.length,p=f.length;let x=0,v=0;for(;x<g&&x<p&&d[x]===f[x];)x++;for(;v+x<g&&v+x<p&&d[g-v-1]===f[p-v-1];)v++;return[x,g-x-v,f.slice(x,p-v)]})(i,a);c!==0&&n.deleteData(o,c),n.insertData(o,u)}else n.nodeValue=a}}function JP(e,t,r,n,s,a){x9(s,e,t);const i=a.theme.text;i!==void 0&&p9(0,0,n,e,i)}function _w(e,t){const r=document.createElement(t);return r.appendChild(e),r}class Lf extends Wm{static getType(){return"text"}static clone(t){return new Lf(t.__text,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__text=t.__text,this.__format=t.__format,this.__style=t.__style,this.__mode=t.__mode,this.__detail=t.__detail}constructor(t="",r){super(r),this.__text=t,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const t=this.getLatest();return Ste[t.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===mf()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(t){const r=i0[t];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(t,r){return D_(this.getLatest().__format,t,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(t,r){const n=this.__format,s=lk(0,n),a=ck(0,n),i=s===null?a:s,o=document.createElement(i);let c=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),s!==null&&(c=document.createElement(a),o.appendChild(c)),JP(c,this,0,n,this.__text,t);const u=this.__style;return u!==""&&(o.style.cssText=u),o}updateDOM(t,r,n){const s=this.__text,a=t.__format,i=this.__format,o=lk(0,a),c=lk(0,i),u=ck(0,a),d=ck(0,i);if((o===null?u:o)!==(c===null?d:c))return!0;if(o===c&&u!==d){const v=r.firstChild;v==null&&Ht(48);const w=document.createElement(d);return JP(w,this,0,i,s,n),r.replaceChild(w,v),!1}let f=r;c!==null&&o!==null&&(f=r.firstChild,f==null&&Ht(49)),x9(s,f,this);const g=n.theme.text;g!==void 0&&a!==i&&p9(0,a,i,f,g);const p=t.__style,x=this.__style;return p!==x&&(r.style.cssText=x),!1}static importDOM(){return{"#text":()=>({conversion:Jte,priority:0}),b:()=>({conversion:Xte,priority:0}),code:()=>({conversion:Bu,priority:0}),em:()=>({conversion:Bu,priority:0}),i:()=>({conversion:Bu,priority:0}),mark:()=>({conversion:Bu,priority:0}),s:()=>({conversion:Bu,priority:0}),span:()=>({conversion:Yte,priority:0}),strong:()=>({conversion:Bu,priority:0}),sub:()=>({conversion:Bu,priority:0}),sup:()=>({conversion:Bu,priority:0}),u:()=>({conversion:Bu,priority:0})}}static importJSON(t){return Ds().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTextContent(t.text).setFormat(t.format).setDetail(t.detail).setMode(t.mode).setStyle(t.style)}exportDOM(t){let{element:r}=super.exportDOM(t);return os(r)||Ht(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=_w(r,"b")),this.hasFormat("italic")&&(r=_w(r,"i")),this.hasFormat("strikethrough")&&(r=_w(r,"s")),this.hasFormat("underline")&&(r=_w(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(t,r){}setFormat(t){const r=this.getWritable();return r.__format=typeof t=="string"?i0[t]:t,r}setDetail(t){const r=this.getWritable();return r.__detail=typeof t=="string"?wte[t]:t,r}setStyle(t){const r=this.getWritable();return r.__style=t,r}toggleFormat(t){const r=D_(this.getFormat(),t,null);return this.setFormat(r)}toggleDirectionless(){const t=this.getWritable();return t.__detail^=1,t}toggleUnmergeable(){const t=this.getWritable();return t.__detail^=2,t}setMode(t){const r=bte[t];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(t){if(this.__text===t)return this;const r=this.getWritable();return r.__text=t,r}select(t,r){hi();let n=t,s=r;const a=tr(),i=this.getTextContent(),o=this.__key;if(typeof i=="string"){const c=i.length;n===void 0&&(n=c),s===void 0&&(s=c)}else n=0,s=0;if(!Mt(a))return w9(o,n,o,s,"text","text");{const c=mf();c!==a.anchor.key&&c!==a.focus.key||gi(o),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const t=this.getTextContentSize();return this.select(t,t)}spliceText(t,r,n,s){const a=this.getWritable(),i=a.__text,o=n.length;let c=t;c<0&&(c=o+c,c<0&&(c=0));const u=tr();if(s&&Mt(u)){const f=t+o;u.setTextNodeRange(a,f,a,f)}const d=i.slice(0,c)+n+i.slice(c+r);return a.__text=d,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...t){hi();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=mf(),i=n.length;t.sort(((A,j)=>A-j)),t.push(i);const o=[],c=t.length;for(let A=0,j=0;A<i&&j<=c;j++){const I=t[j];I>A&&(o.push(n.slice(A,I)),A=I)}const u=o.length;if(u===1)return[r];const d=o[0],f=r.getParent();let g;const p=r.getFormat(),x=r.getStyle(),v=r.__detail;let w=!1,C=null,k=null;const _=tr();if(Mt(_)){const[A,j]=_.isBackward()?[_.focus,_.anchor]:[_.anchor,_.focus];A.type==="text"&&A.key===s&&(C=A),j.type==="text"&&j.key===s&&(k=j)}r.isSegmented()?(g=Ds(d),g.__format=p,g.__style=x,g.__detail=v,g.__state=UP(r,g),w=!0):g=r.setTextContent(d);const N=[g];for(let A=1;A<u;A++){const j=Ds(o[A]);j.__format=p,j.__style=x,j.__detail=v,j.__state=UP(r,j);const I=j.__key;a===s&&gi(I),N.push(j)}const E=C?C.offset:null,P=k?k.offset:null;let F=0;for(const A of N){if(!C&&!k)break;const j=F+A.getTextContentSize();if(C!==null&&E!==null&&E<=j&&E>=F&&(C.set(A.getKey(),E-F,"text"),E<j&&(C=null)),k!==null&&P!==null&&P<=j&&P>=F){k.set(A.getKey(),P-F,"text");break}F=j}if(f!==null){(function(I){const B=I.getPreviousSibling(),Y=I.getNextSibling();B!==null&&I_(B),Y!==null&&I_(Y)})(this);const A=f.getWritable(),j=this.getIndexWithinParent();w?(A.splice(j,0,N),this.remove()):A.splice(j,1,N),Mt(_)&&P_(_,f,j,u-1)}return N}mergeWithSibling(t){const r=t===this.getPreviousSibling();r||t===this.getNextSibling()||Ht(50);const n=this.__key,s=t.__key,a=this.__text,i=a.length;mf()===s&&gi(n);const o=tr();if(Mt(o)){const f=o.anchor,g=o.focus;f!==null&&f.key===s&&l8(f,r,n,t,i),g!==null&&g.key===s&&l8(g,r,n,t,i)}const c=t.__text,u=r?c+a:a+c;this.setTextContent(u);const d=this.getWritable();return t.remove(),d}isTextEntity(){return!1}}function Yte(e){return{forChild:w4(e.style),node:null}}function Xte(e){const t=e,r=t.style.fontWeight==="normal";return{forChild:w4(t.style,r?void 0:"bold"),node:null}}const ZP=new WeakMap;function Qte(e){if(!os(e))return!1;if(e.nodeName==="PRE")return!0;const t=e.style.whiteSpace;return typeof t=="string"&&t.startsWith("pre")}function Jte(e){const t=e;e.parentElement===null&&Ht(129);let r=t.textContent||"";if((function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=ZP.get(a))===void 0&&!Qte(a);)i.push(a),a=a.parentNode;const o=s===void 0?a:s;for(let c=0;c<i.length;c++)ZP.set(i[c],o);return o})(t)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const o=n[i];o===`
`||o===`\r
`?s.push(nu()):o==="	"?s.push(Hm()):o!==""&&s.push(Ds(o))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=t,s=!0;for(;n!==null&&(n=e8(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=t,s=!0;for(;n!==null&&(n=e8(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:Ds(r)}}function e8(e,t){let r=e;for(;;){let n;for(;(n=t?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,os(r)){const a=r.style.display;if(a===""&&!iE(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=t?r.firstChild:r.lastChild)!==null;)r=s;if(fd(r))return r;if(r.nodeName==="BR")return null}}const Zte={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function Bu(e){const t=Zte[e.nodeName.toLowerCase()];return t===void 0?{node:null}:{forChild:w4(e.style,t),node:null}}function Ds(e=""){return co(new Lf(e))}function rr(e){return e instanceof Lf}function w4(e,t){const r=e.fontWeight,n=e.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=e.fontStyle==="italic",o=n.includes("underline"),c=e.verticalAlign;return u=>(rr(u)&&(s&&!u.hasFormat("bold")&&u.toggleFormat("bold"),a&&!u.hasFormat("strikethrough")&&u.toggleFormat("strikethrough"),i&&!u.hasFormat("italic")&&u.toggleFormat("italic"),o&&!u.hasFormat("underline")&&u.toggleFormat("underline"),c!=="sub"||u.hasFormat("subscript")||u.toggleFormat("subscript"),c!=="super"||u.hasFormat("superscript")||u.toggleFormat("superscript"),t&&!u.hasFormat(t)&&u.toggleFormat(t)),u)}class Dv extends Lf{static getType(){return"tab"}static clone(t){return new Dv(t.__key)}constructor(t){super("	",t),this.__detail=2}static importDOM(){return null}createDOM(t){const r=super.createDOM(t),n=cm(t.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(t){return Hm().updateFromJSON(t)}setTextContent(t){return t!=="	"&&t!==""&&Ht(126),super.setTextContent("	")}spliceText(t,r,n,s){return n===""&&r===0||n==="	"&&r===1||Ht(286),this}setDetail(t){return t!==2&&Ht(127),this}setMode(t){return t!=="normal"&&Ht(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function Hm(){return co(new Dv)}function qb(e){return e instanceof Dv}class ere{constructor(t,r,n){this._selection=null,this.key=t,this.offset=r,this.type=n}is(t){return this.key===t.key&&this.offset===t.offset&&this.type===t.type}isBefore(t){return this.key===t.key?this.offset<t.offset:U9(Tl(id(this,"next")),Tl(id(t,"next")))<0}getNode(){const t=ha(this.key);return t===null&&Ht(20),t}set(t,r,n,s){const a=this._selection,i=this.key;s&&this.key===t&&this.offset===r&&this.type===n||(this.key=t,this.offset=r,this.type=n,Iv()||(mf()===i&&gi(t),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function su(e,t,r){return new ere(e,t,r)}function uk(e,t){let r=t.__key,n=e.offset,s="element";if(rr(t)){s="text";const a=t.getTextContentSize();n>a&&(n=a)}else if(!_t(t)){const a=t.getNextSibling();if(rr(a))r=a.__key,n=0,s="text";else{const i=t.getParent();i&&(r=i.__key,n=t.getIndexWithinParent()+1)}}e.set(r,n,s)}function t8(e,t){if(_t(t)){const r=t.getLastDescendant();_t(r)||rr(r)?uk(e,r):uk(e,t)}else uk(e,t)}class Yb{constructor(t){this._cachedNodes=null,this._nodes=t,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){if(!Ai(t))return!1;const r=this._nodes,n=t._nodes;return r.size===n.size&&Array.from(r).every((s=>n.has(s)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(t){this.dirty=!0,this._nodes.add(t),this._cachedNodes=null}delete(t){this.dirty=!0,this._nodes.delete(t),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(t){return this._nodes.has(t)}clone(){return new Yb(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(t){}insertText(){}insertNodes(t){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(rr(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(t);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=this._nodes,n=[];for(const s of r){const a=ha(s);a!==null&&n.push(a)}return Iv()||(this._cachedNodes=n),n}getTextContent(){const t=this.getNodes();let r="";for(let n=0;n<t.length;n++)r+=t[n].getTextContent();return r}deleteNodes(){const t=this.getNodes();if((tr()||Gm())===this&&t[0]){const r=yi(t[0],"next");Lre(Af(r,r))}for(const r of t)r.remove()}}function Mt(e){return e instanceof N0}class N0{constructor(t,r,n,s){this.anchor=t,this.focus=r,t._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){return!!Mt(t)&&this.anchor.is(t.anchor)&&this.focus.is(t.focus)&&this.format===t.format&&this.style===t.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=(function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const o=new Set,c=new Set;for(const u of n)if(tu(u)){const{origin:d}=u;s.length===0?o.add(d):(c.add(d),s.push(d))}else{const{origin:d}=u;_t(d)&&c.has(d)||s.push(d)}if(i&&s.push(i.caret.origin),f0(n.focus)&&_t(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let u=Fl(n.focus.origin,"previous");tu(u)&&o.has(u.origin)&&!u.origin.isEmpty()&&u.origin.is(s[s.length-1]);u=z4(u))o.delete(u.origin),s.pop();for(;s.length>1;){const u=s[s.length-1];if(!_t(u)||c.has(u)||u.isEmpty()||o.has(u))break;s.pop()}if(s.length===0&&n.isCollapsed()){const u=Tl(n.anchor),d=Tl(n.anchor.getFlipped()),f=p=>_f(p)?p.origin:p.getNodeAtCaret(),g=f(u)||f(d)||(n.anchor.getNodeAtCaret()?u.origin:d.origin);s.push(g)}return s})(H9(N8(this),"next"));return Iv()||(this._cachedNodes=r),r}setTextNodeRange(t,r,n,s){this.anchor.set(t.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const t=this.getNodes();if(t.length===0)return"";const r=t[0],n=t[t.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[o,c]=ZT(this);let u="",d=!0;for(let f=0;f<t.length;f++){const g=t[f];if(_t(g)&&!g.isInline())d||(u+=`
`),d=!g.isEmpty();else if(d=!1,rr(g)){let p=g.getTextContent();g===r?g===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(p=o<c?p.slice(o,c):p.slice(c,o)):p=i?p.slice(o):p.slice(c):g===n&&(p=i?p.slice(0,c):p.slice(0,o)),u+=p}else!_n(g)&&!Qu(g)||g===n&&this.isCollapsed()||(u+=g.getTextContent())}return u}applyDOMRange(t){const r=Cs(),n=r.getEditorState()._selection,s=v9(t.startContainer,t.startOffset,t.endContainer,t.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),k_(this)}clone(){const t=this.anchor,r=this.focus;return new N0(su(t.key,t.offset,t.type),su(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(t){this.format=D_(this.format,t,null),this.dirty=!0}setFormat(t){this.format=t,this.dirty=!0}setStyle(t){this.style=t,this.dirty=!0}hasFormat(t){const r=i0[t];return!!(this.format&r)}insertRawText(t){const r=t.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(nu()):i==="	"?n.push(Hm()):n.push(Ds(i))}this.insertNodes(n)}insertText(t){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,o=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,o=r),i.type==="element"&&(function(w,C,k,_){const N=w.getNode(),E=N.getChildAtIndex(w.offset),P=Ds();if(P.setFormat(k),P.setStyle(_),E4(E))E.splice(0,0,[P]);else{const F=Ea(N)?is().append(P):P;E===null?N.append(F):E.insertBefore(F)}w.is(C)&&C.set(P.__key,0,"text"),w.set(P.__key,0,"text")})(i,o,s,a),o.type==="element"&&g0(o,Tl(id(o,"next")));const c=i.offset;let u=o.offset;const d=this.getNodes(),f=d.length;let g=d[0];rr(g)||Ht(26);const p=g.getTextContent().length,x=g.getParentOrThrow();let v=d[f-1];if(f===1&&o.type==="element"&&(u=p,o.set(i.key,u,"text")),this.isCollapsed()&&c===p&&(Uu(g)||!g.canInsertTextAfter()||!x.canInsertTextAfter()&&g.getNextSibling()===null)){let w=g.getNextSibling();if(rr(w)&&w.canInsertTextBefore()&&!Uu(w)||(w=Ds(),w.setFormat(s),w.setStyle(a),x.canInsertTextAfter()?g.insertAfter(w):x.insertAfter(w)),w.select(0,0),g=w,t!=="")return void this.insertText(t)}else if(this.isCollapsed()&&c===0&&(Uu(g)||!g.canInsertTextBefore()||!x.canInsertTextBefore()&&g.getPreviousSibling()===null)){let w=g.getPreviousSibling();if(rr(w)&&!Uu(w)||(w=Ds(),w.setFormat(s),x.canInsertTextBefore()?g.insertBefore(w):x.insertBefore(w)),w.select(),g=w,t!=="")return void this.insertText(t)}else if(g.isSegmented()&&c!==p){const w=Ds(g.getTextContent());w.setFormat(s),g.replace(w),g=w}else if(!this.isCollapsed()&&t!==""){const w=v.getParent();if(!x.canInsertTextBefore()||!x.canInsertTextAfter()||_t(w)&&(!w.canInsertTextBefore()||!w.canInsertTextAfter()))return this.insertText(""),y9(this.anchor,this.focus,null),void this.insertText(t)}if(f===1){if(Vh(g)){const _=Ds(t);return _.select(),void g.replace(_)}const w=g.getFormat(),C=g.getStyle();if(c!==u||w===s&&C===a){if(qb(g)){const _=Ds(t);return _.setFormat(s),_.setStyle(a),_.select(),void g.replace(_)}}else{if(g.getTextContent()!==""){const _=Ds(t);if(_.setFormat(s),_.setStyle(a),_.select(),c===0)g.insertBefore(_,!1);else{const[N]=g.splitText(c);N.insertAfter(_,!1)}return void(_.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length))}g.setFormat(s),g.setStyle(a)}const k=u-c;g=g.spliceText(c,k,t,!0),g.getTextContent()===""?g.remove():this.anchor.type==="text"&&(g.isComposing()?this.anchor.offset-=t.length:(this.format=w,this.style=C))}else{const w=new Set([...g.getParentKeys(),...v.getParentKeys()]),C=_t(g)?g:g.getParentOrThrow();let k=_t(v)?v:v.getParentOrThrow(),_=v;if(!C.is(k)&&k.isInline())do _=k,k=k.getParentOrThrow();while(k.isInline());if(o.type==="text"&&(u!==0||v.getTextContent()==="")||o.type==="element"&&v.getIndexWithinParent()<u)if(rr(v)&&!Vh(v)&&u!==v.getTextContentSize()){if(v.isSegmented()){const A=Ds(v.getTextContent());v.replace(A),v=A}Ea(o.getNode())||o.type!=="text"||(v=v.spliceText(0,u,"")),w.add(v.__key)}else{const A=v.getParentOrThrow();A.canBeEmpty()||A.getChildrenSize()!==1?v.remove():A.remove()}else w.add(v.__key);const N=k.getChildren(),E=new Set(d),P=C.is(k),F=C.isInline()&&g.getNextSibling()===null?C:g;for(let A=N.length-1;A>=0;A--){const j=N[A];if(j.is(g)||_t(j)&&j.isParentOf(g))break;j.isAttached()&&(!E.has(j)||j.is(_)?P||F.insertAfter(j,!1):j.remove())}if(!P){let A=k,j=null;for(;A!==null;){const I=A.getChildren(),B=I.length;(B===0||I[B-1].is(j))&&(w.delete(A.__key),j=A),A=A.getParent()}}if(Vh(g))if(c===p)g.select();else{const A=Ds(t);A.select(),g.replace(A)}else g=g.spliceText(c,p-c,t,!0),g.getTextContent()===""?g.remove():g.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length);for(let A=1;A<f;A++){const j=d[A],I=j.__key;w.has(I)||j.remove()}}}removeText(){const t=tr()===this;c_(this,Bre(N8(this))),t&&tr()!==this&&vi(this)}formatText(t,r=null){if(this.isCollapsed())return this.toggleFormat(t),void gi(null);const n=this.getNodes(),s=[];for(const N of n)rr(N)&&s.push(N);const a=N=>{n.forEach((E=>{if(_t(E)){const P=E.getFormatFlags(t,N);E.setTextFormat(P)}}))},i=s.length;if(i===0)return this.toggleFormat(t),gi(null),void a(r);const o=this.anchor,c=this.focus,u=this.isBackward(),d=u?c:o,f=u?o:c;let g=0,p=s[0],x=d.type==="element"?0:d.offset;if(d.type==="text"&&x===p.getTextContentSize()&&(g=1,p=s[1],x=0),p==null)return;const v=p.getFormatFlags(t,r);a(v);const w=i-1;let C=s[w];const k=f.type==="text"?f.offset:C.getTextContentSize();if(p.is(C)){if(x===k)return;if(Uu(p)||x===0&&k===p.getTextContentSize())p.setFormat(v);else{const N=p.splitText(x,k),E=x===0?N[0]:N[1];E.setFormat(v),d.type==="text"&&d.set(E.__key,0,"text"),f.type==="text"&&f.set(E.__key,k-x,"text")}return void(this.format=v)}x===0||Uu(p)||([,p]=p.splitText(x),x=0),p.setFormat(v);const _=C.getFormatFlags(t,v);k>0&&(k===C.getTextContentSize()||Uu(C)||([C]=C.splitText(k)),C.setFormat(_));for(let N=g+1;N<w;N++){const E=s[N],P=E.getFormatFlags(t,_);E.setFormat(P)}d.type==="text"&&d.set(p.__key,x,"text"),f.type==="text"&&f.set(C.__key,k,"text"),this.format=v|_}insertNodes(t){if(t.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const x=tr();return Mt(x)||Ht(134),x.insertNodes(t)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=mk(r,Cl),s=t[t.length-1];if(_t(n)&&"__language"in n){if("__language"in t[0])this.insertText(t[0].getTextContent());else{const x=dk(this);n.splice(x,0,t),s.selectEnd()}return}if(!t.some((x=>(_t(x)||_n(x))&&!x.isInline()))){_t(n)||Ht(211,r.constructor.name,r.getType());const x=dk(this);return n.splice(x,0,t),void s.selectEnd()}const a=(function(x){const v=is();let w=null;for(let C=0;C<x.length;C++){const k=x[C],_=Qu(k);if(_||_n(k)&&k.isInline()||_t(k)&&k.isInline()||rr(k)||k.isParentRequired()){if(w===null&&(w=k.createParentElementNode(),v.append(w),_))continue;w!==null&&w.append(k)}else v.append(k),w=null}return v})(t),i=a.getLastDescendant(),o=a.getChildren(),c=!_t(n)||!n.isEmpty()?this.insertParagraph():null,u=o[o.length-1];let d=o[0];var f;_t(f=d)&&Cl(f)&&!f.isEmpty()&&_t(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(_t(n)||Ht(211,r.constructor.name,r.getType()),n.append(...d.getChildren()),d=o[1]),d&&(n===null&&Ht(212,r.constructor.name,r.getType()),(function(x,v,w){const C=v.getParentOrThrow().getLastChild();let k=v;const _=[v];for(;k!==C;)k.getNextSibling()||Ht(140),k=k.getNextSibling(),_.push(k);let N=x;for(const E of _)N=N.insertAfter(E)})(n,d));const g=mk(i,Cl);c&&_t(g)&&(c.canMergeWhenEmpty()||Cl(u))&&(g.append(...c.getChildren()),c.remove()),_t(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const p=_t(n)?n.getLastChild():null;Qu(p)&&g!==n&&p.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=is();return ys().splice(this.anchor.offset,0,[i]),i.select(),i}const t=dk(this),r=mk(this.anchor.getNode(),Cl);_t(r)||Ht(213);const n=r.getChildAtIndex(t),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(t){const r=nu();if(this.insertNodes([r]),t){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const t=this.getNodes(),r=t.length,n=r-1,s=this.anchor,a=this.focus;let i=t[0],o=t[n];const[c,u]=ZT(this);if(r===0)return[];if(r===1){if(rr(i)&&!this.isCollapsed()){const f=c>u?u:c,g=c>u?c:u,p=i.splitText(f,g),x=f===0?p[0]:p[1];return x!=null?[x]:[]}return[i]}const d=s.isBefore(a);if(rr(i)){const f=d?c:u;f===i.getTextContentSize()?t.shift():f!==0&&([,i]=i.splitText(f),t[0]=i)}if(rr(o)){const f=o.getTextContent().length,g=d?u:c;g===0?t.pop():g!==f&&([o]=o.splitText(g),t[n]=o)}return t}modify(t,r,n){if(c8(this,t,r,n))return;const s=t==="move",a=Cs(),i=pc(Pl(a));if(!i)return;const o=a._blockCursorElement,c=a._rootElement,u=this.focus.getNode();if(c===null||o===null||!_t(u)||u.isInline()||u.canBeEmpty()||sE(o,a,c),this.dirty){let d=c0(a,this.anchor.key),f=c0(a,this.focus.key);this.anchor.type==="text"&&(d=Sm(d)),this.focus.type==="text"&&(f=Sm(f)),d&&f&&_9(i,d,this.anchor.offset,f,this.focus.offset)}if((function(d,f,g,p){d.modify(f,g,p)})(i,t,r?"backward":"forward",n),i.rangeCount>0){const d=i.getRangeAt(0),f=this.anchor.getNode(),g=Ea(f)?f:Sre(f);if(this.applyDOMRange(d),this.dirty=!0,!s){const p=this.getNodes(),x=[];let v=!1;for(let w=0;w<p.length;w++){const C=p[w];nE(C,g)?x.push(C):v=!0}if(v&&x.length>0)if(r){const w=x[0];_t(w)?w.selectStart():w.getParentOrThrow().selectStart()}else{const w=x[x.length-1];_t(w)?w.selectEnd():w.getParentOrThrow().selectEnd()}i.anchorNode===d.startContainer&&i.anchorOffset===d.startOffset||(function(w){const C=w.focus,k=w.anchor,_=k.key,N=k.offset,E=k.type;k.set(C.key,C.offset,C.type,!0),C.set(_,N,E,!0)})(this)}}n==="lineboundary"&&c8(this,t,r,n,"decorators")}forwardDeletion(t,r,n){if(!n&&(t.type==="element"&&_t(r)&&t.offset===r.getChildrenSize()||t.type==="text"&&t.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(_t(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(t){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,t))return;const a=H4(id(n,t?"previous":"next"));if(a.getTextSlices().every((o=>o===null||o.distance===0))){let o={type:"initial"};for(const c of a.iterNodeCarets("shadowRoot"))if(tu(c)){if(!c.origin.isInline()){if(c.origin.isShadowRoot()){if(o.type==="merge-block")break;if(_t(a.anchor.origin)&&a.anchor.origin.isEmpty()){const u=Tl(c);c_(this,Af(u,u)),a.anchor.origin.remove()}return}o.type!=="merge-next-block"&&o.type!=="merge-block"||(o={block:o.block,caret:c,type:"merge-block"})}}else{if(o.type==="merge-block")break;if(f0(c)){if(_t(c.origin)){if(c.origin.isInline()){if(!c.origin.isParentOf(a.anchor.origin))break}else o={block:c.origin,type:"merge-next-block"};continue}if(_n(c.origin)){if(!c.origin.isIsolated())if(o.type==="merge-next-block"&&(c.origin.isKeyboardSelectable()||!c.origin.isInline())&&_t(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const u=_4();u.add(c.origin.getKey()),vi(u)}else c.origin.remove();return}break}}if(o.type==="merge-block"){const{caret:c,block:u}=o;return c_(this,Af(!c.origin.isEmpty()&&u.isEmpty()?V4(yi(u,c.direction)):a.anchor,c)),this.removeText()}}const i=this.focus;if(this.modify("extend",t,"character"),this.isCollapsed()){if(t&&n.offset===0&&n8(this,n.getNode()))return}else{const o=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,o!==null&&o.isSegmented()){const c=i.offset,u=o.getTextContentSize();if(o.is(s)||t&&c!==u||!t&&c!==0)return void s8(o,t,c)}else if(s!==null&&s.isSegmented()){const c=n.offset,u=s.getTextContentSize();if(s.is(o)||t&&c!==0||!t&&c!==u)return void s8(s,t,c)}(function(c,u){const d=c.anchor,f=c.focus,g=d.getNode(),p=f.getNode();if(g===p&&d.type==="text"&&f.type==="text"){const x=d.offset,v=f.offset,w=x<v,C=w?x:v,k=w?v:x,_=k-1;C!==_&&(function(N){return!(I9(N)||tre(N))})(g.getTextContent().slice(C,k))&&(u?f.set(f.key,_,f.type):d.set(d.key,_,d.type))}})(this,t)}}if(this.removeText(),t&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&Ea(n.getParent())&&n.getPreviousSibling()===null&&n8(this,n)}}deleteLine(t){this.isCollapsed()&&this.modify("extend",t,"lineboundary"),this.isCollapsed()?this.deleteCharacter(t):this.removeText()}deleteWord(t){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,t))return;this.modify("extend",t,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function Ai(e){return e instanceof Yb}function r8(e){const t=e.offset;if(e.type==="text")return t;const r=e.getNode();return t===r.getChildrenSize()?r.getTextContent().length:0}function ZT(e){const t=e.getStartEndPoints();if(t===null)return[0,0];const[r,n]=t;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[r8(r),r8(n)]}function n8(e,t){for(let r=t;r;r=r.getParent()){if(_t(r)){if(r.collapseAtStart(e))return!0;if(io(r))break}if(r.getPreviousSibling())break}return!1}const tre=(()=>{try{const e=new RegExp("\\p{Emoji}","u"),t=e.test.bind(e);if(t("")&&t("#")&&t(""))return t}catch{}return()=>!1})();function s8(e,t,r){const n=e,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,o=0;for(let u=0;u<a;u++){const d=u===a-1;if(o=i,i+=s[u].length,t&&i===r||i>r||d){s.splice(u,1),d&&(o=void 0);break}}const c=s.join("").trim();c===""?n.remove():(n.setTextContent(c),n.select(o,o))}function a8(e,t,r,n){let s,a=t;if(os(e)){let i=!1;const o=e.childNodes,c=o.length,u=n._blockCursorElement;a===c&&(i=!0,a=c-1);let d=o[a],f=!1;if(d===u)d=o[a+1],f=!0;else if(u!==null){const g=u.parentNode;e===g&&t>Array.prototype.indexOf.call(g.children,u)&&a--}if(s=tm(d),rr(s))a=bf(s,i?"next":"previous");else{let g=tm(e);if(g===null)return null;if(_t(g)){const p=n.getElementByKey(g.getKey());p===null&&Ht(214),[g,a]=g.getDOMSlot(p).resolveChildIndex(g,p,e,t),_t(g)||Ht(215),i&&a>=g.getChildrenSize()&&(a=Math.max(0,g.getChildrenSize()-1));let v=g.getChildAtIndex(a);if(_t(v)&&(function(w,C,k){const _=w.getParent();return k===null||_===null||!_.canBeEmpty()||_!==k.getNode()})(v,0,r)){const w=i?v.getLastDescendant():v.getFirstDescendant();w===null?g=v:(v=w,g=_t(v)?v:v.getParentOrThrow()),a=0}rr(v)?(s=v,g=null,a=bf(v,i?"next":"previous")):v!==g&&i&&!f&&(_t(g)||Ht(216),a=Math.min(g.getChildrenSize(),a+1))}else{const p=g.getIndexWithinParent();a=t===0&&_n(g)&&tm(e)===g?p:p+1,g=g.getParentOrThrow()}if(_t(g))return su(g.__key,a,"element")}}else s=tm(e);return rr(s)?su(s.__key,bf(s,a,"clamp"),"text"):null}function i8(e,t,r){const n=e.offset,s=e.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(t){if((r||!t)&&a===null&&_t(i)&&i.isInline()){const o=i.getPreviousSibling();rr(o)&&e.set(o.__key,o.getTextContent().length,"text")}}else _t(a)&&!r&&a.isInline()?e.set(a.__key,a.getChildrenSize(),"element"):rr(a)&&e.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(t&&_t(a)&&a.isInline())e.set(a.__key,0,"element");else if((r||t)&&a===null&&_t(i)&&i.isInline()&&!i.canInsertTextAfter()){const o=i.getNextSibling();rr(o)&&e.set(o.__key,0,"text")}}}function y9(e,t,r){if(e.type==="text"&&t.type==="text"){const n=e.isBefore(t),s=e.is(t);i8(e,n,s),i8(t,!n,s),s&&t.set(e.key,e.offset,e.type);const a=Cs();if(a.isComposing()&&a._compositionKey!==e.key&&Mt(r)){const i=r.anchor,o=r.focus;e.set(i.key,i.offset,i.type,!0),t.set(o.key,o.offset,o.type,!0)}}}function v9(e,t,r,n,s,a){if(e===null||r===null||!Lv(s,e,r))return null;const i=a8(e,t,Mt(a)?a.anchor:null,s);if(i===null)return null;const o=a8(r,n,Mt(a)?a.focus:null,s);if(o===null)return null;if(i.type==="element"&&o.type==="element"){const c=tm(e),u=tm(r);if(_n(c)&&_n(u))return null}return y9(i,o,a),[i,o]}function eE(e){return _t(e)&&!e.isInline()}function w9(e,t,r,n,s,a){const i=Bf(),o=new N0(su(e,t,s),su(r,n,a),0,"");return o.dirty=!0,i._selection=o,o}function Xb(){const e=su("root",0,"element"),t=su("root",0,"element");return new N0(e,t,0,"")}function _4(){return new Yb(new Set)}function b4(e,t,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,o=i==="selectionchange",c=!LT&&(o||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let u,d,f,g;if(Mt(e)&&!c)return e.clone();if(t===null)return null;if(u=t.anchorNode,d=t.focusNode,f=t.anchorOffset,g=t.focusOffset,o&&Mt(e)&&!Lv(r,u,d))return e.clone();const p=v9(u,f,d,g,r,e);if(p===null)return null;const[x,v]=p;return new N0(x,v,Mt(e)?e.format:0,Mt(e)?e.style:"")}function tr(){return Bf()._selection}function Gm(){return Cs()._editorState._selection}function P_(e,t,r,n=1){const s=e.anchor,a=e.focus,i=s.getNode(),o=a.getNode();if(!t.is(i)&&!t.is(o))return;const c=t.__key;if(e.isCollapsed()){const u=s.offset;if(r<=u&&n>0||r<u&&n<0){const d=Math.max(0,u+n);s.set(c,d,"element"),a.set(c,d,"element"),o8(e)}}else{const u=e.isBackward(),d=u?a:s,f=d.getNode(),g=u?s:a,p=g.getNode();if(t.is(f)){const x=d.offset;(r<=x&&n>0||r<x&&n<0)&&d.set(c,Math.max(0,x+n),"element")}if(t.is(p)){const x=g.offset;(r<=x&&n>0||r<x&&n<0)&&g.set(c,Math.max(0,x+n),"element")}}o8(e)}function o8(e){const t=e.anchor,r=t.offset,n=e.focus,s=n.offset,a=t.getNode(),i=n.getNode();if(e.isCollapsed()){if(!_t(a))return;const o=a.getChildrenSize(),c=r>=o,u=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(rr(u)){let d=0;c&&(d=u.getTextContentSize()),t.set(u.__key,d,"text"),n.set(u.__key,d,"text")}}else{if(_t(a)){const o=a.getChildrenSize(),c=r>=o,u=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(rr(u)){let d=0;c&&(d=u.getTextContentSize()),t.set(u.__key,d,"text")}}if(_t(i)){const o=i.getChildrenSize(),c=s>=o,u=c?i.getChildAtIndex(o-1):i.getChildAtIndex(s);if(rr(u)){let d=0;c&&(d=u.getTextContentSize()),n.set(u.__key,d,"text")}}}}function F_(e,t,r,n,s){let a=null,i=0,o=null;n!==null?(a=n.__key,rr(n)?(i=n.getTextContentSize(),o="text"):_t(n)&&(i=n.getChildrenSize(),o="element")):s!==null&&(a=s.__key,rr(s)?o="text":_t(s)&&(o="element")),a!==null&&o!==null?e.set(a,i,o):(i=t.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),e.set(r.__key,i,"element"))}function l8(e,t,r,n,s){e.type==="text"?e.set(r,e.offset+(t?0:s),"text"):e.offset>n.getIndexWithinParent()&&e.set(e.key,e.offset-1,"element")}function _9(e,t,r,n,s){try{e.setBaseAndExtent(t,r,n,s)}catch{}}function rre(e,t,r,n,s,a,i){const o=n.anchorNode,c=n.focusNode,u=n.anchorOffset,d=n.focusOffset,f=document.activeElement;if(s.has(E9)&&f!==a||f!==null&&j4(f))return;if(!Mt(t))return void(e!==null&&Lv(r,o,c)&&n.removeAllRanges());const g=t.anchor,p=t.focus,x=g.key,v=p.key,w=c0(r,x),C=c0(r,v),k=g.offset,_=p.offset,N=t.format,E=t.style,P=t.isCollapsed();let F=w,A=C,j=!1;if(g.type==="text"){F=Sm(w);const ee=g.getNode();j=ee.getFormat()!==N||ee.getStyle()!==E}else Mt(e)&&e.anchor.type==="text"&&(j=!0);var I,B,Y,Z,se;if(p.type==="text"&&(A=Sm(C)),F!==null&&A!==null&&(P&&(e===null||j||Mt(e)&&(e.format!==N||e.style!==E))&&(I=N,B=E,Y=k,Z=x,se=performance.now(),u9=[I,B,Y,Z,se]),u!==k||d!==_||o!==F||c!==A||n.type==="Range"&&P||(f!==null&&a.contains(f)||a.focus({preventScroll:!0}),g.type==="element"))){if(_9(n,F,k,A,_),!s.has(cre)&&t.isCollapsed()&&a!==null&&a===document.activeElement){const ee=Mt(t)&&t.anchor.type==="element"?F.childNodes[k]||null:n.rangeCount>0?n.getRangeAt(0):null;if(ee!==null){let te;if(ee instanceof Text){const L=document.createRange();L.selectNode(ee),te=L.getBoundingClientRect()}else te=ee.getBoundingClientRect();(function(L,V,M){const H=B9(M),W=R4(H);if(H===null||W===null)return;let{top:R,bottom:z}=V,K=0,Q=0,ae=M;for(;ae!==null;){const X=ae===H.body;if(X)K=0,Q=Pl(L).innerHeight;else{const le=ae.getBoundingClientRect();K=le.top,Q=le.bottom}let ie=0;if(R<K?ie=-(K-R):z>Q&&(ie=z-Q),ie!==0)if(X)W.scrollBy(0,ie);else{const le=ae.scrollTop;ae.scrollTop+=ie;const ce=ae.scrollTop-le;R-=ce,z-=ce}if(X)break;ae=Bv(ae)}})(r,te,a)}}XT=!0}}function nre(e){let t=tr()||Gm();t===null&&(t=ys().selectEnd()),t.insertNodes(e)}function dk(e){let t=e;e.isCollapsed()||t.removeText();const r=tr();Mt(r)&&(t=r),Mt(t)||Ht(161);const n=t.anchor;let s=n.getNode(),a=n.offset;for(;!Cl(s);){const i=s;if([s,a]=sre(s,a),i.is(s))break}return a}function sre(e,t){const r=e.getParent();if(!r){const s=is();return ys().append(s),s.select(),[ys(),0]}if(rr(e)){const s=e.splitText(t);if(s.length===0)return[r,e.getIndexWithinParent()];const a=t===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!_t(e)||t===0)return[r,e.getIndexWithinParent()];const n=e.getChildAtIndex(t);if(n){const s=new N0(su(e.__key,t,"element"),su(e.__key,t,"element"),0,""),a=e.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,e.getIndexWithinParent()+1]}function c8(e,t,r,n,s="decorators-and-blocks"){if(t==="move"&&n==="character"&&!e.isCollapsed()){const[d,f]=r===e.isBackward()?[e.focus,e.anchor]:[e.anchor,e.focus];return f.set(d.key,d.offset,d.type),!0}const a=id(e.focus,r?"previous":"next"),i=n==="lineboundary",o=t==="move";let c=a,u=s==="decorators-and-blocks";if(!W9(c)){for(const d of c){u=!1;const{origin:f}=d;if(!_n(f)||f.isIsolated()||(c=d,!i||!f.isInline()))break}if(u)for(const d of H4(a).iterNodeCarets(t==="extend"?"shadowRoot":"root")){if(tu(d))d.origin.isInline()||(c=d);else{if(_t(d.origin))continue;_n(d.origin)&&!d.origin.isInline()&&(c=d)}break}}if(c===a)return!1;if(o&&!i&&_n(c.origin)&&c.origin.isKeyboardSelectable()){const d=_4();return d.add(c.origin.getKey()),vi(d),!0}return c=Tl(c),o&&g0(e.anchor,c),g0(e.focus,c),u||!i}let za=null,Wa=null,Eo=!1,fk=!1,o_=0;const u8={characterData:!0,childList:!0,subtree:!0};function Iv(){return Eo||za!==null&&za._readOnly}function hi(){Eo&&Ht(13)}function b9(){o_>99&&Ht(14)}function Bf(){return za===null&&Ht(195,S9()),za}function Cs(){return Wa===null&&Ht(196,S9()),Wa}function S9(){let e=0;const t=new Set,r=Zb.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=e2(s);if(P4(a))e++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),t.add(i)}}let n=` Detected on the page: ${e} compatible editor(s) with version ${r}`;return t.size&&(n+=` and incompatible editors with versions ${Array.from(t).join(", ")}`),n}function are(){return Wa}function d8(e,t,r){const n=t.__type,s=A9(e,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let o=0;o<i&&(a[o](t),t.isAttached());o++);}function f8(e,t){return e!==void 0&&e.__key!==t&&e.isAttached()}function k9(e,t){if(!t)return;const r=e._updateTags;let n=t;Array.isArray(t)||(n=[t]);for(const s of n)r.add(s)}function ire(e){return S4(e,Cs()._nodes)}function S4(e,t){const r=e.type,n=t.get(r);n===void 0&&Ht(17,r);const s=n.klass;e.type!==s.getType()&&Ht(18,s.name);const a=s.importJSON(e),i=e.children;if(_t(a)&&Array.isArray(i))for(let o=0;o<i.length;o++){const c=S4(i[o],t);a.append(c)}return a}function h8(e,t,r){const n=za,s=Eo,a=Wa;za=t,Eo=!0,Wa=e;try{return r()}finally{za=n,Eo=s,Wa=a}}function Wu(e,t){const r=e._pendingEditorState,n=e._rootElement,s=e._headless||n===null;if(r===null)return;const a=e._editorState,i=a._selection,o=r._selection,c=e._dirtyType!==a0,u=za,d=Eo,f=Wa,g=e._updating,p=e._observer;let x=null;if(e._pendingEditorState=null,e._editorState=r,!s&&c&&p!==null){Wa=e,za=r,Eo=!1,e._updating=!0;try{const P=e._dirtyType,F=e._dirtyElements,A=e._dirtyLeaves;p.disconnect(),x=Dte(a,r,e,P,F,A)}catch(P){if(P instanceof Error&&e._onError(P),fk)throw P;return N9(e,null,n,r),UL(e),e._dirtyType=bm,fk=!0,Wu(e,a),void(fk=!1)}finally{p.observe(n,u8),e._updating=g,za=u,Eo=d,Wa=f}}r._readOnly||(r._readOnly=!0);const v=e._dirtyLeaves,w=e._dirtyElements,C=e._normalizedNodes,k=e._updateTags,_=e._deferred;c&&(e._dirtyType=a0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),(function(P,F){const A=P._decorators;let j=P._pendingDecorators||A;const I=F._nodeMap;let B;for(B in j)I.has(B)||(j===A&&(j=O9(P)),delete j[B])})(e,r);const N=s?null:pc(Pl(e));if(e._editable&&N!==null&&(c||o===null||o.dirty)&&n!==null&&!k.has(ure)){Wa=e,za=r;try{if(p!==null&&p.disconnect(),c||o===null||o.dirty){const P=e._blockCursorElement;P!==null&&sE(P,e,n),rre(i,o,e,N,k,n)}(function(P,F,A){let j=P._blockCursorElement;if(Mt(A)&&A.isCollapsed()&&A.anchor.type==="element"&&F.contains(document.activeElement)){const I=A.anchor,B=I.getNode(),Y=I.offset;let Z=!1,se=null;if(Y===B.getChildrenSize())gk(B.getChildAtIndex(Y-1))&&(Z=!0);else{const ee=B.getChildAtIndex(Y);if(ee!==null&&gk(ee)){const te=ee.getPreviousSibling();(te===null||gk(te))&&(Z=!0,se=P.getElementByKey(ee.__key))}}if(Z){const ee=P.getElementByKey(B.__key);return j===null&&(P._blockCursorElement=j=(function(te){const L=te.theme,V=document.createElement("div");V.contentEditable="false",V.setAttribute("data-lexical-cursor","true");let M=L.blockCursor;if(M!==void 0){if(typeof M=="string"){const H=RL(M);M=L.blockCursor=H}M!==void 0&&V.classList.add(...M)}return V})(P._config)),F.style.caretColor="transparent",void(se===null?ee.appendChild(j):ee.insertBefore(j,se))}}j!==null&&sE(j,P,F)})(e,n,o)}finally{p!==null&&p.observe(n,u8),Wa=f,za=u}}x!==null&&(function(P,F,A,j,I){const B=Array.from(P._listeners.mutation),Y=B.length;for(let Z=0;Z<Y;Z++){const[se,ee]=B[Z];for(const te of ee){const L=F.get(te);L!==void 0&&se(L,{dirtyLeaves:j,prevEditorState:I,updateTags:A})}}})(e,x,k,v,a),Mt(o)||o===null||i!==null&&i.is(o)||e.dispatchCommand(qL,void 0);const E=e._pendingDecorators;E!==null&&(e._decorators=E,e._pendingDecorators=null,ky("decorator",e,!0,E)),(function(P,F,A){const j=y8(F),I=y8(A);j!==I&&ky("textcontent",P,!0,I)})(e,t||a,r),ky("update",e,!0,{dirtyElements:w,dirtyLeaves:v,editorState:r,mutatedNodes:x,normalizedNodes:C,prevEditorState:t||a,tags:k}),(function(P,F){if(P._deferred=[],F.length!==0){const A=P._updating;P._updating=!0;try{for(let j=0;j<F.length;j++)F[j]()}finally{P._updating=A}}})(e,_),(function(P){const F=P._updates;if(F.length!==0){const A=F.shift();if(A){const[j,I]=A;Qb(P,j,I)}}})(e)}function ky(e,t,r,...n){const s=t._updating;t._updating=r;try{const a=Array.from(t._listeners[e]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{t._updating=s}}function g8(e,t){const r=e._updates;let n=t||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,o=e._pendingEditorState;let c;i!==void 0&&(c=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(o===null&&Ht(191),o._flushSync=!0),c&&e._deferred.push(c),k9(e,i.tag)),o==null?Qb(e,a,i):a()}}return n}function Qb(e,t,r){const n=e._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,k9(e,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&e._deferred.push(s);const o=e._editorState;let c=e._pendingEditorState,u=!1;(c===null||c._readOnly)&&(c=e._pendingEditorState=C9(c||o),u=!0),c._flushSync=i;const d=za,f=Eo,g=Wa,p=e._updating;za=c,Eo=!1,e._updating=!0,Wa=e;const x=e._headless||e.getRootElement()===null;N4(null);try{u&&(x?o._selection!==null&&(c._selection=o._selection.clone()):c._selection=(function(k,_){const N=k.getEditorState()._selection,E=pc(Pl(k));return Mt(N)||N==null?b4(N,E,k,_):N.clone()})(e,r&&r.event||null));const w=e._compositionKey;t(),a=g8(e,a),(function(k,_){const N=_.getEditorState()._selection,E=k._selection;if(Mt(E)){const P=E.anchor,F=E.focus;let A;if(P.type==="text"&&(A=P.getNode(),A.selectionTransform(N,E)),F.type==="text"){const j=F.getNode();A!==j&&j.selectionTransform(N,E)}}})(c,e),e._dirtyType!==a0&&(a?(function(k,_){const N=_._dirtyLeaves,E=k._nodeMap;for(const P of N){const F=E.get(P);rr(F)&&F.isAttached()&&F.isSimpleText()&&!F.isUnmergeable()&&HP(F)}})(c,e):(function(k,_){const N=_._dirtyLeaves,E=_._dirtyElements,P=k._nodeMap,F=mf(),A=new Map;let j=N,I=j.size,B=E,Y=B.size;for(;I>0||Y>0;){if(I>0){_._dirtyLeaves=new Set;for(const Z of j){const se=P.get(Z);rr(se)&&se.isAttached()&&se.isSimpleText()&&!se.isUnmergeable()&&HP(se),se!==void 0&&f8(se,F)&&d8(_,se,A),N.add(Z)}if(j=_._dirtyLeaves,I=j.size,I>0){o_++;continue}}_._dirtyLeaves=new Set,_._dirtyElements=new Map,B.delete("root")&&B.set("root",!0);for(const Z of B){const se=Z[0],ee=Z[1];if(E.set(se,ee),!ee)continue;const te=P.get(se);te!==void 0&&f8(te,F)&&d8(_,te,A)}j=_._dirtyLeaves,I=j.size,B=_._dirtyElements,Y=B.size,o_++}_._dirtyLeaves=N,_._dirtyElements=E})(c,e),g8(e),(function(k,_,N,E){const P=k._nodeMap,F=_._nodeMap,A=[];for(const[j]of E){const I=F.get(j);I!==void 0&&(I.isAttached()||(_t(I)&&LL(I,j,P,F,A,E),P.has(j)||E.delete(j),A.push(j)))}for(const j of A)F.delete(j);for(const j of N){const I=F.get(j);I===void 0||I.isAttached()||(P.has(j)||N.delete(j),F.delete(j))}})(o,c,e._dirtyLeaves,e._dirtyElements)),w!==e._compositionKey&&(c._flushSync=!0);const C=c._selection;if(Mt(C)){const k=c._nodeMap,_=C.anchor.key,N=C.focus.key;k.get(_)!==void 0&&k.get(N)!==void 0||Ht(19)}else Ai(C)&&C._nodes.size===0&&(c._selection=null)}catch(w){return w instanceof Error&&e._onError(w),e._pendingEditorState=o,e._dirtyType=bm,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void Wu(e)}finally{za=d,Eo=f,Wa=g,e._updating=p,o_=0}e._dirtyType!==a0||e._deferred.length>0||(function(w,C){const k=C.getEditorState()._selection,_=w._selection;if(_!==null){if(_.dirty||!_.is(k))return!0}else if(k!==null)return!0;return!1})(c,e)?c._flushSync?(c._flushSync=!1,Wu(e)):u&&mre((()=>{Wu(e)})):(c._flushSync=!1,u&&(n.clear(),e._deferred=[],e._pendingEditorState=null))}function Ho(e,t,r){Wa===e&&r===void 0?t():Qb(e,t,r)}class Cy{constructor(t,r,n){this.element=t,this.before=r||null,this.after=n||null}withBefore(t){return new Cy(this.element,t,this.after)}withAfter(t){return new Cy(this.element,this.before,t)}withElement(t){return this.element===t?this:new Cy(t,this.before,this.after)}insertChild(t){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&Ht(222),this.element.insertBefore(t,r),this}removeChild(t){return t.parentElement!==this.element&&Ht(223),this.element.removeChild(t),this}replaceChild(t,r){return r.parentElement!==this.element&&Ht(224),this.element.replaceChild(t,r),this}getFirstChild(){const t=this.after?this.after.nextSibling:this.element.firstChild;return t===this.before||t===this.getManagedLineBreak()?null:t}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(t){if(t===null)this.removeManagedLineBreak();else{const r=t==="decorator"&&(_m||Ky);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const t=this.getManagedLineBreak();if(t){const r=this.element,n=t.nodeName==="IMG"?t.nextSibling:null;n&&r.removeChild(n),r.removeChild(t),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(t){const r=this.getManagedLineBreak();if(r){if(t===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),t){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let t=0;for(let r=this.after;r!==null;r=r.previousSibling)t++;return t}resolveChildIndex(t,r,n,s){if(n===this.element){const c=this.getFirstChildOffset();return[t,Math.min(c+t.getChildrenSize(),Math.max(c,s))]}const a=m8(r,n);a.push(s);const i=m8(r,this.element);let o=t.getIndexWithinParent();for(let c=0;c<i.length;c++){const u=a[c],d=i[c];if(u===void 0||u<d)break;if(u>d){o+=1;break}}return[t.getParentOrThrow(),o]}}function m8(e,t){const r=[];let n=t;for(;n!==e&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==e&&Ht(225),r.reverse()}class $i extends Wm{constructor(t){super(t),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(t){super.afterCloneFrom(t),this.__key===t.__key&&(this.__first=t.__first,this.__last=t.__last,this.__size=t.__size),this.__indent=t.__indent,this.__format=t.__format,this.__style=t.__style,this.__dir=t.__dir,this.__textFormat=t.__textFormat,this.__textStyle=t.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const t=this.getFormat();return _te[t]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getChildrenKeys(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r.__key),r=r.getNextSibling();return t}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const t=Cs()._dirtyElements;return t!==null&&t.has(this.__key)}isLastChild(){const t=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(t)}getAllTextNodes(){const t=[];let r=this.getFirstChild();for(;r!==null;){if(rr(r)&&t.push(r),_t(r)){const n=r.getAllTextNodes();t.push(...n)}r=r.getNextSibling()}return t}getFirstDescendant(){let t=this.getFirstChild();for(;_t(t);){const r=t.getFirstChild();if(r===null)break;t=r}return t}getLastDescendant(){let t=this.getLastChild();for(;_t(t);){const r=t.getLastChild();if(r===null)break;t=r}return t}getDescendantByIndex(t){const r=this.getChildren(),n=r.length;if(t>=n){const a=r[n-1];return _t(a)&&a.getLastDescendant()||a||null}const s=r[t];return _t(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const t=this.getLatest().__first;return t===null?null:ha(t)}getFirstChildOrThrow(){const t=this.getFirstChild();return t===null&&Ht(45,this.__key),t}getLastChild(){const t=this.getLatest().__last;return t===null?null:ha(t)}getLastChildOrThrow(){const t=this.getLastChild();return t===null&&Ht(96,this.__key),t}getChildAtIndex(t){const r=this.getChildrenSize();let n,s;if(t<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=t;){if(s===t)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=t;){if(s===t)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let t="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContent(),_t(a)&&s!==n-1&&!a.isInline()&&(t+=ad)}return t}getTextContentSize(){let t=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContentSize(),_t(a)&&s!==n-1&&!a.isInline()&&(t+=ad.length)}return t}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(t){if(t!==""){const r=RP[t];return!!(this.getFormat()&r)}return!1}hasTextFormat(t){const r=i0[t];return!!(this.getTextFormat()&r)}getFormatFlags(t,r){return D_(this.getLatest().__textFormat,t,r)}getTextStyle(){return this.getLatest().__textStyle}select(t,r){hi();const n=tr();let s=t,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(t===0&&r===0){const c=this.getFirstChild();if(rr(c)||_t(c))return c.select(0,0)}else if(!(t!==void 0&&t!==i||r!==void 0&&r!==i)){const c=this.getLastChild();if(rr(c)||_t(c))return c.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const o=this.__key;return Mt(n)?(n.anchor.set(o,s,"element"),n.focus.set(o,a,"element"),n.dirty=!0,n):w9(o,s,o,a,"element","element")}selectStart(){const t=this.getFirstDescendant();return t?t.selectStart():this.select()}selectEnd(){const t=this.getLastDescendant();return t?t.selectEnd():this.select()}clear(){const t=this.getWritable();return this.getChildren().forEach((r=>r.remove())),t}append(...t){return this.splice(this.getChildrenSize(),0,t)}setDirection(t){const r=this.getWritable();return r.__dir=t,r}setFormat(t){return this.getWritable().__format=t!==""?RP[t]:0,this}setStyle(t){return this.getWritable().__style=t||"",this}setTextFormat(t){const r=this.getWritable();return r.__textFormat=t,r}setTextStyle(t){const r=this.getWritable();return r.__textStyle=t,r}setIndent(t){return this.getWritable().__indent=t,this}splice(t,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();t+r<=a||Ht(226,String(t),String(r),String(a));const o=i.__key,c=[],u=[],d=this.getChildAtIndex(t+r);let f=null,g=a-r+s;if(t!==0)if(t===a)f=this.getLastChild();else{const x=this.getChildAtIndex(t);x!==null&&(f=x.getPreviousSibling())}if(r>0){let x=f===null?this.getFirstChild():f.getNextSibling();for(let v=0;v<r;v++){x===null&&Ht(100);const w=x.getNextSibling(),C=x.__key;Kh(x.getWritable()),u.push(C),x=w}}let p=f;for(let x=0;x<s;x++){const v=n[x];p!==null&&v.is(p)&&(f=p=p.getPreviousSibling());const w=v.getWritable();w.__parent===o&&g--,Kh(w);const C=v.__key;if(p===null)i.__first=C,w.__prev=null;else{const k=p.getWritable();k.__next=C,w.__prev=k.__key}v.__key===o&&Ht(76),w.__parent=o,c.push(C),p=v}if(t+r===a)p!==null&&(p.getWritable().__next=null,i.__last=p.__key);else if(d!==null){const x=d.getWritable();if(p!==null){const v=p.getWritable();x.__prev=p.__key,v.__next=d.__key}else x.__prev=null}if(i.__size=g,u.length){const x=tr();if(Mt(x)){const v=new Set(u),w=new Set(c),{anchor:C,focus:k}=x;p8(C,v,w)&&F_(C,C.getNode(),this,f,d),p8(k,v,w)&&F_(k,k.getNode(),this,f,d),g!==0||this.canBeEmpty()||io(this)||this.remove()}}return i}getDOMSlot(t){return new Cy(t)}exportDOM(t){const{element:r}=super.exportDOM(t);if(os(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const t={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(t.textFormat=r),n!==""&&(t.textStyle=n),t}updateFromJSON(t){return super.updateFromJSON(t).setFormat(t.format).setIndent(t.indent).setDirection(t.direction).setTextFormat(t.textFormat||0).setTextStyle(t.textStyle||"")}insertNewAfter(t,r){return null}canIndent(){return!0}collapseAtStart(t){return!1}excludeFromCopy(t){return!1}canReplaceWith(t){return!0}canInsertAfter(t){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(t){return!1}extractWithChild(t,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(t,r){const n=this.getDOMSlot(t);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function _t(e){return e instanceof $i}function p8(e,t,r){let n=e.getNode();for(;n;){const s=n.__key;if(t.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class k4 extends Wm{decorate(t,r){Ht(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function _n(e){return e instanceof k4}class Rv extends $i{static getType(){return"root"}static clone(){return new Rv}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){Ht(51)}getTextContent(){const t=this.__cachedText;return!Iv()&&Cs()._dirtyType!==a0||t===null?super.getTextContent():t}remove(){Ht(52)}replace(t){Ht(53)}insertBefore(t){Ht(54)}insertAfter(t){Ht(55)}updateDOM(t,r){return!1}splice(t,r,n){for(const s of n)_t(s)||_n(s)||Ht(282);return super.splice(t,r,n)}static importJSON(t){return ys().updateFromJSON(t)}collapseAtStart(){return!0}}function Ea(e){return e instanceof Rv}function C9(e){return new Jb(new Map(e._nodeMap))}function C4(){return new Jb(new Map([["root",new Rv]]))}function T9(e){const t=e.exportJSON(),r=e.constructor;if(t.type!==r.getType()&&Ht(130,r.name),_t(e)){const n=t.children;Array.isArray(n)||Ht(59,r.name);const s=e.getChildren();for(let a=0;a<s.length;a++){const i=T9(s[a]);n.push(i)}}return t}class Jb{constructor(t,r){this._nodeMap=t,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(t,r){return h8(r&&r.editor||null,this,t)}clone(t){const r=new Jb(this._nodeMap,t===void 0?this._selection:t);return r._readOnly=!0,r}toJSON(){return h8(null,this,(()=>({root:T9(ys())})))}}const O_="historic",ore="history-push",Ty="history-merge",lre="paste",E9="collaboration",cre="skip-scroll-into-view",ure="skip-dom-selection";class T4 extends $i{static getType(){return"artificial"}createDOM(t){return document.createElement("div")}}class Mv extends $i{static getType(){return"paragraph"}static clone(t){return new Mv(t.__key)}createDOM(t){const r=document.createElement("p"),n=cm(t.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(t,r,n){return!1}static importDOM(){return{p:t=>({conversion:dre,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(os(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(t){return is().updateFromJSON(t)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(t,r){const n=is();n.setTextFormat(t.format),n.setTextStyle(t.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const t=this.getChildren();if(t.length===0||rr(t[0])&&t[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function dre(e){const t=is();return e.style&&(t.setFormat(e.style.textAlign),L4(e,t)),{node:t}}function is(){return co(new Mv)}function E4(e){return e instanceof Mv}const gn=0,Gg=1,fre=4;function N9(e,t,r,n){const s=e._keyToDOMMap;s.clear(),e._editorState=C4(),e._pendingEditorState=n,e._compositionKey=null,e._dirtyType=a0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const a=e._observer;a!==null&&(a.disconnect(),e._observer=null),t!==null&&(t.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function hre(e){const t=e||{},r=are(),n=t.theme||{},s=e===void 0?r:t.parentEditor||null,a=t.disableEvents||!1,i=C4(),o=t.namespace||(s!==null?s._config.namespace:R9()),c=t.editorState,u=[Rv,Lf,Ov,Dv,Mv,T4,...t.nodes||[]],{onError:d,html:f}=t,g=t.editable===void 0||t.editable;let p;if(e===void 0&&r!==null)p=r._nodes;else{p=new Map;for(let v=0;v<u.length;v++){let w=u[v],C=null,k=null;if(typeof w!="function"){const F=w;w=F.replace,C=F.with,k=F.withKlass||null}const{ownNodeConfig:_}=B4(w),N=w.getType(),E=w.transform(),P=new Set;_&&_.$transform&&P.add(_.$transform),E!==null&&P.add(E),p.set(N,{exportDOM:f&&f.export?f.export.get(w):void 0,klass:w,replace:C,replaceWithKlass:k,sharedNodeState:Ate(u[v]),transforms:P})}}const x=new Zb(i,s,p,{disableEvents:a,namespace:o,theme:n},d||console.error,(function(v,w){const C=new Map,k=new Set,_=N=>{Object.keys(N).forEach((E=>{let P=C.get(E);P===void 0&&(P=[],C.set(E,P)),P.push(N[E])}))};return v.forEach((N=>{const E=N.klass.importDOM;if(E==null||k.has(E))return;k.add(E);const P=E.call(N.klass);P!==null&&_(P)})),w&&_(w),C})(p,f?f.import:void 0),g,e);return c!==void 0&&(x._pendingEditorState=c,x._dirtyType=bm),x}class Zb{constructor(t,r,n,s,a,i,o,c){this._createEditorArgs=c,this._parentEditor=r,this._rootElement=null,this._editorState=t,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=a0,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=R9(),this._onError=a,this._htmlConversions=i,this._editable=o,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(t){const r=this._listeners.update;return r.add(t),()=>{r.delete(t)}}registerEditableListener(t){const r=this._listeners.editable;return r.add(t),()=>{r.delete(t)}}registerDecoratorListener(t){const r=this._listeners.decorator;return r.add(t),()=>{r.delete(t)}}registerTextContentListener(t){const r=this._listeners.textcontent;return r.add(t),()=>{r.delete(t)}}registerRootListener(t){const r=this._listeners.root;return t(this._rootElement,null),r.add(t),()=>{t(null,this._rootElement),r.delete(t)}}registerCommand(t,r,n){n===void 0&&Ht(35);const s=this._commands;s.has(t)||s.set(t,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(t);a===void 0&&Ht(36,String(t));const i=a[n];return i.add(r),()=>{i.delete(r),a.every((o=>o.size===0))&&s.delete(t)}}registerMutationListener(t,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(t)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const o=n&&n.skipInitialization;return o!==void 0&&o||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(t){const r=this._nodes.get(t.getType());return r===void 0&&Ht(37,t.name),r}resolveRegisteredNodeAfterReplacements(t){for(;t.replaceWithKlass;)t=this.getRegisteredNode(t.replaceWithKlass);return t}initializeMutationListener(t,r){const n=this._editorState,s=C8(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&t(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(t,r){const n=this.getRegisteredNode(t);return n.transforms.add(r),n}registerNodeTransform(t,r){const n=this.registerNodeTransformToKlass(t,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return(function(i,o){const c=C8(i.getEditorState()),u=[];for(const d of o){const f=c.get(d);f&&u.push(f)}u.length!==0&&i.update((()=>{for(const d of u)for(const f of d.keys()){const g=ha(f);g&&g.markDirty()}}),i._pendingEditorState===null?{tag:Ty}:void 0)})(this,s.map((i=>i.klass.getType()))),()=>{s.forEach((i=>i.transforms.delete(r)))}}hasNode(t){return this._nodes.has(t.getType())}hasNodes(t){return t.every(this.hasNode.bind(this))}dispatchCommand(t,r){return hr(this,t,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(t){const r=this._rootElement;if(t!==r){const n=cm(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=t,N9(this,r,t,s),r!==null&&(this._config.disableEvents||Kte(r),n!=null&&r.classList.remove(...n)),t!==null){const a=R4(t),i=t.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",t.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=bm,UL(this),this._updateTags.add(Ty),Wu(this),this._config.disableEvents||(function(o,c){const u=o.ownerDocument,d=j_.get(u);(d===void 0||d<1)&&u.addEventListener("selectionchange",m9),j_.set(u,(d||0)+1),o.__lexicalEditor=c;const f=g9(o);for(let g=0;g<YT.length;g++){const[p,x]=YT[g],v=typeof x=="function"?w=>{QP(w)||(XP(w),(c.isEditable()||p==="click")&&x(w,c))}:w=>{if(QP(w))return;XP(w);const C=c.isEditable();switch(p){case"cut":return C&&hr(c,v4,w);case"copy":return hr(c,Kb,w);case"paste":return C&&hr(c,p4,w);case"dragstart":return C&&hr(c,i9,w);case"dragover":return C&&hr(c,o9,w);case"dragend":return C&&hr(c,Ute,w);case"focus":return C&&hr(c,Hte,w);case"blur":return C&&hr(c,Gte,w);case"drop":return C&&hr(c,s9,w)}};o.addEventListener(p,v),f.push((()=>{o.removeEventListener(p,v)}))}})(t,this),n!=null&&t.classList.add(...n)}else this._window=null,this._updateTags.add(Ty),Wu(this);ky("root",this,!1,t,r)}}getElementByKey(t){return this._keyToDOMMap.get(t)||null}getEditorState(){return this._editorState}setEditorState(t,r){t.isEmpty()&&Ht(38);let n=t;n._readOnly&&(n=C9(t),n._selection=t._selection?t._selection.clone():null),$L(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),Wu(this)),this._pendingEditorState=n,this._dirtyType=bm,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||Wu(this)}parseEditorState(t,r){return(function(n,s,a){const i=C4(),o=za,c=Eo,u=Wa,d=s._dirtyElements,f=s._dirtyLeaves,g=s._cloneNotNeeded,p=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,za=i,Eo=!1,Wa=s,N4(null);try{const x=s._nodes;S4(n.root,x),a&&a(),i._readOnly=!0}catch(x){x instanceof Error&&s._onError(x)}finally{s._dirtyElements=d,s._dirtyLeaves=f,s._cloneNotNeeded=g,s._dirtyType=p,za=o,Eo=c,Wa=u}return i})(typeof t=="string"?JSON.parse(t):t,this,r)}read(t){return Wu(this),this.getEditorState().read(t,{editor:this})}update(t,r){(function(n,s,a){n._updating?n._updates.push([s,a]):Qb(n,s,a)})(this,t,r)}focus(t,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),Ho(this,(()=>{const s=tr(),a=ys();s!==null?s.dirty||vi(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),wre("focus"),_re((()=>{n.removeAttribute("autocapitalize"),t&&t()}))})),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const t=this._rootElement;t!==null&&t.blur();const r=pc(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(t){this._editable!==t&&(this._editable=t,ky("editable",this,!0,t))}toJSON(){return{editorState:this._editorState.toJSON()}}}Zb.version="0.35.0+prod.esm";let tE=null;function N4(e){tE=e}let gre=1;function A9(e,t){const r=A4(e,t);return r===void 0&&Ht(30,t),r}function A4(e,t){return e._nodes.get(t)}const mre=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)};function x8(e){return _n(Nf(e))}function j4(e){const t=document.activeElement;if(!os(t))return!1;const r=t.nodeName;return _n(Nf(e))&&(r==="INPUT"||r==="TEXTAREA"||t.contentEditable==="true"&&e2(t)==null)}function Lv(e,t,r){const n=e.getRootElement();try{return n!==null&&n.contains(t)&&n.contains(r)&&t!==null&&!j4(t)&&j9(t)===e}catch{return!1}}function P4(e){return e instanceof Zb}function j9(e){let t=e;for(;t!=null;){const r=e2(t);if(P4(r))return r;t=Bv(t)}return null}function e2(e){return e?e.__lexicalEditor:null}function Vh(e){return qb(e)||e.isToken()}function Uu(e){return Vh(e)||e.isSegmented()}function fd(e){return Vm(e)&&e.nodeType===fte}function pre(e){return Vm(e)&&e.nodeType===hte}function Sm(e){let t=e;for(;t!=null;){if(fd(t))return t;t=t.firstChild}return null}function D_(e,t,r){const n=i0[t];if(r!==null&&(e&n)==(r&n))return e;let s=e^n;return t==="subscript"?s&=-65:t==="superscript"?s&=-33:t==="lowercase"?(s&=-513,s&=-1025):t==="uppercase"?(s&=-257,s&=-1025):t==="capitalize"&&(s&=-257,s&=-513),s}function P9(e){return rr(e)||Qu(e)||_n(e)}function xre(e,t){const r=(function(){const i=tE;return tE=null,i})();if((t=t||r&&r.__key)!=null)return void(e.__key=t);hi(),b9();const n=Cs(),s=Bf(),a=""+gre++;s._nodeMap.set(a,e),_t(e)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=ML,e.__key=a}function Kh(e){const t=e.getParent();if(t!==null){const r=e.getWritable(),n=t.getWritable(),s=e.getPreviousSibling(),a=e.getNextSibling(),i=a!==null?a.__key:null,o=s!==null?s.__key:null,c=s!==null?s.getWritable():null,u=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=o),c!==null&&(c.__next=i),u!==null&&(u.__prev=o),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function I_(e){b9();const t=e.getLatest(),r=t.__parent,n=Bf(),s=Cs(),a=n._nodeMap,i=s._dirtyElements;r!==null&&(function(c,u,d){let f=c;for(;f!==null;){if(d.has(f))return;const g=u.get(f);if(g===void 0)break;d.set(f,!1),f=g.__parent}})(r,a,i);const o=t.__key;s._dirtyType=ML,_t(e)?i.set(o,!0):s._dirtyLeaves.add(o)}function gi(e){hi();const t=Cs(),r=t._compositionKey;if(e!==r){if(t._compositionKey=e,r!==null){const n=ha(r);n!==null&&n.getWritable()}if(e!==null){const n=ha(e);n!==null&&n.getWritable()}}}function mf(){return Iv()?null:Cs()._compositionKey}function ha(e,t){const r=(t||Bf())._nodeMap.get(e);return r===void 0?null:r}function F9(e,t){const r=t2(e,Cs());return r!==void 0?ha(r,t):null}function t2(e,t){return e[`__lexicalKey_${t._key}`]}function Nf(e,t){let r=e;for(;r!=null;){const n=F9(r,t);if(n!==null)return n;r=Bv(r)}return null}function O9(e){const t=e._decorators,r=Object.assign({},t);return e._pendingDecorators=r,r}function y8(e){return e.read((()=>ys().getTextContent()))}function ys(){return D9(Bf())}function D9(e){return e._nodeMap.get("root")}function vi(e){hi();const t=Bf();e!==null&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function tm(e){const t=Cs(),r=(function(n,s){let a=n;for(;a!=null;){const i=t2(a,s);if(i!==void 0)return i;a=Bv(a)}return null})(e,t);return r===null?e===t.getRootElement()?ha("root"):null:ha(r)}function I9(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function F4(e){const t=[];let r=e;for(;r!==null;)t.push(r),r=r._parentEditor;return t}function R9(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function M9(e){return fd(e)?e.nodeValue:null}function O4(e,t,r){const n=pc(Pl(t));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let o=M9(s);const c=Nf(s);if(o!==null&&rr(c)){if(o===Gb&&r){const u=r.length;o=r,a=u,i=u}o!==null&&D4(c,o,a,i,e)}}}function D4(e,t,r,n,s){let a=e;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let o=t;(i||s)&&t[t.length-1]===Gb&&(o=t.slice(0,-1));const c=a.getTextContent();if(s||o!==c){if(o===""){if(gi(null),Ky||_m||__)a.remove();else{const v=Cs();setTimeout((()=>{v.update((()=>{a.isAttached()&&a.remove()}))}),20)}return}const u=a.getParent(),d=Gm(),f=a.getTextContentSize(),g=mf(),p=a.getKey();if(a.isToken()||g!==null&&p===g&&!i||Mt(d)&&(u!==null&&!u.canInsertTextBefore()&&d.anchor.offset===0||d.anchor.key===e.__key&&d.anchor.offset===0&&!a.canInsertTextBefore()&&!i||d.focus.key===e.__key&&d.focus.offset===f&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const x=tr();if(!Mt(x)||r===null||n===null)return void v8(a,o,x);if(x.setTextNodeRange(a,r,a,n),a.isSegmented()){const v=Ds(a.getTextContent());a.replace(v),a=v}v8(a,o,x)}}}function v8(e,t,r){if(e.setTextContent(t),Mt(r)){const n=e.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=bf(e,a.offset,"clamp"))}}}function bw(e,t,r){const n=t[r]||!1;return n==="any"||n===e[r]}function yre(e,t){return bw(e,t,"altKey")&&bw(e,t,"ctrlKey")&&bw(e,t,"shiftKey")&&bw(e,t,"metaKey")}function On(e,t,r){return yre(e,r)&&e.key.toLowerCase()===t.toLowerCase()}const $u={ctrlKey:!Kc,metaKey:Kc},w8={altKey:Kc,ctrlKey:!Kc};function _8(e){return e.key==="Backspace"}function b8(e){return On(e,"a",$u)}function vre(e){const t=ys();if(Mt(e)){const r=e.anchor,n=e.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),k_(e),e}{const r=t.select(0,t.getChildrenSize());return vi(k_(r)),r}}function cm(e,t){e.__lexicalClassNameCache===void 0&&(e.__lexicalClassNameCache={});const r=e.__lexicalClassNameCache,n=r[t];if(n!==void 0)return n;const s=e[t];if(typeof s=="string"){const a=RL(s);return r[t]=a,a}return s}function I4(e,t,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,o=t.get(a);o===void 0&&Ht(33,a);const c=o.klass;let u=e.get(c);u===void 0&&(u=new Map,e.set(c,u));const d=u.get(i),f=d==="destroyed"&&s==="created";(d===void 0||f)&&u.set(i,f?"updated":s)}function S8(e,t,r){const n=e.getParent();let s=r,a=e;return n!==null&&(t&&r===0?(s=a.getIndexWithinParent(),a=n):t||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(t?s-1:s)}function rE(e,t){const r=e.offset;if(e.type==="element")return S8(e.getNode(),t,r);{const n=e.getNode();if(t&&r===0||!t&&r===n.getTextContentSize()){const s=t?n.getPreviousSibling():n.getNextSibling();return s===null?S8(n.getParentOrThrow(),t,n.getIndexWithinParent()+(t?0:1)):s}}return null}function L9(e){const t=Pl(e).event,r=t&&t.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function hr(e,t,r){return(function(n,s,a){const i=F4(n);for(let o=4;o>=0;o--)for(let c=0;c<i.length;c++){const u=i[c],d=u._commands.get(s);if(d!==void 0){const f=d[o];if(f!==void 0){const g=Array.from(f),p=g.length;let x=!1;if(Ho(u,(()=>{for(let v=0;v<p;v++)if(g[v](a,n))return void(x=!0)})),x)return x}}}return!1})(e,t,r)}function r2(e){return!Ea(e)&&!e.isLastChild()&&!e.isInline()}function c0(e,t){const r=e._keyToDOMMap.get(t);return r===void 0&&Ht(75,t),r}function Bv(e){const t=e.assignedSlot||e.parentElement;return aE(t)?t.host:t}function B9(e){return pre(e)?e:os(e)?e.ownerDocument:null}function wre(e){hi(),Cs()._updateTags.add(e)}function _re(e){hi(),Cs()._deferred.push(e)}function nE(e,t){let r=e.getParent();for(;r!==null;){if(r.is(t))return!0;r=r.getParent()}return!1}function R4(e){const t=B9(e);return t?t.defaultView:null}function Pl(e){const t=e._window;return t===null&&Ht(78),t}function bre(e){return _t(e)&&e.isInline()||_n(e)&&e.isInline()}function Sre(e){let t=e.getParentOrThrow();for(;t!==null;){if(io(t))return t;t=t.getParentOrThrow()}return t}function io(e){return Ea(e)||_t(e)&&e.isShadowRoot()}function co(e){const t=Cs(),r=e.getType(),n=A4(t,r);n===void 0&&Ht(200,e.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(e),o=i.constructor;return a!==null?i instanceof a||Ht(201,a.name,a.getType(),o.name,o.getType(),e.constructor.name,r):i instanceof e.constructor&&o!==e.constructor||Ht(202,o.name,o.getType(),e.constructor.name,r),i.__key===e.__key&&Ht(203,e.constructor.name,r,o.name,o.getType()),i}return e}function hk(e,t){!Ea(e.getParent())||_t(t)||_n(t)||Ht(99)}function kre(e){const t=ha(e);return t===null&&Ht(63,e),t}function gk(e){return(_n(e)||_t(e)&&!e.canBeEmpty())&&!e.isInline()}function sE(e,t,r){r.style.removeProperty("caret-color"),t._blockCursorElement=null;const n=e.parentElement;n!==null&&n.removeChild(e)}function pc(e){return vc?(e||window).getSelection():null}function Cre(e){const t=R4(e);return t?t.getSelection():null}function $9(e){return os(e)&&e.tagName==="A"}function os(e){return Vm(e)&&e.nodeType===dte}function Vm(e){return typeof e=="object"&&e!==null&&"nodeType"in e&&typeof e.nodeType=="number"}function aE(e){return Vm(e)&&e.nodeType===gte}function iE(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return e.nodeName.match(t)!==null}function R_(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return e.nodeName.match(t)!==null}function Cl(e){if(_n(e)&&!e.isInline())return!0;if(!_t(e)||io(e))return!1;const t=e.getFirstChild(),r=t===null||Qu(t)||rr(t)||t.isInline();return!e.isInline()&&e.canBeEmpty()!==!1&&r}function mk(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function $v(){return Cs()}const k8=new WeakMap,Tre=new Map;function C8(e){if(!e._readOnly&&e.isEmpty())return Tre;e._readOnly||Ht(192);let t=k8.get(e);return t||(t=(function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let o=n.get(i);o||(o=new Map,n.set(i,o)),o.set(s,a)}return n})(e),k8.set(e,t)),t}function M4(e){const t=e.constructor.clone(e);return t.afterCloneFrom(e),t}function L4(e,t){const r=parseInt(e.style.paddingInlineStart,10)||0,n=Math.round(r/40);t.setIndent(n)}function Ere(e){e.__lexicalUnmanaged=!0}function Nre(e){return e.__lexicalUnmanaged===!0}function Yx(e,t){return(function(r,n){return Object.prototype.hasOwnProperty.call(r,n)})(e,t)&&e[t]!==Wm[t]}function B4(e){const t=MP in e.prototype?e.prototype[MP]():void 0,r=(function(i){return i===k4||i===$i||i===Wm})(e),n=!r&&Yx(e,"getType")?e.getType():void 0;let s,a=n;if(t)if(n)s=t[n];else for(const[i,o]of Object.entries(t))a=i,s=o;if(!r&&a&&(Yx(e,"getType")||(e.getType=()=>a),Yx(e,"clone")||(e.clone=i=>(N4(i),new e)),Yx(e,"importJSON")||(e.importJSON=s&&s.$importJSON||(i=>new e().updateFromJSON(i))),!Yx(e,"importDOM")&&s)){const{importDOM:i}=s;i&&(e.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function Are(e){const t=$v();return hi(),new(t.resolveRegisteredNodeAfterReplacements(t.getRegisteredNode(e))).klass}const jre={next:"previous",previous:"next"};class $4{constructor(t){this.origin=t}[Symbol.iterator](){return G4({hasNext:f0,initial:this.getAdjacentCaret(),map:t=>t,step:t=>t.getAdjacentCaret()})}getAdjacentCaret(){return yi(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return yi(this.origin,this.direction)}remove(){const t=this.getNodeAtCaret();return t&&t.remove(),this}replaceOrInsert(t,r){const n=this.getNodeAtCaret();return t.is(this.origin)||t.is(n)||(n===null?this.insert(t):n.replace(t,r)),this}splice(t,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),o=new Map;for(let c=a.getAdjacentCaret();c!==null&&o.size<t;c=c.getAdjacentCaret()){const u=c.origin.getWritable();o.set(u.getKey(),u)}for(const c of s){if(o.size>0){const u=a.getNodeAtCaret();if(u){if(o.delete(u.getKey()),o.delete(c.getKey()),!(u.is(c)||a.origin.is(c))){const d=c.getParent();d&&d.is(i)&&c.remove(),u.replace(c)}}else u===null&&Ht(263,Array.from(o).join(" "))}else a.insert(c);a=yi(c,this.direction)}for(const c of o.values())c.remove();return this}}class Zy extends $4{type="child";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:Fl(t,this.direction)}getParentCaret(t="root"){return yi(U4(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=Km(this.direction);return yi(this.getNodeAtCaret(),t)||Fl(this.origin,t)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(t){return t instanceof Zy&&this.direction===t.direction&&this.origin.is(t.origin)}isSamePointCaret(t){return this.isSameNodeCaret(t)}}const Pre={root:Ea,shadowRoot:io};function Km(e){return jre[e]}function U4(e,t="root"){return Pre[t](e)?null:e}class u0 extends $4{type="sibling";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:yi(t,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return _t(this.origin)?Fl(this.origin,this.direction):null}getParentCaret(t="root"){return yi(U4(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=Km(this.direction);return yi(this.getNodeAtCaret(),t)||Fl(this.origin.getParentOrThrow(),t)}isSamePointCaret(t){return t instanceof u0&&this.direction===t.direction&&this.origin.is(t.origin)}isSameNodeCaret(t){return(t instanceof u0||t instanceof d0)&&this.direction===t.direction&&this.origin.is(t.origin)}}class d0 extends $4{type="text";constructor(t,r){super(t),this.offset=r}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:h0(t,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(t="root"){return yi(U4(this.getParentAtCaret(),t),this.direction)}getFlipped(){return h0(this.origin,Km(this.direction),this.offset)}isSamePointCaret(t){return t instanceof d0&&this.direction===t.direction&&this.origin.is(t.origin)&&this.offset===t.offset}isSameNodeCaret(t){return(t instanceof u0||t instanceof d0)&&this.direction===t.direction&&this.origin.is(t.origin)}getSiblingCaret(){return yi(this.origin,this.direction)}}function _f(e){return e instanceof d0}function f0(e){return e instanceof u0}function tu(e){return e instanceof Zy}const Fre={next:class extends d0{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends d0{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},Ore={next:class extends u0{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends u0{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},Dre={next:class extends Zy{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends Zy{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function yi(e,t){return e?new Ore[t](e):null}function h0(e,t,r){return e?new Fre[t](e,bf(e,r)):null}function bf(e,t,r="error"){const n=e.getTextContentSize();let s=t==="next"?n:t==="previous"?0:t;return(s<0||s>n)&&(r!=="clamp"&&(function(a,...i){const o=new URL("https://lexical.dev/docs/error"),c=new URLSearchParams;c.append("code",a);for(const u of i)c.append("v",u);o.search=c.toString(),console.warn(`Minified Lexical warning #${a}; visit ${o.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(284,String(t),String(n),e.getKey()),s=s<0?0:n),s}function T8(e,t){return new Rre(e,t)}function Fl(e,t){return _t(e)?new Dre[t](e):null}function Ire(e){return e&&e.getChildCaret()||e}function z4(e){return e&&Ire(e.getAdjacentCaret())}class W4{type="node-caret-range";constructor(t,r,n){this.anchor=t,this.focus=r,this.direction=n}getLatest(){const t=this.anchor.getLatest(),r=this.focus.getLatest();return t===this.anchor&&r===this.focus?this:new W4(t,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const t=s=>{const a=this[s].getLatest();return _f(a)?(function(i,o){const{direction:c,origin:u}=i,d=bf(u,o==="focus"?Km(c):c);return T8(i,d-i.offset)})(a,s):null},r=t("anchor"),n=t("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[T8(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(t="root"){const r=_f(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=_f(n),a=i=>i.isSameNodeCaret(n)?null:z4(i)||i.getParentCaret(t);return G4({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class Rre{type="slice";constructor(t,r){this.caret=t,this.distance=r}getSliceIndices(){const{distance:t,caret:{offset:r}}=this,n=r+t;return n<r?[n,r]:[r,n]}getTextContent(){const[t,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(t,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:t,direction:r}}=this,[n,s]=this.getSliceIndices(),a=t.getTextContent();return h0(t.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function H4(e){return Af(e,yi(ys(),e.direction))}function Mre(e){return Af(e,e)}function Af(e,t){return e.direction!==t.direction&&Ht(265),new W4(e,t,e.direction)}function G4(e){const{initial:t,hasNext:r,step:n,map:s}=e;let a=t;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function U9(e,t){const r=l_(e.origin,t.origin);switch(r===null&&Ht(275,e.origin.getKey(),t.origin.getKey()),r.type){case"same":{const n=e.type==="text",s=t.type==="text";return n&&s?(function(a,i){return Math.sign(a-i)})(e.offset,t.offset):e.type===t.type?0:n?-1:s?1:e.type==="child"?-1:1}case"ancestor":return e.type==="child"?-1:1;case"descendant":return t.type==="child"?1:-1;case"branch":return z9(r)}}function z9(e){const{a:t,b:r}=e,n=t.__key,s=r.__key;let a=t,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function Sw(e,t){return t.is(e)}function E8(e){return _t(e)?[e.getLatest(),null]:[e.getParent(),e.getLatest()]}function l_(e,t){if(e.is(t))return{commonAncestor:e,type:"same"};const r=new Map;for(let[n,s]=E8(e);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=E8(t);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(Sw(e,n)||Ht(276),{commonAncestor:n,type:"ancestor"}):s===null?(Sw(t,n)||Ht(277),{commonAncestor:n,type:"descendant"}):((_t(a)||Sw(e,a))&&(_t(s)||Sw(t,s))&&n.is(a.getParent())&&n.is(s.getParent())||Ht(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function id(e,t){const{type:r,key:n,offset:s}=e,a=kre(e.key);return r==="text"?(rr(a)||Ht(266,a.getType(),n),h0(a,t,s)):(_t(a)||Ht(267,a.getType(),n),$re(a,e.offset,t))}function g0(e,t){const{origin:r,direction:n}=t,s=n==="next";_f(t)?e.set(r.getKey(),t.offset,"text"):f0(t)?rr(r)?e.set(r.getKey(),bf(r,n),"text"):e.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(tu(t)&&_t(r)||Ht(268),e.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function Lre(e){const t=tr(),r=Mt(t)?t:Xb();return c_(r,e),vi(r),r}function c_(e,t){g0(e.anchor,t.anchor),g0(e.focus,t.focus)}function N8(e){const{anchor:t,focus:r}=e,n=id(t,"next"),s=id(r,"next"),a=U9(n,s)<=0?"next":"previous";return Af(km(n,a),km(s,a))}function V4(e){const{direction:t,origin:r}=e,n=yi(r,Km(t)).getNodeAtCaret();return n?yi(n,t):Fl(r.getParentOrThrow(),t)}function A8(e,t="root"){const r=[e];for(let n=tu(e)?e.getParentCaret(t):e.getSiblingCaret();n!==null;n=n.getParentCaret(t))r.push(V4(n));return r}function pk(e){return!!e&&e.origin.isAttached()}function Bre(e,t="removeEmptySlices"){if(e.isCollapsed())return e;const r="root",n="next";let s=t;const a=H9(e,n),i=A8(a.anchor,r),o=A8(a.focus.getFlipped(),r),c=new Set,u=[];for(const x of a.iterNodeCarets(r))if(tu(x))c.add(x.origin.getKey());else if(f0(x)){const{origin:v}=x;_t(v)&&!c.has(v.getKey())||u.push(v)}for(const x of u)x.remove();for(const x of a.getTextSlices()){if(!x)continue;const{origin:v}=x.caret,w=v.getTextContentSize(),C=V4(yi(v,n)),k=v.getMode();if(Math.abs(x.distance)===w&&s==="removeEmptySlices"||k==="token"&&x.distance!==0)C.remove();else if(x.distance!==0){s="removeEmptySlices";let _=x.removeTextSlice();const N=x.caret.origin;if(k==="segmented"){const E=_.origin,P=Ds(E.getTextContent()).setStyle(E.getStyle()).setFormat(E.getFormat());C.replaceOrInsert(P),_=h0(P,n,_.offset)}N.is(i[0].origin)&&(i[0]=_),N.is(o[0].origin)&&(o[0]=_.getFlipped())}}let d,f;for(const x of i)if(pk(x)){d=Tl(x);break}for(const x of o)if(pk(x)){f=Tl(x);break}const g=(function(x,v,w){if(!x||!v)return null;const C=x.getParentAtCaret(),k=v.getParentAtCaret();if(!C||!k)return null;const _=C.getParents().reverse();_.push(C);const N=k.getParents().reverse();N.push(k);const E=Math.min(_.length,N.length);let P;for(P=0;P<E&&_[P]===N[P];P++);const F=(I,B)=>{let Y;for(let Z=P;Z<I.length;Z++){const se=I[Z];if(io(se))return;!Y&&B(se)&&(Y=se)}return Y},A=F(_,Cl),j=A&&F(N,(I=>w.has(I.getKey())&&Cl(I)));return A&&j?[A,j]:null})(d,f,c);if(g){const[x,v]=g;Fl(x,"previous").splice(0,v.getChildren()),v.remove()}const p=[d,f,...i,...o].find(pk);if(p)return Mre(km(Tl(p),e.direction));Ht(269,JSON.stringify(i.map((x=>x.origin.__key))))}function Tl(e){const t=(function(s){let a=s;for(;tu(a);){const i=z4(a);if(!tu(i))break;a=i}return a})(e.getLatest()),{direction:r}=t;if(rr(t.origin))return _f(t)?t:h0(t.origin,r,r);const n=t.getAdjacentCaret();return f0(n)&&rr(n.origin)?h0(n.origin,r,Km(r)):t}function W9(e){return _f(e)&&e.offset!==bf(e.origin,e.direction)}function km(e,t){return e.direction===t?e:e.getFlipped()}function H9(e,t){return e.direction===t?e:Af(km(e.focus,t),km(e.anchor,t))}function $re(e,t,r){let n=Fl(e,"next");for(let s=0;s<t;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return km(n,r)}const G9=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Ure=G9?S.useLayoutEffect:S.useEffect,kw={tag:Ty};function V9({initialConfig:e,children:t}){const r=S.useMemo((()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:o,html:c}=e,u=lte(null,n),d=hre({editable:e.editable,html:c,namespace:s,nodes:a,onError:f=>i(f,d),theme:n});return(function(f,g){if(g!==null){if(g===void 0)f.update((()=>{const p=ys();if(p.isEmpty()){const x=is();p.append(x);const v=G9?document.activeElement:null;(tr()!==null||v!==null&&v===f.getRootElement())&&x.select()}}),kw);else if(g!==null)switch(typeof g){case"string":{const p=f.parseEditorState(g);f.setEditorState(p,kw);break}case"object":f.setEditorState(g,kw);break;case"function":f.update((()=>{ys().isEmpty()&&g(f)}),kw)}}})(d,o),[d,u]}),[]);return Ure((()=>{const n=e.editable,[s]=r;s.setEditable(n===void 0||n)}),[]),l.jsx(zm.Provider,{value:r,children:t})}const zre=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function Wre(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}function Hre(){return(function(e){const[t]=ou(),r=S.useMemo((()=>e(t)),[t,e]),[n,s]=S.useState((()=>r.initialValueFn())),a=S.useRef(n);return zre((()=>{const{initialValueFn:i,subscribe:o}=r,c=i();return a.current!==c&&(a.current=c,s(c)),o((u=>{a.current=u,s(u)}))}),[r,e]),n})(Wre)}function Gre(){return ys().getTextContent()}function Vre(e,t=!0){if(e)return!1;let r=Gre();return t&&(r=r.trim()),r===""}function Kre(e){if(!Vre(e,!1))return!1;const t=ys().getChildren(),r=t.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=t[n];if(_n(s))return!1;if(_t(s)){if(!E4(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let o=0;o<i;o++){const c=a[n];if(!rr(c))return!1}}}return!0}function K9(e){return()=>Kre(e)}const oE=new Map;function q9(e){const t={};if(!e)return t;const r=e.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(t[s.trim()]=a.trim())}return t}function j8(e){let t=oE.get(e);return t===void 0&&(t=q9(e),oE.set(e,t)),t}function Y9(e){const t=$v().getElementByKey(e.getKey());if(t===null)return null;const r=t.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(t)}function X9(e){return Y9(Ea(e)?e:e.getParentOrThrow())}function P8(e){const t=X9(e);return t!==null&&t.direction==="rtl"}function Q9(e,t){const r=e.getStartEndPoints();if(t.isSelected(e)&&!Uu(t)&&r!==null){const[n,s]=r,a=e.isBackward(),i=n.getNode(),o=s.getNode(),c=t.is(i),u=t.is(o);if(c||u){const[d,f]=ZT(e),g=i.is(o),p=t.is(a?o:i),x=t.is(a?i:o);let v,w=0;g?(w=d>f?f:d,v=d>f?d:f):p?(w=a?f:d,v=void 0):x&&(w=0,v=a?d:f),t.__text=t.__text.slice(w,v)}}return t}function qre(e){const t=e.getStyle(),r=q9(t);oE.set(t,r)}function Yre(e,t){const r=e.getFormatType(),n=e.getIndent();r!==t.getFormatType()&&t.setFormat(r),n!==t.getIndent()&&t.setIndent(n)}function um(e,t,r=Yre){if(e===null)return;const n=e.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,o]=n;a=Xb(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(o.key,o.offset,o.type);const c=xk(i.getNode(),Cl),u=xk(o.getNode(),Cl);_t(c)&&s.set(c.getKey(),c),_t(u)&&s.set(u.getKey(),u)}for(const i of e.getNodes())if(_t(i)&&Cl(i))s.set(i.getKey(),i);else if(n===null){const o=xk(i,Cl);_t(o)&&s.set(o.getKey(),o)}for(const[i,o]of s){const c=t();r(o,c),o.replace(c,!0),a&&(i===a.anchor.key&&a.anchor.set(c.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(c.getKey(),a.focus.offset,a.focus.type))}a&&e.is(tr())&&vi(a)}function J9(e){const t=Z9(e);return t!==null&&t.writingMode==="vertical-rl"}function Z9(e){const t=e.anchor.getNode();return _t(t)?Y9(t):X9(t)}function F8(e,t){let r=J9(e)?!t:t;eB(e)&&(r=!r);const n=id(e.focus,r?"previous":"next");if(W9(n))return!1;for(const s of H4(n)){if(tu(s))return!s.origin.isInline();if(!_t(s.origin)){if(_n(s.origin))return!0;break}}return!1}function Xre(e,t,r,n){e.modify(t?"extend":"move",r,n)}function eB(e){const t=Z9(e);return t!==null&&t.direction==="rtl"}function O8(e,t,r){const n=eB(e);let s;s=J9(e)||n?!r:r,Xre(e,t,s,"character")}function xk(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function Qre(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const tB=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Jre=tB&&"documentMode"in document?document.documentMode:null;!(!tB||!("InputEvent"in window)||Jre)&&"getTargetRanges"in new window.InputEvent("input");function rB(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}function A0(...e){return()=>{for(let t=e.length-1;t>=0;t--)e[t]();e.length=0}}function Ca(e,...t){const r=rB(...t);r.length>0&&e.classList.add(...r)}function Sf(e,...t){const r=rB(...t);r.length>0&&e.classList.remove(...r)}function Zre(e){return e?e.getAdjacentCaret():null}function ene(e,t){let r=e;for(;r!=null;){if(r instanceof t)return r;r=r.getParent()}return null}function tne(e){const t=n2(e,(r=>_t(r)&&!r.isInline()));return _t(t)||Qre(4,e.__key),t}const n2=(e,t)=>{let r=e;for(;r!==ys()&&r!=null;){if(t(r))return r;r=r.getParent()}return null};function Rh(e,t){return e!==null&&Object.getPrototypeOf(e).constructor.name===t.name}function nB(e,t){const r=[],n=Array.from(e).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(t(s))r.push(s);else if(_t(s))for(const a of rne(s))n.push(a);return r}function rne(e){return nne(Fl(e,"previous"))}function nne(e){return G4({hasNext:f0,initial:e.getAdjacentCaret(),map:t=>t.origin.getLatest(),step:t=>t.getAdjacentCaret()})}function sne(e){const t=window.location.origin,r=n=>{if(n.origin!==t)return;const s=e.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const o=i.payload;if(o&&o.functionId==="makeChanges"){const c=o.args;if(c){const[u,d,f,g,p,x]=c;e.update((()=>{const v=tr();if(Mt(v)){const w=v.anchor;let C=w.getNode(),k=0,_=0;if(rr(C)&&u>=0&&d>=0&&(k=u,_=u+d,v.setTextNodeRange(C,k,C,_)),k===_&&f===""||(v.insertRawText(f),C=w.getNode()),rr(C)){k=g,_=g+p;const N=C.getTextContentSize();k=k>N?N:k,_=_>N?N:_,v.setTextNodeRange(C,k,C,_)}n.stopImmediatePropagation()}}))}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function ane(e,t){const r=t.body?t.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!aB.has(i.nodeName)){const o=iB(i,e,s,!1);o!==null&&(n=n.concat(o))}}return(function(a){for(const i of a)i.getNextSibling()instanceof T4&&i.insertAfter(nu());for(const i of a){const o=i.getChildren();for(const c of o)i.insertBefore(c);i.remove()}})(s),n}function ine(e,t){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=ys().getChildren();for(let s=0;s<n.length;s++)sB(e,n[s],r,t);return r.innerHTML}function sB(e,t,r,n=null){let s=n===null||t.isSelected(n);const a=_t(t)&&t.excludeFromCopy("html");let i=t;if(n!==null){let p=M4(t);p=rr(p)&&n!==null?Q9(n,p):p,i=p}const o=_t(i)?i.getChildren():[],c=A4(e,i.getType());let u;u=c&&c.exportDOM!==void 0?c.exportDOM(e,i):i.exportDOM(e);const{element:d,after:f}=u;if(!d)return!1;const g=document.createDocumentFragment();for(let p=0;p<o.length;p++){const x=o[p],v=sB(e,x,g,n);!s&&_t(t)&&v&&t.extractWithChild(x,n,"html")&&(s=!0)}if(s&&!a){if((os(d)||aE(d))&&d.append(g),r.append(d),f){const p=f.call(i,d);p&&(aE(d)?d.replaceChildren(p):d.replaceWith(p))}}else r.append(g);return s}const aB=new Set(["STYLE","SCRIPT"]);function iB(e,t,r,n,s=new Map,a){let i=[];if(aB.has(e.nodeName))return i;let o=null;const c=(function(x,v){const{nodeName:w}=x,C=v._htmlConversions.get(w.toLowerCase());let k=null;if(C!==void 0)for(const _ of C){const N=_(x);N!==null&&(k===null||(k.priority||0)<=(N.priority||0))&&(k=N)}return k!==null?k.conversion:null})(e,t),u=c?c(e):null;let d=null;if(u!==null){d=u.after;const x=u.node;if(o=Array.isArray(x)?x[x.length-1]:x,o!==null){for(const[,v]of s)if(o=v(o,a),!o)break;o&&i.push(...Array.isArray(x)?x:[o])}u.forChild!=null&&s.set(e.nodeName,u.forChild)}const f=e.childNodes;let g=[];const p=(o==null||!io(o))&&(o!=null&&eE(o)||n);for(let x=0;x<f.length;x++)g.push(...iB(f[x],t,r,p,new Map(s),o));return d!=null&&(g=d(g)),R_(e)&&(g=one(e,g,p?()=>{const x=new T4;return r.push(x),x}:is)),o==null?g.length>0?i=i.concat(g):R_(e)&&(function(x){return x.nextSibling==null||x.previousSibling==null?!1:iE(x.nextSibling)&&iE(x.previousSibling)})(e)&&(i=i.concat(nu())):_t(o)&&o.append(...g),i}function one(e,t,r){const n=e.style.textAlign,s=[];let a=[];for(let i=0;i<t.length;i++){const o=t[i];if(eE(o))n&&!o.getFormat()&&o.setFormat(n),s.push(o);else if(a.push(o),i===t.length-1||i<t.length-1&&eE(t[i+1])){const c=r();c.setFormat(n),c.append(...a),s.push(c),a=[]}}return s}function M_(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function lne(e,t=tr()){return t==null&&M_(166),Mt(t)&&t.isCollapsed()||t.getNodes().length===0?"":ine(e,t)}function cne(e,t=tr()){return t==null&&M_(166),Mt(t)&&t.isCollapsed()||t.getNodes().length===0?null:JSON.stringify(une(e,t))}function D8(e,t,r){const n=e.getData("application/x-lexical-editor");if(n)try{const o=JSON.parse(n);if(o.namespace===r._config.namespace&&Array.isArray(o.nodes))return I8(r,dne(o.nodes),t)}catch{}const s=e.getData("text/html"),a=e.getData("text/plain");if(s&&a!==s)try{const o=new DOMParser().parseFromString((function(c){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:u=>u}).createHTML(c):c})(s),"text/html");return I8(r,ane(r,o),t)}catch{}const i=a||e.getData("text/uri-list");if(i!=null)if(Mt(t)){const o=i.split(/(\r?\n|\t)/);o[o.length-1]===""&&o.pop();for(let c=0;c<o.length;c++){const u=tr();if(Mt(u)){const d=o[c];d===`
`||d===`\r
`?u.insertParagraph():d==="	"?u.insertNodes([Hm()]):u.insertText(d)}}}else t.insertRawText(i)}function I8(e,t,r){e.dispatchCommand(Ite,{nodes:t,selection:r})||(r.insertNodes(t),(function(n){if(Mt(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=id(s,"previous");if(i)if(_f(i))a=i.origin;else{const o=Af(i,Fl(ys(),"next").getFlipped());for(const c of o){if(rr(c.origin)){a=c.origin;break}if(_t(c.origin)&&!c.origin.isInline())break}}if(a&&rr(a)){const o=a.getFormat(),c=a.getStyle();n.format===o&&n.style===c||(n.format=o,n.style=c,n.dirty=!0)}}})(r))}function oB(e,t,r,n=[]){let s=t===null||r.isSelected(t);const a=_t(r)&&r.excludeFromCopy("html");let i=r;if(t!==null){let u=M4(r);u=rr(u)&&t!==null?Q9(t,u):u,i=u}const o=_t(i)?i.getChildren():[],c=(function(u){const d=u.exportJSON(),f=u.constructor;if(d.type!==f.getType()&&M_(58,f.name),_t(u)){const g=d.children;Array.isArray(g)||M_(59,f.name)}return d})(i);if(rr(i)){const u=i.__text;u.length>0?c.text=u:s=!1}for(let u=0;u<o.length;u++){const d=o[u],f=oB(e,t,d,c.children);!s&&_t(r)&&f&&r.extractWithChild(d,t,"clone")&&(s=!0)}if(s&&!a)n.push(c);else if(Array.isArray(c.children))for(let u=0;u<c.children.length;u++){const d=c.children[u];n.push(d)}return s}function une(e,t){const r=[],n=ys().getChildren();for(let s=0;s<n.length;s++)oB(e,t,n[s],r);return{namespace:e._config.namespace,nodes:r}}function dne(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],s=ire(n);rr(s)&&qre(s),t.push(s)}return t}let Ig=null;async function R8(e,t,r){if(Ig!==null)return!1;if(t!==null)return new Promise(((u,d)=>{e.update((()=>{u(M8(e,t,r))}))}));const n=e.getRootElement(),s=e._window||window,a=window.document,i=pc(s);if(n===null||i===null)return!1;const o=a.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(a.createTextNode("#")),n.append(o);const c=new Range;return c.setStart(o,0),c.setEnd(o,1),i.removeAllRanges(),i.addRange(c),new Promise(((u,d)=>{const f=e.registerCommand(Kb,(g=>(Rh(g,ClipboardEvent)&&(f(),Ig!==null&&(window.clearTimeout(Ig),Ig=null),u(M8(e,g,r))),!0)),fre);Ig=window.setTimeout((()=>{f(),Ig=null,u(!1)}),50),a.execCommand("copy"),o.remove()}))}function M8(e,t,r){if(r===void 0){const s=pc(e._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!Lv(e,a,i))return!1;const o=tr();if(o===null)return!1;r=hne(o)}t.preventDefault();const n=t.clipboardData;return n!==null&&(gne(n,r),!0)}const fne=[["text/html",lne],["application/x-lexical-editor",cne]];function hne(e=tr()){const t={"text/plain":e?e.getTextContent():""};if(e){const r=$v();for(const[n,s]of fne){const a=s(r,e);a!==null&&(t[n]=a)}}return t}function gne(e,t){for(const r in t){const n=t[r];n!==void 0&&e.setData(r,n)}}function L8(e,t){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(e,t);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(e,t);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const qm=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,mne=qm&&"documentMode"in document?document.documentMode:null,pne=!(!qm||!("InputEvent"in window)||mne)&&"getTargetRanges"in new window.InputEvent("input"),xne=qm&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),B8=qm&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,yne=qm&&/^(?=.*Chrome).*/i.test(navigator.userAgent),vne=qm&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!yne,$8=Ir("DRAG_DROP_PASTE_FILE");let Uv=class lB extends $i{static getType(){return"quote"}static clone(t){return new lB(t.__key)}createDOM(t){const r=document.createElement("blockquote");return Ca(r,t.theme.quote),r}updateDOM(t,r){return!1}static importDOM(){return{blockquote:t=>({conversion:wne,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(os(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return zv().updateFromJSON(t)}insertNewAfter(t,r){const n=is(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const t=is();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}canMergeWhenEmpty(){return!0}};function zv(){return co(new Uv)}function U8(e){return e instanceof Uv}let Wv=class cB extends $i{static getType(){return"heading"}static clone(t){return new cB(t.__tag,t.__key)}constructor(t,r){super(r),this.__tag=t}getTag(){return this.__tag}setTag(t){const r=this.getWritable();return this.__tag=t,r}createDOM(t){const r=this.__tag,n=document.createElement(r),s=t.theme.heading;if(s!==void 0){const a=s[r];Ca(n,a)}return n}updateDOM(t,r,n){return t.__tag!==this.__tag}static importDOM(){return{h1:t=>({conversion:Rg,priority:0}),h2:t=>({conversion:Rg,priority:0}),h3:t=>({conversion:Rg,priority:0}),h4:t=>({conversion:Rg,priority:0}),h5:t=>({conversion:Rg,priority:0}),h6:t=>({conversion:Rg,priority:0}),p:t=>{const r=t.firstChild;return r!==null&&z8(r)?{conversion:()=>({node:null}),priority:3}:null},span:t=>z8(t)?{conversion:r=>({node:pf("h1")}),priority:3}:null}}exportDOM(t){const{element:r}=super.exportDOM(t);if(os(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return pf(t.tag).updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTag(t.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(t,r=!0){const n=t?t.anchor.offset:0,s=this.getLastDescendant(),a=!s||t&&t.anchor.key===s.getKey()&&n===s.getTextContentSize()||!t?is():pf(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&t){const o=is();o.select(),this.replace(o,!0)}return a}collapseAtStart(){const t=this.isEmpty()?is():pf(this.getTag());return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}extractWithChild(){return!0}};function z8(e){return e.nodeName.toLowerCase()==="span"&&e.style.fontSize==="26pt"}function Rg(e){const t=e.nodeName.toLowerCase();let r=null;return t!=="h1"&&t!=="h2"&&t!=="h3"&&t!=="h4"&&t!=="h5"&&t!=="h6"||(r=pf(t),e.style!==null&&(L4(e,r),r.setFormat(e.style.textAlign))),{node:r}}function wne(e){const t=zv();return e.style!==null&&(t.setFormat(e.style.textAlign),L4(e,t)),{node:t}}function pf(e="h1"){return co(new Wv(e))}function _ne(e){return e instanceof Wv}function Cw(e){let t=null;if(Rh(e,DragEvent)?t=e.dataTransfer:Rh(e,ClipboardEvent)&&(t=e.clipboardData),t===null)return[!1,[],!1];const r=t.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(t.files),s]}function W8(e){const t=tr();if(!Mt(t))return!1;const r=new Set,n=t.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const o=n2(a,(u=>_t(u)&&!u.isInline()));if(o===null)continue;const c=o.getKey();o.canIndent()&&!r.has(c)&&(r.add(c),e(o))}return r.size>0}function H8(e){const t=Nf(e);return _n(t)}function yk(e){for(const t of["lowercase","uppercase","capitalize"])e.hasFormat(t)&&e.toggleFormat(t)}function bne(e){return A0(e.registerCommand(m4,(t=>{const r=tr();return!!Ai(r)&&(r.clear(),!0)}),gn),e.registerCommand(Gh,(t=>{const r=tr();return Mt(r)?(r.deleteCharacter(t),!0):!!Ai(r)&&(r.deleteNodes(),!0)}),gn),e.registerCommand(Qy,(t=>{const r=tr();return!!Mt(r)&&(r.deleteWord(t),!0)}),gn),e.registerCommand(Jy,(t=>{const r=tr();return!!Mt(r)&&(r.deleteLine(t),!0)}),gn),e.registerCommand(om,(t=>{const r=tr();if(typeof t=="string")r!==null&&r.insertText(t);else{if(r===null)return!1;const n=t.dataTransfer;if(n!=null)D8(n,r,e);else if(Mt(r)){const s=t.data;return s&&r.insertText(s),!0}}return!0}),gn),e.registerCommand(VT,(()=>{const t=tr();return!!Mt(t)&&(t.removeText(),!0)}),gn),e.registerCommand(Mi,(t=>{const r=tr();return!!Mt(r)&&(r.formatText(t),!0)}),gn),e.registerCommand(a9,(t=>{const r=tr();if(!Mt(r)&&!Ai(r))return!1;const n=r.getNodes();for(const s of n){const a=n2(s,(i=>_t(i)&&!i.isInline()));a!==null&&a.setFormat(t)}return!0}),gn),e.registerCommand(im,(t=>{const r=tr();return!!Mt(r)&&(r.insertLineBreak(t),!0)}),gn),e.registerCommand(Xy,(()=>{const t=tr();return!!Mt(t)&&(t.insertParagraph(),!0)}),gn),e.registerCommand(Bte,(()=>(nre([Hm()]),!0)),gn),e.registerCommand($te,(()=>W8((t=>{const r=t.getIndent();t.setIndent(r+1)}))),gn),e.registerCommand(KP,(()=>W8((t=>{const r=t.getIndent();r>0&&t.setIndent(Math.max(0,r-1))}))),gn),e.registerCommand(QL,(t=>{const r=tr();if(Ai(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(Mt(r)){const n=rE(r.focus,!0);if(!t.shiftKey&&_n(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),t.preventDefault(),!0}return!1}),gn),e.registerCommand(JL,(t=>{const r=tr();if(Ai(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(Mt(r)){if((function(s){const a=s.focus;return a.key==="root"&&a.offset===ys().getChildrenSize()})(r))return t.preventDefault(),!0;const n=rE(r.focus,!1);if(!t.shiftKey&&_n(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),t.preventDefault(),!0}return!1}),gn),e.registerCommand(XL,(t=>{const r=tr();if(Ai(r)){const n=r.getNodes();if(n.length>0)return t.preventDefault(),P8(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!Mt(r))return!1;if(F8(r,!0)){const n=t.shiftKey;return t.preventDefault(),O8(r,n,!0),!0}return!1}),gn),e.registerCommand(YL,(t=>{const r=tr();if(Ai(r)){const s=r.getNodes();if(s.length>0)return t.preventDefault(),P8(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!Mt(r))return!1;const n=t.shiftKey;return!!F8(r,!1)&&(t.preventDefault(),O8(r,n,!1),!0)}),gn),e.registerCommand(e9,(t=>{if(H8(t.target))return!1;const r=tr();if(Mt(r)){if((function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(Ea(a))return!1;const i=tne(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))})(r))return t.preventDefault(),e.dispatchCommand(KP,void 0);if(B8&&navigator.language==="ko-KR")return!1}else if(!Ai(r))return!1;return t.preventDefault(),e.dispatchCommand(Gh,!0)}),gn),e.registerCommand(r9,(t=>{if(H8(t.target))return!1;const r=tr();return!(!Mt(r)&&!Ai(r))&&(t.preventDefault(),e.dispatchCommand(Gh,!1))}),gn),e.registerCommand(A_,(t=>{const r=tr();if(!Mt(r))return!1;if(yk(r),t!==null){if((B8||xne||vne)&&pne)return!1;if(t.preventDefault(),t.shiftKey)return e.dispatchCommand(im,!1)}return e.dispatchCommand(Xy,void 0)}),gn),e.registerCommand(t9,(()=>{const t=tr();return!!Mt(t)&&(e.blur(),!0)}),gn),e.registerCommand(s9,(t=>{const[,r]=Cw(t);if(r.length>0){const s=L8(t.clientX,t.clientY);if(s!==null){const{offset:a,node:i}=s,o=Nf(i);if(o!==null){const c=Xb();if(rr(o))c.anchor.set(o.getKey(),a,"text"),c.focus.set(o.getKey(),a,"text");else{const d=o.getParentOrThrow().getKey(),f=o.getIndexWithinParent()+1;c.anchor.set(d,f,"element"),c.focus.set(d,f,"element")}const u=k_(c);vi(u)}e.dispatchCommand($8,r)}return t.preventDefault(),!0}const n=tr();return!!Mt(n)}),gn),e.registerCommand(i9,(t=>{const[r]=Cw(t),n=tr();return!(r&&!Mt(n))}),gn),e.registerCommand(o9,(t=>{const[r]=Cw(t),n=tr();if(r&&!Mt(n))return!1;const s=L8(t.clientX,t.clientY);if(s!==null){const a=Nf(s.node);_n(a)&&t.preventDefault()}return!0}),gn),e.registerCommand(KT,(()=>(vre(),!0)),gn),e.registerCommand(Kb,(t=>(R8(e,Rh(t,ClipboardEvent)?t:null),!0)),gn),e.registerCommand(v4,(t=>((async function(r,n){await R8(n,Rh(r,ClipboardEvent)?r:null),n.update((()=>{const s=tr();Mt(s)?s.removeText():Ai(s)&&s.getNodes().forEach((a=>a.remove()))}))})(t,e),!0)),gn),e.registerCommand(p4,(t=>{const[,r,n]=Cw(t);return r.length>0&&!n?(e.dispatchCommand($8,r),!0):Vm(t.target)&&j4(t.target)?!1:tr()!==null&&((function(s,a){s.preventDefault(),a.update((()=>{const i=tr(),o=Rh(s,InputEvent)||Rh(s,KeyboardEvent)?null:s.clipboardData;o!=null&&i!==null&&D8(o,i,a)}),{tag:lre})})(t,e),!0)}),gn),e.registerCommand(ZL,(t=>{const r=tr();return Mt(r)&&yk(r),!1}),gn),e.registerCommand(n9,(t=>{const r=tr();return Mt(r)&&yk(r),!1}),gn))}const lE=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function G8(e){return e.getEditorState().read(K9(e.isComposing()))}function uB({contentEditable:e,placeholder:t=null,ErrorBoundary:r}){const[n]=ou(),s=(function(a,i){const[o,c]=S.useState((()=>a.getDecorators()));return lE((()=>a.registerDecoratorListener((u=>{dT.flushSync((()=>{c(u)}))}))),[a]),S.useEffect((()=>{c(a.getDecorators())}),[a]),S.useMemo((()=>{const u=[],d=Object.keys(o);for(let f=0;f<d.length;f++){const g=d[f],p=l.jsx(i,{onError:v=>a._onError(v),children:l.jsx(S.Suspense,{fallback:null,children:o[g]})}),x=a.getElementByKey(g);x!==null&&u.push(dT.createPortal(p,x,g))}return u}),[i,o,a])})(n,r);return(function(a){lE((()=>A0(bne(a),sne(a))),[a])})(n),l.jsxs(l.Fragment,{children:[e,l.jsx(Sne,{content:t}),s]})}function Sne({content:e}){const[t]=ou(),r=(function(s){const[a,i]=S.useState((()=>G8(s)));return lE((()=>{function o(){const c=G8(s);i(c)}return o(),A0(s.registerUpdateListener((()=>{o()})),s.registerEditableListener((()=>{o()})))}),[s]),a})(t),n=Hre();return r?typeof e=="function"?e(n):e:null}const dB=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function kne({editor:e,ariaActiveDescendant:t,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:o,ariaLabel:c,ariaLabelledBy:u,ariaMultiline:d,ariaOwns:f,ariaRequired:g,autoCapitalize:p,className:x,id:v,role:w="textbox",spellCheck:C=!0,style:k,tabIndex:_,"data-testid":N,...E},P){const[F,A]=S.useState(e.isEditable()),j=S.useCallback((B=>{B&&B.ownerDocument&&B.ownerDocument.defaultView?e.setRootElement(B):e.setRootElement(null)}),[e]),I=S.useMemo((()=>(function(...B){return Y=>{B.forEach((Z=>{typeof Z=="function"?Z(Y):Z!=null&&(Z.current=Y)}))}})(P,j)),[j,P]);return dB((()=>(A(e.isEditable()),e.registerEditableListener((B=>{A(B)})))),[e]),l.jsx("div",{"aria-activedescendant":F?t:void 0,"aria-autocomplete":F?r:"none","aria-controls":F?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":F&&w==="combobox"?!!i:void 0,...o!=null?{"aria-invalid":o}:{},"aria-label":c,"aria-labelledby":u,"aria-multiline":d,"aria-owns":F?f:void 0,"aria-readonly":!F||void 0,"aria-required":g,autoCapitalize:p,className:x,contentEditable:F,"data-testid":N,id:v,ref:I,role:w,spellCheck:C,style:k,tabIndex:_,...E})}const Cne=S.forwardRef(kne);function V8(e){return e.getEditorState().read(K9(e.isComposing()))}const fB=S.forwardRef(Tne);function Tne(e,t){const{placeholder:r,...n}=e,[s]=ou();return l.jsxs(l.Fragment,{children:[l.jsx(Cne,{editor:s,...n,ref:t}),r!=null&&l.jsx(Ene,{editor:s,content:r})]})}function Ene({content:e,editor:t}){const r=(function(i){const[o,c]=S.useState((()=>V8(i)));return dB((()=>{function u(){const d=V8(i);c(d)}return u(),A0(i.registerUpdateListener((()=>{u()})),i.registerEditableListener((()=>{u()})))}),[i]),o})(t),[n,s]=S.useState(t.isEditable());if(S.useLayoutEffect((()=>(s(t.isEditable()),t.registerEditableListener((i=>{s(i)})))),[t]),!r)return null;let a=null;return typeof e=="function"?a=e(n):e!==null&&(a=e),a===null?null:l.jsx("div",{"aria-hidden":!0,children:a})}const Tw=0,cE=1,uE=2,ic=0,Nne=1,K8=2,Ane=3,jne=4;function Pne(e,t,r,n,s){if(e===null||r.size===0&&n.size===0&&!s)return ic;const a=t._selection,i=e._selection;if(s)return Nne;if(!(Mt(a)&&Mt(i)&&i.isCollapsed()&&a.isCollapsed()))return ic;const o=(function(C,k,_){const N=C._nodeMap,E=[];for(const P of k){const F=N.get(P);F!==void 0&&E.push(F)}for(const[P,F]of _){if(!F)continue;const A=N.get(P);A===void 0||Ea(A)||E.push(A)}return E})(t,r,n);if(o.length===0)return ic;if(o.length>1){const C=t._nodeMap,k=C.get(a.anchor.key),_=C.get(i.anchor.key);return k&&_&&!e._nodeMap.has(k.__key)&&rr(k)&&k.__text.length===1&&a.anchor.offset===1?K8:ic}const c=o[0],u=e._nodeMap.get(c.__key);if(!rr(u)||!rr(c)||u.__mode!==c.__mode)return ic;const d=u.__text,f=c.__text;if(d===f)return ic;const g=a.anchor,p=i.anchor;if(g.key!==p.key||g.type!=="text")return ic;const x=g.offset,v=p.offset,w=f.length-d.length;return w===1&&v===x-1?K8:w===-1&&v===x+1?Ane:w===-1&&v===x?jne:ic}function Fne(e,t){let r=Date.now(),n=ic;return(s,a,i,o,c,u)=>{const d=Date.now();if(u.has(O_))return n=ic,r=d,uE;const f=Pne(s,a,o,c,e.isComposing()),g=(()=>{const p=i===null||i.editor===e,x=u.has(ore);if(!x&&p&&u.has(Ty))return Tw;if(s===null)return cE;const v=a._selection;return o.size>0||c.size>0?x===!1&&f!==ic&&f===n&&d<r+t&&p||o.size===1&&(function(w,C,k){const _=C._nodeMap.get(w),N=k._nodeMap.get(w),E=C._selection,P=k._selection;return!(Mt(E)&&Mt(P)&&E.anchor.type==="element"&&E.focus.type==="element"&&P.anchor.type==="text"&&P.focus.type==="text"||!rr(_)||!rr(N)||_.__parent!==N.__parent)&&JSON.stringify(C.read((()=>_.exportJSON())))===JSON.stringify(k.read((()=>N.exportJSON())))})(Array.from(o)[0],s,a)?Tw:cE:v!==null?Tw:uE})();return r=d,n=f,g}}function q8(e){e.undoStack=[],e.redoStack=[],e.current=null}function One(e,t,r){const n=Fne(e,r);return A0(e.registerCommand(x4,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(c.length!==0){const u=i.current,d=c.pop();u!==null&&(o.push(u),a.dispatchCommand(xw,!0)),c.length===0&&a.dispatchCommand(yw,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:O_})}})(e,t),!0)),gn),e.registerCommand(y4,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(o.length!==0){const u=i.current;u!==null&&(c.push(u),a.dispatchCommand(yw,!0));const d=o.pop();o.length===0&&a.dispatchCommand(xw,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:O_})}})(e,t),!0)),gn),e.registerCommand(zte,(()=>(q8(t),!1)),gn),e.registerCommand(Wte,(()=>(q8(t),e.dispatchCommand(xw,!1),e.dispatchCommand(yw,!1),!0)),gn),e.registerUpdateListener((({editorState:a,prevEditorState:i,dirtyLeaves:o,dirtyElements:c,tags:u})=>{const d=t.current,f=t.redoStack,g=t.undoStack,p=d===null?null:d.editorState;if(d!==null&&a===p)return;const x=n(i,a,d,o,c,u);if(x===cE)f.length!==0&&(t.redoStack=[],e.dispatchCommand(xw,!1)),d!==null&&(g.push({...d}),e.dispatchCommand(yw,!0));else if(x===uE)return;t.current={editor:e,editorState:a}})))}function Dne(){return{current:null,redoStack:[],undoStack:[]}}function hB({delay:e,externalHistoryState:t}){const[r]=ou();return(function(n,s,a=1e3){const i=S.useMemo((()=>s||Dne()),[s]);S.useEffect((()=>One(n,i,a)),[a,n,i])})(r,t,e),null}function gB({defaultSelection:e}){const[t]=ou();return S.useEffect((()=>{t.focus((()=>{const r=document.activeElement,n=t.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})}),{defaultSelection:e})}),[e,t]),null}function dE(e,t){return dE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},dE(e,t)}var Y8={error:null},Ine=(function(e){var t,r;function n(){for(var a,i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return(a=e.call.apply(e,[this].concat(o))||this).state=Y8,a.resetErrorBoundary=function(){for(var u,d=arguments.length,f=new Array(d),g=0;g<d;g++)f[g]=arguments[g];a.props.onReset==null||(u=a.props).onReset.apply(u,f),a.reset()},a}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,dE(t,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(Y8)},s.componentDidCatch=function(a,i){var o,c;(o=(c=this.props).onError)==null||o.call(c,a,i)},s.componentDidUpdate=function(a,i){var o,c,u,d,f=this.state.error,g=this.props.resetKeys;f!==null&&i.error!==null&&((u=a.resetKeys)===void 0&&(u=[]),(d=g)===void 0&&(d=[]),u.length!==d.length||u.some((function(p,x){return!Object.is(p,d[x])})))&&((o=(c=this.props).onResetKeysChange)==null||o.call(c,a.resetKeys,g),this.reset())},s.render=function(){var a=this.state.error,i=this.props,o=i.fallbackRender,c=i.FallbackComponent,u=i.fallback;if(a!==null){var d={error:a,resetErrorBoundary:this.resetErrorBoundary};if(S.isValidElement(u))return u;if(typeof o=="function")return o(d);if(c)return S.createElement(c,d);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n})(S.Component);function mB({children:e,onError:t}){return l.jsx(Ine,{fallback:l.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:t,children:e})}const K4=/^(\d+(?:\.\d+)?)px$/,dm={BOTH:3,NO_STATUS:0,ROW:1};class Ym extends $i{static getType(){return"tablecell"}static clone(t){return new Ym(t.__headerState,t.__colSpan,t.__width,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__rowSpan=t.__rowSpan,this.__backgroundColor=t.__backgroundColor,this.__verticalAlign=t.__verticalAlign}static importDOM(){return{td:t=>({conversion:X8,priority:0}),th:t=>({conversion:X8,priority:0})}}static importJSON(t){return pB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeaderStyles(t.headerState).setColSpan(t.colSpan||1).setRowSpan(t.rowSpan||1).setWidth(t.width||void 0).setBackgroundColor(t.backgroundColor||null).setVerticalAlign(t.verticalAlign||void 0)}constructor(t=dm.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=t,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(t){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),fE(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),Ca(r,t.theme.tableCell,this.hasHeader()&&t.theme.tableCellHeader),r}exportDOM(t){const r=super.exportDOM(t);if(os(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...fE(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(t){const r=this.getWritable();return r.__colSpan=t,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(t){const r=this.getWritable();return r.__rowSpan=t,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(t,r=dm.BOTH){const n=this.getWritable();return n.__headerState=t&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(t){const r=this.getWritable();return r.__width=t,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(t){const r=this.getWritable();return r.__backgroundColor=t,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(t){const r=this.getWritable();return r.__verticalAlign=t||void 0,r}toggleHeaderStyle(t){const r=this.getWritable();return(r.__headerState&t)===t?r.__headerState-=t:r.__headerState+=t,r}hasHeaderState(t){return(this.getHeaderStyles()&t)===t}hasHeader(){return this.getLatest().__headerState!==dm.NO_STATUS}updateDOM(t){return t.__headerState!==this.__headerState||t.__width!==this.__width||t.__colSpan!==this.__colSpan||t.__rowSpan!==this.__rowSpan||t.__backgroundColor!==this.__backgroundColor||t.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function fE(e){return e==="middle"||e==="bottom"}function X8(e){const t=e,r=e.nodeName.toLowerCase();let n;K4.test(t.style.width)&&(n=parseFloat(t.style.width));const s=pB(r==="th"?dm.ROW:dm.NO_STATUS,t.colSpan,n);s.__rowSpan=t.rowSpan;const a=t.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=t.style.verticalAlign;fE(i)&&(s.__verticalAlign=i);const o=t.style,c=(o&&o.textDecoration||"").split(" "),u=o.fontWeight==="700"||o.fontWeight==="bold",d=c.includes("line-through"),f=o.fontStyle==="italic",g=c.includes("underline");return{after:p=>{const x=[];let v=null;const w=()=>{if(v){const C=v.getFirstChild();Qu(C)&&v.getChildrenSize()===1&&C.remove()}};for(const C of p)bre(C)||rr(C)||Qu(C)?(rr(C)&&(u&&C.toggleFormat("bold"),d&&C.toggleFormat("strikethrough"),f&&C.toggleFormat("italic"),g&&C.toggleFormat("underline")),v?v.append(C):(v=is().append(C),x.push(v))):(x.push(C),w(),v=null);return w(),x.length===0&&x.push(is()),x},node:s}}function pB(e=dm.NO_STATUS,t=1,r){return co(new Ym(e,t,r))}function ev(e){return e instanceof Ym}function hE(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class Xm extends $i{static getType(){return"tablerow"}static clone(t){return new Xm(t.__height,t.__key)}static importDOM(){return{tr:t=>({conversion:Rne,priority:0})}}static importJSON(t){return xB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeight(t.height)}constructor(t,r){super(r),this.__height=t}exportJSON(){const t=this.getHeight();return{...super.exportJSON(),...t===void 0?void 0:{height:t}}}createDOM(t){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),Ca(r,t.theme.tableRow),r}extractWithChild(t,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(t){const r=this.getWritable();return r.__height=t,r}getHeight(){return this.getLatest().__height}updateDOM(t){return t.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function Rne(e){const t=e;let r;return K4.test(t.style.height)&&(r=parseFloat(t.style.height)),{after:n=>nB(n,ev),node:xB(r)}}function xB(e){return co(new Xm(e))}function yB(e){return e instanceof Xm}const vB=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Mne=vB&&"documentMode"in document?document.documentMode:null;vB&&"InputEvent"in window&&!Mne&&new window.InputEvent("input");function Lne(e,t,r){const n=[];let s=null,a=null;function i(c){let u=n[c];return u===void 0&&(n[c]=u=[]),u}const o=e.getChildren();for(let c=0;c<o.length;c++){const u=o[c];yB(u)||hE(209);const d=i(c);for(let f=u.getFirstChild(),g=0;f!=null;f=f.getNextSibling()){for(ev(f)||hE(147);d[g]!==void 0;)g++;const p={cell:f,startColumn:g,startRow:c},{__rowSpan:x,__colSpan:v}=f;for(let w=0;w<x&&!(c+w>=o.length);w++){const C=i(c+w);for(let k=0;k<v;k++)C[g+k]=p}}}return[n,s,a]}function Xx(e){return os(e)&&e.nodeName==="TABLE"}function Bne(e,t){for(let r=t,n=null;r!==null;r=r.getParent()){if(e.is(r))return n;ev(r)&&(n=r)}return null}function $ne(e,t,r){return Bne(e,Nf(t,r))}function Q8(e,t,r){if(!t.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=t.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}Sf(e,...n),Ca(e,...s)}const Une=new WeakSet;function J8(e=$v()){return Une.has(e)}class Hv extends $i{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(t){const r=this.getWritable();return r.__colWidths=t,r}static clone(t){return new Hv(t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__colWidths=t.__colWidths,this.__rowStriping=t.__rowStriping,this.__frozenColumnCount=t.__frozenColumnCount,this.__frozenRowCount=t.__frozenRowCount}static importDOM(){return{table:t=>({conversion:zne,priority:1})}}static importJSON(t){return wB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setRowStriping(t.rowStriping||!1).setFrozenColumns(t.frozenColumnCount||0).setFrozenRows(t.frozenRowCount||0).setColWidths(t.colWidths)}constructor(t){super(t),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(t,r,n){return n==="html"}getDOMSlot(t){const r=Xx(t)?t:t.querySelector("table");return Xx(r)||hE(229),super.getDOMSlot(t).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(t,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),Ere(s),Ca(n,t.theme.table),this.updateTableElement(null,n,t),J8(r)){const a=document.createElement("div"),i=t.theme.tableScrollableWrapper;return i?Ca(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,t),a}return n}updateTableWrapper(t,r,n,s){this.__frozenColumnCount!==(t?t.__frozenColumnCount:0)&&(function(a,i,o,c){c>0?(Ca(a,o.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(Sf(a,o.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))})(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(t?t.__frozenRowCount:0)&&(function(a,i,o,c){c>0?(Ca(a,o.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(Sf(a,o.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))})(r,n,s,this.__frozenRowCount)}updateTableElement(t,r,n){this.__style!==(t?t.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!t&&t.__rowStriping)&&(function(s,a,i){i?(Ca(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(Sf(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))})(r,n,this.__rowStriping),(function(s,a,i,o){const c=s.querySelector("colgroup");if(!c)return;const u=[];for(let d=0;d<i;d++){const f=document.createElement("col"),g=o&&o[d];g&&(f.style.width=`${g}px`),u.push(f)}c.replaceChildren(...u)})(r,0,this.getColumnCount(),this.getColWidths()),Q8(r,n,this.getFormatType())}updateDOM(t,r,n){const s=this.getDOMSlot(r).element;return r===s===J8()||(os(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(t,r,s,n),this.updateTableElement(t,s,n),!1);var a}exportDOM(t){const r=super.exportDOM(t),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!Xx(s)&&os(s)&&(s=s.querySelector("table")),!Xx(s))return null;Q8(s,t._config,this.getFormatType());const[a]=Lne(this),i=new Map;for(const d of a)for(const f of d){const g=f.cell.getKey();i.has(g)||i.set(g,{colSpan:f.cell.getColSpan(),startColumn:f.startColumn})}const o=new Set;for(const d of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const f=d.getAttribute("data-temporary-table-cell-lexical-key");if(f){const g=i.get(f);if(d.removeAttribute("data-temporary-table-cell-lexical-key"),g){i.delete(f);for(let p=0;p<g.colSpan;p++)o.add(p+g.startColumn)}}}const c=s.querySelector(":scope > colgroup");if(c){const d=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter(((f,g)=>o.has(g)));c.replaceChildren(...d)}const u=s.querySelectorAll(":scope > tr");if(u.length>0){const d=document.createElement("tbody");for(const f of u)d.appendChild(f);s.append(d)}return s},element:!Xx(n)&&os(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(t,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let o=0;o<i.length;o++){const c=i[o];if(c==null)continue;const{elem:u}=c,d=$ne(this,u);if(d!==null&&t.is(d))return{x:o,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(t,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[t<a.length?t:a.length-1];return i??null}getDOMCellFromCordsOrThrow(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(s==null)return null;const a=Nf(s.elem);return ev(a)?a:null}getCellNodeFromCordsOrThrow(t,r,n){const s=this.getCellNodeFromCords(t,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(t){const r=this.getWritable();return r.__rowStriping=t,r}setFrozenColumns(t){const r=this.getWritable();return r.__frozenColumnCount=t,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(t){const r=this.getWritable();return r.__frozenRowCount=t,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const t=this.getFirstChild();if(!t)return 0;let r=0;return t.getChildren().forEach((n=>{ev(n)&&(r+=n.getColSpan())})),r}}function zne(e){const t=wB();e.hasAttribute("data-lexical-row-striping")&&t.setRowStriping(!0),e.hasAttribute("data-lexical-frozen-column")&&t.setFrozenColumns(1),e.hasAttribute("data-lexical-frozen-row")&&t.setFrozenRows(1);const r=e.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!K4.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&t.setColWidths(n)}return{after:n=>nB(n,yB),node:t}}function wB(){return co(new Hv)}function xf(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function gE(e){let t=1,r=e.getParent();for(;r!=null;){if(En(r)){const n=r.getParent();if(Yr(n)){t++,r=n.getParent();continue}xf(40)}return t}return t}function mE(e){let t=e.getParent();Yr(t)||xf(40);let r=t;for(;r!==null;)r=r.getParent(),Yr(r)&&(t=r);return t}function _B(e){let t=[];const r=e.getChildren().filter(En);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();Yr(a)?t=t.concat(_B(a)):t.push(s)}return t}function Yc(e){return En(e)&&Yr(e.getFirstChild())}function Z8(e){return Jo().append(e)}function bB(e,t){return En(e)&&(t.length===0||t.length===1&&e.is(t[0])&&e.getChildrenSize()===0)}function eF(e){const t=tr();if(t!==null){let r=t.getNodes();if(Mt(t)){const s=t.getStartEndPoints();s===null&&xf(143);const[a]=s,i=a.getNode(),o=i.getParent();if(io(i)){const c=i.getFirstChild();if(c)r=c.selectStart().getNodes();else{const u=is();i.append(u),r=u.select().getNodes()}}else if(bB(i,r)){const c=No(e);if(io(o)){i.replace(c);const u=Jo();_t(i)&&(u.setFormat(i.getFormatType()),u.setIndent(i.getIndent())),c.append(u)}else if(En(i)){const u=i.getParentOrThrow();m0(c,u.getChildren()),u.replace(c)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(_t(a)&&a.isEmpty()&&!En(a)&&!n.has(a.getKey())){tF(a,e);continue}let i=P9(a)?a.getParent():En(a)&&a.isEmpty()?a:null;for(;i!=null;){const o=i.getKey();if(Yr(i)){if(!n.has(o)){const c=No(e);m0(c,i.getChildren()),i.replace(c),n.add(o)}break}{const c=i.getParent();if(io(c)&&!n.has(o)){n.add(o),tF(i,e);break}i=c}}}}}function m0(e,t){e.splice(e.getChildrenSize(),0,t)}function tF(e,t){if(Yr(e))return e;const r=e.getPreviousSibling(),n=e.getNextSibling(),s=Jo();let a;if(m0(s,e.getChildren()),Yr(r)&&t===r.getListType())r.append(s),Yr(n)&&t===n.getListType()&&(m0(r,n.getChildren()),n.remove()),a=r;else if(Yr(n)&&t===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=No(t);i.append(s),e.replace(i),a=i}return s.setFormat(e.getFormatType()),s.setIndent(e.getIndent()),e.remove(),a}function q4(e,t){const r=e.getLastChild(),n=t.getFirstChild();r&&n&&Yc(r)&&Yc(n)&&(q4(r.getFirstChild(),n.getFirstChild()),n.remove());const s=t.getChildren();s.length>0&&e.append(...s),t.remove()}function Wne(){const e=tr();if(Mt(e)){const t=new Set,r=e.getNodes(),n=e.anchor.getNode();if(bB(n,r))t.add(mE(n));else for(let s=0;s<r.length;s++){const a=r[s];if(P9(a)){const i=ene(a,hd);i!=null&&t.add(mE(i))}}for(const s of t){let a=s;const i=_B(s);for(const o of i){const c=is().setTextStyle(e.style).setTextFormat(e.format);m0(c,o.getChildren()),a.insertAfter(c),a=c,o.__key===e.anchor.key&&g0(e.anchor,Tl(Fl(c,"next"))),o.__key===e.focus.key&&g0(e.focus,Tl(Fl(c,"next"))),o.remove()}s.remove()}}}function SB(e){const t=e.getListType()!=="check";let r=e.getStart();for(const n of e.getChildren())En(n)&&(n.getValue()!==r&&n.setValue(r),t&&n.getLatest().__checked!=null&&n.setChecked(void 0),Yr(n.getFirstChild())||r++)}function Hne(e){const t=new Set;if(Yc(e)||t.has(e.getKey()))return;const r=e.getParent(),n=e.getNextSibling(),s=e.getPreviousSibling();if(Yc(n)&&Yc(s)){const a=s.getFirstChild();if(Yr(a)){a.append(e);const i=n.getFirstChild();Yr(i)&&(m0(a,i.getChildren()),n.remove(),t.add(n.getKey()))}}else if(Yc(n)){const a=n.getFirstChild();if(Yr(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(e)}}else if(Yc(s)){const a=s.getFirstChild();Yr(a)&&a.append(e)}else if(Yr(r)){const a=Jo().setTextFormat(e.getTextFormat()).setTextStyle(e.getTextStyle()),i=No(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(e),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function Gne(e){if(Yc(e))return;const t=e.getParent(),r=t?t.getParent():void 0;if(Yr(r?r.getParent():void 0)&&En(r)&&Yr(t)){const n=t?t.getFirstChild():void 0,s=t?t.getLastChild():void 0;if(e.is(n))r.insertBefore(e),t.isEmpty()&&r.remove();else if(e.is(s))r.insertAfter(e),t.isEmpty()&&r.remove();else{const a=t.getListType(),i=Jo(),o=No(a);i.append(o),e.getPreviousSiblings().forEach((d=>o.append(d)));const c=Jo(),u=No(a);c.append(u),m0(u,e.getNextSiblings()),r.insertBefore(i),r.insertAfter(c),r.replace(e)}}}function Vne(){const e=tr();if(!Mt(e)||!e.isCollapsed())return!1;const t=e.anchor.getNode();if(!En(t)||t.getChildrenSize()!==0)return!1;const r=mE(t),n=t.getParent();Yr(n)||xf(40);const s=n.getParent();let a;if(io(s))a=is(),r.insertAfter(a);else{if(!En(s))return!1;a=Jo(),s.insertAfter(a)}a.setTextStyle(e.style).setTextFormat(e.format).select();const i=t.getNextSiblings();if(i.length>0){const o=No(n.getListType());if(En(a)){const c=Jo();c.append(o),a.insertAfter(c)}else a.insertAfter(o);o.append(...i)}return(function(o){let c=o;for(;c.getNextSibling()==null&&c.getPreviousSibling()==null;){const u=c.getParent();if(u==null||!En(u)&&!Yr(u))break;c=u}c.remove()})(t),!0}function L_(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}let hd=class extends $i{$config(){return this.config("listitem",{$transform:t=>{if(t.__checked==null)return;const r=t.getParent();Yr(r)&&r.getListType()!=="check"&&t.getChecked()!=null&&t.setChecked(void 0)},extends:$i,importDOM:{li:()=>({conversion:Kne,priority:0})}})}constructor(t=1,r=void 0,n){super(n),this.__value=t===void 0?1:t,this.__checked=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__value=t.__value,this.__checked=t.__checked}createDOM(t){const r=document.createElement("li");return this.updateListItemDOM(null,r,t),r}updateListItemDOM(t,r,n){const s=this.getParent();Yr(s)&&s.getListType()==="check"&&(function(o,c,u,d){Yr(c.getFirstChild())?(o.removeAttribute("role"),o.removeAttribute("tabIndex"),o.removeAttribute("aria-checked")):(o.setAttribute("role","checkbox"),o.setAttribute("tabIndex","-1"),u&&c.__checked===u.__checked||o.setAttribute("aria-checked",c.getChecked()?"true":"false"))})(r,this,t),r.value=this.__value,(function(o,c,u){const d=[],f=[],g=c.list,p=g?g.listitem:void 0;let x;if(g&&g.nested&&(x=g.nested.listitem),p!==void 0&&d.push(...L_(p)),g){const v=u.getParent(),w=Yr(v)&&v.getListType()==="check",C=u.getChecked();w&&!C||f.push(g.listitemUnchecked),w&&C||f.push(g.listitemChecked),w&&d.push(C?g.listitemChecked:g.listitemUnchecked)}if(x!==void 0){const v=L_(x);u.getChildren().some((w=>Yr(w)))?d.push(...v):f.push(...v)}f.length>0&&Sf(o,...f),d.length>0&&Ca(o,...d)})(r,n.theme,this);const a=t?t.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),(function(o,c,u){const d=j8(c.__textStyle);for(const f in d)o.style.setProperty(`--listitem-marker-${f}`,d[f]);if(u)for(const f in j8(u.__textStyle))f in d||o.style.removeProperty(`--listitem-marker-${f}`)})(r,this,t)}updateDOM(t,r,n){const s=r;return this.updateListItemDOM(t,s,n),!1}updateFromJSON(t){return super.updateFromJSON(t).setValue(t.value).setChecked(t.checked)}exportDOM(t){const r=this.createDOM(t._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...t){for(let r=0;r<t.length;r++){const n=t[r];if(_t(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(t,r){if(En(t))return super.replace(t);this.setIndent(0);const n=this.getParentOrThrow();if(!Yr(n))return t;if(n.__first===this.getKey())n.insertBefore(t);else if(n.__last===this.getKey())n.insertAfter(t);else{const s=No(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(t),t.insertAfter(s)}return r&&(_t(t)||xf(139),this.getChildren().forEach((s=>{t.append(s)}))),this.remove(),n.getChildrenSize()===0&&n.remove(),t}insertAfter(t,r=!0){const n=this.getParentOrThrow();if(Yr(n)||xf(39),En(t))return super.insertAfter(t,r);const s=this.getNextSiblings();if(n.insertAfter(t,r),s.length!==0){const a=No(n.getListType());s.forEach((i=>a.append(i))),t.insertAfter(a,r)}return t}remove(t){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(t),r&&n&&Yc(r)&&Yc(n)&&(q4(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(t,r=!0){const n=Jo().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(t){const r=is();this.getChildren().forEach((i=>r.append(i)));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=En(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=t.anchor,o=t.focus,c=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(c,i.offset,"element"),o.type==="element"&&o.getNode().is(this)&&o.set(c,o.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(t){const r=this.getWritable();return r.__value=t,r}getChecked(){const t=this.getLatest();let r;const n=this.getParent();return Yr(n)&&(r=n.getListType()),r==="check"?!!t.__checked:void 0}setChecked(t){const r=this.getWritable();return r.__checked=t,r}toggleChecked(){const t=this.getWritable();return t.setChecked(!t.__checked)}getIndent(){const t=this.getParent();if(t===null||!this.isAttached())return this.getLatest().__indent;let r=t.getParentOrThrow(),n=0;for(;En(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(t){typeof t!="number"&&xf(117),(t=Math.floor(t))>=0||xf(199);let r=this.getIndent();for(;r!==t;)r<t?(Hne(this),r++):(Gne(this),r--);return this}canInsertAfter(t){return En(t)}canReplaceWith(t){return En(t)}canMergeWith(t){return En(t)||E4(t)}extractWithChild(t,r){if(!Mt(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return No("bullet")}canMergeWhenEmpty(){return!0}};function Kne(e){if(e.classList.contains("task-list-item")){for(const r of e.children)if(r.tagName==="INPUT")return qne(r)}const t=e.getAttribute("aria-checked");return{node:Jo(t==="true"||t!=="false"&&void 0)}}function qne(e){return e.getAttribute("type")!=="checkbox"?{node:null}:{node:Jo(e.hasAttribute("checked"))}}function Jo(e){return co(new hd(void 0,e))}function En(e){return e instanceof hd}let $f=class extends $i{$config(){return this.config("list",{$transform:t=>{(function(r){const n=r.getNextSibling();Yr(n)&&r.getListType()===n.getListType()&&q4(r,n)})(t),SB(t)},extends:$i,importDOM:{ol:()=>({conversion:nF,priority:0}),ul:()=>({conversion:nF,priority:0})}})}constructor(t="number",r=1,n){super(n);const s=Xne[t]||t;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__listType=t.__listType,this.__tag=t.__tag,this.__start=t.__start}getTag(){return this.getLatest().__tag}setListType(t){const r=this.getWritable();return r.__listType=t,r.__tag=t==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(t){const r=this.getWritable();return r.__start=t,r}createDOM(t,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,rF(s,t.theme,this),s}updateDOM(t,r,n){return t.__tag!==this.__tag||(rF(r,n.theme,this),!1)}updateFromJSON(t){return super.updateFromJSON(t).setListType(t.listType).setStart(t.start)}exportDOM(t){const r=this.createDOM(t._config,t);return os(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(t,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];En(i)||(s===n&&(s=[...n]),s[a]=Jo().append(!_t(i)||Yr(i)||i.isInline()?i:Ds(i.getTextContent())))}return super.splice(t,r,s)}extractWithChild(t){return En(t)}};function rF(e,t,r){const n=[],s=[],a=t.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],o=gE(r)-1,c=o%i.length,u=i[c],d=a[r.__tag];let f;const g=a.nested,p=a.checklist;if(g!==void 0&&g.list&&(f=g.list),d!==void 0&&n.push(d),p!==void 0&&r.__listType==="check"&&n.push(p),u!==void 0){n.push(...L_(u));for(let x=0;x<i.length;x++)x!==c&&s.push(r.__tag+x)}if(f!==void 0){const x=L_(f);o>1?n.push(...x):s.push(...x)}}s.length>0&&Sf(e,...s),n.length>0&&Ca(e,...n)}function Yne(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];if(En(n)){t.push(n);const s=n.getChildren();s.length>1&&s.forEach((a=>{Yr(a)&&t.push(Z8(a))}))}else t.push(Z8(n))}return t}function nF(e){const t=e.nodeName.toLowerCase();let r=null;return t==="ol"?r=No("number",e.start):t==="ul"&&(r=(function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if(os(s)&&s.hasAttribute("aria-checked"))return!0;return!1})(e)?No("check"):No("bullet")),{after:Yne,node:r}}const Xne={ol:"number",ul:"bullet"};function No(e="number",t=1){return co(new $f(e,t))}function Yr(e){return e instanceof $f}const Qne=Ir("UPDATE_LIST_START_COMMAND"),Y4=Ir("INSERT_UNORDERED_LIST_COMMAND"),X4=Ir("INSERT_ORDERED_LIST_COMMAND"),Q4=Ir("REMOVE_LIST_COMMAND");function Jne(e){return A0(e.registerCommand(X4,(()=>(eF("number"),!0)),Gg),e.registerCommand(Qne,(t=>{const{listNodeKey:r,newStart:n}=t,s=ha(r);return!!Yr(s)&&(s.getListType()==="number"&&(s.setStart(n),SB(s)),!0)}),Gg),e.registerCommand(Y4,(()=>(eF("bullet"),!0)),Gg),e.registerCommand(Q4,(()=>(Wne(),!0)),Gg),e.registerCommand(Xy,(()=>Vne()),Gg),e.registerNodeTransform(hd,(t=>{const r=t.getFirstChild();if(r){if(rr(r)){const n=r.getStyle(),s=r.getFormat();t.getTextStyle()!==n&&t.setTextStyle(n),t.getTextFormat()!==s&&t.setTextFormat(s)}}else{const n=tr();Mt(n)&&(n.style!==t.getTextStyle()||n.format!==t.getTextFormat())&&n.isCollapsed()&&t.is(n.anchor.getNode())&&t.setTextStyle(n.style).setTextFormat(n.format)}})),e.registerNodeTransform(Lf,(t=>{const r=t.getParent();if(En(r)&&t.is(r.getFirstChild())){const n=t.getStyle(),s=t.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}})))}function Zne(e){const t=r=>{const n=r.getParent();if(Yr(r.getFirstChild())||!Yr(n))return;const s=n2(r,(a=>En(a)&&Yr(a.getParent())&&En(a.getPreviousSibling())));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(En(s)){const a=s.getPreviousSibling();if(En(a)){const i=(function(c){let u=c,d=u.getFirstChild();for(;Yr(d);){const f=d.getLastChild();if(!En(f))break;u=f,d=u.getFirstChild()}return u})(a),o=i.getParent();if(Yr(o)){const c=gE(o);c+1<gE(n)&&r.setIndent(c)}}}};return e.registerNodeTransform($f,(r=>{const n=[r];for(;n.length>0;){const s=n.shift();if(Yr(s)){for(const a of s.getChildren())if(En(a)){t(a);const i=a.getFirstChild();Yr(i)&&n.push(i)}}}}))}var vk={exports:{}},sF;function ese(){return sF||(sF=1,(function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=(function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function k(_){return _ instanceof c?new c(_.type,k(_.content),_.alias):Array.isArray(_)?_.map(k):_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(k){return Object.prototype.toString.call(k).slice(8,-1)},objId:function(k){return k.__id||Object.defineProperty(k,"__id",{value:++a}),k.__id},clone:function k(_,N){N=N||{};var E,P;switch(o.util.type(_)){case"Object":if(P=o.util.objId(_),N[P])return N[P];E={},N[P]=E;for(var F in _)_.hasOwnProperty(F)&&(E[F]=k(_[F],N));return E;case"Array":return P=o.util.objId(_),N[P]?N[P]:(E=[],N[P]=E,_.forEach(function(A,j){E[j]=k(A,N)}),E);default:return _}},getLanguage:function(k){for(;k;){var _=s.exec(k.className);if(_)return _[1].toLowerCase();k=k.parentElement}return"none"},setLanguage:function(k,_){k.className=k.className.replace(RegExp(s,"gi"),""),k.classList.add("language-"+_)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(E){var k=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(E.stack)||[])[1];if(k){var _=document.getElementsByTagName("script");for(var N in _)if(_[N].src==k)return _[N]}return null}},isActive:function(k,_,N){for(var E="no-"+_;k;){var P=k.classList;if(P.contains(_))return!0;if(P.contains(E))return!1;k=k.parentElement}return!!N}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(k,_){var N=o.util.clone(o.languages[k]);for(var E in _)N[E]=_[E];return N},insertBefore:function(k,_,N,E){E=E||o.languages;var P=E[k],F={};for(var A in P)if(P.hasOwnProperty(A)){if(A==_)for(var j in N)N.hasOwnProperty(j)&&(F[j]=N[j]);N.hasOwnProperty(A)||(F[A]=P[A])}var I=E[k];return E[k]=F,o.languages.DFS(o.languages,function(B,Y){Y===I&&B!=k&&(this[B]=F)}),F},DFS:function k(_,N,E,P){P=P||{};var F=o.util.objId;for(var A in _)if(_.hasOwnProperty(A)){N.call(_,A,_[A],E||A);var j=_[A],I=o.util.type(j);I==="Object"&&!P[F(j)]?(P[F(j)]=!0,k(j,N,null,P)):I==="Array"&&!P[F(j)]&&(P[F(j)]=!0,k(j,N,A,P))}}},plugins:{},highlightAll:function(k,_){o.highlightAllUnder(document,k,_)},highlightAllUnder:function(k,_,N){var E={callback:N,container:k,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",E),E.elements=Array.prototype.slice.apply(E.container.querySelectorAll(E.selector)),o.hooks.run("before-all-elements-highlight",E);for(var P=0,F;F=E.elements[P++];)o.highlightElement(F,_===!0,E.callback)},highlightElement:function(k,_,N){var E=o.util.getLanguage(k),P=o.languages[E];o.util.setLanguage(k,E);var F=k.parentElement;F&&F.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(F,E);var A=k.textContent,j={element:k,language:E,grammar:P,code:A};function I(Y){j.highlightedCode=Y,o.hooks.run("before-insert",j),j.element.innerHTML=j.highlightedCode,o.hooks.run("after-highlight",j),o.hooks.run("complete",j),N&&N.call(j.element)}if(o.hooks.run("before-sanity-check",j),F=j.element.parentElement,F&&F.nodeName.toLowerCase()==="pre"&&!F.hasAttribute("tabindex")&&F.setAttribute("tabindex","0"),!j.code){o.hooks.run("complete",j),N&&N.call(j.element);return}if(o.hooks.run("before-highlight",j),!j.grammar){I(o.util.encode(j.code));return}if(_&&n.Worker){var B=new Worker(o.filename);B.onmessage=function(Y){I(Y.data)},B.postMessage(JSON.stringify({language:j.language,code:j.code,immediateClose:!0}))}else I(o.highlight(j.code,j.grammar,j.language))},highlight:function(k,_,N){var E={code:k,grammar:_,language:N};if(o.hooks.run("before-tokenize",E),!E.grammar)throw new Error('The language "'+E.language+'" has no grammar.');return E.tokens=o.tokenize(E.code,E.grammar),o.hooks.run("after-tokenize",E),c.stringify(o.util.encode(E.tokens),E.language)},tokenize:function(k,_){var N=_.rest;if(N){for(var E in N)_[E]=N[E];delete _.rest}var P=new f;return g(P,P.head,k),d(k,P,_,P.head,0),x(P)},hooks:{all:{},add:function(k,_){var N=o.hooks.all;N[k]=N[k]||[],N[k].push(_)},run:function(k,_){var N=o.hooks.all[k];if(!(!N||!N.length))for(var E=0,P;P=N[E++];)P(_)}},Token:c};n.Prism=o;function c(k,_,N,E){this.type=k,this.content=_,this.alias=N,this.length=(E||"").length|0}c.stringify=function k(_,N){if(typeof _=="string")return _;if(Array.isArray(_)){var E="";return _.forEach(function(I){E+=k(I,N)}),E}var P={type:_.type,content:k(_.content,N),tag:"span",classes:["token",_.type],attributes:{},language:N},F=_.alias;F&&(Array.isArray(F)?Array.prototype.push.apply(P.classes,F):P.classes.push(F)),o.hooks.run("wrap",P);var A="";for(var j in P.attributes)A+=" "+j+'="'+(P.attributes[j]||"").replace(/"/g,"&quot;")+'"';return"<"+P.tag+' class="'+P.classes.join(" ")+'"'+A+">"+P.content+"</"+P.tag+">"};function u(k,_,N,E){k.lastIndex=_;var P=k.exec(N);if(P&&E&&P[1]){var F=P[1].length;P.index+=F,P[0]=P[0].slice(F)}return P}function d(k,_,N,E,P,F){for(var A in N)if(!(!N.hasOwnProperty(A)||!N[A])){var j=N[A];j=Array.isArray(j)?j:[j];for(var I=0;I<j.length;++I){if(F&&F.cause==A+","+I)return;var B=j[I],Y=B.inside,Z=!!B.lookbehind,se=!!B.greedy,ee=B.alias;if(se&&!B.pattern.global){var te=B.pattern.toString().match(/[imsuy]*$/)[0];B.pattern=RegExp(B.pattern.source,te+"g")}for(var L=B.pattern||B,V=E.next,M=P;V!==_.tail&&!(F&&M>=F.reach);M+=V.value.length,V=V.next){var H=V.value;if(_.length>k.length)return;if(!(H instanceof c)){var W=1,R;if(se){if(R=u(L,M,k,Z),!R||R.index>=k.length)break;var ae=R.index,z=R.index+R[0].length,K=M;for(K+=V.value.length;ae>=K;)V=V.next,K+=V.value.length;if(K-=V.value.length,M=K,V.value instanceof c)continue;for(var Q=V;Q!==_.tail&&(K<z||typeof Q.value=="string");Q=Q.next)W++,K+=Q.value.length;W--,H=k.slice(M,K),R.index-=M}else if(R=u(L,0,H,Z),!R)continue;var ae=R.index,X=R[0],ie=H.slice(0,ae),le=H.slice(ae+X.length),ce=M+H.length;F&&ce>F.reach&&(F.reach=ce);var _e=V.prev;ie&&(_e=g(_,_e,ie),M+=ie.length),p(_,_e,W);var ne=new c(A,Y?o.tokenize(X,Y):X,ee,X);if(V=g(_,_e,ne),le&&g(_,V,le),W>1){var pe={cause:A+","+I,reach:ce};d(k,_,N,V.prev,M,pe),F&&pe.reach>F.reach&&(F.reach=pe.reach)}}}}}}function f(){var k={value:null,prev:null,next:null},_={value:null,prev:k,next:null};k.next=_,this.head=k,this.tail=_,this.length=0}function g(k,_,N){var E=_.next,P={value:N,prev:_,next:E};return _.next=P,E.prev=P,k.length++,P}function p(k,_,N){for(var E=_.next,P=0;P<N&&E!==k.tail;P++)E=E.next;_.next=E,E.prev=_,k.length-=P}function x(k){for(var _=[],N=k.head.next;N!==k.tail;)_.push(N.value),N=N.next;return _}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(k){var _=JSON.parse(k.data),N=_.language,E=_.code,P=_.immediateClose;n.postMessage(o.highlight(E,o.languages[N],N)),P&&n.close()},!1)),o;var v=o.util.currentScript();v&&(o.filename=v.src,v.hasAttribute("data-manual")&&(o.manual=!0));function w(){o.manual||o.highlightAll()}if(!o.manual){var C=document.readyState;C==="loading"||C==="interactive"&&v&&v.defer?document.addEventListener("DOMContentLoaded",w):window.requestAnimationFrame?window.requestAnimationFrame(w):window.setTimeout(w,16)}return o})(t);e.exports&&(e.exports=r),typeof g_<"u"&&(g_.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};o["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var c={};c[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},r.languages.insertBefore("markup","cdata",c)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,(function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))})(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,(function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading",s=function(v,w){return" Error "+v+" while fetching file: "+w},a=" Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",c="loading",u="loaded",d="failed",f="pre[data-src]:not(["+o+'="'+u+'"]):not(['+o+'="'+c+'"])';function g(v,w,C){var k=new XMLHttpRequest;k.open("GET",v,!0),k.onreadystatechange=function(){k.readyState==4&&(k.status<400&&k.responseText?w(k.responseText):k.status>=400?C(s(k.status,k.statusText)):C(a))},k.send(null)}function p(v){var w=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(v||"");if(w){var C=Number(w[1]),k=w[2],_=w[3];return k?_?[C,Number(_)]:[C,void 0]:[C,C]}}r.hooks.add("before-highlightall",function(v){v.selector+=", "+f}),r.hooks.add("before-sanity-check",function(v){var w=v.element;if(w.matches(f)){v.code="",w.setAttribute(o,c);var C=w.appendChild(document.createElement("CODE"));C.textContent=n;var k=w.getAttribute("data-src"),_=v.language;if(_==="none"){var N=(/\.(\w+)$/.exec(k)||[,"none"])[1];_=i[N]||N}r.util.setLanguage(C,_),r.util.setLanguage(w,_);var E=r.plugins.autoloader;E&&E.loadLanguages(_),g(k,function(P){w.setAttribute(o,u);var F=p(w.getAttribute("data-range"));if(F){var A=P.split(/\r\n?|\n/g),j=F[0],I=F[1]==null?A.length:F[1];j<0&&(j+=A.length),j=Math.max(0,Math.min(j-1,A.length)),I<0&&(I+=A.length),I=Math.max(0,Math.min(I,A.length)),P=A.slice(j,I).join(`
`),w.hasAttribute("data-start")||w.setAttribute("data-start",String(j+1))}C.textContent=P,r.highlightElement(C)},function(P){w.setAttribute(o,d),C.textContent=P})}}),r.plugins.fileHighlight={highlight:function(w){for(var C=(w||document).querySelectorAll(f),k=0,_;_=C[k++];)r.highlightElement(_)}};var x=!1;r.fileHighlight=function(){x||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),x=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(vk)),vk.exports}ese();Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(t,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(e,t){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Prism.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(d){return d=d.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+d+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(d){["url","bold","italic","strike","code-snippet"].forEach(function(f){d!==f&&(e.languages.markdown[d].inside.content.inside[f]=e.languages.markdown[f])})}),e.hooks.add("after-tokenize",function(d){if(d.language!=="markdown"&&d.language!=="md")return;function f(g){if(!(!g||typeof g=="string"))for(var p=0,x=g.length;p<x;p++){var v=g[p];if(v.type!=="code"){f(v.content);continue}var w=v.content[1],C=v.content[3];if(w&&C&&w.type==="code-language"&&C.type==="code-block"&&typeof w.content=="string"){var k=w.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");k=(/[a-z][\w-]*/i.exec(k)||[""])[0].toLowerCase();var _="language-"+k;C.alias?typeof C.alias=="string"?C.alias=[C.alias,_]:C.alias.push(_):C.alias=[_]}}}f(d.tokens)}),e.hooks.add("wrap",function(d){if(d.type==="code-block"){for(var f="",g=0,p=d.classes.length;g<p;g++){var x=d.classes[g],v=/language-(.+)/.exec(x);if(v){f=v[1];break}}var w=e.languages[f];if(w)d.content=e.highlight(u(d.content),w,f);else if(f&&f!=="none"&&e.plugins.autoloader){var C="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);d.attributes.id=C,e.plugins.autoloader.loadLanguages(f,function(){var k=document.getElementById(C);k&&(k.innerHTML=e.highlight(k.textContent,e.languages[f],f))})}}});var i=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},c=String.fromCodePoint||String.fromCharCode;function u(d){var f=d.replace(i,"");return f=f.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(g,p){if(p=p.toLowerCase(),p[0]==="#"){var x;return p[1]==="x"?x=parseInt(p.slice(2),16):x=Number(p.slice(1)),c(x)}else{var v=o[p];return v||g}}),f}e.languages.md=e.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var r=e.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(e){var t=e.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};t.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:t},boolean:t.boolean,variable:t.variable}})(Prism);var aF={},iF;function tse(){return iF||(iF=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),aF}tse();var oF={},lF;function rse(){return lF||(lF=1,(function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string})(Prism)),oF}rse();Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(e){e.inside.interpolation.inside=Prism.languages.swift});var cF={},uF;function nse(){return uF||(uF=1,(function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript})(Prism)),cF}nse();var dF={},fF;function sse(){return fF||(fF=1,(function(e){var t=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:t,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:t,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism)),dF}sse();var hF={},gF;function ase(){return gF||(gF=1,(function(e){var t=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return t.source});e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:t,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])})(Prism)),hF}ase();function kB(e,t){for(const r of e.childNodes){if(os(r)&&r.tagName===t)return!0;kB(r,t)}return!1}const uy="data-language",Qx="data-highlight-language",Ew="data-theme";class j0 extends $i{static getType(){return"code"}static clone(t){return new j0(t.__language,t.__key)}constructor(t,r){super(r),this.__language=t||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(t){super.afterCloneFrom(t),this.__language=t.__language,this.__theme=t.__theme,this.__isSyntaxHighlightSupported=t.__isSyntaxHighlightSupported}createDOM(t){const r=document.createElement("code");Ca(r,t.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(uy,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(Qx,n));const s=this.getTheme();s&&r.setAttribute(Ew,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(t,r,n){const s=this.__language,a=t.__language;s?s!==a&&r.setAttribute(uy,s):a&&r.removeAttribute(uy);const i=this.__isSyntaxHighlightSupported;t.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(Qx,s):r.removeAttribute(Qx):i&&s&&r.setAttribute(Qx,s);const o=this.__theme,c=t.__theme;o?o!==c&&r.setAttribute(Ew,o):c&&r.removeAttribute(Ew);const u=this.__style,d=t.__style;return u?u!==d&&r.setAttribute("style",u):d&&r.removeAttribute("style"),!1}exportDOM(t){const r=document.createElement("pre");Ca(r,t._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(uy,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(Qx,n));const s=this.getTheme();s&&r.setAttribute(Ew,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:t=>t.textContent!=null&&(/\r?\n/.test(t.textContent)||kB(t,"BR"))?{conversion:mF,priority:1}:null,div:()=>({conversion:ise,priority:1}),pre:()=>({conversion:mF,priority:0}),table:t=>wk(t)?{conversion:ose,priority:3}:null,td:t=>{const r=t,n=r.closest("table");return r.classList.contains("js-file-line")||n&&wk(n)?{conversion:pF,priority:3}:null},tr:t=>{const r=t.closest("table");return r&&wk(r)?{conversion:pF,priority:3}:null}}}static importJSON(t){return Ku().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setLanguage(t.language).setTheme(t.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(t,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&t.isCollapsed()&&t.anchor.key===this.__key&&t.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const c=is();return this.insertAfter(c,r),c}const{anchor:a,focus:i}=t,o=(a.isBefore(i)?a:i).getNode();if(rr(o)){let c=cse(o);const u=[];for(;;)if(qb(c))u.push(Hm()),c=c.getNextSibling();else{if(!EB(c))break;{let w=0;const C=c.getTextContent(),k=c.getTextContentSize();for(;w<k&&C[w]===" ";)w++;if(w!==0&&u.push(TB(" ".repeat(w))),w!==k)break;c=c.getNextSibling()}}const d=o.splitText(a.offset)[0],f=a.offset===0?0:1,g=d.getIndexWithinParent()+f,p=o.getParentOrThrow(),x=[nu(),...u];p.splice(g,0,x);const v=u[u.length-1];v?v.select():a.offset===0?d.selectPrevious():d.getNextSibling().selectNext(0,0)}if(J4(o)){const{offset:c}=t.anchor;o.splice(c,0,[nu()]),o.select(c+1,c+1)}return null}canIndent(){return!1}collapseAtStart(){const t=is();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}setLanguage(t){const r=this.getWritable();return r.__language=t||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(t){const r=this.getWritable();return r.__isSyntaxHighlightSupported=t,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(t){const r=this.getWritable();return r.__theme=t||void 0,r}getTheme(){return this.getLatest().__theme}}function Ku(e,t){return Are(j0).setLanguage(e).setTheme(t)}function J4(e){return e instanceof j0}function mF(e){return{node:Ku(e.getAttribute(uy))}}function ise(e){const t=e,r=xF(t);return r||(function(n){let s=n.parentElement;for(;s!==null;){if(xF(s))return!0;s=s.parentElement}return!1})(t)?{node:r?Ku():null}:{node:null}}function ose(){return{node:Ku()}}function pF(){return{node:null}}function xF(e){return e.style.fontFamily.match("monospace")!==null}function wk(e){return e.classList.contains("js-file-line-container")}let s2=class CB extends Lf{constructor(t="",r,n){super(t,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(t){return new CB(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(t){const r=this.getWritable();return r.__highlightType=t||void 0,r}canHaveFormat(){return!1}createDOM(t){const r=super.createDOM(t),n=_k(t.theme,this.__highlightType);return Ca(r,n),r}updateDOM(t,r,n){const s=super.updateDOM(t,r,n),a=_k(n.theme,t.__highlightType),i=_k(n.theme,this.__highlightType);return a!==i&&(a&&Sf(r,a),i&&Ca(r,i)),s}static importJSON(t){return TB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHighlightType(t.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(t){return this}isParentRequired(){return!0}createParentElementNode(){return Ku()}};function _k(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function TB(e="",t){return co(new s2(e,t))}function EB(e){return e instanceof s2}function lse(e,t){let r=e;for(let n=yi(e,t);n&&(EB(n.origin)||qb(n.origin));n=Zre(n))r=n.origin;return r}function cse(e){return lse(e,"previous")}(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach((function(r){var n=t[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),e.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}})),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);const use=new Set(["http:","https:","mailto:","sms:","tel:"]);class Uf extends $i{static getType(){return"link"}static clone(t){return new Uf(t.__url,{rel:t.__rel,target:t.__target,title:t.__title},t.__key)}constructor(t="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=t,this.__target=s,this.__rel=a,this.__title=i}createDOM(t){const r=document.createElement("a");return this.updateLinkDOM(null,r,t),Ca(r,t.theme.link),r}updateLinkDOM(t,r,n){if($9(r)){t&&t.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];t&&t[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(t,r,n){return this.updateLinkDOM(t,r,n),!1}static importDOM(){return{a:t=>({conversion:dse,priority:1})}}static importJSON(t){return B_().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setURL(t.url).setRel(t.rel||null).setTarget(t.target||null).setTitle(t.title||null)}sanitizeUrl(t){t=vF(t);try{const r=new URL(vF(t));if(!use.has(r.protocol))return"about:blank"}catch{return t}return t}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(t){const r=this.getWritable();return r.__url=t,r}getTarget(){return this.getLatest().__target}setTarget(t){const r=this.getWritable();return r.__target=t,r}getRel(){return this.getLatest().__rel}setRel(t){const r=this.getWritable();return r.__rel=t,r}getTitle(){return this.getLatest().__title}setTitle(t){const r=this.getWritable();return r.__title=t,r}insertNewAfter(t,r=!0){const n=B_(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(t,r,n){if(!Mt(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function dse(e){let t=null;if($9(e)){const r=e.textContent;(r!==null&&r!==""||e.children.length>0)&&(t=B_(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:t}}function B_(e="",t){return co(new Uf(e,t))}function fse(e){return e instanceof Uf}class Qm extends Uf{constructor(t="",r={},n){super(t,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(t){return new Qm(t.__url,{isUnlinked:t.__isUnlinked,rel:t.__rel,target:t.__target,title:t.__title},t.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(t){const r=this.getWritable();return r.__isUnlinked=t,r}createDOM(t){return this.__isUnlinked?document.createElement("span"):super.createDOM(t)}updateDOM(t,r,n){return super.updateDOM(t,r,n)||t.__isUnlinked!==this.__isUnlinked}static importJSON(t){return yF().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setIsUnlinked(t.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(t,r=!0){const n=this.getParentOrThrow().insertNewAfter(t,r);if(_t(n)){const s=yF(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function yF(e="",t){return co(new Qm(e,t))}function hse(e){return e instanceof Qm}const gse=/^\+?[0-9\s()-]{5,}$/;function vF(e){return e.match(/^[a-z][a-z0-9+.-]*:/i)||e.match(/^[/#.]/)?e:e.includes("@")?`mailto:${e}`:gse.test(e)?`tel:${e}`:`https://${e}`}function pE(e,t){const r={};for(const n of e){const s=t(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function mse(e){const t=pE(e,(r=>r.type));return{element:t.element||[],multilineElement:t["multiline-element"]||[],textFormat:t["text-format"]||[],textMatch:t["text-match"]||[]}}const wF=/[!-/:-@[-`{-~\s]/;function pse(e){return rr(e)&&!e.hasFormat("code")}function xse(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function _F(e,t,r){const n=r.length;for(let s=t;s>=n;s--){const a=s-n;if(NB(e,a,r,0,n)&&e[a+n]!==" ")return a}return-1}function NB(e,t,r,n,s){for(let a=0;a<s;a++)if(e[t+a]!==r[n+a])return!1;return!0}function yse(e,t=a2){const r=mse(t),n=pE(r.textFormat,(({tag:i})=>i[i.length-1])),s=pE(r.textMatch,(({trigger:i})=>i));for(const i of t){const o=i.type;if(o==="element"||o==="text-match"||o==="multiline-element"){const c=i.dependencies;for(const u of c)e.hasNode(u)||xse(173,u.getType())}}const a=(i,o,c)=>{(function(u,d,f,g){const p=u.getParent();if(!io(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[f-1]!==" ")return!1;for(const{regExp:v,replace:w}of g){const C=x.match(v);if(C&&C[0].length===(C[0].endsWith(" ")?f:f-1)){const k=d.getNextSiblings(),[_,N]=d.splitText(f);if(w(u,N?[N,...k]:k,C,!1)!==!1)return _.remove(),!0}}return!1})(i,o,c,r.element)||(function(u,d,f,g){const p=u.getParent();if(!io(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[f-1]!==" ")return!1;for(const{regExpStart:v,replace:w,regExpEnd:C}of g){if(C&&!("optional"in C)||C&&"optional"in C&&!C.optional)continue;const k=x.match(v);if(k&&k[0].length===(k[0].endsWith(" ")?f:f-1)){const _=d.getNextSiblings(),[N,E]=d.splitText(f);if(w(u,E?[E,..._]:_,k,null,null,!1)!==!1)return N.remove(),!0}}return!1})(i,o,c,r.multilineElement)||(function(u,d,f){let g=u.getTextContent();const p=f[g[d-1]];if(p==null)return!1;d<g.length&&(g=g.slice(0,d));for(const x of p){if(!x.replace||!x.regExp)continue;const v=g.match(x.regExp);if(v===null)continue;const w=v.index||0,C=w+v[0].length;let k;return w===0?[k]=u.splitText(C):[,k]=u.splitText(w,C),k.selectNext(0,0),x.replace(k,v),!0}return!1})(o,c,s)||(function(u,d,f){const g=u.getTextContent(),p=d-1,x=g[p],v=f[x];if(!v)return!1;for(const w of v){const{tag:C}=w,k=C.length,_=p-k+1;if(k>1&&!NB(g,_,C,0,k)||g[_-1]===" ")continue;const N=g[p+1];if(w.intraword===!1&&N&&!wF.test(N))continue;const E=u;let P=E,F=_F(g,_,C),A=P;for(;F<0&&(A=A.getPreviousSibling())&&!Qu(A);)if(rr(A)){if(A.hasFormat("code"))continue;const L=A.getTextContent();P=A,F=_F(L,L.length,C)}if(F<0||P===E&&F+k===_)continue;const j=P.getTextContent();if(F>0&&j[F-1]===x)continue;const I=j[F-1];if(w.intraword===!1&&I&&!wF.test(I))continue;const B=E.getTextContent(),Y=B.slice(0,_)+B.slice(p+1);E.setTextContent(Y);const Z=P===E?Y:j;P.setTextContent(Z.slice(0,F)+Z.slice(F+k));const se=tr(),ee=Xb();vi(ee);const te=p-k*(P===E?2:1)+1;ee.anchor.set(P.__key,F,"text"),ee.focus.set(E.__key,te,"text");for(const L of w.format)ee.hasFormat(L)||ee.formatText(L);ee.anchor.set(ee.focus.key,ee.focus.offset,ee.focus.type);for(const L of w.format)ee.hasFormat(L)&&ee.toggleFormat(L);return Mt(se)&&(ee.format=se.format),!0}})(o,c,n)};return e.registerUpdateListener((({tags:i,dirtyLeaves:o,editorState:c,prevEditorState:u})=>{if(i.has(E9)||i.has(O_)||e.isComposing())return;const d=c.read(tr),f=u.read(tr);if(!Mt(f)||!Mt(d)||!d.isCollapsed()||d.is(f))return;const g=d.anchor.key,p=d.anchor.offset,x=c._nodeMap.get(g);!rr(x)||!o.has(g)||p!==1&&p>f.anchor.offset+1||e.update((()=>{if(!pse(x))return;const v=x.getParent();v===null||J4(v)||a(v,x,d.anchor.offset)}))}))}const vse=/^(\s*)(\d{1,})\.\s/,wse=/^(\s*)[-*+]\s/,_se=/^(#{1,6})\s/,bse=/^>\s/,Sse=/^[ \t]*```([\w-]+)?/,kse=/[ \t]*```$/,AB=e=>(t,r,n,s)=>{const a=e(n);a.append(...r),t.replace(a),s||a.select(0,0)},jB=e=>(t,r,n,s)=>{const a=t.getPreviousSibling(),i=t.getNextSibling(),o=Jo(e==="check"?n[3]==="x":void 0);if(Yr(i)&&i.getListType()===e){const u=i.getFirstChild();u!==null?u.insertBefore(o):i.append(o),t.remove()}else if(Yr(a)&&a.getListType()===e)a.append(o),t.remove();else{const u=No(e,e==="number"?Number(n[2]):void 0);u.append(o),t.replace(u)}o.append(...r),s||o.select(0,0);const c=(function(u){const d=u.match(/\t/g),f=u.match(/ /g);let g=0;return d&&(g+=d.length),f&&(g+=Math.floor(f.length/4)),g})(n[1]);c&&o.setIndent(c)},Z4=(e,t,r)=>{const n=[],s=e.getChildren();let a=0;for(const i of s)if(En(i)){if(i.getChildrenSize()===1){const d=i.getFirstChild();if(Yr(d)){n.push(Z4(d,t,r+1));continue}}const o=" ".repeat(4*r),c=e.getListType(),u=c==="number"?`${e.getStart()+a}. `:c==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(o+u+t(i)),a++}return n.join(`
`)},Cse={dependencies:[Wv],export:(e,t)=>{if(!_ne(e))return null;const r=Number(e.getTag().slice(1));return"#".repeat(r)+" "+t(e)},regExp:_se,replace:AB((e=>{const t="h"+e[1].length;return pf(t)})),type:"element"},Tse={dependencies:[Uv],export:(e,t)=>{if(!U8(e))return null;const r=t(e).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:bse,replace:(e,t,r,n)=>{if(n){const a=e.getPreviousSibling();if(U8(a))return a.splice(a.getChildrenSize(),0,[nu(),...t]),void e.remove()}const s=zv();s.append(...t),e.replace(s),n||s.select(0,0)},type:"element"},Ese={dependencies:[j0],export:e=>{if(!J4(e))return null;const t=e.getTextContent();return"```"+(e.getLanguage()||"")+(t?`
`+t:"")+"\n```"},regExpEnd:{optional:!0,regExp:kse},regExpStart:Sse,replace:(e,t,r,n,s,a)=>{let i,o;if(!t&&s){if(s.length===1)n?(i=Ku(),o=r[1]+s[0]):(i=Ku(r[1]),o=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=Ku(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();o=s.join(`
`)}const c=Ds(o);i.append(c),e.append(i)}else t&&AB((c=>Ku(c?c[1]:void 0)))(e,t,r,a)},type:"multiline-element"},Nse={dependencies:[$f,hd],export:(e,t)=>Yr(e)?Z4(e,t,0):null,regExp:wse,replace:jB("bullet"),type:"element"},Ase={dependencies:[$f,hd],export:(e,t)=>Yr(e)?Z4(e,t,0):null,regExp:vse,replace:jB("number"),type:"element"},jse={format:["code"],tag:"`",type:"text-format"},Pse={format:["highlight"],tag:"==",type:"text-format"},Fse={format:["bold","italic"],tag:"***",type:"text-format"},Ose={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},Dse={format:["bold"],tag:"**",type:"text-format"},Ise={format:["bold"],intraword:!1,tag:"__",type:"text-format"},Rse={format:["strikethrough"],tag:"~~",type:"text-format"},Mse={format:["italic"],tag:"*",type:"text-format"},Lse={format:["italic"],intraword:!1,tag:"_",type:"text-format"},Bse={dependencies:[Uf],export:(e,t,r)=>{if(!fse(e)||hse(e))return null;const n=e.getTitle(),s=t(e);return n?`[${s}](${e.getURL()} "${n}")`:`[${s}](${e.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(e,t)=>{const[,r,n,s]=t,a=B_(n,{title:s}),i=r.split("[").length-1,o=r.split("]").length-1;let c=r,u="";if(i<o)return;if(i>o){const f=r.split("[");u="["+f[0],c=f.slice(1).join("[")}const d=Ds(c);return d.setFormat(e.getFormat()),a.append(d),e.replace(a),u&&a.insertBefore(Ds(u)),d},trigger:")",type:"text-match"},$se=[Cse,Tse,Nse,Ase],Use=[Ese],zse=[jse,Fse,Ose,Dse,Ise,Pse,Mse,Lse,Rse],Wse=[Bse],a2=[...$se,...Use,...zse,...Wse];function bF(e,t){return e.getEditorState().read((()=>{const r=ha(t);return r!==null&&r.isSelected()}))}function Hse(e){const[t]=ou(),[r,n]=S.useState((()=>bF(t,e)));return S.useEffect((()=>{let s=!0;const a=t.registerUpdateListener((()=>{s&&n(bF(t,e))}));return()=>{s=!1,a()}}),[t,e]),[r,S.useCallback((s=>{t.update((()=>{let a=tr();Ai(a)||(a=_4(),vi(a)),Ai(a)&&(s?a.add(e):a.delete(e))}))}),[t,e]),S.useCallback((()=>{t.update((()=>{const s=tr();Ai(s)&&s.clear()}))}),[t])]}function Gse({nodeKey:e}){const[t]=ou(),[r,n,s]=Hse(e);return S.useEffect((()=>A0(t.registerCommand(m4,(a=>{const i=t.getElementByKey(e);return a.target===i&&(a.shiftKey||s(),n(!r),!0)}),Gg))),[s,t,r,e,n]),S.useEffect((()=>{const a=t.getElementByKey(e),i=t._config.theme.hrSelected??"selected";a!==null&&(r?Ca(a,i):Sf(a,i))}),[t,r,e]),null}class Gv extends k4{static getType(){return"horizontalrule"}static clone(t){return new Gv(t.__key)}static importJSON(t){return e3().updateFromJSON(t)}static importDOM(){return{hr:()=>({conversion:Vse,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(t){const r=document.createElement("hr");return Ca(r,t.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return l.jsx(Gse,{nodeKey:this.__key})}}function Vse(){return{node:e3()}}function e3(){return co(new Gv)}function Kse(e){return e instanceof Gv}const qse=[{dependencies:[Gv],export:e=>Kse(e)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(e,t,r,n)=>{const s=e3();n||e.getNextSibling()!=null?e.replace(s):e.insertBefore(s),s.selectNext()},type:"element"},...a2];function PB({transformers:e=qse}){const[t]=ou();return S.useEffect((()=>yse(t,e)),[t,e]),null}function FB({hasStrictIndent:e=!1}){const[t]=ou();return S.useEffect((()=>{if(!t.hasNodes([$f,hd]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")}),[t]),S.useEffect((()=>{if(e)return Zne(t)}),[t,e]),(function(r){S.useEffect((()=>Jne(r)),[r])})(t),null}const Yse=({onChange:e})=>{const[t]=S.useContext(zm)||[];return S.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{ys().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},Xse=()=>{const[e]=S.useContext(zm)||[],t=S.useCallback(()=>{e&&e.dispatchCommand(Mi,"bold")},[e]),r=S.useCallback(()=>{e&&e.dispatchCommand(Mi,"italic")},[e]),n=S.useCallback(()=>{e&&e.dispatchCommand(Mi,"underline")},[e]),s=S.useCallback(()=>{e&&e.dispatchCommand(Mi,"strikethrough")},[e]),a=S.useCallback(p=>{e&&e.update(()=>{const x=tr();Mt(x)&&um(x,()=>pf(p))})},[e]),i=S.useCallback(()=>{e&&e.update(()=>{const p=tr();Mt(p)&&um(p,()=>is())})},[e]);S.useCallback(()=>{e&&e.update(()=>{const p=tr();Mt(p)&&um(p,()=>zv())})},[e]);const o=S.useCallback(()=>{e&&e.dispatchCommand(Y4)},[e]),c=S.useCallback(()=>{e&&e.dispatchCommand(X4)},[e]),u=S.useCallback(()=>{e&&e.dispatchCommand(Q4)},[e]),d=S.useCallback(p=>{e&&e.update(()=>{const x=tr();Mt(x)&&x.getNodes().forEach(v=>{rr(v)&&v.setStyle(`color: ${p}`)})})},[e]),f=S.useCallback(p=>{e&&e.update(()=>{const x=tr();Mt(x)&&x.getNodes().forEach(w=>{if(rr(w)){const C=w.getStyle(),k=C?C.replace(/font-size:\s*\d+px;?\s*/g,"").trim():"",_=k?`${k}; font-size: ${p}px;`:`font-size: ${p}px;`;w.setStyle(_)}})})},[e]),g=S.useCallback(p=>{e&&e.dispatchCommand(a9,p)},[e]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:t,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:o,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:" List"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),l.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),l.jsx("button",{type:"button",onClick:()=>d("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),l.jsx("button",{type:"button",onClick:()=>d("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),l.jsx("button",{type:"button",onClick:()=>d("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),l.jsx("button",{type:"button",onClick:()=>d("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),l.jsx("button",{type:"button",onClick:()=>f(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),l.jsx("button",{type:"button",onClick:()=>f(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),l.jsx("button",{type:"button",onClick:()=>f(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),l.jsx("button",{type:"button",onClick:()=>f(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),l.jsx("button",{type:"button",onClick:()=>g("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:""}),l.jsx("button",{type:"button",onClick:()=>g("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:""}),l.jsx("button",{type:"button",onClick:()=>g("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:""})]})]})},Qse=({value:e,onChange:t,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Wv,$f,hd,Uv,j0,s2,Hv,Ym,Xm,Qm,Uf],onError:s=>{console.error("Lexical error:",s)},editorState:e?(()=>{try{const s=JSON.parse(e);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs(V9,{initialConfig:n,children:[l.jsx(Xse,{}),l.jsx(Yse,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(uB,{contentEditable:l.jsx(fB,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:mB}),l.jsx(hB,{}),l.jsx(gB,{}),l.jsx(FB,{}),l.jsx(PB,{transformers:a2})]})]})})},Jse=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=ds(),{post:o}=tl(),{showNotification:c}=Aa(),[u,d]=S.useState({test_name:e,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[f,g]=S.useState({isLoading:!1,error:null,showPreview:!0});S.useEffect(()=>{d(C=>({...C,test_name:e||""}))},[e]);const p=()=>{if(u.num_questions>=3){g(_=>({..._,error:"Maximum 3 questions allowed for performance reasons"}));return}const k={id:Math.max(...u.questions.map(_=>_.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};d(_=>({..._,num_questions:_.num_questions+1,questions:[..._.questions,k]}))},x=C=>{u.questions.length<=1||d(k=>({...k,num_questions:k.num_questions-1,questions:k.questions.filter(_=>_.id!==C)}))},v=(C,k)=>{d(_=>({..._,questions:_.questions.map(N=>N.id===C?{...N,question_json:k}:N)}))},w=async()=>{if(!u.test_name.trim()){g(C=>({...C,error:"Test name is required"}));return}if(u.questions.some(C=>!C.question_json.trim())){g(C=>({...C,error:"All questions must have content"}));return}g(C=>({...C,isLoading:!0,error:null}));try{const C={test_name:u.test_name,num_questions:u.num_questions,passing_score:u.passing_score,questions:u.questions.map((k,_)=>({question_id:_+1,question_json:k.question_json,canvas_width:k.canvas_width,canvas_height:k.canvas_height,max_canvas_width:k.max_canvas_width,max_canvas_height:k.max_canvas_height}))};t&&t(C)}catch(C){console.error("Error preparing drawing test:",C),g(k=>({...k,error:"Failed to prepare drawing test. Please try again."})),c("Failed to prepare drawing test","error")}finally{g(C=>({...C,isLoading:!1}))}};return l.jsxs("div",{className:"drawing-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",u.num_questions,"/3)"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),l.jsxs(Ze,{onClick:p,disabled:u.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),l.jsx("div",{className:"space-y-4",children:u.questions.map((C,k)=>l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",k+1]}),u.questions.length>1&&l.jsx(Ze,{onClick:()=>x(C.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),l.jsx(Qse,{value:C.question_json,onChange:_=>v(C.id,_),placeholder:""})]})]},C.id))})]}),f.error&&l.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:f.error}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx(Ze,{onClick:r,variant:"secondary",disabled:f.isLoading,children:"Cancel"}),l.jsx(Ze,{onClick:w,variant:"primary",disabled:f.isLoading||!u.test_name.trim(),className:"flex items-center gap-2",children:f.isLoading?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})},Zse=({onChange:e})=>{const[t]=S.useContext(zm)||[];return S.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{ys().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},eae=({onAddBlank:e,blankCount:t})=>{const[r]=S.useContext(zm)||[],n=S.useCallback(()=>{r&&r.dispatchCommand(Mi,"bold")},[r]),s=S.useCallback(()=>{r&&r.dispatchCommand(Mi,"italic")},[r]),a=S.useCallback(()=>{r&&r.dispatchCommand(Mi,"underline")},[r]),i=S.useCallback(()=>{r&&r.dispatchCommand(Mi,"strikethrough")},[r]),o=S.useCallback(x=>{r&&r.update(()=>{const v=tr();Mt(v)&&um(v,()=>pf(x))})},[r]),c=S.useCallback(()=>{r&&r.update(()=>{const x=tr();Mt(x)&&um(x,()=>is())})},[r]),u=S.useCallback(()=>{r&&r.update(()=>{const x=tr();Mt(x)&&um(x,()=>zv())})},[r]),d=S.useCallback(()=>{r&&r.dispatchCommand(Y4)},[r]),f=S.useCallback(()=>{r&&r.dispatchCommand(X4)},[r]),g=S.useCallback(()=>{r&&r.dispatchCommand(Q4)},[r]),p=S.useCallback(()=>{!r||!e||(r.update(()=>{const x=tr();if(Mt(x)){const w=`${t+1}_________`,C=Ds(w);C.setStyle("background-color: #f0f9ff; border: 1px dashed #3b82f6; padding: 2px 4px; border-radius: 4px; font-family: monospace;"),x.insertNodes([C])}}),e())},[r,e,t]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:a,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>o("h1"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>o("h2"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>o("h3"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"}),l.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Quote",children:'"'})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:""}),l.jsx("button",{type:"button",onClick:f,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1."}),l.jsx("button",{type:"button",onClick:g,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:""})]}),e&&l.jsx("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:l.jsxs("button",{type:"button",onClick:p,className:"px-3 py-1 text-sm font-medium bg-blue-500 text-white border border-blue-600 rounded hover:bg-blue-600 transition-colors",title:"Add Blank",children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline mr-1",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Blank"]})})]})},tae=({value:e,onChange:t,placeholder:r,onAddBlank:n,blankCount:s=0})=>{const a={namespace:"FillBlanksLexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Wv,$f,hd,Uv,j0,s2,Hv,Ym,Xm,Qm,Uf],onError:i=>{console.error("Lexical error:",i)},editorState:e?(()=>{try{const i=JSON.parse(e);return JSON.stringify(i)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs(V9,{initialConfig:a,children:[l.jsx(eae,{onAddBlank:n,blankCount:s}),l.jsx(Zse,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(uB,{contentEditable:l.jsx(fB,{className:"p-4 min-h-32 focus:outline-none"}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:mB}),l.jsx(hB,{}),l.jsx(gB,{}),l.jsx(FB,{}),l.jsx(PB,{transformers:a2})]})]})})},rae=({testName:e="",allowedTime:t=null,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const{user:o}=ds(),{post:c}=tl(),{showNotification:u}=Aa(),[d,f]=S.useState({test_name:e,test_text:"",num_questions:1,num_blanks:0,passing_score:100,separate_type:!0,allowed_time:t,blanks:[]}),[g,p]=S.useState({isLoading:!1,error:null,showPreview:!0});S.useEffect(()=>{f(F=>({...F,test_name:e||"",allowed_time:t}))},[e,t]);const x=F=>{f(A=>({...A,test_text:F}))},v=()=>{const A={id:d.blanks.length+1,position:0,question:"",options:["","","",""],correct_answer:""};f(j=>({...j,blanks:[...j.blanks,A],num_blanks:j.num_blanks+1}))},w=F=>{f(A=>({...A,blanks:A.blanks.filter(j=>j.id!==F),num_blanks:A.num_blanks-1}))},C=F=>{f(A=>({...A,blanks:A.blanks.map(j=>j.id===F?{...j,options:[...j.options,""]}:j)}))},k=(F,A)=>{f(j=>({...j,blanks:j.blanks.map(I=>I.id===F?{...I,options:I.options.filter((B,Y)=>Y!==A),correct_answer:I.correct_answer===String.fromCharCode(65+A)?"":I.correct_answer}:I)}))},_=(F,A,j)=>{f(I=>({...I,blanks:I.blanks.map(B=>B.id===F?{...B,options:B.options.map((Y,Z)=>Z===A?j:Y)}:B)}))},N=(F,A)=>{console.log(" [DEBUG] updateBlankQuestion called:",{blankId:F,question:A}),f(j=>({...j,blanks:j.blanks.map(I=>I.id===F?{...I,question:A}:I)})),console.log(" [DEBUG] updateBlankQuestion completed")},E=(F,A)=>{f(j=>({...j,blanks:j.blanks.map(I=>I.id===F?{...I,correct_answer:A}:I)}))},P=async()=>{if(!d.test_name.trim()){p(F=>({...F,error:"Test name is required"}));return}if(!d.test_text.trim()){p(F=>({...F,error:"Test text is required"}));return}if(d.blanks.length===0){p(F=>({...F,error:"At least one blank is required"}));return}if(console.log(" [DEBUG] Validating blanks:",d.blanks),d.blanks.forEach((F,A)=>{console.log(` [DEBUG] Blank ${A+1}:`,{question:F.question,questionTrimmed:F.question?.trim(),correct_answer:F.correct_answer,options:F.options})}),d.separate_type===!1){if(d.blanks.some(F=>!F.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing correct answer"),p(F=>({...F,error:"All blanks must have correct answers"}));return}}else if(d.blanks.some(F=>!F.question.trim()||!F.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing question or correct answer"),p(F=>({...F,error:"All blanks must have question text and correct answer"}));return}console.log(" [DEBUG] Validation passed - all blanks have question and correct answer"),p(F=>({...F,isLoading:!0,error:null}));try{const F={test_name:d.test_name,test_text:d.test_text,num_questions:d.blanks.length,num_blanks:d.blanks.length,separate_type:d.separate_type,passing_score:d.passing_score,allowed_time:d.allowed_time,blanks:d.blanks.map((A,j)=>({question_id:j+1,question_json:A.question,question:A.question,options:A.options,correct_answer:A.correct_answer,blank_positions:{},blank_options:A.options||[],correct_answers:[A.correct_answer]}))};console.log(" [DEBUG] Calling onTestSaved with data:",F),r?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),r(F),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(F){console.error("Error preparing fill blanks test:",F),p(A=>({...A,error:"Failed to prepare fill blanks test. Please try again."})),u("Failed to prepare fill blanks test","error")}finally{p(F=>({...F,isLoading:!1}))}};return l.jsxs("div",{className:"fill-blanks-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Fill Blanks Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test with text content and multiple choice blanks"}),g.error&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600 text-sm",children:g.error})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${d.separate_type===!0?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>f(F=>({...F,separate_type:!0})),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:d.separate_type===!0,onChange:()=>f(F=>({...F,separate_type:!0})),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Separate Mode"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Multiple choice questions below the text"})]}),l.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${d.separate_type===!1?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>f(F=>({...F,separate_type:!1})),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:d.separate_type===!1,onChange:()=>f(F=>({...F,separate_type:!1})),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Inline Mode"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Dropdown for option inside the text"})]})]}),l.jsx(tae,{value:d.test_text,onChange:x,placeholder:"Type your text here. Use the 'Add Blank' button in the toolbar to insert blanks.",onAddBlank:v,blankCount:d.blanks.length})]}),d.separate_type===!0&&l.jsx("div",{className:"space-y-4",children:d.blanks.map((F,A)=>l.jsxs(jt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",F.id," Configuration"]}),l.jsx(Ze,{variant:"danger",size:"small",onClick:()=>w(F.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Question Text for Blank ",F.id," *"]}),l.jsx("input",{type:"text",placeholder:"Enter question text for this blank",value:F.question,onChange:j=>N(F.id,j.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),F.options.map((j,I)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+I)}`,value:j||"",onChange:B=>_(F.id,I,B.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),F.options.length>2&&l.jsx(Ze,{variant:"danger",size:"small",onClick:()=>k(F.id,I),className:"px-2 py-1 text-sm",children:""})]},I)),F.options.length<6&&l.jsx(Ze,{variant:"secondary",size:"small",onClick:()=>C(F.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:F.correct_answer||"",onChange:j=>E(F.id,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),F.options.filter(j=>j.trim().length>0).map((j,I)=>l.jsxs("option",{value:String.fromCharCode(65+I),children:[String.fromCharCode(65+I),") ",j]},I))]})]})]},F.id))}),d.separate_type===!1&&l.jsx("div",{className:"space-y-4",children:d.blanks.map((F,A)=>l.jsxs(jt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",F.id," Options"]}),l.jsx(Ze,{variant:"danger",size:"small",onClick:()=>w(F.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),F.options.map((j,I)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+I)}`,value:j||"",onChange:B=>_(F.id,I,B.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),F.options.length>2&&l.jsx(Ze,{variant:"danger",size:"small",onClick:()=>k(F.id,I),className:"px-2 py-1 text-sm",children:""})]},I)),F.options.length<6&&l.jsx(Ze,{variant:"secondary",size:"small",onClick:()=>C(F.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:F.correct_answer||"",onChange:j=>E(F.id,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),F.options.filter(j=>j.trim().length>0).map((j,I)=>l.jsxs("option",{value:String.fromCharCode(65+I),children:[String.fromCharCode(65+I),") ",j]},I))]})]})]},F.id))}),l.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[l.jsx(Ze,{onClick:n,variant:"secondary",disabled:a,children:"Cancel"}),l.jsx(Ze,{onClick:P,variant:"primary",disabled:a||d.blanks.length===0,children:a?l.jsx(Wr,{size:"sm"}):"Save Test"})]})]})},nae=[{value:"A1",label:"A1 (Beginner)",description:"Basic vocabulary, simple sentences"},{value:"A2",label:"A2 (Elementary)",description:"Everyday vocabulary, present/past tenses"},{value:"B1",label:"B1 (Intermediate)",description:"Varied vocabulary, complex sentences"},{value:"B2",label:"B2 (Upper-Intermediate)",description:"Advanced vocabulary, sophisticated structures"},{value:"C1",label:"C1 (Advanced)",description:"Nuanced vocabulary, complex discourse"},{value:"C2",label:"C2 (Proficiency)",description:"Native-like fluency and accuracy"}],sae=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{showNotification:i}=Aa(),[o,c]=S.useState({min_words:50,questions:[{question_id:1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}),[u,d]=S.useState(!1),f=S.useCallback((C,k)=>{c(_=>({..._,[C]:k}))},[]),g=S.useCallback((C,k,_)=>{c(N=>({...N,questions:N.questions.map((E,P)=>P===C?{...E,[k]:_}:E)}))},[]),p=S.useCallback(()=>{c(C=>({...C,questions:[...C.questions,{question_id:C.questions.length+1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}))},[]),x=S.useCallback(C=>{o.questions.length>1&&c(k=>({...k,questions:k.questions.filter((_,N)=>N!==C)}))},[o.questions.length]),v=S.useCallback(()=>{const C={};return o.min_words<10&&(C.min_words="Minimum word count must be at least 10 words"),o.questions.forEach((k,_)=>{k.prompt.trim()||(C[`question_${_}_prompt`]="Question prompt is required")}),C},[o]),w=S.useCallback(async C=>{C.preventDefault();const k=v();if(Object.keys(k).length>0){i("Please fix the validation errors","error");return}d(!0);try{const _={test_name:e,time_limit:300,min_duration:30,max_duration:600,max_attempts:3,min_words:o.min_words,passing_score:50,allowed_time:null,questions:o.questions.map((N,E)=>({question_id:E+1,prompt:N.prompt,expected_duration:N.expected_duration,difficulty_level:N.difficulty_level}))};console.log(" [DEBUG] Calling onTestSaved with data:",_),t?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),t(_),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(_){console.error("Error preparing speaking test:",_),i("Failed to prepare speaking test","error")}finally{d(!1)}},[o,v,i,t,e]);return u||s?l.jsxs("div",{className:"flex items-center justify-center p-8",children:[l.jsx(Wr,{}),l.jsx("span",{className:"ml-2",children:"Creating speaking test..."})]}):l.jsxs("div",{className:"speaking-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Speaking Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a speaking test where students record audio responses with AI-powered feedback"})]}),l.jsxs("form",{onSubmit:w,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Scoring Settings"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Word Count *"}),l.jsx("input",{type:"number",min:"10",max:"1000",value:o.min_words,onChange:C=>f("min_words",parseInt(C.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.min_words&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.min_words})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Questions"}),l.jsx(Ze,{type:"button",variant:"outline",onClick:p,children:"Add Question"})]}),o.questions.length>1&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Multiple Questions Detected"}),l.jsx("div",{className:"mt-1 text-sm text-blue-700",children:l.jsxs("p",{children:["You have ",o.questions.length," questions in this test.",l.jsx("strong",{children:" Only one question will be randomly selected"})," and shown to each student. This ensures fair distribution across your question pool."]})})]})]})}),o.questions.map((C,k)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"font-medium",children:["Question ",k+1]}),o.questions.length>1&&l.jsx(Ze,{type:"button",variant:"outline",size:"sm",onClick:()=>x(k),className:"text-red-600 hover:text-red-700",children:"Remove"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Prompt *"}),l.jsx("textarea",{value:C.prompt,onChange:_=>g(k,"prompt",_.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Enter the question prompt for students"}),a[`question_${k}_prompt`]&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:a[`question_${k}_prompt`]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Duration (seconds)"}),l.jsx("input",{type:"number",min:"10",max:"600",value:C.expected_duration||"",onChange:_=>g(k,"expected_duration",_.target.value?parseInt(_.target.value):null),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CEFR Level"}),l.jsx("select",{value:C.difficulty_level,onChange:_=>g(k,"difficulty_level",_.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:nae.map(_=>l.jsxs("option",{value:_.value,children:[_.label," - ",_.description]},_.value))}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the appropriate CEFR level for this question. This will be used by AI to evaluate students appropriately."})]})]})]})]},k))]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",disabled:u||s,children:u||s?"Creating...":"Create Speaking Test"})]})]})]})},OB=(e,t)=>{const[r,n]=S.useState(()=>{try{const i=window.localStorage.getItem(e);return i?JSON.parse(i):t}catch(i){return console.error(`Error reading localStorage key "${e}":`,i),t}}),s=S.useCallback(i=>{try{const o=i instanceof Function?i(r):i;n(o),window.localStorage.setItem(e,JSON.stringify(o))}catch(o){console.error(`Error setting localStorage key "${e}":`,o)}},[e,r]),a=S.useCallback(()=>{try{window.localStorage.removeItem(e),n(t)}catch(i){console.error(`Error removing localStorage key "${e}":`,i)}},[e,t]);return[r,s,a]},i2=()=>{const e=S.useCallback((c,u=null)=>{try{const d=window.localStorage.getItem(c);return d?JSON.parse(d):u}catch(d){return console.error(`Error reading localStorage key "${c}":`,d),u}},[]),t=S.useCallback((c,u)=>{try{window.localStorage.setItem(c,JSON.stringify(u))}catch(d){console.error(`Error setting localStorage key "${c}":`,d)}},[]),r=S.useCallback(c=>{try{window.localStorage.removeItem(c)}catch(u){console.error(`Error removing localStorage key "${c}":`,u)}},[]),n=S.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(c){console.error("Error clearing localStorage:",c)}},[]),s=S.useCallback(()=>{try{const c={};for(let g=0;g<window.localStorage.length;g++){const p=window.localStorage.key(g);p&&(c[p]=window.localStorage.getItem(p))}const u=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),d=URL.createObjectURL(u),f=document.createElement("a");f.href=d,f.download="localStorage_backup.json",f.click(),URL.revokeObjectURL(d),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(c){console.error("Error exporting localStorage data:",c)}},[]),a=S.useCallback(()=>{try{window.localStorage.clear()}catch(c){console.error("Error clearing localStorage:",c)}},[]),i=S.useCallback(()=>{try{const c={};for(let u=0;u<window.localStorage.length;u++){const d=window.localStorage.key(u);d&&(c[d]=window.localStorage.getItem(d))}return c}catch(c){return console.error("Error exporting localStorage data:",c),{}}},[]),o=S.useCallback(c=>{try{Object.entries(c).forEach(([u,d])=>{window.localStorage.setItem(u,d)})}catch(u){console.error("Error importing localStorage data:",u)}},[]);return{getItem:e,setItem:t,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:o}},aae=({question:e,testId:t,testType:r="true_false",mode:n="student",displayNumber:s,studentAnswer:a,onAnswerChange:i,onQuestionChange:o,onSave:c,isEditing:u=!1,isSaving:d=!1,validationErrors:f={},showCorrectAnswers:g=!1,studentId:p=null})=>{const{getItem:x,setItem:v}=i2();Aa(),S.useRef(null);const[w,C]=S.useState(""),[k,_]=S.useState(""),[N,E]=S.useState(""),[P,F]=S.useState(!1),[A,j]=S.useState(!0),[I,B]=S.useState(""),[Y,Z]=S.useState(!1),[se,ee]=S.useState(null);S.useEffect(()=>{if(e&&(E(e.question||""),_(e.correct_answer||""),n==="student"&&p)){const ae=x(`test_progress_${p}_${r}_${t}_${e.question_id}`);ae&&C(ae)}},[e,t,r,n,x]),S.useEffect(()=>{n==="student"&&a!==void 0&&a!==null&&(console.log(" TrueFalseQuestion syncing with parent studentAnswer:",a),C(a))},[a,n]),S.useEffect(()=>{if(n==="student"&&w&&t&&e?.question_id&&p){const ae=setTimeout(()=>{Z(!0),v(`test_progress_${p}_${r}_${t}_${e.question_id}`,w),ee(new Date().toLocaleTimeString()),setTimeout(()=>Z(!1),1e3)},1e3);return()=>clearTimeout(ae)}},[w,t,r,e?.question_id,n,p,v]),S.useEffect(()=>{if(n==="teacher"&&(N||k)){const ae=setTimeout(()=>{Z(!0);const X={question:N,correct_answer:k,timestamp:Date.now()};v(`teacher_form_${r}_${t}`,X),ee(new Date().toLocaleTimeString()),setTimeout(()=>Z(!1),1e3)},2e3);return()=>clearTimeout(ae)}},[N,k,t,r,n,v]);const te=S.useCallback(ae=>{n==="student"&&(C(ae),i&&i(e.question_id,ae),M(ae))},[n,e?.question_id,i]),L=S.useCallback(ae=>{E(ae),o&&o(e.question_id,ae),H(ae)},[e?.question_id,o]),V=S.useCallback(ae=>{_(ae),o&&o(e.question_id,{...e,correct_answer:ae}),W(ae)},[e,o]),M=S.useCallback(ae=>{if(n==="student"){if(!ae){j(!1),B("Please select an answer");return}j(!0),B("")}},[n]),H=S.useCallback(ae=>{if(n==="teacher"){if(!ae||ae.trim().length<10){j(!1),B("Question must be at least 10 characters long");return}j(!0),B("")}},[n]),W=S.useCallback(ae=>{if(n==="teacher"){if(!ae){j(!1),B("Please select a correct answer");return}j(!0),B("")}},[n]),R=S.useCallback(()=>{if(n!=="teacher"||!c)return;const ae={question_id:e.question_id,question:N,correct_answer:k,type:"true_false"};c(ae)},[n,c,e?.question_id,N,k]),z=S.useCallback(ae=>ae?ae.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),K=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e?.question_id]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[Y&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Wr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),se&&!Y&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",se]})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:z(N)}}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="true"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&k==="true"?"ring-2 ring-green-400":""}`,children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"true",checked:w==="true",onChange:()=>te("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="false"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&k==="false"?"ring-2 ring-green-400":""}`,children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"false",checked:w==="false",onChange:()=>te("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]}),!A&&I&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:I})]}),Q=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[Y&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Wr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),se&&!Y&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",se]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("textarea",{id:`question_${e?.question_id}`,value:N,onChange:ae=>L(ae.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${k==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"true",checked:k==="true",onChange:()=>V("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${k==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:k==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${k==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"false",checked:k==="false",onChange:()=>V("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${k==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:k==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!A&&I&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:I}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(Ze,{variant:"success",onClick:R,disabled:!A||d,className:"w-full sm:w-auto",children:d?l.jsx(Wr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:"true-false-question-container",children:n==="student"?K():Q()})},iae=({question:e,testId:t,testType:r="multiple_choice",mode:n="student",studentAnswer:s,onAnswerChange:a,onQuestionChange:i,onOptionAdd:o,onOptionRemove:c,onSave:u,isEditing:d=!1,isSaving:f=!1,validationErrors:g={},showCorrectAnswers:p=!1,studentId:x=null,displayNumber:v})=>{const{getItem:w,setItem:C}=i2(),{showNotification:k}=Aa();S.useRef(null);const[_,N]=S.useState(""),[E,P]=S.useState(["","","",""]),[F,A]=S.useState(""),[j,I]=S.useState(""),[B,Y]=S.useState(!1),[Z,se]=S.useState(!0),[ee,te]=S.useState(""),[L,V]=S.useState(!1),[M,H]=S.useState(null);S.useEffect(()=>{if(e&&(I(e.question||""),P(e.options||["","","",""]),A(e.correct_answer||""),n==="student"&&x)){const Ce=w(`test_progress_${x}_${r}_${t}_${e.question_id}`);Ce&&N(Ce)}},[e,t,r,n,w]),S.useEffect(()=>{n==="student"&&s!==void 0&&s!==null&&(console.log(" MultipleChoiceQuestion syncing with parent studentAnswer:",s),N(s))},[s,n]),S.useEffect(()=>{if(n==="student"&&_&&t&&e?.question_id&&x){const Ce=setTimeout(()=>{V(!0),C(`test_progress_${x}_${r}_${t}_${e.question_id}`,_),H(new Date().toLocaleTimeString()),setTimeout(()=>V(!1),1e3)},1e3);return()=>clearTimeout(Ce)}},[_,t,r,e?.question_id,n,x,C]),S.useEffect(()=>{if(n==="teacher"&&(j||E.some(Ce=>Ce.trim()))){const Ce=setTimeout(()=>{V(!0);const Ae={question:j,options:E,correct_answer:F,timestamp:Date.now()};C(`teacher_form_${r}_${t}`,Ae),H(new Date().toLocaleTimeString()),setTimeout(()=>V(!1),1e3)},2e3);return()=>clearTimeout(Ce)}},[j,E,F,t,r,n,C]),S.useCallback(Ce=>{if(n!=="student")return;const Ae=String(Ce);N(Ae),a&&a(e.question_id,Ae),ae(Ae)},[n,e?.question_id,a]);const W=S.useCallback(Ce=>{I(Ce),i&&i(e.question_id,Ce),X(Ce)},[e?.question_id,i]),R=S.useCallback((Ce,Ae)=>{const Ge=[...E];Ge[Ce]=Ae,P(Ge),i&&i(e.question_id,{...e,options:Ge}),ie(Ge)},[E,e,i]),z=S.useCallback(Ce=>{A(Ce),i&&i(e.question_id,{...e,correct_answer:Ce}),le(Ce)},[e,i]),K=S.useCallback(()=>{if(E.length<6){const Ce=[...E,""];P(Ce),o&&o(e.question_id,Ce)}else k("Maximum 6 options allowed","warning")},[E,e?.question_id,o,k]),Q=S.useCallback(Ce=>{if(E.length>2){const Ae=E.filter((Ge,Le)=>Le!==Ce);if(P(Ae),F===String.fromCharCode(65+Ce))A("");else if(F&&String.fromCharCode(65+Ce)<F){const Ge=String.fromCharCode(65+Ce-1);A(Ge)}c&&c(e.question_id,Ae)}else k("Minimum 2 options required","warning")},[E,F,e?.question_id,c,k]),ae=S.useCallback(Ce=>{if(n==="student"){if(!Ce){se(!1),te("Please select an answer");return}se(!0),e?.correct_answer&&Ce===e.correct_answer?te(" Correct answer!"):e?.correct_answer?te(" Incorrect answer"):te("Answer selected")}},[n,e?.correct_answer]),X=S.useCallback(Ce=>!Ce||Ce.trim().length<10?(se(!1),te("Question must be at least 10 characters long"),!1):(se(!0),te(""),!0),[]),ie=S.useCallback(Ce=>{if(n!=="teacher")return;if(Ce.filter(Ge=>Ge.trim().length>0).length<2){se(!1),te("At least 2 options must be filled");return}if(Ce.some(Ge=>Ge.trim().length>0&&Ge.trim().length<3)){se(!1),te("Each option must be at least 3 characters long");return}se(!0),te("")},[n]),le=S.useCallback(Ce=>{if(n==="teacher"){if(!Ce){se(!1),te("Please select a correct answer");return}se(!0),te("")}},[n]),ce=S.useCallback(()=>{if(n!=="teacher"||!u)return;const Ce={question_id:e.question_id,question:j,options:E.filter(Ae=>Ae.trim().length>0),correct_answer:F,type:"multiple_choice"};u(Ce)},[n,u,e?.question_id,j,E,F]),_e=S.useCallback(Ce=>Ce?Ce.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]);return n==="teacher"?l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[L&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Wr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),M&&!L&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",M]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("textarea",{id:`question_${e?.question_id}`,value:j,onChange:Ce=>W(Ce.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),l.jsx(Ze,{variant:"secondary",size:"small",onClick:K,disabled:E.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),l.jsx("div",{className:"space-y-3",children:E.map((Ce,Ae)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+Ae)}),l.jsx("input",{type:"text",value:Ce,onChange:Ge=>R(Ae,Ge.target.value),placeholder:`Option ${String.fromCharCode(65+Ae)}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0}),E.length>2&&l.jsx(Ze,{variant:"danger",size:"small",onClick:()=>Q(Ae),className:"px-2 py-1 text-sm",children:""})]},Ae))})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:`correct_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{id:`correct_${e?.question_id}`,value:F,onChange:Ce=>z(Ce.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[l.jsx("option",{value:"",children:"Select correct answer"}),E.map((Ce,Ae)=>{if(!Ce.trim())return null;const Ge=String.fromCharCode(65+Ae);return l.jsxs("option",{value:Ge,children:[Ge,") ",Ce]},Ae)})]})]})]}),!Z&&ee&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:ee}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(Ze,{variant:"success",onClick:ce,disabled:!Z||f,className:"w-full sm:w-auto",children:f?l.jsx(Wr,{size:"small"}):"Save Question"})})]}):l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof v=="number"?v:e?.question_id]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[L&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Wr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),M&&!L&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",M]})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:_e(j)}}),l.jsx("div",{className:"space-y-3",children:E.map((Ce,Ae)=>l.jsxs("label",{className:`flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${_===String.fromCharCode(65+Ae)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[l.jsx("input",{type:"radio",name:`mcq_${t}_${e?.question_id}`,value:String.fromCharCode(65+Ae),checked:_===String.fromCharCode(65+Ae),onChange:Ge=>{N(Ge.target.value),a&&a(e?.question_id,Ge.target.value)},className:"mr-3"}),l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600 mr-3",children:String.fromCharCode(65+Ae)}),l.jsx("span",{className:"flex-1",children:Ce||`Option ${String.fromCharCode(65+Ae)}`})]},Ae))}),!Z&&ee&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:ee})]})},oae=({question:e,testId:t,testType:r="input",mode:n="student",displayNumber:s,studentAnswer:a,onAnswerChange:i,onQuestionChange:o,onAnswerAdd:c,onAnswerRemove:u,onSave:d,isEditing:f=!1,isSaving:g=!1,validationErrors:p={},showCorrectAnswers:x=!1,studentId:v=null})=>{const{getItem:w,setItem:C}=i2(),{showNotification:k}=Aa(),_=S.useRef(null),[N,E]=S.useState(""),[P,F]=S.useState([""]),[A,j]=S.useState(!1),[I,B]=S.useState(!0),[Y,Z]=S.useState(""),[se,ee]=S.useState(!1);S.useEffect(()=>{if(n==="student"&&e?.question_id&&t&&r&&v){const X=`test_progress_${v}_${r}_${t}_${e.question_id}`,ie=w(X);ie&&E(ie)}},[e?.question_id,r,t,n,v,w]),S.useEffect(()=>{n==="student"&&a!==void 0&&a!==null&&(console.log(" InputQuestion syncing with parent studentAnswer:",a),E(a))},[a,n]),S.useEffect(()=>{n==="teacher"&&e?.answers&&F(e.answers.length>0?e.answers:[""])},[e?.answers,n]),S.useEffect(()=>{if(n==="student"&&N&&e?.question_id&&t&&r&&v){const X=setTimeout(()=>{ee(!0),C(`test_progress_${v}_${r}_${t}_${e.question_id}`,N),setTimeout(()=>ee(!1),1e3)},1e3);return()=>clearTimeout(X)}},[N,e?.question_id,r,t,n,v,C]),S.useEffect(()=>{if(n==="teacher"&&P&&o){const X=setTimeout(()=>{o({...e,answers:P.filter(ie=>ie.trim())})},500);return()=>clearTimeout(X)}},[P,e,n,o]);const te=S.useCallback(X=>{E(X);const ie=X.trim().length>0;B(ie),Z(ie?"":"Please enter an answer"),i&&i(e.question_id,X)},[e?.question_id,i]),L=S.useCallback((X,ie)=>{const le=[...P];le[X]=ie,F(le),i&&i(e.question_id,le)},[P,e?.question_id,i]),V=S.useCallback(()=>{if(n==="teacher"){const X=[...P,""];F(X),c&&c(e.question_id,X)}},[P,e?.question_id,n,c]),M=S.useCallback(X=>{if(n==="teacher"&&P.length>1){const ie=P.filter((le,ce)=>ce!==X);F(ie),u&&u(e.question_id,ie)}},[P,e?.question_id,n,u]),H=S.useCallback(()=>{if(n==="student"){const X=N.trim().length>0;return B(X),Z(X?"":"Please enter an answer"),X}else if(n==="teacher"){const X=P.some(ie=>ie.trim().length>0);return B(X),Z(X?"":"Please enter at least one correct answer"),X}return!0},[N,P,n]),W=S.useCallback(X=>X?X.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"",[]),R=S.useCallback(()=>{j(!0)},[]),z=S.useCallback(()=>{j(!1),H()},[H]),K=S.useCallback(X=>{X.key==="Enter"&&n==="student"&&N.trim()&&(C(`test_progress_${r}_${t}_${e.question_id}`,N),k("Answer saved","success"))},[N,r,t,e?.question_id,n,C,k]),Q=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e.question_id]}),se&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(Wr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:W(e.question)}}),l.jsx("div",{className:"space-y-3",children:l.jsx("input",{ref:_,type:"text",id:`input_${e.question_id}`,placeholder:"Enter your answer here...",value:N,onChange:X=>te(X.target.value),onFocus:R,onBlur:z,onKeyPress:K,className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${I?A?"border-blue-500":"border-gray-300 hover:border-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500"}`,"data-question-id":e.question_id,"aria-label":`Answer for question ${e.question_id}`,"aria-invalid":!I,"aria-describedby":I?void 0:`error-${e.question_id}`})}),x&&e.correct_answers&&l.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[l.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),l.jsx("ul",{className:"space-y-1",children:e.correct_answers.map((X,ie)=>l.jsxs("li",{className:"text-green-700 text-sm",children:[" ",X]},ie))})]})]}),ae=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e.question_id||"New"]}),g&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(Wr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("input",{type:"text",id:`question_${e.question_id||"new"}`,value:e.question||"",onChange:X=>o&&o({...e,question:X.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${p.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),p.question&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:p.question})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),l.jsx(Ze,{type:"button",variant:"secondary",size:"small",onClick:V,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),l.jsx("div",{className:"space-y-3",children:P.map((X,ie)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:ie+1}),l.jsx("input",{type:"text",value:X,onChange:le=>L(ie,le.target.value),placeholder:`Correct answer ${ie+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":e.question_id,"data-answer-index":ie}),P.length>1&&l.jsx(Ze,{type:"button",variant:"danger",size:"small",onClick:()=>M(ie),className:"px-2 py-1 text-sm",children:" Remove"})]},ie))}),p.answers&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:p.answers})]})]}),d&&l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(Ze,{type:"button",variant:"success",onClick:d,disabled:g,className:"w-full sm:w-auto",children:g?l.jsx(Wr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:`input-question-container ${n} ${A?"focused":""}`,children:n==="student"?Q():ae()})},Jm=(e,t,r)=>{const[n,s]=S.useState(!1),[a,i]=S.useState(0),[o,c]=S.useState(!1),u=S.useRef(!1);S.useEffect(()=>{if(!e||!t||!r)return;const w=`anti_cheating_${r}_${e}_${t}`,C=Bs(w);C&&(i(C.tabSwitches||0),c(C.isCheating||!1))},[e,t,r]);const d=S.useCallback(()=>{if(console.log(" handleTabSwitch called - isTracking:",u.current),!u.current){console.log(" Not tracking, returning early");return}console.log(" Tab switch detected - starting 7 second timer...");const w=Date.now();setTimeout(()=>{const C=Date.now()-w;console.log(" Timer completed - time hidden:",C,"ms"),C>=6500?(console.log(" Tab was hidden for sufficient time - counting as tab switch"),i(k=>{const _=k+1,N=_>=2;console.log(" Tab switch count updated:",{newCount:_,cheating:N}),c(N);const E=`anti_cheating_${r}_${e}_${t}`;return _s(E,{tabSwitches:_,isCheating:N},120*1e3),_})):console.log(" Tab was not hidden long enough - not counting as switch")},7e3)},[e,t,r]),f=S.useCallback(()=>{u.current&&(console.log(" Visibility change detected:",{hidden:document.hidden,isTracking:u.current}),document.hidden?d():console.log(" Tab became visible"))},[d]),g=S.useCallback(()=>{console.log(" startTracking called - setting up anti-cheating detection"),console.log(" Current document.hidden state:",document.hidden),console.log(" Current document.visibilityState:",document.visibilityState),s(!0),u.current=!0,document.addEventListener("visibilitychange",f),console.log(" Anti-cheating event listeners added (visibilitychange only)")},[f]),p=S.useCallback(()=>{console.log(" stopTracking called - removing anti-cheating detection"),s(!1),u.current=!1,document.removeEventListener("visibilitychange",f),console.log(" Anti-cheating event listeners removed")},[f]),x=S.useCallback(()=>{const w={caught_cheating:o,visibility_change_times:a};return console.log(" getCheatingData called:",w),w},[o,a]),v=S.useCallback(()=>{r&&e&&t&&Lm(r,e,t),i(0),c(!1),console.log(" Anti-cheating data deleted from localStorage")},[r,e,t]);return{startTracking:g,stopTracking:p,clearData:v,getCheatingData:x,tabSwitches:a,isCheating:o,isTracking:n}},lae=({testData:e,onTestComplete:t,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=S.useState(null),[o,c]=S.useState(null);S.useEffect(()=>{(async()=>{try{const[ht,Lt]=await Promise.all([mi(()=>Promise.resolve().then(()=>Kee),void 0),mi(()=>Promise.resolve().then(()=>CZ),void 0)]);i(ht),c(Lt.default)}catch(ht){console.error("Failed to load Konva:",ht)}})()},[]);const u=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[d,f]=S.useState({}),[g,p]=S.useState({}),[x,v]=S.useState(0),[w,C]=S.useState(!1),[k,_]=S.useState(null),[N,E]=S.useState(0),[P,F]=S.useState(0),[A,j]=S.useState(null),[I,B]=S.useState(null),[Y,Z]=S.useState(!1),[se,ee]=S.useState(!1),[te,L]=S.useState(!1),{showNotification:V}=Aa(),{makeAuthenticatedRequest:M}=tl(),{user:H}=ds(),{startTracking:W,stopTracking:R,getCheatingData:z,clearData:K}=Jm("matching_type",e?.id,H?.student_id||H?.id),Q=S.useRef(null),ae=S.useRef(null),X=S.useRef(null),ie=S.useRef(0),[le,ce]=S.useState(400);S.useRef({});const _e=S.useCallback(()=>{Z(!0)},[]),ne=S.useCallback(()=>{p({}),f({}),Z(!1)},[]),pe=S.useCallback(()=>{ee(!0)},[]),Ce=S.useCallback(()=>{ee(!1),r()},[r]),Ae=S.useMemo(()=>{if(!e)return null;const rt=e.blocks.map(zt=>{let Dt=zt.coordinates;if(typeof Dt=="string")try{Dt=JSON.parse(Dt)}catch(De){console.error(" Failed to parse coordinates:",De),Dt={x:0,y:0,width:100,height:100}}return Dt={x:(typeof Dt.x=="number"?Dt.x:Number(Dt.x))||0,y:(typeof Dt.y=="number"?Dt.y:Number(Dt.y))||0,width:(typeof Dt.width=="number"?Dt.width:Number(Dt.width))||30,height:(typeof Dt.height=="number"?Dt.height:Number(Dt.height))||10},{id:zt.id,word:zt.word,coordinates:Dt,hasArrow:zt.hasArrow,arrow:zt.arrow}}),ht=Array.isArray(e.arrows)?e.arrows:[],Lt=e.words.map(zt=>({id:zt.id,word:zt.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:rt,arrows:ht,words:Lt}},[e]);S.useEffect(()=>{if(!e?.image_url)return;const rt=new Image;rt.crossOrigin="anonymous",rt.onload=()=>{console.log(" Image loaded successfully"),E(rt.width),F(rt.height);const ht=Q.current?.clientWidth||800,Lt=Q.current?.clientHeight||600,zt=ht/rt.width,Dt=Lt/rt.height,De=Math.min(zt,Dt,1),Ie=rt.width*De,Ke=rt.height*De,Je=(ht-Ie)/2,Ye=(Lt-Ke)/2;_({x:Je,y:Ye,width:Ie,height:Ke,scaleX:De,scaleY:De,scale:De,image:rt}),ie.current=Q.current?.clientWidth||800,console.log(" Image info calculated:",{x:Je,y:Ye,width:Ie,height:Ke,scaleX:De,scaleY:De})},rt.onerror=()=>{console.error(" Failed to load image"),V("Failed to load test image","error")},rt.src=e.image_url},[e?.image_url,V]),S.useEffect(()=>{if(!Ae||!k)return;const rt=ie.current||Q.current?.clientWidth||800,ht=12,Lt=38;let zt=k.x,Dt=k.y+k.height+ht;const De=k.x+k.width,Ie={};Ae.words.forEach(Ye=>{if(!Object.prototype.hasOwnProperty.call(g,Ye.id)){const Tt=typeof Ye.word=="string"?Ye.word:"",Nt=Math.max(60,Tt.length*8+20);zt+Nt>Math.min(rt-ht,De)&&(zt=k.x,Dt+=Lt),d[Ye.id]||(Ie[Ye.id]={x:zt,y:Dt}),zt+=Nt+ht}}),Object.keys(Ie).length&&f(Ye=>({...Ye,...Ie}));const Ke=Object.values(Ie).reduce((Ye,Tt)=>Math.max(Ye,Tt.y),Dt),Je=Math.max(k.y+k.height+ht,Ke+Lt+ht);ce(Math.max(400,Math.ceil(Je)))},[Ae,k,g,d]);const Ge=S.useCallback(()=>{if(!k||!Ae)return[];const rt=u();return rt?Ae.blocks.map(ht=>{const Lt=ht.coordinates;let zt,Dt,De,Ie;zt=k.x+Lt.x*(k.scale??k.scaleX),Dt=k.y+Lt.y*(k.scale??k.scaleY),De=Lt.width*(k.scale??k.scaleX),Ie=Lt.height*(k.scale??k.scaleY);const Ke=g[ht.id];return l.jsxs(rt.Group,{children:[l.jsx(rt.Rect,{x:zt,y:Dt,width:De,height:Ie,fill:Ke?"rgba(40, 167, 69, 0.4)":A===ht.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:Ke?"#28a745":A===ht.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:Ke?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),Ke&&l.jsx(rt.KonvaText,{x:zt+5,y:Dt+Ie/2-10,width:De-10,height:20,text:Ae.words.find(Je=>Je.id===Ke)?.word||"",fontSize:Math.min(12,De/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},ht.id)}):[]},[k,Ae,g,a]),Le=S.useCallback(()=>{if(!k||!Ae)return[];const rt=u();return rt?(console.log(" Processing arrows:",Ae.arrows),Ae.arrows.map(ht=>{if(console.log(" Arrow data:",ht),!ht.start||!ht.end)return console.warn(" Arrow missing start/end coordinates:",ht),null;let Lt,zt,Dt,De;if(ht.rel_start_x!==null&&ht.rel_start_y!==null&&ht.rel_end_x!==null&&ht.rel_end_y!==null&&ht.image_width&&ht.image_height&&ht.image_width>0&&ht.image_height>0){const Ie=ht.image_width,Ke=ht.image_height,Je=k.width/Ie,Ye=k.height/Ke;Lt=k.x+Number(ht.rel_start_x)/100*Ie*Je,zt=k.y+Number(ht.rel_start_y)/100*Ke*Ye,Dt=k.x+Number(ht.rel_end_x)/100*Ie*Je,De=k.y+Number(ht.rel_end_y)/100*Ke*Ye}else{const Ie=k.scale??k.scaleX??1,Ke=Number(ht.start.x),Je=Number(ht.start.y),Ye=Number(ht.end.x),Tt=Number(ht.end.y);Ke<=k.width+1&&Ye<=k.width+1&&Je<=k.height+1&&Tt<=k.height+1?(Lt=k.x+(isNaN(Ke)?0:Ke),zt=k.y+(isNaN(Je)?0:Je),Dt=k.x+(isNaN(Ye)?0:Ye),De=k.y+(isNaN(Tt)?0:Tt)):(Lt=k.x+(isNaN(Ke)?0:Ke)*Ie,zt=k.y+(isNaN(Je)?0:Je)*Ie,Dt=k.x+(isNaN(Ye)?0:Ye)*Ie,De=k.y+(isNaN(Tt)?0:Tt)*Ie)}return l.jsx(rt.Arrow,{points:[Lt,zt,Dt,De],stroke:ht.style?.color||"#dc3545",fill:ht.style?.color||"#dc3545",strokeWidth:ht.style?.thickness||3,pointerLength:10,pointerWidth:10},ht.id)}).filter(Boolean)):[]},[k,Ae,a]),At=S.useCallback(()=>{if(!Ae)return[];const rt=u();return rt?Ae.words.map(ht=>{const Lt=d[ht.id]||{x:0,y:0},zt=typeof ht.word=="string"?ht.word:"",Dt=Math.max(60,zt.length*8+20);return Object.values(g).includes(ht.id)?null:l.jsxs(rt.Group,{x:Lt.x,y:Lt.y,draggable:!0,onDragEnd:Ie=>et(Ie,ht.id),children:[l.jsx(rt.Rect,{width:Dt,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),l.jsx(rt.KonvaText,{text:zt,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:Dt,height:34,listening:!1})]},ht.id)}):[]},[Ae,d,g,k,a]),et=S.useCallback((rt,ht)=>{const Lt=rt.target.x(),zt=rt.target.y();if(f(Nt=>({...Nt,[ht]:{x:Lt,y:zt}})),!k||!Ae)return;const Dt=Ae.words.find(Nt=>Nt.id===ht);if(!Dt)return;const De=typeof Dt.word=="string"?Dt.word:"",Ie=Math.max(60,De.length*8+20),Ke={x:Lt,y:zt,width:Ie,height:34},Je=k.scale??k.scaleX??1,Ye=(Nt,Wt)=>!(Wt.x>Nt.x+Nt.width||Wt.x+Wt.width<Nt.x||Wt.y>Nt.y+Nt.height||Wt.y+Wt.height<Nt.y),Tt=Ae.blocks.find(Nt=>{const Wt=Nt.coordinates,or={x:k.x+Wt.x*Je,y:k.y+Wt.y*Je,width:Wt.width*Je,height:Wt.height*Je};return Ye(Ke,or)});if(Tt){p(fr=>({...fr,[Tt.id]:ht}));const Nt=Tt.coordinates,Wt=k.x+Nt.x*Je,or=k.y+Nt.y*Je,dr=Nt.width*Je,Er=Nt.height*Je;f(fr=>({...fr,[ht]:{x:Wt+(dr-Ie)/2,y:or+(Er-34)/2}})),V(`Word "${Dt.word}" placed in block`,"success")}},[k,Ae,V]),pt=S.useCallback(()=>{if(!Ae)return 0;const rt=Ae.words.length,ht=Object.keys(g).length;return rt>0?ht/rt*100:0},[Ae,g]);S.useEffect(()=>{const rt=pt();v(rt)},[pt]),S.useEffect(()=>{if(e&&!I){const rt=new Date;B(rt),console.log(" Test timer started at:",rt.toISOString()),W(),console.log(" Anti-cheating tracking started")}},[e,I,W]);const lt=S.useCallback(async()=>{if(Ae){C(!0);try{const rt=Ae.words.length;let ht=0;console.log(" Scoring check - placedWords:",g),console.log(" Scoring check - blocks:",Ae.blocks.map(nr=>({id:nr.id,word:nr.word}))),console.log(" Scoring check - words:",Ae.words.map(nr=>({id:nr.id,word:nr.word}))),Ae.blocks.forEach(nr=>{const me=g[nr.id];if(console.log(` Block ${nr.id} (expects "${nr.word}") has placed word ID: ${me}`),me){const Ne=Ae.words.find(Fe=>Fe.id===me);console.log(" Placed word:",Ne),Ne&&Ne.word===nr.word?(ht++,console.log(` Correct! Block ${nr.id} has correct word "${Ne.word}"`)):console.log(` Incorrect! Block ${nr.id} expected "${nr.word}" but got "${Ne?.word||"nothing"}"`)}else console.log(` Block ${nr.id} has no word placed`)});const Lt=ht,zt=rt;console.log(` Final Score: ${Lt}/${zt} (${Math.round(Lt/zt*100)}%)`);const Dt=new Date,De=I?Math.round((Dt-I)/1e3):0,Ie=I?I.toISOString():Dt.toISOString();console.log(" Test timing:",{startedAt:Ie,endTime:Dt.toISOString(),timeTaken:`${De} seconds`});const Ke=z();console.log(" Anti-cheating data for submission:",Ke);const Je=H.student_id,Ye=`retest_assignment_id_${Je}_matching_type_${e.id}`,Tt=localStorage.getItem(Ye),{academicCalendarService:Nt}=await mi(async()=>{const{academicCalendarService:nr}=await Promise.resolve().then(()=>l2);return{academicCalendarService:nr}},void 0);await Nt.loadAcademicCalendar();const or=Nt.getCurrentTerm()?.id;if(!or)throw new Error("No current academic period found");const dr={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:Je,academic_period_id:or,answers:g,score:Lt,maxScore:zt,time_taken:De,started_at:Ie,submitted_at:Dt.toISOString(),caught_cheating:Ke.caught_cheating,visibility_change_times:Ke.visibility_change_times,retest_assignment_id:Tt?Number(Tt):null,parent_test_id:e.id};console.log(" Submitting test data:",dr);const fr=await(await M("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(dr)})).json();if(console.log(" Submission response:",fr),fr.success){if(V("Test submitted successfully!","success"),R(),K(),H?.student_id&&Lm(H.student_id,"matching_type",e.id),!!Tt&&H?.student_id){let Ne=3;try{const bt=localStorage.getItem(`student_active_tests_${H.student_id}`);if(bt){const ze=JSON.parse(bt)?.tests?.find(ke=>ke.test_id===e.id&&ke.test_type==="matching_type");ze&&(Ne=ze.retest_attempts_left||ze.max_attempts||3)}}catch(bt){console.error("Error checking active tests cache:",bt)}const Re=(Lt>0&&zt>0?Lt/zt*100:0)>=50;if(Re){const bt=`retest_attempt${Ne}_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(bt,"true"),console.log(" Passed retest, marking last-slot key:",bt);let Pe=0;for(let $e=1;$e<=10;$e++){const Be=`retest_attempt${$e}_${H.student_id}_matching_type_${e.id}`;localStorage.getItem(Be)==="true"&&Pe++}const ze=`test_completed_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(ze,"true"),console.log(" Marked retest as completed (student passed):",ze);const ke=`retest_attempts_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(ke,JSON.stringify({used:Pe,max:Ne})),console.log(" Set retest attempts metadata (student passed):",ke,{used:Pe,max:Ne})}else{let bt=1;for(let Be=1;Be<=10;Be++){const Et=`retest_attempt${Be}_${H.student_id}_matching_type_${e.id}`;if(localStorage.getItem(Et)!=="true"){bt=Be;break}}const Pe=`retest_attempt${bt}_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(Pe,"true"),console.log(" Marked retest attempt as completed:",Pe);let ze=0;for(let Be=1;Be<=10;Be++){const Et=`retest_attempt${Be}_${H.student_id}_matching_type_${e.id}`;localStorage.getItem(Et)==="true"&&ze++}const ke=Ne-ze,$e=ke<=0||Re;if(console.log(" Retest completion check:",{usedAttempts:ze,maxAttempts:Ne,attemptsLeft:ke,passed:Re,shouldComplete:$e}),$e){const Be=`test_completed_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(Be,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",Be);const Et=`retest_attempts_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(Et,JSON.stringify({used:ze,max:Ne})),console.log(" Set retest attempts metadata (attempts exhausted):",Et,{used:ze,max:Ne})}}}else if(H?.student_id){const Ne=`test_completed_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(Ne,"true"),console.log(" Test marked as completed in localStorage:",Ne)}if(H?.student_id){const{setCachedData:Ne,CACHE_TTL:Fe}=await mi(async()=>{const{setCachedData:bt,CACHE_TTL:Pe}=await Promise.resolve().then(()=>qg);return{setCachedData:bt,CACHE_TTL:Pe}},void 0),Re=`student_results_table_${H.student_id}`;Ne(Re,fr,Fe.student_results_table),console.log(" Test results cached with key:",Re)}const me=`retest1_${Je}_matching_type_${e.id}`;localStorage.removeItem(me),localStorage.removeItem(Ye),t&&t(Lt)}else throw new Error(fr.message||"Failed to submit test")}catch(rt){console.error(" Error submitting test:",rt),V(`Error submitting test: ${rt.message}`,"error")}finally{C(!1)}}},[Ae,g,e,H,I,M,V,t]);return!e||!Ae?l.jsx(Wr,{}):l.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:l.jsxs("div",{className:"max-w-6xl mx-auto",children:[l.jsx("div",{className:"flex justify-end mb-2",children:l.jsx(Ze,{onClick:pe,variant:"outline",size:"sm",children:"Back to Cabinet"})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e.test_name})}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),l.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(x),"%"]})]})]}),l.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${x}%`}})})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:l.jsx("div",{className:"lg:col-span-3",children:l.jsxs(jt,{className:"p-4",children:[l.jsx("div",{className:"mb-4 text-center",children:l.jsx(Ze,{onClick:_e,variant:"secondary",children:"Reset"})}),l.jsx("div",{ref:Q,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${le}px`},children:k&&a?(()=>{const{Stage:rt,Layer:ht,KonvaImage:Lt}=u();return l.jsxs(rt,{ref:ae,width:Q.current?.clientWidth||800,height:le,children:[l.jsxs(ht,{children:[l.jsx(Lt,{ref:X,image:k.image,x:k.x,y:k.y,width:k.width,height:k.height,listening:!1}),Ge(),Le()]}),l.jsx(ht,{listening:!0,children:At()})]})})():k?l.jsxs("div",{className:"flex items-center justify-center h-full",children:[l.jsx(Wr,{size:"lg"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),l.jsx("div",{className:"mt-4 text-center",children:l.jsx(Ze,{onClick:()=>L(!0),disabled:w||x<100,children:w?"Submitting...":"Submit Test"})})]})})}),l.jsx(fa,{isOpen:Y,onClose:()=>Z(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>Z(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:ne,variant:"primary",children:"Reset"})]})]})}),l.jsx(fa,{isOpen:se,onClose:()=>ee(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>ee(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:Ce,variant:"primary",children:"Go Back"})]})]})}),l.jsx(fa,{isOpen:te,onClose:()=>L(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>L(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:()=>{L(!1),lt()},variant:"primary",children:"Submit"})]})]})})]})})},cae=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=ds(),{makeAuthenticatedRequest:o}=tl(),{showNotification:c}=Aa(),[u,d]=S.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[f,g]=S.useState("drag"),[p,x]=S.useState(!1),[v,w]=S.useState(null),C=S.useCallback(()=>{d(F=>[...F,{leftWord:"",rightWord:""}])},[]),k=S.useCallback(F=>{u.length>1&&d(A=>A.filter((j,I)=>I!==F))},[u.length]),_=S.useCallback((F,A)=>{d(j=>j.map((I,B)=>B===F?{...I,leftWord:A}:I))},[]),N=S.useCallback((F,A)=>{d(j=>j.map((I,B)=>B===F?{...I,rightWord:A}:I))},[]),E=S.useCallback(()=>u.every(F=>F.leftWord.trim()&&F.rightWord.trim()),[u]),P=S.useCallback(async()=>{if(!E()){c("Please fill in all word pairs","error");return}x(!0),w(null);try{const F=u.map((j,I)=>({question_id:I+1,left_word:j.leftWord.trim(),right_word:j.rightWord.trim()})),A={test_name:e,num_questions:F.length,interaction_type:f,questions:F};console.log(" Saving word matching test:",A),t({testName:e,numQuestions:F.length,interactionType:f,wordPairs:u,questions:F})}catch(F){console.error("Error saving word matching test:",F),w(F.message),c("Failed to save test: "+F.message,"error")}finally{x(!1)}},[e,u,f,E,o,c,t]);return l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-0",children:[l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${f==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("drag"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:f==="drag",onChange:()=>g("drag"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" Easier for younger students",l.jsx("br",{})," Visual feedback on placement",l.jsx("br",{})," Mobile-friendly"]})]}),l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${f==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("arrow"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:f==="arrow",onChange:()=>g("arrow"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" More challenging",l.jsx("br",{})," Better for visual learners",l.jsx("br",{})," Requires precision"]})]})]})]})}),l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"word-pairs-section",children:[l.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),l.jsx(Ze,{onClick:C,size:"sm",children:"+ Add Pair"})]}),l.jsx("div",{className:"pairs-list space-y-3 p-0 md:p-4",children:u.map((F,A)=>l.jsxs("div",{className:"word-pair-row flex items-center space-x-2 md:space-x-4 p-2 md:p-4 bg-gray-50 rounded-lg border",children:[l.jsx("div",{className:"pair-number flex-shrink-0",children:l.jsx("span",{className:"number-badge w-6 h-6 md:w-8 md:h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs md:text-sm font-semibold",children:A+1})}),l.jsx("div",{className:"left-word flex-1",children:l.jsx("input",{type:"text",value:F.leftWord,onChange:j=>_(A,j.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-lg md:text-xl",children:""}),l.jsx("div",{className:"right-word flex-1",children:l.jsx("input",{type:"text",value:F.rightWord,onChange:j=>N(A,j.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-actions flex-shrink-0",children:l.jsx(Ze,{onClick:()=>k(A),variant:"outline",size:"sm",className:"remove-btn w-6 h-6 md:w-8 md:h-8 p-0 text-red-500 hover:bg-red-50",disabled:u.length<=1,children:""})})]},A))})]})}),l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"preview-section",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),l.jsx("div",{className:"preview-pairs space-y-2",children:u.map((F,A)=>l.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[l.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[A+1,"."]}),l.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:F.leftWord||"Left word"}),l.jsx("span",{className:"preview-arrow text-gray-500",children:""}),l.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:F.rightWord||"Right word"})]},A))})]})}),l.jsxs("div",{className:"flex justify-center space-x-4",children:[l.jsx(Ze,{onClick:P,disabled:!E()||p,className:"px-8",children:p?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),l.jsx(Ze,{onClick:r,variant:"secondary",children:"Cancel"})]}),v&&l.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600",children:v})})]})},uae=(e,t)=>{const[r,n,s]=OB(`test_progress_${e}_${t}`,{}),[a,i]=S.useState(!1),[o,c]=S.useState(0),[u,d]=S.useState(0),[f,g]=S.useState(!1),[p,x]=S.useState(null),v=S.useRef(null),w=S.useRef(null),C=S.useCallback((M,H)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(W=>({...W,[M]:H})),console.log(`Saved progress for question ${M}:`,H)},[n]),k=S.useCallback(M=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[M]||null,[r]),_=S.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${e}, testId: ${t}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const M=`test_progress_${e}_${t}`;console.log(`[DEBUG] Removing localStorage key: ${M}`);const H=Object.keys(r).length>0;s(),console.log(H?`[DEBUG] Progress cleared for test ${e}_${t}`:`[DEBUG] No progress found to clear for test ${e}_${t}`)},[s,e,t,r]),N=S.useCallback(()=>{v.current&&(N(v.current),v.current=null),w.current&&(N(w.current),w.current=null)},[]),E=S.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${e}, testId: ${t}`),w.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),I()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[e,t]),P=S.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${e}, testId: ${t}`);const M=j(),H=u>0?Math.round(M/u*100):0;return console.log(`[DEBUG] Progress: ${M}/${u} questions answered`),console.log(`[DEBUG] Progress bar updated: ${H}%`),{answeredQuestions:M,totalQuestions:u,percentage:H}},[e,t,u]),F=S.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const M=j();console.log(`[DEBUG] Submit button state check: ${M}/${u} questions answered`);const H=M===u&&u>0;return console.log(H?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),H},[u]),A=S.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${e}, testId: ${t}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const M=Object.keys(r).length;c(M),console.log(`[DEBUG] Restored ${M} answered questions`)}catch(M){console.error("[ERROR] Failed to load saved progress:",M),x(M.message)}},[e,t,r]),j=S.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${e}`);const M=Object.keys(r).length;return c(M),console.log(`[DEBUG] Found ${M} answered questions`),M},[e,r]),I=S.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${e}, testId: ${t}`);try{console.log("[DEBUG] Progress saved:",r)}catch(M){console.error("[ERROR] Failed to save progress:",M),x(M.message)}},[e,t,r]),B=S.useCallback(()=>{try{const M=`test_completed_${e}_${t}`,H=localStorage.getItem(M)==="true";return i(H),H}catch(M){return console.error("Error checking test completion:",M),!1}},[e,t]),Y=S.useCallback(()=>{try{const M=`test_completed_${e}_${t}`;localStorage.setItem(M,"true"),i(!0),console.log(`Test ${e}_${t} marked as completed`)}catch(M){console.error("Error marking test completed:",M)}},[e,t]),Z=S.useCallback(()=>{console.log("Marking test completed in UI:",{testType:e,testId:t}),Y()},[e,t,Y]),se=S.useCallback(M=>{try{const H=`test_creation_state_${e}_${t}`;localStorage.setItem(H,JSON.stringify(M)),console.log("Test creation state saved:",M)}catch(H){console.error("Error saving test creation state:",H)}},[e,t]),ee=S.useCallback(()=>{try{const M=`test_creation_state_${e}_${t}`;localStorage.removeItem(M),console.log("Test creation state cleared")}catch(M){console.error("Error clearing test creation state:",M)}},[e,t]),te=S.useCallback((M,H)=>{try{const W=`test_step_${e}_${t}_${M}`;localStorage.setItem(W,JSON.stringify(H)),console.log(`Step ${M} data saved:`,H)}catch(W){console.error(`Error saving step ${M} data:`,W)}},[e,t]),L=S.useCallback(M=>{try{const H=`test_step_${e}_${t}_${M}`,W=localStorage.getItem(H);return W?JSON.parse(W):null}catch(H){return console.error(`Error restoring step ${M} data:`,H),null}},[e,t]),V=S.useCallback(()=>{try{const M=`test_creation_state_${e}_${t}`,H=localStorage.getItem(M);return H?JSON.parse(H):null}catch(M){return console.error("Error restoring test creation state:",M),null}},[e,t]);return S.useEffect(()=>()=>{N()},[e,t,E,A,N]),S.useEffect(()=>{j()},[r,j]),{progress:r,isCompleted:a,answeredCount:o,totalQuestions:u,isLoading:f,error:p,saveProgress:C,getProgress:k,clearProgress:_,clearInterval:N,setupProgressTracking:E,updateProgress:P,updateSubmitButton:F,loadProgress:A,getAnsweredCount:j,saveProgressForPage:I,checkCompleted:B,markCompleted:Y,markCompletedUI:Z,saveState:se,clearState:ee,saveStepData:te,restoreStepData:L,restoreState:V,setTotalQuestions:d,setError:x}},dae=({testData:e,onTestComplete:t,onBackToCabinet:r})=>{const{user:n}=ds(),{makeAuthenticatedRequest:s}=tl(),{showNotification:a}=Aa(),[i,o]=S.useState({width:window.innerWidth,height:window.innerHeight});S.useEffect(()=>{const De=()=>{o({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[]);const{getCheatingData:c,stopTracking:u,clearData:d}=Jm(),[f,g]=S.useState(null),[p,x]=S.useState({}),[v,w]=S.useState(null),C=S.useRef(null),[k,_]=S.useState(800),N={VERY_SMALL:400,MOBILE:600,TABLET:900},E={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},P={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:80,MARGIN:50},F=i.width<N.VERY_SMALL,A=i.width>=N.VERY_SMALL&&i.width<N.MOBILE,j=i.width>=N.MOBILE&&i.width<N.TABLET;i.width>=N.TABLET;const I=F?E.VERY_SMALL:A?E.MOBILE:j?E.TABLET:E.DESKTOP;S.useEffect(()=>{const De=()=>{if(C.current){const Ke=C.current.clientWidth;console.log(" Container width detected:",Ke),Ke>0&&_(Ke)}};De();const Ie=[setTimeout(De,50),setTimeout(De,100),setTimeout(De,200),setTimeout(De,500)];return window.addEventListener("resize",De),()=>{Ie.forEach(Ke=>clearTimeout(Ke)),window.removeEventListener("resize",De)}},[f]);const B=P.BLOCK_WIDTH*I,Y=P.BLOCK_HEIGHT*I,Z=P.BLOCK_SPACING*I,se=P.MARGIN*I,ee=se;console.log(" Mobile Debug:",{screenWidth:i.width,containerWidth:C.current?.clientWidth,canvasWidth:k,scale:I,blockWidth:B,margin:se,leftBlockX:ee,displayDataLoaded:!!f});const te=ee+B+20+B+se,L=te<=k;let V,M=B,H=Y;if(L)V=Math.min(Math.max(ee+B+20,k-B-se),k-B-se);else{const De=k-se*2,Ie=Math.floor((De-20)/2);M=Math.max(60,Ie),H=Math.max(30,H*(M/B)),V=ee+M+20,console.log(" Very small screen - adjusted block size:",{availableWidth:De,maxBlockWidth:Ie,actualBlockWidth:M,actualBlockHeight:H})}console.log(" Right Block Position:",{rightBlockX:V,rightBlockRightEdge:V+M,canvasWidth:k,fits:V+M<=k,canFitSideBySide:L,minRequiredWidth:te});const W=se,R={DRAGGED_WORD:Math.max(8,14*I),ORIGINAL_WORD:Math.max(10,16*I),LEFT_WORD:Math.max(10,14*I)},z=Math.max(1,3*I),K=S.useCallback((De,Ie,Ke)=>{if(!De)return H;const Je=Ie*.55,Ye=Math.floor(Ke/Je),Tt=Math.ceil(De.length/Ye),Nt=Ie*1.1,Wt=12*I,or=Tt*Nt+Wt,dr=Math.max(H*.8,30*I);return Math.max(dr,or)},[H,I]),ae=S.useCallback(()=>{if(!f?.leftWords||!f?.rightWords)return P.CANVAS_HEIGHT*I;let De=se*2;for(let Ke=0;Ke<f.leftWords.length;Ke++){const Je=f.leftWords[Ke],Ye=f.rightWords[Ke],Tt=K(Je,R.LEFT_WORD,M),Nt=K(Ye,R.ORIGINAL_WORD,M),Wt=Math.max(Tt,Nt);De+=Wt,Ke<f.leftWords.length-1&&(De+=20*I)}const Ie=P.CANVAS_HEIGHT*I;return Math.max(Ie,De)},[f,K,R,M,se,I])();S.useCallback((De,Ie)=>{if(!De||!Ie)return Z;const Ke=De.map((Tt,Nt)=>{const Wt=Ie[Nt],or=K(Tt,R.LEFT_WORD,M),dr=K(Wt,R.ORIGINAL_WORD,M);return Math.max(or,dr)}),Je=Math.max(...Ke),Ye=20*I;return Je+Ye},[Z,K,R,M,I]);const ie=S.useCallback(()=>{if(!f?.leftWords||!f?.rightWords)return[];const De=[];let Ie=se;for(let Ke=0;Ke<f.leftWords.length;Ke++){const Je=f.leftWords[Ke],Ye=f.rightWords[Ke],Tt=K(Je,R.LEFT_WORD,M),Nt=K(Ye,R.ORIGINAL_WORD,M),Wt=Math.max(Tt,Nt);De.push({y:Ie,leftHeight:Tt,rightHeight:Nt,rowHeight:Wt}),Ie+=Wt+20*I}return De},[f,K,R,M,se,I])(),[le,ce]=S.useState([]),[_e,ne]=S.useState(!1),[pe,Ce]=S.useState(!1),[Ae,Ge]=S.useState(null),[Le,At]=S.useState(!1),[et,pt]=S.useState(!1);S.useEffect(()=>{if(e){if(console.log(" WordMatchingStudent: Initializing test data:",e),console.log(" Interaction type:",e.interaction_type),console.log(" Left words:",e.leftWords),console.log(" Right words:",e.rightWords),console.log(" Correct pairs:",e.correctPairs),!Array.isArray(e.leftWords)||!Array.isArray(e.rightWords)){console.error(" Invalid data structure - leftWords or rightWords not arrays:",{leftWords:e.leftWords,rightWords:e.rightWords});return}if(g(e),Ge(new Date),n?.student_id){const De=`test_progress_${n.student_id}_word_matching_${e.id}`,Ie=Bs(De);Ie&&(x(Ie.answers||{}),ce(Ie.arrows||[]),Ge(new Date(Ie.startTime)),console.log(" Test progress restored:",Ie))}}},[e,n?.student_id]),S.useEffect(()=>{if(f&&Ae&&n?.student_id){const De=setInterval(()=>{const Ie={answers:p,arrows:le,startTime:Ae.toISOString()},Ke=`test_progress_${n.student_id}_word_matching_${e.id}`;_s(Ke,Ie,Ls.test_progress),console.log(" Progress auto-saved")},3e4);return()=>clearInterval(De)}},[f,p,le,Ae,n?.student_id,e?.id]);const lt=S.useCallback((De,Ie)=>{if(console.log(" handleWordClick called:",{side:De,index:Ie,interactionType:e?.interaction_type,selectedWord:v}),e?.interaction_type!=="arrow"){console.log(" Not arrow mode, ignoring click");return}if(v){if(v.side===De&&v.index===Ie)console.log(" Deselecting word"),w(null);else if(v.side!==De){console.log(" Creating arrow connection:",{startWord:v,endWord:{side:De,index:Ie}});const Ke={id:Date.now().toString(),startWord:v,endWord:{side:De,index:Ie},color:"#3B82F6"};ce(Je=>{const Ye=[...Je,Ke];return console.log(" Updated arrows:",Ye),Ye}),x(Je=>{const Ye={...Je,[v.index]:Ie};return console.log(" Updated answers:",Ye),Ye}),w(null)}}else console.log(" Selecting word:",{side:De,index:Ie}),w({side:De,index:Ie})},[v,e?.interaction_type]);S.useCallback((De,Ie)=>{e.interaction_type==="drag"&&x(Ke=>({...Ke,[De]:Ie}))},[e?.interaction_type]);const rt=S.useCallback(()=>{At(!0)},[]),ht=S.useCallback(()=>{x({}),ce([]),w(null),At(!1)},[]),Lt=S.useCallback(()=>{pt(!0)},[]),zt=S.useCallback(()=>{pt(!1),r&&r()},[r]),Dt=S.useCallback(async()=>{if(f){ne(!0);try{const De=f?.leftWords?.length||0;let Ie=0,Ke={};e.interaction_type==="drag"?Object.entries(p).forEach(([Pe,ze])=>{const ke=f?.correctPairs?.[Pe];ze===ke&&Ie++,Ke[Pe]=ze}):le.forEach(Pe=>{const ze=Pe.startWord.side==="left"?Pe.startWord.index:Pe.endWord.index,ke=Pe.startWord.side==="right"?Pe.startWord.index:Pe.endWord.index;f?.correctPairs?.[ze]===ke&&Ie++,Ke[ze]=ke});const Je=Ie,Ye=De;console.log(` Final Score: ${Je}/${Ye} (${Math.round(Je/Ye*100)}%)`);const Tt=new Date,Nt=Ae?Math.round((Tt-Ae)/1e3):0,Wt=Ae?Ae.toISOString():Tt.toISOString(),or=c(),dr=n.student_id,Er=`retest_assignment_id_${dr}_word_matching_${e.id}`,fr=localStorage.getItem(Er),{academicCalendarService:nr}=await mi(async()=>{const{academicCalendarService:Pe}=await Promise.resolve().then(()=>l2);return{academicCalendarService:Pe}},void 0);await nr.loadAcademicCalendar();const Ne=nr.getCurrentTerm()?.id;if(!Ne)throw new Error("No current academic period found");const Fe={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:dr,academic_period_id:Ne,parent_test_id:e.id,retest_assignment_id:fr?Number(fr):null,interaction_type:e.interaction_type,answers:Ke,score:Je,maxScore:Ye,time_taken:Nt,started_at:Wt,submitted_at:Tt.toISOString(),caught_cheating:or.caught_cheating,visibility_change_times:or.visibility_change_times};console.log(" Submission data being sent:",Fe),console.log(" TestData structure:",e),console.log(" Submitting test results...");const Re=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});console.log(" Submission response received:",Re.status);const bt=await Re.json();if(bt.success){if(a("Test submitted successfully!","success"),u(),d(),n?.student_id&&Lm(n.student_id,"word_matching",e.id),!!fr&&n?.student_id){let ze=3;try{const Be=localStorage.getItem(`student_active_tests_${n.student_id}`);if(Be){const It=JSON.parse(Be)?.tests?.find(Kt=>Kt.test_id===e.id&&Kt.test_type==="word_matching");It&&(ze=It.retest_attempts_left||It.max_attempts||3)}}catch(Be){console.error("Error checking active tests cache:",Be)}const $e=(Je>0&&Ye>0?Je/Ye*100:0)>=50;if($e){const Be=`retest_attempt${ze}_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Be,"true"),console.log(" Passed retest, marking last-slot key:",Be);let Et=0;for(let wr=1;wr<=10;wr++){const lr=`retest_attempt${wr}_${n.student_id}_word_matching_${e.id}`;localStorage.getItem(lr)==="true"&&Et++}const It=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(It,"true"),console.log(" Marked retest as completed (student passed):",It);const Kt=`retest_attempts_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Kt,JSON.stringify({used:Et,max:ze})),console.log(" Set retest attempts metadata (student passed):",Kt,{used:Et,max:ze})}else{let Be=1;for(let lr=1;lr<=10;lr++){const Fr=`retest_attempt${lr}_${n.student_id}_word_matching_${e.id}`;if(localStorage.getItem(Fr)!=="true"){Be=lr;break}}const Et=`retest_attempt${Be}_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Et,"true"),console.log(" Marked retest attempt as completed:",Et);let It=0;for(let lr=1;lr<=10;lr++){const Fr=`retest_attempt${lr}_${n.student_id}_word_matching_${e.id}`;localStorage.getItem(Fr)==="true"&&It++}const Kt=ze-It,wr=Kt<=0||$e;if(console.log(" Retest completion check:",{usedAttempts:It,maxAttempts:ze,attemptsLeft:Kt,passed:$e,shouldComplete:wr}),wr){const lr=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(lr,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",lr);const Fr=`retest_attempts_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Fr,JSON.stringify({used:It,max:ze})),console.log(" Set retest attempts metadata (attempts exhausted):",Fr,{used:It,max:ze})}}}else if(n?.student_id){const ze=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(ze,"true"),console.log(" Test marked as completed in localStorage:",ze)}if(n?.student_id){const ze=`student_results_table_${n.student_id}`;_s(ze,bt,Ls.student_results_table),console.log(" Test results cached with key:",ze)}if(n?.student_id){const ze=`retest1_${dr}_word_matching_${e.id}`;localStorage.removeItem(ze),localStorage.removeItem(Er)}t&&t(Je),ne(!1)}else throw new Error(bt.message||"Failed to submit test")}catch(De){console.error("Error submitting test:",De),ne(!1)}}},[f,p,le,e,n,Ae,c,u,d,s,t]);return f?l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-4xl mx-auto p-6",children:[l.jsx(fa,{isOpen:_e,onClose:()=>{},title:"Submitting",size:"small",children:l.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[l.jsx(Wr,{size:"lg",className:"mb-3"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),l.jsx("div",{className:"flex justify-end mb-2",children:l.jsx(Ze,{onClick:Lt,variant:"outline",size:"sm",disabled:_e,children:"Back to Cabinet"})}),l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"text-left",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:e.test_name}),l.jsx("p",{className:"text-gray-600",children:e.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]})}),e.interaction_type==="drag"?l.jsx(jt,{className:"mb-6",children:l.jsx("div",{ref:C,className:"relative w-full",children:l.jsx(n0,{width:k,height:ae,className:`border-2 border-gray-200 rounded-lg ${_e?"pointer-events-none opacity-50":""}`,children:l.jsxs(r0,{children:[f.leftWords.map((De,Ie)=>{const Ke=p[Ie]!==void 0,Je=K(De,R.LEFT_WORD,M),Ye=ie[Ie],Tt=Ye?Ye.y:W+Ie*Z;return l.jsxs(cc,{x:ee,y:Tt,draggable:!Ke,onDragStart:Nt=>{Nt.target.moveToTop()},onDragEnd:Nt=>{Nt.target.getStage();const Wt=f.rightWords,or=M+60,dr=H+30,Er=V-30,fr=W-15;console.log(" Drop detection - Word dropped at:",Nt.target.x(),Nt.target.y());for(let nr=0;nr<Wt.length;nr++){const me=ie[nr],Ne=me?me.y:fr+nr*Z,Fe=Er,Re=Er+or,bt=Ne,Pe=Ne+dr;if(console.log(` Checking drop zone ${nr}:`,{left:Fe,right:Re,top:bt,bottom:Pe,word:Wt[nr]}),Nt.target.x()>=Fe&&Nt.target.x()<=Re&&Nt.target.y()>=bt&&Nt.target.y()<=Pe){console.log(` Match found! Word "${f.leftWords[Ie]}" matched with "${Wt[nr]}"`),x(ze=>({...ze,[Ie]:nr}));break}}console.log(" No match found, resetting position"),Nt.target.position({x:ee,y:Tt})},children:[l.jsx(Ga,{width:M,height:Je,fill:Ke?"#e5e7eb":"#3b82f6",stroke:Ke?"#9ca3af":"#1d4ed8",strokeWidth:2,cornerRadius:8,opacity:Ke?.5:1}),l.jsx(qc,{text:De,x:M/2,y:Je/2,fontSize:R.LEFT_WORD,fontFamily:"Arial",fill:Ke?"#dc2626":"white",align:"center",verticalAlign:"middle",width:M,offsetX:M/2,offsetY:Je/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Ie}`)}),f.rightWords.map((De,Ie)=>{const Ke=K(De,R.ORIGINAL_WORD,M),Je=ie[Ie],Ye=Je?Je.y:W+Ie*Z,Tt=Object.keys(p).find(Nt=>p[Nt]===Ie);return l.jsxs(cc,{x:V,y:Ye,children:[l.jsx(Ga,{width:M,height:Ke,fill:Tt?"#10b981":"#f3f4f6",stroke:Tt?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8}),l.jsx(qc,{text:De,x:M/2,y:Ke/2,fontSize:R.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:M,offsetX:M/2,offsetY:Ke/2,wrap:"word",ellipsis:!0,listening:!1}),Tt&&l.jsx(qc,{text:f.leftWords[Tt],x:M/2,y:Ke/4,fontSize:R.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:M,offsetX:M/2,offsetY:Ke/8,wrap:"word",ellipsis:!0})]},`right-${Ie}`)})]})})})}):l.jsx(jt,{className:"mb-6",children:l.jsx("div",{ref:C,className:"relative w-full",children:l.jsx(n0,{width:k,height:ae,className:`border-2 border-gray-200 rounded-lg ${_e?"pointer-events-none opacity-50":""}`,children:l.jsxs(r0,{children:[f?.leftWords?.map((De,Ie)=>{const Ke=K(De,R.LEFT_WORD,M),Je=ie[Ie],Ye=Je?Je.y:W+Ie*Z,Tt=v?.side==="left"&&v?.index===Ie;return l.jsxs(cc,{x:ee,y:Ye,onClick:()=>lt("left",Ie),children:[l.jsx(Ga,{width:M,height:Ke,fill:Tt?"#3b82f6":"#f3f4f6",stroke:Tt?"#1d4ed8":"#d1d5db",strokeWidth:Tt?3:2,cornerRadius:8}),l.jsx(qc,{text:De,x:M/2,y:Ke/2,fontSize:R.LEFT_WORD,fontFamily:"Arial",fill:Tt?"white":"#374151",align:"center",verticalAlign:"middle",width:M,offsetX:M/2,offsetY:Ke/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Ie}`)}),f?.rightWords?.map((De,Ie)=>{const Ke=K(De,R.ORIGINAL_WORD,M),Je=ie[Ie],Ye=Je?Je.y:W+Ie*Z,Tt=v?.side==="right"&&v?.index===Ie;return l.jsxs(cc,{x:V,y:Ye,onClick:()=>lt("right",Ie),children:[l.jsx(Ga,{width:M,height:Ke,fill:Tt?"#3b82f6":"#f3f4f6",stroke:Tt?"#1d4ed8":"#d1d5db",strokeWidth:Tt?3:2,cornerRadius:8}),l.jsx(qc,{text:De,x:M/2,y:Ke/2,fontSize:R.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:M,offsetX:M/2,offsetY:Ke/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${Ie}`)}),le.map((De,Ie)=>{const Ke=f?.leftWords?.[De.startWord.index],Je=f?.rightWords?.[De.endWord.index],Ye=K(Ke,R.LEFT_WORD,M),Tt=K(Je,R.ORIGINAL_WORD,M),Nt=ie[De.startWord.index],Wt=ie[De.endWord.index],or=Nt?Nt.y+Ye/2:W+De.startWord.index*Z+Ye/2,dr=Wt?Wt.y+Tt/2:W+De.endWord.index*Z+Tt/2;return l.jsx(ui,{points:[ee+M+20,or,V-20,dr],stroke:De.color||"#3b82f6",strokeWidth:z,lineCap:"round",lineJoin:"round"},Ie)})]})})})}),l.jsx(jt,{children:l.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${_e?"pointer-events-none opacity-50":""}`,children:[l.jsx(Ze,{onClick:rt,variant:"outline",disabled:_e,children:"Reset"}),l.jsx(Ze,{onClick:()=>Ce(!0),disabled:_e,className:"px-8",children:_e?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm",color:"white",className:"mr-2"}),"Submitting..."]}):"Submit Test"})]})}),l.jsx(fa,{isOpen:Le&&!_e,onClose:()=>At(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>At(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:ht,variant:"primary",children:"Reset"})]})]})}),l.jsx(fa,{isOpen:et,onClose:()=>pt(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>pt(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:zt,variant:"primary",children:"Leave"})]})]})}),l.jsx(fa,{isOpen:pe,onClose:()=>Ce(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>Ce(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:()=>{Ce(!1),Dt()},variant:"primary",children:"Submit"})]})]})})]}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(Wr,{size:"lg"})})},fae=({id:e,x:t,y:r,width:n,height:s,text:a,fontSize:i,color:o,isSelected:c,onSelect:u,onUpdate:d,onDelete:f})=>{const[g,p]=S.useState(!1),x=S.useRef(!1),v=S.useRef(null),w=S.useRef({x:0,y:0}),C=S.useRef(null),k=5,_=()=>{x.current=!0,p(!0)},N=()=>{if(x.current=!1,p(!1),C.current)try{C.current.draggable(!1)}catch{}},E=()=>{v.current&&(clearTimeout(v.current),v.current=null)};S.useEffect(()=>()=>{E()},[]),S.useEffect(()=>{if(C.current)try{C.current.draggable(x.current)}catch{}},[g]);const P=A=>{A.cancelBubble=!0,d(e,{isEditing:!0})},F=A=>{d(e,{x:A.target.x(),y:A.target.y()})};return l.jsxs(cc,{ref:C,x:t,y:r,draggable:g,dragBoundFunc:A=>x.current?A:{x:t,y:r},name:"textbox-group",onClick:A=>{A.cancelBubble=!0,u(e)},onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblClick:P,onDblTap:P,onPointerDown:A=>{A.cancelBubble=!0;const j=A.evt||{};w.current={x:j.clientX??0,y:j.clientY??0},E(),v.current=setTimeout(()=>{_()},400)},onPointerMove:A=>{if(!v.current)return;const j=A.evt||{},I=Math.abs((j.clientX??0)-w.current.x),B=Math.abs((j.clientY??0)-w.current.y);(I>k||B>k)&&E()},onPointerUp:A=>{A.cancelBubble=!0,E(),N()},onPointerLeave:()=>{E(),N()},onDragEnd:A=>{F(A),N()},children:[l.jsx(Ga,{width:n,height:s,fill:c?"#fef3c7":"#ffffff",stroke:c?"#f59e0b":"#d1d5db",strokeWidth:c?2:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1},name:"textbox-rect",onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblTap:A=>{A.cancelBubble=!0,P(A)}}),l.jsx(qc,{text:a,width:n,height:s,padding:8,align:"left",verticalAlign:"top",fontSize:i,fill:o,wrap:"word",name:"textbox-text",onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblTap:A=>{A.cancelBubble=!0,P(A)}})]})},hae=({x:e,y:t,width:r,height:n,initialText:s,onSave:a,onCancel:i})=>{const o=S.useRef(null);S.useEffect(()=>{o.current&&(o.current.focus(),o.current.select())},[]);const c=u=>{u.key==="Enter"&&!u.shiftKey?(u.preventDefault(),a(o.current.value)):u.key==="Escape"&&i()};return l.jsx("textarea",{ref:o,defaultValue:s,style:{position:"absolute",top:t,left:e,width:r,height:n,fontSize:"14px",border:"2px solid #f59e0b",borderRadius:"6px",padding:"8px",background:"white",resize:"none",outline:"none",fontFamily:"inherit",lineHeight:"1.4",zIndex:1e3},onKeyDown:c,onBlur:()=>a(o.current.value)})},gae=({width:e,height:t,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:o,onZoomChange:c,isPanning:u,isFullscreen:d,constrainPanPosition:f,handleWheel:g,stageRef:p,setIsPanning:x,responsiveDimensions:v,canvasSize:w,question:C,textBoxes:k,setTextBoxes:_,selectedTextBox:N,setSelectedTextBox:E,handleTextBoxSelect:P,handleTextBoxUpdate:F,handleTextBoxDelete:A,isEditingText:j,editingTextBox:I,setIsEditingText:B,setEditingTextBox:Y,setCurrentTool:Z})=>{const[se,ee]=S.useState(!1),[te,L]=S.useState([]),[V,M]=S.useState(null),[H,W]=S.useState(null),R=S.useRef(null),[z,K]=S.useState(.25),[Q,ae]=S.useState({x:0,y:0}),X=S.useRef(null),ie=S.useRef(null),le=S.useRef(!1),ce=6;S.useEffect(()=>{const ke=()=>{const $e=R.current;if(!$e)return;const Be=$e.clientWidth||1,Et=$e.clientHeight||1,It=Math.min(Be/(w.width||1),Et/(w.height||1));K(Math.min(It,1))};return ke(),window.addEventListener("resize",ke),()=>window.removeEventListener("resize",ke)},[w.width,w.height,d]);const _e=ke=>{const $e=p.current,Be=$e.getPointerPosition();if(s==="pan"){if(Re(ke.target))try{$e.draggable(!1),le.current=!0}catch{}return}if(s==="text"){const It={x:(Be.x-$e.x())/$e.scaleX(),y:(Be.y-$e.y())/$e.scaleY()};X.current={...It},ie.current={x:Be.x,y:Be.y};return}ee(!0);const Et={x:(Be.x-$e.x())/$e.scaleX(),y:(Be.y-$e.y())/$e.scaleY()};W(Et),s==="pencil"?L([{x:Et.x,y:Et.y,color:a,thickness:i}]):s==="eraser"?L([{x:Et.x,y:Et.y,color:a,thickness:i,tool:"eraser"}]):["line","rectangle","circle"].includes(s)&&M({type:s,startX:Et.x,startY:Et.y,endX:Et.x,endY:Et.y,color:a,thickness:i})},ne=ke=>{const $e=p.current,Be=$e.getPointerPosition(),Et={x:(Be.x-$e.x())/$e.scaleX(),y:(Be.y-$e.y())/$e.scaleY()};if(ae(Et),s!=="pan"){if(s==="text"&&X.current&&ie.current){const It=Math.abs(Be.x-ie.current.x),Kt=Math.abs(Be.y-ie.current.y);(It>ce||Kt>ce)&&(X.current=null)}if(se)if(s==="pencil"){const It=[...te,{x:Et.x,y:Et.y,color:a,thickness:i}];L(It)}else if(s==="eraser"){const It=[...te,{x:Et.x,y:Et.y,color:a,thickness:i,tool:"eraser"}];L(It)}else["line","rectangle","circle"].includes(s)&&V&&M({...V,endX:Et.x,endY:Et.y})}},pe=ke=>{const $e=p.current;if(s==="pan"){if(le.current){try{$e.draggable(!0)}catch{}le.current=!1}return}if(s==="text"&&X.current){const Be=ke&&ke.target;if(Be&&typeof Be.name=="function"&&Be.name()==="canvas-bg"){const It={id:Date.now(),x:X.current.x,y:X.current.y,width:150,height:60,text:"Double-click to edit",fontSize:14,color:"#000000"};_(Kt=>[...Kt,It]),E(It.id)}X.current=null,ie.current=null}if(se){if(s==="pencil"){const Be=[...r,te];n(Be),L([])}else if(s==="eraser"){const Be=[...r,te];n(Be),L([])}else if(["line","rectangle","circle"].includes(s)&&V){const Be=[...r,V];n(Be),M(null)}ee(!1),W(null)}},[Ce,Ae]=S.useState(null),[Ge,Le]=S.useState(null),[At,et]=S.useState(!1),[pt,lt]=S.useState(null),[rt,ht]=S.useState(!1),[Lt,zt]=S.useState(!1),[Dt,De]=S.useState([]),[Ie,Ke]=S.useState(null),[Je,Ye]=S.useState({totalGestures:0,zoomGestures:0,panGestures:0,combinedGestures:0,averageResponseTime:0});let Tt=null;const Wt=(window.devicePixelRatio||1)>1.5,or={scaleDelta:Wt?.03:.04,centerDelta:Wt?4:6,minTouchDistance:8,gestureHysteresis:.02},dr=()=>{ht(!1),lt(null),Ae(null),Le(null),ee(!1),W(null),zt(!1),Ke(null),Tt&&(cancelAnimationFrame(Tt),Tt=null),p.current&&p.current.stop()},Er=ke=>{if(ke.length<2)return 0;const $e=ke[0],Be=ke[1];return Math.sqrt(Math.pow(Be.clientX-$e.clientX,2)+Math.pow(Be.clientY-$e.clientY,2))},fr=ke=>{if(ke.length<2)return null;const $e=ke[0],Be=ke[1];return{x:($e.clientX+Be.clientX)/2,y:($e.clientY+Be.clientY)/2}},nr=ke=>{De($e=>[...$e,{type:ke,timestamp:Date.now()}].slice(-5))},me=()=>{const ke=Date.now(),$e=Dt.filter(It=>ke-It.timestamp<500);if($e.length<2)return 0;const Be=$e[$e.length-1],Et=$e[$e.length-2];return Be.type===Et.type?or.gestureHysteresis:0},Ne=(ke,$e)=>{Ye(Be=>({totalGestures:Be.totalGestures+1,zoomGestures:ke.includes("zoom")?Be.zoomGestures+1:Be.zoomGestures,panGestures:ke.includes("pan")?Be.panGestures+1:Be.panGestures,combinedGestures:ke==="zoom+pan"?Be.combinedGestures+1:Be.combinedGestures,averageResponseTime:(Be.averageResponseTime+$e)/2}))},Fe=(ke,$e,Be,Et)=>{const It=p.current,Kt=It.scaleX(),wr=It.position();let lr=Kt,Fr=wr;if(ke){const xe=Be/Ce,he=Kt*xe,we=C?.max_canvas_width||1536,Se=C?.max_canvas_height||2048,He=we/w.width,ct=Se/w.height,qe=Math.min(He,ct,1);lr=Math.max(.25,Math.min(qe,he));const oe=Et,fe={x:(oe.x-It.x())/Kt,y:(oe.y-It.y())/Kt};Fr={x:oe.x-fe.x*lr,y:oe.y-fe.y*lr}}if($e){const xe=Et.x-Ge.x,he=Et.y-Ge.y;ke?Fr={x:Fr.x+xe,y:Fr.y+he}:Fr={x:wr.x+xe,y:wr.y+he}}Tt||(Tt=requestAnimationFrame(()=>{It.scale({x:lr,y:lr}),It.position(Fr),It.batchDraw(),Tt=null})),ke&&$e?(lt("zoom+pan"),zt(!0)):ke?(lt("zoom"),zt(!0)):$e&&lt("pan");const be=Date.now()-(Ie||Date.now());Ne(ke&&$e?"zoom+pan":ke?"zoom":"pan",be),console.log(" Combined gesture",{doZoom:ke,doPan:$e,scale:lr.toFixed(2),pos:Fr})},Re=ke=>{if(!ke||typeof ke.name!="function")return!1;if((ke.name()||"").includes("textbox-"))return!0;const Be=ke.getParent&&ke.getParent();return Be&&typeof Be.name=="function"&&(Be.name()||"").includes("textbox-")},bt=ke=>{const $e=ke.evt.touches,Be=ke.target;if(Re(Be)){if(s==="pan"&&p.current)try{p.current.draggable(!1),le.current=!0}catch{}return}$e.length===2?(ke.evt.preventDefault(),ht(!0),lt(null),Ae(Er($e)),Le(fr($e)),ee(!1),Ke(Date.now())):$e.length===1&&(ht(!1),lt(null),_e(ke))},Pe=ke=>{const $e=ke.evt.touches,Be=ke.target;if(!Re(Be))if($e.length===2&&rt){ke.evt.preventDefault();const Et=p.current,It=Er($e),Kt=fr($e);if(Ce&&Ge&&Et&&It>or.minTouchDistance){const wr=Math.abs(It/Ce-1),lr=Math.sqrt(Math.pow(Kt.x-Ge.x,2)+Math.pow(Kt.y-Ge.y,2)),Fr=me(),ue=or.scaleDelta-Fr,be=or.centerDelta-Fr*10,xe=wr>ue,he=lr>be;(xe||he)&&(Fe(xe,he,It,Kt),xe&&he?nr("zoom+pan"):xe?nr("zoom"):he&&nr("pan")),console.log(" Gesture Debug",{scaleDelta:wr.toFixed(3),centerDelta:lr.toFixed(1),doZoom:xe,doPan:he,hysteresis:Fr.toFixed(3),adjustedScaleDelta:ue.toFixed(3),adjustedCenterDelta:be.toFixed(1),gestureHistory:Dt.slice(-3)})}Ae(It),Le(Kt)}else $e.length===1&&!rt&&(ke.evt.preventDefault(),ne())},ze=ke=>{const $e=ke.evt.touches,Be=ke.target;Re(Be)||($e.length===0?(pe(ke),dr(),zt(!1)):$e.length===1&&(ht(!1),lt(null),Ae(null),Le(null),zt(!1)))};return l.jsx("div",{className:"relative w-full block sm:flex sm:justify-center",children:l.jsx("div",{className:"w-full max-w-full block sm:flex sm:justify-center",children:l.jsxs("div",{className:"relative",style:{border:d&&(v.width<window.innerWidth-40||v.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[l.jsx("div",{ref:R,className:"w-full h-full",style:{touchAction:"manipulation"},children:l.jsx(n0,{ref:p,width:v.width,height:v.height,scaleX:d?v.zoom:o,scaleY:d?v.zoom:o,onMouseDown:_e,onMousemove:ne,onMouseup:pe,onTouchStart:bt,onTouchMove:Pe,onTouchEnd:ze,onWheel:g||(()=>{}),onDragStart:()=>{console.log(" Drag started"),s==="pan"&&x(!0)},onDragEnd:()=>{if(console.log(" Drag ended"),s==="pan"&&(x(!1),f)){const ke=p.current,$e=R.current,Be=$e?.clientWidth||v.width,Et=$e?.clientHeight||v.height,It=w.width*ke.scaleX(),Kt=w.height*ke.scaleY(),wr=ke.x(),lr=ke.y();(wr>Be||wr<-It||lr>Et||lr<-Kt)&&f(ke)}},draggable:s==="pan"&&o>.25,className:`border-0 rounded-none shadow-none sm:border sm:rounded-lg sm:shadow-sm ${s==="pan"?"cursor-grab":u?"cursor-grabbing":"cursor-crosshair"}`,style:{width:"100%",height:"auto"},onLoad:()=>{console.log(" DrawingTestStudent - Stage loaded with dimensions:",v.width,"x",v.height),console.log(" DrawingTestStudent - Canvas size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Current zoom level:",o),console.log(" DrawingTestStudent - Effective display size:",Math.round(w.width*o),"x",Math.round(w.height*o)),console.log(" DrawingTestStudent - Total pixels displayed:",Math.round(w.width*o*w.height*o))},children:l.jsxs(r0,{children:[l.jsx(Ga,{x:0,y:0,width:w.width,height:w.height,fill:"white",name:"canvas-bg"}),r.map((ke,$e)=>{if(Array.isArray(ke)){const Be=ke[0]?.tool==="eraser";return l.jsx(ui,{points:ke.flatMap(Et=>[Et.x,Et.y]),stroke:Be?"black":ke[0]?.color||"#000000",strokeWidth:Be?(ke[0]?.thickness||2)*7:ke[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:Be?"destination-out":"source-over"},$e)}else{if(ke.type==="line")return l.jsx(ui,{points:[ke.startX,ke.startY,ke.endX,ke.endY],stroke:ke.color,strokeWidth:ke.thickness,lineCap:"round"},$e);if(ke.type==="rectangle"){const Be=Math.abs(ke.endX-ke.startX),Et=Math.abs(ke.endY-ke.startY),It=Math.min(ke.startX,ke.endX),Kt=Math.min(ke.startY,ke.endY);return l.jsx(Ga,{x:It,y:Kt,width:Be,height:Et,stroke:ke.color,strokeWidth:ke.thickness,fill:"transparent"},$e)}else if(ke.type==="circle"){const Be=Math.sqrt(Math.pow(ke.endX-ke.startX,2)+Math.pow(ke.endY-ke.startY,2))/2,Et=(ke.startX+ke.endX)/2,It=(ke.startY+ke.endY)/2;return l.jsx(wf,{x:Et,y:It,radius:Be,stroke:ke.color,strokeWidth:ke.thickness,fill:"transparent"},$e)}}return null}),k.map(ke=>l.jsx(fae,{...ke,isSelected:N===ke.id,onSelect:P,onUpdate:F,onDelete:A},ke.id)),s==="pencil"&&l.jsx(ui,{points:te.flatMap(ke=>[ke.x,ke.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),s==="eraser"&&l.jsx(ui,{points:te.flatMap(ke=>[ke.x,ke.y]),stroke:"black",strokeWidth:i*7,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:"destination-out"}),V&&V.type==="line"&&l.jsx(ui,{points:[V.startX,V.startY,V.endX,V.endY],stroke:V.color,strokeWidth:V.thickness,lineCap:"round"}),V&&V.type==="rectangle"&&l.jsx(Ga,{x:Math.min(V.startX,V.endX),y:Math.min(V.startY,V.endY),width:Math.abs(V.endX-V.startX),height:Math.abs(V.endY-V.startY),stroke:V.color,strokeWidth:V.thickness,fill:"transparent"}),V&&V.type==="circle"&&l.jsx(wf,{x:(V.startX+V.endX)/2,y:(V.startY+V.endY)/2,radius:Math.sqrt(Math.pow(V.endX-V.startX,2)+Math.pow(V.endY-V.startY,2))/2,stroke:V.color,strokeWidth:V.thickness,fill:"transparent"}),s==="eraser"&&l.jsx(wf,{x:Q.x,y:Q.y,radius:i*7/2,stroke:"#666666",strokeWidth:2,fill:"rgba(102, 102, 102, 0.2)",dash:[5,5],listening:!1}),s==="pencil"&&l.jsx(ui,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="line"&&l.jsx(ui,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="rectangle"&&l.jsx(ui,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="circle"&&l.jsx(ui,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1})]})})}),j&&I&&l.jsx(hae,{x:I.x,y:I.y,width:I.width,height:I.height,initialText:I.text,onSave:ke=>{F(I.id,{text:ke}),B(!1),Y(null)},onCancel:()=>{B(!1),Y(null)}}),l.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[l.jsx("button",{onClick:()=>{const ke=p.current,$e=ke.scaleX(),Be=C?.max_canvas_width||1536,Et=C?.max_canvas_height||2048,It=Be/w.width,Kt=Et/w.height,wr=Math.min(It,Kt,5),lr=Math.min(wr,ke.scaleX()*1.2);ke.scale({x:lr,y:lr}),ke.batchDraw(),console.log(" DrawingTestStudent - Zoom In button:",$e.toFixed(2),"->",lr.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*lr),"x",Math.round(w.height*lr)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*lr*w.height*lr),"pixels"),c(lr)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),l.jsx("button",{onClick:()=>{const ke=p.current,$e=ke.scaleX(),Be=Math.max(.25,ke.scaleX()*.8);ke.scale({x:Be,y:Be}),ke.batchDraw(),console.log(" DrawingTestStudent - Zoom Out button:",$e.toFixed(2),"->",Be.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*Be),"x",Math.round(w.height*Be)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*Be*w.height*Be),"pixels"),c(Be)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:""}),l.jsx("button",{onClick:()=>{const ke=p.current,$e=ke.scaleX();ke.scale({x:1,y:1}),ke.position({x:0,y:0}),ke.batchDraw(),console.log(" DrawingTestStudent - Reset zoom:",$e.toFixed(2),"-> 1.00"),console.log(" DrawingTestStudent - Reset effective size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Reset resolution:",w.width*w.height,"pixels"),c(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),l.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(o*100),"%"]})]})})})},mae=({content:e})=>{if(!e)return l.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const t=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(t).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(t).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const o=i.children?i.children.map(t).join(""):"";let c="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?c+=" text-align: center;":i.format==="right"?c+=" text-align: right;":i.format==="left"&&(c+=" text-align: left;")),`<li style="${c}">${o}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(t).join(""):""};let r=e;if(typeof e=="string"&&e.startsWith("{"))try{const n=JSON.parse(e);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(t).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return l.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},pae=({question:e,questionIndex:t,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{Aa();const[o,c]=S.useState([]),[u,d]=S.useState(!0),[f,g]=S.useState("pencil"),[p,x]=S.useState("#000000"),[v,w]=S.useState(2),[C,k]=S.useState([]),[_,N]=S.useState(-1),[E,P]=S.useState({width:600,height:800}),[F,A]=S.useState(1),[j,I]=S.useState(!1),[B,Y]=S.useState(!1),[Z,se]=S.useState(!1),[ee,te]=S.useState([]),[L,V]=S.useState(null),[M,H]=S.useState(!1),[W,R]=S.useState(null),z=_>0,K=_<C.length-1,[Q,ae]=S.useState(!1),X=S.useRef(null),ie=S.useRef(null),[le,ce]=S.useState({width:600,height:800}),_e=S.useRef(!1),[ne,pe]=S.useState(.25),Ce=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];S.useEffect(()=>{const De=()=>{se(window.innerWidth>=1024)};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[]),S.useEffect(()=>{if(e){const De=e.max_canvas_width||1536,Ie=e.max_canvas_height||2048,Ke=e.canvas_width||600,Je=e.canvas_height||800;if(P({width:De,height:Ie}),_e.current)console.log(" DrawingTestStudent - Preserving user zoom:",F.toFixed(2));else{A(1),_e.current=!0;const Tt=(Ke-De*1)/2,Nt=(Je-Ie*1)/2;if(!isNaN(Tt)&&!isNaN(Nt)&&X.current){const Wt={x:Tt,y:Nt};X.current.position(Wt),X.current.batchDraw()}console.log(" DrawingTestStudent - Canvas size set:",De,"x",Ie),console.log(" DrawingTestStudent - Viewport size:",Ke,"x",Je),console.log(" DrawingTestStudent - Initial zoom:",1 .toFixed(2)),console.log(" DrawingTestStudent - Image resolution:",De*Ie,"pixels"),console.log(" DrawingTestStudent - Aspect ratio:",(De/Ie).toFixed(2))}if(r&&typeof r=="string")try{const Ye=JSON.parse(r);Ye.lines?c(Ye.lines):c(Ye),Ye.textBoxes&&te(Ye.textBoxes)}catch{console.log("No valid drawing data found")}d(!1)}},[e,r]),S.useEffect(()=>{const De=()=>{const Ie=ie.current;if(!Ie)return;const Ke=Ie.clientWidth||1,Je=Ie.clientHeight||1,Ye=Math.min(Ke/(E.width||1),Je/(E.height||1));pe(Math.min(Ye,1))};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[E.width,E.height,Q]);const Ae=De=>{c(De);const Ie={lines:De,textBoxes:ee};n(e.question_id,JSON.stringify(Ie)),Ge(De,ee)},Ge=(De,Ie=ee)=>{const Ke=C.slice(0,_+1);Ke.push({lines:[...De],textBoxes:[...Ie]}),k(Ke),N(Ke.length-1)},Le=()=>{if(z){const De=_-1,Ie=C[De];if(Ie&&typeof Ie=="object"&&Ie.lines){c([...Ie.lines]),te([...Ie.textBoxes]);const Ke={lines:Ie.lines,textBoxes:Ie.textBoxes};n(e.question_id,JSON.stringify(Ke))}else{const Ke=Ie||[];c([...Ke]),n(e.question_id,JSON.stringify(Ke))}N(De)}},At=()=>{if(K){const De=_+1,Ie=C[De];if(Ie&&typeof Ie=="object"&&Ie.lines){c([...Ie.lines]),te([...Ie.textBoxes]);const Ke={lines:Ie.lines,textBoxes:Ie.textBoxes};n(e.question_id,JSON.stringify(Ke))}else{const Ke=Ie||[];c([...Ke]),n(e.question_id,JSON.stringify(Ke))}N(De)}},et=()=>{c([]),te([]),V(null),n(e.question_id,"")},pt=De=>{V(De)},lt=(De,Ie)=>{const Ke=ee.map(Ye=>Ye.id===De?{...Ye,...Ie}:Ye);te(Ke),Ge(o,Ke);const Je={lines:o,textBoxes:Ke};if(n(e.question_id,JSON.stringify(Je)),Ie.isEditing){const Ye=ee.find(Tt=>Tt.id===De);R(Ye),H(!0)}},rt=De=>{const Ie=ee.filter(Je=>Je.id!==De);te(Ie),L===De&&V(null),Ge(o,Ie);const Ke={lines:o,textBoxes:Ie};n(e.question_id,JSON.stringify(Ke))},ht=()=>{if(Q){const Ke=e?.canvas_width||600,Je=e?.canvas_height||800,Ye=window.innerWidth-40,Tt=window.innerHeight-40,Nt=Ye/Ke,Wt=Tt/Je,or=Math.min(Nt,Wt,1);return{width:Ke,height:Je,zoom:or}}const De=e?.canvas_width||600,Ie=e?.canvas_height||800;return{width:De,height:Ie,zoom:1}};S.useEffect(()=>{const De=()=>{ce(ht())};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[Q,E]);const Lt=De=>{De.evt.preventDefault();const Ie=X.current,Ke=Ie.scaleX(),Je=Ie.getPointerPosition(),Ye={x:(Je.x-Ie.x())/Ke,y:(Je.y-Ie.y())/Ke},Tt=De.evt.deltaY>0?Ke*.9:Ke*1.1,Nt=e?.max_canvas_width||1536,Wt=e?.max_canvas_height||2048,or=Nt/E.width,dr=Wt/E.height,Er=Math.min(or,dr,1),fr=Math.max(ne,Math.min(Er,Tt)),nr={x:Je.x-Ye.x*fr,y:Je.y-Ye.y*fr};if(fr<=ne&&ie.current){const me=ie.current.clientWidth||1,Ne=ie.current.clientHeight||1;nr.x=(me-E.width*fr)/2,nr.y=(Ne-E.height*fr)/2}Ie.scale({x:fr,y:fr}),Ie.position(nr),Ie.batchDraw(),console.log(" DrawingTestStudent - Wheel zoom:",Ke.toFixed(2),"->",fr.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(E.width*fr),"x",Math.round(E.height*fr)),console.log(" DrawingTestStudent - New resolution:",Math.round(E.width*fr*E.height*fr),"pixels"),A(fr),_e.current=!0},zt=De=>{const Ie=De.scaleX(),Ke=ie.current,Je=Ke?.clientWidth||le.width,Ye=Ke?.clientHeight||le.height,Tt=E.width*Ie,Nt=E.height*Ie;if(Ie<=ne){const Fe=(Je-Tt)/2,Re=(Ye-Nt)/2;De.position({x:Fe,y:Re}),De.batchDraw();return}if(Tt<=Je&&Nt<=Ye){const Fe=(Je-Tt)/2,Re=(Ye-Nt)/2;De.position({x:Fe,y:Re}),De.batchDraw();return}const Wt=Math.max(0,Tt-Je),or=Math.max(0,Nt-Ye),dr=-Wt,Er=-or,fr=De.x(),nr=De.y(),me=Math.max(dr,Math.min(Wt,fr)),Ne=Math.max(Er,Math.min(or,nr));(me!==fr||Ne!==nr)&&(De.position({x:me,y:Ne}),De.batchDraw())},Dt=()=>{if(Q)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const De=ie.current;De&&(De.requestFullscreen?De.requestFullscreen():De.webkitRequestFullscreen?De.webkitRequestFullscreen():De.msRequestFullscreen&&De.msRequestFullscreen())}};return S.useEffect(()=>{const De=()=>{ae(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",De),document.addEventListener("webkitfullscreenchange",De),document.addEventListener("msfullscreenchange",De),()=>{document.removeEventListener("fullscreenchange",De),document.removeEventListener("webkitfullscreenchange",De),document.removeEventListener("msfullscreenchange",De)}},[]),S.useEffect(()=>()=>{X.current&&X.current.stop()},[]),u?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx(Wr,{})}):e?l.jsxs("div",{className:`drawing-question w-full max-w-full mx-0 p-0 sm:p-2 ${Q?"fixed inset-0 z-50 bg-white overflow-y-auto":""}`,children:[!Q&&l.jsx("div",{className:"mb-4",children:l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",t+1]})}),!Q&&e.question_json&&e.question_json.trim()&&l.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[l.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),l.jsx("div",{className:"text-gray-700",children:l.jsx(mae,{content:e.question_json})})]}),!Q&&l.jsx(jt,{className:"p-1 sm:p-2 mb-2",children:l.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"hidden sm:block text-sm text-gray-700",children:"Tool:"}),l.jsxs("div",{className:"flex flex-nowrap sm:flex-wrap gap-1 overflow-x-auto",children:[l.jsx("button",{onClick:()=>g("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:""}),l.jsx("button",{onClick:()=>g("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:""}),l.jsx("button",{onClick:()=>g("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:""}),l.jsx("button",{onClick:()=>g("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:""}),l.jsx("button",{onClick:()=>g("eraser"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="eraser"?"bg-red-500 text-white border-red-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Eraser",children:""}),l.jsx("button",{onClick:()=>g("text"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="text"?"bg-green-500 text-white border-green-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Text Box",children:""}),l.jsx("button",{onClick:()=>g("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:""})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"History:"}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:Le,disabled:!z,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${z?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:""}),l.jsx("button",{onClick:At,disabled:!K,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${K?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:""})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>I(!j),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[l.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:p}}),l.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),j&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:l.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:Ce.map(De=>l.jsx("button",{onClick:()=>{x(De),I(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${p===De?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:De},title:De},De))})})]}),l.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[l.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),l.jsx("input",{type:"range",min:"1",max:"10",value:v,onChange:De=>w(parseInt(De.target.value)),className:"w-16 sm:w-20"}),l.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[v,"px"]})]}),l.jsx(Ze,{onClick:et,variant:"secondary",size:"sm",children:"Clear"})]})}),l.jsx(jt,{paddingClass:"p-0 sm:p-2",children:l.jsxs("div",{ref:ie,className:"w-full drawing-canvas-container relative p-0 m-0",children:[l.jsx(gae,{width:E.width,height:E.height,lines:o,onDrawingChange:Ae,currentTool:f,currentColor:p,currentThickness:v,zoom:F,onZoomChange:A,isPanning:B,isFullscreen:Q,constrainPanPosition:zt,handleWheel:Lt,stageRef:X,setIsPanning:Y,responsiveDimensions:le,canvasSize:E,question:e,textBoxes:ee,setTextBoxes:te,selectedTextBox:L,setSelectedTextBox:V,handleTextBoxSelect:pt,handleTextBoxUpdate:lt,handleTextBoxDelete:rt,isEditingText:M,editingTextBox:W,setIsEditingText:H,setEditingTextBox:R,setCurrentTool:g}),l.jsx("button",{onClick:Dt,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:Q?"Exit Fullscreen":"Enter Fullscreen",children:Q?l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},bk={enhanceUserData(e,t){const r={id:e.id||e.student_id||e.teacher_id,username:e.username||e.student_id,name:e.name||e.first_name,surname:e.surname||e.last_name,nickname:e.nickname,role:t,is_active:e.is_active!==void 0?e.is_active:!0,created_at:e.created_at,updated_at:e.updated_at};switch(t){case"student":return{...r,student_id:e.student_id,grade:e.grade,class:e.class,number:e.number,subjects:e.subjects||[]};case"teacher":return{...r,teacher_id:e.teacher_id,first_name:e.first_name,last_name:e.last_name,email:e.email,phone:e.phone,subjects:e.subjects||[]};case"admin":return{...r,admin_id:e.admin_id,permissions:e.permissions||["all"]};default:return r}},async studentLogin(e){console.log("Trying student login...");try{const t=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:e.username,password:e.password})}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:t};throw new Error(r.message||"Student login failed")}catch(t){throw console.error("Student login error:",t),new Error(t.message||"Student login failed")}},async teacherLogin(e){console.log("Trying teacher login...");try{const t=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:t};throw new Error(r.message||"Teacher login failed")}catch(t){throw console.error("Teacher login error:",t),new Error(t.message||"Teacher login failed")}},async adminLogin(e){console.log("Trying admin login...");try{const t=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:t};throw new Error(r.message||"Admin login failed")}catch(t){throw console.error("Admin login error:",t),new Error(t.message||"Admin login failed")}},async login(e){const{username:t,password:r}=e;console.log("Attempting login with:",t,r);try{if(t==="admin"){const o=await this.adminLogin(e),c=await o.json();return await this.handleLoginResponse(o,"admin",c)}const n=await this.teacherLogin(e),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(e),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(e,t,r){if(e.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,t),{success:!0,data:r,role:t}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(e,t){console.log(`Handling post-login actions for role: ${t}`);try{switch(t){case"student":e.student&&(this.populateStudentInfo(e.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":e.teacher&&(this.populateTeacherInfo(e.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":e.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${t}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const e=document.getElementById("unifiedLoginForm");if(e){e.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=e.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),e.classList.remove("test-submitting","disabled"),e.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log(" Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log(" Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(e){return console.error("Logout error:",e),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log(" Interface reset to login state")}catch(e){console.error("Error resetting interface:",e),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(e){try{return{success:!0,message:(await js.post("/auth/change-password",{currentPassword:e.currentPassword,newPassword:e.newPassword,confirmPassword:e.confirmPassword})).data.message}}catch(t){throw new Error(t.response?.data?.message||"Password change failed")}},async verifyToken(e){try{const t=await js.get("/auth/verify",{headers:{Authorization:`Bearer ${e}`}});return{success:!0,valid:t.data.valid,user:t.data.user}}catch(t){return{success:!1,valid:!1,error:t.message}}},async refreshToken(e){try{const t=await js.post("/auth/refresh",{refreshToken:e});return{success:!0,token:t.data.token,refreshToken:t.data.refreshToken}}catch(t){throw new Error(t.response?.data?.message||"Token refresh failed")}},async getUserProfile(){try{return{success:!0,user:(await js.get("/auth/profile")).data.user}}catch(e){throw new Error(e.response?.data?.message||"Failed to get user profile")}},async updateUserProfile(e){try{return{success:!0,user:(await js.put("/auth/profile",e)).data.user}}catch(t){throw new Error(t.response?.data?.message||"Failed to update user profile")}},populateStudentInfo(e){console.log("=== populateStudentInfo called ==="),console.log("Student object:",e);const t=document.getElementById("studentName");if(t){const s=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=e?.grade||"",console.log("Set student grade to:",e?.grade));const n=document.getElementById("studentClass");n&&(n.textContent=e?.class||"",console.log("Set student class to:",e?.class)),console.log("Student info populated successfully")},populateTeacherInfo(e){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",e);const t=document.getElementById("teacherName");if(t){const n=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=e?.username||"",console.log("Set teacher username to:",e?.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.sub?e.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${e.sub}`),e.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${e.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher ID from JWT:",e),null}},getCurrentAdmin(){const e=window.tokenManager?.getToken();if(!e)return null;const t=window.tokenManager.decodeToken(e);if(!t||t.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:t.sub,username:t.username,role:t.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.username?(console.log(`[DEBUG] Found teacher username from JWT: ${e.username}`),e.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher username from JWT:",e),null}},isAdmin(){try{const e=window.tokenManager?.getToken();if(!e)return!1;const t=window.tokenManager.decodeToken(e);return t&&t.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const e=this.getCurrentAdmin();return e?e.id:null}catch(e){return console.error("[ERROR] Error getting admin ID:",e),null}}},xae=()=>{const e=Po(),{login:t,setUserData:r,isAuthenticated:n,user:s}=ds(),[a,i]=S.useState({username:"",password:""}),[o,c]=S.useState(!1),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,x]=S.useState(!1);S.useEffect(()=>{v()},[]);const v=S.useCallback(async()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager)if(await window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const Y=await window.tokenManager.getAccessToken(),Z=window.tokenManager.decodeToken(Y);Z&&Z.role?console.log("User role from JWT:",Z.role):console.log("No valid role found in JWT, showing login")}catch(Y){console.error("Error decoding JWT token:",Y)}}else console.log("No valid JWT session found, showing login");else console.log("No tokenManager found, showing login")},[]),w=S.useCallback(async B=>{if(B.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),A("Please wait for the logout process to complete.","warning");return}const{username:Y,password:Z}=a;if(!Y||!Z){d("Please enter both username and password");return}c(!0),d("");try{let se,ee;Y==="admin"?(se=await bk.adminLogin({username:Y,password:Z}),ee=no.ADMIN):/^\d+$/.test(Y)?(se=await bk.studentLogin({username:Y,password:Z}),ee=no.STUDENT):(se=await bk.teacherLogin({username:Y,password:Z}),ee=no.TEACHER);let te,L;if(se.response?(te=se,L=se.response):(te=await se.json(),L=se),await C(L,ee,te)){A("Login successful!","success");try{if("credentials"in navigator&&window.PasswordCredential&&a?.username&&a?.password){const V=new window.PasswordCredential({id:String(a.username),password:String(a.password)});await navigator.credentials.store(V)}}catch{}try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(se){console.error("Login error:",se),d("Invalid username or password")}finally{c(!1)}},[a]),C=S.useCallback(async(B,Y,Z)=>{if(B.ok&&Z.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),P(),!1;try{Z.token&&(window.tokenManager.setTokens(Z.token,Y),Z.refreshToken&&window.tokenManager.setRefreshToken(Z.refreshToken),console.log("JWT token stored successfully"));const se={...Z.data,...Z,role:Y};return r(se),await k(se),!0}catch(se){return console.error("Error handling login response:",se),P(se),!1}}else return console.error("Login failed:",Z.error||"Unknown error"),d(Z.error||"Login failed. Please check your credentials."),!1},[t]),k=S.useCallback(async B=>{if(console.log("Handling post-login actions for role:",B.role),p){console.log(" Post-login already handled, skipping");return}x(!0);try{switch(B.role){case no.STUDENT:await _(B),e("/student");break;case no.TEACHER:await N(B),e("/teacher");break;case no.ADMIN:await E(B),e("/admin");break;default:console.error("Unknown user role:",B.role),P()}}catch(Y){console.error("Error in post-login actions:",Y),P(Y)}},[e,p]);S.useEffect(()=>{n||x(!1)},[n]);const _=S.useCallback(async B=>{console.log("Populating student info:",B)},[]),N=S.useCallback(async B=>{console.log("Populating teacher info:",B)},[]),E=S.useCallback(async B=>{console.log("Populating admin info:",B)},[]),P=S.useCallback((B=null)=>{console.error("Login failure:",B),d("Login failed. Please check your credentials and try again."),F()},[]),F=S.useCallback(()=>{i({username:"",password:""}),d(""),c(!1)},[]),A=S.useCallback((B,Y)=>{const Z={id:Date.now(),message:B,type:Y,timestamp:new Date};g(se=>[...se,Z]),setTimeout(()=>{g(se=>se.filter(ee=>ee.id!==Z.id))},P0.NOTIFICATION_DURATION)},[]),j=S.useCallback(B=>{const{name:Y,value:Z}=B.target;i(se=>({...se,[Y]:Z})),u&&d("")},[u]),I=S.useCallback(B=>{B.key==="Enter"&&!o&&w(B)},[w,o]);return l.jsxs(at.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsxs(at.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsxs(at.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx(at.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:l.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-16 w-16 object-contain"})}),l.jsx(at.h1,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"Mathayom Watsing School"}),l.jsx(at.p,{className:"text-lg text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:"Test Management System"})]}),l.jsxs(at.div,{className:"bg-white rounded-xl shadow-2xl p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[l.jsx(at.h2,{className:"text-2xl font-semibold text-gray-900 text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"Login"}),l.jsxs("form",{onSubmit:w,className:"space-y-6",children:[l.jsxs(at.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[l.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),l.jsx(at.input,{type:"text",id:"username",name:"username",value:a.username,onChange:j,onKeyDown:I,placeholder:"Enter your username",required:!0,autoComplete:"username",autoCapitalize:"none",spellCheck:!1,disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),l.jsxs(at.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsx(at.input,{type:"password",id:"password",name:"password",value:a.password,onChange:j,onKeyDown:I,placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),l.jsx(ko,{children:u&&l.jsx(at.div,{id:"error-message",className:"bg-red-50 border border-red-200 rounded-lg p-3",role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:l.jsx("p",{className:"text-sm text-red-600",children:u})})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:l.jsx(Ze,{type:"submit",variant:"primary",size:"lg",disabled:o,className:"w-full",children:o?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm",className:"mr-2"}),"Logging in..."]}):"Login"})})]})]})]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:l.jsx(ko,{children:f.map(B=>l.jsx(at.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:l.jsx(mc,{type:B.type,message:B.message,onClose:()=>g(Y=>Y.filter(Z=>Z.id!==B.id))})},B.id))})})]})},ms={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(t.success)return console.log("Student data loaded successfully:",t.subjects),t.subjects;throw new Error(t.error||"Failed to load student data")}catch(e){throw console.error("Error loading student data:",e),e}},getStudentSubjects(e){return console.log("getStudentSubjects called with subjects:",e),e.map(t=>({id:t.id||t.subject_id,name:t.subject,grade:t.grade,class:t.class,testResults:t.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const e=await this.getCurrentTeacherId();if(!e)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:e,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(e){throw console.error("Error loading teacher data:",e),e}},getTeacherSubjects(e){return console.log("getTeacherSubjects called with subjects:",e),e.map(t=>{let r=[];return t.classes&&Array.isArray(t.classes)&&(r=t.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:t.subject_id,name:t.subject,classes:r,assignments:t.assignments||[],description:t.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(t=>({id:t,name:t,classes:this.generateClassButtons(t)}))},generateClassButtons(e){const t=[];for(let r=1;r<=10;r++)t.push({id:`${e}_${r}`,name:`${e}/${r}`,grade:e,class:r});return t},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[t,r,n]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAllUsers()]);return{teachers:t.status==="fulfilled"?t.value:[],subjects:r.status==="fulfilled"?r.value:[],users:n.status==="fulfilled"?n.value:[],loadedAt:new Date().toISOString()}}catch(e){throw console.error("Error loading admin data:",e),e}},async saveTeacherSubjects(e){console.log("saveTeacherSubjects called with subjects:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:e})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(t){throw console.error("Error saving teacher subjects:",t),t}},async deleteTeacherSubject(e){console.log("deleteTeacherSubject called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/delete-teacher-subject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher subject assignment deleted successfully"),r;throw new Error(r.error||"Failed to delete teacher subject assignment")}catch(t){throw console.error("Error deleting teacher subject assignment:",t),t}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("Subjects dropdown data loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(t.error||"Failed to load subjects dropdown")}catch(e){throw console.error("Error loading subjects dropdown:",e),e}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(t.success)return console.log("Grades and classes loaded successfully"),t.data;throw new Error(t.message||"Failed to load grades and classes")}catch(e){throw console.error("Error loading grades and classes:",e),e}},async saveSubjectClasses(e,t){console.log("saveSubjectClasses called with subjectId:",e,"classes:",t);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:e,classes:t})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("All subjects loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all subjects")}catch(e){throw console.error("Error loading all subjects:",e),e}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(t.success)return console.log("Subjects for selection loaded successfully"),t.subjects;throw new Error(t.message||"Failed to load subjects for selection")}catch(e){throw console.error("Error loading subjects for selection:",e),e}},async addAcademicYear(e){console.log("addAcademicYear called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(t){throw console.error("Error adding academic year:",t),t}},async getAllUsers(){console.log("getAllUsers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(t.success)return console.log("All users loaded successfully"),t.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all users")}catch(e){throw console.error("Error loading all users:",e),e}},async getAllTeachers(){console.log("getAllTeachers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(t.success)return console.log("All teachers loaded successfully"),t.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all teachers")}catch(e){throw console.error("Error loading all teachers:",e),e}},async createUser(e){console.log("createUser called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(t){throw console.error("Error creating user:",t),t}},async updateUser(e,t){console.log("updateUser called with userId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(e){console.log("createTeacher called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(t){throw console.error("Error creating teacher:",t),t}},async updateTeacher(e,t){console.log("updateTeacher called with teacherId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(e){console.log("updateStudentInfo called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(t){throw console.error("Error updating student info:",t),t}},async changePassword(e){console.log("changePassword called");let t;if(e.studentId)t="/.netlify/functions/change-student-password";else if(e.username)t="/.netlify/functions/change-teacher-password";else throw new Error("Invalid password data: missing studentId or username");try{const n=await(await window.tokenManager.makeAuthenticatedRequest(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Password changed successfully"),n;throw new Error(n.error||"Failed to change password")}catch(r){throw console.error("Error changing password:",r),r}},async getCurrentTeacherId(){try{const{SecureToken:e}=await mi(async()=>{const{SecureToken:n}=await Promise.resolve().then(()=>n5);return{SecureToken:n}},void 0),t=await(window.tokenManager?.getToken()||e.get())||localStorage.getItem("accessToken");if(!t)return null;const r=JSON.parse(atob(t.split(".")[1]));return r.teacher_id||r.sub||null}catch(e){return console.error("Error getting current teacher ID:",e),null}},async getCurrentAdminId(){try{const{SecureToken:e}=await mi(async()=>{const{SecureToken:n}=await Promise.resolve().then(()=>n5);return{SecureToken:n}},void 0),t=await(window.tokenManager?.getToken()||e.get())||localStorage.getItem("accessToken");if(!t)return null;const r=JSON.parse(atob(t.split(".")[1]));return r.admin_id||r.sub||null}catch(e){return console.error("Error getting current admin ID:",e),null}}},DB=S.createContext(),IB=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState([]),[a,i]=S.useState([]),[o,c]=S.useState([]),[u,d]=S.useState([]),[f,g]=S.useState([]),[p,x]=S.useState([]),[v,w]=S.useState([]),[C,k]=S.useState(!1),[_,N]=S.useState(null),[E,P]=S.useState(!1),[F,A]=S.useState(!1),[j,I]=S.useState(!1),[B,Y]=S.useState(null),[Z,se]=S.useState(null),[ee,te]=S.useState(null),L=S.useCallback(async()=>{try{k(!0),N(null);const Ne=`student_subjects_${t?.student_id||t?.id||""}`;console.log(" UserContext: Checking cache for key:",Ne);const Fe=Bs(Ne);if(Fe){console.log(" UserContext: Cache HIT! Using cached student data"),s(Fe),V(Fe);return}console.log(" UserContext: Cache MISS! Fetching from API");const Re=await ms.getStudentData();if(Re)s(Re),V(Re),console.log(" UserContext: Caching student data with key:",Ne),_s(Ne,Re,Ls.student_subjects);else throw new Error("No subjects data received")}catch(me){N(me.message||"Failed to load student data"),console.error("Error loading student data:",me)}finally{k(!1)}},[t?.student_id,t?.id]),V=me=>{console.log("Displaying student subjects:",me),s(me)},M=S.useCallback(async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),N("No valid teacher session found");return}const Ne=`teacher_subjects_${t?.teacher_id||t?.id||""}`,Fe=Bs(Ne);if(Fe){s(Fe),Fe.length===0?Wt():H(Fe);return}const Re=await ms.getTeacherSubjects();if(Re.success)s(Re.subjects),_s(Ne,Re.subjects,Ls.teacher_subjects),Re.subjects.length===0?Wt():H(Re.subjects);else throw new Error(Re.message||"Failed to load teacher data")}catch(me){N(me.message||"Failed to load teacher data"),console.error("Error loading teacher data:",me)}finally{k(!1)}},[t?.teacher_id,t?.id]),H=me=>{console.log("Showing main cabinet with subjects:",me),s(me)},W=me=>{console.log("Displaying grade buttons:",me),c(me)},R=async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),N("No valid admin session found");return}await Promise.all([pe(),lt(),ae()])}catch(me){N(me.message||"Failed to load admin data"),console.error("Error loading admin data:",me)}finally{k(!1)}},z=me=>{console.log(" populateStudentInfoDirectly called with:",me);try{r(me),console.log(" Set student profile:",me)}catch(Ne){console.error("Error populating student info:",Ne)}},K=me=>{console.log("=== populateStudentInfo called ==="),r(me)},Q=me=>{console.log("=== populateTeacherInfo called ==="),r(me)},ae=S.useCallback(async()=>{try{k(!0);const me="admin_users_",Ne=Bs(me);if(Ne){d(Ne),X(Ne);return}const Fe=await ms.getAllUsers();if(Fe.success)d(Fe.users),X(Fe.users),_s(me,Fe.users,Ls.admin_users);else throw new Error(Fe.message||"Failed to load users")}catch(me){N(me.message||"Failed to load users"),console.error("Error loading users:",me)}finally{k(!1)}},[]),X=me=>{console.log("Displaying all users:",me),d(me)},ie=(me,Ne)=>{console.log("Displaying users table:",me,Ne),d(me)},le=()=>{console.log("Toggling users content")},ce=()=>{console.log("Showing add user form"),P(!0)},_e=()=>{console.log("Hiding add user form"),P(!1)},ne=me=>{console.log("Editing user row:",me);const Ne=u.find(Fe=>Fe.id===me);Y(Ne)},pe=S.useCallback(async()=>{try{const me="admin_teachers_",Ne=Bs(me);if(Ne){g(Ne),Ce(Ne);return}const Fe=await ms.getAllTeachers();if(Fe.success)g(Fe.teachers),Ce(Fe.teachers),_s(me,Fe.teachers,Ls.admin_teachers);else throw new Error(Fe.message||"Failed to load teachers")}catch(me){N(me.message||"Failed to load teachers"),console.error("Error loading teachers:",me)}},[]),Ce=me=>{console.log("Displaying all teachers:",me),g(me)},Ae=(me,Ne)=>{console.log("Displaying teachers table:",me,Ne),g(me)},Ge=()=>{console.log("Toggling teachers content")},Le=()=>{console.log("Showing add teacher form"),A(!0)},At=()=>{console.log("Hiding add teacher form"),A(!1)},et=me=>{console.log("Editing teacher:",me);const Ne=f.find(Fe=>Fe.id===me);se(Ne)},pt=me=>{console.log("Editing teacher row:",me);const Ne=f.find(Fe=>Fe.id===me);se(Ne)},lt=S.useCallback(async()=>{try{const me="admin_subjects_",Ne=Bs(me);if(Ne){x(Ne),rt(Ne);return}const Fe=await ms.getAllSubjects();if(Fe.success)x(Fe.subjects),rt(Fe.subjects),_s(me,Fe.subjects,Ls.admin_subjects);else throw new Error(Fe.message||"Failed to load subjects")}catch(me){N(me.message||"Failed to load subjects"),console.error("Error loading subjects:",me)}},[]),rt=me=>{console.log("Displaying all subjects:",me),x(me)},ht=(me,Ne)=>{console.log("Displaying subjects table:",me,Ne),x(me)},Lt=()=>{console.log("Toggling subjects content")},zt=()=>{console.log("Showing add subject form"),I(!0)},Dt=()=>{console.log("Hiding add subject form"),I(!1)},De=me=>{console.log("Editing subject row:",me);const Ne=p.find(Fe=>Fe.id===me);te(Ne)},Ie=me=>{console.log("Displaying academic year:",me),w(me)},Ke=()=>{console.log("Showing add academic year form")},Je=()=>{console.log("Hiding add academic year form")},Ye=me=>{console.log("Handling add academic year:",me)},Tt=()=>{console.log("Toggling academic year content")},Nt=()=>{console.log("Showing academic year editor")},Wt=()=>{console.log("Showing subject selection")},or=()=>{console.log("Showing main cabinet")},dr=me=>{r(Ne=>({...Ne,...me}))},Er=()=>{r(null),s([]),i([]),c([]),d([]),g([]),x([]),w([]),N(null)},fr=S.useCallback(me=>{Er(),me&&vN(me)},[]),nr={userProfile:t,userSubjects:n,userClasses:a,userGrades:o,allUsers:u,allTeachers:f,allSubjects:p,academicYears:v,isLoading:C,error:_,showUserForm:E,showTeacherForm:F,showSubjectForm:j,editingUser:B,editingTeacher:Z,editingSubject:ee,loadStudentData:L,displayStudentSubjects:V,populateStudentInfoDirectly:z,populateStudentInfo:K,loadTeacherData:M,showMainCabinetWithSubjects:H,displayGradeButtons:W,populateTeacherInfo:Q,showSubjectSelection:Wt,showMainCabinet:or,loadAdminData:R,getAllUsers:ae,displayAllUsers:X,displayUsersTable:ie,toggleUsersContent:le,showAddUserForm:ce,hideAddUserForm:_e,editUserRow:ne,loadAllTeachers:pe,displayAllTeachers:Ce,displayTeachersTable:Ae,toggleTeachersContent:Ge,showAddTeacherForm:Le,hideAddTeacherForm:At,editTeacher:et,editTeacherRow:pt,loadAllSubjects:lt,displayAllSubjects:rt,displaySubjectsTable:ht,toggleSubjectsContent:Lt,showAddSubjectForm:zt,hideAddSubjectForm:Dt,editSubjectRow:De,displayAcademicYear:Ie,showAddAcademicYearForm:Ke,hideAddAcademicYearForm:Je,handleAddAcademicYear:Ye,toggleAcademicYearContent:Tt,showAcademicYearEditor:Nt,updateUserProfile:dr,clearUserData:Er,clearUserDataWithCache:fr,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:c,setAllUsers:d,setAllTeachers:g,setAllSubjects:x,setAcademicYears:w,setError:N};return l.jsx(DB.Provider,{value:nr,children:e})},o2=()=>{const e=S.useContext(DB);if(!e)throw new Error("useUser must be used within a UserProvider");return e},Jx={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",UPDATE_SPEAKING_TEST_SCORE:"/.netlify/functions/update-speaking-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},In={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing",FILL_BLANKS:"fill_blanks"},no={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(e,t)=>t+1);const P0={NOTIFICATION_DURATION:3e3},kf=(e,t,r)=>{if(!e||!Array.isArray(e)||e.length===0)return{score:0,total:0,percentage:0};let n=0;return e.forEach((s,a)=>{const i=Array.isArray(t)?t[a]:t[String(s.question_id||s.id||a)];i!=null&&Cm(s,i,r)&&n++}),{score:n,total:e.length,percentage:Math.round(n/e.length*100)}},tv=(e,t)=>{console.log(" Getting correct answer for question:",e,"testType:",t);let r="";switch(t){case In.TRUE_FALSE:r=e.correct_answer?"true":"false",console.log(" TRUE_FALSE correct_answer from question:",r,typeof r);break;case In.MULTIPLE_CHOICE:const n=e.correct_answer.charCodeAt(0)-65,s=`option_${String.fromCharCode(97+n)}`,a=e[s];a?r=a:r=`Option ${e.correct_answer}`;break;case In.INPUT:e.correct_answers&&Array.isArray(e.correct_answers)?r=e.correct_answers.join(", "):r=e.correct_answer||"Unknown";break;case In.MATCHING:r=e.correct_answer||e.answer;break;case In.WORD_MATCHING:r=e.correct_answer||e.answer;break;case In.DRAWING:r="Drawing required";break;case In.FILL_BLANKS:e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?r=e.correct_answers[0]:r=e.correct_answer||"Unknown";break;default:r="Unknown"}return console.log(" Correct answer:",r),r},Cm=(e,t,r)=>{if(console.log("[DEBUG] checkAnswerCorrectness called for question:",e,"studentAnswer:",t,"testType:",r),!t||t==="")return console.log("[DEBUG] No student answer provided"),!1;let n=!1;switch(r){case In.TRUE_FALSE:n=t.toLowerCase()==="true"===e.correct_answer;break;case In.MULTIPLE_CHOICE:let a="";if(typeof t=="string"){const o=t.trim();if(/^[a-z]$/i.test(o))a=o.toUpperCase();else if(/^\d+$/.test(o)){const c=parseInt(o,10),u=c>=0?c:NaN;Number.isNaN(u)||(a=String.fromCharCode(65+u))}}else if(typeof t=="number"){const o=t;Number.isNaN(o)||(a=String.fromCharCode(65+o))}n=a!==""&&a===String(e.correct_answer||"").toUpperCase();break;case In.INPUT:if(e.correct_answers&&Array.isArray(e.correct_answers)){const o=t.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();n=e.correct_answers.some(c=>{const u=c.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();return o===u?!0:u&&o.includes(u)?u.length===1?o.startsWith(u)||o.endsWith(u):!0:!1})}else{const o=t.toLowerCase().trim(),c=e.correct_answer.toLowerCase().trim();o===c?n=!0:c&&o.includes(c)?c.length===1?n=o.startsWith(c)||o.endsWith(c):n=!0:n=!1}break;case In.MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case In.WORD_MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case In.DRAWING:console.warn("Drawing tests should not be auto-scored!"),n=!1;break;case In.FILL_BLANKS:const i=e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?e.correct_answers[0]:e.correct_answer;if(i&&t){let o="";if(typeof t=="string"){const c=t.trim();if(/^[a-z]$/i.test(c))o=c.toUpperCase();else if(/^\d+$/.test(c)){const u=parseInt(c,10),d=u>=0?u:NaN;Number.isNaN(d)||(o=String.fromCharCode(65+d))}}else if(typeof t=="number"){const c=t;Number.isNaN(c)||(o=String.fromCharCode(65+c))}n=o!==""&&o===String(i||"").toUpperCase()}break;default:console.warn(`[WARN] Unknown test type for answer checking: ${r}`),n=!1}return console.log(`[DEBUG] Answer correctness: ${n}`),n};class yae{constructor(){this.academicCalendar=null,this.loaded=!1}async loadAcademicCalendar(){if(this.loaded)return this.academicCalendar;try{const t=async n=>{const s=await fetch(n,{headers:{Accept:"application/json"},credentials:"include"}),a=s.headers&&s.headers.get&&s.headers.get("content-type")||"";if(!s.ok)throw new Error(`HTTP ${s.status}`);if(!a.includes("application/json"))throw new Error("Non-JSON response");return await s.json()};let r=null;if(r=await t("/academic_year.json"),!Array.isArray(r))throw new Error("Invalid academic calendar format");return this.academicCalendar=r,this.loaded=!0,console.log(" Academic calendar loaded:",this.academicCalendar.length,"terms"),this.academicCalendar}catch(t){return console.error(" Error loading academic calendar:",t),null}}getCurrentTerm(){if(!this.academicCalendar)return null;const t=new Date;return this.academicCalendar.find(n=>{const s=new Date(n.start_date),a=new Date(n.end_date);return t>=s&&t<=a})}getCurrentSemester(){const t=this.getCurrentTerm();if(!t)return null;const r=t.semester,n=this.academicCalendar.filter(s=>s.semester===r&&s.academic_year===t.academic_year);return{semester:r,currentTerm:t,allTerms:n}}getCurrentAcademicPeriodId(){return this.getCurrentTerm()?.id||null}getSemesterTerms(t){return this.academicCalendar?this.academicCalendar.filter(r=>r.semester===t):[]}getAcademicYearTerms(t){return this.academicCalendar?this.academicCalendar.filter(r=>r.academic_year===t):[]}getCurrentSemesterWithTerms(){const t=this.getCurrentSemester();if(!t)return null;const{semester:r,currentTerm:n,allTerms:s}=t;return{semester:r,currentTerm:n,allTerms:s,terms:s.map(a=>({id:a.id,term:a.term,start_date:a.start_date,end_date:a.end_date,isCurrent:a.id===n.id,label:`Term ${a.term}${a.id===n.id?" (Current)":""}`}))}}getCurrentSemesterTerms(){const t=this.getCurrentSemester();if(!t)return null;const{semester:r,currentTerm:n,allTerms:s}=t;return{semester:r,currentTerm:n,terms:s.map(a=>({id:a.id,term:a.term,start_date:a.start_date,end_date:a.end_date,isCurrent:a.id===n.id,label:`Term ${a.term}${a.id===n.id?" (Current)":""}`}))}}getTermById(t){return this.academicCalendar?this.academicCalendar.find(r=>r.id===t):null}isCurrentTerm(t){return this.getCurrentTerm()?.id===t}getAcademicYears(){return this.academicCalendar?[...new Set(this.academicCalendar.map(r=>r.academic_year))].sort():[]}getAcademicYearSemesterTerms(t,r){return this.academicCalendar?this.academicCalendar.filter(n=>n.academic_year===t&&n.semester===r):[]}}const xc=new yae,l2=Object.freeze(Object.defineProperty({__proto__:null,academicCalendarService:xc},Symbol.toStringTag,{value:"Module"})),fn={async getTestInfo(e,t){console.log(`[DEBUG] getTestInfo called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(e,t){console.log(`[DEBUG] getTestQuestions called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getTestQuestionsWithInfo(e,t){console.log(`[DEBUG] getTestQuestionsWithInfo called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test questions with info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions with info data received:",s),s.success)return console.log("[DEBUG] Test questions with info retrieved successfully"),{questions:s.questions,testInfo:s.test_info};throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions with info:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const e="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(e){throw console.error("[ERROR] Failed to get active tests:",e),e}},async getTeacherTests(e=!1){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const t="/.netlify/functions/get-teacher-active-tests",r=e?`${t}?ts=${Date.now()}`:t;console.log("[DEBUG] Fetching teacher tests from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Teacher tests data received:",s),s.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),s.tests;throw new Error(s.error||"Failed to get teacher tests")}catch(t){throw console.error("[ERROR] Failed to get teacher tests:",t),t}},async submitTest(e,t,r,n={},s=null){console.log("Submitting test:",{testType:e,testId:t});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let a;try{const N=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`)).json();if(N.success)a=N.test_info;else throw new Error("Failed to get test information")}catch(_){console.error("Error getting test info:",_);const N=await this.getTestQuestions(e,t);a={test_name:`Test ${t}`,num_questions:N.length}}const i=await this.getTestQuestions(e,t);let o,c;if(e==="drawing")o=null,c=null;else{const _=n?.answers_by_id?n.answers_by_id:r;o=kf(i,_,e).score,c=a.num_questions}const u=this.transformAnswersForSubmission(r,e),d=a.teacher_id||null,f=a.subject_id||null,g=s?.student_id||s?.id||(window.tokenManager?.getCurrentUser?window.tokenManager.getCurrentUser()?.student_id||window.tokenManager.getCurrentUser()?.id:null);await xc.loadAcademicCalendar();const x=xc.getCurrentTerm()?.id;if(!x)throw new Error("No current academic period found");const v={test_id:t,test_name:a.test_name,test_type:e,teacher_id:d,subject_id:f,student_id:g,academic_period_id:x,answers:u,score:o,maxScore:c,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0,answers_by_id:n.answers_by_id||null,question_order:n.question_order||null,retest_assignment_id:n.retest_assignment_id||null,parent_test_id:n.parent_test_id||t};console.log(" testService retest_assignment_id:",n.retest_assignment_id),console.log(" testService timingData:",n),console.log(" testService commonData.retest_assignment_id:",v.retest_assignment_id);let w;switch(e){case"multiple_choice":w="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":w="/.netlify/functions/submit-true-false-test";break;case"input":w="/.netlify/functions/submit-input-test";break;case"matching_type":w="/.netlify/functions/submit-matching-type-test";break;case"word_matching":w="/.netlify/functions/submit-word-matching-test";break;case"drawing":w="/.netlify/functions/submit-drawing-test";break;case"fill_blanks":w="/.netlify/functions/submit-fill-blanks-test";break;default:throw new Error(`Unsupported test type: ${e}`)}console.log("Submitting to:",w),console.log("Submission data:",v),console.log("Submission data JSON:",JSON.stringify(v,null,2)),console.log(" Final submission retest_assignment_id:",v.retest_assignment_id);const C=await window.tokenManager.makeAuthenticatedRequest(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(!C.ok)throw new Error(`HTTP error! status: ${C.status}`);const k=await C.json();if(console.log("Test submission result:",k),k.success)return this.clearTestProgress(e,t),{success:!0,score:o,maxScore:c,result:k};throw new Error(k.error||"Failed to submit test")}catch(a){throw console.error("Error submitting test:",a),a}},async createTest(e){try{return(await js.post("/tests/create",e)).data}catch(t){throw new Error(t.message||"Failed to create test")}},async updateTest(e,t,r){try{return(await js.put(`/tests/${e}/${t}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(e,t){try{return(await js.delete(`/tests/${e}/${t}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(e,t){try{return(await js.post(`/tests/${e}/${t}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(e,t){try{return(await js.post(`/tests/${e}/${t}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(e,t){try{return(await js.post(`/tests/${e}/${t}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(e,t,r){try{return(await js.delete(`/tests/${e}/${t}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(e,t){try{return(await js.get(`/tests/${e}/${t}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(e,t,r="json"){try{return(await js.get(`/tests/${e}/${t}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(e,t){try{return(await js.uploadFile(`/tests/import?type=${t}`,e)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(e,t){try{return(await js.get(`/tests/${e}/${t}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const e=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();if(console.log("[DEBUG] Student test results data received:",t),t.success)return console.log("[DEBUG] Student test results retrieved successfully"),t;throw new Error(t.error||"Failed to get student test results")}catch(e){throw console.error("[ERROR] Failed to get student test results:",e),new Error(e.message||"Failed to get student test results")}},async getClassResults(e,t,r){try{return(await js.get(`/tests/class-results/${e}/${t}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(e,t,r){try{return(await js.post(`/tests/${e}/${t}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(e,t){try{return(await js.get(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(e,t){try{return(await js.delete(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(e){try{return(await js.post("/tests/validate",e)).data}catch(t){throw new Error(t.message||"Failed to validate test data")}},async getTestPreview(e,t){try{return(await js.get(`/tests/${e}/${t}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},isAnswerCorrect(e,t,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(t))===r.correct_answer;case"true_false":return t.toLowerCase()==="true"===r.correct_answer;case"input":const i=r.correct_answers||[],o=t.toLowerCase().trim();return i.some(c=>{const u=c.toLowerCase().trim();return o===u?!0:u&&o.includes(u)?u.length===1?o.startsWith(u)||o.endsWith(u):!0:!1});case"matching_type":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"drawing":return t&&t!=="No answer";default:return!1}},transformAnswersForSubmission(e,t){switch(t){case"multiple_choice":return e;case"true_false":return e;case"input":return e;case"matching_type":return e;case"word_matching":return e;case"drawing":if(Array.isArray(e)&&e.length>0)try{const r=e[0];return typeof r=="string"&&r.startsWith("[")?JSON.parse(r):e}catch(r){return console.warn("Failed to parse drawing answers:",r),e}return e;default:return e}},async markTestCompleted(e,t){try{console.log(`[DEBUG] markTestCompleted called with testType: ${e}, testId: ${t}`);const r=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:e,test_id:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[DEBUG] Mark test completed response:",n),n.success)return console.log(`Test ${e}_${t} marked as completed successfully`),{success:!0,message:n.message};throw new Error(n.error||"Failed to mark test as completed")}catch(r){throw console.error("Error marking test completed:",r),r}},clearTestProgress(e,t){try{const r=`test_progress_${e}_${t}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${e}_${t}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(e){console.log("[DEBUG] saveMultipleChoiceTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving multiple choice test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveTrueFalseTest(e){console.log("[DEBUG] saveTrueFalseTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving true/false test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveInputTest(e){console.log("[DEBUG] saveInputTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving input test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveMatchingTest(e){console.log("[DEBUG] saveMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"matching_type",num_questions:e.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveWordMatchingTest(e){console.log("[DEBUG] saveWordMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving word matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveDrawingTest(e){console.log("[DEBUG] saveDrawingTest called with:",e);try{const t={...e,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(t){return console.error("Error saving drawing test:",t),{success:!1,message:"Error saving test: "+t.message}}},async getDrawingTest(e){console.log("[DEBUG] getDrawingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting drawing test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitDrawingTest(e,t,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(e,t,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:e,score:t,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:e,score:t,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(e){console.log("[DEBUG] getWordMatchingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting word matching test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitWordMatchingTest(e,t,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(e){console.log("[DEBUG] assignTestToClasses called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(t){return console.error("Error assigning test to classes:",t),{success:!1,message:"Error assigning test: "+t.message}}},async removeClassAssignment(e){console.log("[DEBUG] removeClassAssignment called with assignmentId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${e}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(t){return console.error("Error removing class assignment:",t),{success:!1,message:"Error removing assignment: "+t.message}}}},RB=S.createContext(),MB=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState([]),[a,i]=S.useState({}),[o,c]=S.useState({}),[u,d]=S.useState(!1),[f,g]=S.useState(null),[p,x]=S.useState([]),[v,w]=S.useState(!1),[C,k]=S.useState(null),[_,N]=S.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[E,P]=S.useState(null),[F,A]=S.useState(0),{getItem:j,setItem:I,removeItem:B}=OB();S.useEffect(()=>{let me;return u&&E&&(me=setInterval(()=>{const Ne=Math.floor((Date.now()-E)/1e3);A(Ne)},1e3)),()=>{me&&clearInterval(me)}},[u,E]);const Y=async(me,Ne)=>{try{w(!0),k(null),console.log(`[DEBUG] loadTestForPage called with testType: ${me}, testId: ${Ne}`);const Fe=await fn.getTestInfo(me,Ne);console.log("[DEBUG] Test info retrieved:",Fe);const Re=await fn.getTestQuestions(me,Ne);console.log("[DEBUG] Test questions retrieved:",Re),r({...Fe,testType:me,testId:Ne}),s(Re),d(!0),P(Date.now()),A(0),Z(me,Ne),console.log("[DEBUG] Test loaded successfully")}catch(Fe){k(Fe.message||"Failed to load test"),console.error("Error loading test:",Fe)}finally{w(!1)}},Z=(me,Ne)=>{try{const Fe=`test_progress_${me}_${Ne}`,Re=j(Fe);Re&&(i(Re.answers||{}),c(Re.progress||{}))}catch(Fe){console.error("Error loading saved progress:",Fe)}},se=(me,Ne,Fe,Re)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const Pe=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${me}_${Ne}`,ze={...a,[Fe]:Re},ke={...o,[Fe]:{answered:!0,timestamp:Date.now()}};i(ze),c(ke),I(Pe,{answers:ze,progress:ke,lastSaved:Date.now()}),console.log(`Saved progress for question ${Fe}:`,Re)}catch(bt){console.error("Error saving test progress:",bt)}},ee=(me,Ne,Fe)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const bt=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${me}_${Ne}`;return j(bt)?.answers?.[Fe]||null}catch(Re){return console.error("Error getting test progress:",Re),null}},te=(me,Ne)=>{try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${me}, testId: ${Ne}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const Fe=window.tokenManager?.getDecodedToken()?.sub||"unknown",Re=`test_progress_${Fe}_${me}_${Ne}`;console.log(`[DEBUG] Removing localStorage key: ${Re}`);const bt=j(Re)!==null;B(Re),i({}),c({});for(let Pe=0;Pe<localStorage.length;Pe++){const ze=localStorage.key(Pe);ze&&ze.startsWith(`test_progress_${Fe}_${me}_${Ne}_`)&&(localStorage.removeItem(ze),console.log(`[DEBUG] Cleared individual question key: ${ze}`))}console.log(bt?`[DEBUG] Progress cleared for test ${me}_${Ne}`:`[DEBUG] No progress found to clear for test ${me}_${Ne}`)}catch(Fe){console.error("Error clearing test progress:",Fe)}},L=async(me,Ne,Fe="")=>{try{w(!0),k(null),console.log("Submitting test:",{testType:me,testId:Ne});const Re=ae(me,Ne);if(Object.keys(Re).length===0){k("Please answer at least one question before submitting.");return}let bt;try{bt=await fn.getTestInfo(me,Ne)}catch(It){console.error("Error getting test info:",It);const Kt=await fn.getTestQuestions(me,Ne);bt={test_name:`Test ${Ne}`,num_questions:Kt.length}}const Pe=await fn.getTestQuestions(me,Ne),ze=kf(Pe,Re,me),ke=bt.num_questions,$e=ie(Re,me),Be={test_id:Ne,test_name:bt.test_name,score:ze,maxScore:ke,answers:$e},Et=await fn.submitTest(me,Ne,Be);if(Et.success){if(g(Et.result),W(me,Ne,Fe),te(me,Ne),Fe){const It=`student_results_table_${Fe}`;me!=="drawing"?(console.log(" TestContext: Caching test results after submission with key:",It),_s(It,Et.result,Ls.student_results_table)):console.log(" TestContext: Skipping cache for drawing test submission (teacher-scored).")}return Fe&&Lm(Fe,me,Ne),d(!1),Et.results}else throw new Error(Et.message||"Test submission failed")}catch(Re){throw k(Re.message||"Failed to submit test"),Re}finally{w(!1)}},V=(me,Ne,Fe)=>{g({testType:me,testId:Ne,answers:Fe}),d(!1)},M=()=>{r(null),s([]),i({}),c({}),d(!1),g(null),k(null),P(null),A(0)},H=(me,Ne,Fe="")=>{try{const Re=`test_completed_${Fe}_${me}_${Ne}`;return j(Re)===!0}catch(Re){return console.error("Error checking test completion:",Re),!1}},W=(me,Ne,Fe="")=>{try{const Re=`test_completed_${Fe}_${me}_${Ne}`;I(Re,!0)}catch(Re){console.error("Error marking test completed:",Re)}},R=me=>Object.keys(a).length,z=()=>{const me=R(t?.testType),Ne=n.length;return{canSubmit:me===Ne,answeredCount:me,totalQuestions:Ne}},K=()=>{t&&te(t.testType,t.testId),M()},Q=(me="")=>{try{const Ne=`student_results_table_${me}`;console.log(" TestContext: Clearing test results cache:",Ne),localStorage.removeItem(Ne),console.log(" TestContext: Test results cache cleared")}catch(Ne){console.error("Error clearing test results cache:",Ne)}},ae=(me,Ne)=>({...a}),X=(me,Ne,Fe=null)=>{try{if(!me)return"No answer";switch(Ne){case"true_false":return me?"True":"False";case"multiple_choice":if(Fe&&typeof me=="string"&&!isNaN(parseInt(me))){const Re=parseInt(me),bt=`option_${String.fromCharCode(97+Re)}`,Pe=Fe[bt];if(Pe)return Pe}return String(me).toUpperCase();case"input":return String(me);case"matching_type":return typeof me=="object"?Object.entries(me).map(([Re,bt])=>`${Re}  ${bt}`).join(", "):String(me);case"word_matching":return typeof me=="object"?Object.entries(me).map(([Re,bt])=>`${Re}  ${bt}`).join(", "):String(me);case"drawing":return"Drawing submitted";default:return String(me)}}catch(Re){return console.error("Error formatting student answer:",Re),"Error displaying answer"}},ie=(me,Ne)=>{try{if(!me||typeof me!="object")return{};const Fe={};return Object.entries(me).forEach(([Re,bt])=>{if(bt!=null)switch(Ne){case"true_false":Fe[Re]=!!bt;break;case"multiple_choice":Fe[Re]=String(bt).toUpperCase();break;case"input":Fe[Re]=String(bt).trim();break;case"matching_type":typeof bt=="object"?Fe[Re]=bt:Fe[Re]=String(bt);break;case"word_matching":typeof bt=="object"?Fe[Re]=bt:Fe[Re]=String(bt);break;case"drawing":Fe[Re]=bt;break;default:Fe[Re]=bt}}),Fe}catch(Fe){return console.error("Error transforming answers for submission:",Fe),me||{}}},le=S.useCallback(async(me="")=>{try{w(!0);const Ne=`student_active_tests_${me}`,Fe=Bs(Ne);if(Fe)return x(Fe),Fe;const Re=await fn.getActiveTests();return x(Re),_s(Ne,Re,Ls.student_active_tests),Re}catch(Ne){return k(Ne.message||"Failed to load active tests"),x([]),[]}finally{w(!1)}},[]),ce=async()=>{try{return w(!0),await fn.getTeacherTests()}catch(me){return k(me.message||"Failed to load teacher tests"),[]}finally{w(!1)}},_e=async me=>{try{return w(!0),await fn.createTest(me)}catch(Ne){throw k(Ne.message||"Failed to create test"),Ne}finally{w(!1)}},ne=async(me,Ne)=>{try{return w(!0),await fn.deleteTest(me,Ne)}catch(Fe){throw k(Fe.message||"Failed to delete test"),Fe}finally{w(!1)}},pe=async(me,Ne)=>{try{return await fn.getTestInfo(me,Ne)}catch(Fe){throw console.error("Error getting test info:",Fe),Fe}},Ce=async(me,Ne)=>{try{return await fn.getTestQuestions(me,Ne)}catch(Fe){throw console.error("Error getting test questions:",Fe),Fe}},Ae=async(me,Ne,Fe)=>{try{console.log("Showing test results:",{testType:me,testId:Ne,studentAnswers:Fe});const Re=await pe(me,Ne),bt=await Ce(me,Ne);At(Re,bt,me,Fe),d(!1),console.log("Test results displayed successfully")}catch(Re){console.error("Error showing test results:",Re),k("Failed to display test results"),g({testType:me,testId:Ne,answers:Fe,showResults:!0,error:"Could not load detailed results"}),d(!1)}},Ge=async(me,Ne,Fe)=>{try{w(!0);const Re=await pe(me,Ne),bt=await Ce(me,Ne);At(Re,bt,me,Fe)}catch(Re){k(Re.message||"Failed to load test results")}finally{w(!1)}},Le=S.useCallback(async(me="")=>{try{w(!0);const Ne=`student_results_table_${me}`;console.log(" TestContext: Checking cache for key:",Ne);const Fe=Bs(Ne);if(Fe)return console.log(" TestContext: Cache HIT! Using cached test results"),g(Fe),Fe;console.log(" TestContext: Cache MISS! Fetching from API");const Re=await fn.getStudentTestResults();return console.log(" TestContext: Test results loaded:",Re),console.log(" TestContext: Results data:",Re?.results||Re),console.log(" TestContext: Results length:",Re?.results?.length||0),g(Re),console.log(" TestContext: Caching test results with key:",Ne),console.log(" TestContext: Results being cached:",Re),console.log(" TestContext: Results.results being cached:",Re.results),_s(Ne,Re,Ls.student_results_table),Re}catch(Ne){throw console.error("Error loading test results:",Ne),k(Ne.message||"Failed to load test results"),Ne}finally{w(!1)}},[]),At=(me,Ne,Fe,Re)=>{try{console.log("Displaying test results:",{testInfo:me,questions:Ne,testType:Fe,studentAnswers:Re});const bt=kf(Ne,Re,Fe),Pe=me?.num_questions||Ne?.length||0,ze=Pe>0?Math.round(bt/Pe*100):0,ke=ze>=60,$e=Ne.map((Be,Et)=>{const It=Be.question_id||Be.id,Kt=Re[It],wr=Cm(Be,Kt,Fe);return{questionNumber:Et+1,question:Be.question||Be.question_text,userAnswer:X(Kt,Fe),correctAnswer:tv(Be,Fe),isCorrect:wr,questionType:Fe}});g({testInfo:me,questions:Ne,testType:Fe,studentAnswers:Re,showResults:!0,score:bt,totalQuestions:Pe,percentage:ze,passed:ke,questionAnalysis:$e,timestamp:new Date().toISOString()}),c(Be=>({...Be,score:bt,totalQuestions:Pe,percentage:ze,passed:ke,lastUpdated:Date.now()})),et(),console.log(`Test results displayed: ${bt}/${Pe} (${ze}%) - ${ke?"PASSED":"FAILED"}`)}catch(bt){console.error("Error displaying test results:",bt),k("Failed to display test results")}},et=S.useCallback(()=>{try{console.log("Setting up test results page event listeners");const me=Pe=>{if(Pe.key==="Escape"&&K(),Pe.ctrlKey&&Pe.key==="p"&&(Pe.preventDefault(),window.print()),Pe.key==="Enter"&&f&&!f.passed){const ze=document.getElementById("retake-test-button");ze&&ze.click()}},Ne=()=>{window.print()},Fe=()=>{if(f){const Pe=`Test: ${f.testInfo?.test_name||"Test"}
Score: ${f.score}/${f.totalQuestions} (${f.percentage}%)
Status: ${f.passed?"PASSED":"FAILED"}
Completed: ${new Date(f.timestamp).toLocaleString()}`;navigator.clipboard.writeText(Pe).then(()=>{console.log("Results copied to clipboard")}).catch(ze=>{console.error("Failed to copy results:",ze)})}};document.addEventListener("keydown",me);const Re=document.getElementById("print-results");Re&&Re.addEventListener("click",Ne);const bt=document.getElementById("copy-results");return bt&&bt.addEventListener("click",Fe),()=>{document.removeEventListener("keydown",me),Re&&Re.removeEventListener("click",Ne),bt&&bt.removeEventListener("click",Fe)}}catch(me){console.error("Error setting up test results page event listeners:",me)}},[K,f]),pt=async(me,Ne,Fe)=>{try{w(!0),k(null),console.log("Viewing test details:",{testType:me,testId:Ne,testName:Fe}),N({isOpen:!0,testType:me,testId:Ne,testName:Fe,questions:[],isLoading:!0});const Re=await fn.getTestQuestions(me,Ne);Re&&Re.length>0?(N({isOpen:!0,testType:me,testId:Ne,testName:Fe,questions:Re,isLoading:!1}),console.log(`Test details loaded: ${Re.length} questions`)):(k("Could not load test questions. Please try again."),N({isOpen:!0,testType:me,testId:Ne,testName:Fe,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(Re){console.error("Error loading test details:",Re),k("Error loading test details. Please try again."),N({isOpen:!0,testType:me,testId:Ne,testName:Fe,questions:[],isLoading:!1,error:Re.message||"Failed to load test details"})}finally{w(!1)}},lt=(me,Ne,Fe,Re)=>{try{console.log("Showing test details modal:",{testType:me,testId:Ne,testName:Fe,questions:Re}),N({isOpen:!0,testType:me,testId:Ne,testName:Fe,questions:Re||[],isLoading:!1,error:null})}catch(bt){console.error("Error showing test details modal:",bt),k("Failed to show test details modal")}},rt=()=>{try{console.log("Closing test details modal"),N({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(me){console.error("Error closing test details modal:",me)}},ht=(me,Ne)=>{try{switch(Ne){case"multiple_choice":return l.jsxs("div",{className:"answer-options",children:[l.jsx("p",{children:l.jsx("strong",{children:"Options:"})}),l.jsxs("p",{children:["A) ",me.option_a||"No text"]}),l.jsxs("p",{children:["B) ",me.option_b||"No text"]}),me.option_c&&l.jsxs("p",{children:["C) ",me.option_c]}),me.option_d&&l.jsxs("p",{children:["D) ",me.option_d]}),me.option_e&&l.jsxs("p",{children:["E) ",me.option_e]}),me.option_f&&l.jsxs("p",{children:["F) ",me.option_f]}),l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",me.correct_answer||"Not specified"]})})]});case"true_false":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?"True":"False"]})})});case"input":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",me.correct_answer||"Not specified"]})})});case"matching_type":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?JSON.stringify(me.correct_answer):"Not specified"]})})});case"word_matching":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?JSON.stringify(me.correct_answer):"Not specified"]})})});default:return l.jsx("p",{children:"Unknown question type"})}}catch(Fe){return console.error("Error formatting question answer display:",Fe),l.jsx("p",{children:"Error displaying question"})}},Lt=(me,Ne)=>{try{console.log("Navigating to test:",{testType:me,testId:Ne}),r({testType:me,testId:Ne}),d(!0),Y(me,Ne)}catch(Fe){console.error("Error navigating to test:",Fe),k("Failed to navigate to test")}},zt=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),c({}),d(!1),g(null),k(null)}catch(me){console.error("Error hiding test sections:",me)}},Dt=(me,Ne,Fe,Re)=>{try{console.log("Displaying test on page:",{testInfo:me,questions:Ne,testType:Fe,testId:Re}),r({...me,testType:Fe,testId:Re}),s(Ne),d(!0),Z(Fe,Re),Nt(Fe,Re),Ye(Fe,Re)}catch(bt){console.error("Error displaying test on page:",bt),k("Failed to display test on page")}},De=(me,Ne,Fe)=>{try{return console.log("Rendering questions for page:",{questions:me,testType:Ne,testId:Fe}),!me||!Array.isArray(me)?(console.warn("Invalid questions array for rendering"),[]):me.map((Re,bt)=>{const Pe=ze=>{const ke={...a,[Re.question_id]:ze};i(ke),se(Ne,Fe,Re.question_id,ze)};return{question:Re,index:bt,testType:Ne,testId:Fe,studentAnswer:a[Re.question_id]||"",onAnswerChange:Pe}})}catch(Re){return console.error("Error rendering questions for page:",Re),[]}},Ie=S.useCallback((me,Ne)=>{try{if(!me||!Ne){console.warn("Cannot save progress: missing testType or testId");return}const Fe=`test_progress_${me}_${Ne}`,Re={answers:a,progress:o,lastSaved:Date.now(),testType:me,testId:Ne};I(Fe,Re),console.log(`Progress saved for test ${me}_${Ne}:`,Re)}catch(Fe){console.error("Error saving progress for page:",Fe)}},[a,o,I]),Ke=S.useCallback(me=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(Fe=>Fe==null?!1:typeof Fe=="string"?Fe.trim()!=="":typeof Fe=="object"?Object.keys(Fe).length>0:!0).length}catch(Ne){return console.error("Error getting answered questions count for page:",Ne),0}},[a]),Je=S.useCallback((me,Ne)=>{try{console.log("Updating progress display for page:",{testType:me,testId:Ne});const Fe=Ke(me),Re=n.length,bt=Re>0?Math.round(Fe/Re*100):0,Pe=Fe===Re&&Re>0;c(Be=>({...Be,answeredCount:Fe,totalQuestions:Re,percentage:bt,canSubmit:Pe,remainingQuestions:Re-Fe,lastUpdated:Date.now()}));const ze=document.getElementById("progress-bar"),ke=document.getElementById("progress-text"),$e=document.getElementById("submit-test-button");return ze&&(ze.style.width=`${bt}%`,ze.className=ze.className.replace(/bg-\w+-\d+/,""),bt>=100?ze.classList.add("bg-green-500"):bt>=80?ze.classList.add("bg-blue-500"):bt>=60?ze.classList.add("bg-yellow-500"):bt>=40?ze.classList.add("bg-orange-500"):ze.classList.add("bg-red-500")),ke&&(ke.textContent=`${Fe}/${Re} questions answered (${bt}%)`),$e&&($e.disabled=!Pe,Pe?($e.textContent=" Submit Test",$e.classList.remove("bg-gray-400"),$e.classList.add("bg-green-600","hover:bg-green-700")):($e.textContent=` Complete ${Re-Fe} more question${Re-Fe!==1?"s":""}`,$e.classList.remove("bg-green-600","hover:bg-green-700"),$e.classList.add("bg-gray-400"))),{answeredCount:Fe,totalQuestions:Re,percentage:bt,canSubmit:Pe}}catch(Fe){return console.error("Error updating progress display for page:",Fe),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,Ke]),Ye=S.useCallback((me,Ne)=>{try{console.log("Setting up test page event listeners:",{testType:me,testId:Ne});const Fe=setInterval(()=>{Object.keys(a).length>0&&(Ie(me,Ne),console.log("Auto-saved progress for test:",me,Ne))},3e4),Re=setInterval(()=>{Je(me,Ne)},2e3),bt=Be=>{Be.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&K(),Be.ctrlKey&&Be.key==="s"&&(Be.preventDefault(),Ie(me,Ne),console.log("Manual save triggered")),Be.key},Pe=Be=>{Object.keys(a).length>0&&(Be.preventDefault(),Be.returnValue="Your test progress will be saved. Are you sure you want to leave?")},ze=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),Ie(me,Ne))},ke=()=>{console.log("Window focused - updating progress"),Je(me,Ne)},$e=()=>{console.log("Window blurred - saving progress"),Ie(me,Ne)};return document.addEventListener("keydown",bt),window.addEventListener("beforeunload",Pe),document.addEventListener("visibilitychange",ze),window.addEventListener("focus",ke),window.addEventListener("blur",$e),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${me}_${Ne}`]=Fe,window.testIntervals[`progress_${me}_${Ne}`]=Re,()=>{clearInterval(Fe),clearInterval(Re),document.removeEventListener("keydown",bt),window.removeEventListener("beforeunload",Pe),document.removeEventListener("visibilitychange",ze),window.removeEventListener("focus",ke),window.removeEventListener("blur",$e),window.testIntervals&&(delete window.testIntervals[`autosave_${me}_${Ne}`],delete window.testIntervals[`progress_${me}_${Ne}`])}}catch(Fe){console.error("Error setting up test page event listeners:",Fe)}},[a,Ie,Je,K]),Tt=S.useCallback(()=>{try{const me=Ke(t?.testType),Ne=n.length,Fe=me===Ne&&Ne>0,Re=document.getElementById("submit-test-button");return Re&&(Re.disabled=!Fe,Re.textContent=Fe?"Submit Test":`Complete ${Ne-me} more questions`),{canSubmit:Fe,answeredCount:me,totalQuestions:Ne}}catch(me){return console.error("Error updating submit button state for page:",me),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[t,n.length,Ke]),Nt=S.useCallback((me,Ne)=>{try{console.log("Setting up progress tracking for page:",{testType:me,testId:Ne});const Fe=setInterval(()=>{Je(me,Ne),Tt()},1e3),Re=setInterval(()=>{Object.keys(a).length>0&&Ie(me,Ne)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${me}_${Ne}`]=Fe,window.testIntervals[`autosave_${me}_${Ne}`]=Re,()=>{clearInterval(Fe),clearInterval(Re),window.testIntervals&&(delete window.testIntervals[`progress_${me}_${Ne}`],delete window.testIntervals[`autosave_${me}_${Ne}`])}}catch(Fe){console.error("Error setting up progress tracking for page:",Fe)}},[a,Je,Tt,Ie]),Wt=S.useCallback(async(me,Ne)=>{const Fe=document.getElementById("submit-test-button");try{const Re=Ke(me),bt=n.length;if(Re<bt){k(`Please answer all ${bt} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;Fe&&(Fe.disabled=!0,Fe.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await L(me,Ne)&&(te(me,Ne),V(me,Ne,a),console.log("Test submitted successfully!"))}catch(Re){console.error("Error submitting test from page:",Re),k("Failed to submit test. Please try again."),Fe&&(Fe.disabled=!1,Fe.textContent="Submit Test")}},[Ke,n.length,L,te,V,a]),or=S.useCallback(()=>{try{if(!t)return null;const me=["true_false","multiple_choice","input","matching_type","word_matching"];return me.includes(t.testType)?t.testType:me.includes(t.test_type)?t.test_type:null}catch(me){return console.error("Error getting current test type:",me),null}},[t]),dr=S.useCallback((me,Ne)=>{try{console.log("Clearing progress tracking interval:",{testType:me,testId:Ne});const Fe=`progress_interval_${me}_${Ne}`,Re=`autosave_interval_${me}_${Ne}`;window.testIntervals&&(window.testIntervals[Fe]&&(clearInterval(window.testIntervals[Fe]),delete window.testIntervals[Fe]),window.testIntervals[Re]&&(clearInterval(window.testIntervals[Re]),delete window.testIntervals[Re])),console.log(`Cleared progress tracking intervals for test ${me}_${Ne}`)}catch(Fe){console.error("Error clearing progress tracking interval:",Fe)}},[]),nr={currentTest:t,testQuestions:n,studentAnswers:a,testProgress:o,isTestActive:u,testResults:f,activeTests:p,isLoading:v,error:C,testDetailsModal:_,testStartTime:E,timeElapsed:F,loadTestForPage:Y,submitTest:L,navigateToTestResults:V,navigateBackToCabinet:M,clearTestDataAndReturnToCabinet:K,saveTestProgress:se,getTestProgress:ee,clearTestProgress:te,loadSavedProgressForPage:Z,isTestCompleted:H,markTestCompleted:W,markTestCompletedInUI:(me,Ne)=>{console.log("Marking test completed in UI:",{testType:me,testId:Ne}),W(me,Ne)},getAnsweredQuestionsCount:R,updateSubmitButtonState:z,updateSubmitButtonStateForPage:Tt,loadStudentActiveTests:le,loadActiveTests:le,loadTeacherActiveTests:ce,getTestInfo:pe,getTestQuestions:Ce,createTest:_e,deleteTest:ne,showTestResults:Ae,loadTestResults:Le,loadTestResultsForPage:Ge,displayTestResultsOnPage:At,setupTestResultsPageEventListeners:et,clearTestResultsCache:Q,viewTestDetails:pt,showTestDetailsModal:lt,closeTestDetailsModal:rt,getQuestionAnswerDisplay:ht,navigateToTest:Lt,hideTestSections:zt,displayTestOnPage:Dt,renderQuestionsForPage:De,setupTestPageEventListeners:Ye,setupProgressTrackingForPage:Nt,updateProgressDisplayForPage:Je,submitTestFromPage:Wt,getAnsweredQuestionsCountForPage:Ke,getCurrentTestType:or,saveProgressForPage:Ie,clearProgressTrackingInterval:dr,collectTestAnswers:ae,calculateTestScore:kf,checkAnswerCorrectness:Cm,formatStudentAnswerForDisplay:X,getCorrectAnswer:tv,transformAnswersForSubmission:ie,clearAllTestData:()=>{try{console.log("Clearing old test data from localStorage (older than 15 days)...");const Ne=Date.now()-360*60*60*1e3,Fe=[];for(let Re=0;Re<localStorage.length;Re++){const bt=localStorage.key(Re);if(!(!bt||!((bt.startsWith("test_")||bt.startsWith("student_")||bt.startsWith("teacher_")||bt.startsWith("admin_")||bt.includes("progress")||bt.includes("answers"))&&!bt.includes("test_completed_"))))try{const ze=localStorage.getItem(bt);if(!ze){Fe.push(bt);continue}let ke=null;if(ze.startsWith("{")||ze.startsWith("[")){const $e=JSON.parse(ze),Be=$e.timestamp||$e.lastSaved||$e.lastTickAt||$e.createdAt||$e.updatedAt||$e.startedAt||$e.started_at||$e.created_at;Be&&(ke=new Date(Be).getTime())}if(!ke){const $e=`${bt}__ts`,Be=localStorage.getItem($e);Be&&(ke=parseInt(Be)||null)}if(!ke)continue;ke<Ne&&Fe.push(bt)}catch{continue}}return Fe.forEach(Re=>{console.log(`Removing old localStorage key: ${Re}`),B(Re)}),console.log(`Cleared ${Fe.length} old test-related items from localStorage`),{success:!0,clearedCount:Fe.length}}catch(me){return console.error("Error clearing old test data:",me),{success:!1,error:me.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:c,setIsTestActive:d,setTestResults:g,setError:k};return l.jsx(RB.Provider,{value:nr,children:e})},Vv=()=>{const e=S.useContext(RB);if(!e)throw new Error("useTest must be used within a TestProvider");return e},dy=window.location.hostname==="mathayomwatsing.netlify.app";dy&&(console.log=()=>{},console.debug=()=>{},console.info=()=>{},console.warn=()=>{});const ge={debug:(e,...t)=>{dy||console.log(e,...t)},warn:(e,...t)=>{dy||console.warn(e,...t)},error:(e,...t)=>{console.error(e,...t)},info:(e,...t)=>{dy||console.info(e,...t)},isEnabled:()=>!dy},Kv=({testResults:e,onBackToCabinet:t,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0})=>{if(!e||!e.showResults)return l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:i,testType:o,score:c,totalQuestions:u,percentage:d,passed:f,questionAnalysis:g,timestamp:p}=e,x=C=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[C]||C,v=C=>C>=80?"text-green-600 bg-green-50":C>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",w=C=>C?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):l.jsx("div",{className:"bg-gray-50 py-8 overflow-y-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs(at.div,{className:"bg-white rounded-lg shadow-lg p-6 mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(e?.caught_cheating||s)&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-6",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",e?.visibility_change_times||a||0," times during the test."]})})]})}),l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Test Results"}),l.jsx("h2",{className:"text-xl text-gray-700 mb-1",children:i?.test_name||"Test"}),l.jsxs("p",{className:"text-sm text-gray-500",children:[x(o),"  Completed on ",new Date(p).toLocaleDateString()]})]}),l.jsx("div",{className:"text-right",children:l.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${w(f)}`,children:f?" PASSED":" FAILED"})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:c}),l.jsx("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:u}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:`text-3xl font-bold ${v(d).split(" ")[0]}`,children:[d,"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Score"})]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-6",children:l.jsx(at.div,{className:`h-3 rounded-full ${v(d).split(" ")[1]}`,initial:{width:0},animate:{width:`${d}%`},transition:{duration:1,ease:"easeOut"}})}),l.jsx("div",{className:"flex flex-wrap gap-3",children:l.jsx(Ze,{onClick:t,variant:"primary",className:"flex items-center gap-2",children:" Back to Cabinet"})})]}),o!=="matching_type"&&o!=="word_matching"&&l.jsxs(at.div,{className:"bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Question Review"}),l.jsx("div",{className:"space-y-4",children:g.map((C,k)=>l.jsxs(at.div,{className:`p-4 rounded-lg border-2 ${C.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:k*.1},children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Question ",C.questionNumber]}),l.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${C.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.isCorrect?" Correct":" Incorrect"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Question:"}),l.jsx("p",{className:"text-gray-700 bg-gray-100 p-3 rounded",children:C.question})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Your Answer:"}),l.jsx("p",{className:`p-3 rounded ${C.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.userAnswer||"No answer provided"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Correct Answer:"}),l.jsx("p",{className:"bg-blue-100 text-blue-800 p-3 rounded",children:C.correctAnswer})]})]})]},k))})]}),l.jsxs(at.div,{className:"bg-white rounded-lg shadow-lg p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Summary Statistics"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g.filter(C=>C.isCorrect).length}),l.jsx("div",{className:"text-sm text-blue-600",children:"Correct"})]}),l.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:g.filter(C=>!C.isCorrect).length}),l.jsx("div",{className:"text-sm text-red-600",children:"Incorrect"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[Math.round(g.filter(C=>C.isCorrect).length/u*100),"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy"})]}),l.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u}),l.jsx("div",{className:"text-sm text-purple-600",children:"Total"})]})]})]})]})})},LB=({isOpen:e,onClose:t,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1})=>{if(!e)return null;const o=f=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[f]||f,c=f=>({multiple_choice:"",true_false:"",input:"",matching_type:""})[f]||"",u=(f,g)=>{switch(g){case"multiple_choice":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[f.option_a&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),l.jsx("span",{className:"text-gray-700",children:f.option_a})]}),f.option_b&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),l.jsx("span",{className:"text-gray-700",children:f.option_b})]}),f.option_c&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),l.jsx("span",{className:"text-gray-700",children:f.option_c})]}),f.option_d&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),l.jsx("span",{className:"text-gray-700",children:f.option_d})]}),f.option_e&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),l.jsx("span",{className:"text-gray-700",children:f.option_e})]}),f.option_f&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:f.option_f})]})]})]});case"true_false":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),l.jsx("span",{className:"text-gray-700",children:"True"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},d=(f,g)=>{if(!f.correct_answer)return null;let p="";switch(g){case"multiple_choice":p=f.correct_answer.toUpperCase();break;case"true_false":p=f.correct_answer?"True":"False";break;case"input":p=f.correct_answer;break;case"matching_type":p=typeof f.correct_answer=="object"?JSON.stringify(f.correct_answer):f.correct_answer;break;default:p=String(f.correct_answer)}return l.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[l.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),l.jsx("p",{className:"text-green-700 font-mono",children:p})]})};return l.jsx(ko,{children:l.jsxs(at.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[l.jsx(at.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t}),l.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:l.jsxs(at.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("span",{className:"text-2xl",children:c(r)}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[o(r),"  ",a.length," Questions"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ze,{onClick:()=>window.print(),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Print"}),l.jsx(Ze,{onClick:t,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Close"})]})]}),l.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):a.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),l.jsx("p",{className:"text-gray-500",children:"This test doesn't have any questions yet."})]}):l.jsx("div",{className:"space-y-6",children:a.map((f,g)=>l.jsxs(at.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:g*.1,duration:.3},children:[l.jsx("div",{className:"flex items-start justify-between mb-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",g+1]}),l.jsx("span",{className:"text-gray-500 text-sm",children:o(r)})]})}),l.jsx("div",{className:"mb-4",children:l.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:f.question||f.question_text})}),u(f,r),d(f,r)]},f.id||f.question_id||g))})}),l.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[l.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&l.jsxs("span",{children:["Showing ",a.length," question",a.length!==1?"s":""]})}),l.jsx("div",{className:"flex items-center space-x-3",children:l.jsx(Ze,{onClick:t,variant:"primary",className:"flex items-center space-x-2",children:"Close"})})]})]})})]})})},vae=({answeredCount:e=0,totalQuestions:t=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i=""})=>{const o=t>0?Math.round(e/t*100):0,c=t-e,u=g=>{const p=Math.floor(g/3600),x=Math.floor(g%3600/60),v=g%60;return p>0?`${p}:${x.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`:`${x}:${v.toString().padStart(2,"0")}`},d=g=>g>=100?"bg-green-500":g>=80?"bg-blue-500":g>=60?"bg-yellow-500":g>=40?"bg-orange-500":"bg-red-500",f=g=>g>=100?"text-green-600":g>=80?"text-blue-600":g>=60?"text-yellow-600":g>=40?"text-orange-600":"text-red-600";return l.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 ${i}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Progress"}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-2xl",children:""}),l.jsx("span",{className:"text-sm font-mono text-gray-600",children:u(r)})]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),l.jsxs("span",{className:`text-sm font-semibold ${f(o)}`,children:[o,"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:l.jsx(at.div,{className:`h-full ${d(o)} transition-colors duration-300`,initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5,ease:"easeOut"}})})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-4",children:[l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:e}),l.jsx("div",{className:"text-xs text-blue-600",children:"Answered"})]}),l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-600",children:c}),l.jsx("div",{className:"text-xs text-gray-600",children:"Remaining"})]}),l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:t}),l.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]})]}),l.jsx("div",{className:"mb-4",children:e===t?l.jsx(at.div,{className:"flex items-center justify-center p-3 bg-green-50 border border-green-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:"text-green-600 font-medium",children:" All questions answered! Ready to submit."})}):c===1?l.jsx(at.div,{className:"flex items-center justify-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:"text-yellow-600 font-medium",children:"Almost there! 1 question remaining."})}):l.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:l.jsxs("span",{className:"text-gray-600 font-medium",children:[c," questions remaining"]})})}),a&&l.jsx("div",{className:"flex justify-center",children:l.jsx(at.button,{onClick:n,disabled:s,className:`px-8 py-3 rounded-lg font-semibold text-white transition-all duration-300 ${s?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"}`,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},children:s?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Submitting..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Submit Test"})]})})})]})},wae=({testText:e,blanks:t,separateType:r=!0,testId:n,testName:s="Unknown Test",teacherId:a="Unknown Teacher",subjectId:i,onTestComplete:o,onAnswerChange:c})=>{if(console.log(" FillBlanksTestStudent Props Debug:"),console.log("- testText:",e),console.log("- blanks:",t),console.log("- separateType:",r),console.log("- testId:",n),console.log("- testName:",s),console.log("- teacherId:",a),console.log("- subjectId:",i),!e||!t||!Array.isArray(t))return console.log(" FillBlanksTestStudent: Missing test data"),l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(jt,{className:"max-w-md w-full",children:l.jsxs(jt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load fill blanks test data"}),l.jsx(Ze,{onClick:()=>window.history.back(),variant:"primary",children:"Back to Dashboard"})]})})});const[u,d]=S.useState({}),[f,g]=S.useState(!1),[p,x]=S.useState(null),[v,w]=S.useState(null),[C,k]=S.useState(!1),[_,N]=S.useState(null),{showNotification:E}=Aa(),{makeAuthenticatedRequest:P}=tl(),{user:F}=ds(),{startTracking:A,stopTracking:j,getCheatingData:I,clearData:B}=Jm("fill_blanks",n,F?.student_id||F?.id);i2();const Y=S.useCallback((te,L)=>{try{let V=te;if(typeof te=="string"&&te.startsWith("{"))try{const R=JSON.parse(te);R.root&&R.root.children&&(V=R.root.children.map(z=>z.children?z.children.map(K=>K.style&&K.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":K.text||"").join(""):"").join(" "))}catch(R){console.error("Error parsing Lexical JSON:",R)}let M=V;L.forEach((R,z)=>{const K=`[${z+1}_________]`;M=M.replace("[BLANK_PLACEHOLDER]",K)});const W=M.split(/(\[\d+_________\])/).map((R,z)=>R.match(/\[\d+_________\]/)?l.jsx("span",{className:"inline-block px-3 py-1 mx-1 bg-purple-100 text-purple-800 border-2 border-purple-400 rounded-lg font-mono font-bold shadow-sm",children:R},z):l.jsx("span",{children:R},z));return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:W})})}catch(V){return console.error("Error rendering text with blanks:",V),l.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[]),Z=S.useCallback((te,L)=>{try{let V=te;if(typeof te=="string"&&te.startsWith("{"))try{const R=JSON.parse(te);R.root&&R.root.children&&(V=R.root.children.map(z=>z.children?z.children.map(K=>K.style&&K.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":K.text||"").join(""):"").join(" "))}catch(R){console.error("Error parsing Lexical JSON:",R)}const M=[];L.forEach((R,z)=>{const K=u[R.id],Q=K?R.options[K.charCodeAt(0)-65]:null,ae=Q?l.jsx("span",{className:"inline-block px-3 py-2 bg-green-100 text-green-800 rounded-lg border-2 border-green-400 cursor-pointer hover:bg-green-200 hover:border-green-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(R.id),children:Q},z):l.jsxs("span",{className:"inline-block px-3 py-2 bg-purple-100 text-purple-800 rounded-lg border-2 border-purple-400 cursor-pointer hover:bg-purple-200 hover:border-purple-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(R.id),children:[z+1,"_________"]},z);M.push(ae),V=V.replace("[BLANK_PLACEHOLDER]",`__BLANK_${R.id}__`)});const H=V.split(/__BLANK_\d+__/),W=[];for(let R=0;R<H.length;R++)H[R]&&W.push(l.jsx("span",{children:H[R]},`text-${R}`)),R<M.length&&W.push(M[R]);return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:W})})}catch(V){return console.error("Error rendering text with inline blanks:",V),l.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[u]),se=S.useCallback((te,L)=>{const V={...u,[te]:L};d(V),c&&c(te,L)},[u,c]),ee=S.useCallback(te=>l.jsx("div",{className:"space-y-6",children:te.map((L,V)=>{const M=L.blank_options||L.options||[];L.correct_answers;const H=L.question_json||L.question||`Blank ${V+1}`;return console.log(` Blank ${V+1} question text:`,H),l.jsxs(jt,{className:"p-4",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",V+1]}),l.jsx("p",{className:"text-gray-600 mb-4",children:H})]}),l.jsx("div",{className:"space-y-3",children:M.filter(W=>W&&W.trim().length>0).map((W,R)=>l.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[l.jsx("input",{type:"radio",name:`blank_${L.question_id||L.id||V}`,value:String.fromCharCode(65+R),checked:u[L.question_id||L.id||V]===String.fromCharCode(65+R),onChange:z=>se(L.question_id||L.id||V,z.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),l.jsxs("span",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+R)}),l.jsx("span",{className:"text-gray-700",children:W})]})]},R))})]},L.question_id||L.id||V)})}),[u,se]);return S.useEffect(()=>{if(n&&F?.student_id){x(new Date),A(),console.log(" Anti-cheating tracking started for fill blanks test");const L=`test_progress_${F.student_id}_fill_blanks_${n}`,V=Bs(L);V&&(d(V.answers||{}),x(new Date(V.startTime)),console.log(" Fill blanks test progress restored:",V))}},[n,F?.student_id,t,A]),S.useEffect(()=>{if(p&&F?.student_id&&n){const te=setInterval(()=>{const L={answers:u,startTime:p.toISOString()},V=`test_progress_${F.student_id}_fill_blanks_${n}`;_s(V,L,Ls.test_progress),console.log(" Fill blanks progress auto-saved")},3e4);return()=>clearInterval(te)}},[p,u,F?.student_id,n]),S.useEffect(()=>()=>{j(),B(),console.log(" Fill blanks test component unmounted - anti-cheating cleanup")},[j,B]),S.useCallback(async()=>{g(!0);try{const te=t.length;let L=0;t.forEach((pe,Ce)=>{const Ae=u[pe.id];Ae&&Ae===pe.correct_answer&&L++});const V=L,M=te;console.log(` Fill Blanks Score: ${V}/${M} (${Math.round(V/M*100)}%)`);const H=new Date,W=p?Math.round((H-p)/1e3):0,R=p?p.toISOString():H.toISOString(),z=I();console.log(" Anti-cheating data for fill blanks submission:",z);const K=F.student_id,Q=`retest_assignment_id_${K}_fill_blanks_${n}`,ae=localStorage.getItem(Q),{academicCalendarService:X}=await mi(async()=>{const{academicCalendarService:pe}=await Promise.resolve().then(()=>l2);return{academicCalendarService:pe}},void 0);await X.loadAcademicCalendar();const le=X.getCurrentTerm()?.id;if(!le)throw new Error("No current academic period found");const ce={test_id:n,test_name:s,teacher_id:a||null,subject_id:i||null,student_id:K,academic_period_id:le,parent_test_id:n,retest_assignment_id:ae?Number(ae):null,answers:u,score:V,maxScore:M,time_taken:W,started_at:R,submitted_at:H.toISOString(),caught_cheating:z.caught_cheating,visibility_change_times:z.visibility_change_times};console.log(" Submitting fill blanks test:",ce);const ne=await(await P("/.netlify/functions/submit-fill-blanks-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)})).json();if(ne.success){if(E("Test submitted successfully!","success"),j(),B(),console.log(" Anti-cheating tracking stopped and data cleared for fill blanks test"),F?.student_id&&(Lm(F.student_id,"fill_blanks",n),console.log(" Fill blanks test data cleared from cache")),!!ae&&F?.student_id){let Ce=3;try{const Le=localStorage.getItem(`student_active_tests_${F.student_id}`);if(Le){const et=JSON.parse(Le)?.tests?.find(pt=>pt.test_id===n&&pt.test_type==="fill_blanks");et&&(Ce=et.retest_attempts_left||et.max_attempts||3)}}catch(Le){console.error("Error checking active tests cache:",Le)}const Ge=(V>0&&M>0?V/M*100:0)>=50;if(Ge){const Le=`retest_attempt${Ce}_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(Le,"true"),console.log(" Passed retest, marking last-slot key:",Le);let At=0;for(let lt=1;lt<=10;lt++){const rt=`retest_attempt${lt}_${F.student_id}_fill_blanks_${n}`;localStorage.getItem(rt)==="true"&&At++}const et=`test_completed_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(et,"true"),console.log(" Marked retest as completed (student passed):",et);const pt=`retest_attempts_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(pt,JSON.stringify({used:At,max:Ce})),console.log(" Set retest attempts metadata (student passed):",pt,{used:At,max:Ce})}else{let Le=1;for(let rt=1;rt<=10;rt++){const ht=`retest_attempt${rt}_${F.student_id}_fill_blanks_${n}`;if(localStorage.getItem(ht)!=="true"){Le=rt;break}}const At=`retest_attempt${Le}_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(At,"true"),console.log(" Marked retest attempt as completed:",At);let et=0;for(let rt=1;rt<=10;rt++){const ht=`retest_attempt${rt}_${F.student_id}_fill_blanks_${n}`;localStorage.getItem(ht)==="true"&&et++}const pt=Ce-et,lt=pt<=0||Ge;if(console.log(" Retest completion check:",{usedAttempts:et,maxAttempts:Ce,attemptsLeft:pt,passed:Ge,shouldComplete:lt}),lt){const rt=`test_completed_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(rt,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",rt);const ht=`retest_attempts_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(ht,JSON.stringify({used:et,max:Ce})),console.log(" Set retest attempts metadata (attempts exhausted):",ht,{used:et,max:Ce})}}}else if(F?.student_id){const Ce=`test_completed_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(Ce,"true"),console.log(" Fill blanks test marked as completed in localStorage:",Ce)}if(F?.student_id){const Ce=`retest1_${K}_fill_blanks_${n}`;localStorage.removeItem(Ce),localStorage.removeItem(Q)}if(F?.student_id){const Ce=`student_results_table_${F.student_id}`;_s(Ce,ne,Ls.student_results_table),console.log(" Fill blanks test results cached with key:",Ce)}setShowSubmitModal(!1),setTimeout(()=>{o&&o(V)},2e3)}else throw new Error(ne.message||"Failed to submit test")}catch(te){console.error("Error submitting test:",te),E("Error submitting test. Please try again.","error")}finally{g(!1)}},[u,t,n,s,a,i,p,I,j,B,P,E,o,F]),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:l.jsxs(jt,{children:[f&&l.jsx(jt.Header,{children:l.jsx("div",{className:"flex items-center justify-center",children:l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[l.jsx(Wr,{size:"small"}),l.jsx("span",{children:"Submitting..."})]})})}),l.jsx(jt.Body,{children:r===!0?l.jsxs(l.Fragment,{children:[Y(e,t),ee(t)]}):l.jsx(l.Fragment,{children:Z(e,t)})}),r===!1&&v&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Answer"}),l.jsx("div",{className:"space-y-2",children:t.find(te=>te.id===v)?.options.filter(te=>te.trim().length>0).map((te,L)=>l.jsxs("button",{onClick:()=>{se(v,String.fromCharCode(65+L)),w(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 rounded-lg border border-gray-200",children:[l.jsxs("span",{className:"font-semibold text-blue-600 mr-2",children:[String.fromCharCode(65+L),")"]}),te]},L))}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx(Ze,{onClick:()=>w(null),variant:"secondary",size:"sm",children:"Cancel"})})]})}),l.jsx(jt.Footer,{children:l.jsx("div",{className:"flex gap-3"})})]})})};let _ae=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}};const Tm=new _ae;window.tokenManager=Tm;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{Tm.init()}):Tm.init());const BB=async(e,t,r,n,s=!1)=>{try{console.log(" Fetching teacher student results:",{teacherId:e,grade:t,className:r,termId:n,forceRefresh:s});const a=s?`&_t=${Date.now()}`:"",o=await(await Tm.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}${a}`,{cache:s?"no-cache":"default",headers:s?{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}:{}})).json();if(o.success)return console.log(" Teacher student results loaded:",o.results.length,"results"),console.log(" Students loaded:",o.students?.length||0,"students"),{success:!0,results:o.results,students:o.students||[],count:o.results.length,student_count:o.student_count||0};throw new Error(o.error||"Failed to load teacher student results")}catch(a){return console.error("Error fetching teacher student results:",a),{success:!1,error:a.message,results:[]}}},$B=async(e,t)=>{try{console.log(" Fetching student results view:",{studentId:e,academicPeriodId:t});const r=t?`&academic_period_id=${t}`:"",s=await(await Tm.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${e}${r}`)).json();if(s.success)return console.log(" Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},bae=async(e,t,r,n)=>{try{console.log(" Fetching class summary:",{teacherId:e,grade:t,className:r,academicPeriodId:n});const a=await(await Tm.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log(" Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},Sae=async(e,t,r,n,s={})=>{try{const a=await BB(e,t,r,n);if(!a.success)return a;let i=a.results;return s.subject&&(i=i.filter(o=>o.subject&&o.subject.toLowerCase().includes(s.subject.toLowerCase()))),s.testType&&(i=i.filter(o=>o.test_type===s.testType)),s.minScore!==void 0&&(i=i.filter(o=>o.score/o.max_score*100>=s.minScore)),s.maxScore!==void 0&&(i=i.filter(o=>o.score/o.max_score*100<=s.maxScore)),s.passed!==void 0&&(i=i.filter(o=>o.score>=o.passing_score===s.passed)),{success:!0,results:i,count:i.length,originalCount:a.results.length}}catch(a){return console.error("Error filtering teacher student results:",a),{success:!1,error:a.message,results:[]}}},kae=async(e,t,r={})=>{try{const n=await $B(e,t);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},Cae={getTeacherStudentResults:BB,getStudentResultsView:$B,getClassSummary:bae,getTeacherStudentResultsFiltered:Sae,getStudentResultsViewFiltered:kae};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tae=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Eae=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),SF=e=>{const t=Eae(e);return t.charAt(0).toUpperCase()+t.slice(1)},UB=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),Nae=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Aae={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jae=S.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>S.createElement("svg",{ref:c,...Aae,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:UB("lucide",s),...!a&&!Nae(o)&&{"aria-hidden":"true"},...o},[...i.map(([u,d])=>S.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=(e,t)=>{const r=S.forwardRef(({className:n,...s},a)=>S.createElement(jae,{ref:a,iconNode:t,className:UB(`lucide-${Tae(SF(e))}`,`lucide-${e}`,n),...s}));return r.displayName=SF(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pae=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Fae=Zm("download",Pae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oae=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Dae=Zm("maximize-2",Oae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iae=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Rae=Zm("rotate-cw",Iae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mae=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],zB=Zm("x",Mae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lae=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Bae=Zm("zoom-in",Lae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ae=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Uae=Zm("zoom-out",$ae),nc={WIDTH:1536,HEIGHT:2048,ASPECT_RATIO:1536/2048},WB={MIN:.25,MAX:1,INITIAL:.25,STEP:.1},Th={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",ERASER:"eraser"},kF={CURSOR_COLOR:"#ff0000",CURSOR_OPACITY:.3},CF={ERASER_TO_THICKNESS_RATIO:2.5,THICKNESS_TO_ERASER_RATIO:.4},$_={MAX_ENTRIES:10,MAX_MEMORY_KB:500,COMPRESSION_THRESHOLD:200},HB=e=>{try{const t=JSON.stringify(e);return new Blob([t]).size/1024}catch(t){return console.warn("Error calculating memory usage:",t),0}},zae=e=>Array.isArray(e)?e.map(t=>Array.isArray(t)?Wae(t):t):e,Wae=e=>{if(e.length<=2)return e;const t=[e[0]],r=2;for(let n=1;n<e.length-1;n++){const s=e[n-1],a=e[n];e[n+1],Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))>r&&t.push(a)}return t.push(e[e.length-1]),t},Hae=(e,t=Date.now())=>{const r=HB(e);return{data:[...e],timestamp:t,memoryUsage:r,compressed:r>$_.COMPRESSION_THRESHOLD}},TF=(e,t,r)=>{const n=Hae(t),s=HB(t),a=e.slice(0,r+1);a.push(n);let i=a;return s>$_.MAX_MEMORY_KB&&(i=Gae(a)),i.length>$_.MAX_ENTRIES&&(i=i.slice(-10)),{history:i,index:i.length-1}},Gae=e=>e.map(t=>t.memoryUsage>$_.COMPRESSION_THRESHOLD?{...t,data:zae(t.data),compressed:!0}:t),EF=(e,t)=>{if(t<0||t>=e.length)return[];const r=e[t];return r?r.compressed?Vae(r.data):[...r.data]:[]},Vae=e=>[...e],NF=e=>e>0,AF=(e,t)=>e<t-1,Kae=()=>({history:[],index:-1}),qae=()=>{const[e,t]=S.useState({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null}),[r,n]=S.useState([]),[s,a]=S.useState([]),i=S.useCallback(E=>{t(P=>({...P,...E}))},[]),o=S.useCallback(()=>{t({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null})},[]),c=S.useCallback(E=>{const P={x:E.x,y:E.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(F=>({...F,isDrawing:!0,currentLine:[P]})):["line","rectangle","circle"].includes(e.currentTool)&&t(F=>({...F,isDrawing:!0,currentShape:{type:e.currentTool,startX:E.x,startY:E.y,endX:E.x,endY:E.y,color:e.currentColor,thickness:e.currentThickness}}))},[e.currentTool,e.currentColor,e.currentThickness]),u=S.useCallback(E=>{if(!e.isDrawing)return;const P={x:E.x,y:E.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(F=>({...F,currentLine:[...F.currentLine,P]})):e.currentShape&&t(F=>({...F,currentShape:{...F.currentShape,endX:E.x,endY:E.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape]),d=S.useCallback(()=>{if(!e.isDrawing)return;let E=r;if(e.currentTool==="pencil"&&e.currentLine.length>0?(E=[...r,e.currentLine],n(E)):e.currentShape&&(E=[...r,e.currentShape],n(E)),E!==r){const P=TF(e.drawingHistory,E,e.historyIndex);t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:P.history,historyIndex:P.index}))}else t(P=>({...P,isDrawing:!1,currentLine:[],currentShape:null}))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,r,e.drawingHistory,e.historyIndex]),f=S.useCallback(E=>Math.round(E*CF.ERASER_TO_THICKNESS_RATIO),[]),g=S.useCallback(E=>Math.round(E*CF.THICKNESS_TO_ERASER_RATIO),[]),p=S.useCallback(E=>{t(P=>({...P,currentThickness:E,eraserSize:f(E)}))},[f]),x=S.useCallback(E=>{t(P=>({...P,eraserSize:E,currentThickness:g(E)}))},[g]),v=S.useCallback(E=>{const P=TF(e.drawingHistory,E,e.historyIndex);t(F=>({...F,drawingHistory:P.history,historyIndex:P.index}))},[e.drawingHistory,e.historyIndex]),w=S.useCallback(()=>{if(NF(e.historyIndex)){const E=e.historyIndex-1,P=EF(e.drawingHistory,E);n([...P]),t(F=>({...F,historyIndex:E}))}},[e.historyIndex,e.drawingHistory]),C=S.useCallback(()=>{if(AF(e.historyIndex,e.drawingHistory.length)){const E=e.historyIndex+1,P=EF(e.drawingHistory,E);n([...P]),t(F=>({...F,historyIndex:E}))}},[e.historyIndex,e.drawingHistory]),k=S.useCallback(()=>{const E=Kae();t(P=>({...P,drawingHistory:E.history,historyIndex:E.index}))},[]),_=NF(e.historyIndex),N=AF(e.historyIndex,e.drawingHistory.length);return{drawingState:e,setDrawingState:t,drawingData:r,setDrawingData:n,textBoxes:s,setTextBoxes:a,updateDrawingState:i,resetDrawingState:o,startDrawing:c,continueDrawing:u,finishDrawing:d,handleThicknessChange:p,handleEraserSizeChange:x,saveToHistoryState:v,undo:w,redo:C,clearHistoryState:k,canUndoState:_,canRedoState:N}},jF={SCALE_DELTA:.05,CENTER_DELTA:20},rm=e=>{if(e.length<2)return 0;const t=e[0],r=e[1];return Math.sqrt(Math.pow(r.clientX-t.clientX,2)+Math.pow(r.clientY-t.clientY,2))},uf=e=>{if(e.length<2)return null;const t=e[0],r=e[1];return{x:(t.clientX+r.clientX)/2,y:(t.clientY+r.clientY)/2}},Yae=(e,t)=>{if(e.length!==2||!t)return null;const r=rm(e),n=rm(t),s=uf(e),a=uf(t);if(n===0)return null;const i=Math.abs(r/n-1),o=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));return i>jF.SCALE_DELTA?"zoom":o>jF.CENTER_DELTA?"pan":null},Xae=e=>{let t;return function(){const r=arguments,n=this;t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e.apply(n,r),t=null})}},Vg=(e,t)=>{const r=t.getPointerPosition();return{x:(r.x-t.x())/t.scaleX(),y:(r.y-t.y())/t.scaleY()}},ml={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},U_={color:"#000000",thickness:2},PF=(e,t,r)=>({x:e.x,y:e.y,color:t||U_.color,thickness:r||U_.thickness}),Qae=(e,t,r,n,s)=>({type:e,startX:t.x,startY:t.y,endX:r.x,endY:r.y,color:n||U_.color,thickness:s||U_.thickness}),GB=(e,t,r,n,s,a)=>{const i=e-r,o=t-n,c=s-r,u=a-n,d=i*c+o*u,f=c*c+u*u;let g=-1;f!==0&&(g=d/f);let p,x;g<0?(p=r,x=n):g>1?(p=s,x=a):(p=r+g*c,x=n+g*u);const v=e-p,w=t-x;return Math.sqrt(v*v+w*w)},Jae=(e,t)=>{if(t.length===0)return[e];const r=t.sort((a,i)=>a.index-i.index),n=[];let s=0;for(const a of r)a.index>s&&n.push(e.slice(s,a.index+1)),s=a.index+1;return s<e.length&&n.push(e.slice(s)),n.filter(a=>a.length>0)},Zae=(e,t,r,n)=>{const s=[],a=r/2;for(let i=0;i<n.length-1;i++){const o=n[i],c=n[i+1],u=GB(e,t,o.x,o.y,c.x,c.y);u<=a&&s.push({index:i,point:{x:o.x,y:o.y},distance:u})}return s},eie=(e,t,r,n)=>{const s=Zae(t,r,n,e);return s.length===0?[e]:Jae(e,s)},tie=(e,t,r,n)=>{if(n.type==="rectangle"){const s=Math.min(n.startX,n.endX),a=Math.min(n.startY,n.endY),i=Math.abs(n.endX-n.startX),o=Math.abs(n.endY-n.startY);return e>=s&&e<=s+i&&t>=a&&t<=a+o}else if(n.type==="circle"){const s=(n.startX+n.endX)/2,a=(n.startY+n.endY)/2,i=Math.sqrt(Math.pow(n.endX-n.startX,2)+Math.pow(n.endY-n.startY,2))/2;return Math.sqrt(Math.pow(e-s,2)+Math.pow(t-a,2))<=i}return!1},FF=(e,t,r,n)=>{const s=[];for(const a of n)if(Array.isArray(a)){const i=eie(a,e,t,r);s.push(...i)}else a.type==="line"?GB(e,t,a.startX,a.startY,a.endX,a.endY)>r/2&&s.push(a):(a.type==="rectangle"||a.type==="circle")&&(tie(e,t,r,a)||s.push(a));return s},rie=(e,t,r,n,s,a,i,o,c)=>{const[u,d]=S.useState({isActive:!1,type:null,lastDistance:null,lastCenter:null}),f=S.useCallback(P=>{if(P.evt.preventDefault(),P.evt.stopPropagation(),e.currentTool===ml.PAN)return;const F=P.target.getStage(),A=Vg(P,F),j=PF(A,e.currentColor,e.currentThickness);e.currentTool===ml.PENCIL?t(I=>({...I,isDrawing:!0,currentLine:[j]})):[ml.LINE,ml.RECTANGLE,ml.CIRCLE].includes(e.currentTool)&&t(I=>({...I,isDrawing:!0,currentShape:Qae(e.currentTool,A,A,e.currentColor,e.currentThickness)}))},[e.currentTool,e.currentColor,e.currentThickness,t]),g=S.useCallback(P=>{const F=FF(P.x,P.y,e.eraserSize,r);n(F),s(F)},[e.eraserSize,r,n,s]),p=S.useCallback(P=>{o&&(a(),v("Undo",P))},[o,a]),x=S.useCallback(P=>{c&&(i(),v("Redo",P))},[c,i]),v=S.useCallback((P,F)=>{const A=F.target.getStage(),j=Vg(F,A),I=new Konva.Circle({x:j.x,y:j.y,radius:20,stroke:"#4CAF50",strokeWidth:3,opacity:.8,listening:!1});A.add(I),I.to({scaleX:2,scaleY:2,opacity:0,duration:.3,onFinish:()=>{I.destroy()}})},[]),w=S.useCallback(P=>{if(P.evt.preventDefault(),P.evt.stopPropagation(),!e.isDrawing)return;const F=P.target.getStage(),A=Vg(P,F),j=PF(A,e.currentColor,e.currentThickness);e.currentTool===ml.PENCIL?t(I=>({...I,currentLine:[...I.currentLine,j]})):e.currentShape&&t(I=>({...I,currentShape:{...I.currentShape,endX:A.x,endY:A.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape,t]),C=S.useCallback(P=>{P&&P.evt&&(P.evt.preventDefault(),P.evt.stopPropagation()),e.isDrawing&&(e.currentTool===ml.PENCIL&&e.currentLine.length>0?n(F=>[...F,e.currentLine]):e.currentShape&&n(F=>[...F,e.currentShape]),t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null})))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,n,t]),k=S.useCallback(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;if(F.length===2)d({isActive:!0,type:"pan",lastDistance:rm(F),lastCenter:uf(F)});else if(F.length===1)if(e.currentTool===ml.ERASER){const A=P.target.getStage(),j=Vg(P,A);g(j)}else e.currentTool===ml.UNDO?p(P):e.currentTool===ml.REDO?x(P):f(P)},[rm,uf,f,e.currentTool,g,p,x]),_=S.useCallback(Xae(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;if(F.length===2&&u.isActive){const A=Yae(F,u);if(A==="zoom"){const j=rm(F),I=uf(F),B=j/u.lastDistance,Y=Math.max(.25,Math.min(1,e.zoom*B));t(Z=>({...Z,zoom:Y,position:{x:I.x-(I.x-Z.position.x)*(Y/Z.zoom),y:I.y-(I.y-Z.position.y)*(Y/Z.zoom)}}))}else if(A==="pan"){const j=uf(F),I=j.x-u.lastCenter.x,B=j.y-u.lastCenter.y;t(Y=>({...Y,position:{x:Y.position.x+I,y:Y.position.y+B}}))}d(j=>({...j,lastDistance:rm(F),lastCenter:uf(F)}))}else if(F.length===1)if(e.currentTool===ml.ERASER){const A=P.target.getStage(),j=Vg(P,A),I=FF(j.x,j.y,e.eraserSize,r);n(I)}else if(e.currentTool===ml.PAN){const A=uf(F),j=A.x-u.lastCenter.x,I=A.y-u.lastCenter.y;t(B=>({...B,position:{x:B.position.x+j,y:B.position.y+I}})),d(B=>({...B,lastCenter:A}))}else w(P)}),[u,e.zoom,t,w]),N=S.useCallback(P=>{_(P)},[_]),E=S.useCallback(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;F.length===0?(C(P),d({isActive:!1,type:null,lastDistance:null,lastCenter:null})):F.length===1&&d(A=>({...A,isActive:!1}))},[C]);return{handleTouchStart:k,handleTouchMove:N,handleTouchEnd:E,handleEraserStart:g,handleUndoTouch:p,handleRedoTouch:x,showTouchFeedback:v}},nie=(e,t)=>{const[r,n]=S.useState(e.MIN),[s,a]=S.useState({x:0,y:0}),i=S.useCallback((g,p,x)=>{const v=Math.max(e.MIN,Math.min(e.MAX,g));if(p){const w=v/r,C={x:p.x-(p.x-s.x)*w,y:p.y-(p.y-s.y)*w};return{zoom:v,position:C}}else{const w=t.width*v,C=t.height*v,k={x:(x.width-w)/2,y:(x.height-C)/2};return{zoom:v,position:k}}},[r,s,e,t]),o=S.useCallback(()=>{const g=Math.min(r*(1+e.STEP),e.MAX);n(g)},[r,e]),c=S.useCallback(()=>{const g=Math.max(r/(1+e.STEP),e.MIN);n(g)},[r,e]),u=S.useCallback((g,p,x)=>{const v=i(g,p,x);n(v.zoom),a(v.position)},[i]),d=S.useCallback((g,p)=>{a(x=>({x:x.x+g,y:x.y+p}))},[]),f=S.useCallback(()=>{n(e.INITIAL),a({x:0,y:0})},[e.INITIAL]);return{zoom:r,setZoom:n,position:s,setPosition:a,handleZoomIn:o,handleZoomOut:c,handleZoomToPoint:u,handlePan:d,resetZoom:f}},sie=e=>{const[t,r]=S.useState([]),[n,s]=S.useState(0),a=S.useCallback(f=>{if(console.log("parseDrawingData - input drawing:",f),console.log("parseDrawingData - drawing.answers:",f?.answers),!f?.answers)return console.log("parseDrawingData - no answers found, returning empty array"),[];try{if(typeof f.answers=="string"){console.log("parseDrawingData - parsing string answers");const g=JSON.parse(f.answers);return console.log("parseDrawingData - parsed string result:",g),g&&typeof g=="object"&&g.lines&&console.log("parseDrawingData - new format detected with lines and textBoxes"),g}if(f.answers&&typeof f.answers=="object"&&f.answers.lines)return console.log("parseDrawingData - answers is new format object"),f.answers;if(Array.isArray(f.answers)){if(console.log("parseDrawingData - answers is array"),f.answers.every(p=>typeof p=="string"))try{const p=f.answers.map(x=>{try{return JSON.parse(x)}catch{return x}});return console.log("parseDrawingData - parsed array elements"),p}catch{return console.log("parseDrawingData - failed to parse array elements, returning raw"),f.answers}return f.answers}return console.log("parseDrawingData - answers is neither string nor array, returning empty array"),[]}catch(g){return console.error("Error parsing drawing data:",g),[]}},[]),i=S.useCallback(f=>{if(console.log("processQuestions - input answers:",f),console.log("processQuestions - answers type:",typeof f),console.log("processQuestions - answers isArray:",Array.isArray(f)),f&&typeof f=="object"&&f.lines){console.log("processQuestions - new format detected with lines and textBoxes"),console.log("processQuestions - lines count:",f.lines?.length),console.log("processQuestions - textBoxes count:",f.textBoxes?.length);const p=o(f.lines);return console.log("processQuestions - canvas groups:",p),console.log("processQuestions - number of canvas groups:",p.length),p.map((x,v)=>(console.log(`processQuestions - canvas ${v} strokes:`,x),console.log(`processQuestions - canvas ${v} stroke count:`,x.length),{questionNumber:v+1,drawingData:x,textBoxes:f.textBoxes||[]}))}if(Array.isArray(f)&&f.every(p=>p&&typeof p=="object"&&p.lines))return console.log("processQuestions - array of {lines,textBoxes} detected"),f.map((p,x)=>({questionNumber:x+1,drawingData:p.lines||[],textBoxes:p.textBoxes||[]}));if(!Array.isArray(f))return console.log("processQuestions - answers is not array or object, returning empty array"),[];console.log("processQuestions - processing",f.length,"answers (old format)");const g=o(f);return console.log("processQuestions - canvas groups:",g),console.log("processQuestions - number of canvas groups:",g.length),g.map((p,x)=>(console.log(`processQuestions - canvas ${x} strokes:`,p),console.log(`processQuestions - canvas ${x} stroke count:`,p.length),{questionNumber:x+1,drawingData:p,textBoxes:[]}))},[]),o=S.useCallback(f=>{console.log("groupStrokesByCanvas - input answers:",f);const g=c(f);return console.log("groupStrokesByCanvas - using strategy:",g),g==="by_question_boundary"?u(f):g==="by_stroke_type"?d(f):[f]},[]),c=S.useCallback(f=>{console.log("determineGroupingStrategy - analyzing answers:",f);let g=0,p=0;return f.forEach(x=>{Array.isArray(x)?g++:typeof x=="object"&&p++}),console.log("determineGroupingStrategy - arrayCount:",g,"objectCount:",p),g>0&&p>0?"by_stroke_type":f.length>3?"by_question_boundary":"single_canvas"},[]),u=S.useCallback(f=>{console.log("groupByQuestionBoundary - grouping answers:",f);const g=[];let p=[];const x=Math.ceil(f.length/2);for(let v=0;v<f.length;v++)p.push(f[v]),(v+1)%x===0&&v<f.length-1&&(g.push([...p]),p=[]);return p.length>0&&g.push(p),console.log("groupByQuestionBoundary - result:",g),g},[]),d=S.useCallback(f=>{console.log("groupByStrokeType - grouping answers:",f);const g=[],p=[];f.forEach(v=>{Array.isArray(v)?g.push(v):typeof v=="object"&&p.push(v)});const x=[];return g.length>0&&x.push(g),p.length>0&&x.push(p),console.log("groupByStrokeType - result:",x),x},[]);return S.useEffect(()=>{if(e){console.log("useDataParsing - drawing object:",e),console.log("useDataParsing - drawing.answers:",e.answers),console.log("useDataParsing - drawing.answers type:",typeof e.answers),console.log("useDataParsing - drawing.answers length:",e.answers?.length);const f=a(e);console.log("useDataParsing - parsed answers:",f),console.log("useDataParsing - parsed answers type:",typeof f),console.log("useDataParsing - parsed answers length:",f?.length);const g=i(f);console.log("useDataParsing - processed questions:",g),console.log("useDataParsing - processed questions length:",g?.length),g.length>0&&(console.log("useDataParsing - first question drawingData:",g[0]?.drawingData),console.log("useDataParsing - first question drawingData length:",g[0]?.drawingData?.length)),r(g),s(0)}},[e,a,i]),{questionsData:t,setQuestionsData:r,currentQuestionIndex:n,setCurrentQuestionIndex:s,parseDrawingData:a,processQuestions:i}},OF={MIN:.25,INITIAL:1},aie=(e,t)=>{const[r,n]=S.useState(!1),[s,a]=S.useState(null),i=S.useCallback(()=>{document.fullscreenElement||(a({zoom:e.zoom,position:{...e.position}}),document.documentElement.requestFullscreen().then(()=>{n(!0),t(c=>({...c,zoom:OF.MIN,position:{x:0,y:0},isFullscreen:!0}))}).catch(c=>{console.error("Error entering fullscreen:",c)}))},[e.zoom,e.position,t]),o=S.useCallback(()=>{document.fullscreenElement&&document.exitFullscreen().then(()=>{n(!1),s?(t(c=>({...c,zoom:s.zoom,position:s.position,isFullscreen:!1})),a(null)):t(c=>({...c,zoom:OF.INITIAL,position:{x:0,y:0},isFullscreen:!1}))}).catch(c=>{console.error("Error exiting fullscreen:",c)})},[s,t]);return{isFullscreen:r,enterFullscreen:i,exitFullscreen:o}},VB=S.forwardRef(({drawingData:e,textBoxes:t=[],drawingState:r,canvasSize:n,zoom:s,position:a,onTouchStart:i,onTouchMove:o,onTouchEnd:c,mousePosition:u,isMouseOverCanvas:d,isEraserDrawing:f},g)=>{const p=S.useRef(null),[x,v]=S.useState(.25),[w,C]=S.useState(null),[k,_]=S.useState({x:0,y:0}),[N,E]=S.useState(!1),P=S.useCallback(({x:H,y:W,size:R,visible:z,isDrawing:K})=>!z||!H||!W?null:l.jsx(wf,{x:H,y:W,radius:R/2,stroke:kF.CURSOR_COLOR,strokeWidth:2,dash:[5,5],opacity:K?.8:kF.CURSOR_OPACITY,listening:!1,zIndex:1e3}),[]),F=S.useCallback(H=>{if(r.currentTool===Th.ERASER){const W=H.target.getStage(),R=Vg(H,W);_(R)}},[r.currentTool]),A=S.useCallback(()=>{r.currentTool===Th.ERASER&&E(!0)},[r.currentTool]),j=S.useCallback(()=>{E(!1)},[]);S.useEffect(()=>{const H=g.current;if(H)return H.on("mousemove",F),H.on("mouseenter",A),H.on("mouseleave",j),()=>{H.off("mousemove",F),H.off("mouseenter",A),H.off("mouseleave",j)}},[F,A,j,g]),S.useEffect(()=>{const H=n.width??n.WIDTH,W=n.height??n.HEIGHT,R=()=>{const z=p.current;if(!z)return;const K=z.clientWidth||1,Q=z.clientHeight||1,ae=Math.abs(r.rotation%180)===90,X=ae?W:H,ie=ae?H:W,le=Math.min(K/(X||1),Q/(ie||1));v(Math.min(le,1))};return R(),window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[n.width,n.height,n.WIDTH,n.HEIGHT,r.rotation]);const I=S.useMemo(()=>{const H=p.current;if(!H||!w)return 0;const W=H.clientWidth||1,R=H.clientHeight||1,z=Math.min(W/Math.max(w.width,1),R/Math.max(w.height,1));return Math.min(z,WB.MAX)},[w]),B=S.useMemo(()=>Math.max(s,x||1),[s,x]),Y=S.useMemo(()=>{const H=n.width??n.WIDTH,W=n.height??n.HEIGHT;if(!p.current)return{x:0,y:0};const R=p.current.clientWidth||1,z=p.current.clientHeight||1,K=(R-H*B)/2,Q=(z-W*B)/2;return s<=x?{x:K,y:Q}:{x:a.x!==void 0?a.x:K,y:a.y!==void 0?a.y:Q}},[a,s,x,B,n.width,n.height,w,I]);S.useEffect(()=>{if(!Array.isArray(e)||e.length===0){C(null);return}let H=1/0,W=1/0,R=-1/0,z=-1/0;const K=(ie,le)=>{Number.isFinite(ie)&&Number.isFinite(le)&&(ie<H&&(H=ie),le<W&&(W=le),ie>R&&(R=ie),le>z&&(z=le))};if(e.forEach(ie=>{if(Array.isArray(ie))ie.forEach(le=>K(le.x,le.y));else if(ie&&typeof ie=="object"){if(ie.type==="line")K(ie.startX,ie.startY),K(ie.endX,ie.endY);else if(ie.type==="rectangle")K(ie.startX,ie.startY),K(ie.endX,ie.endY);else if(ie.type==="circle"){const le=Math.sqrt(Math.pow(ie.endX-ie.startX,2)+Math.pow(ie.endY-ie.startY,2))/2,ce=(ie.startX+ie.endX)/2,_e=(ie.startY+ie.endY)/2;K(ce-le,_e-le),K(ce+le,_e+le)}}}),!Number.isFinite(H)||!Number.isFinite(W)||!Number.isFinite(R)||!Number.isFinite(z)){C(null);return}const Q=16,ae=Math.max(1,R-H+Q*2),X=Math.max(1,z-W+Q*2);C({minX:H-Q,minY:W-Q,width:ae,height:X})},[e]),S.useEffect(()=>{console.log("CanvasViewer - drawingData:",e),console.log("CanvasViewer - drawingData length:",e?.length),console.log("CanvasViewer - textBoxes:",t),console.log("CanvasViewer - textBoxes length:",t?.length),e&&e.length>0&&console.log("CanvasViewer - first item:",e[0]),t&&t.length>0&&console.log("CanvasViewer - first textBox:",t[0])},[e,t]),S.useEffect(()=>{const H=n.width??n.WIDTH,W=n.height??n.HEIGHT;console.log("CanvasViewer - canvas dimensions:",{width:H,height:W}),console.log("CanvasViewer - zoom:",s,"fitZoom:",x,"displayScale:",B),console.log("CanvasViewer - stagePosition:",Y)},[n,s,x,B,Y]);const Z=(H,W)=>{if(console.log(`CanvasViewer - rendering element ${W}:`,H),Array.isArray(H))return console.log(`CanvasViewer - rendering line with ${H.length} points`),l.jsx(ui,{points:H.flatMap(R=>[R.x,R.y]),stroke:H[0]?.color||"#000000",strokeWidth:H[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},W);if(H.type==="line")return l.jsx(ui,{points:[H.startX,H.startY,H.endX,H.endY],stroke:H.color,strokeWidth:H.thickness,lineCap:"round"},W);if(H.type==="rectangle"){const R=Math.abs(H.endX-H.startX),z=Math.abs(H.endY-H.startY),K=Math.min(H.startX,H.endX),Q=Math.min(H.startY,H.endY);return l.jsx(Ga,{x:K,y:Q,width:R,height:z,stroke:H.color,strokeWidth:H.thickness,fill:"transparent"},W)}else if(H.type==="circle"){const R=Math.sqrt(Math.pow(H.endX-H.startX,2)+Math.pow(H.endY-H.startY,2))/2,z=(H.startX+H.endX)/2,K=(H.startY+H.endY)/2;return l.jsx(wf,{x:z,y:K,radius:R,stroke:H.color,strokeWidth:H.thickness,fill:"transparent"},W)}return null},se=()=>{if(!r.isDrawing)return null;if(r.currentTool===Th.PENCIL&&r.currentLine.length>0)return l.jsx(ui,{points:r.currentLine.flatMap(H=>[H.x,H.y]),stroke:r.currentColor,strokeWidth:r.currentThickness,tension:.5,lineCap:"round",lineJoin:"round"});if(r.currentShape){const{type:H,startX:W,startY:R,endX:z,endY:K,color:Q,thickness:ae}=r.currentShape;if(H===Th.LINE)return l.jsx(ui,{points:[W,R,z,K],stroke:Q,strokeWidth:ae,lineCap:"round"});if(H===Th.RECTANGLE){const X=Math.abs(z-W),ie=Math.abs(K-R),le=Math.min(W,z),ce=Math.min(R,K);return l.jsx(Ga,{x:le,y:ce,width:X,height:ie,stroke:Q,strokeWidth:ae,fill:"transparent"})}else if(H===Th.CIRCLE){const X=Math.sqrt(Math.pow(z-W,2)+Math.pow(K-R,2))/2,ie=(W+z)/2,le=(R+K)/2;return l.jsx(wf,{x:ie,y:le,radius:X,stroke:Q,strokeWidth:ae,fill:"transparent"})}}return null},ee=r.isFullscreen?{position:"fixed",inset:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",zIndex:60}:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"},te={transform:`rotate(${r.rotation}deg)`,transformOrigin:"center center"},L=S.useCallback(H=>{H.preventDefault(),H.stopPropagation()},[]),V=S.useCallback(H=>{H.preventDefault(),H.stopPropagation()},[]),M=S.useCallback(H=>{H.preventDefault(),H.stopPropagation()},[]);return l.jsx("div",{style:{...ee,touchAction:"none",WebkitTouchCallout:"none"},ref:p,className:"select-none",onTouchStart:L,onTouchMove:V,onTouchEnd:M,children:l.jsx("div",{style:{...te,touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onTouchStart:L,onTouchMove:V,onTouchEnd:M,children:l.jsx(n0,{ref:g,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),scaleX:B,scaleY:B,x:Y.x,y:Y.y,onTouchStart:i,onTouchMove:o,onTouchEnd:c,children:l.jsxs(r0,{children:[l.jsx(Ga,{x:0,y:0,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),fill:"white"}),e.map((H,W)=>(console.log(`CanvasViewer - mapping item ${W}:`,H),Z(H,W))),t&&t.map((H,W)=>l.jsx(Ga,{x:H.x,y:H.y,width:H.width,height:H.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}},`textbox-${W}`)),t&&t.map((H,W)=>l.jsx(qc,{x:H.x+8,y:H.y+8,width:H.width-16,height:H.height-16,text:H.text,fontSize:H.fontSize||14,fill:H.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"},`text-${W}`)),se(),r.currentTool===Th.ERASER&&l.jsx(P,{x:k.x,y:k.y,size:r.eraserSize,visible:N,isDrawing:f})]})})})})});VB.displayName="CanvasViewer";function iie({containerRef:e,canvasSize:t,rotation:r=0}){const[n,s]=S.useState(1),[a,i]=S.useState({x:0,y:0}),o=S.useRef({width:1,height:1}),c=S.useRef(.01),u=S.useRef(0),d=S.useRef(!1),f=S.useCallback(()=>{const N=t?.width??t?.WIDTH??0,E=t?.height??t?.HEIGHT??0,P=Math.abs(r%180)===90;return{width:P?E:N,height:P?N:E}},[t,r]),g=S.useCallback(()=>{const N=e?.current;if(!N)return{width:1,height:1};const E=N.clientWidth||1,P=N.clientHeight||1;return o.current={width:E,height:P},{width:E,height:P}},[e]),p=S.useCallback(()=>{const{width:N,height:E}=o.current,{width:P,height:F}=f(),A=N/Math.max(P,1),j=E/Math.max(F,1);return Math.min(A,j,1)*.98},[f]),x=S.useCallback(N=>{const{width:E,height:P}=o.current,{width:F,height:A}=f(),j=Math.max(c.current,Math.min(N,1.5));let I=(E-F*j)/2,B=(P-A*j)/2;const Y=E-F*j,Z=P-A*j;I=Math.min(Math.max(0,I),Math.max(0,Y)),B=Math.min(Math.max(0,B),Math.max(0,Z));try{console.log("[Camera] centerAtScale",{targetScale:N,clampedScale:j,container:{containerW:E,containerH:P},canvas:{canvasW:F,canvasH:A},translate:{x:I,y:B},rotation:r})}catch{}i({x:I,y:B}),s(j)},[f]),v=S.useCallback(()=>{const{width:N,height:E}=g(),{width:P,height:F}=f(),A=p();let j=(N-P*A)/2,I=(E-F*A)/2;const B=N-P*A,Y=E-F*A;j=Math.min(Math.max(0,j),Math.max(0,B)),I=Math.min(Math.max(0,I),Math.max(0,Y));try{console.log("[Camera] fitCanvas",{scale:A,container:{containerW:N,containerH:E},canvas:{canvasW:P,canvasH:F},translate:{x:j,y:I},rotation:r})}catch{}s(A),i({x:j,y:I}),c.current=A,d.current=!1},[f,g,p]),w=S.useCallback(()=>{const{width:N,height:E}=g(),{width:P,height:F}=f(),A=(N-P)/2,j=(E-F)/2;s(1),i({x:A,y:j})},[f,g]),C=S.useCallback((N,E)=>{const{width:P,height:F}=o.current,{width:A,height:j}=f(),I=Math.max(c.current,Math.min(N,1.5));if(E&&Number.isFinite(E.x)&&Number.isFinite(E.y)){const B={x:(E.x-a.x)/n,y:(E.y-a.y)/n},Y=E.x-B.x*I,Z=E.y-B.y*I;try{console.log("[Camera] zoomTo(pointer) ->",{from:n,to:I})}catch{}s(I),i({x:Y,y:Z}),u.current=Date.now()+400,d.current=!0}else{let B=(P-A*I)/2,Y=(F-j*I)/2;const Z=P-A*I,se=F-j*I;B=Math.min(Math.max(0,B),Math.max(0,Z)),Y=Math.min(Math.max(0,Y),Math.max(0,se));try{console.log("[Camera] zoomTo(center) ->",{from:n,to:I})}catch{}s(I),i({x:B,y:Y}),u.current=Date.now()+400,d.current=!0}},[f,n,a]),k=S.useCallback((N,E)=>{const P=n*N,{width:F,height:A}=o.current,j={x:F/2,y:A/2};C(P,E||j)},[n,C]),_=S.useCallback((N,E)=>{i(P=>({x:P.x+N,y:P.y+E})),u.current=Date.now()+200,d.current=!0},[]);return S.useEffect(()=>{const N=e?.current;if(!N)return;const E=new ResizeObserver(()=>{g();const P=p();if(c.current=P,!(Date.now()<u.current)&&!d.current){try{console.log("[Camera] resize centerAtScale",{scale:n})}catch{}x(n)}});return E.observe(N),g(),()=>E.disconnect()},[e,g,p,x,n]),S.useEffect(()=>{d.current=!1,c.current=p(),x(n)},[r,t?.width,t?.height,t?.WIDTH,t?.HEIGHT,p,x,n]),S.useMemo(()=>({scale:n,translate:a,setScale:s,setTranslate:i,centerAtScale:x,fitCanvas:v,oneToOne:w,zoomTo:C,zoomByFactor:k,panBy:_}),[n,a,x,v,w,C,k,_])}const Zx=new Map,KB=S.forwardRef(({drawingData:e,textBoxes:t=[],canvasSize:r,rotation:n=0,onScaleChange:s,persistKey:a="viewer",onTextBoxEdit:i},o)=>{const c=S.useRef(null),u=S.useRef(null),d=iie({containerRef:c,canvasSize:r,rotation:n}),[f,g]=S.useState({width:1,height:1}),p=S.useRef(null),x=S.useRef(null),[v,w]=S.useState(null);S.useEffect(()=>{console.log("[ViewerCanvas] drawingData received:",e),console.log("[ViewerCanvas] drawingData length:",e?.length),e&&e.length>0&&console.log("[ViewerCanvas] First drawing element:",e[0]),console.log("[ViewerCanvas] textBoxes:",t),console.log("[ViewerCanvas] textBoxes length:",t?.length)},[e]),S.useEffect(()=>{typeof s=="function"&&s(d.scale);try{console.log("[ViewerCanvas] scale changed",{scale:d.scale})}catch{}if(a){const M=Zx.get(a)||{};Zx.set(a,{...M,scale:d.scale})}},[d.scale,s]),S.useEffect(()=>{if(a){const M=Zx.get(a)||{};Zx.set(a,{...M,translate:{x:d.translate.x,y:d.translate.y}})}},[a,d.translate.x,d.translate.y]),S.useImperativeHandle(o,()=>({zoomIn:M=>d.zoomByFactor(1.1,M),zoomOut:M=>d.zoomByFactor(1/1.1,M),fitCanvas:()=>d.fitCanvas(),oneToOne:()=>d.oneToOne(),getScale:()=>d.scale,getStage:()=>u.current,getPointerPosition:()=>u.current?.getPointerPosition?.(),exportPNGFullCanvas:()=>{const M=u.current;if(!M)return null;const H=r?.width??r?.WIDTH??1536,W=r?.height??r?.HEIGHT??2048,R={scaleX:M.scaleX(),scaleY:M.scaleY(),x:M.x(),y:M.y(),width:M.width(),height:M.height()},z=p.current,K=x.current,Q=z?{x:z.x(),y:z.y(),scaleX:z.scaleX(),scaleY:z.scaleY()}:null,ae=K?{x:K.x(),y:K.y(),rotation:K.rotation()}:null;try{return M.scale({x:1,y:1}),M.position({x:0,y:0}),M.size({width:H,height:W}),z&&(z.position({x:0,y:0}),z.scale({x:1,y:1})),K&&(K.position({x:0,y:0}),K.rotation(0)),M.batchDraw(),M.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:H,height:W})}finally{K&&ae&&(K.position({x:ae.x,y:ae.y}),K.rotation(ae.rotation)),z&&Q&&(z.position({x:Q.x,y:Q.y}),z.scale({x:Q.scaleX,y:Q.scaleY})),M.scale({x:R.scaleX,y:R.scaleY}),M.position({x:R.x,y:R.y}),M.size({width:R.width,height:R.height}),M.batchDraw()}}}),[d]),S.useEffect(()=>{const M=c.current;if(!M)return;const H=()=>{g({width:M.clientWidth||1,height:M.clientHeight||1})};H();const W=new ResizeObserver(H);return W.observe(M),()=>W.disconnect()},[]),S.useEffect(()=>{if(!Array.isArray(e)||e.length===0){w(null);return}let M=1/0,H=1/0,W=-1/0,R=-1/0;const z=(X,ie)=>{Number.isFinite(X)&&Number.isFinite(ie)&&(X<M&&(M=X),ie<H&&(H=ie),X>W&&(W=X),ie>R&&(R=ie))};if(e.forEach(X=>{if(Array.isArray(X))X.forEach(ie=>z(ie.x,ie.y));else if(X&&typeof X=="object"){if(X.type==="line")z(X.startX,X.startY),z(X.endX,X.endY);else if(X.type==="rectangle")z(X.startX,X.startY),z(X.endX,X.endY);else if(X.type==="circle"){const ie=Math.hypot(X.endX-X.startX,X.endY-X.startY)/2,le=(X.startX+X.endX)/2,ce=(X.startY+X.endY)/2;z(le-ie,ce-ie),z(le+ie,ce+ie)}}}),!Number.isFinite(M)||!Number.isFinite(H)||!Number.isFinite(W)||!Number.isFinite(R)){w(null);return}const K=16,Q=Math.max(1,W-M+K*2),ae=Math.max(1,R-H+K*2);w({minX:M-K,minY:H-K,width:Q,height:ae,centerX:M-K+Q/2,centerY:H-K+ae/2})},[e]);const C=S.useMemo(()=>{if(!v)return{scale:1,x:0,y:0};const M=r?.width??r?.WIDTH??1536,H=r?.height??r?.HEIGHT??2048,W=Math.min(M/Math.max(1,v.width),H/Math.max(1,v.height),1),R=v.width*W,z=v.height*W,K=(M-R)/2,Q=(H-z)/2,ae=K-v.minX*W,X=Q-v.minY*W;return{scale:W,x:ae,y:X}},[v,r?.width,r?.height,r?.WIDTH,r?.HEIGHT]),k=S.useRef(!1);S.useEffect(()=>{if(k.current)return;const M=a?Zx.get(a):null;M&&Number.isFinite(M.scale)&&M.translate&&Number.isFinite(M.translate.x)&&Number.isFinite(M.translate.y)?(d.setScale(M.scale),d.setTranslate(M.translate)):d.fitCanvas(),k.current=!0},[a,d]),S.useEffect(()=>{try{console.log("[ViewerCanvas] rotation changed",{rotation:n,scale:d.scale,translate:d.translate})}catch{}d.fitCanvas()},[n]),S.useEffect(()=>{d.centerAtScale(d.scale)},[n]);const _=M=>{M.evt.preventDefault();const H=u.current;if(!H)return;const W=H.getPointerPosition(),R=Math.pow(1.0015,-M.evt.deltaY);d.zoomByFactor(R,W)},N=S.useRef(!1),E=S.useRef({x:0,y:0}),P=()=>{const M=c.current;if(!M)return 1;const H=M.clientWidth||1,W=M.clientHeight||1,R=r?.width??r?.WIDTH??1,z=r?.height??r?.HEIGHT??1,K=Math.abs(n%180)===90,Q=K?z:R,ae=K?R:z,X=Math.min(H/Q,W/ae);return Math.min(X,1)},F=M=>{const H=P();d.scale<=H||(N.current=!0,E.current={x:M.evt.clientX,y:M.evt.clientY})},A=M=>{if(!N.current)return;const H=M.evt.clientX-E.current.x,W=M.evt.clientY-E.current.y;E.current={x:M.evt.clientX,y:M.evt.clientY},d.panBy(H,W)},j=()=>{N.current=!1},I=1536,B=2048,Y=(M,H)=>{if(console.log(`[ViewerCanvas] Rendering drawing element ${H}:`,M),Array.isArray(M))return console.log(`[ViewerCanvas] Array item with ${M.length} points:`,M.slice(0,3)),l.jsx(ui,{points:M.flatMap(W=>[W.x,W.y]),stroke:M[0]?.color||"#000000",strokeWidth:M[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},H);if(M?.type==="line")return l.jsx(ui,{points:[M.startX,M.startY,M.endX,M.endY],stroke:M.color,strokeWidth:M.thickness,lineCap:"round"},H);if(M?.type==="rectangle"){const W=Math.abs(M.endX-M.startX),R=Math.abs(M.endY-M.startY),z=Math.min(M.startX,M.endX),K=Math.min(M.startY,M.endY);return l.jsx(Ga,{x:z,y:K,width:W,height:R,stroke:M.color,strokeWidth:M.thickness,fill:"transparent"},H)}else if(M?.type==="circle"){const W=Math.sqrt(Math.pow(M.endX-M.startX,2)+Math.pow(M.endY-M.startY,2))/2,R=(M.startX+M.endX)/2,z=(M.startY+M.endY)/2;return l.jsx(wf,{x:R,y:z,radius:W,stroke:M.color,strokeWidth:M.thickness,fill:"transparent"},H)}return null},Z=S.useRef(new Map),se=S.useRef(null),ee=S.useRef({x:0,y:0}),te=S.useCallback(M=>{const H=c.current;H&&(H.setPointerCapture?.(M.pointerId),Z.current.set(M.pointerId,{x:M.clientX,y:M.clientY}),E.current={x:M.clientX,y:M.clientY})},[]),L=S.useCallback(M=>{const H=Z.current;if(H.has(M.pointerId)){if(H.set(M.pointerId,{x:M.clientX,y:M.clientY}),H.size===2){const W=Array.from(H.values()),R=W[1].x-W[0].x,z=W[1].y-W[0].y,K=Math.hypot(R,z),Q={x:(W[0].x+W[1].x)/2,y:(W[0].y+W[1].y)/2},ae=u.current,X=ae&&ae.getPointerPosition()||Q;if(se.current!=null){const ie=K/Math.max(1,se.current);d.zoomByFactor(ie,X)}se.current=K,ee.current=X}else if(H.size===1){const W=P();if(d.scale<=W)return;const R=M.clientX-E.current.x,z=M.clientY-E.current.y;E.current={x:M.clientX,y:M.clientY},d.panBy(R,z)}}},[]),V=S.useCallback(M=>{const H=c.current;H&&(H.releasePointerCapture?.(M.pointerId),Z.current.delete(M.pointerId),Z.current.size<2&&(se.current=null),N.current=!1)},[]);return l.jsx("div",{ref:c,style:{width:"100%",height:"100%",display:"block",backgroundColor:"transparent",touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onPointerDown:te,onPointerMove:L,onPointerUp:V,children:l.jsx(n0,{ref:u,width:f.width,height:f.height,onWheel:_,onMouseDown:F,onMouseMove:A,onMouseUp:j,onMouseLeave:j,children:l.jsx(r0,{children:l.jsx(cc,{ref:p,x:d.translate.x,y:d.translate.y,scaleX:d.scale,scaleY:d.scale,children:(()=>{const M=(n%360+360)%360;let H=0,W=0;M===90?H=B:M===180?(H=I,W=B):M===270&&(W=I);try{console.log("[ViewerCanvas] rotatedGroup offset",{rotation:n,norm:M,tx:H,ty:W,canvasW:I,canvasH:B})}catch{}return l.jsxs(cc,{ref:x,x:H,y:W,rotation:n,children:[l.jsx(Ga,{x:0,y:0,width:I,height:B,fill:"white"}),l.jsxs(cc,{x:C.x,y:C.y,scaleX:C.scale,scaleY:C.scale,children:[Array.isArray(e)?(console.log("[ViewerCanvas] Rendering",e.length,"drawing elements"),e.map((R,z)=>Y(R,z))):null,Array.isArray(t)&&t.map((R,z)=>l.jsxs(cc,{x:R.x,y:R.y,children:[l.jsx(Ga,{width:R.width,height:R.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),l.jsx(qc,{text:R.text,x:8,y:8,width:Math.max(0,(R.width||0)-16),height:Math.max(0,(R.height||0)-16),fontSize:R.fontSize||14,fill:R.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"})]},`tb-${z}`))]})]})})()})})})})});KB.displayName="ViewerCanvas";const oie=({zoom:e,onZoomIn:t,onZoomOut:r,onRotate:n,onDownload:s,onFullscreen:a,isFullscreen:i})=>l.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 items-center justify-center",children:[l.jsx(Ze,{onClick:t,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:l.jsx(Bae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ze,{onClick:r,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:l.jsx(Uae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ze,{onClick:n,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:l.jsx(Rae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ze,{onClick:s,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:l.jsx(Fae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ze,{onClick:a,variant:"secondary",size:"icon",className:"w-10 h-10",title:i?"Exit Fullscreen":"Enter Fullscreen",children:i?l.jsx(zB,{className:"w-4 h-4 mx-auto my-auto"}):l.jsx(Dae,{className:"w-4 h-4 mx-auto my-auto"})})]}),lie=({currentQuestion:e,totalQuestions:t,onPrevious:r,onNext:n,drawingDataLength:s})=>t<=1?null:l.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ze,{onClick:r,disabled:e===0,variant:"outline",size:"sm",children:"Previous"}),l.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",e+1," of ",t]}),l.jsx(Ze,{onClick:n,disabled:e===t-1,variant:"outline",size:"sm",children:"Next"})]}),l.jsxs("div",{className:"text-sm text-gray-500",children:[s," lines"]})]})}),qB=({drawing:e,isOpen:t,onClose:r,onScoreChange:n,onMaxScoreChange:s,isTeacherView:a=!1,onSaveScore:i})=>{const{drawingState:o,setDrawingState:c,drawingData:u,setDrawingData:d,textBoxes:f,setTextBoxes:g,saveToHistoryState:p,undo:x,redo:v,canUndoState:w,canRedoState:C}=qae(),{questionsData:k,currentQuestionIndex:_,setCurrentQuestionIndex:N}=sie(e),{zoom:E,position:P,handleZoomIn:F,handleZoomOut:A}=nie(WB,nc),{isFullscreen:j,enterFullscreen:I,exitFullscreen:B}=aie(o,c),{handleTouchStart:Y,handleTouchMove:Z,handleTouchEnd:se}=rie(o,c,u,d,p,x,v,w,C),ee=S.useRef(null),te=S.useRef(null),[L,V]=S.useState(1),[M,H]=S.useState(""),[W,R]=S.useState("");S.useEffect(()=>{if(console.log("DrawingModal - questionsData:",k),console.log("DrawingModal - currentQuestionIndex:",_),k.length>0){const ce=k[_]?.drawingData||[],_e=k[_]?.textBoxes||[];console.log("DrawingModal - setting drawingData:",ce),console.log("DrawingModal - setting textBoxes:",_e),d(ce),g(_e)}},[k,_,d,g]),S.useEffect(()=>{t&&e&&(H((Number.isFinite(e.score)?e.score:0).toString()),R("10"))},[t,e]);const z=()=>{_>0&&N(_-1)},K=()=>{_<k.length-1&&N(_+1)},Q=()=>{w&&x()},ae=()=>{C&&v()};S.useEffect(()=>{const ce=_e=>{(_e.ctrlKey||_e.metaKey)&&(_e.key==="z"&&!_e.shiftKey?(_e.preventDefault(),Q()):(_e.key==="y"||_e.key==="z"&&_e.shiftKey)&&(_e.preventDefault(),ae()))};return document.addEventListener("keydown",ce),()=>document.removeEventListener("keydown",ce)},[Q,ae]);const X=()=>{c(ce=>({...ce,rotation:(ce.rotation+90)%360}))},ie=()=>{if(a&&te.current){const pe=te.current.exportPNGFullCanvas();if(!pe)return;const Ce=document.createElement("a");Ce.href=pe,Ce.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(Ce),Ce.click(),document.body.removeChild(Ce);return}const ce=ee.current;if(!ce)return;const _e=ce.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:nc.WIDTH,height:nc.HEIGHT}),ne=document.createElement("a");ne.href=_e,ne.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(ne),ne.click(),document.body.removeChild(ne)},le=async()=>{if(!a)return r();const ce=parseInt(M,10),_e=10;Number.isFinite(ce)&&(typeof i=="function"?await i({resultId:e.id,score:Math.max(0,Math.min(10,ce)),maxScore:_e}):(n&&n(e.id,ce),s&&s(e.id,_e))),r()};return!t||!e?null:l.jsx(ko,{children:l.jsx(at.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:l.jsxs(at.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl h-[90vh] w-full mx-4 flex flex-col select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:ce=>ce.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[e.name," ",e.surname," - ",e.test_name]})]}),l.jsx(Ze,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:l.jsx(zB,{className:"w-5 h-5"})})]}),k.length>1&&l.jsx(lie,{currentQuestion:_,totalQuestions:k.length,onPrevious:z,onNext:K,drawingDataLength:k[_]?.drawingData?.length||0}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[l.jsxs("div",{className:"flex-1 min-h-0 relative overflow-hidden bg-gray-100 p-0 sm:p-4 select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},children:[a?l.jsx(KB,{ref:te,drawingData:u,textBoxes:f,canvasSize:{width:nc.WIDTH,height:nc.HEIGHT,WIDTH:nc.WIDTH,HEIGHT:nc.HEIGHT},rotation:o.rotation,onScaleChange:V}):l.jsx(VB,{ref:ee,drawingData:u,textBoxes:f,drawingState:o,canvasSize:{width:nc.WIDTH,height:nc.HEIGHT,WIDTH:nc.WIDTH,HEIGHT:nc.HEIGHT},zoom:E,position:P,onTouchStart:Y,onTouchMove:Z,onTouchEnd:se,mousePosition:{x:0,y:0},isMouseOverCanvas:!1,isEraserDrawing:!1}),l.jsx(oie,{zoom:a?L:E,onZoomIn:()=>{if(a&&te.current){try{console.log("[ZoomButton] ZoomIn click (teacher)",{before:te.current.getScale?.()})}catch{}te.current.zoomIn(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomIn after",{after:te.current.getScale?.()})}catch{}},0)}else F()},onZoomOut:()=>{if(a&&te.current){try{console.log("[ZoomButton] ZoomOut click (teacher)",{before:te.current.getScale?.()})}catch{}te.current.zoomOut(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomOut after",{after:te.current.getScale?.()})}catch{}},0)}else A()},onRotate:X,onDownload:ie,onFullscreen:j?B:I,isFullscreen:j}),l.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white px-3 py-1 rounded-full text-sm",children:[Math.round((a?L:E)*100),"%"]})]}),a&&l.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Score:"}),l.jsx("input",{type:"number",min:"0",max:10,value:M,onChange:ce=>H(ce.target.value),className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max:"}),l.jsx("input",{type:"number",value:10,disabled:!0,className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded bg-gray-100"})]}),l.jsx(Ze,{onClick:le,variant:"primary",size:"sm",children:"Save"})]})})]})]})})})},YB=({testType:e,testId:t,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:o=3})=>{const c=Po(),{user:u,isAuthenticated:d}=ds(),{testResults:f,loadTestResults:g}=Vv(),[p,x]=S.useState(!0),[v,w]=S.useState(""),[C,k]=S.useState([]),[_,N]=S.useState([]),[E,P]=S.useState(null),[F,A]=S.useState([]),[j,I]=S.useState(0),[B,Y]=S.useState(0),[Z,se]=S.useState(!1),[ee,te]=S.useState(null),L=S.useCallback(X=>{const ie=X.best_retest_score||X.score,le=X.best_retest_max_score||X.max_score,ce=Math.round(ie/le*100);return{score:ie,maxScore:le,percentage:ce}},[]);S.useEffect(()=>{V()},[e,t]),S.useEffect(()=>{!e&&!t&&(f&&f.results?(ge.debug(" Using cached test results from TestContext"),N(f.results),x(!1)):H())},[e,t,f]);const V=S.useCallback(async()=>{ge.debug(" Initializing Student Results...");try{if(x(!0),w(""),!d||!u){ge.debug(" User not authenticated"),w("User not authenticated");return}if(u.role!==no.STUDENT){ge.error(" Invalid user role for student results:",u.role),w("Access denied. Student role required.");return}ge.debug(" Loading test results..."),await g(u?.student_id||u?.id||""),e&&t&&r&&(ge.debug(" Loading specific test results..."),await M(e,t,r)),ge.debug(" Student Results initialization complete!")}catch(X){ge.error(" Error initializing student results:",X),w("Failed to initialize student results")}finally{x(!1)}},[d,u,e,t,r,g]),M=S.useCallback(async(X,ie,le)=>{ge.debug(" Loading specific test results:",X,ie);try{const ce=await fn.getTestInfo(X,ie);ge.debug(" Test info loaded:",ce),P(ce);const _e=await fn.getTestQuestions(X,ie);ge.debug(" Test questions loaded:",_e),A(_e);const ne=kf(_e,le,X).score,pe=_e.length>0?Math.round(ne/_e.length*100):0;I(ne),Y(pe),ge.debug(" Test results calculated:",{score:ne,percentage:pe})}catch(ce){throw ge.error(" Error loading specific test results:",ce),ce}},[]),H=S.useCallback(async(X=0)=>{ge.debug(" Loading all student results using existing test results API...",X>0?`(retry ${X})`:"");try{if(!(u?.student_id||u?.sub))throw new Error("Student ID not found");const le=await fn.getStudentTestResults();if(le.success){ge.debug(" All student results loaded:",le.results.length,"results");const ce=le.results.map(_e=>({..._e,caught_cheating:_e.caught_cheating||!1,visibility_change_times:_e.visibility_change_times||0}));N(ce),te(new Date),le.results.length===0&&X===0&&(ge.debug(" No results found, retrying in 2 seconds..."),setTimeout(()=>{H(1)},2e3))}else throw new Error(le.error||"Failed to load student results")}catch(ie){ge.error(" Error loading all student results:",ie),w(ie.message)}},[u]),W=S.useCallback(X=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[X]||X,[]),R=S.useCallback(X=>{if(!X||X.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No results available"})});const ie=a?X:X.slice(0,o);return l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),l.jsx("th",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ie.map((le,ce)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium text-gray-900",children:l.jsx("span",{className:"bg-blue-100 text-blue-800 px-0.5 sm:px-2 py-0.5 rounded text-xs",children:W(le.subject)})}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-12 sm:max-w-none",children:le.teacher_name}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-16 sm:max-w-none",children:le.test_name}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500",children:l.jsx("div",{className:"flex flex-col items-center space-y-1",children:le.test_type==="drawing"?le.score!==null?l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:_e,maxScore:ne,percentage:pe}=L(le);return pe>=80?"bg-green-100 text-green-800":pe>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:_e,maxScore:ne,percentage:pe}=L(le);return`${_e}/${ne} (${pe}%)`})()}):l.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):le.test_type==="speaking"?le.score!==null?l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:_e,maxScore:ne,percentage:pe}=L(le);return pe>=80?"bg-green-100 text-green-800":pe>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:_e,maxScore:ne,percentage:pe}=L(le);return`${_e}/${ne} (${pe}%)`})()}):l.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:_e,maxScore:ne,percentage:pe}=L(le);return pe>=80?"bg-green-100 text-green-800":pe>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:_e,maxScore:ne,percentage:pe}=L(le);return`${_e}/${ne} (${pe}%)`})()})})}),l.jsx("td",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(le.submitted_at).toLocaleDateString()})]},ce))})]}),X.length>o&&i&&l.jsx("div",{className:"text-center pt-4",children:l.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${X.length-o} More`})})]})},[W,a,o,i]),z=S.useCallback((X,ie)=>{if(ge.debug(" formatAnswer called with:",{answer:X,testType:ie,answerType:typeof X}),!X)return"No answer";switch(ie){case"true_false":const le=typeof X=="boolean"?X:X==="true";return ge.debug(" Boolean answer processed:",le),le?"True":"False";case"multiple_choice":return X.toUpperCase();case"input":return X;case"word_matching":return typeof X=="object"?Object.entries(X).map(([ce,_e])=>`${ce}  ${_e}`).join(", "):X;case"drawing":return"Drawing submitted";default:return X}},[]),K=S.useCallback(()=>!E||!F||!r?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Test Results: ",E.test_name||E.title||"Test"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-blue-600",children:j}),l.jsx("p",{className:"text-sm text-gray-500",children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:F.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Total Questions"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-3xl font-bold ${B>=80?"text-green-600":B>=60?"text-yellow-600":"text-red-600"}`,children:[B,"%"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Score"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions Review"}),l.jsx("div",{className:"space-y-4",children:F.map((X,ie)=>{const le=r[ie],ce=tv(X,e),_e=Cm(X,le,e);return l.jsxs("div",{className:`border rounded-lg p-4 ${_e?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",ie+1]}),l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${_e?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_e?"Correct":"Incorrect"})]}),l.jsx("p",{className:"text-gray-700 mb-3",children:X.question}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Your Answer:"}),l.jsx("p",{className:"text-sm text-gray-900",children:z(le,e)})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Correct Answer:"}),l.jsx("p",{className:"text-sm text-gray-900",children:z(ce,e)})]})]})]},ie)})})]})]}),[E,F,r,e,j,B,tv,Cm,z]),Q=S.useCallback(()=>{if(!_||_.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No test results available yet."})});const X={};return _.forEach(ie=>{const le=ie.subject||"Unknown Subject";X[le]||(X[le]=[]),X[le].push(ie)}),l.jsx("div",{className:"space-y-6",children:Object.entries(X).map(([ie,le])=>l.jsxs("div",{className:"bg-white rounded-lg shadow",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ie})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:le.map((ce,_e)=>{const{score:ne,maxScore:pe,percentage:Ce}=L(ce),Ae=Ce>=80?"text-green-600":Ce>=60?"text-yellow-600":"text-red-600";return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ce.test_name}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ce.teacher_name||"Unknown"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:l.jsxs("span",{className:Ae,children:[ne,"/",pe," (",Ce,"%)"]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(ce.submitted_at).toLocaleDateString()})]},_e)})})]})})]},ie))})},[_]);S.useCallback(()=>{ge.debug(" Clearing test data and returning to cabinet..."),P(null),A([]),setStudentAnswers(null),I(0),Y(0),se(!1),n?n():c("/student")},[n,c]);const ae=S.useCallback(()=>{ge.debug(" Navigating back to cabinet..."),n?n():c("/student")},[n,c]);return S.useCallback((X,ie)=>{const le={id:Date.now(),message:X,type:ie,timestamp:new Date};k(ce=>[...ce,le]),setTimeout(()=>{k(ce=>ce.filter(_e=>_e.id!==le.id))},P0.NOTIFICATION_DURATION)},[]),p?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Wr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Student Results..."})]})}):v?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:v}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{children:[p?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Wr,{size:"md"}),l.jsx("p",{className:"mt-2 text-gray-600",children:"Loading results..."})]}):v?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-red-500 text-4xl mb-2",children:""}),l.jsx("p",{className:"text-red-600",children:v})]}):R(_),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:C.map(X=>l.jsx(mc,{type:X.type,message:X.message,onClose:()=>k(ie=>ie.filter(le=>le.id!==X.id))},X.id))})]}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",ee?ee.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[E&&l.jsx(Ze,{variant:"outline",onClick:()=>se(!Z),children:Z?"Hide Details":"Show Details"}),l.jsx(Ze,{variant:"outline",onClick:ae,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:Z&&E?K():Q()}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:C.map(X=>l.jsx(mc,{type:X.type,message:X.message,onClose:()=>k(ie=>ie.filter(le=>le.id!==X.id))},X.id))}),selectedDrawing&&l.jsx(qB,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},cie=({isMenuOpen:e,onToggleMenu:t,onShowPasswordChange:r})=>{const n=Po(),{user:s,isAuthenticated:a,logout:i}=ds(),{studentData:o,loadStudentData:c}=o2(),{activeTests:u,testResults:d,loadActiveTests:f,loadTestResults:g,viewTestDetails:p,testDetailsModal:x,closeTestDetailsModal:v}=Vv(),[w,C]=S.useState(!0),[k,_]=S.useState(""),[N,E]=S.useState([]),[P,F]=S.useState(null),[A,j]=S.useState(!1),[I,B]=S.useState(null),[Y,Z]=S.useState(null),[se,ee]=S.useState(new Set),[te,L]=S.useState(!1),[V,M]=S.useState(!1),[H,W]=S.useState(!1),[R,z]=S.useState(!1);S.useEffect(()=>{K()},[]),S.useEffect(()=>()=>{W(!1)},[]),S.useEffect(()=>{if(H){const pe=setTimeout(()=>{W(!1)},1e3);return()=>clearTimeout(pe)}},[H]);const K=S.useCallback(async()=>{ge.debug(" Initializing Student Cabinet...");try{if(C(!0),_(""),!a||!s){ge.debug(" User not authenticated, redirecting to login"),n("/login");return}if(s.role!==no.STUDENT){ge.error(" Invalid user role for student cabinet:",s.role),_("Access denied. Student role required.");return}ge.debug(" Loading active tests (single API call)...");const pe=s?.student_id||s?.id||"";if(Q(pe)){ge.debug(" Cache refresh triggered - clearing cache");try{const Ae=`student_active_tests_${pe}`,Ge=`student_results_table_${pe}`;localStorage.removeItem(Ae),localStorage.removeItem(Ge)}catch{}}else ge.debug(" Using existing cache - no refresh needed");try{localStorage.removeItem(`student_active_tests_${pe}`)}catch{}await f(pe),ge.debug(" Student Cabinet initialization complete!")}catch(pe){ge.error(" Error initializing student cabinet:",pe),_("Failed to initialize student cabinet")}finally{C(!1)}},[a,s,n]),Q=S.useCallback(pe=>{if(window.studentCabinetRefreshRequested)return window.studentCabinetRefreshRequested=!1,ge.debug(" Manual refresh requested"),!0;if(window.recentTestCompleted)return window.recentTestCompleted=!1,ge.debug(" Test completed - cache refresh triggered"),!0;const Ce=localStorage.getItem(`last_cabinet_refresh_${pe}`);if(Ce&&Date.now()-parseInt(Ce)>1800*1e3)return ge.debug(" Time-based refresh triggered"),!0;try{for(let Ae=0;Ae<localStorage.length;Ae++){const Ge=localStorage.key(Ae);if(Ge&&Ge.startsWith(`retest_assignment_id_${pe}_`))return ge.debug(" Retest assignment key detected, forcing cache refresh:",Ge),!0}}catch{}return ge.debug(" No refresh triggers - using existing cache"),!1},[]);S.useCallback(async()=>{ge.debug(" Calculating average score...");try{if(d&&d.length>0){const pe=d.reduce((Ae,Ge)=>{const Le=Ge.best_retest_score||Ge.score,At=Ge.best_retest_max_score||Ge.max_score;return typeof Le=="number"&&typeof At=="number"&&At>0?Ae+Math.round(Le/At*100):Ae},0),Ce=Math.round(pe/d.length);Z(Ce),ge.debug(" Average score calculated:",Ce)}}catch(pe){ge.error(" Error calculating average score:",pe)}},[d]),S.useEffect(()=>{if(H){ge.debug(" Skipping completed tests initialization during navigation");return}const pe=s?.student_id||s?.id;if(!pe){ge.debug(" Student ID not available yet, skipping localStorage initialization");return}const Ce=new Set;for(let Ae=0;Ae<localStorage.length;Ae++){const Ge=localStorage.key(Ae);if(Ge&&Ge.startsWith(`test_completed_${pe}_`)&&localStorage.getItem(Ge)==="true"){const At=Ge.replace(`test_completed_${pe}_`,"").split("_");if(At.length>=2){const et=At[0],pt=At.slice(1).join("_"),lt=`${et}_${pt}`;Ce.add(lt),ge.debug(" Found completed test in localStorage:",lt)}}}ee(Ce),z(!0),ge.debug(" Initialized completed tests from localStorage:",Array.from(Ce))},[s?.student_id,s?.id,H]),S.useEffect(()=>{ge.debug(" testResults structure:",d);const pe=d?.results||d;if(ge.debug(" resultsArray:",pe),pe&&pe.length>0){const Ce=s?.student_id||s?.id||"",Ae=new Set;pe.forEach(Ge=>{const Le=`${Ge.test_type}_${Ge.test_id}`;Ae.add(Le),localStorage.setItem(`test_completed_${Ce}_${Ge.test_type}_${Ge.test_id}`,"true")}),ee(Ge=>{const Le=new Set([...Ge,...Ae]);return ge.debug(" Updated completed tests (merged):",Array.from(Le)),Le})}},[d,s?.student_id,s?.id]);const ae=S.useCallback(async(pe,Ce,Ae=!1,Ge=null)=>{ge.debug(" Checking test completion:",pe,Ce,"retestAvailable:",Ae);try{const Le=s?.student_id||s?.id||"";if(Ae){ge.debug(" Retest available from backend, checking attempt limits.");const lt=[];for(let Lt=1;Lt<=10;Lt++){const zt=`retest_attempt${Lt}_${Le}_${pe}_${Ce}`;localStorage.getItem(zt)==="true"&&lt.push(zt)}const rt=lt.length,ht=Ge?.retest_attempts_left||Ge?.max_attempts||3;return ge.debug(" Current attempts:",rt,"Max attempts:",ht,"Attempt keys:",lt),rt>=ht?(ge.debug(" Maximum retest attempts reached in localStorage"),!0):(ge.debug(" Retest attempts available, allowing start."),!1)}const At=`test_completed_${Le}_${pe}_${Ce}`,et=localStorage.getItem(At);if(ge.debug(" localStorage key:",At),ge.debug(" localStorage value:",et),pe==="word_matching"){ge.debug(" Debug: All localStorage keys for student",Le);for(let lt=0;lt<localStorage.length;lt++){const rt=localStorage.key(lt);rt&&rt.includes(Le)&&rt.includes("word_matching")&&ge.debug(" Found word_matching key:",rt,"=",localStorage.getItem(rt))}}if(et==="true")return ge.debug(" Found completion status in local storage:",et),!0;const pt=d?.results||d;return pt&&pt.length>0&&(ge.debug(" Checking database results:",pt.length,"results"),pt.some(rt=>(ge.debug(" Checking result:",rt.test_type,rt.test_id,"vs",pe,Ce),rt.test_type===pe&&rt.test_id===Ce)))?(ge.debug(" Found completion status in database results"),localStorage.setItem(At,"true"),!0):(ge.debug(" Test not completed according to local storage or database"),!1)}catch(Le){return ge.error(" Error checking test completion:",Le),!1}},[d,s?.student_id,s?.id]),X=S.useCallback((pe,Ce)=>{const Ae={id:Date.now(),message:pe,type:Ce,timestamp:new Date};E(Ge=>[...Ge,Ae]),setTimeout(()=>{E(Ge=>Ge.filter(Le=>Le.id!==Ae.id))},P0.NOTIFICATION_DURATION)},[]),ie=S.useCallback(async pe=>{ge.debug(" Showing test details:",pe);try{await p(pe.test_type,pe.test_id,pe.test_name)}catch(Ce){ge.error("Error loading test details:",Ce),X("Failed to load test details","error")}},[p,X]),le=S.useCallback(pe=>{ge.debug(" Starting test:",pe);const Ce=`${pe.test_type}_${pe.test_id}`;if(se.has(Ce)&&!pe?.retest_available){X("This test has already been completed","warning");return}if(ge.debug(" Checking retest conditions:"),ge.debug(" test.retest_available:",pe?.retest_available),ge.debug(" testKey:",Ce),ge.debug(" completedTests.has(testKey):",se.has(Ce)),ge.debug(" completedTests:",Array.from(se)),pe?.retest_available){const Ae=s?.student_id||s?.id||"",Ge=`retest1_${Ae}_${pe.test_type}_${pe.test_id}`;localStorage.setItem(Ge,"true"),ge.debug(" Set retest key:",Ge);try{const Le=`test_completed_${Ae}_${pe.test_type}_${pe.test_id}`;localStorage.removeItem(Le);const At=`${pe.test_type}_${pe.test_id}`;localStorage.removeItem(At),ge.debug(" Cleared completion keys for retest:",Le,At);const et=`retest_in_progress_${Ae}_${pe.test_type}_${pe.test_id}`;localStorage.setItem(et,"1"),ge.debug(" Set in-progress retest lock:",et);try{const pt=`anti_cheating_${Ae}_${pe.test_type}_${pe.test_id}`;localStorage.removeItem(pt);const lt=`speaking_test_data_${Ae}_${pe.test_id}`;localStorage.removeItem(lt);const rt=`speaking_progress_${pe.test_id}`;localStorage.removeItem(rt);const ht=`_${Ae}_${pe.test_type}_${pe.test_id}`,Lt=[];for(let Dt=0;Dt<localStorage.length;Dt++){const De=localStorage.key(Dt);De&&(De.endsWith(ht)||De.includes(`answers_${Ae}_${pe.test_type}_${pe.test_id}`)||De.includes(`progress_${Ae}_${pe.test_type}_${pe.test_id}`)||De.includes(`state_${Ae}_${pe.test_type}_${pe.test_id}`)||De.includes(`selected_${Ae}_${pe.test_type}_${pe.test_id}`))&&Lt.push(De)}Lt.forEach(Dt=>localStorage.removeItem(Dt)),ge.debug(" Cleared generic cached keys for retest start:",Lt);const zt=`retest_attempts_${Ae}_${pe.test_type}_${pe.test_id}`;ge.debug(" Cleared per-test cached keys for retest start:",{antiCheatKey:pt,speakingCacheKey:lt,speakingProgressKey:rt})}catch{}}catch{}if(ge.debug(" Test retest_assignment_id:",pe.retest_assignment_id),ge.debug(" Test retest_assignment_id type:",typeof pe.retest_assignment_id),pe?.retest_assignment_id){const Le=`retest_assignment_id_${Ae}_${pe.test_type}_${pe.test_id}`;localStorage.setItem(Le,String(pe.retest_assignment_id)),ge.debug(" Set retest assignment ID:",Le,"=",pe.retest_assignment_id)}else ge.debug(" No retest assignment ID found in test data")}else ge.debug(" Retest assignment ID storage skipped - retest not available");if(W(!0),ge.debug(" Set isStartingTest to true for test:",pe.test_type),pe.test_type==="matching_type"){ge.debug(" Redirecting to matching test page for testId:",pe.test_id),n(`/student/matching-test/${pe.test_id}`);return}if(pe.test_type==="word_matching"){ge.debug(" Redirecting to word matching test page for testId:",pe.test_id),n(`/student/word-matching-test/${pe.test_id}`);return}if(pe.test_type==="speaking"){ge.debug(" Redirecting to speaking test page for testId:",pe.test_id),n(`/student/speaking-test/${pe.test_id}`);return}n(`/student/test/${pe.test_type}/${pe.test_id}`)},[n,se,X,s?.student_id,s?.id]),ce=S.useCallback(()=>{L(pe=>!pe)},[]),_e=S.useCallback(()=>{M(pe=>!pe)},[]),ne=S.useCallback(async pe=>{if(ge.debug(" Starting test:",pe),H){ge.debug(" Test already starting, ignoring click");return}try{if(await ae(pe.test_type,pe.test_id,pe?.retest_available,pe)&&!pe?.retest_available){X("This test has already been completed","warning");return}le(pe)}catch(Ce){ge.error(" Error starting test:",Ce),X("Failed to start test. Please try again.","error")}},[ae,le,X,H]);return S.useCallback(pe=>{ge.debug(" Viewing test details:",pe),ie(pe)},[ie]),w?l.jsx(at.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsxs(at.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx(Wr,{size:"lg"}),l.jsx(at.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):k?l.jsx(at.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsx(at.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:l.jsxs(at.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[l.jsx(at.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:""}),l.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-6",children:k}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs(at.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(at.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(at.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(at.div,{className:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:s?.name?.charAt(0)||"S"})})}),l.jsxs("div",{children:[l.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white",children:[s?.name," ",s?.surname]}),l.jsxs("p",{className:"text-blue-100 text-sm sm:text-base md:text-lg",children:["Grade ",s?.grade," - Class ",s?.class]})]})]}),l.jsxs(at.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:t,className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(at.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:e?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(ko,{children:e&&l.jsx(at.div,{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(at.button,{onClick:r,className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(at.button,{onClick:()=>{t(),i()},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),l.jsxs(at.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:l.jsx("div",{className:"lg:col-span-1 space-y-6",children:Y!==null&&l.jsx(at.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:l.jsxs(jt,{children:[l.jsx(jt.Header,{children:l.jsx(jt.Title,{children:"Average Score"})}),l.jsx(jt.Body,{children:l.jsxs(at.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[l.jsxs(at.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[Y,"%"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Overall Performance"})]})})]})})})}),l.jsxs("div",{className:"space-y-6",children:[l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(jt,{children:[l.jsx(jt.Header,{children:l.jsx(jt.Title,{className:"text-center",children:"Active Tests"})}),l.jsx(jt.Body,{children:u&&u.length>0?l.jsxs("div",{className:"relative",children:[ge.debug(" Rendering overlay, isStartingTest:",H),H&&l.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 border-blue-200",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Starting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait..."})]})}),l.jsxs("div",{className:"space-y-4",children:[(te?u:u.slice(0,3)).map((pe,Ce)=>l.jsx(at.div,{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:te?0:.7+Ce*.1,duration:.3},whileHover:{scale:1.02},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[l.jsx("h3",{className:"text-sm sm:text-lg font-medium text-gray-900 w-16 sm:w-auto break-words leading-tight line-clamp-2 sm:line-clamp-none",children:pe.test_name}),l.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:pe.subject}),l.jsx("span",{className:"text-gray-500",children:pe.teacher_name}),l.jsxs("span",{className:"text-gray-500",children:[l.jsx("span",{className:"sm:hidden",children:new Date(pe.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}),l.jsx("span",{className:"hidden sm:inline",children:new Date(pe.assigned_at).toLocaleDateString()})]})]})}),l.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const Ae=`${pe.test_type}_${pe.test_id}`,Ge=se.has(Ae);if(!R)return l.jsx(Ze,{variant:"secondary",size:"sm",disabled:!0,className:"bg-gray-100 text-gray-500 border-gray-200",children:"Loading..."});if(Ge&&pe?.retest_available){const Le=s?.student_id||s?.id||"";let At=!1;try{const et=localStorage.getItem(`retest_attempts_${Le}_${pe.test_type}_${pe.test_id}`);if(et){const pt=JSON.parse(et);typeof pt?.used=="number"&&typeof pt?.max=="number"&&pt.used>=pt.max&&(At=!0)}}catch{}return At?l.jsx(Ze,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):l.jsx(Ze,{variant:"primary",size:"sm",onClick:()=>ne(pe),disabled:H,children:"Start Retest"})}return Ge?l.jsx(Ze,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):(ge.debug(" Button render, isStartingTest:",H,"test:",pe.test_type),l.jsx(Ze,{variant:"primary",size:"sm",onClick:()=>ne(pe),disabled:H,children:"Start Test"}))})()})]})},`${pe.test_type}_${pe.test_id}`)),u.length>3&&l.jsx("div",{className:"text-center pt-2",children:l.jsx("button",{onClick:ce,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:te?"Show Less":`Show ${u.length-3} More`})})]})]}):l.jsxs(at.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[l.jsx(at.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"},children:""}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Active Tests"}),l.jsx("p",{className:"text-gray-500",children:"No active tests available for your class at the moment."})]})})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(jt,{children:[l.jsx(jt.Header,{children:l.jsx(jt.Title,{children:"Test Results"})}),l.jsx(jt.Body,{children:d&&d.showResults?l.jsx(Kv,{testResults:d,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(pe,Ce)=>{f(),setTestResults(null)},isLoading:w}):l.jsx(YB,{compact:!0,showAll:V,onToggleShowAll:_e,maxInitial:3})})]})})]})]}),l.jsx(LB,{isOpen:x.isOpen,onClose:v,testType:x.testType,testId:x.testId,testName:x.testName,questions:x.questions||[],isLoading:x.isLoading||!1}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:N.map(pe=>l.jsx(mc,{type:pe.type,message:pe.message,onClose:()=>E(Ce=>Ce.filter(Ae=>Ae.id!==pe.id))},pe.id))})]})},uie=({testInfo:e,questions:t,testType:r,studentAnswers:n,onBackToCabinet:s,checkAnswerCorrectness:a,formatStudentAnswerForDisplay:i,getCorrectAnswer:o})=>{const[c,u]=S.useState(0),[d,f]=S.useState(0),[g,p]=S.useState(!0);if(S.useEffect(()=>{const w=()=>{try{const C=kf(t,n,r).score,k=e?.num_questions||t?.length||0,_=k>0?Math.round(C/k*100):0;u(C),f(_),p(!1)}catch(C){console.error("Error calculating test results:",C),u(0),f(0),p(!1)}};t&&t.length>0?w():p(!1)},[t,n,r,e,kf]),g)return l.jsx("div",{className:"flex justify-center items-center min-h-64",children:l.jsx("div",{className:"text-lg",children:"Calculating results..."})});const x=e?.num_questions||t?.length||0,v=e?.test_name||e?.title||"Test";return l.jsxs("div",{className:"test-results-page max-w-4xl mx-auto p-6 overflow-y-auto min-h-screen",children:[l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"results-header text-center",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Test Results: ",v]}),l.jsx("p",{className:"text-gray-600",children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"results-summary",children:[l.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 text-center",children:["Your Score: ",c," / ",x," (",d,"%)"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:l.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${d>=80?"bg-green-500":d>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${d}%`}})}),l.jsx("div",{className:"text-center",children:l.jsx("p",{className:`text-lg font-medium ${d>=80?"text-green-600":d>=60?"text-yellow-600":"text-red-600"}`,children:d>=80?"Excellent!":d>=60?"Good job!":"Keep practicing!"})})]})}),t&&t.length>0&&l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"questions-review",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Question Review"}),l.jsx("div",{className:"space-y-4",children:t.map((w,C)=>{const k=n[String(w.question_id)]||"No answer";console.log(" TestResultsDisplay - Question",C+1,":",{question:w,studentAnswer:k,testType:r});const _=a(w,k,r);return console.log(" TestResultsDisplay - isCorrect result:",_),l.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${_?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[l.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[l.jsxs("h4",{className:"text-lg font-medium text-gray-800",children:["Question ",C+1]}),l.jsx("span",{className:`text-2xl font-bold ${_?"text-green-600":"text-red-600"}`,children:_?"":""})]}),l.jsx("div",{className:"question-text mb-3",children:l.jsx("p",{className:"text-gray-700 font-medium",children:w.question})}),l.jsxs("div",{className:"answer-section space-y-2",children:[l.jsxs("p",{className:"student-answer",children:[l.jsx("strong",{className:"text-gray-600",children:"Your Answer:"})," ",l.jsx("span",{className:`font-medium ${_?"text-green-700":"text-red-700"}`,children:i(k,r,w)})]}),!_&&l.jsxs("p",{className:"correct-answer",children:[l.jsx("strong",{className:"text-gray-600",children:"Correct Answer:"})," ",l.jsx("span",{className:"text-green-700 font-medium",children:r==="multiple_choice"?String(w.correct_answer||"").toUpperCase():i(o(w,r),r,w)})]})]})]},w.question_id||C)})})]})}),l.jsx(jt,{children:l.jsx("div",{className:"results-actions text-center",children:l.jsx(Ze,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-medium",children:"Back to Cabinet"})})})]})};class die{constructor(){this.activeRequests=new Map,this.completedRequests=new Map,this.maxCacheSize=100,this.cacheTimeout=3e4}generateKey(t,r,n={}){const s=Object.keys(n).sort().reduce((a,i)=>(a[i]=n[i],a),{});return`${t}_${r}_${JSON.stringify(s)}`}isRequestInProgress(t){return this.activeRequests.has(t)}getCachedResult(t){const r=this.completedRequests.get(t);return r&&Date.now()-r.timestamp<this.cacheTimeout?r.result:null}startRequest(t,r){return this.activeRequests.set(t,r),r.finally(()=>{this.activeRequests.delete(t)}),r}cacheResult(t,r){if(this.completedRequests.size>=this.maxCacheSize){const n=this.completedRequests.keys().next().value;this.completedRequests.delete(n)}this.completedRequests.set(t,{result:r,timestamp:Date.now()})}async deduplicateApiCall(t,r,n,s){const a=this.generateKey(t,r,n);if(this.isRequestInProgress(a))return console.log(" API deduplication: Request already in progress, waiting...",a),this.activeRequests.get(a);const i=this.getCachedResult(a);if(i)return console.log(" API deduplication: Using cached result",a),i;console.log(" API deduplication: Making new request",a);const o=this.startRequest(a,s());try{const c=await o;return this.cacheResult(a,c),c}catch(c){throw c}}clearCache(){this.activeRequests.clear(),this.completedRequests.clear(),console.log(" API deduplication: Cache cleared")}}const DF=new die,fie=(e,t)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>e.apply(null,n),t)}},hie=({onBackToCabinet:e,currentTest:t})=>{const r=Po(),{user:n,isAuthenticated:s}=ds(),{activeTests:a,loadActiveTests:i}=Vv(),o=S.useCallback(fie((Pe,ze,ke)=>{try{if(window.skipInitialProgressSave&&ke.answers&&ke.answers.length===0){ge.debug(" Skipping empty progress save during restoration"),window.skipInitialProgressSave=!1;return}const Be=`test_progress_${n?.student_id||n?.id||"unknown"}_${Pe}_${ze}`,Et=localStorage.getItem(Be);if(Et&&ke.answers&&ke.answers.length===0)try{const It=JSON.parse(Et);if(It.answers&&It.answers.length>0){ge.debug(" Skipping empty progress save - existing progress is better:",It.answers);return}}catch{}localStorage.setItem(Be,JSON.stringify(ke)),ge.debug(`Saved test progress for ${Pe}_${ze}:`,ke)}catch($e){ge.error("Error saving test progress:",$e)}},1e3),[n?.student_id,n?.id]),c=S.useCallback((Pe,ze,ke)=>{o(Pe,ze,ke)},[o]),u=S.useCallback((Pe,ze)=>{try{const $e=`test_progress_${n?.student_id||n?.id||"unknown"}_${Pe}_${ze}`,Be=localStorage.getItem($e);return Be?JSON.parse(Be):null}catch(ke){return ge.error("Error getting test progress:",ke),null}},[n?.student_id,n?.id]),d=S.useCallback((Pe,ze)=>{try{const ke=n?.student_id||n?.id||"unknown",$e=`test_progress_${ke}_${Pe}_${ze}`;localStorage.removeItem($e);for(let Be=0;Be<localStorage.length;Be++){const Et=localStorage.key(Be);Et&&Et.startsWith(`test_progress_${ke}_${Pe}_${ze}_`)&&(localStorage.removeItem(Et),ge.debug(` Cleared individual question key: ${Et}`))}ge.debug(`Cleared test progress for ${Pe}_${ze}`)}catch(ke){ge.error("Error clearing test progress:",ke)}},[n?.student_id,n?.id]),[f,g]=S.useState(!0),[p,x]=S.useState(!1),[v,w]=S.useState(""),[C,k]=S.useState(!1),[_,N]=S.useState(""),[E,P]=S.useState([]),[F,A]=S.useState(t?"test":"list"),[j,I]=S.useState(null),[B,Y]=S.useState(null),[Z,se]=S.useState(null),[ee,te]=S.useState([]),[L,V]=S.useState([]),[M,H]=S.useState(0),[W,R]=S.useState(0),[z,K]=S.useState(null),Q=Is.useRef(null),ae=Is.useRef(null),[X,ie]=S.useState(!1),[le,ce]=S.useState(!1),[_e,ne]=S.useState(null),[pe,Ce]=S.useState(null),[Ae,Ge]=S.useState(!1),[Le,At]=S.useState(!1),[et,pt]=S.useState({isInitialized:!1,initializationId:null,lastTestId:null,initializationCount:0}),[lt,rt]=S.useState({isRestored:!1,restoredTestId:null,restorationCount:0}),{startTracking:ht,stopTracking:Lt,getCheatingData:zt,clearData:Dt,isCheating:De,tabSwitches:Ie}=Jm(j?.test_type,j?.test_id,n?.student_id||n?.id);S.useEffect(()=>{(()=>{const ze=[];for(let ke=0;ke<localStorage.length;ke++){const $e=localStorage.key(ke);if($e&&$e.startsWith("test_progress_")&&!$e.includes("_51712_")&&!$e.includes("_51736_")){const Be=$e.split("_");Be.length===4&&Be[0]==="test"&&Be[1]==="progress"&&ze.push($e)}}ze.forEach(ke=>{localStorage.removeItem(ke),ge.debug(" Cleared old cache key:",ke)})})()},[]);const Ke=S.useCallback(()=>{const Pe=j?.test_id,ze=n?.student_id||n?.id;if(!ze||!Pe)return ge.debug(" Skipping initialization - missing required data:",{studentId:ze,currentTestId:Pe}),!1;const ke=`${ze}_${Pe}_${Date.now()}`;return et.isInitialized&&et.lastTestId===Pe?(ge.debug(" Already initialized for this test - skipping"),!1):et.initializationId?(ge.debug(" Initialization in progress - skipping duplicate"),!1):(ge.debug(" Starting initialization:",ke),pt({isInitialized:!1,initializationId:ke,lastTestId:Pe}),!0)},[et,j,n?.student_id,n?.id]),Je=S.useCallback(()=>{pt(Pe=>({...Pe,isInitialized:!0,initializationId:null})),ge.debug(" Initialization completed")},[]),Ye=S.useCallback(async()=>{ge.debug(" Initializing Student Tests...");try{if(g(!0),N(""),!s||!n){ge.debug(" User not authenticated"),N("User not authenticated");return}if(n.role!==no.STUDENT){ge.error(" Invalid user role for student tests:",n.role),N("Access denied. Student role required.");return}ge.debug(" Loading active tests..."),await i(),Je(),ge.debug(" Student Tests initialization complete!")}catch(Pe){ge.error(" Error initializing student tests:",Pe),N("Failed to initialize student tests")}finally{g(!1)}},[s,n,i,Je]);S.useEffect(()=>{Ke()&&Ye()},[Ke,Ye]),S.useEffect(()=>{t&&(ge.debug(" Auto-starting test from prop:",t),k(!0),Wt(t))},[t]),S.useCallback(async()=>{ge.debug(" Loading student active tests...");try{const Pe=await fn.getActiveTests();ge.debug(" Active tests loaded:",Pe);const ze=Pe.map(ke=>({...ke,subject_id:ke.subject_id||ke.subjectId,teacher_id:ke.teacher_id||ke.teacherId,is_active:ke.is_active!==void 0?ke.is_active:!0,created_at:ke.created_at||ke.createdAt,updated_at:ke.updated_at||ke.updatedAt}));return Ce(new Date),ze}catch(Pe){throw ge.error(" Error loading active tests:",Pe),Pe}},[]),S.useCallback(async(Pe,ze)=>{ge.debug(" Checking test completion:",Pe,ze);try{const ke=u(Pe,ze);return ke&&ke.completed}catch(ke){return ge.error(" Error checking test completion:",ke),!1}},[u]),S.useEffect(()=>{if(ee.length>0&&j?.test_id){const Pe=setTimeout(()=>{let ze=!1;const ke=new Array(ee.length).fill("");if(ee.forEach(($e,Be)=>{const It=`test_progress_${n?.student_id||n?.id||"unknown"}_${B}_${j?.test_id}_${$e.question_id}`,Kt=localStorage.getItem(It);if(Kt){const wr=Kt.replace(/^"(.*)"$/,"$1");ke[Be]=wr,ze=!0}}),ze){V(ke);const $e=ke.filter(Et=>Et&&typeof Et=="string"&&Et.trim()!=="").length,Be=ee.length>0?$e/ee.length*100:0;H(Be)}},100);return()=>clearTimeout(Pe)}},[ee,B,j?.test_id]);const Tt=S.useCallback(async(Pe,ze)=>{ge.debug(" Marking test as completed:",Pe,ze);try{const ke=u(Pe,ze)||{};ke.completed=!0,ke.completedAt=new Date().toISOString(),c(Pe,ze,ke);const Be=`test_completed_${n?.student_id||n?.id||""}_${Pe}_${ze}`;localStorage.setItem(Be,"true"),ge.debug(" Test completion marked in localStorage:",Be),ge.debug(" localStorage value after setting:",localStorage.getItem(Be)),me("Test marked as completed","success")}catch(ke){ge.error(" Error marking test as completed:",ke),me("Failed to mark test as completed","error")}},[u,c]),Nt=S.useCallback(Pe=>{ge.debug(" Showing test details:",Pe),ne(Pe),ce(!0)},[]),Wt=S.useCallback(async Pe=>{ge.debug(" Starting test:",Pe);let ze=Date.now(),ke;try{w(""),x(!0),ze=Date.now();const $e=()=>{const Ee=Date.now()-ze,ot=Math.max(0,250-Ee);setTimeout(()=>{g(!1),x(!1)},ot)};let Be=!1;ke=setTimeout(()=>{Be=!0,w("Loading is taking longer than expected...")},15e3);const It=`test_completed_${n?.student_id||n?.id||""}_${Pe.test_type}_${Pe.test_id}`,Kt=localStorage.getItem(It)==="true";if(Kt&&!Pe?.retest_available){ge.debug(" Test already completed, redirecting to main cabinet"),me("This test has already been completed","info"),r("/student");return}if(Kt&&Pe?.retest_available&&ge.debug(" Test completed but retest available, allowing retest"),Pe.test_type===In.MATCHING){ge.debug(" Redirecting to matching test page for testId:",Pe.test_id),r(`/student/matching-test/${Pe.test_id}`);return}if(Pe.test_type===In.WORD_MATCHING){ge.debug(" Redirecting to word matching test page for testId:",Pe.test_id),r(`/student/word-matching-test/${Pe.test_id}`);return}I(Pe),Y(Pe.test_type),rt({isRestored:!1,restoredTestId:null,restorationCount:0});const[wr,lr]=await Promise.all([DF.deduplicateApiCall("GET",`test-info-${Pe.test_type}-${Pe.test_id}`,{testType:Pe.test_type,testId:Pe.test_id},()=>fn.getTestInfo(Pe.test_type,Pe.test_id)),DF.deduplicateApiCall("GET",`test-questions-${Pe.test_type}-${Pe.test_id}`,{testType:Pe.test_type,testId:Pe.test_id},()=>fn.getTestQuestions(Pe.test_type,Pe.test_id))]);se(wr);let Fr=lr;try{if(!!wr?.is_shuffled){const Xe=n?.student_id||n?.id||"unknown",ot=`${Xe}:${Pe.test_type}:${Pe.test_id}`,xt=Array.from(ot).reduce((Yt,_r)=>(Yt<<5)-Yt+_r.charCodeAt(0),0)>>>0,qt=`test_shuffle_order_${Xe}_${Pe.test_type}_${Pe.test_id}`,yt=localStorage.getItem(qt);if(yt){const Yt=JSON.parse(yt),_r=new Map(lr.map(kr=>[kr.question_id,kr]));Fr=Yt.map(kr=>_r.get(kr)).filter(Boolean)}else{const _r=function(xr){return function(){var Gr=xr+=1831565813;return Gr=Math.imul(Gr^Gr>>>15,Gr|1),Gr^=Gr+Math.imul(Gr^Gr>>>7,Gr|61),((Gr^Gr>>>14)>>>0)/4294967296}}(xt);Fr=[...lr];for(let xr=Fr.length-1;xr>0;xr--){const Gr=Math.floor(_r()*(xr+1));[Fr[xr],Fr[Gr]]=[Fr[Gr],Fr[xr]]}const kr=Fr.map(xr=>xr.question_id);localStorage.setItem(qt,JSON.stringify(kr))}}}catch(Ee){ge.error("Shuffle error (ignored):",Ee)}te(Fr),$e();const ue=Pe.test_id;if(lt.isRestored&&lt.restoredTestId===ue){ge.debug(" Progress already restored for this test - skipping");return}ge.debug(" Starting progress restoration for test:",Pe.test_type,Pe.test_id),rt(Ee=>({...Ee,restorationCount:Ee.restorationCount+1}));const be=n?.student_id||n?.id||"unknown",xe=`test_progress_${be}_${Pe.test_type}_${Pe.test_id}`,he=localStorage.getItem(xe);ge.debug(" Checking main progress key:",xe),ge.debug(" Main progress data:",he);let we=new Array(lr.length).fill("");if(he)try{const Ee=JSON.parse(he);ge.debug(" Parsed progress data:",Ee),Ee.answers&&Array.isArray(Ee.answers)&&(we=Ee.answers,ge.debug(" Loaded answers from main progress:",we))}catch(Ee){ge.error(" Error parsing main progress:",Ee)}lr.forEach((Ee,Xe)=>{const ot=`test_progress_${be}_${Pe.test_type}_${Pe.test_id}_${Ee.question_id}`,xt=localStorage.getItem(ot);if(ge.debug(` Checking individual answer for question ${Ee.question_id}:`,xt),xt){const qt=xt.replace(/^"(.*)"$/,"$1");we[Xe]=qt,ge.debug(` Loaded individual answer for question ${Ee.question_id}:`,qt)}}),ge.debug(" Final initial answers after loading all sources:",we);const Se=we.filter(Ee=>Ee&&typeof Ee=="string"&&Ee.trim()!=="").length;if(Se>0){ge.debug(` Restoring progress: ${Se}/${lr.length} questions answered`),V(we);const Ee=lr.length>0?Se/lr.length*100:0;H(Ee),ge.debug(` Progress restored: ${Ee}% complete`)}else ge.debug(" No existing progress found - starting fresh"),V(we),H(0);rt(Ee=>({...Ee,isRestored:!0,restoredTestId:ue})),Se>0&&(ge.debug(" Existing progress found - preventing overwrite during initialization"),window.skipInitialProgressSave=!0);const He=Number(wr?.allowed_time||0),ct=n?.student_id||n?.id||"unknown";if(Q.current=`test_timer_${ct}_${Pe.test_type}_${Pe.test_id}`,He>0)try{const Ee=localStorage.getItem(Q.current),Xe=Date.now();if(Ee){const ot=JSON.parse(Ee),xt=Math.floor((Xe-new Date(ot.lastTickAt).getTime())/1e3),qt=Math.max(0,Number(ot.remainingSeconds||He)-Math.max(0,xt));R(qt),ae.current=Xe}else R(He),ae.current=Xe,localStorage.setItem(Q.current,JSON.stringify({remainingSeconds:He,lastTickAt:new Date(Xe).toISOString(),startedAt:new Date(Xe).toISOString()}))}catch(Ee){ge.error("Timer cache init error:",Ee),R(He)}else R(0);const qe=new Date;K(qe),ge.debug(" Test timer started at:",qe.toISOString());const oe=n?.student_id||n?.id||"unknown",fe=`anti_cheating_${oe}_${Pe.test_type}_${Pe.test_id}`,Te=localStorage.getItem(fe);if(ge.debug(" Checking for anti-cheating data with key:",fe),ge.debug(" Key format: anti_cheating_{studentId}_{testType}_{testId}"),ge.debug(" Current test details:",{testType:Pe.test_type,testId:Pe.test_id,studentId:oe}),Te)try{const Ee=JSON.parse(Te);ge.debug(" Found existing anti-cheating data for THIS test:",Ee),ge.debug(" Visibility change times for this test:",Ee.tabSwitches||0),ge.debug(" Cheating status for this test:",Ee.isCheating||!1),Ee.isCheating&&(ge.debug(" WARNING: Student has been flagged for cheating in THIS test!"),ge.debug(" Tab switches detected in this test:",Ee.tabSwitches),me(` Warning: Suspicious activity detected in this test (${Ee.tabSwitches} tab switches). Continued violations may result in test disqualification.`,"warning"))}catch(Ee){ge.error(" Error parsing existing anti-cheating data:",Ee)}else ge.debug(" No existing anti-cheating data found for this test - starting fresh");ht(),ge.debug(" Anti-cheating tracking started"),A("test"),ge.debug(" Test started successfully")}catch($e){ge.error(" Error starting test:",$e),me("Failed to start test","error"),w("Failed to load test data. Please try again.")}finally{const $e=Date.now()-ze,Et=Math.max(0,250-$e);setTimeout(()=>{g(!1),x(!1)},Et),k(!1);try{ke&&clearTimeout(ke)}catch{}}},[u]),or=S.useCallback(async()=>{if(!j||!Z||!ee||!L){me("No test data to submit","error");return}ge.debug(" Submitting test:",j);try{ie(!0);const Pe=kf(ee,L,j.test_type),ze=new Date,ke=z?Math.round((ze-z)/1e3):0,$e=z?z.toISOString():ze.toISOString();ge.debug(" Test timing:",{startedAt:$e,endTime:ze.toISOString(),timeTaken:`${ke} seconds`});const Be=zt();ge.debug(" Anti-cheating data for submission:",Be);const Et={};ee.forEach((Kt,wr)=>{Et[Kt.question_id]=L[wr]??""}),j.test_type==="drawing"&&(ge.debug(" Drawing test answers being submitted:",L),ge.debug(" Drawing test answers type:",typeof L[0]),ge.debug(" Drawing test answers content:",L[0]));const It=await fn.submitTest(j.test_type,j.test_id,L,{time_taken:(()=>{const Kt=Number(Z?.allowed_time||0);return Kt>0?Math.min(ke,Kt):ke})(),started_at:$e,submitted_at:ze.toISOString(),answers_by_id:Et,question_order:ee.map(Kt=>Kt.question_id),caught_cheating:Be.caught_cheating,visibility_change_times:Be.visibility_change_times,retest_assignment_id:(()=>{const wr=`retest_assignment_id_${n?.student_id||n?.id||""}_${j.test_type}_${j.test_id}`,lr=localStorage.getItem(wr);return ge.debug(" Frontend retest key:",wr),ge.debug(" Frontend retest assignment ID from localStorage:",lr),ge.debug(" Frontend retest assignment ID converted:",lr?Number(lr):null),ge.debug(" Frontend current test data:",j),ge.debug(" Frontend current test retest_assignment_id:",j.retest_assignment_id),lr?Number(lr):null})(),parent_test_id:j.test_id},n);if(ge.debug(" Test submission result:",It),It.success){window.recentTestCompleted=!0,ge.debug(" Test completed - cache refresh triggered");const Kt=n?.student_id||n?.id||"",wr=`retest_assignment_id_${Kt}_${j.test_type}_${j.test_id}`;if(!!localStorage.getItem(wr)){const he=j?.retest_attempts_left||j?.max_attempts||3,we=(It?.percentage_score??0)>=50;if(we){const Se=`retest_attempt${he}_${Kt}_${j.test_type}_${j.test_id}`;localStorage.setItem(Se,"true"),ge.debug(" Passed retest, marking last-slot key:",Se);let He=0;for(let qe=1;qe<=10;qe++){const oe=`retest_attempt${qe}_${Kt}_${j.test_type}_${j.test_id}`;localStorage.getItem(oe)==="true"&&He++}if(Kt&&j.test_type&&j.test_id){const qe=`test_completed_${Kt}_${j.test_type}_${j.test_id}`;localStorage.setItem(qe,"true"),ge.debug(" Marked retest as completed (student passed):",qe);const oe=`retest_attempts_${Kt}_${j.test_type}_${j.test_id}`;localStorage.setItem(oe,JSON.stringify({used:He,max:he})),ge.debug(" Set retest attempts metadata (student passed):",oe,{used:He,max:he})}const ct=`retest1_${Kt}_${j.test_type}_${j.test_id}`;localStorage.removeItem(ct)}else{let Se=1;for(let fe=1;fe<=10;fe++){const Te=`retest_attempt${fe}_${Kt}_${j.test_type}_${j.test_id}`;if(localStorage.getItem(Te)!=="true"){Se=fe;break}}const He=`retest_attempt${Se}_${Kt}_${j.test_type}_${j.test_id}`;localStorage.setItem(He,"true"),ge.debug(" Marked retest attempt as completed:",He);let ct=0;for(let fe=1;fe<=10;fe++){const Te=`retest_attempt${fe}_${Kt}_${j.test_type}_${j.test_id}`;localStorage.getItem(Te)==="true"&&ct++}const qe=he-ct,oe=qe<=0||we;if(ge.debug(" Retest completion check:",{usedAttempts:ct,maxAttempts:he,attemptsLeft:qe,passed:we,shouldComplete:oe}),oe&&Kt&&j.test_type&&j.test_id){const fe=`test_completed_${Kt}_${j.test_type}_${j.test_id}`;localStorage.setItem(fe,"true"),ge.debug(" Marked retest as completed (attempts exhausted or passed):",fe);const Te=`retest_attempts_${Kt}_${j.test_type}_${j.test_id}`;localStorage.setItem(Te,JSON.stringify({used:ct,max:he})),ge.debug(" Set retest attempts metadata (attempts exhausted):",Te,{used:ct,max:he})}if(ct>=he){const fe=`retest1_${Kt}_${j.test_type}_${j.test_id}`;localStorage.removeItem(fe)}}}if(ge.debug(" Marking test as completed..."),await Tt(j.test_type,j.test_id),j.test_type!=="drawing"){ge.debug(" Caching test results after submission...");const we=`student_results_table_${n?.student_id||n?.id||"unknown"}`,{setCachedData:Se,CACHE_TTL:He}=await mi(async()=>{const{setCachedData:ct,CACHE_TTL:qe}=await Promise.resolve().then(()=>qg);return{setCachedData:ct,CACHE_TTL:qe}},void 0);Se(we,It,He.student_results_table),ge.debug(" Test results cached with key:",we)}else ge.debug(" Drawing test submitted - not caching results (will appear after teacher grades)");ge.debug(" Clearing test progress..."),d(j.test_type,j.test_id);try{const he=n?.student_id||n?.id||"unknown",we=`test_timer_${he}_${j.test_type}_${j.test_id}`;localStorage.removeItem(we);const Se=`test_shuffle_order_${he}_${j.test_type}_${j.test_id}`;localStorage.removeItem(Se)}catch{}if(n?.student_id){const he=`test_completed_${n.student_id}_${j.test_type}_${j.test_id}`;localStorage.setItem(he,"true"),ge.debug(" Test marked as completed in localStorage:",he)}try{const he=n?.student_id||n?.id||"",we=`retest1_${he}_${j.test_type}_${j.test_id}`,Se=`retest_assignment_id_${he}_${j.test_type}_${j.test_id}`;localStorage.removeItem(we),localStorage.removeItem(Se),ge.debug(" Cleared retest keys:",we,Se)}catch(he){ge.warn("Failed to clear retest keys:",he)}ge.debug(" Clearing test progress and anti-cheating data for THIS test only...");const Fr=n?.student_id||n?.id||"unknown",ue=[],be=`test_progress_${Fr}_${j.test_type}_${j.test_id}`,xe=`anti_cheating_${Fr}_${j.test_type}_${j.test_id}`;for(let he=0;he<localStorage.length;he++){const we=localStorage.key(he);we&&(we===be||we===xe)&&ue.push(we)}ue.forEach(he=>{localStorage.removeItem(he),ge.debug(` Cleared for THIS test only: ${he}`)}),ge.debug(" Clearing anti-cheating data..."),Lt(),Dt(),j.test_type!=="drawing"?A("results"):r("/student"),me("Test submitted successfully!","success"),ge.debug(" Test submitted successfully")}else throw ge.error(" Test submission failed:",It.error),new Error(It.error||"Failed to submit test")}catch(Pe){ge.error(" Error submitting test:",Pe),me("Failed to submit test","error")}finally{ie(!1)}},[j,Z,ee,L,Tt,d]);S.useCallback(()=>(ge.debug(" Collecting test answers..."),L),[L]);const dr=S.useCallback(()=>{if(!ee||!L)return;const Pe=L.filter(ke=>ke&&typeof ke=="string"&&ke.trim()!=="").length,ze=ee.length>0?Pe/ee.length*100:0;if(H(ze),ge.debug(` Progress updated: ${Pe}/${ee.length} questions answered (${Math.round(ze)}%)`),j){const ke={answers:L,progress:ze,lastSaved:new Date().toISOString()};c(j.test_type,j.test_id,ke)}},[ee,L,j,c]);S.useEffect(()=>{dr()},[dr]);const Er=S.useCallback(()=>{if(!L)return 0;const Pe=L.filter(ze=>ze&&typeof ze=="string"&&ze.trim()!=="").length;return ge.debug(" getAnsweredCount:",{studentAnswers:L,answeredCount:Pe,totalQuestions:ee?.length}),Pe},[L,ee]),fr=S.useCallback(()=>{if(ge.debug(" Navigating back to cabinet..."),j&&n?.student_id){ge.debug(" Cabinet navigation detected - counting as cheating attempt");const ze=`anti_cheating_${n?.student_id||n?.id||"unknown"}_${j.test_type}_${j.test_id}`,ke=localStorage.getItem(ze);let $e=0,Be=!1;if(ke)try{const wr=JSON.parse(ke);$e=wr.tabSwitches||0,Be=wr.isCheating||!1}catch(wr){ge.error(" Error parsing existing anti-cheating data:",wr)}const Et=$e+1,It=Et>=2;ge.debug(` Tab switch count: ${$e}  ${Et} (cheating: ${It})`);const Kt={tabSwitches:Et,isCheating:It,lastUpdated:new Date().toISOString()};localStorage.setItem(ze,JSON.stringify(Kt)),ge.debug(" Anti-cheating data updated for cabinet navigation:",Kt)}e?e():r("/student")},[e,r,j,n?.student_id]);S.useCallback(()=>{ge.debug(" Showing test results..."),A("results")},[]);const nr=S.useCallback((Pe,ze,ke=null)=>{switch(ge.debug(" Formatting student answer for display:",Pe,"testType:",ze,"question:",ke),ze){case In.MULTIPLE_CHOICE:if(Pe.toString().startsWith("Option "))return Pe;if(ke&&typeof Pe=="string"&&!isNaN(parseInt(Pe))){const $e=parseInt(Pe),Be=`option_${String.fromCharCode(97+$e)}`,Et=ke[Be];if(Et)return ge.debug(" Converted",Pe,"to option text:",Et),Et;{const It=String.fromCharCode(65+$e);return ge.debug(" Converted",Pe,"to",It),It}}else{if(typeof Pe=="string"&&isNaN(parseInt(Pe)))return ge.debug(" Already formatted text:",Pe),Pe;{const $e=String.fromCharCode(65+parseInt(Pe));return ge.debug(" Converted",Pe,"to",$e),$e}}case In.TRUE_FALSE:return Pe==="true"?"True":"False";case In.INPUT:return Pe;case In.MATCHING:return typeof Pe=="object"?JSON.stringify(Pe):Pe;case In.WORD_MATCHING:return typeof Pe=="object"?JSON.stringify(Pe):Pe;case In.DRAWING:return Pe&&Pe.trim()!==""?"Drawing submitted":"No drawing";case In.FILL_BLANKS:return Pe;default:return ge.warn(" Unknown test type for answer formatting:",ze),Pe}},[]),me=S.useCallback((Pe,ze)=>{const ke={id:Date.now(),message:Pe,type:ze,timestamp:new Date};P($e=>[...$e,ke]),setTimeout(()=>{P($e=>$e.filter(Be=>Be.id!==ke.id))},P0.NOTIFICATION_DURATION)},[]);S.useEffect(()=>{dr()},[dr]),S.useEffect(()=>{if(F!=="test")return;const Pe=Number(Z?.allowed_time||0);if(!Pe)return;const ze=setInterval(()=>{R(ke=>{const $e=Math.max(0,ke-1);try{const Be=Date.now();ae.current||(ae.current=Be),Q.current&&localStorage.setItem(Q.current,JSON.stringify({remainingSeconds:$e,lastTickAt:new Date(Be).toISOString(),startedAt:z?z.toISOString():new Date(Be-(Pe-$e)*1e3).toISOString()}))}catch{}return $e===0&&or(),$e})},1e3);return()=>clearInterval(ze)},[F,Z?.allowed_time,or,z]);const Ne=S.useCallback((Pe,ze)=>{if(!Pe)return null;const ke=($e,Be)=>{const Et=[...L];Et[ze]=Be,V(Et),ge.debug(` Answer changed: question ${$e} = ${Be}`),ge.debug(" Updated studentAnswers:",Et)};switch(j.test_type){case In.TRUE_FALSE:return l.jsx(aae,{question:Pe,questionIndex:ze,studentAnswer:L[ze]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:B,displayNumber:ze+1});case In.MULTIPLE_CHOICE:return l.jsx(iae,{question:Pe,questionIndex:ze,studentAnswer:L[ze]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:B,displayNumber:ze+1});case In.INPUT:return l.jsx(oae,{question:Pe,questionIndex:ze,studentAnswer:L[ze]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:B,displayNumber:ze+1});case In.MATCHING:return ge.error("Matching test reached renderQuestion - this should not happen"),l.jsxs("div",{className:"text-center p-8",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),l.jsx(Ze,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case In.DRAWING:return l.jsx(pae,{question:Pe,questionIndex:ze,studentAnswer:L[ze]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:B});case In.FILL_BLANKS:return ze===0?l.jsx(wae,{testText:Z?.test_text,blanks:(ee||[]).map(($e,Be)=>({id:$e.question_id||Be+1,options:$e.blank_options||[],correct_answer:$e.correct_answers?.[0]||$e.correct_answer,question:$e.question_json||""})),separateType:Z?.separate_type,testId:j?.test_id,testName:Z?.test_name||j?.test_name,teacherId:Z?.teacher_id||j?.teacher_id,subjectId:Z?.subject_id||j?.subject_id,onTestComplete:or,onAnswerChange:($e,Be)=>{const Et=ee.findIndex(It=>It.question_id===$e);if(Et!==-1){const It=[...L];It[Et]=Be,V(It),ge.debug(` Fill Blanks answer changed: question ${$e} = ${Be}`)}}},`fill-blanks-${j?.test_id}-${Z?.test_name}`):null;default:return l.jsx("div",{children:"Unsupported question type"})}},[j,L,B]);function Fe(){return!j||!Z||!ee?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:Z.test_name||Z.title||"Test"})}),l.jsx("div",{className:"mb-4",children:l.jsx(vae,{answeredCount:Er(),totalQuestions:ee.length,percentage:Math.round(M),timeElapsed:Number(Z?.allowed_time||0)>0?W:0,showDetails:!0})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Answer all questions below:"}),l.jsx("div",{className:"space-y-8",children:ee.map((Pe,ze)=>l.jsx("div",{className:"question-container",children:Ne(Pe,ze)},Pe.question_id||ze))})]}),l.jsx("div",{className:"flex justify-center",children:l.jsx(Ze,{variant:"primary",size:"lg",onClick:()=>Ge(!0),disabled:X||Er()<ee.length,loading:X,children:X?"Submitting...":`Submit Test (${Er()}/${ee.length})`})})]})}if(f)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Wr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:t?"Starting Test...":"Loading Student Tests..."})]})});if(_)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:_}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx(fa,{isOpen:Le,onClose:()=>At(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>At(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:()=>{At(!1),fr()},variant:"primary",children:"Go Back"})]})]})}),l.jsx(fa,{isOpen:Ae,onClose:()=>Ge(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>Ge(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:()=>{Ge(!1),or()},variant:"primary",children:"Submit"})]})]})}),l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Test"})}),l.jsx(Ze,{variant:"outline",onClick:()=>At(!0),children:"Back to Cabinet"})]})})}),De&&F==="results"&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",Ie," times during the test."]})})]})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 overflow-y-auto",children:[!t&&F==="list"&&Re(),F==="test"&&Fe(),F==="results"&&bt()]}),F==="test"&&p&&l.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-[1px] flex flex-col items-center justify-center z-50",children:[l.jsx(Wr,{size:"lg"}),l.jsx("p",{className:"mt-3 text-gray-700",children:"Preparing your test"}),v&&l.jsx("div",{className:"mt-3 text-sm text-gray-500",children:v})]}),l.jsx(LB,{isOpen:le,onClose:()=>ce(!1),testType:_e?.test_type,testId:_e?.test_id,testName:_e?.test_name,questions:_e?.questions,isLoading:f}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:E.map(Pe=>l.jsx(mc,{type:Pe.type,message:Pe.message,onClose:()=>P(ze=>ze.filter(ke=>ke.id!==Pe.id))},Pe.id))})]});function Re(){return!a||a.length===0?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No active tests available for your class."})}):l.jsx("div",{className:"space-y-6",children:a.map((Pe,ze)=>l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Pe.test_name}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Subject:"})," ",Pe.subject]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Teacher:"})," ",Pe.teacher_name]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Type:"})," ",Pe.test_type]})]}),l.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Assigned: ",new Date(Pe.assigned_at).toLocaleDateString()]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:()=>Nt(Pe),disabled:C||f,children:"View Details"}),l.jsx(Ze,{variant:"primary",onClick:()=>Wt(Pe),disabled:C||f,children:C?"Starting...":"Start Test"})]})]})},ze))})}function bt(){if(!j||!Z||!ee||!L)return null;const Pe={};return L.forEach((ze,ke)=>{if(ee[ke]){const $e=ee[ke].question_id||ee[ke].id||ke;Pe[String($e)]=ze,ge.debug(" Converting answer:",{index:ke,questionId:$e,answer:ze,question:ee[ke]})}}),ge.debug(" Final answersObject:",Pe),ge.debug(" Questions structure:",ee.map(ze=>({id:ze.question_id,correct_answer:ze.correct_answer}))),l.jsx(uie,{testInfo:Z,questions:ee,testType:j.test_type,studentAnswers:Pe,onBackToCabinet:fr,checkAnswerCorrectness:Cm,formatStudentAnswerForDisplay:nr,getCorrectAnswer:tv})}},gie=()=>{const{testId:e}=Mb(),t=Po(),{user:r}=ds(),{makeAuthenticatedRequest:n}=tl(),{showNotification:s}=Aa(),[a,i]=S.useState(null),[o,c]=S.useState(!0),[u,d]=S.useState(null),[f,g]=S.useState(null),[p,x]=S.useState(!1);Jm("matching_type",a?.id);const v=S.useCallback(()=>{if(!r?.student_id||!e)return!1;const N=`test_completed_${r.student_id}_matching_type_${e}`,E=localStorage.getItem(N)==="true",P=`retest1_${r.student_id}_matching_type_${e}`,F=localStorage.getItem(P)==="true";return E&&!F?(ge.debug(" Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),t("/student"),!0):!1},[r?.student_id,e,t,s]),w=S.useCallback(async()=>{if(!e){d("Test ID is required"),c(!1);return}if(!v())try{c(!0),d(null);const N=await n(`/.netlify/functions/get-matching-type-test?test_id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!N.ok)throw new Error("Failed to load test data");const E=await N.json();if(!E.success)throw new Error(E.message||"Failed to load test");const P=E.data;ge.debug(" Test data from get-matching-type-test:",P);const F=await n(`/.netlify/functions/get-test-questions?test_id=${e}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!F.ok)throw new Error("Failed to load test questions");const A=await F.json();if(!A.success)throw new Error(A.message||"Failed to load test questions");ge.debug(" Questions data from get-test-questions:",A);const j={id:P.test_id,test_name:P.test_name,teacher_id:P.teacher_id,subject_id:P.subject_id,image_url:P.image_url,image:null,blocks:(()=>{if(Array.isArray(A.questions)&&A.questions.length>0){const I=A.questions[0];return Array.isArray(I.blocks)?I.blocks.map((B,Y)=>{let Z=B.block_coordinates||B.coordinates||(typeof B.x=="number"?{x:B.x,y:B.y,width:B.width,height:B.height}:null);if(typeof Z=="string")try{Z=JSON.parse(Z)}catch{Z=null}return(!Z||typeof Z!="object")&&(Z={x:0,y:0,width:30,height:10}),Z={x:(typeof Z.x=="number"?Z.x:Number(Z.x))||0,y:(typeof Z.y=="number"?Z.y:Number(Z.y))||0,width:(typeof Z.width=="number"?Z.width:Number(Z.width))||30,height:(typeof Z.height=="number"?Z.height:Number(Z.height))||10},{id:B.block_id||B.question_id||B.id||Y+1,word:B.word||`Word ${Y+1}`,coordinates:Z,hasArrow:!!B.has_arrow,arrow:B.arrow||null}}):A.questions.map(B=>{ge.debug(" Processing question:",B);let Y;try{Y=typeof B.block_coordinates=="string"?JSON.parse(B.block_coordinates):B.block_coordinates}catch{Y={x:0,y:0,width:100,height:100}}return(!Y||typeof Y!="object")&&(Y={x:0,y:0,width:100,height:100}),Y={x:(typeof Y.x=="number"?Y.x:Number(Y.x))||0,y:(typeof Y.y=="number"?Y.y:Number(Y.y))||0,width:(typeof Y.width=="number"?Y.width:Number(Y.width))||100,height:(typeof Y.height=="number"?Y.height:Number(Y.height))||100},{id:B.question_id,word:B.word,coordinates:Y,hasArrow:B.has_arrow,arrow:B.arrow}})}return[]})(),words:(()=>{if(Array.isArray(A.questions)&&A.questions.length>0){const I=A.questions[0];if(Array.isArray(I.words)){const B=I.words,Y=Array.isArray(I.blocks)?I.blocks:[];return typeof B[0]=="string"?B.map((se,ee)=>({id:`w_${Y[ee]?.question_id||Y[ee]?.block_id||A.questions[ee]?.question_id||ee+1}_${ee}`,word:String(se),blockId:null,isPlaced:!1,isCorrect:!1})):B.map((se,ee)=>({id:`w_${se.question_id||se.id||ee+1}_${ee}`,word:se.word||String(se.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return A.questions.map(B=>({id:`w_${B.question_id}`,word:B.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:P.arrows?P.arrows.map(I=>(ge.debug(" Processing arrow:",I),{id:I.id,questionId:I.question_id,blockId:I.block_id||I.question_id,start:{x:Number(I.start_x)||0,y:Number(I.start_y)||0},end:{x:Number(I.end_x)||0,y:Number(I.end_y)||0},rel_start_x:I.rel_start_x!==null?Number(I.rel_start_x):null,rel_start_y:I.rel_start_y!==null?Number(I.rel_start_y):null,rel_end_x:I.rel_end_x!==null?Number(I.rel_end_x):null,rel_end_y:I.rel_end_y!==null?Number(I.rel_end_y):null,image_width:I.image_width?Number(I.image_width):null,image_height:I.image_height?Number(I.image_height):null,style:(typeof I.style=="string"?JSON.parse(I.style):I.style)||{color:"#dc3545",thickness:3}})):[]};if(P.image_url){const I=new Image;I.crossOrigin="anonymous",I.onload=()=>{j.image=I,i(j),c(!1)},I.onerror=()=>{ge.warn("Failed to load test image"),i(j),c(!1)},I.src=P.image_url}else i(j),c(!1)}catch(N){ge.error("Error loading test data:",N),d(N.message||"Failed to load test"),c(!1)}},[e,n]);S.useEffect(()=>{r?.student_id&&w()},[w,r?.student_id]);const C=S.useCallback(async N=>{ge.debug("Test completed:",N),s("Test completed successfully!","success");const E=parseInt(N)||0,P=a?.blocks?.length||a?.words?.length||0,F=P>0?Math.round(E/P*100):0,A={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"matching_type",score:E,totalQuestions:P,percentage:F,passed:F>=60,questionAnalysis:a?.questions?.map((j,I)=>({questionNumber:I+1,isCorrect:I<E,userAnswer:I<E?`Matched: ${j.word}`:"Not answered",correctAnswer:`Match: ${j.word}`}))||Array.from({length:P},(j,I)=>({questionNumber:I+1,isCorrect:I<E,userAnswer:I<E?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};ge.debug(" Using test results data:",A),g(A),x(!0)},[a,s]),k=S.useCallback(()=>{t("/student")},[t]),_=S.useCallback(()=>{x(!1),g(null),w()},[w]);return o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(jt,{className:"max-w-md w-full",children:l.jsxs(jt.Body,{className:"text-center",children:[l.jsx(Wr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):u?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(jt,{className:"max-w-md w-full",children:l.jsxs(jt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:u}),l.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):a?p&&f?l.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:l.jsx(Kv,{testResults:f,onBackToCabinet:k,onRetakeTest:_,isLoading:!1})}):l.jsx(lae,{testData:a,onTestComplete:C,onBackToCabinet:k}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(jt,{className:"max-w-md w-full",children:l.jsxs(jt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),l.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},mie=()=>{const{testId:e}=Mb(),t=Po(),{user:r}=ds(),{makeAuthenticatedRequest:n}=tl(),{showNotification:s}=Aa(),[a,i]=S.useState(null),[o,c]=S.useState(!0),[u,d]=S.useState(null),[f,g]=S.useState(null),[p,x]=S.useState(!1),v=S.useCallback(()=>{if(!r?.student_id||!e)return!1;const _=`test_completed_${r.student_id}_word_matching_${e}`,N=`retest1_${r.student_id}_word_matching_${e}`;return localStorage.getItem(N)==="true"?!1:localStorage.getItem(_)==="true"},[r?.student_id,e]),w=S.useCallback(async()=>{if(!e){d("Test ID is required"),c(!1);return}if(v()){s("This test has already been completed","warning"),t("/student");return}c(!0),d(null);try{const _=`word_matching_test_${e}`,N=Bs(_);if(N){if(ge.debug(" Word matching test loaded from cache:",N),N.id){let F=N,A=Array.isArray(F.correctPairs)?F.correctPairs:F.correctPairs&&typeof F.correctPairs=="object"?Object.keys(F.correctPairs).map(j=>[Number(j),F.correctPairs[j]]).sort((j,I)=>j[0]-I[0]).map(([,j])=>j):null;if(Array.isArray(F.leftWords)&&Array.isArray(F.rightWords)&&Array.isArray(A)){const j=F.rightWords.map((ee,te)=>te),I=F.leftWords.map((ee,te)=>te);for(let ee=j.length-1;ee>0;ee--){const te=Math.floor(Math.random()*(ee+1));[j[ee],j[te]]=[j[te],j[ee]]}for(let ee=I.length-1;ee>0;ee--){const te=Math.floor(Math.random()*(ee+1));[I[ee],I[te]]=[I[te],I[ee]]}const B=j.map(ee=>F.rightWords[ee]),Y=I.map(ee=>F.leftWords[ee]),Z=new Map(j.map((ee,te)=>[ee,te])),se=I.map(ee=>{const te=A[ee];return Z.get(te)});F={...F,leftWords:Y,rightWords:B,correctPairs:se}}i(F)}else{let A={id:N.test_id,test_id:N.test_id,test_name:N.test_name,teacher_id:N.teacher_id,subject_id:N.subject_id,num_questions:N.num_questions,interaction_type:N.interaction_type,passing_score:N.passing_score,created_at:N.created_at,updated_at:N.updated_at,leftWords:N.leftWords,rightWords:N.rightWords,correctPairs:N.correctPairs,originalPairs:N.originalPairs},j=Array.isArray(A.correctPairs)?A.correctPairs:A.correctPairs&&typeof A.correctPairs=="object"?Object.keys(A.correctPairs).map(I=>[Number(I),A.correctPairs[I]]).sort((I,B)=>I[0]-B[0]).map(([,I])=>I):null;if(Array.isArray(A.leftWords)&&Array.isArray(A.rightWords)&&Array.isArray(j)){const I=A.rightWords.map((te,L)=>L),B=A.leftWords.map((te,L)=>L);for(let te=I.length-1;te>0;te--){const L=Math.floor(Math.random()*(te+1));[I[te],I[L]]=[I[L],I[te]]}for(let te=B.length-1;te>0;te--){const L=Math.floor(Math.random()*(te+1));[B[te],B[L]]=[B[L],B[te]]}const Y=I.map(te=>A.rightWords[te]),Z=B.map(te=>A.leftWords[te]),se=new Map(I.map((te,L)=>[te,L])),ee=B.map(te=>{const L=j[te];return se.get(L)});A={...A,leftWords:Z,rightWords:Y,correctPairs:ee}}i(A)}c(!1);return}const P=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${e}`)).json();if(P.success){const F={id:P.data.test_id,test_id:P.data.test_id,test_name:P.data.test_name,teacher_id:P.data.teacher_id,subject_id:P.data.subject_id,num_questions:P.data.num_questions,interaction_type:P.data.interaction_type,passing_score:P.data.passing_score,created_at:P.data.created_at,updated_at:P.data.updated_at,leftWords:P.data.leftWords,rightWords:P.data.rightWords,correctPairs:P.data.correctPairs,originalPairs:P.data.originalPairs};let A=F,j=Array.isArray(A.correctPairs)?A.correctPairs:A.correctPairs&&typeof A.correctPairs=="object"?Object.keys(A.correctPairs).map(I=>[Number(I),A.correctPairs[I]]).sort((I,B)=>I[0]-B[0]).map(([,I])=>I):null;if(Array.isArray(A.leftWords)&&Array.isArray(A.rightWords)&&Array.isArray(j)){const I=A.rightWords.map((te,L)=>L),B=A.leftWords.map((te,L)=>L);for(let te=I.length-1;te>0;te--){const L=Math.floor(Math.random()*(te+1));[I[te],I[L]]=[I[L],I[te]]}for(let te=B.length-1;te>0;te--){const L=Math.floor(Math.random()*(te+1));[B[te],B[L]]=[B[L],B[te]]}const Y=I.map(te=>A.rightWords[te]),Z=B.map(te=>A.leftWords[te]),se=new Map(I.map((te,L)=>[te,L])),ee=B.map(te=>{const L=j[te];return se.get(L)});A={...A,leftWords:Z,rightWords:Y,correctPairs:ee}}i(A),_s(_,A,Ls.word_matching_test),ge.debug(" Word matching test loaded from API and cached:",F)}else throw new Error(P.message||"Failed to load test")}catch(_){ge.error("Error loading word matching test:",_),d(_.message),s("Failed to load test: "+_.message,"error")}finally{c(!1)}},[e,v,n,s,t]),C=S.useCallback(async _=>{ge.debug("Test completed:",_),s("Test completed successfully!","success");const N=parseInt(_)||0,E=a?.num_questions||0,P=E>0?Math.round(N/E*100):0,F={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"word_matching",score:N,totalQuestions:E,percentage:P,passed:P>=60,questionAnalysis:Array.isArray(a?.correctPairs)?a.correctPairs.map((A,j)=>({questionNumber:j+1,isCorrect:j<N,userAnswer:j<N?`${A.left}  ${A.right}`:"Not answered",correctAnswer:`${A.left}  ${A.right}`})):Array.from({length:E},(A,j)=>({questionNumber:j+1,isCorrect:j<N,userAnswer:j<N?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};ge.debug(" Using test results data:",F),g(F),x(!0)},[a,s]),k=S.useCallback(()=>{t("/student")},[t]);return S.useEffect(()=>{w()},[w]),o?l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsxs(jt,{className:"p-8 text-center",children:[l.jsx(Wr,{size:"lg",className:"mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):u?l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(jt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-red-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:u}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):a?p&&f?l.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:l.jsx(Kv,{testResults:f,onBackToCabinet:()=>{g(null),x(!1),t("/student")},onRetakeTest:(_,N)=>{g(null),x(!1),w()},isLoading:!1})}):l.jsx(at.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gray-50 py-8",children:l.jsx(dae,{testData:a,onTestComplete:C,onBackToCabinet:k})}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(jt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-gray-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},pie=S.forwardRef(({onRecordingComplete:e,minDuration:t=0,maxDuration:r=600,minWords:n=50,maxAttempts:s=3,currentAttempt:a=1},i)=>{const[o,c]=S.useState(!1),[u,d]=S.useState(!1),[f,g]=S.useState(0),[p,x]=S.useState(null),[v,w]=S.useState(null),[C,k]=S.useState("good"),_=S.useRef(null),N=S.useRef([]),E=S.useRef(null),P=S.useRef(null),F=S.useRef(null),A=S.useRef(null),j=S.useRef(null);S.useImperativeHandle(i,()=>({startRecording:()=>I(),stopRecording:()=>B(),pauseRecording:()=>Y(),resumeRecording:()=>Z()}));const I=S.useCallback(async()=>{try{if(w(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");if(!window.isSecureContext&&!window.location.hostname.includes("localhost"))throw new Error("Microphone access requires HTTPS. Please use a secure connection.");const V=window.AudioContext||window.webkitAudioContext;F.current||(F.current=new V),F.current.state!=="running"&&await F.current.resume().catch(()=>{}),console.log(" Requesting microphone permission...");const M=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,channelCount:1}});console.log(" Microphone permission granted"),E.current=M;try{let K=document.getElementById("ios-audio-sink");K||(K=document.createElement("audio"),K.id="ios-audio-sink",K.muted=!0,K.playsInline=!0,K.style.display="none",document.body.appendChild(K)),K.srcObject=M,await K.play().catch(()=>{})}catch{}const H=F.current.createAnalyser();F.current.createMediaStreamSource(M).connect(H),H.fftSize=256,A.current=H,se();let R="audio/webm;codecs=opus";typeof MediaRecorder<"u"&&MediaRecorder.isTypeSupported&&!MediaRecorder.isTypeSupported(R)&&(MediaRecorder.isTypeSupported("audio/mp4")?R="audio/mp4":MediaRecorder.isTypeSupported("audio/aac")?R="audio/aac":R="");const z=new MediaRecorder(M,R?{mimeType:R}:void 0);_.current=z,N.current=[],z.ondataavailable=K=>{K.data.size>0&&N.current.push(K.data)},z.onstop=()=>{const K=R&&R.startsWith("audio/")?R:"audio/webm",Q=new Blob(N.current,{type:K});x(Q),e(Q,f),E.current&&E.current.getTracks().forEach(ae=>ae.stop()),j.current&&cancelAnimationFrame(j.current)},z.start(1e3),c(!0),g(0),P.current=setInterval(()=>{g(K=>{const Q=K+1;return Q>=r&&B(),Q})},1e3)}catch(V){console.error("Error starting recording:",V);const M=/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1;V.name==="NotAllowedError"?w(M?"Microphone access denied. Please go to Settings > Safari > Microphone and allow access, then refresh the page.":"Microphone access denied. Please allow microphone access in your browser settings and try again."):V.name==="NotFoundError"?w("No microphone found. Please connect a microphone and try again."):V.name==="NotSupportedError"?w("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox."):V.message.includes("HTTPS")?w("Microphone access requires HTTPS. Please use a secure connection."):w(`Failed to access microphone: ${V.message}`)}},[r]),B=S.useCallback(()=>{if(_.current&&o&&(_.current.stop(),c(!1),d(!1),P.current&&clearInterval(P.current),f<t)){w(`Recording must be at least ${t} seconds long.`);return}},[o,f,t,p,e]),Y=S.useCallback(()=>{_.current&&o&&!u&&(_.current.pause(),d(!0),P.current&&clearInterval(P.current))},[o,u]),Z=S.useCallback(()=>{_.current&&o&&u&&(_.current.resume(),d(!1),P.current=setInterval(()=>{g(V=>{const M=V+1;return M>=r&&B(),M})},1e3))},[o,u,r,B]),se=S.useCallback(()=>{if(!A.current)return;const V=A.current,M=new Uint8Array(V.frequencyBinCount),H=()=>{V.getByteFrequencyData(M);const W=M.reduce((R,z)=>R+z,0)/M.length;W<10?k("poor"):W<30?k("fair"):k("good"),o&&(j.current=requestAnimationFrame(H))};H()},[o]),ee=V=>{const M=Math.floor(V/60),H=V%60;return`${M}:${H.toString().padStart(2,"0")}`},te=()=>{switch(C){case"poor":return"text-red-600";case"fair":return"text-yellow-600";case"good":return"text-green-600";default:return"text-gray-600"}},L=()=>{switch(C){case"poor":return"Poor audio quality - speak closer to microphone";case"fair":return"Fair audio quality - good for recording";case"good":return"Excellent audio quality";default:return"Monitoring audio quality..."}};return l.jsxs("div",{className:"audio-recorder bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Record Your Response"}),l.jsx("p",{className:"text-gray-600",children:"Speak clearly and at a normal pace. You can pause and resume if needed."})]}),l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:ee(f)}),l.jsx("div",{className:`text-sm ${te()}`,children:L()}),u&&l.jsx("div",{className:"text-yellow-600 font-semibold mt-2",children:" Recording Paused"})]}),o&&l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"flex justify-center items-center space-x-1 h-8",children:Array.from({length:20},(V,M)=>l.jsx("div",{className:"bg-blue-400 rounded-sm",style:{width:"4px",height:`${Math.random()*20+4}px`,animation:"pulse 0.5s ease-in-out infinite"}},M))})}),l.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-center mb-6",children:o?l.jsxs(l.Fragment,{children:[u?l.jsxs("button",{onClick:Z,className:"w-full sm:w-auto bg-green-600 text-white px-6 py-4 rounded-full hover:bg-green-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Resume"})]}):l.jsxs("button",{onClick:Y,className:"w-full sm:w-auto bg-yellow-600 text-white px-6 py-4 rounded-full hover:bg-yellow-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Pause"})]}),l.jsxs("button",{onClick:B,className:"w-full sm:w-auto bg-gray-600 text-white px-6 py-4 rounded-full hover:bg-gray-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Stop & Submit"})]})]}):l.jsxs("button",{onClick:I,className:"w-full sm:w-auto bg-red-600 text-white px-6 py-4 rounded-full hover:bg-red-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Start Recording"})]})}),v&&l.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:v})}),l.jsxs("div",{className:"mt-4 text-center text-sm text-gray-600",children:["Attempt ",a," of ",s,a<s&&l.jsx("span",{className:"ml-2 text-blue-600",children:"(You can re-record if needed)"})]})]})}),XB=({audioBlob:e,audioUrl:t,recordingTime:r,className:n=""})=>{const[s,a]=S.useState(!1),[i,o]=S.useState(0),[c,u]=S.useState(0),[d,f]=S.useState(1),[g,p]=S.useState(1),[x,v]=S.useState(!0),[w,C]=S.useState(""),[k,_]=S.useState(!1),[N,E]=S.useState(null),[P,F]=S.useState(!1),A=S.useRef(null),j=S.useRef(null),I=S.useRef(!1);S.useEffect(()=>()=>{I.current=!0},[]),S.useEffect(()=>{let M=!1;if(t)M||C(t);else if(e){if(!e||e.size===0){M||v(!1);return}if(!(e instanceof Blob)){console.error("audioBlob is not a Blob:",typeof e,e),M||v(!1);return}const H=URL.createObjectURL(e);return M||C(H),()=>{M=!0,URL.revokeObjectURL(H)}}return()=>{M=!0}},[e,t]),S.useEffect(()=>{let M=!1;const H=R=>{try{const z=new URL(R);return/\/storage\/v1\/object\/public\//.test(z.pathname)}catch{return!1}};async function W(R){if(!R||P||/\/object\/sign\//.test(R)||!H(R))return R;try{const K=new URL(R).pathname.replace(/^\/storage\/v1\/object\/public\//,""),Q=K.split("/")[0],ae=K.substring(Q.length+1),X=await fetch(`/.netlify/functions/get-speaking-test-new?action=sign-audio&bucket=${encodeURIComponent(Q)}&file_path=${encodeURIComponent(ae)}`);if(X.ok){const{url:ie}=await X.json();if(!M&&!I.current){F(!0);try{await fetch(ie,{headers:{Range:"bytes=0-1"},mode:"cors"})}catch{}C(ie)}return ie}}catch{}return R}return(async()=>{if(t){const R=await W(t);try{await fetch(R,{headers:{Range:"bytes=0-1"},mode:"cors"})}catch{}!M&&!I.current&&!P&&C(R)}})(),()=>{M=!0}},[t,P]),S.useEffect(()=>{let M=!1;return w&&(M||(_(!1),E(null),v(!0))),()=>{M=!0}},[w]),S.useEffect(()=>{if(A.current&&w){const M=A.current;let H=!1;try{M.src=w}catch{}M.load();const W=()=>{if(H||I.current)return;let ne=M.duration;if(ne===1/0)try{M.currentTime=1e101,M.ontimeupdate=()=>{if(H||I.current)return;M.ontimeupdate=null;const pe=M.duration;H||(u(isFinite(pe)&&pe>0?pe:0),M.currentTime=0,v(!1))};return}catch(pe){console.warn("Seek trick failed:",pe)}if(isNaN(ne)||!isFinite(ne)||ne<=0){const pe=M.seekable&&M.seekable.length>0&&isFinite(M.seekable.end(0)),Ce=!pe&&M.buffered&&M.buffered.length>0&&isFinite(M.buffered.end(M.buffered.length-1));pe?ne=M.seekable.end(0):Ce&&(ne=M.buffered.end(M.buffered.length-1))}isNaN(ne)||!isFinite(ne)||ne<=0?(console.warn("Invalid audio duration after fallbacks:",ne),r&&r>0?H||u(r):H||u(0)):H||u(ne),H||v(!1)},R=()=>{H||I.current||W()},z=()=>{H||I.current||W()},K=()=>{H||I.current||W()},Q=()=>{H||I.current||W()},ae=()=>{H||I.current||o(M.currentTime)},X=()=>{H||I.current||(a(!1),o(0))},ie=()=>{H||I.current||a(!0)},le=()=>{H||I.current||a(!1)},ce=ne=>{if(H||I.current)return;console.error("Audio loading error:",ne),console.error("Audio error details:",{error:M.error,networkState:M.networkState,readyState:M.readyState,src:M.src,currentSrc:M.currentSrc});const pe=M.error?.code;pe===4&&_(!0),E(M.error||{code:pe}),v(!1)},_e=setTimeout(()=>{H||I.current||M.readyState===0&&v(!1)},6e3);return M.addEventListener("loadedmetadata",R),M.addEventListener("durationchange",z),M.addEventListener("canplay",K),M.addEventListener("canplaythrough",Q),M.addEventListener("timeupdate",ae),M.addEventListener("ended",X),M.addEventListener("play",ie),M.addEventListener("pause",le),M.addEventListener("error",ce),()=>{H=!0,clearTimeout(_e),M.removeEventListener("loadedmetadata",R),M.removeEventListener("durationchange",z),M.removeEventListener("canplay",K),M.removeEventListener("canplaythrough",Q),M.removeEventListener("timeupdate",ae),M.removeEventListener("ended",X),M.removeEventListener("play",ie),M.removeEventListener("pause",le),M.removeEventListener("error",ce),M.pause(),M.src="",M.load()}}},[w,r]),S.useEffect(()=>{let M=!1;return r&&r>0&&(isNaN(c)||!isFinite(c)||c<=0)&&(M||u(r)),()=>{M=!0}},[r,c]);const B=()=>{A.current&&(s?A.current.pause():A.current.play().catch(M=>{console.error("Play failed:",M)}))},Y=M=>{if(A.current&&j.current&&c>0){const H=j.current.getBoundingClientRect(),W=M.clientX-H.left,R=H.width,z=Math.max(0,Math.min(c,W/R*c));isFinite(z)&&z>=0&&(A.current.currentTime=z,o(z))}},Z=M=>{const H=parseFloat(M.target.value);f(H),A.current&&(A.current.volume=H)},se=M=>{const H=parseFloat(M.target.value);p(H),A.current&&(A.current.playbackRate=H)},ee=M=>{if(isNaN(M))return"0:00";const H=Math.floor(M/60),W=Math.floor(M%60);return`${H}:${W.toString().padStart(2,"0")}`};if(!e&&!t)return l.jsx("div",{className:`audio-player ${n}`,children:l.jsx("div",{className:"text-center text-gray-500 py-8",children:"No audio available"})});const L=(M=>{try{const W=(M||"").toLowerCase().split("?")[0].split("#")[0];return W.endsWith(".webm")?"audio/webm":W.endsWith(".mp3")?"audio/mpeg":W.endsWith(".m4a")?"audio/mp4":W.endsWith(".aac")?"audio/aac":W.endsWith(".wav")?"audio/wav":void 0}catch{return}})(w||t),V=Is.useMemo(()=>typeof window>"u"?!0:document.createElement("audio").canPlayType("audio/webm")!=="",[]);return l.jsxs("div",{className:`audio-player bg-gray-50 rounded-lg p-4 ${n}`,children:[l.jsx("audio",{ref:A,preload:"metadata",controls:!1,style:{display:"none"},crossOrigin:"anonymous",children:l.jsx("source",{src:w,type:L})}),x?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),l.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Loading audio..."})]}):k?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:"text-sm text-red-600",children:"This audio format isn't supported by your browser."}),w?l.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,L?l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",L]}):null,l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Browser WebM support: ",V?"Yes":"No",!V&&" - Try using Chrome, Firefox, or Edge"]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Preferred format: WebM"})]}):N?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:"text-sm text-red-600",children:"Playback failed. Please try opening the audio directly."}),w?l.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,L?l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",L]}):null]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{ref:j,className:"w-full bg-gray-200 rounded-full h-3 cursor-pointer hover:h-4 transition-all min-h-[24px]",onClick:Y,children:l.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all",style:{width:`${i/c*100}%`}})}),l.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mt-2 font-medium",children:[l.jsx("span",{children:ee(i)}),l.jsx("span",{children:ee(c)})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:B,className:"bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center",children:s?l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.617 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.617l3.766-3.793a1 1 0 011.617.793zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:d,onChange:Z,className:"w-24 h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer min-h-[20px]"}),l.jsxs("span",{className:"text-sm text-gray-600 w-10 font-medium",children:[Math.round(d*100),"%"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Speed:"}),l.jsxs("select",{value:g,onChange:se,className:"text-sm border border-gray-300 rounded px-2 py-1",children:[l.jsx("option",{value:"0.5",children:"0.5x"}),l.jsx("option",{value:"0.75",children:"0.75x"}),l.jsx("option",{value:"1",children:"1x"}),l.jsx("option",{value:"1.25",children:"1.25x"}),l.jsx("option",{value:"1.5",children:"1.5x"}),l.jsx("option",{value:"2",children:"2x"})]})]})]})]})]})},xie=({transcript:e,scores:t,audioBlob:r,recordingTime:n,onReRecord:s,onFinalSubmit:a,canReRecord:i,attemptNumber:o,maxAttempts:c,isSubmitting:u=!1})=>{const[d,f]=S.useState(!1);console.log(" FeedbackDisplay received recordingTime:",n);const g=(w,C)=>{const k=w/C*100;return k>=80?"text-green-600":k>=60?"text-yellow-600":"text-red-600"},p=(w,C)=>{const k=w/C*100;return k>=90?"A+":k>=80?"A":k>=70?"B":k>=60?"C":k>=50?"D":"F"},x=()=>p(t?.overall_score||0,100),v=()=>g(t?.overall_score||0,100);return console.log(" FeedbackDisplay received scores:",t),console.log(" Individual score values:",{grammar_score:t?.grammar_score,vocabulary_score:t?.vocabulary_score,pronunciation_score:t?.pronunciation_score,fluency_score:t?.fluency_score,content_score:t?.content_score}),l.jsxs("div",{className:"feedback-display bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Speaking Test Results"}),l.jsx("p",{className:"text-gray-600",children:"Review your performance and decide whether to submit or re-record."})]}),l.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-3 sm:p-6 rounded-lg mb-6",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-4xl font-bold ${v()}`,children:[t?.overall_score||0,"/100"]}),l.jsxs("div",{className:`text-2xl font-semibold ${v()} mt-2`,children:["Grade: ",x()]}),l.jsx("div",{className:"text-gray-600 mt-2",children:t?.overall_score>=80?"Excellent work!":t?.overall_score>=60?"Good job!":t?.overall_score>=50?"Not bad, but could be better.":"Keep practicing!"})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Grammar"}),l.jsxs("span",{className:`font-bold ${g(t?.grammar_score||0,25)}`,children:[t?.grammar_score||0,"/25"]})]}),l.jsxs("div",{className:"text-sm text-gray-600",children:[t?.grammar_mistakes||0," mistakes found"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Math.min((t?.grammar_score||0)/25*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Vocabulary"}),l.jsxs("span",{className:`font-bold ${g(t?.vocabulary_score||0,20)}`,children:[t?.vocabulary_score||0,"/20"]})]}),l.jsxs("div",{className:"text-sm text-gray-600",children:[t?.vocabulary_mistakes||0," vocabulary issues"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:`${Math.min((t?.vocabulary_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Pronunciation"}),l.jsxs("span",{className:`font-bold ${g(t?.pronunciation_score||0,15)}`,children:[t?.pronunciation_score||0,"/15"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Clarity and accuracy"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:`${Math.min((t?.pronunciation_score||0)/15*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Fluency"}),l.jsxs("span",{className:`font-bold ${g(t?.fluency_score||0,20)}`,children:[t?.fluency_score||0,"/20"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Pace, pauses, and flow"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min((t?.fluency_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Content"}),l.jsxs("span",{className:`font-bold ${g(t?.content_score||0,20)}`,children:[t?.content_score||0,"/20"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"How well addressed the prompt"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${Math.min((t?.content_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Word Count"}),l.jsxs("span",{className:"font-bold text-gray-700",children:[t?.word_count||0," words"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total words spoken"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-gray-600 h-2 rounded-full",style:{width:`${Math.min((t?.word_count||0)/100*100,100)}%`}})})]})]}),r&&l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Your Recording"}),l.jsx(XB,{audioBlob:r,recordingTime:n})]}),t?.feedback&&l.jsx("div",{className:"mb-6 bg-gradient-to-r from-green-50 to-blue-50 p-3 sm:p-6 rounded-lg border border-green-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("span",{className:"text-green-600 text-2xl",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-semibold text-green-800 mb-3 text-lg",children:"AI Feedback"}),l.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.feedback})]})]})}),t?.improved_transcript&&l.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[l.jsx("span",{className:"text-green-600 text-lg",children:""}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:"Improved Version"}),l.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Here's how your response could be improved with better grammar and vocabulary:"})]})]}),l.jsx("div",{className:"bg-white border border-green-200 rounded p-3",children:l.jsx("p",{className:"text-gray-800 leading-relaxed",children:t.improved_transcript})})]}),l.jsx("div",{className:"mb-6",children:l.jsx("button",{onClick:()=>f(!d),className:"text-blue-600 hover:text-blue-800 text-sm",children:d?"Hide Details":"Show Details"})}),d&&l.jsxs("div",{className:"mb-6 bg-blue-50 p-3 sm:p-4 rounded-lg",children:[l.jsx("h4",{className:"font-semibold mb-3",children:"Detailed Analysis"}),l.jsxs("div",{className:"space-y-3 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Word Count Analysis:"}),l.jsxs("span",{className:"ml-2 text-gray-700",children:["You spoke ",t?.word_count||0," words.",t?.word_count>=50?" Great job meeting the minimum requirement!":" Consider speaking more to meet the minimum word requirement."]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Grammar Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.grammar_mistakes===0?"Perfect grammar!":`Found ${t?.grammar_mistakes||0} grammar ${t?.grammar_mistakes===1?"mistake":"mistakes"}.`}),t?.grammar_corrections&&t.grammar_corrections.length>0&&l.jsx("div",{className:"mt-2 space-y-2",children:t.grammar_corrections.map((w,C)=>l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-red-600 font-mono text-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-red-600",children:w.mistake}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-600",children:w.correction})]}),l.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[l.jsx("strong",{children:"Explanation:"})," ",w.explanation]})]})]})},C))})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Vocabulary Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.vocabulary_mistakes===0?"Excellent vocabulary usage!":`Found ${t?.vocabulary_mistakes||0} vocabulary ${t?.vocabulary_mistakes===1?"issue":"issues"}.`}),t?.vocabulary_corrections&&t.vocabulary_corrections.length>0&&l.jsx("div",{className:"mt-2 space-y-2",children:t.vocabulary_corrections.map((w,C)=>l.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-purple-600 font-mono text-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-purple-600",children:w.mistake}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-600",children:w.correction})]}),l.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[l.jsx("strong",{children:"Explanation:"})," ",w.explanation]})]})]})},C))})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Pronunciation Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.pronunciation_corrections&&t.pronunciation_corrections.length>0?`Found ${t.pronunciation_corrections.length} pronunciation ${t.pronunciation_corrections.length===1?"tip":"tips"} to help improve clarity.`:"Great pronunciation! Your speech was clear and easy to understand."})]}),t?.pronunciation_corrections&&t.pronunciation_corrections.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Pronunciation Tips:"}),l.jsx("div",{className:"mt-2 space-y-2",children:t.pronunciation_corrections.map((w,C)=>l.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-orange-600 font-mono text-sm",children:""}),l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-orange-700",children:w.word}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-700",children:w.correction})]})})]})},C))})]}),t?.language_use_corrections&&t.language_use_corrections.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Language Use Suggestions:"}),l.jsx("div",{className:"mt-2 space-y-2",children:t.language_use_corrections.map((w,C)=>l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-blue-600 font-mono text-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-blue-700",children:w.mistake}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-700",children:w.suggestion})]}),w.explanation&&l.jsxs("div",{className:"text-xs text-blue-700 mt-1",children:[l.jsx("strong",{children:"Why:"})," ",w.explanation]})]})]})},C))})]})]})]}),l.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["Attempt ",o," of ",c]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-center justify-center",children:[i&&l.jsxs("button",{onClick:s,className:"w-full sm:w-auto bg-yellow-600 text-white px-4 py-2.5 rounded-lg hover:bg-yellow-700 flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Re-record"})]}),l.jsx("button",{onClick:a,disabled:u,className:`w-full sm:w-auto px-4 py-2.5 rounded-lg flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium ${u?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"} text-white`,children:u?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Submitting..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Submit Final"})]})})]}),!i&&l.jsx("div",{className:"mt-4 p-2 sm:p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:l.jsxs("p",{className:"text-yellow-800 text-sm",children:[l.jsx("strong",{children:"Maximum attempts reached."}),' This is your final attempt. Click "Submit Final" to complete the test.']})})]})},yie=({testData:e,onComplete:t,onExit:r,onTestComplete:n})=>{const[s,a]=S.useState("recording"),[i,o]=S.useState(null),[c,u]=S.useState(""),[d,f]=S.useState(null),[g,p]=S.useState(!1),[x,v]=S.useState(!1),[w,C]=S.useState(!1),[k,_]=S.useState(null),[N,E]=S.useState(1),[P]=S.useState(e.max_attempts||3),[F,A]=S.useState(!1),[j,I]=S.useState(0),[B,Y]=S.useState(!1),[Z,se]=S.useState(0),[ee,te]=S.useState(null),L=tl(),{user:V}=ds(),{makeAuthenticatedRequest:M}=L,H=S.useRef(null);S.useEffect(()=>{if(e?.test_id&&V?.student_id){const ce=`speaking_attempts_${V.student_id}_${e.test_id}`,_e=localStorage.getItem(ce);if(_e){const ne=parseInt(_e,10);ne>0&&ne<=P&&(E(ne),console.log(" Loaded attempts from localStorage:",ne))}}},[e,V,P]),S.useEffect(()=>{if(e&&!ee){const ce=new Date;te(ce),console.log(" Speaking test timer started at:",ce.toISOString())}},[e,ee]),S.useEffect(()=>{let ce=0;s==="recording"?ce=25:s==="processing"?ce=50:s==="feedback"?ce=75:s==="completed"&&(ce=100),se(ce)},[s]),S.useEffect(()=>{(async()=>{try{if(!window.isSecureContext&&!window.location.hostname.includes("localhost")){_("Microphone access requires HTTPS. Please use a secure connection.");return}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){_("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");return}if(navigator.permissions)try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?(A(!0),console.log(" Microphone permission already granted")):console.log(" Microphone permission not yet granted - user will need to click record button")}catch(_e){console.log(" Could not check microphone permission status:",_e)}}catch(_e){console.error(" Error checking microphone permission:",_e)}})()},[]),S.useEffect(()=>{const ce=setInterval(()=>{i&&s==="recording"&&W()},3e4);return()=>clearInterval(ce)},[i,s]);const W=S.useCallback(async()=>{try{const ce={test_id:e.test_id,audio_blob:i?await R(i):null,attempt_number:N,step:s,timestamp:new Date().toISOString()};localStorage.setItem(`speaking_progress_${e.test_id}`,JSON.stringify(ce))}catch(ce){console.error("Failed to save progress:",ce)}},[e.test_id,i,N,s]),R=ce=>new Promise((_e,ne)=>{const pe=new FileReader;pe.onloadend=()=>{const Ae=pe.result.split(",")[1];_e(Ae)},pe.onerror=ne,pe.readAsDataURL(ce)}),z=S.useCallback(ce=>{if(e?.test_id&&V?.student_id){const _e=`speaking_attempts_${V.student_id}_${e.test_id}`;localStorage.setItem(_e,ce.toString()),console.log(" Saved attempts to localStorage:",ce)}},[e,V]),K=S.useCallback(async(ce,_e,ne,pe,Ce)=>{if(e?.test_id&&V?.student_id)try{const{setCachedData:Ae,CACHE_TTL:Ge}=await mi(async()=>{const{setCachedData:pt,CACHE_TTL:lt}=await Promise.resolve().then(()=>qg);return{setCachedData:pt,CACHE_TTL:lt}},void 0),Le=`speaking_test_data_${V.student_id}_${e.test_id}`,et={audioBlob:ce?await R(ce):null,transcript:_e,scores:ne,recordingTime:pe,currentStep:Ce,timestamp:Date.now()};Ae(Le,et,Ge.speaking_test_data),console.log(" Saved speaking test data to cache:",Le)}catch(Ae){console.error("Failed to save speaking test data to cache:",Ae)}},[e,V]),Q=S.useCallback(async()=>{if(e?.test_id&&V?.student_id)try{const{getCachedData:ce}=await mi(async()=>{const{getCachedData:pe}=await Promise.resolve().then(()=>qg);return{getCachedData:pe}},void 0),_e=`speaking_test_data_${V.student_id}_${e.test_id}`,ne=ce(_e);if(ne){if(console.log(" Loaded speaking test data from cache:",ne),ne.audioBlob){const pe=new Blob([Uint8Array.from(atob(ne.audioBlob),Ce=>Ce.charCodeAt(0))],{type:"audio/webm"});o(pe)}return ne.transcript&&u(ne.transcript),ne.scores&&f(ne.scores),ne.recordingTime&&I(ne.recordingTime),ne.currentStep&&a(ne.currentStep),!0}}catch(ce){console.error("Failed to load speaking test data from cache:",ce)}return!1},[e,V]);S.useEffect(()=>{if(e?.test_id&&V?.student_id){try{const ce=V.student_id,_e=`retest_assignment_id_${ce}_speaking_${e.test_id}`,ne=`retest_in_progress_${ce}_speaking_${e.test_id}`;if(!!localStorage.getItem(_e)||!!localStorage.getItem(ne)){const Ce=`speaking_test_data_${ce}_${e.test_id}`,Ae=`anti_cheating_${ce}_speaking_${e.test_id}`,Ge=`speaking_progress_${e.test_id}`;localStorage.removeItem(Ce),localStorage.removeItem(Ae),localStorage.removeItem(Ge),console.log(" Cleared speaking per-test cache for retest start:",{cacheKey:Ce,antiCheatKey:Ae,progressKey:Ge})}}catch{}Q()}},[e,V,Q]),S.useEffect(()=>{e?.test_id&&V?.student_id&&(i||c||d)&&K(i,c,d,j,s)},[i,c,d,j,s,e,V,K]);const ae=S.useCallback(async(ce,_e)=>{if(B){console.log(" Already processing, skipping duplicate call");return}console.log(" Recording completed, duration:",_e),Y(!0),o(ce),I(_e),a("processing"),_(null);try{const ne=await R(ce),pe=new Date,Ce=e.start_time?Math.round((pe-e.start_time)/1e3):0,Ae=e.start_time?new Date(e.start_time).toISOString():pe.toISOString(),Ge=V.student_id,Le=`retest_assignment_id_${Ge}_speaking_${e.test_id}`,At=localStorage.getItem(Le),et={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:Ge,question_id:e.question_id||1,audio_blob:ne,audio_duration:ce.duration||0,time_taken:Ce,started_at:Ae,submitted_at:pe.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:At?Number(At):null,parent_test_id:e.test_id};console.log(" Submitting speaking test:",et),console.log(" Processing audio with AI...");try{const lt=await(await M("/.netlify/functions/process-speaking-audio-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e.test_id,question_id:e.question_id||1,audio_blob:ne})})).json();if(lt.success){console.log(" AI Analysis Result:",lt),u(lt.transcript);const rt=lt.transcript?lt.transcript.split(/\s+/).filter(zt=>zt.length>0).length:0;console.log(" Word Count Verification:",{aiCount:lt.word_count,actualCount:rt,transcript:lt.transcript});const ht=rt,Lt={overall_score:lt.overall_score,word_count:ht,grammar_score:lt.grammar_score,vocabulary_score:lt.vocabulary_score,pronunciation_score:lt.pronunciation_score,fluency_score:lt.fluency_score,content_score:lt.content_score,grammar_mistakes:lt.grammar_mistakes,vocabulary_mistakes:lt.vocabulary_mistakes,feedback:lt.feedback,improved_transcript:lt.improved_transcript,grammar_corrections:lt.grammar_corrections||[],vocabulary_corrections:lt.vocabulary_corrections||[],language_use_corrections:lt.language_use_corrections||[],pronunciation_corrections:lt.pronunciation_corrections||[],ai_feedback:lt.ai_feedback||null};console.log(" Mapped Scores:",Lt),console.log(" Individual scores check:",{grammar_score:lt.grammar_score,vocabulary_score:lt.vocabulary_score,pronunciation_score:lt.pronunciation_score,fluency_score:lt.fluency_score,content_score:lt.content_score}),f(Lt),a("feedback")}else throw new Error(lt.message||"Failed to process audio with AI");localStorage.removeItem(`speaking_progress_${e.test_id}`)}catch(pt){console.error("Speaking test submission error:",pt),pt.message.includes("No valid authentication token found")?(_("Your session has expired. Please refresh the page and try again."),setTimeout(()=>{window.location.reload()},3e3)):_(pt.message),a("recording")}}catch(ne){console.error("Speaking test submission error:",ne),_(ne.message),a("recording")}finally{Y(!1)}},[e,V,M,N,z,B]);S.useEffect(()=>{s==="processing"&&!c&&!d&&(console.log(' Detected stuck "processing" state on reload. Attempting recovery...'),i?(console.log(" Resuming processing from cached audio blob..."),ae(i,j)):(console.log(" No cached audio blob found. Resetting to recording step."),a("recording")))},[s,c,d,i,j,ae]);const X=S.useCallback(()=>{if(N<P){o(null),u(""),f(null),_(null),Y(!1);const ce=N+1;E(ce),z(ce),a("recording")}else _("Maximum attempts reached")},[N,P,z]),ie=S.useCallback(async()=>{if(!(!c||!d)){p(!0);try{const ce=new Date,_e=e.start_time?Math.round((ce-e.start_time)/1e3):0,ne=e.start_time?new Date(e.start_time).toISOString():ce.toISOString(),pe=V.student_id,Ce=`retest_assignment_id_${pe}_speaking_${e.test_id}`,Ae=localStorage.getItem(Ce),{academicCalendarService:Ge}=await mi(async()=>{const{academicCalendarService:rt}=await Promise.resolve().then(()=>l2);return{academicCalendarService:rt}},void 0);await Ge.loadAcademicCalendar();const At=Ge.getCurrentTerm()?.id;if(!At)throw new Error("No current academic period found");const et={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:pe,academic_period_id:At,question_id:e.question_id||1,audio_blob:i?await R(i):null,audio_duration:i?.duration||0,time_taken:_e,started_at:ne,submitted_at:ce.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:Ae?Number(Ae):null,parent_test_id:e.test_id,transcript:c,scores:d,final_submission:!0};console.log(" Final submission:",et),console.log(" Making final submission request...");const pt=await M("/.netlify/functions/submit-speaking-test-final",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(et)});console.log(" Final submission response status:",pt.status);const lt=await pt.json();if(console.log(" Final submission result:",lt),lt.success){if(V?.student_id){const Ye=`test_completed_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(Ye,"true"),console.log(" Speaking test marked as completed in localStorage:",Ye);const Tt=`retest_in_progress_${V.student_id}_speaking_${e.test_id}`;localStorage.removeItem(Tt),console.log(" Cleared in-progress retest lock:",Tt);const Nt=`speaking_attempts_${V.student_id}_${e.test_id}`;localStorage.removeItem(Nt),console.log(" Cleared attempts from localStorage upon submission");const{clearTestData:Wt}=await mi(async()=>{const{clearTestData:or}=await Promise.resolve().then(()=>qg);return{clearTestData:or}},void 0);Wt(V.student_id,"speaking_test_data",e.test_id),console.log(" Cleared speaking test data from cache upon submission");try{const or=`anti_cheating_${V.student_id}_speaking_${e.test_id}`;localStorage.removeItem(or),console.log(" Cleared anti-cheating key:",or)}catch{}}console.log(" Caching speaking test results after submission...");const ht=`student_results_table_${V?.student_id||V?.id||"unknown"}`,{setCachedData:Lt,getCachedData:zt,CACHE_TTL:Dt,clearTestData:De}=await mi(async()=>{const{setCachedData:Ye,getCachedData:Tt,CACHE_TTL:Nt,clearTestData:Wt}=await Promise.resolve().then(()=>qg);return{setCachedData:Ye,getCachedData:Tt,CACHE_TTL:Nt,clearTestData:Wt}},void 0),Ie={id:Date.now(),test_id:e.test_id,test_type:"speaking",test_name:e.test_name,score:Math.round(d.overall_score/10),max_score:10,percentage:d.overall_score,caught_cheating:!1,visibility_change_times:0,is_completed:!0,submitted_at:new Date().toISOString(),subject:"Listening and Speaking",teacher_name:e.teacher_name||"Unknown"};let Ke={success:!0,results:[],count:0};try{const Ye=zt(ht);Ye&&Array.isArray(Ye.results)&&(Ke.results=Ye.results.slice())}catch{}if(Ke.results.unshift(Ie),Ke.count=Ke.results.length,Lt(ht,Ke,Dt.student_results_table),console.log(" Speaking test results cached (merged) with key:",ht),V?.student_id&&De(V.student_id,"speaking",e.test_id),!!Ae&&V?.student_id){let Ye=3;try{const Wt=localStorage.getItem(`student_active_tests_${V.student_id}`);if(Wt){const dr=JSON.parse(Wt)?.tests?.find(Er=>Er.test_id===e.test_id&&Er.test_type==="speaking");dr&&(Ye=dr.retest_attempts_left||dr.max_attempts||3)}}catch(Wt){console.error("Error checking active tests cache:",Wt)}const Nt=(d?.overall_score??0)>=50;if(Nt){const Wt=`retest_attempt${Ye}_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(Wt,"true"),console.log(" Passed retest, marking last-slot key:",Wt);let or=0;for(let fr=1;fr<=10;fr++){const nr=`retest_attempt${fr}_${V.student_id}_speaking_${e.test_id}`;localStorage.getItem(nr)==="true"&&or++}const dr=`test_completed_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(dr,"true"),console.log(" Marked retest as completed (student passed):",dr);const Er=`retest_attempts_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(Er,JSON.stringify({used:or,max:Ye})),console.log(" Set retest attempts metadata (student passed):",Er,{used:or,max:Ye})}else{let Wt=1;for(let nr=1;nr<=10;nr++){const me=`retest_attempt${nr}_${V.student_id}_speaking_${e.test_id}`;if(localStorage.getItem(me)!=="true"){Wt=nr;break}}const or=`retest_attempt${Wt}_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(or,"true"),console.log(" Marked retest attempt as completed:",or);let dr=0;for(let nr=1;nr<=10;nr++){const me=`retest_attempt${nr}_${V.student_id}_speaking_${e.test_id}`;localStorage.getItem(me)==="true"&&dr++}const Er=Ye-dr,fr=Er<=0||Nt;if(console.log(" Retest completion check:",{usedAttempts:dr,maxAttempts:Ye,attemptsLeft:Er,passed:Nt,shouldComplete:fr}),fr){const nr=`test_completed_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(nr,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",nr);const me=`retest_attempts_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(me,JSON.stringify({used:dr,max:Ye})),console.log(" Set retest attempts metadata (attempts exhausted):",me,{used:dr,max:Ye})}}}if(V?.student_id){const Ye=`retest1_${V.student_id}_speaking_${e.test_id}`,Tt=`retest_assignment_id_${V.student_id}_speaking_${e.test_id}`;localStorage.removeItem(Ye),localStorage.removeItem(Tt)}try{n&&n(d.overall_score),typeof r=="function"&&r()}catch{}return}else throw new Error(lt.message||"Failed to submit speaking test")}catch(ce){console.error("Speaking test submission error:",ce),_(ce.message)}finally{p(!1)}}},[e,V,M,c,d,i,N,t]);S.useCallback(()=>{a("completed"),t({test_id:e.test_id,transcript:c,scores:d,attempt_number:N})},[e.test_id,c,d,N,t]);const le=()=>{switch(s){case"recording":return l.jsxs("div",{className:"speaking-test-recording",children:[l.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:e.test_name}),l.jsxs("div",{className:"mb-6 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Instructions:"}),l.jsx("p",{className:"text-gray-700 mb-4",children:e.prompt}),l.jsx("div",{className:"bg-blue-50 p-3 sm:p-4 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Requirements:"})," Minimum ",e.min_words||50," words, 0-",e.max_duration||600," seconds duration"]})})]}),l.jsx(pie,{ref:H,onRecordingComplete:ae,minDuration:0,maxDuration:e.max_duration||600,minWords:e.min_words||50,maxAttempts:P,currentAttempt:N}),k&&l.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:k})})]});case"processing":return l.jsxs("div",{className:"transcription-status bg-white rounded-lg shadow-lg p-4 sm:p-8 text-center",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"Processing Your Speech"}),l.jsx("p",{className:"text-lg text-blue-600",children:"Please wait while we process your audio..."})]}),l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]});case"feedback":return console.log(" Rendering feedback step with Submit Final button"),l.jsx(xie,{transcript:c,scores:d,audioBlob:i,recordingTime:j,onReRecord:X,onFinalSubmit:()=>v(!0),canReRecord:N<P,attemptNumber:N,maxAttempts:P,isSubmitting:g});case"completed":const ce={showResults:!0,testInfo:{test_name:e?.test_name||"Speaking Test",id:e?.test_id,test_id:e?.test_id},testType:"speaking",score:d?.overall_score||0,totalQuestions:1,percentage:d?.overall_score||0,passed:(d?.overall_score||0)>=50,questionAnalysis:[{questionNumber:1,userAnswer:c,correctAnswer:"Speaking test completed",isCorrect:!0,score:d?.overall_score||0,maxScore:100,feedback:`Word Count: ${d?.word_count||0}, Grammar: ${d?.grammar_score||0}/40, Vocabulary: ${d?.vocab_score||0}/30`}],timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};return l.jsx("div",{className:"speaking-test-completed",children:l.jsx(Kv,{testResults:ce,onBackToCabinet:()=>C(!0),onRetakeTest:()=>{a("recording"),u(""),f(null),o(null),E(1)},isLoading:!1})});default:return null}};return l.jsxs("div",{children:[l.jsx(fa,{isOpen:x&&!g,onClose:()=>v(!1),title:"Submit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>v(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:()=>{v(!1),ie()},variant:"primary",children:"Submit"})]})]})}),l.jsx(fa,{isOpen:w,onClose:()=>C(!1),title:"Exit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>C(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:()=>{C(!1),typeof r=="function"&&r()},variant:"primary",children:"Go Back"})]})]})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-3 sm:p-6",children:[k&&l.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:k})}),le()]})]})},vie=e=>function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296},wie=(e,t,r)=>{if(e.length===1)return e[0];const n=`${r}:speaking:${t}`,s=Array.from(n).reduce((o,c)=>(o<<5)-o+c.charCodeAt(0),0)>>>0,a=vie(s),i=Math.floor(a()*e.length);return e[i]},_ie=()=>{const{testId:e}=Mb(),t=Po(),{user:r}=ds(),n=tl(),{showNotification:s}=Aa(),[a,i]=S.useState(null),[o,c]=S.useState([]),[u,d]=S.useState(null),[f,g]=S.useState(!0),[p,x]=S.useState(null),[v,w]=S.useState(!1),[C,k]=S.useState(null),[_,N]=S.useState(!1),{startTracking:E,stopTracking:P}=Jm("speaking",e,r?.student_id||r?.id);S.useEffect(()=>{F(),A()},[e]),S.useEffect(()=>{if(a&&!v){ge.debug(" Speaking test - initializing anti-cheating tracking");const Y=r?.student_id||r?.id||"unknown",Z=`anti_cheating_${Y}_speaking_${e}`,se=localStorage.getItem(Z);if(ge.debug(" Checking for anti-cheating data with key:",Z),ge.debug(" Key format: anti_cheating_{studentId}_{testType}_{testId}"),ge.debug(" Current test details:",{testType:"speaking",testId:e,studentId:Y}),se)try{const ee=JSON.parse(se);ge.debug(" Found existing anti-cheating data for THIS speaking test:",ee),ge.debug(" Visibility change times for this test:",ee.tabSwitches||0),ge.debug(" Cheating status for this test:",ee.isCheating||!1),ee.isCheating&&(ge.debug(" WARNING: Student has been flagged for cheating in THIS speaking test!"),ge.debug(" Tab switches detected in this test:",ee.tabSwitches),s(` Warning: Suspicious activity detected in this speaking test (${ee.tabSwitches} tab switches). Continued violations may result in test disqualification.`,"warning"))}catch(ee){ge.error(" Error parsing existing anti-cheating data:",ee)}else ge.debug(" No existing anti-cheating data found for this speaking test - starting fresh");E(),ge.debug(" Anti-cheating tracking started for speaking test")}return()=>{a&&(ge.debug(" Cleaning up anti-cheating tracking for speaking test"),P())}},[a,v,e,r?.student_id,r?.id,E,P,s]);const F=async()=>{try{g(!0);const Y=await n.getSpeakingTest(e);if(Y.success)i(Y.test);else throw new Error(Y.message||"Failed to load test");const Z=await n.getSpeakingTestQuestions(e);if(Z.success){const se=Z.questions;c(se);const ee=r?.student_id||r?.id,te=wie(se,e,ee);d(te),ge.debug(" Selected question for student:",{studentId:ee,testId:e,totalQuestions:se.length,selectedQuestion:te?.id,selectedPrompt:te?.prompt?.substring(0,50)+"..."})}}catch(Y){ge.error("Error loading test data:",Y),x(Y.message)}finally{g(!1)}},A=()=>{const Z=`test_completed_${r?.student_id||r?.id}_speaking_${e}`;if(localStorage.getItem(Z)==="true"){w(!0);const ee=localStorage.getItem(`speaking_test_result_${e}`);ee&&k(JSON.parse(ee))}},j=async Y=>{try{w(!0),k(Y),localStorage.setItem(`speaking_test_result_${e}`,JSON.stringify(Y)),window.dispatchEvent(new CustomEvent("testCompleted",{detail:{testId:e,testType:"speaking"}})),setTimeout(()=>{t("/student")},2e3)}catch(Z){ge.error("Error handling test completion:",Z)}},I=()=>{if(ge.debug(" Navigating back to cabinet from speaking test..."),a&&r?.student_id){ge.debug(" Cabinet navigation detected - counting as cheating attempt");const Z=`anti_cheating_${r?.student_id||r?.id||"unknown"}_speaking_${e}`,se=localStorage.getItem(Z);let ee=0,te=!1;if(se)try{const H=JSON.parse(se);ee=H.tabSwitches||0,te=H.isCheating||!1}catch(H){ge.error(" Error parsing existing anti-cheating data:",H)}const L=ee+1,V=L>=2;ge.debug(` Tab switch count: ${ee}  ${L} (cheating: ${V})`);const M={tabSwitches:L,isCheating:V,lastUpdated:new Date().toISOString()};localStorage.setItem(Z,JSON.stringify(M)),ge.debug(" Anti-cheating data updated for cabinet navigation:",M)}t("/student")};if(f)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(Ze,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Loading speaking test..."})]})})})]});if(p)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(Ze,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-red-600 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-6",children:p})]})})})]});if(v&&C)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test Results"})}),l.jsx(Ze,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx(Kv,{testType:"speaking",testData:a,result:C,onRetake:()=>{w(!1),k(null);const Y=JSON.parse(localStorage.getItem("userData")||"{}").student_id;localStorage.removeItem(`test_completed_${Y}_speaking_${e}`)}})})]});if(!a||o.length===0)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(Ze,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Unable to load test information"})]})})})]});const B=u;return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx(fa,{isOpen:_,onClose:()=>N(!1),title:"Exit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>N(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:()=>{N(!1),I()},variant:"primary",children:"Go Back"})]})]})}),l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(Ze,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.length>1&&u&&l.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-white text-xs font-bold",children:"i"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Question Selection"}),l.jsx("div",{className:"mt-1 text-sm text-blue-700",children:l.jsxs("p",{children:["This test has ",o.length," questions. You have been assigned ",l.jsxs("strong",{children:["Question ",u.question_number]}),"."]})})]})]})}),l.jsx(yie,{testData:{...a,test_id:parseInt(e),question_id:B?.id,prompt:B?.prompt,start_time:Date.now()},onComplete:j,onExit:I,onTestComplete:j})]})]})},bie=()=>{const{testType:e,testId:t}=Mb(),r=Po(),{activeTests:n}=Vv(),s=()=>{r("/student")},a=n.find(i=>i.test_type===e&&i.test_id===parseInt(t));return l.jsx(hie,{onBackToCabinet:s,currentTest:a||{test_type:e,test_id:parseInt(t)}})},Sie=()=>{const e=Po(),{user:t,isAuthenticated:r,isLoading:n}=ds(),[s,a]=S.useState(!1),[i,o]=S.useState(!0),[c,u]=S.useState(""),[d,f]=S.useState([]),[g,p]=S.useState(!1),[x,v]=S.useState(!1),[w,C]=S.useState({currentPassword:"",newPassword:"",confirmPassword:""}),k=S.useCallback(async()=>{ge.debug(" Initializing Student Application...");try{if(o(!0),u(""),!r||!t){ge.debug(" User not authenticated, redirecting to login"),e("/login");return}if(t.role!==no.STUDENT){ge.error(" Invalid user role for student app:",t.role),u("Access denied. Student role required.");return}ge.debug(" Initializing event listeners..."),_(),ge.debug(" Setting up back to cabinet button listeners..."),N(),ge.debug(" Setting up password change form listener..."),E(),ge.debug(" Loading student data..."),await P(),ge.debug(" Exposing student functions globally..."),F(),ge.debug(" Populating student info from user data..."),Z(t),a(!0),ge.debug(" Student Application initialization complete!")}catch(te){ge.error(" Error initializing student app:",te),u("Failed to initialize student application")}finally{o(!1)}},[r,t,e]);S.useEffect(()=>{n||k()},[n,r,t,k]);const _=S.useCallback(()=>{ge.debug(" Setting up student event listeners...");const te=V=>{g&&!V.target.closest(".student-menu")&&p(!1)},L=V=>{V.key==="Escape"&&g&&p(!1)};return document.addEventListener("click",te),document.addEventListener("keydown",L),()=>{document.removeEventListener("click",te),document.removeEventListener("keydown",L)}},[g]),N=S.useCallback(()=>{ge.debug(" Setting up back to cabinet listeners...")},[]),E=S.useCallback(()=>{ge.debug(" Setting up password change form...")},[]),P=S.useCallback(async()=>{ge.debug(" Loading student data...");try{ge.debug(" Student data loaded successfully")}catch(te){throw ge.error(" Error loading student data:",te),te}},[]),F=S.useCallback(()=>{ge.debug(" Exposing student functions globally..."),window.toggleStudentMenu=A,window.showChangePasswordTab=j,window.hideChangePasswordTab=I,window.navigateBackToCabinet=Y,window.handlePasswordChange=B,window.populateStudentInfoDirectly=Z,ge.debug(" All student functions exposed globally")},[]),A=S.useCallback(()=>{ge.debug(" toggleStudentMenu called"),p(te=>{const L=!te;return ge.debug(" Menu state changed from",te,"to",L),L}),ge.debug(" Toggled dropdown menu")},[]),j=S.useCallback(()=>{ge.debug(" showChangePasswordTab called"),v(!0),p(!1)},[]),I=S.useCallback(()=>{ge.debug(" hideChangePasswordTab called"),v(!1),C({currentPassword:"",newPassword:"",confirmPassword:""})},[]),B=S.useCallback(async te=>{te.preventDefault(),ge.debug(" handlePasswordChange called");const{currentPassword:L,newPassword:V,confirmPassword:M}=w;if(!L||!V||!M){se("Please fill in all fields","error");return}if(V!==M){se("New passwords do not match","error");return}if(V.length<6){se("New password must be at least 6 characters long","error");return}const H=/[a-zA-Z]/.test(V),W=/[0-9]/.test(V);if(!H||!W){se("New password must contain both letters and numbers","error");return}if(!t||!t.student_id){se("Session expired. Please login again.","error");return}const R=t.student_id;if(window.confirm("Are you sure you want to change your password?"))try{o(!0);const z=await ms.changePassword({studentId:R,currentPassword:L,newPassword:V});z.success?(se("Password changed successfully!","success"),I()):se(z.message||"Failed to change password","error")}catch(z){ge.error("Password change error:",z),se("Failed to change password. Please try again.","error")}finally{o(!1)}},[w,t]),Y=S.useCallback(()=>{if(ge.debug("[DEBUG] navigateBackToCabinet called"),!r||!t){ge.warn("[WARN] No valid user found, redirecting to login"),e("/login");return}t.role===no.STUDENT?(ge.debug("[DEBUG] Navigating to student cabinet"),e("/student")):(ge.warn("[WARN] Unknown user role, redirecting to login"),e("/login"))},[r,t,e]),Z=S.useCallback(te=>{ge.debug(" populateStudentInfoDirectly called with:",te);try{ge.debug(" Student info populated successfully")}catch(L){ge.error(" Error populating student info:",L)}},[]),se=S.useCallback((te,L)=>{const V={id:Date.now(),message:te,type:L,timestamp:new Date};f(M=>[...M,V]),setTimeout(()=>{f(M=>M.filter(H=>H.id!==V.id))},P0.NOTIFICATION_DURATION)},[]),ee=S.useCallback(te=>{const{name:L,value:V}=te.target;C(M=>({...M,[L]:V}))},[]);return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Wr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):c?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:c}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{className:"bg-gray-50",children:[l.jsxs(yN,{children:[l.jsx(Rs,{path:"/",element:l.jsxs("div",{className:"student-app",children:[l.jsx(cie,{isMenuOpen:g,onToggleMenu:A,onShowPasswordChange:j}),x&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),l.jsxs("form",{onSubmit:B,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:w.currentPassword,onChange:ee,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:w.newPassword,onChange:ee,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:w.confirmPassword,onChange:ee,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:I,className:"flex-1",children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),l.jsx(Rs,{path:"/test/:testType/:testId",element:l.jsx(bie,{})}),l.jsx(Rs,{path:"matching-test/:testId",element:l.jsx(gie,{})}),l.jsx(Rs,{path:"word-matching-test/:testId",element:l.jsx(mie,{})}),l.jsx(Rs,{path:"speaking-test/:testId",element:l.jsx(_ie,{})}),l.jsx(Rs,{path:"/results",element:l.jsx(YB,{})})]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(te=>l.jsx(mc,{type:te.type,message:te.message,onClose:()=>f(L=>L.filter(V=>V.id!==te.id))},te.id))})]}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Wr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},kie=()=>l.jsx(BM,{children:l.jsx(MB,{children:l.jsx(IB,{children:l.jsx(Sie,{})})})}),Cie=({result:e,isOpen:t,onClose:r,initialTab:n="overview",editingSpeakingScore:s,tempSpeakingScore:a,isSavingSpeakingScore:i,onStartSpeakingScoreEdit:o,onSaveSpeakingScore:c,onCancelSpeakingScoreEdit:u,onTempSpeakingScoreChange:d})=>{const[f,g]=S.useState(n),p=S.useRef(!1);if(S.useEffect(()=>()=>{p.current=!0},[]),S.useEffect(()=>{t&&g(n)},[t,n]),!t||!e)return null;const x={test_id:e.test_id,test_name:e.test_name,subject_id:e.subject_id};let v=e?.__audioUrl||void 0;const w=v?void 0:e?.answers;typeof w=="string"?v=w:w&&typeof w=="object"&&(v=w.audio_url),S.useEffect(()=>{console.log("[SpeakingReview] Transcript sources",{fromResult:e?.transcript,fromAnswersObject:typeof w=="object"&&w?.transcript?w.transcript:void 0,hasAnswers:!!w,test_id:e?.test_id,student_id:e?.student_id})},[e?.test_id,e?.student_id]);const[C,k]=S.useState("");S.useEffect(()=>{const N=new AbortController;let E=!1;const P=e?.__studentId||e?.student_id;return!e?.transcript&&!(typeof w=="object"&&w?.transcript)&&e?.test_id&&P&&(async()=>{try{const F=`/.netlify/functions/get-speaking-test-new?action=transcript&test_id=${encodeURIComponent(e.test_id)}&student_id=${encodeURIComponent(P)}`;console.log("[SpeakingReview] Fetching transcript from API:",{url:F});const A=await(window.tokenManager?.getToken()||Fs.get())||localStorage.getItem("accessToken")||localStorage.getItem("token"),j=await fetch(F,{headers:{Authorization:A?`Bearer ${A}`:""},signal:N.signal});console.log("[SpeakingReview] Transcript API response:",{ok:j.ok,status:j.status});const I=await j.json().catch(()=>({}));console.log("[SpeakingReview] Transcript API body:",I),!E&&!p.current&&(j.ok?k(I.transcript||""):console.warn("[SpeakingReview] Transcript API failed:",I?.error||"unknown error"))}catch(F){F.name!=="AbortError"&&!p.current&&console.error("[SpeakingReview] Transcript fetch error:",F)}})(),()=>{E=!0;try{N.abort()}catch{}}},[e]);const _={score:e.score,max_score:e.max_score,percentage:e.percentage,audio_url:v,transcript:e.transcript||C||(typeof w=="object"&&w?.transcript?w.transcript:void 0),time_taken:e.time_taken,started_at:e.started_at,submitted_at:e.submitted_at};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex justify-between items-center",children:[l.jsxs("h2",{className:"text-xl font-semibold",children:["Speaking Test Review - ",x.test_name]}),l.jsx("button",{onClick:r,className:"text-white hover:text-gray-200 text-2xl font-bold",children:""})]}),l.jsx("div",{className:"border-b border-gray-200",children:l.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"audio",label:"Audio"},{id:"transcript",label:"Transcript"},{id:"analysis",label:"AI Analysis"},{id:"scoring",label:"Scoring"}].map(N=>l.jsx("button",{onClick:()=>g(N.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${f===N.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:N.label},N.id))})}),l.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[f==="overview"&&l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Test Name"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:x.test_name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[_.score," / ",_.max_score]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Time Taken"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:_.time_taken?`${Math.floor(_.time_taken/60)}:${(_.time_taken%60).toString().padStart(2,"0")}`:"N/A"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Submitted At"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:_.submitted_at?new Date(_.submitted_at).toLocaleString():"N/A"})]})]})}),f==="audio"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Audio Recording"}),_.audio_url?l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Click the play button to listen to the student's recording:"}),l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsx(XB,{audioUrl:_.audio_url,className:"w-full"})})]}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No audio recording available"})})]}),f==="transcript"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Transcript"}),_.transcript?l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:_.transcript})}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No transcript available"})})]}),f==="analysis"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI Analysis Results"}),(()=>{let N=e.ai_feedback;if(N&&typeof N=="string")try{N=JSON.parse(N)}catch{N=null}return N?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Overall Performance"}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-800",children:N.overall_score||0}),l.jsx("div",{className:"text-sm text-gray-600",children:"Overall Score (0-100)"})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Category Breakdown"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[N.grammar_score||0,"/25"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Grammar"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-green-600",children:[N.vocabulary_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Vocabulary"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[N.pronunciation_score||0,"/15"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Pronunciation"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[N.fluency_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Fluency"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-red-600",children:[N.content_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Content"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Performance Metrics"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Word Count:"}),l.jsx("span",{className:"text-sm font-medium",children:N.word_count||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Grammar Mistakes:"}),l.jsx("span",{className:"text-sm font-medium text-red-600",children:N.grammar_mistakes||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Vocabulary Issues:"}),l.jsx("span",{className:"text-sm font-medium text-red-600",children:N.vocabulary_mistakes||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Difficulty Level:"}),l.jsx("span",{className:"text-sm font-medium",children:N.difficulty_level||"N/A"})]})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"AI Feedback"}),N.feedback?l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-gray-700",children:N.feedback})}):l.jsx("div",{className:"text-center py-4 text-gray-500",children:l.jsx("p",{className:"text-sm",children:"No AI feedback available"})})]})]}),N.improved_transcript&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Improved Transcript"}),l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-gray-700",children:N.improved_transcript})})]}),N.grammar_corrections&&N.grammar_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Grammar Corrections"}),l.jsx("div",{className:"space-y-3",children:N.grammar_corrections.map((E,P)=>l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-red-800",children:"Mistake:"})," ",E.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-green-800",children:"Correction:"})," ",E.correction]}),E.explanation&&l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l.jsx("span",{className:"font-medium",children:"Explanation:"})," ",E.explanation]})]},P))})]}),N.vocabulary_corrections&&N.vocabulary_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Vocabulary Improvements"}),l.jsx("div",{className:"space-y-3",children:N.vocabulary_corrections.map((E,P)=>l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-yellow-800",children:"Original:"})," ",E.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-green-800",children:"Better:"})," ",E.correction]}),E.explanation&&l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l.jsx("span",{className:"font-medium",children:"Explanation:"})," ",E.explanation]})]},P))})]}),N.language_use_corrections&&N.language_use_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Language Use Suggestions"}),l.jsx("div",{className:"space-y-3",children:N.language_use_corrections.map((E,P)=>l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-blue-800",children:"Original:"})," ",E.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-blue-800",children:"Suggestion:"})," ",E.suggestion]}),E.explanation&&l.jsx("div",{className:"text-xs text-blue-700 mt-1",children:E.explanation})]},P))})]})]}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No AI analysis available for this result"})})})()]}),f==="scoring"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 text-center",children:"Score Details"}),s?l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 place-items-center",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Score"}),l.jsx("input",{type:"number",min:"0",max:_.max_score,value:a,onChange:N=>d(N.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Max Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[_.max_score," (Fixed)"]})]})]}),l.jsxs("div",{className:"flex justify-center space-x-3",children:[l.jsx("button",{onClick:c,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Saving...":"Save Score"}),l.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"})]})]}):l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("div",{className:"grid grid-cols-1 place-items-center gap-2",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Current Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[_.score," / ",_.max_score]})]})}),l.jsx("button",{onClick:()=>o(e.id,_.score),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 mx-auto",children:"Edit Score"})]})]})]}),l.jsx("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3",children:l.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})})]})})},Tie=({isOpen:e,onClose:t,testResult:r,questions:n,isLoadingQuestions:s})=>{const a=w=>{if(!w)return{};if(typeof w=="string")try{return JSON.parse(w)}catch{return{}}return w||{}},i=S.useMemo(()=>{const w=r?.answers;if(console.log(" [TestAnswerModal] Raw testResult.answers:",w),console.log(" [TestAnswerModal] Raw testResult.answers type:",typeof w),w&&typeof w=="object"&&w.answers_by_id)return console.log(" [TestAnswerModal] Found answers_by_id format"),console.log(" [TestAnswerModal] answers_by_id:",w.answers_by_id),console.log(" [TestAnswerModal] question_order:",w.question_order),w.answers_by_id||{};const C=a(w);return console.log(" [TestAnswerModal] Parsed student answers:",C),console.log(" [TestAnswerModal] Full testResult:",r),C},[r?.answers]),o=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,_=String(k),N=Number(k),E=i[_]!==void 0?i[_]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=w.correct_answer,F=E===P,A=j=>{const I=`option_${j.toLowerCase()}`;return w[I]||j};return l.jsxs("tr",{className:F?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:C+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:w.question}),l.jsx("td",{className:"px-4 py-3 text-sm",children:E?l.jsxs("span",{className:`font-medium ${F?"text-green-700":"text-red-700"}`,children:[E," - ",A(E)]}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700",children:[P," - ",A(P)]}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:F?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},_)})})]})}),c=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,_=String(k),N=Number(k),E=i[_]!==void 0?i[_]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=w.correct_answer;let F;typeof E=="boolean"?F=E:typeof E=="string"?F=E.toLowerCase().trim()==="true":E===1||E==="1"?F=!0:E===0||E==="0"?F=!1:F=!!E;let A;typeof P=="boolean"?A=P:typeof P=="string"?A=P.toLowerCase().trim()==="true":A=!!P;const j=F===A;C===0&&console.log(" [TestAnswerModal] True/False First Question Debug:",{questionIdStr:_,studentAnswer:E,studentAnswerType:typeof E,normalizedStudentAnswer:F,correctAnswer:P,correctAnswerType:typeof P,normalizedCorrectAnswer:A,isCorrect:j});const I=E!=null?F:null,B=A;return l.jsxs("tr",{className:j?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:C+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:w.question}),l.jsx("td",{className:"px-4 py-3 text-sm",children:I!==null?l.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${I?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:I?"True":"False"}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm",children:l.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${B?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:B?"True":"False"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:j?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},_)})})]})}),u=()=>{if(!n||n.length===0)return l.jsx("p",{className:"text-gray-500",children:"No questions available"});const w=(C,k)=>{if(!C||!k||k.length===0)return!1;const _=String(C).toLowerCase().trim();return k.some(N=>{const E=String(N).toLowerCase().trim();return _===E||E.length>=2&&_.includes(E)?!0:E.length===1?_.startsWith(E)||_.endsWith(E):!1})};return l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer(s)"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((C,k)=>{const _=C.question_id||C.id||k+1,N=String(_),E=Number(_),P=i[N]!==void 0?i[N]:i[E]!==void 0?i[E]:i[_]!==void 0?i[_]:void 0,F=Array.isArray(C.correct_answers)?C.correct_answers:C.correct_answer?[C.correct_answer]:[],A=w(P,F);return k===0&&console.log(" [TestAnswerModal] First question debug:",{questionIdNum:_,questionIdStr:N,questionIdNumKey:E,studentAnswer:P,studentAnswers:i,studentAnswersKeys:Object.keys(i),correctAnswers:F,question:C}),l.jsxs("tr",{className:A?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:k+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:C.question}),l.jsx("td",{className:"px-4 py-3 text-sm",children:P?l.jsx("span",{className:`font-medium ${A?"text-green-700":"text-red-700"}`,children:P}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:F.length>0?l.jsx("div",{className:"space-y-1",children:F.map((j,I)=>l.jsx("div",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:j},I))}):l.jsx("span",{className:"text-gray-400",children:"No correct answer defined"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:A?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},N)})})]})})},d=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Left Word"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Match"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Match"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,_=String(k),N=Number(k),E=i[_]!==void 0?i[_]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=w.left_word,F=w.right_word;let A=null,j=!1;if(E){if(typeof E=="object")A=E.definition||E.right||E.word,j=E.word===P&&(E.definition||E.right)===F;else if(typeof E=="string")try{const I=JSON.parse(E);A=I.definition||I.right||I.word,j=I.word===P&&(I.definition||I.right)===F}catch{A=E}}return l.jsxs("tr",{className:j?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:C+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:P}),l.jsx("td",{className:"px-4 py-3 text-sm",children:A?l.jsx("span",{className:j?"text-green-700 font-medium":"text-red-700 font-medium",children:A}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:F}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:j?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},_)})})]})}),f=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"space-y-6",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,_=String(k),N=Number(k);C===0&&console.log(" [TestAnswerModal] Fill Blanks First Question Debug:",{questionIdNum:k,questionIdStr:_,questionIdNumKey:N,question:w,studentAnswers:i,studentAnswersKeys:Object.keys(i),correctAnswers:w.correct_answers});const E=i[_]!==void 0?i[_]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=Array.isArray(w.correct_answers)?w.correct_answers:[];let F=[];return Array.isArray(E)?F=E:E!=null?F=[E]:F=[],l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold text-gray-900 mb-3",children:["Question ",C+1]}),l.jsxs("div",{className:"space-y-3",children:[w.question_json&&l.jsx("div",{className:"text-sm text-gray-700 mb-4",children:typeof w.question_json=="string"?w.question_json:w.question_json.text||w.question_json.question||"Question text not available"}),l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Blank #"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map((A,j)=>{let I=F[j];const B=j+1,Y=String(B),Z=Number(B);(I==null||I==="")&&(I=i[Y]!==void 0?i[Y]:i[Z]!==void 0?i[Z]:I),C===0&&j===0&&console.log(" [TestAnswerModal] Fill Blanks First Blank Debug:",{blankIndex:j,potentialBlankId:B,potentialBlankIdStr:Y,potentialBlankIdNum:Z,studentAns:I,studentAnswersForQ:F,correctAns:A,studentAnswersKeys:Object.keys(i)});const se=String(I||"").trim().toLowerCase()===String(A||"").trim().toLowerCase();return l.jsxs("tr",{className:se?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:j+1}),l.jsx("td",{className:"px-4 py-2 text-sm",children:I?l.jsx("span",{className:se?"text-green-700 font-medium":"text-red-700 font-medium",children:String(I)}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:String(A)}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:se?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:""}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:""})})]},j)})})]})]})]},_)})}),g=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Matching type tests require visual comparison. Answers stored as connection pairs."}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Word"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student Connection"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,_=String(k),N=Number(k),E=i[_]!==void 0?i[_]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0;return l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:w.word}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:E?typeof E=="object"?JSON.stringify(E):E:l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})})]},_)})})]})})]}),p=()=>{if(!r)return null;const w=r.test_type||r.testType;if(s)return l.jsxs("div",{className:"flex items-center justify-center py-12",children:[l.jsx(Wr,{size:"lg"}),l.jsx("span",{className:"ml-4 text-gray-600",children:"Loading questions..."})]});if(!n||n.length===0)return l.jsxs("div",{className:"text-center py-8",children:[l.jsx("p",{className:"text-gray-500",children:"Unable to load questions for this test."}),l.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Test ID: ",r.test_id,", Type: ",w]})]});switch(w){case"multiple_choice":return o();case"true_false":return c();case"input":return u();case"word_matching":return d();case"fill_blanks":return f();case"matching_type":return g();default:return l.jsxs("div",{className:"text-center py-8",children:[l.jsxs("p",{className:"text-gray-500",children:['Test type "',w,'" is not supported for answer viewing.']}),l.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Drawing and Speaking tests have their own dedicated modals."})]})}};if(!r)return null;r.test_type||r.testType;const x=`${r.name||""} ${r.surname||""}`.trim(),v=`${r.test_name||"Test"} - ${x||r.student_id}`;return l.jsxs(fa,{isOpen:e,onClose:t,title:v,size:"large",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[l.jsxs("div",{className:"flex space-x-6",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Score"}),l.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[r.best_retest_score!==null&&r.best_retest_score!==void 0?`${r.best_retest_score} / ${r.best_retest_max_score||r.max_score||0}`:`${r.score||0} / ${r.max_score||0}`,r.best_retest_score!==null&&r.best_retest_score!==void 0&&l.jsx("span",{className:"ml-2 text-xs text-blue-600",children:"(Retest Best)"})]})]}),r.best_retest_percentage!==null&&r.best_retest_percentage!==void 0&&r.best_retest_percentage>0||r.percentage&&r.percentage>0?l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Percentage"}),l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:r.best_retest_percentage!==null&&r.best_retest_percentage!==void 0?`${r.best_retest_percentage.toFixed(1)}%`:`${r.percentage?.toFixed(1)||"0.0"}%`})]}):null,r.subject&&r.subject!=="N/A"?l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Subject"}),l.jsx("div",{className:"text-sm font-medium text-gray-700",children:r.subject})]}):null]}),r.submitted_at&&l.jsxs("div",{className:"text-right",children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Submitted"}),l.jsx("div",{className:"text-sm text-gray-700",children:new Date(r.submitted_at).toLocaleString()})]})]}),l.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:p()}),r.caught_cheating&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsxs("p",{className:"text-sm text-red-800",children:[" This test was flagged for suspicious activity (visibility changes: ",r.visibility_change_times||0,")"]})})]})};class Sk extends Is.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){if(console.error("ErrorBoundary caught an error:",t,r),t.message&&t.message.includes("Minified React error #300")){console.warn("React error #300 caught and handled by ErrorBoundary");return}}render(){return this.state.hasError?l.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[l.jsx("h3",{className:"text-red-800 font-medium",children:"Something went wrong"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:"An error occurred while rendering this component."})]}):this.props.children}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var z_={};z_.version="0.18.5";var QB=1252,Eie=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],t3={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},r3=function(e){Eie.indexOf(e)!=-1&&(QB=t3[0]=e)};function Nie(){r3(1252)}var uc=function(e){r3(e)};function n3(){uc(1200),Nie()}function IF(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Aie(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function JB(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var fy=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Aie(e.slice(2)):t==254&&r==255?JB(e.slice(2)):t==65279?e.slice(1):e},Nw=function(t){return String.fromCharCode(t)},RF=function(t){return String.fromCharCode(t)},rv,yf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function nv(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=yf.charAt(a)+yf.charAt(i)+yf.charAt(o)+yf.charAt(c);return t}function Zo(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=yf.indexOf(e.charAt(u++)),i=yf.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=yf.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=yf.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var en=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),gd=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function jf(e){return en?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function MF(e){return en?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var qo=function(t){return en?gd(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function c2(e){if(typeof ArrayBuffer>"u")return qo(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function zf(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function jie(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function s3(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return s3(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ha=en?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:gd(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Pie(e){for(var t=[],r=0,n=e.length+250,s=jf(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=jf(65535),n=65530)}return t.push(s.slice(0,r)),Ha(t)}var oo=/\u0000/g,hy=/[\u0001-\u0006]/g;function fm(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function dc(e,t){var r=""+e;return r.length>=t?r:Ms("0",t-r.length)+r}function a3(e,t){var r=""+e;return r.length>=t?r:Ms(" ",t-r.length)+r}function W_(e,t){var r=""+e;return r.length>=t?r:r+Ms(" ",t-r.length)}function Fie(e,t){var r=""+Math.round(e);return r.length>=t?r:Ms("0",t-r.length)+r}function Oie(e,t){var r=""+e;return r.length>=t?r:Ms("0",t-r.length)+r}var LF=Math.pow(2,32);function Mg(e,t){if(e>LF||e<-LF)return Fie(e,t);var r=Math.round(e);return Oie(r,t)}function H_(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var BF=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],kk=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Die(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Dr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},$F={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Iie={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function G_(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),o=f*i+a,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),a=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=a):(d=u,o=i)),!r)return[0,n*o,d];var g=Math.floor(n*o/d);return[g,n*o-g*d,d]}function Mh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=Uie(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var ZB=new Date(1899,11,31,0,0,0),Rie=ZB.getTime(),Mie=new Date(1900,2,1,0,0,0);function e$(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Mie&&(r+=1440*60*1e3),(r-(Rie+(e.getTimezoneOffset()-ZB.getTimezoneOffset())*6e4))/(1440*60*1e3)}function i3(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Lie(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Bie(e){var t=e<0?12:11,r=i3(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function $ie(e){var t=i3(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function sv(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Bie(e):t===10?r=e.toFixed(10).substr(0,12):r=$ie(e),i3(Lie(r.toUpperCase()))}function p0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):sv(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ol(14,e$(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Uie(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function zie(e,t,r,n){var s="",a=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return kk[r.m-1][1];case 5:return kk[r.m-1][0];default:return kk[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return BF[r.q][0];default:return BF[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?dc(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=dc(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?dc(c,u):"";return d}function vf(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var t$=/%/g;function Wie(e,t,r){var n=t.replace(t$,""),s=t.length-n.length;return Ju(e,n,r*Math.pow(10,2*s))+Ms("%",s)}function Hie(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ju(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function r$(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+r$(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var n$=/# (\?+)( ?)\/( ?)(\d+)/;function Gie(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Ms(" ",e[1].length+1+e[4].length):a3(i,e[1].length)+e[2]+"/"+e[3]+dc(o,e[4].length))}function Vie(e,t,r){return r+(t===0?"":""+t)+Ms(" ",e[1].length+2+e[4].length)}var s$=/^#*0*\.([0#]+)/,a$=/\).*[0#]/,i$=/\(###\) ###\\?-####/;function to(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function UF(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function zF(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Kie(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function qie(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function xl(e,t,r){if(e.charCodeAt(0)===40&&!t.match(a$)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xl("n",n,r):"("+xl("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Hie(e,t,r);if(t.indexOf("%")!==-1)return Wie(e,t,r);if(t.indexOf("E")!==-1)return r$(t,r);if(t.charCodeAt(0)===36)return"$"+xl(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Mg(c,t.length);if(t.match(/^[#?]+$/))return s=Mg(r,0),s==="0"&&(s=""),s.length>t.length?s:to(t.substr(0,t.length-s.length))+s;if(a=t.match(n$))return Gie(a,c,u);if(t.match(/^#+0+$/))return u+Mg(c,t.length-t.indexOf("0"));if(a=t.match(s$))return s=UF(r,a[1].length).replace(/^([^\.]+)$/,"$1."+to(a[1])).replace(/\.$/,"."+to(a[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+Ms("0",to(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+UF(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+vf(Mg(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xl(e,t,-r):vf(""+(Math.floor(r)+Kie(r,a[1].length)))+"."+dc(zF(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return xl(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=fm(xl(e,t.replace(/[\\-]/g,""),r)),i=0,fm(fm(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(i$))return s=xl(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=G_(c,Math.pow(10,i)-1,!1),s=""+u,d=Ju("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=W_(o[2],i),d.length<a[4].length&&(d=to(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=G_(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?a3(o[1],i)+a[2]+"/"+a[3]+W_(o[2],i):Ms(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=Mg(r,0),t.length<=s.length?s:to(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,g=t.length-s.length-f;return to(t.substr(0,f)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=zF(r,a[1].length),r<0?"-"+xl(e,t,-r):vf(qie(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?dc(0,3-x.length):"")+x})+"."+dc(i,a[1].length);switch(t){case"###,##0.00":return xl(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=vf(Mg(c,0));return p!=="0"?u+p:"";case"###,###.00":return xl(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return xl(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Yie(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ju(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Xie(e,t,r){var n=t.replace(t$,""),s=t.length-n.length;return Ju(e,n,r*Math.pow(10,2*s))+Ms("%",s)}function o$(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+o$(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Wc(e,t,r){if(e.charCodeAt(0)===40&&!t.match(a$)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wc("n",n,r):"("+Wc("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Yie(e,t,r);if(t.indexOf("%")!==-1)return Xie(e,t,r);if(t.indexOf("E")!==-1)return o$(t,r);if(t.charCodeAt(0)===36)return"$"+Wc(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+dc(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:to(t.substr(0,t.length-s.length))+s;if(a=t.match(n$))return Vie(a,c,u);if(t.match(/^#+0+$/))return u+dc(c,t.length-t.indexOf("0"));if(a=t.match(s$))return s=(""+r).replace(/^([^\.]+)$/,"$1."+to(a[1])).replace(/\.$/,"."+to(a[1])),s=s.replace(/\.(\d*)$/,function(x,v){return"."+v+Ms("0",to(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+vf(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wc(e,t,-r):vf(""+r)+"."+Ms("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Wc(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=fm(Wc(e,t.replace(/[\\-]/g,""),r)),i=0,fm(fm(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(i$))return s=Wc(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=G_(c,Math.pow(10,i)-1,!1),s=""+u,d=Ju("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=W_(o[2],i),d.length<a[4].length&&(d=to(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=G_(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?a3(o[1],i)+a[2]+"/"+a[3]+W_(o[2],i):Ms(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:to(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,g=t.length-s.length-f;return to(t.substr(0,f)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Wc(e,t,-r):vf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?dc(0,3-x.length):"")+x})+"."+dc(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=vf(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Wc(e,t.slice(0,t.lastIndexOf(".")),r)+to(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ju(e,t,r){return(r|0)===r?Wc(e,t,r):xl(e,t,r)}function Qie(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var l$=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ep(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":H_(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(l$))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Jie(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",u,d,f,g="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!H_(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Mh(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Mh(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var v={t:o,v:o};if(u==null&&(u=Mh(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",g="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",i+=5,g="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(v.v=u.H>=12?"":""),v.t="T",i+=5,g="h"):(v.t="t",++i),u==null&&v.t==="T")return"";s[s.length]=v,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(l$)){if(u==null&&(u=Mh(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",ep(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var w=0,C=0,k;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=g,c="h",w<1&&(w=1);break;case"s":(k=s[i].v.match(/\.0+$/))&&(C=Math.max(C,k[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=zie(s[i].t.charCodeAt(0),s[i].v,u,C),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;_+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=p0(t,r);break}var E="",P,F;if(_.length>0){_.charCodeAt(0)==40?(P=t<0&&_.charCodeAt(0)===45?-t:t,F=Ju("n",_,P)):(P=t<0&&n>1?-t:t,F=Ju("n",_,P),P<0&&s[0]&&s[0].t=="t"&&(F=F.substr(1),s[0].v="-"+s[0].v)),N=F.length-1;var A=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){A=i;break}var j=s.length;if(A===s.length&&F.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=F.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=F.substr(0,N+1),N=-1),s[i].t="t",j=i);N>=0&&j<s.length&&(s[j].v=F.substr(0,N+1)+s[j].v)}else if(A!==s.length&&F.indexOf("E")===-1){for(N=F.indexOf(".")-1,i=A;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===A?s[i].v.indexOf(".")-1:s[i].v.length-1,E=s[i].v.substr(d+1);d>=0;--d)N>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(E=F.charAt(N--)+E);s[i].v=E,s[i].t="t",j=i}for(N>=0&&j<s.length&&(s[j].v=F.substr(0,N+1)+s[j].v),N=F.indexOf(".")+1,i=A;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==A)){for(d=s[i].v.indexOf(".")>-1&&i===A?s[i].v.indexOf(".")+1:0,E=s[i].v.substr(0,d);d<s[i].v.length;++d)N<F.length&&(E+=F.charAt(N++));s[i].v=E,s[i].t="t",j=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(P=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Ju(s[i].t,s[i].v,P),s[i].t="t");var I="";for(i=0;i!==s.length;++i)s[i]!=null&&(I+=s[i].v);return I}var WF=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function HF(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Zie(e,t){var r=Qie(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(WF),o=r[1].match(WF);return HF(t,i)?[n,r[0]]:HF(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Ol(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Dr)[e],n==null&&(n=r.table&&r.table[$F[e]]||Dr[$F[e]]),n==null&&(n=Iie[e]||"General");break}if(H_(n,0))return p0(t,r);t instanceof Date&&(t=e$(t,r.date1904));var s=Zie(n,t);if(H_(s[1]))return p0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Jie(s[1],t,r,s[0])}function Zu(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Dr[r]==null){t<0&&(t=r);continue}if(Dr[r]==e){t=r;break}}t<0&&(t=391)}return Dr[t]=e,t}function u2(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Zu(e[t],t)}function tp(){Dr=Die()}var eoe={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},c$=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function toe(e){var t=typeof e=="number"?Dr[e]:e;return t=t.replace(c$,"(\\d+)"),new RegExp("^"+t+"$")}function roe(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(c$)||[]).forEach(function(f,g){var p=parseInt(r[g+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":c=p;break;case"m":i>=0?o=p:s=p;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var noe=(function(){var e={};e.version="1.2.0";function t(){for(var F=0,A=new Array(256),j=0;j!=256;++j)F=j,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,A[j]=F;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(F){var A=0,j=0,I=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)B[I]=F[I];for(I=0;I!=256;++I)for(j=F[I],A=256+I;A<4096;A+=256)j=B[A]=j>>>8^F[j&255];var Y=[];for(I=1;I!=16;++I)Y[I-1]=typeof Int32Array<"u"?B.subarray(I*256,I*256+256):B.slice(I*256,I*256+256);return Y}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],u=s[4],d=s[5],f=s[6],g=s[7],p=s[8],x=s[9],v=s[10],w=s[11],C=s[12],k=s[13],_=s[14];function N(F,A){for(var j=A^-1,I=0,B=F.length;I<B;)j=j>>>8^r[(j^F.charCodeAt(I++))&255];return~j}function E(F,A){for(var j=A^-1,I=F.length-15,B=0;B<I;)j=_[F[B++]^j&255]^k[F[B++]^j>>8&255]^C[F[B++]^j>>16&255]^w[F[B++]^j>>>24]^v[F[B++]]^x[F[B++]]^p[F[B++]]^g[F[B++]]^f[F[B++]]^d[F[B++]]^u[F[B++]]^c[F[B++]]^o[F[B++]]^i[F[B++]]^a[F[B++]]^r[F[B++]];for(I+=15;B<I;)j=j>>>8^r[(j^F[B++])&255];return~j}function P(F,A){for(var j=A^-1,I=0,B=F.length,Y=0,Z=0;I<B;)Y=F.charCodeAt(I++),Y<128?j=j>>>8^r[(j^Y)&255]:Y<2048?(j=j>>>8^r[(j^(192|Y>>6&31))&255],j=j>>>8^r[(j^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,Z=F.charCodeAt(I++)&1023,j=j>>>8^r[(j^(240|Y>>8&7))&255],j=j>>>8^r[(j^(128|Y>>2&63))&255],j=j>>>8^r[(j^(128|Z>>6&15|(Y&3)<<4))&255],j=j>>>8^r[(j^(128|Z&63))&255]):(j=j>>>8^r[(j^(224|Y>>12&15))&255],j=j>>>8^r[(j^(128|Y>>6&63))&255],j=j>>>8^r[(j^(128|Y&63))&255]);return~j}return e.table=r,e.bstr=N,e.buf=E,e.str=P,e})(),Tr=(function(){var t={};t.version="1.2.1";function r(ue,be){for(var xe=ue.split("/"),he=be.split("/"),we=0,Se=0,He=Math.min(xe.length,he.length);we<He;++we){if(Se=xe[we].length-he[we].length)return Se;if(xe[we]!=he[we])return xe[we]<he[we]?-1:1}return xe.length-he.length}function n(ue){if(ue.charAt(ue.length-1)=="/")return ue.slice(0,-1).indexOf("/")===-1?ue:n(ue.slice(0,-1));var be=ue.lastIndexOf("/");return be===-1?ue:ue.slice(0,be+1)}function s(ue){if(ue.charAt(ue.length-1)=="/")return s(ue.slice(0,-1));var be=ue.lastIndexOf("/");return be===-1?ue:ue.slice(be+1)}function a(ue,be){typeof be=="string"&&(be=new Date(be));var xe=be.getHours();xe=xe<<6|be.getMinutes(),xe=xe<<5|be.getSeconds()>>>1,ue.write_shift(2,xe);var he=be.getFullYear()-1980;he=he<<4|be.getMonth()+1,he=he<<5|be.getDate(),ue.write_shift(2,he)}function i(ue){var be=ue.read_shift(2)&65535,xe=ue.read_shift(2)&65535,he=new Date,we=xe&31;xe>>>=5;var Se=xe&15;xe>>>=4,he.setMilliseconds(0),he.setFullYear(xe+1980),he.setMonth(Se-1),he.setDate(we);var He=be&31;be>>>=5;var ct=be&63;return be>>>=6,he.setHours(be),he.setMinutes(ct),he.setSeconds(He<<1),he}function o(ue){fi(ue,0);for(var be={},xe=0;ue.l<=ue.length-4;){var he=ue.read_shift(2),we=ue.read_shift(2),Se=ue.l+we,He={};switch(he){case 21589:xe=ue.read_shift(1),xe&1&&(He.mtime=ue.read_shift(4)),we>5&&(xe&2&&(He.atime=ue.read_shift(4)),xe&4&&(He.ctime=ue.read_shift(4))),He.mtime&&(He.mt=new Date(He.mtime*1e3));break}ue.l=Se,be[he]=He}return be}var c;function u(){return c||(c={})}function d(ue,be){if(ue[0]==80&&ue[1]==75)return me(ue,be);if((ue[0]|32)==109&&(ue[1]|32)==105)return Be(ue,be);if(ue.length<512)throw new Error("CFB file size "+ue.length+" < 512");var xe=3,he=512,we=0,Se=0,He=0,ct=0,qe=0,oe=[],fe=ue.slice(0,512);fi(fe,0);var Te=f(fe);switch(xe=Te[0],xe){case 3:he=512;break;case 4:he=4096;break;case 0:if(Te[1]==0)return me(ue,be);default:throw new Error("Major Version: Expected 3 or 4 saw "+xe)}he!==512&&(fe=ue.slice(0,he),fi(fe,28));var Ee=ue.slice(0,he);g(fe,xe);var Xe=fe.read_shift(4,"i");if(xe===3&&Xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Xe);fe.l+=4,He=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),ct=fe.read_shift(4,"i"),we=fe.read_shift(4,"i"),qe=fe.read_shift(4,"i"),Se=fe.read_shift(4,"i");for(var ot=-1,xt=0;xt<109&&(ot=fe.read_shift(4,"i"),!(ot<0));++xt)oe[xt]=ot;var qt=p(ue,he);w(qe,Se,qt,he,oe);var yt=k(qt,He,oe,he);yt[He].name="!Directory",we>0&&ct!==Z&&(yt[ct].name="!MiniFAT"),yt[oe[0]].name="!FAT",yt.fat_addrs=oe,yt.ssz=he;var Yt={},_r=[],kr=[],xr=[];_(He,yt,qt,_r,we,Yt,kr,ct),x(kr,xr,_r),_r.shift();var Gr={FileIndex:kr,FullPaths:xr};return be&&be.raw&&(Gr.raw={header:Ee,sectors:qt}),Gr}function f(ue){if(ue[ue.l]==80&&ue[ue.l+1]==75)return[0,0];ue.chk(se,"Header Signature: "),ue.l+=16;var be=ue.read_shift(2,"u");return[ue.read_shift(2,"u"),be]}function g(ue,be){var xe=9;switch(ue.l+=2,xe=ue.read_shift(2)){case 9:if(be!=3)throw new Error("Sector Shift: Expected 9 saw "+xe);break;case 12:if(be!=4)throw new Error("Sector Shift: Expected 12 saw "+xe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+xe)}ue.chk("0600","Mini Sector Shift: "),ue.chk("000000000000","Reserved: ")}function p(ue,be){for(var xe=Math.ceil(ue.length/be)-1,he=[],we=1;we<xe;++we)he[we-1]=ue.slice(we*be,(we+1)*be);return he[xe-1]=ue.slice(xe*be),he}function x(ue,be,xe){for(var he=0,we=0,Se=0,He=0,ct=0,qe=xe.length,oe=[],fe=[];he<qe;++he)oe[he]=fe[he]=he,be[he]=xe[he];for(;ct<fe.length;++ct)he=fe[ct],we=ue[he].L,Se=ue[he].R,He=ue[he].C,oe[he]===he&&(we!==-1&&oe[we]!==we&&(oe[he]=oe[we]),Se!==-1&&oe[Se]!==Se&&(oe[he]=oe[Se])),He!==-1&&(oe[He]=he),we!==-1&&he!=oe[he]&&(oe[we]=oe[he],fe.lastIndexOf(we)<ct&&fe.push(we)),Se!==-1&&he!=oe[he]&&(oe[Se]=oe[he],fe.lastIndexOf(Se)<ct&&fe.push(Se));for(he=1;he<qe;++he)oe[he]===he&&(Se!==-1&&oe[Se]!==Se?oe[he]=oe[Se]:we!==-1&&oe[we]!==we&&(oe[he]=oe[we]));for(he=1;he<qe;++he)if(ue[he].type!==0){if(ct=he,ct!=oe[ct])do ct=oe[ct],be[he]=be[ct]+"/"+be[he];while(ct!==0&&oe[ct]!==-1&&ct!=oe[ct]);oe[he]=-1}for(be[0]+="/",he=1;he<qe;++he)ue[he].type!==2&&(be[he]+="/")}function v(ue,be,xe){for(var he=ue.start,we=ue.size,Se=[],He=he;xe&&we>0&&He>=0;)Se.push(be.slice(He*Y,He*Y+Y)),we-=Y,He=Oh(xe,He*4);return Se.length===0?St(0):Ha(Se).slice(0,ue.size)}function w(ue,be,xe,he,we){var Se=Z;if(ue===Z){if(be!==0)throw new Error("DIFAT chain shorter than expected")}else if(ue!==-1){var He=xe[ue],ct=(he>>>2)-1;if(!He)return;for(var qe=0;qe<ct&&(Se=Oh(He,qe*4))!==Z;++qe)we.push(Se);w(Oh(He,he-4),be-1,xe,he,we)}}function C(ue,be,xe,he,we){var Se=[],He=[];we||(we=[]);var ct=he-1,qe=0,oe=0;for(qe=be;qe>=0;){we[qe]=!0,Se[Se.length]=qe,He.push(ue[qe]);var fe=xe[Math.floor(qe*4/he)];if(oe=qe*4&ct,he<4+oe)throw new Error("FAT boundary crossed: "+qe+" 4 "+he);if(!ue[fe])break;qe=Oh(ue[fe],oe)}return{nodes:Se,data:rO([He])}}function k(ue,be,xe,he){var we=ue.length,Se=[],He=[],ct=[],qe=[],oe=he-1,fe=0,Te=0,Ee=0,Xe=0;for(fe=0;fe<we;++fe)if(ct=[],Ee=fe+be,Ee>=we&&(Ee-=we),!He[Ee]){qe=[];var ot=[];for(Te=Ee;Te>=0;){ot[Te]=!0,He[Te]=!0,ct[ct.length]=Te,qe.push(ue[Te]);var xt=xe[Math.floor(Te*4/he)];if(Xe=Te*4&oe,he<4+Xe)throw new Error("FAT boundary crossed: "+Te+" 4 "+he);if(!ue[xt]||(Te=Oh(ue[xt],Xe),ot[Te]))break}Se[Ee]={nodes:ct,data:rO([qe])}}return Se}function _(ue,be,xe,he,we,Se,He,ct){for(var qe=0,oe=he.length?2:0,fe=be[ue].data,Te=0,Ee=0,Xe;Te<fe.length;Te+=128){var ot=fe.slice(Te,Te+128);fi(ot,64),Ee=ot.read_shift(2),Xe=h3(ot,0,Ee-oe),he.push(Xe);var xt={name:Xe,type:ot.read_shift(1),color:ot.read_shift(1),L:ot.read_shift(4,"i"),R:ot.read_shift(4,"i"),C:ot.read_shift(4,"i"),clsid:ot.read_shift(16),state:ot.read_shift(4,"i"),start:0,size:0},qt=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);qt!==0&&(xt.ct=N(ot,ot.l-8));var yt=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);yt!==0&&(xt.mt=N(ot,ot.l-8)),xt.start=ot.read_shift(4,"i"),xt.size=ot.read_shift(4,"i"),xt.size<0&&xt.start<0&&(xt.size=xt.type=0,xt.start=Z,xt.name=""),xt.type===5?(qe=xt.start,we>0&&qe!==Z&&(be[qe].name="!StreamData")):xt.size>=4096?(xt.storage="fat",be[xt.start]===void 0&&(be[xt.start]=C(xe,xt.start,be.fat_addrs,be.ssz)),be[xt.start].name=xt.name,xt.content=be[xt.start].data.slice(0,xt.size)):(xt.storage="minifat",xt.size<0?xt.size=0:qe!==Z&&xt.start!==Z&&be[qe]&&(xt.content=v(xt,be[qe].data,(be[ct]||{}).data))),xt.content&&fi(xt.content,0),Se[Xe]=xt,He.push(xt)}}function N(ue,be){return new Date((Vo(ue,be+4)/1e7*Math.pow(2,32)+Vo(ue,be)/1e7-11644473600)*1e3)}function E(ue,be){return u(),d(c.readFileSync(ue),be)}function P(ue,be){var xe=be&&be.type;switch(xe||en&&Buffer.isBuffer(ue)&&(xe="buffer"),xe||"base64"){case"file":return E(ue,be);case"base64":return d(qo(Zo(ue)),be);case"binary":return d(qo(ue),be)}return d(ue,be)}function F(ue,be){var xe=be||{},he=xe.root||"Root Entry";if(ue.FullPaths||(ue.FullPaths=[]),ue.FileIndex||(ue.FileIndex=[]),ue.FullPaths.length!==ue.FileIndex.length)throw new Error("inconsistent CFB structure");ue.FullPaths.length===0&&(ue.FullPaths[0]=he+"/",ue.FileIndex[0]={name:he,type:5}),xe.CLSID&&(ue.FileIndex[0].clsid=xe.CLSID),A(ue)}function A(ue){var be="Sh33tJ5";if(!Tr.find(ue,"/"+be)){var xe=St(4);xe[0]=55,xe[1]=xe[3]=50,xe[2]=54,ue.FileIndex.push({name:be,type:2,content:xe,size:4,L:69,R:69,C:69}),ue.FullPaths.push(ue.FullPaths[0]+be),j(ue)}}function j(ue,be){F(ue);for(var xe=!1,he=!1,we=ue.FullPaths.length-1;we>=0;--we){var Se=ue.FileIndex[we];switch(Se.type){case 0:he?xe=!0:(ue.FileIndex.pop(),ue.FullPaths.pop());break;case 1:case 2:case 5:he=!0,isNaN(Se.R*Se.L*Se.C)&&(xe=!0),Se.R>-1&&Se.L>-1&&Se.R==Se.L&&(xe=!0);break;default:xe=!0;break}}if(!(!xe&&!be)){var He=new Date(1987,1,19),ct=0,qe=Object.create?Object.create(null):{},oe=[];for(we=0;we<ue.FullPaths.length;++we)qe[ue.FullPaths[we]]=!0,ue.FileIndex[we].type!==0&&oe.push([ue.FullPaths[we],ue.FileIndex[we]]);for(we=0;we<oe.length;++we){var fe=n(oe[we][0]);he=qe[fe],he||(oe.push([fe,{name:s(fe).replace("/",""),type:1,clsid:te,ct:He,mt:He,content:null}]),qe[fe]=!0)}for(oe.sort(function(Xe,ot){return r(Xe[0],ot[0])}),ue.FullPaths=[],ue.FileIndex=[],we=0;we<oe.length;++we)ue.FullPaths[we]=oe[we][0],ue.FileIndex[we]=oe[we][1];for(we=0;we<oe.length;++we){var Te=ue.FileIndex[we],Ee=ue.FullPaths[we];if(Te.name=s(Ee).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||te,we===0)Te.C=oe.length>1?1:-1,Te.size=0,Te.type=5;else if(Ee.slice(-1)=="/"){for(ct=we+1;ct<oe.length&&n(ue.FullPaths[ct])!=Ee;++ct);for(Te.C=ct>=oe.length?-1:ct,ct=we+1;ct<oe.length&&n(ue.FullPaths[ct])!=n(Ee);++ct);Te.R=ct>=oe.length?-1:ct,Te.type=1}else n(ue.FullPaths[we+1]||"")==n(Ee)&&(Te.R=we+1),Te.type=2}}}function I(ue,be){var xe=be||{};if(xe.fileType=="mad")return Et(ue,xe);switch(j(ue),xe.fileType){case"zip":return Fe(ue,xe)}var he=(function(Xe){for(var ot=0,xt=0,qt=0;qt<Xe.FileIndex.length;++qt){var yt=Xe.FileIndex[qt];if(yt.content){var Yt=yt.content.length;Yt>0&&(Yt<4096?ot+=Yt+63>>6:xt+=Yt+511>>9)}}for(var _r=Xe.FullPaths.length+3>>2,kr=ot+7>>3,xr=ot+127>>7,Gr=kr+xt+_r+xr,un=Gr+127>>7,Xr=un<=109?0:Math.ceil((un-109)/127);Gr+un+Xr+127>>7>un;)Xr=++un<=109?0:Math.ceil((un-109)/127);var cr=[1,Xr,un,xr,_r,xt,ot,0];return Xe.FileIndex[0].size=ot<<6,cr[7]=(Xe.FileIndex[0].start=cr[0]+cr[1]+cr[2]+cr[3]+cr[4]+cr[5])+(cr[6]+7>>3),cr})(ue),we=St(he[7]<<9),Se=0,He=0;{for(Se=0;Se<8;++Se)we.write_shift(1,ee[Se]);for(Se=0;Se<8;++Se)we.write_shift(2,0);for(we.write_shift(2,62),we.write_shift(2,3),we.write_shift(2,65534),we.write_shift(2,9),we.write_shift(2,6),Se=0;Se<3;++Se)we.write_shift(2,0);for(we.write_shift(4,0),we.write_shift(4,he[2]),we.write_shift(4,he[0]+he[1]+he[2]+he[3]-1),we.write_shift(4,0),we.write_shift(4,4096),we.write_shift(4,he[3]?he[0]+he[1]+he[2]-1:Z),we.write_shift(4,he[3]),we.write_shift(-4,he[1]?he[0]-1:Z),we.write_shift(4,he[1]),Se=0;Se<109;++Se)we.write_shift(-4,Se<he[2]?he[1]+Se:-1)}if(he[1])for(He=0;He<he[1];++He){for(;Se<236+He*127;++Se)we.write_shift(-4,Se<he[2]?he[1]+Se:-1);we.write_shift(-4,He===he[1]-1?Z:He+1)}var ct=function(Xe){for(He+=Xe;Se<He-1;++Se)we.write_shift(-4,Se+1);Xe&&(++Se,we.write_shift(-4,Z))};for(He=Se=0,He+=he[1];Se<He;++Se)we.write_shift(-4,L.DIFSECT);for(He+=he[2];Se<He;++Se)we.write_shift(-4,L.FATSECT);ct(he[3]),ct(he[4]);for(var qe=0,oe=0,fe=ue.FileIndex[0];qe<ue.FileIndex.length;++qe)fe=ue.FileIndex[qe],fe.content&&(oe=fe.content.length,!(oe<4096)&&(fe.start=He,ct(oe+511>>9)));for(ct(he[6]+7>>3);we.l&511;)we.write_shift(-4,L.ENDOFCHAIN);for(He=Se=0,qe=0;qe<ue.FileIndex.length;++qe)fe=ue.FileIndex[qe],fe.content&&(oe=fe.content.length,!(!oe||oe>=4096)&&(fe.start=He,ct(oe+63>>6)));for(;we.l&511;)we.write_shift(-4,L.ENDOFCHAIN);for(Se=0;Se<he[4]<<2;++Se){var Te=ue.FullPaths[Se];if(!Te||Te.length===0){for(qe=0;qe<17;++qe)we.write_shift(4,0);for(qe=0;qe<3;++qe)we.write_shift(4,-1);for(qe=0;qe<12;++qe)we.write_shift(4,0);continue}fe=ue.FileIndex[Se],Se===0&&(fe.start=fe.size?fe.start-1:Z);var Ee=Se===0&&xe.root||fe.name;if(oe=2*(Ee.length+1),we.write_shift(64,Ee,"utf16le"),we.write_shift(2,oe),we.write_shift(1,fe.type),we.write_shift(1,fe.color),we.write_shift(-4,fe.L),we.write_shift(-4,fe.R),we.write_shift(-4,fe.C),fe.clsid)we.write_shift(16,fe.clsid,"hex");else for(qe=0;qe<4;++qe)we.write_shift(4,0);we.write_shift(4,fe.state||0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,fe.start),we.write_shift(4,fe.size),we.write_shift(4,0)}for(Se=1;Se<ue.FileIndex.length;++Se)if(fe=ue.FileIndex[Se],fe.size>=4096)if(we.l=fe.start+1<<9,en&&Buffer.isBuffer(fe.content))fe.content.copy(we,we.l,0,fe.size),we.l+=fe.size+511&-512;else{for(qe=0;qe<fe.size;++qe)we.write_shift(1,fe.content[qe]);for(;qe&511;++qe)we.write_shift(1,0)}for(Se=1;Se<ue.FileIndex.length;++Se)if(fe=ue.FileIndex[Se],fe.size>0&&fe.size<4096)if(en&&Buffer.isBuffer(fe.content))fe.content.copy(we,we.l,0,fe.size),we.l+=fe.size+63&-64;else{for(qe=0;qe<fe.size;++qe)we.write_shift(1,fe.content[qe]);for(;qe&63;++qe)we.write_shift(1,0)}if(en)we.l=we.length;else for(;we.l<we.length;)we.write_shift(1,0);return we}function B(ue,be){var xe=ue.FullPaths.map(function(qe){return qe.toUpperCase()}),he=xe.map(function(qe){var oe=qe.split("/");return oe[oe.length-(qe.slice(-1)=="/"?2:1)]}),we=!1;be.charCodeAt(0)===47?(we=!0,be=xe[0].slice(0,-1)+be):we=be.indexOf("/")!==-1;var Se=be.toUpperCase(),He=we===!0?xe.indexOf(Se):he.indexOf(Se);if(He!==-1)return ue.FileIndex[He];var ct=!Se.match(hy);for(Se=Se.replace(oo,""),ct&&(Se=Se.replace(hy,"!")),He=0;He<xe.length;++He)if((ct?xe[He].replace(hy,"!"):xe[He]).replace(oo,"")==Se||(ct?he[He].replace(hy,"!"):he[He]).replace(oo,"")==Se)return ue.FileIndex[He];return null}var Y=64,Z=-2,se="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",L={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function V(ue,be,xe){u();var he=I(ue,xe);c.writeFileSync(be,he)}function M(ue){for(var be=new Array(ue.length),xe=0;xe<ue.length;++xe)be[xe]=String.fromCharCode(ue[xe]);return be.join("")}function H(ue,be){var xe=I(ue,be);switch(be&&be.type||"buffer"){case"file":return u(),c.writeFileSync(be.filename,xe),xe;case"binary":return typeof xe=="string"?xe:M(xe);case"base64":return nv(typeof xe=="string"?xe:M(xe));case"buffer":if(en)return Buffer.isBuffer(xe)?xe:gd(xe);case"array":return typeof xe=="string"?qo(xe):xe}return xe}var W;function R(ue){try{var be=ue.InflateRaw,xe=new be;if(xe._processChunk(new Uint8Array([3,0]),xe._finishFlushFlag),xe.bytesRead)W=ue;else throw new Error("zlib does not expose bytesRead")}catch(he){console.error("cannot use native zlib: "+(he.message||he))}}function z(ue,be){if(!W)return fr(ue,be);var xe=W.InflateRaw,he=new xe,we=he._processChunk(ue.slice(ue.l),he._finishFlushFlag);return ue.l+=he.bytesRead,we}function K(ue){return W?W.deflateRawSync(ue):Je(ue)}var Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(ue){var be=(ue<<1|ue<<11)&139536|(ue<<5|ue<<15)&558144;return(be>>16|be>>8|be)&255}for(var le=typeof Uint8Array<"u",ce=le?new Uint8Array(256):[],_e=0;_e<256;++_e)ce[_e]=ie(_e);function ne(ue,be){var xe=ce[ue&255];return be<=8?xe>>>8-be:(xe=xe<<8|ce[ue>>8&255],be<=16?xe>>>16-be:(xe=xe<<8|ce[ue>>16&255],xe>>>24-be))}function pe(ue,be){var xe=be&7,he=be>>>3;return(ue[he]|(xe<=6?0:ue[he+1]<<8))>>>xe&3}function Ce(ue,be){var xe=be&7,he=be>>>3;return(ue[he]|(xe<=5?0:ue[he+1]<<8))>>>xe&7}function Ae(ue,be){var xe=be&7,he=be>>>3;return(ue[he]|(xe<=4?0:ue[he+1]<<8))>>>xe&15}function Ge(ue,be){var xe=be&7,he=be>>>3;return(ue[he]|(xe<=3?0:ue[he+1]<<8))>>>xe&31}function Le(ue,be){var xe=be&7,he=be>>>3;return(ue[he]|(xe<=1?0:ue[he+1]<<8))>>>xe&127}function At(ue,be,xe){var he=be&7,we=be>>>3,Se=(1<<xe)-1,He=ue[we]>>>he;return xe<8-he||(He|=ue[we+1]<<8-he,xe<16-he)||(He|=ue[we+2]<<16-he,xe<24-he)||(He|=ue[we+3]<<24-he),He&Se}function et(ue,be,xe){var he=be&7,we=be>>>3;return he<=5?ue[we]|=(xe&7)<<he:(ue[we]|=xe<<he&255,ue[we+1]=(xe&7)>>8-he),be+3}function pt(ue,be,xe){var he=be&7,we=be>>>3;return xe=(xe&1)<<he,ue[we]|=xe,be+1}function lt(ue,be,xe){var he=be&7,we=be>>>3;return xe<<=he,ue[we]|=xe&255,xe>>>=8,ue[we+1]=xe,be+8}function rt(ue,be,xe){var he=be&7,we=be>>>3;return xe<<=he,ue[we]|=xe&255,xe>>>=8,ue[we+1]=xe&255,ue[we+2]=xe>>>8,be+16}function ht(ue,be){var xe=ue.length,he=2*xe>be?2*xe:be+5,we=0;if(xe>=be)return ue;if(en){var Se=MF(he);if(ue.copy)ue.copy(Se);else for(;we<ue.length;++we)Se[we]=ue[we];return Se}else if(le){var He=new Uint8Array(he);if(He.set)He.set(ue);else for(;we<xe;++we)He[we]=ue[we];return He}return ue.length=he,ue}function Lt(ue){for(var be=new Array(ue),xe=0;xe<ue;++xe)be[xe]=0;return be}function zt(ue,be,xe){var he=1,we=0,Se=0,He=0,ct=0,qe=ue.length,oe=le?new Uint16Array(32):Lt(32);for(Se=0;Se<32;++Se)oe[Se]=0;for(Se=qe;Se<xe;++Se)ue[Se]=0;qe=ue.length;var fe=le?new Uint16Array(qe):Lt(qe);for(Se=0;Se<qe;++Se)oe[we=ue[Se]]++,he<we&&(he=we),fe[Se]=0;for(oe[0]=0,Se=1;Se<=he;++Se)oe[Se+16]=ct=ct+oe[Se-1]<<1;for(Se=0;Se<qe;++Se)ct=ue[Se],ct!=0&&(fe[Se]=oe[ct+16]++);var Te=0;for(Se=0;Se<qe;++Se)if(Te=ue[Se],Te!=0)for(ct=ne(fe[Se],he)>>he-Te,He=(1<<he+4-Te)-1;He>=0;--He)be[ct|He<<Te]=Te&15|Se<<4;return he}var Dt=le?new Uint16Array(512):Lt(512),De=le?new Uint16Array(32):Lt(32);if(!le){for(var Ie=0;Ie<512;++Ie)Dt[Ie]=0;for(Ie=0;Ie<32;++Ie)De[Ie]=0}(function(){for(var ue=[],be=0;be<32;be++)ue.push(5);zt(ue,De,32);var xe=[];for(be=0;be<=143;be++)xe.push(8);for(;be<=255;be++)xe.push(9);for(;be<=279;be++)xe.push(7);for(;be<=287;be++)xe.push(8);zt(xe,Dt,288)})();var Ke=(function(){for(var be=le?new Uint8Array(32768):[],xe=0,he=0;xe<X.length-1;++xe)for(;he<X[xe+1];++he)be[he]=xe;for(;he<32768;++he)be[he]=29;var we=le?new Uint8Array(259):[];for(xe=0,he=0;xe<ae.length-1;++xe)for(;he<ae[xe+1];++he)we[he]=xe;function Se(ct,qe){for(var oe=0;oe<ct.length;){var fe=Math.min(65535,ct.length-oe),Te=oe+fe==ct.length;for(qe.write_shift(1,+Te),qe.write_shift(2,fe),qe.write_shift(2,~fe&65535);fe-- >0;)qe[qe.l++]=ct[oe++]}return qe.l}function He(ct,qe){for(var oe=0,fe=0,Te=le?new Uint16Array(32768):[];fe<ct.length;){var Ee=Math.min(65535,ct.length-fe);if(Ee<10){for(oe=et(qe,oe,+(fe+Ee==ct.length)),oe&7&&(oe+=8-(oe&7)),qe.l=oe/8|0,qe.write_shift(2,Ee),qe.write_shift(2,~Ee&65535);Ee-- >0;)qe[qe.l++]=ct[fe++];oe=qe.l*8;continue}oe=et(qe,oe,+(fe+Ee==ct.length)+2);for(var Xe=0;Ee-- >0;){var ot=ct[fe];Xe=(Xe<<5^ot)&32767;var xt=-1,qt=0;if((xt=Te[Xe])&&(xt|=fe&-32768,xt>fe&&(xt-=32768),xt<fe))for(;ct[xt+qt]==ct[fe+qt]&&qt<250;)++qt;if(qt>2){ot=we[qt],ot<=22?oe=lt(qe,oe,ce[ot+1]>>1)-1:(lt(qe,oe,3),oe+=5,lt(qe,oe,ce[ot-23]>>5),oe+=3);var yt=ot<8?0:ot-4>>2;yt>0&&(rt(qe,oe,qt-ae[ot]),oe+=yt),ot=be[fe-xt],oe=lt(qe,oe,ce[ot]>>3),oe-=3;var Yt=ot<4?0:ot-2>>1;Yt>0&&(rt(qe,oe,fe-xt-X[ot]),oe+=Yt);for(var _r=0;_r<qt;++_r)Te[Xe]=fe&32767,Xe=(Xe<<5^ct[fe])&32767,++fe;Ee-=qt-1}else ot<=143?ot=ot+48:oe=pt(qe,oe,1),oe=lt(qe,oe,ce[ot]),Te[Xe]=fe&32767,++fe}oe=lt(qe,oe,0)-1}return qe.l=(oe+7)/8|0,qe.l}return function(qe,oe){return qe.length<8?Se(qe,oe):He(qe,oe)}})();function Je(ue){var be=St(50+Math.floor(ue.length*1.1)),xe=Ke(ue,be);return be.slice(0,xe)}var Ye=le?new Uint16Array(32768):Lt(32768),Tt=le?new Uint16Array(32768):Lt(32768),Nt=le?new Uint16Array(128):Lt(128),Wt=1,or=1;function dr(ue,be){var xe=Ge(ue,be)+257;be+=5;var he=Ge(ue,be)+1;be+=5;var we=Ae(ue,be)+4;be+=4;for(var Se=0,He=le?new Uint8Array(19):Lt(19),ct=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],qe=1,oe=le?new Uint8Array(8):Lt(8),fe=le?new Uint8Array(8):Lt(8),Te=He.length,Ee=0;Ee<we;++Ee)He[Q[Ee]]=Se=Ce(ue,be),qe<Se&&(qe=Se),oe[Se]++,be+=3;var Xe=0;for(oe[0]=0,Ee=1;Ee<=qe;++Ee)fe[Ee]=Xe=Xe+oe[Ee-1]<<1;for(Ee=0;Ee<Te;++Ee)(Xe=He[Ee])!=0&&(ct[Ee]=fe[Xe]++);var ot=0;for(Ee=0;Ee<Te;++Ee)if(ot=He[Ee],ot!=0){Xe=ce[ct[Ee]]>>8-ot;for(var xt=(1<<7-ot)-1;xt>=0;--xt)Nt[Xe|xt<<ot]=ot&7|Ee<<3}var qt=[];for(qe=1;qt.length<xe+he;)switch(Xe=Nt[Le(ue,be)],be+=Xe&7,Xe>>>=3){case 16:for(Se=3+pe(ue,be),be+=2,Xe=qt[qt.length-1];Se-- >0;)qt.push(Xe);break;case 17:for(Se=3+Ce(ue,be),be+=3;Se-- >0;)qt.push(0);break;case 18:for(Se=11+Le(ue,be),be+=7;Se-- >0;)qt.push(0);break;default:qt.push(Xe),qe<Xe&&(qe=Xe);break}var yt=qt.slice(0,xe),Yt=qt.slice(xe);for(Ee=xe;Ee<286;++Ee)yt[Ee]=0;for(Ee=he;Ee<30;++Ee)Yt[Ee]=0;return Wt=zt(yt,Ye,286),or=zt(Yt,Tt,30),be}function Er(ue,be){if(ue[0]==3&&!(ue[1]&3))return[jf(be),2];for(var xe=0,he=0,we=MF(be||1<<18),Se=0,He=we.length>>>0,ct=0,qe=0;(he&1)==0;){if(he=Ce(ue,xe),xe+=3,he>>>1)he>>1==1?(ct=9,qe=5):(xe=dr(ue,xe),ct=Wt,qe=or);else{xe&7&&(xe+=8-(xe&7));var oe=ue[xe>>>3]|ue[(xe>>>3)+1]<<8;if(xe+=32,oe>0)for(!be&&He<Se+oe&&(we=ht(we,Se+oe),He=we.length);oe-- >0;)we[Se++]=ue[xe>>>3],xe+=8;continue}for(;;){!be&&He<Se+32767&&(we=ht(we,Se+32767),He=we.length);var fe=At(ue,xe,ct),Te=he>>>1==1?Dt[fe]:Ye[fe];if(xe+=Te&15,Te>>>=4,(Te>>>8&255)===0)we[Se++]=Te;else{if(Te==256)break;Te-=257;var Ee=Te<8?0:Te-4>>2;Ee>5&&(Ee=0);var Xe=Se+ae[Te];Ee>0&&(Xe+=At(ue,xe,Ee),xe+=Ee),fe=At(ue,xe,qe),Te=he>>>1==1?De[fe]:Tt[fe],xe+=Te&15,Te>>>=4;var ot=Te<4?0:Te-2>>1,xt=X[Te];for(ot>0&&(xt+=At(ue,xe,ot),xe+=ot),!be&&He<Xe&&(we=ht(we,Xe+100),He=we.length);Se<Xe;)we[Se]=we[Se-xt],++Se}}}return be?[we,xe+7>>>3]:[we.slice(0,Se),xe+7>>>3]}function fr(ue,be){var xe=ue.slice(ue.l||0),he=Er(xe,be);return ue.l+=he[1],he[0]}function nr(ue,be){if(ue)typeof console<"u"&&console.error(be);else throw new Error(be)}function me(ue,be){var xe=ue;fi(xe,0);var he=[],we=[],Se={FileIndex:he,FullPaths:we};F(Se,{root:be.root});for(var He=xe.length-4;(xe[He]!=80||xe[He+1]!=75||xe[He+2]!=5||xe[He+3]!=6)&&He>=0;)--He;xe.l=He+4,xe.l+=4;var ct=xe.read_shift(2);xe.l+=6;var qe=xe.read_shift(4);for(xe.l=qe,He=0;He<ct;++He){xe.l+=20;var oe=xe.read_shift(4),fe=xe.read_shift(4),Te=xe.read_shift(2),Ee=xe.read_shift(2),Xe=xe.read_shift(2);xe.l+=8;var ot=xe.read_shift(4),xt=o(xe.slice(xe.l+Te,xe.l+Te+Ee));xe.l+=Te+Ee+Xe;var qt=xe.l;xe.l=ot+4,Ne(xe,oe,fe,Se,xt),xe.l=qt}return Se}function Ne(ue,be,xe,he,we){ue.l+=2;var Se=ue.read_shift(2),He=ue.read_shift(2),ct=i(ue);if(Se&8257)throw new Error("Unsupported ZIP encryption");for(var qe=ue.read_shift(4),oe=ue.read_shift(4),fe=ue.read_shift(4),Te=ue.read_shift(2),Ee=ue.read_shift(2),Xe="",ot=0;ot<Te;++ot)Xe+=String.fromCharCode(ue[ue.l++]);if(Ee){var xt=o(ue.slice(ue.l,ue.l+Ee));(xt[21589]||{}).mt&&(ct=xt[21589].mt),((we||{})[21589]||{}).mt&&(ct=we[21589].mt)}ue.l+=Ee;var qt=ue.slice(ue.l,ue.l+oe);switch(He){case 8:qt=z(ue,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+He)}var yt=!1;Se&8&&(qe=ue.read_shift(4),qe==134695760&&(qe=ue.read_shift(4),yt=!0),oe=ue.read_shift(4),fe=ue.read_shift(4)),oe!=be&&nr(yt,"Bad compressed size: "+be+" != "+oe),fe!=xe&&nr(yt,"Bad uncompressed size: "+xe+" != "+fe),Kt(he,Xe,qt,{unsafe:!0,mt:ct})}function Fe(ue,be){var xe=be||{},he=[],we=[],Se=St(1),He=xe.compression?8:0,ct=0,qe=0,oe=0,fe=0,Te=0,Ee=ue.FullPaths[0],Xe=Ee,ot=ue.FileIndex[0],xt=[],qt=0;for(qe=1;qe<ue.FullPaths.length;++qe)if(Xe=ue.FullPaths[qe].slice(Ee.length),ot=ue.FileIndex[qe],!(!ot.size||!ot.content||Xe=="Sh33tJ5")){var yt=fe,Yt=St(Xe.length);for(oe=0;oe<Xe.length;++oe)Yt.write_shift(1,Xe.charCodeAt(oe)&127);Yt=Yt.slice(0,Yt.l),xt[Te]=noe.buf(ot.content,0);var _r=ot.content;He==8&&(_r=K(_r)),Se=St(30),Se.write_shift(4,67324752),Se.write_shift(2,20),Se.write_shift(2,ct),Se.write_shift(2,He),ot.mt?a(Se,ot.mt):Se.write_shift(4,0),Se.write_shift(-4,xt[Te]),Se.write_shift(4,_r.length),Se.write_shift(4,ot.content.length),Se.write_shift(2,Yt.length),Se.write_shift(2,0),fe+=Se.length,he.push(Se),fe+=Yt.length,he.push(Yt),fe+=_r.length,he.push(_r),Se=St(46),Se.write_shift(4,33639248),Se.write_shift(2,0),Se.write_shift(2,20),Se.write_shift(2,ct),Se.write_shift(2,He),Se.write_shift(4,0),Se.write_shift(-4,xt[Te]),Se.write_shift(4,_r.length),Se.write_shift(4,ot.content.length),Se.write_shift(2,Yt.length),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(4,0),Se.write_shift(4,yt),qt+=Se.l,we.push(Se),qt+=Yt.length,we.push(Yt),++Te}return Se=St(22),Se.write_shift(4,101010256),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,Te),Se.write_shift(2,Te),Se.write_shift(4,qt),Se.write_shift(4,fe),Se.write_shift(2,0),Ha([Ha(he),Ha(we),Se])}var Re={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function bt(ue,be){if(ue.ctype)return ue.ctype;var xe=ue.name||"",he=xe.match(/\.([^\.]+)$/);return he&&Re[he[1]]||be&&(he=(xe=be).match(/[\.\\]([^\.\\])+$/),he&&Re[he[1]])?Re[he[1]]:"application/octet-stream"}function Pe(ue){for(var be=nv(ue),xe=[],he=0;he<be.length;he+=76)xe.push(be.slice(he,he+76));return xe.join(`\r
`)+`\r
`}function ze(ue){var be=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var fe=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});be=be.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),be.charAt(0)==`
`&&(be="=0D"+be.slice(1)),be=be.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var xe=[],he=be.split(`\r
`),we=0;we<he.length;++we){var Se=he[we];if(Se.length==0){xe.push("");continue}for(var He=0;He<Se.length;){var ct=76,qe=Se.slice(He,He+ct);qe.charAt(ct-1)=="="?ct--:qe.charAt(ct-2)=="="?ct-=2:qe.charAt(ct-3)=="="&&(ct-=3),qe=Se.slice(He,He+ct),He+=ct,He<Se.length&&(qe+="="),xe.push(qe)}}return xe.join(`\r
`)}function ke(ue){for(var be=[],xe=0;xe<ue.length;++xe){for(var he=ue[xe];xe<=ue.length&&he.charAt(he.length-1)=="=";)he=he.slice(0,he.length-1)+ue[++xe];be.push(he)}for(var we=0;we<be.length;++we)be[we]=be[we].replace(/[=][0-9A-Fa-f]{2}/g,function(Se){return String.fromCharCode(parseInt(Se.slice(1),16))});return qo(be.join(`\r
`))}function $e(ue,be,xe){for(var he="",we="",Se="",He,ct=0;ct<10;++ct){var qe=be[ct];if(!qe||qe.match(/^\s*$/))break;var oe=qe.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":he=oe[2].trim();break;case"content-type":Se=oe[2].trim();break;case"content-transfer-encoding":we=oe[2].trim();break}}switch(++ct,we.toLowerCase()){case"base64":He=qo(Zo(be.slice(ct).join("")));break;case"quoted-printable":He=ke(be.slice(ct));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+we)}var fe=Kt(ue,he.slice(xe.length),He,{unsafe:!0});Se&&(fe.ctype=Se)}function Be(ue,be){if(M(ue.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var xe=be&&be.root||"",he=(en&&Buffer.isBuffer(ue)?ue.toString("binary"):M(ue)).split(`\r
`),we=0,Se="";for(we=0;we<he.length;++we)if(Se=he[we],!!/^Content-Location:/i.test(Se)&&(Se=Se.slice(Se.indexOf("file")),xe||(xe=Se.slice(0,Se.lastIndexOf("/")+1)),Se.slice(0,xe.length)!=xe))for(;xe.length>0&&(xe=xe.slice(0,xe.length-1),xe=xe.slice(0,xe.lastIndexOf("/")+1),Se.slice(0,xe.length)!=xe););var He=(he[1]||"").match(/boundary="(.*?)"/);if(!He)throw new Error("MAD cannot find boundary");var ct="--"+(He[1]||""),qe=[],oe=[],fe={FileIndex:qe,FullPaths:oe};F(fe);var Te,Ee=0;for(we=0;we<he.length;++we){var Xe=he[we];Xe!==ct&&Xe!==ct+"--"||(Ee++&&$e(fe,he.slice(Te,we),xe),Te=we)}return fe}function Et(ue,be){var xe=be||{},he=xe.boundary||"SheetJS";he="------="+he;for(var we=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+he.slice(2)+'"',"","",""],Se=ue.FullPaths[0],He=Se,ct=ue.FileIndex[0],qe=1;qe<ue.FullPaths.length;++qe)if(He=ue.FullPaths[qe].slice(Se.length),ct=ue.FileIndex[qe],!(!ct.size||!ct.content||He=="Sh33tJ5")){He=He.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qt){return"_x"+qt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qt){return"_u"+qt.charCodeAt(0).toString(16)+"_"});for(var oe=ct.content,fe=en&&Buffer.isBuffer(oe)?oe.toString("binary"):M(oe),Te=0,Ee=Math.min(1024,fe.length),Xe=0,ot=0;ot<=Ee;++ot)(Xe=fe.charCodeAt(ot))>=32&&Xe<128&&++Te;var xt=Te>=Ee*4/5;we.push(he),we.push("Content-Location: "+(xe.root||"file:///C:/SheetJS/")+He),we.push("Content-Transfer-Encoding: "+(xt?"quoted-printable":"base64")),we.push("Content-Type: "+bt(ct,He)),we.push(""),we.push(xt?ze(fe):Pe(fe))}return we.push(he+`--\r
`),we.join(`\r
`)}function It(ue){var be={};return F(be,ue),be}function Kt(ue,be,xe,he){var we=he&&he.unsafe;we||F(ue);var Se=!we&&Tr.find(ue,be);if(!Se){var He=ue.FullPaths[0];be.slice(0,He.length)==He?He=be:(He.slice(-1)!="/"&&(He+="/"),He=(He+be).replace("//","/")),Se={name:s(be),type:2},ue.FileIndex.push(Se),ue.FullPaths.push(He),we||Tr.utils.cfb_gc(ue)}return Se.content=xe,Se.size=xe?xe.length:0,he&&(he.CLSID&&(Se.clsid=he.CLSID),he.mt&&(Se.mt=he.mt),he.ct&&(Se.ct=he.ct)),Se}function wr(ue,be){F(ue);var xe=Tr.find(ue,be);if(xe){for(var he=0;he<ue.FileIndex.length;++he)if(ue.FileIndex[he]==xe)return ue.FileIndex.splice(he,1),ue.FullPaths.splice(he,1),!0}return!1}function lr(ue,be,xe){F(ue);var he=Tr.find(ue,be);if(he){for(var we=0;we<ue.FileIndex.length;++we)if(ue.FileIndex[we]==he)return ue.FileIndex[we].name=s(xe),ue.FullPaths[we]=xe,!0}return!1}function Fr(ue){j(ue,!0)}return t.find=B,t.read=P,t.parse=d,t.write=H,t.writeFile=V,t.utils={cfb_new:It,cfb_add:Kt,cfb_del:wr,cfb_mov:lr,cfb_gc:Fr,ReadShift:Ey,CheckField:P$,prep_blob:fi,bconcat:Ha,use_zlib:R,_deflateRaw:Je,_inflateRaw:fr,consts:L},t})();function soe(e){return typeof e=="string"?c2(e):Array.isArray(e)?jie(e):e}function qv(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=c2(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Xc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([soe(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=zf(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function aoe(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Us(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function GF(e,t){for(var r=[],n=Us(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function d2(e){for(var t=[],r=Us(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function f2(e){for(var t=[],r=Us(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function ioe(e){for(var t=[],r=Us(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var V_=new Date(1899,11,30,0,0,0);function Na(e,t){var r=e.getTime(),n=V_.getTime()+(e.getTimezoneOffset()-V_.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var u$=new Date,ooe=V_.getTime()+(u$.getTimezoneOffset()-V_.getTimezoneOffset())*6e4,VF=u$.getTimezoneOffset();function h2(e){var t=new Date;return t.setTime(e*24*60*60*1e3+ooe),t.getTimezoneOffset()!==VF&&t.setTime(t.getTime()+(t.getTimezoneOffset()-VF)*6e4),t}function loe(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var KF=new Date("2017-02-19T19:06:09.000Z"),d$=isNaN(KF.getFullYear())?new Date("2/19/17"):KF,coe=d$.getFullYear()==2017;function ls(e,t){var r=new Date(e);if(coe)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(d$.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function x0(e,t){if(en&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Xc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Xc(JB(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Xc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Xc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function cs(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=cs(e[r]));return t}function Ms(e,t){for(var r="";r.length<t;)r+=e;return r}function hc(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var uoe=["january","february","march","april","may","june","july","august","september","october","november","december"];function Em(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&uoe.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var doe=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}})();function f$(e){return e?e.content&&e.type?x0(e.content,!0):e.data?fy(e.data):e.asNodeBuffer&&en?fy(e.asNodeBuffer().toString("binary")):e.asBinary?fy(e.asBinary()):e._data&&e._data.getContent?fy(x0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function h$(e){if(!e)return null;if(e.data)return IF(e.data);if(e.asNodeBuffer&&en)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?IF(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function foe(e){return e&&e.name.slice(-4)===".bin"?h$(e):f$(e)}function bl(e,t){for(var r=e.FullPaths||Us(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function o3(e,t){var r=bl(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ca(e,t,r){if(!r)return foe(o3(e,t));if(!t)return null;try{return ca(e,t)}catch{return null}}function Yo(e,t,r){if(!r)return f$(o3(e,t));if(!t)return null;try{return Yo(e,t)}catch{return null}}function hoe(e,t,r){return h$(o3(e,t))}function qF(e){for(var t=e.FullPaths||Us(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Zr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return en?n=gd(r):n=Pie(r),Tr.utils.cfb_add(e,t,n)}Tr.utils.cfb_add(e,t,r)}else e.file(t,r)}function l3(){return Tr.utils.cfb_new()}function g$(e,t){switch(t.type){case"base64":return Tr.read(e,{type:"base64"});case"binary":return Tr.read(e,{type:"binary"});case"buffer":case"array":return Tr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function gy(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var ra=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,goe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,YF=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,moe=/<[^>]*>/g,zi=ra.match(YF)?YF:moe,poe=/<\w*:/,xoe=/<(\/?)\w+:/;function Lr(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(goe),o=0,c="",u=0,d="",f="",g=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(g=(s=f.charCodeAt(a+1))==34||s==39?1:0,c=f.slice(a+1+g,f.length-g),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var p=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[p]&&d.slice(o-3,o)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function lu(e){return e.replace(xoe,"<$1")}var m$={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},c3=d2(m$),xn=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return m$[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),u3=/[&<>'"]/g,yoe=/[\u0000-\u0008\u000b-\u001f]/g;function Ln(e){var t=e+"";return t.replace(u3,function(r){return c3[r]}).replace(yoe,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function XF(e){return Ln(e).replace(/ /g,"_x0020_")}var p$=/[\u0000-\u001f]/g;function d3(e){var t=e+"";return t.replace(u3,function(r){return c3[r]}).replace(/\n/g,"<br/>").replace(p$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function voe(e){var t=e+"";return t.replace(u3,function(r){return c3[r]}).replace(p$,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var QF=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function woe(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function as(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ck(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function JF(e){var t=jf(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function ZF(e){return gd(e,"binary").toString("utf8")}var Aw="foo bar baz",Hn=en&&(ZF(Aw)==Ck(Aw)&&ZF||JF(Aw)==Ck(Aw)&&JF)||Ck,Xc=en?function(e){return gd(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},av=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),x$=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),_oe=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),boe=/<\/?(?:vt:)?variant>/g,Soe=/<(?:vt:)([^>]*)>([\s\S]*)</;function eO(e,t){var r=Lr(e),n=e.match(_oe(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(boe,"").match(Soe);i&&s.push({v:Hn(i[2]),t:i[1]})}),s}var y$=/(^\s|\s$|\n)/;function pi(e,t){return"<"+e+(t.match(y$)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function iv(e){return Us(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Zt(e,t,r){return"<"+e+(r!=null?iv(r):"")+(t!=null?(t.match(y$)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function xE(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function koe(e,t){switch(typeof e){case"string":var r=Zt("vt:lpwstr",Ln(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Zt((e|0)==e?"vt:i4":"vt:r8",Ln(String(e)));case"boolean":return Zt("vt:bool",e?"true":"false")}if(e instanceof Date)return Zt("vt:filetime",xE(e));throw new Error("Unable to serialize "+e)}function f3(e){if(en&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Hn(zf(s3(e)));throw new Error("Bad input format: expected Buffer or string")}var ov=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ta={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},F0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Go={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Coe(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Toe(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var tO=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},rO=en?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:gd(t)})):tO(e)}:tO,nO=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(qu(e,s)));return n.join("").replace(oo,"")},h3=en?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(oo,""):nO(e,t,r)}:nO,sO=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},v$=en?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):sO(e,t,r)}:sO,aO=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Kg(e,s)));return n.join("")},Yv=en?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):aO(t,r,n)}:aO,w$=function(e,t){var r=Vo(e,t);return r>0?Yv(e,t+4,t+4+r-1):""},_$=w$,b$=function(e,t){var r=Vo(e,t);return r>0?Yv(e,t+4,t+4+r-1):""},S$=b$,k$=function(e,t){var r=2*Vo(e,t);return r>0?Yv(e,t+4,t+4+r-1):""},C$=k$,T$=function(t,r){var n=Vo(t,r);return n>0?h3(t,r+4,r+4+n):""},E$=T$,N$=function(e,t){var r=Vo(e,t);return r>0?Yv(e,t+4,t+4+r):""},A$=N$,j$=function(e,t){return Coe(e,t)},K_=j$,g3=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};en&&(_$=function(t,r){if(!Buffer.isBuffer(t))return w$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},S$=function(t,r){if(!Buffer.isBuffer(t))return b$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},C$=function(t,r){if(!Buffer.isBuffer(t))return k$(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},E$=function(t,r){if(!Buffer.isBuffer(t))return T$(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},A$=function(t,r){if(!Buffer.isBuffer(t))return N$(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},K_=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):j$(t,r)},g3=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Kg=function(e,t){return e[t]},qu=function(e,t){return e[t+1]*256+e[t]},Eoe=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Vo=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Oh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Noe=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ey(e,t){var r="",n,s,a=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,en&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(qu(this,u)),u+=2;e*=2;break;case"utf8":r=Yv(this,this.l,this.l+e);break;case"utf16le":e*=2,r=h3(this,this.l,this.l+e);break;case"wstr":return Ey.call(this,e,"dbcs");case"lpstr-ansi":r=_$(this,this.l),e=4+Vo(this,this.l);break;case"lpstr-cp":r=S$(this,this.l),e=4+Vo(this,this.l);break;case"lpwstr":r=C$(this,this.l),e=4+2*Vo(this,this.l);break;case"lpp4":e=4+Vo(this,this.l),r=E$(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Vo(this,this.l),r=A$(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Kg(this,this.l+e++))!==0;)a.push(Nw(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=qu(this,this.l+e))!==0;)a.push(Nw(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Kg(this,u),this.l=u+1,o=Ey.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Nw(qu(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Kg(this,u),this.l=u+1,o=Ey.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Nw(Kg(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Kg(this,this.l),this.l++,n;case 2:return n=(t==="i"?Eoe:qu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Oh:Noe)(this,this.l),this.l+=4,n):(s=Vo(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=K_(this,this.l):s=K_([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=v$(this,this.l,e);break}}return this.l+=e,r}var Aoe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},joe=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Poe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Foe(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)Poe(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Aoe(this,t,this.l);break;case 8:if(n=8,r==="f"){Toe(this,t,this.l);break}case 16:break;case-4:n=4,joe(this,t,this.l);break}return this.l+=n,this}function P$(e,t){var r=v$(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function fi(e,t){e.l=t,e.read_shift=Ey,e.chk=P$,e.write_shift=Foe}function Ui(e,t){e.l+=t}function St(e){var t=jf(e);return fi(t,0),t}function md(e,t,r){if(e){var n,s,a;fi(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=hv[o]||hv[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,o))return}}}function Ao(){var e=[],t=en?256:2048,r=function(u){var d=St(u);return fi(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),Ha(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function Ot(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=hv[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&g3(r)&&e.push(r)}}function Ny(e,t,r){var n=cs(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function iO(e,t,r){var n=cs(e);return n.s=Ny(n.s,t.s,r),n.e=Ny(n.e,t.s,r),n}function Ay(e,t){if(e.cRel&&e.c<0)for(e=cs(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=cs(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Rr(e);return!e.cRel&&e.cRel!=null&&(r=Ioe(r)),!e.rRel&&e.rRel!=null&&(r=Ooe(r)),r}function Tk(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ss(e.s.c)+":"+(e.e.cRel?"":"$")+Ss(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ea(e.s.r)+":"+(e.e.rRel?"":"$")+ea(e.e.r):Ay(e.s,t.biff)+":"+Ay(e.e,t.biff)}function m3(e){return parseInt(Doe(e),10)-1}function ea(e){return""+(e+1)}function Ooe(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Doe(e){return e.replace(/\$(\d+)$/,"$1")}function p3(e){for(var t=Roe(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ss(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Ioe(e){return e.replace(/^([A-Z])/,"$$$1")}function Roe(e){return e.replace(/^\$([A-Z])/,"$1")}function Moe(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ks(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Rr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function jo(e){var t=e.indexOf(":");return t==-1?{s:ks(e),e:ks(e)}:{s:ks(e.slice(0,t)),e:ks(e.slice(t+1))}}function Jr(e,t){return typeof t>"u"||typeof t=="number"?Jr(e.s,e.e):(typeof e!="string"&&(e=Rr(e)),typeof t!="string"&&(t=Rr(t)),e==t?e:e+":"+t)}function yn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function oO(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ol(e.z,r?Na(t):t)}catch{}try{return e.w=Ol((e.XF||{}).numFmtId||(r?14:0),r?Na(t):t)}catch{return""+t}}function od(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?pd[e.v]||e.v:t==null?oO(e,e.v):oO(e,t))}function Wf(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function F$(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?ks(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=yn(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[f].length;++g)if(!(typeof t[f][g]>"u")){var p={v:t[f][g]},x=i+f,v=o+g;if(u.s.r>x&&(u.s.r=x),u.s.c>v&&(u.s.c=v),u.e.r<x&&(u.e.r=x),u.e.c<v&&(u.e.c=v),t[f][g]&&typeof t[f][g]=="object"&&!Array.isArray(t[f][g])&&!(t[f][g]instanceof Date))p=t[f][g];else if(Array.isArray(p.v)&&(p.f=t[f][g][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Dr[14],n.cellDates?(p.t="d",p.w=Ol(p.z,Na(p.v))):(p.t="n",p.v=Na(p.v),p.w=Ol(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][v]&&a[x][v].z&&(p.z=a[x][v].z),a[x][v]=p;else{var w=Rr({c:v,r:x});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return u.s.c<1e7&&(a["!ref"]=Jr(u)),a}function rp(e,t){return F$(null,e,t)}function Loe(e){return e.read_shift(4,"i")}function gc(e,t){return t||(t=St(4)),t.write_shift(4,e),t}function Bi(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Va(e,t){var r=!1;return t==null&&(r=!0,t=St(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Boe(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function $oe(e,t){return t||(t=St(4)),t.write_shift(2,0),t.write_shift(2,0),t}function x3(e,t){var r=e.l,n=e.read_shift(1),s=Bi(e),a=[],i={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(Boe(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function Uoe(e,t){var r=!1;return t==null&&(r=!0,t=St(15+4*e.t.length)),t.write_shift(1,0),Va(e.t,t),r?t.slice(0,t.l):t}var zoe=x3;function Woe(e,t){var r=!1;return t==null&&(r=!0,t=St(23+4*e.t.length)),t.write_shift(1,1),Va(e.t,t),t.write_shift(4,1),$oe({},t),r?t.slice(0,t.l):t}function Ll(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function O0(e,t){return t==null&&(t=St(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function D0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function I0(e,t){return t==null&&(t=St(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Hoe=Bi,O$=Va;function y3(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function q_(e,t){var r=!1;return t==null&&(r=!0,t=St(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Goe=Bi,yE=y3,v3=q_;function w3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?K_([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Oh(t,0)>>2;return r?s/100:s}function D$(e,t){t==null&&(t=St(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function I$(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Voe(e,t){return t||(t=St(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var R0=I$,np=Voe;function Ii(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function y0(e,t){return(t||St(8)).write_shift(8,e,"f")}function Koe(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=qh[s];u&&(t.rgb=cv(u));break;case 2:t.rgb=cv([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Y_(e,t){if(t||(t=St(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function qoe(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Yoe(e,t){t||(t=St(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function R$(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Xoe(e){return R$(e,1)}function Qoe(e){return R$(e,2)}var _3=2,bo=3,jw=11,lO=12,X_=19,Pw=64,Joe=65,Zoe=71,ele=4108,tle=4126,$a=80,M$=81,rle=[$a,M$],vE={1:{n:"CodePage",t:_3},2:{n:"Category",t:$a},3:{n:"PresentationFormat",t:$a},4:{n:"ByteCount",t:bo},5:{n:"LineCount",t:bo},6:{n:"ParagraphCount",t:bo},7:{n:"SlideCount",t:bo},8:{n:"NoteCount",t:bo},9:{n:"HiddenCount",t:bo},10:{n:"MultimediaClipCount",t:bo},11:{n:"ScaleCrop",t:jw},12:{n:"HeadingPairs",t:ele},13:{n:"TitlesOfParts",t:tle},14:{n:"Manager",t:$a},15:{n:"Company",t:$a},16:{n:"LinksUpToDate",t:jw},17:{n:"CharacterCount",t:bo},19:{n:"SharedDoc",t:jw},22:{n:"HyperlinksChanged",t:jw},23:{n:"AppVersion",t:bo,p:"version"},24:{n:"DigSig",t:Joe},26:{n:"ContentType",t:$a},27:{n:"ContentStatus",t:$a},28:{n:"Language",t:$a},29:{n:"Version",t:$a},255:{},2147483648:{n:"Locale",t:X_},2147483651:{n:"Behavior",t:X_},1919054434:{}},wE={1:{n:"CodePage",t:_3},2:{n:"Title",t:$a},3:{n:"Subject",t:$a},4:{n:"Author",t:$a},5:{n:"Keywords",t:$a},6:{n:"Comments",t:$a},7:{n:"Template",t:$a},8:{n:"LastAuthor",t:$a},9:{n:"RevNumber",t:$a},10:{n:"EditTime",t:Pw},11:{n:"LastPrinted",t:Pw},12:{n:"CreatedDate",t:Pw},13:{n:"ModifiedDate",t:Pw},14:{n:"PageCount",t:bo},15:{n:"WordCount",t:bo},16:{n:"CharCount",t:bo},17:{n:"Thumbnail",t:Zoe},18:{n:"Application",t:$a},19:{n:"DocSecurity",t:bo},255:{},2147483648:{n:"Locale",t:X_},2147483651:{n:"Behavior",t:X_},1919054434:{}},cO={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},nle=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function sle(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var ale=sle([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qh=cs(ale),pd={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},L$={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},_E={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Fw={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function b3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ile(e){var t=b3();if(!e||!e.match)return t;var r={};if((e.match(zi)||[]).forEach(function(n){var s=Lr(n);switch(s[0].replace(poe,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[_E[s.ContentType]]!==void 0&&t[_E[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Ta.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function B$(e,t){var r=ioe(_E),n=[],s;n[n.length]=ra,n[n.length]=Zt("Types",null,{xmlns:Ta.CT,"xmlns:xsd":Ta.xsd,"xmlns:xsi":Ta.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Zt("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Zt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Fw[c][t.bookType]||Fw[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Zt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Fw[c][t.bookType]||Fw[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Zt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var sn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function lv(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function jy(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(zi)||[]).forEach(function(s){var a=Lr(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:gy(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function hm(e){var t=[ra,Zt("Relationships",null,{xmlns:Ta.RELS})];return Us(e["!id"]).forEach(function(r){t[t.length]=Zt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Rn(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[sn.HLINK,sn.XPATH,sn.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var ole="application/vnd.oasis.opendocument.spreadsheet";function lle(e,t){for(var r=f3(e),n,s;n=ov.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Lr(n[0],!1),s.path=="/"&&s.type!==ole)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function cle(e){var t=[ra];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function uO(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function ule(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function dle(e){var t=[ra];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(uO(e[r][0],e[r][1])),t.push(ule("",e[r][0]));return t.push(uO("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function $$(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+z_.version+"</meta:generator></office:meta></office:document-meta>"}var jl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],fle=(function(){for(var e=new Array(jl.length),t=0;t<jl.length;++t){var r=jl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function U$(e){var t={};e=Hn(e);for(var r=0;r<jl.length;++r){var n=jl[r],s=e.match(fle[r]);s!=null&&s.length>0&&(t[n[1]]=xn(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=ls(t[n[1]]))}return t}function Ek(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Ln(t),n[n.length]=r?Zt(e,t,r):pi(e,t))}function z$(e,t){var r=t||{},n=[ra,Zt("cp:coreProperties",null,{"xmlns:cp":Ta.CORE_PROPS,"xmlns:dc":Ta.dc,"xmlns:dcterms":Ta.dcterms,"xmlns:dcmitype":Ta.dcmitype,"xmlns:xsi":Ta.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Ek("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:xE(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Ek("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:xE(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=jl.length;++a){var i=jl[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Ek(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Yh=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],W$=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function H$(e,t,r,n){var s=[];if(typeof e=="string")s=eO(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?eO(t,n).map(function(d){return d.v}):t,o=0,c=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function hle(e,t,r){var n={};return t||(t={}),e=Hn(e),Yh.forEach(function(s){var a=(e.match(av(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=xn(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&H$(n.HeadingPairs,n.TitlesOfParts,t,r),t}function G$(e){var t=[],r=Zt;return e||(e={}),e.Application="SheetJS",t[t.length]=ra,t[t.length]=Zt("Properties",null,{xmlns:Ta.EXT_PROPS,"xmlns:vt":Ta.vt}),Yh.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Ln(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ln(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var gle=/<[^>]+>[^<]*/g;function mle(e,t){var r={},n="",s=e.match(gle);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Lr(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=xn(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=xn(d);break;case"bool":r[n]=as(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=ls(d);break;case"cy":case"error":r[n]=xn(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function V$(e){var t=[ra,Zt("Properties",null,{xmlns:Ta.CUST_PROPS,"xmlns:vt":Ta.vt})];if(!e)return t.join("");var r=1;return Us(e).forEach(function(s){++r,t[t.length]=Zt("property",koe(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ln(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var bE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Nk;function ple(e,t,r){Nk||(Nk=d2(bE)),t=Nk[t]||t,e[t]=r}function xle(e,t){var r=[];return Us(bE).map(function(n){for(var s=0;s<jl.length;++s)if(jl[s][1]==n)return jl[s];for(s=0;s<Yh.length;++s)if(Yh[s][1]==n)return Yh[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(pi(bE[n[1]]||n[1],s))}}),Zt("DocumentProperties",r.join(""),{xmlns:Go.o})}function yle(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Us(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<jl.length;++i)if(a==jl[i][1])return;for(i=0;i<Yh.length;++i)if(a==Yh[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(Zt(XF(a),o,{"dt:dt":c}))}}),t&&Us(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Zt(XF(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Go.o+'">'+s.join("")+"</"+n+">"}function S3(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vle(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=St(8);return i.write_shift(4,n),i.write_shift(4,s),i}function K$(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function q$(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Y$(e,t,r){return t===31?q$(e):K$(e,t,r)}function SE(e,t,r){return Y$(e,t,r===!1?0:4)}function wle(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Y$(e,t,0)}function _le(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(oo,""),e.l-s&2&&(e.l+=2)}return r}function ble(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(oo,"");return r}function Sle(e){var t=e.l,r=Q_(e,M$);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Q_(e,bo);return[r,n]}function kle(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Sle(e));return r}function dO(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(oo,"").replace(hy,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function X$(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Cle(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Q_(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==lO&&n!==t&&rle.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===lO?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return K$(e,n,4).replace(oo,"");case 31:return q$(e);case 64:return S3(e);case 65:return X$(e);case 71:return Cle(e);case 80:return SE(e,n,!a.raw).replace(oo,"");case 81:return wle(e,n).replace(oo,"");case 4108:return kle(e);case 4126:case 4127:return n==4127?_le(e):ble(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function fO(e,t){var r=St(4),n=St(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=St(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=vle(t);break;case 31:case 80:for(n=St(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ha([r,n])}function hO(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,u={};for(i=0;i!=s;++i){var d=e.read_shift(4),f=e.read_shift(4);a[i]=[d,f+r]}a.sort(function(k,_){return k[1]-_[1]});var g={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(g[x.n]=Q_(e,x.t,{raw:!0}),x.p==="version"&&(g[x.n]=String(g[x.n]>>16)+"."+("0000"+String(g[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(g[x.n]){case 0:g[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:uc(o=g[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[x.n])}}else if(a[i][0]===1){if(o=g.CodePage=Q_(e,_3),uc(o),c!==-1){var v=e.l;e.l=a[c][1],u=dO(e,o),e.l=v}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}u=dO(e,o)}else{var w=u[a[i][0]],C;switch(e[e.l]){case 65:e.l+=4,C=X$(e);break;case 30:e.l+=4,C=SE(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=SE(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=Qs(e,4);break;case 64:e.l+=4,C=ls(S3(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[w]=C}}return e.l=r+n,g}var Q$=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Tle(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function gO(e,t,r){var n=St(8),s=[],a=[],i=8,o=0,c=St(8),u=St(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),i+=8+c.length,!t){u=St(8),u.write_shift(4,0),s.unshift(u);var d=[St(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=St(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Ha(d),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Q$.indexOf(e[o][0])>-1||W$.indexOf(e[o][0])>-1)&&e[o][1]!=null){var g=e[o][1],p=0;if(t){p=+t[e[o][0]];var x=r[p];if(x.p=="version"&&typeof g=="string"){var v=g.split(".");g=(+v[0]<<16)+(+v[1]||0)}c=fO(x.t,g)}else{var w=Tle(g);w==-1&&(w=31,g=String(g)),c=fO(w,g)}a.push(c),u=St(8),u.write_shift(4,t?p:2+o),s.push(u),i+=8+c.length}var C=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,C),C+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),Ha([n].concat(s).concat(a))}function mO(e,t,r){var n=e.content;if(!n)return{};fi(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Tr.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var f=hO(n,t),g={SystemIdentifier:u};for(var p in f)g[p]=f[p];if(g.FMTID=a,s===1)return g;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=hO(n,null)}catch{}for(p in x)g[p]=x[p];return g.FMTID=[a,i],g}function pO(e,t,r,n,s,a){var i=St(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Tr.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=gO(e,r,n);if(o.push(c),s){var u=gO(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(u)}return Ha(o)}function lf(e,t){return e.read_shift(t),null}function Ele(e,t){t||(t=St(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Nle(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Qs(e,t){return e.read_shift(t)===1}function ro(e,t){return t||(t=St(2)),t.write_shift(2,+!!e),t}function ua(e){return e.read_shift(2,"u")}function Sl(e,t){return t||(t=St(2)),t.write_shift(2,e),t}function J$(e,t){return Nle(e,t,ua)}function Ale(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Z$(e,t,r){return r||(r=St(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Xv(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function jle(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Ple(e){var t=e.t||"",r=St(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=St(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Ha(s)}function v0(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Qv(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):v0(e,n,r)}function M0(e,t,r){if(r.biff>5)return Qv(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function eU(e,t,r){return r||(r=St(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Fle(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Ole(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(oo,"");return n&&(e.l+=24),s}function Dle(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(oo,"");return r+i}function Ile(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Ole(e);case"0303000000000000c000000000000046":return Dle(e);default:throw new Error("Unsupported Moniker "+r)}}function Ow(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(oo,""):"";return r}function xO(e,t){t||(t=St(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Rle(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,u="",d,f;s&16&&(a=Ow(e,r-e.l)),s&128&&(i=Ow(e,r-e.l)),(s&257)===257&&(o=Ow(e,r-e.l)),(s&257)===1&&(c=Ile(e,r-e.l)),s&8&&(u=Ow(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(f=S3(e)),e.l=r;var g=i||o||c||"";g&&u&&(g+="#"+u),g||(g="#"+u),s&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var p={Target:g};return d&&(p.guid=d),f&&(p.time=f),a&&(p.Tooltip=a),p}function Mle(e){var t=St(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),xO(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&xO(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function tU(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function rU(e,t){var r=tU(e);return r[3]=0,r}function cu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function w0(e,t,r,n){return n||(n=St(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Lle(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Ble(e,t,r){return t===0?"":M0(e,t,r)}function $le(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function nU(e){var t=e.read_shift(2),r=w3(e);return[t,r]}function Ule(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Xv(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function g2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function sU(e,t){return t||(t=St(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function aU(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var zle=aU;function iU(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Wle(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Hle(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ni(e){e.l+=2,e.l+=e.read_shift(2)}var Gle={0:Ni,4:Ni,5:Ni,6:Ni,7:Hle,8:Ni,9:Ni,10:Ni,11:Ni,12:Ni,13:Wle,14:Ni,15:Ni,16:Ni,17:Ni,18:Ni,19:Ni,20:Ni,21:iU};function Vle(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(Gle[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Dw(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function k3(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=St(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Kle(e,t){return t===0||e.read_shift(2),1200}function qle(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=M0(e,0,r);return e.read_shift(t+n-e.l),s}function Yle(e,t){var r=!t||t.biff==8,n=St(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Xle(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Qle(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Xv(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function Jle(e,t){var r=!t||t.biff>=8?2:1,n=St(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function Zle(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(jle(e));return a.Count=n,a.Unique=s,a}function ece(e,t){var r=St(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=Ple(e[s]);var a=Ha([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function tce(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function rce(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function nce(e){var t=Lle(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function sce(e){return e.read_shift(2),e.read_shift(4)}function yO(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function ace(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function ice(){var e=St(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function oce(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function lce(e){var t=St(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function cce(){}function uce(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Xv(e,0,r),n}function dce(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=St(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function fce(e){var t=cu(e);return t.isst=e.read_shift(4),t}function hce(e,t,r,n){var s=St(10);return w0(e,t,n,s),s.write_shift(4,r),s}function gce(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=cu(e);r.biff==2&&e.l++;var a=Qv(e,n-e.l,r);return s.val=a,s}function mce(e,t,r,n,s){var a=!s||s.biff==8,i=St(8+ +a+(1+a)*r.length);return w0(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function pce(e,t,r){var n=e.read_shift(2),s=M0(e,0,r);return[n,s]}function xce(e,t,r,n){var s=r&&r.biff==5;n||(n=St(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var yce=M0;function vO(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function vce(e,t){var r=t.biff==8||!t.biff?4:2,n=St(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function wce(e){var t=e.read_shift(2),r=e.read_shift(2),n=nU(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function _ce(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(nU(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function bce(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function Sce(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=nle[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function kce(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Sce(e,t,n.fStyle,r),n}function wO(e,t,r,n){var s=r&&r.biff==5;n||(n=St(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function Cce(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Tce(e){var t=St(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function _O(e,t,r){var n=cu(e);(r.biff==2||t==9)&&++e.l;var s=Ale(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function Ece(e,t,r,n,s,a){var i=St(8);return w0(e,t,n,i),Z$(r,a,i),i}function Nce(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=cu(e),s=Ii(e);return n.val=s,n}function Ace(e,t,r,n){var s=St(14);return w0(e,t,n,s),y0(r,s),s}var bO=Ble;function jce(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=v0(e,a),o=[];n>e.l;)o.push(Qv(e));return[a,s,i,o]}function SO(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=Ule(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var Pce=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function kO(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=v0(e,i,r);s&32&&(u=Pce[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:Vhe(e,d,r,o);return{chKey:a,Name:u,itab:c,rgce:f}}function oU(e,t,r){if(r.biff<8)return Fce(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push($le(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function Fce(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Xv(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Oce(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=v0(e,n,r),i=v0(e,s,r);return[a,i]}function Dce(e,t,r){var n=aU(e);e.l++;var s=e.read_shift(1);return t-=8,[Khe(e,t,r),s,n]}function CO(e,t,r){var n=zle(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Hhe(e,t,r)]}function Ice(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Rce(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=M0(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function Mce(e,t,r){return Rce(e,t,r)}function Lce(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(g2(e));return r}function Bce(e){var t=St(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)sU(e[r],t);return t}function $ce(e,t,r){if(r&&r.biff<8)return zce(e,t,r);var n=iU(e),s=Vle(e,t-22,n[1]);return{cmo:n,ft:s}}var Uce={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function zce(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Uce[n]||Ui)(e,t,r)),{cmo:[s,n,a],ft:i}}function Wce(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=Fle(e,6,r);var o=e.read_shift(2);e.read_shift(2),ua(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=v0(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Hce(e,t){var r=g2(e);e.l+=16;var n=Rle(e,t-24);return[r,n]}function Gce(e){var t=St(24),r=ks(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Ha([t,Mle(e[1])])}function Vce(e,t){e.read_shift(2);var r=g2(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(oo,""),[r,n]}function Kce(e){var t=e[1].Tooltip,r=St(10+2*(t.length+1));r.write_shift(2,2048);var n=ks(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function qce(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=cO[r]||r,r=e.read_shift(2),t[1]=cO[r]||r,t}function Yce(e){return e||(e=St(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Xce(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(rU(e));return r}function Qce(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(rU(e));return r}function Jce(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function lU(e,t,r){if(!r.cellStyles)return Ui(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function Zce(e,t){var r=St(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function eue(e,t){var r={};return t<32||(e.l+=16,r.header=Ii(e),r.footer=Ii(e),e.l+=2),r}function tue(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function rue(e){for(var t=St(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var nue=cu,sue=J$,aue=Qv;function iue(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function oue(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=cu(e);++e.l;var s=M0(e,t-7,r);return n.t="str",n.val=s,n}function lue(e){var t=cu(e);++e.l;var r=Ii(e);return t.t="n",t.val=r,t}function cue(e,t,r){var n=St(15);return t1(n,e,t),n.write_shift(8,r,"f"),n}function uue(e){var t=cu(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function due(e,t,r){var n=St(9);return t1(n,e,t),n.write_shift(2,r),n}function fue(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function hue(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function gue(e,t,r){var n=e.l+t,s=cu(e),a=e.read_shift(2),i=v0(e,a,r);return e.l=n,s.t="str",s.val=i,s}var mue=[2,3,48,49,131,139,140,245],kE=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=d2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=jf(1);switch(c.type){case"base64":d=qo(Zo(o));break;case"binary":d=qo(o);break;case"buffer":case"array":d=o;break}fi(d,0);var f=d.read_shift(1),g=!!(f&136),p=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,g=!0;break;case 49:p=!0,g=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var v=0,w=521;f==2&&(v=d.read_shift(2)),d.l+=3,f!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),f!=2&&(w=d.read_shift(2));var C=d.read_shift(2),k=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(k=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var _=[],N={},E=Math.min(d.length,f==2?521:w-10-(p?264:0)),P=x?32:11;d.l<E&&d[d.l]!=13;)switch(N={},N.name=rv.utils.decode(k,d.slice(d.l,d.l+P)).replace(/[\u0000\r\n].*$/g,""),d.l+=P,N.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),f==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&_.push(N),f!=2&&(d.l+=x?13:14),N.type){case"B":(!p||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var F=0,A=0;for(u[0]=[],A=0;A!=_.length;++A)u[0][A]=_[A].name;for(;v-- >0;){if(d[d.l]===42){d.l+=C;continue}for(++d.l,u[++F]=[],A=0,A=0;A!=_.length;++A){var j=d.slice(d.l,d.l+_[A].len);d.l+=_[A].len,fi(j,0);var I=rv.utils.decode(k,j);switch(_[A].type){case"C":I.trim().length&&(u[F][A]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[F][A]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[F][A]=I;break;case"F":u[F][A]=parseFloat(I.trim());break;case"+":case"I":u[F][A]=x?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[F][A]=!0;break;case"N":case"F":u[F][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[F][A]="##MEMO##"+(x?parseInt(I.trim(),10):j.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[F][A]=+I||0);break;case"@":u[F][A]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":u[F][A]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":u[F][A]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[F][A]=-j.read_shift(-8,"f");break;case"B":if(p&&_[A].len==8){u[F][A]=j.read_shift(8,"f");break}case"G":case"P":j.l+=_[A].len;break;case"0":if(_[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[A].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=_,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=rp(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(o,c){try{return Wf(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&uc(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Ao(),f=eb(o,{header:1,raw:!0,cellDates:!0}),g=f[0],p=f.slice(1),x=o["!cols"]||[],v=0,w=0,C=0,k=1;for(v=0;v<g.length;++v){if(((x[v]||{}).DBF||{}).name){g[v]=x[v].DBF.name,++C;continue}if(g[v]!=null){if(++C,typeof g[v]=="number"&&(g[v]=g[v].toString(10)),typeof g[v]!="string")throw new Error("DBF Invalid column name "+g[v]+" |"+typeof g[v]+"|");if(g.indexOf(g[v])!==v){for(w=0;w<1024;++w)if(g.indexOf(g[v]+"_"+w)==-1){g[v]+="_"+w;break}}}}var _=yn(o["!ref"]),N=[],E=[],P=[];for(v=0;v<=_.e.c-_.s.c;++v){var F="",A="",j=0,I=[];for(w=0;w<p.length;++w)p[w][v]!=null&&I.push(p[w][v]);if(I.length==0||g[v]==null){N[v]="?";continue}for(w=0;w<I.length;++w){switch(typeof I[w]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=I[w]instanceof Date?"D":"C";break;default:A="C"}j=Math.max(j,String(I[w]).length),F=F&&F!=A?"C":A}j>250&&(j=250),A=((x[v]||{}).DBF||{}).type,A=="C"&&x[v].DBF.len>j&&(j=x[v].DBF.len),F=="B"&&A=="N"&&(F="N",P[v]=x[v].DBF.dec,j=x[v].DBF.len),E[v]=F=="C"||A=="N"?j:a[F]||0,k+=E[v],N[v]=F}var B=d.next(32);for(B.write_shift(4,318902576),B.write_shift(4,p.length),B.write_shift(2,296+32*C),B.write_shift(2,k),v=0;v<4;++v)B.write_shift(4,0);for(B.write_shift(4,0|(+t[QB]||3)<<8),v=0,w=0;v<g.length;++v)if(g[v]!=null){var Y=d.next(32),Z=(g[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,Z,"sbcs"),Y.write_shift(1,N[v]=="?"?"C":N[v],"sbcs"),Y.write_shift(4,w),Y.write_shift(1,E[v]||a[N[v]]||0),Y.write_shift(1,P[v]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),w+=E[v]||a[N[v]]||0}var se=d.next(264);for(se.write_shift(4,13),v=0;v<65;++v)se.write_shift(4,0);for(v=0;v<p.length;++v){var ee=d.next(k);for(ee.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(N[w]){case"L":ee.write_shift(1,p[v][w]==null?63:p[v][w]?84:70);break;case"B":ee.write_shift(8,p[v][w]||0,"f");break;case"N":var te="0";for(typeof p[v][w]=="number"&&(te=p[v][w].toFixed(P[w]||0)),C=0;C<E[w]-te.length;++C)ee.write_shift(1,32);ee.write_shift(1,te,"sbcs");break;case"D":p[v][w]?(ee.write_shift(4,("0000"+p[v][w].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(p[v][w].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+p[v][w].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var L=String(p[v][w]!=null?p[v][w]:"").slice(0,E[w]);for(ee.write_shift(1,L,"sbcs"),C=0;C<E[w]-L.length;++C)ee.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),cU=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Us(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,p){var x=e[p];return typeof x=="number"?RF(x):x},n=function(g,p,x){var v=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?g:RF(v)};e["|"]=254;function s(g,p){switch(p.type){case"base64":return a(Zo(g),p);case"binary":return a(g,p);case"buffer":return a(en&&Buffer.isBuffer(g)?g.toString("binary"):zf(g),p);case"array":return a(x0(g),p)}throw new Error("Unrecognized type "+p.type)}function a(g,p){var x=g.split(/[\n\r]+/),v=-1,w=-1,C=0,k=0,_=[],N=[],E=null,P={},F=[],A=[],j=[],I=0,B;for(+p.codepage>=0&&uc(+p.codepage);C!==x.length;++C){I=0;var Y=x[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Z=Y.replace(/;;/g,"\0").split(";").map(function(Q){return Q.replace(/\u0000/g,";")}),se=Z[0],ee;if(Y.length>0)switch(se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&N.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,L=!1,V=!1,M=!1,H=-1,W=-1;for(k=1;k<Z.length;++k)switch(Z[k].charAt(0)){case"A":break;case"X":w=parseInt(Z[k].slice(1))-1,L=!0;break;case"Y":for(v=parseInt(Z[k].slice(1))-1,L||(w=0),B=_.length;B<=v;++B)_[B]=[];break;case"K":ee=Z[k].slice(1),ee.charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(hc(ee))?isNaN(Em(ee).getDate())||(ee=ls(ee)):(ee=hc(ee),E!==null&&ep(E)&&(ee=h2(ee))),te=!0;break;case"E":M=!0;var R=gm(Z[k].slice(1),{r:v,c:w});_[v][w]=[_[v][w],R];break;case"S":V=!0,_[v][w]=[_[v][w],"S5S"];break;case"G":break;case"R":H=parseInt(Z[k].slice(1))-1;break;case"C":W=parseInt(Z[k].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}if(te&&(_[v][w]&&_[v][w].length==2?_[v][w][0]=ee:_[v][w]=ee,E=null),V){if(M)throw new Error("SYLK shared formula cannot have own formula");var z=H>-1&&_[H][W];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");_[v][w][1]=EU(z[1],{r:v-H,c:w-W})}break;case"F":var K=0;for(k=1;k<Z.length;++k)switch(Z[k].charAt(0)){case"X":w=parseInt(Z[k].slice(1))-1,++K;break;case"Y":for(v=parseInt(Z[k].slice(1))-1,B=_.length;B<=v;++B)_[B]=[];break;case"M":I=parseInt(Z[k].slice(1))/20;break;case"F":break;case"G":break;case"P":E=N[parseInt(Z[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=Z[k].slice(1).split(" "),B=parseInt(j[0],10);B<=parseInt(j[1],10);++B)I=parseInt(j[2],10),A[B-1]=I===0?{hidden:!0}:{wch:I},Pf(A[B-1]);break;case"C":w=parseInt(Z[k].slice(1))-1,A[w]||(A[w]={});break;case"R":v=parseInt(Z[k].slice(1))-1,F[v]||(F[v]={}),I>0?(F[v].hpt=I,F[v].hpx=Am(I)):I===0&&(F[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}K<1&&(E=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}}return F.length>0&&(P["!rows"]=F),A.length>0&&(P["!cols"]=A),p&&p.sheetRows&&(_=_.slice(0,p.sheetRows)),[_,P]}function i(g,p){var x=s(g,p),v=x[0],w=x[1],C=rp(v,p);return Us(w).forEach(function(k){C[k]=w[k]}),C}function o(g,p){return Wf(i(g,p),p)}function c(g,p,x,v){var w="C;Y"+(x+1)+";X"+(v+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+j3(g.f,{r:x,c:v}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(g,p){p.forEach(function(x,v){var w="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=uv(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=dv(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function d(g,p){p.forEach(function(x,v){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*fv(x.hpx)+";"),w.length>2&&g.push(w+"R"+(v+1))})}function f(g,p){var x=["ID;PWXL;N;E"],v=[],w=yn(g["!ref"]),C,k=Array.isArray(g),_=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),g["!cols"]&&u(x,g["!cols"]),g["!rows"]&&d(x,g["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var E=w.s.c;E<=w.e.c;++E){var P=Rr({r:N,c:E});C=k?(g[N]||[])[E]:g[P],!(!C||C.v==null&&(!C.f||C.F))&&v.push(c(C,g,N,E))}return x.join(_)+_+v.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:i,from_sheet:f}})(),uU=(function(){function e(a,i){switch(i.type){case"base64":return t(Zo(a),i);case"binary":return t(a,i);case"buffer":return t(en&&Buffer.isBuffer(a)?a.toString("binary"):zf(a),i);case"array":return t(x0(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var g=o[d].trim().split(","),p=g[0],x=g[1];++d;for(var v=o[d]||"";(v.match(/["]/g)||[]).length&1&&d<o.length-1;)v+=`
`+o[++d];switch(v=v.trim(),+p){case-1:if(v==="BOT"){f[++c]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?f[c][u]=!0:v==="FALSE"?f[c][u]=!1:isNaN(hc(x))?isNaN(Em(x).getDate())?f[c][u]=x:f[c][u]=ls(x):f[c][u]=hc(x),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),f[c][u++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(a,i){return rp(e(a,i),i)}function n(a,i){return Wf(r(a,i),i)}var s=(function(){var a=function(c,u,d,f,g){c.push(u),c.push(d+","+f),c.push('"'+g.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=yn(c["!ref"]),f,g=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var v=Rr({r:p,c:x});if(f=g?(c[p]||[])[x]:c[v],!f){i(u,1,0,"");continue}switch(f.t){case"n":var w=f.w;!w&&f.v!=null&&(w=f.v),w==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,w,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Ol(f.z||Dr[14],Na(ls(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var C=`\r
`,k=u.join(C);return k}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),dU=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,g){for(var p=f.split(`
`),x=-1,v=-1,w=0,C=[];w!==p.length;++w){var k=p[w].trim().split(":");if(k[0]==="cell"){var _=ks(k[1]);if(C.length<=_.r)for(x=C.length;x<=_.r;++x)C[x]||(C[x]=[]);switch(x=_.r,v=_.c,k[2]){case"t":C[x][v]=e(k[3]);break;case"v":C[x][v]=+k[3];break;case"vtf":var N=k[k.length-1];case"vtc":switch(k[3]){case"nl":C[x][v]=!!+k[4];break;default:C[x][v]=+k[4];break}k[2]=="vtf"&&(C[x][v]=[C[x][v],N])}}}return g&&g.sheetRows&&(C=C.slice(0,g.sheetRows)),C}function n(f,g){return rp(r(f,g),g)}function s(f,g){return Wf(n(f,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var g=[],p=[],x,v="",w=jo(f["!ref"]),C=Array.isArray(f),k=w.s.r;k<=w.e.r;++k)for(var _=w.s.c;_<=w.e.c;++_)if(v=Rr({r:k,c:_}),x=C?(f[k]||[])[_]:f[v],!(!x||x.v==null||x.t==="z")){switch(p=["cell",v,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=Na(ls(x.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=x.w||Ol(x.z||Dr[14],N);break;case"e":continue}g.push(p.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(f){return[a,i,o,i,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}})(),Nm=(function(){function e(d,f,g,p,x){x.raw?f[g][p]=d:d===""||(d==="TRUE"?f[g][p]=!0:d==="FALSE"?f[g][p]=!1:isNaN(hc(d))?isNaN(Em(d).getDate())?f[g][p]=d:f[g][p]=ls(d):f[g][p]=hc(d))}function t(d,f){var g=f||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var w=10,C=0,k=0;k<=v;++k)C=x[k].indexOf(" "),C==-1?C=x[k].length:C++,w=Math.max(w,C);for(k=0;k<=v;++k){p[k]=[];var _=0;for(e(x[k].slice(0,w).trim(),p,k,_,g),_=1;_<=(x[k].length-w)/10+1;++_)e(x[k].slice(w+(_-1)*10,w+_*10).trim(),p,k,_,g)}return g.sheetRows&&(p=p.slice(0,g.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},g=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?g=!g:!g&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p]);if(!x.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p])}return x.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),r[x.pop()[1]]||44}function a(d,f){var g=f||{},p="",x=g.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):g&&g.FS?p=g.FS:p=s(d.slice(0,1024));var w=0,C=0,k=0,_=0,N=0,E=p.charCodeAt(0),P=!1,F=0,A=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var j=g.dateNF!=null?toe(g.dateNF):null;function I(){var B=d.slice(_,N),Y={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)Y.t="z";else if(g.raw)Y.t="s",Y.v=B;else if(B.trim().length===0)Y.t="s",Y.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(Y.t="s",Y.v=B.slice(2,-1).replace(/""/g,'"')):jfe(B)?(Y.t="n",Y.f=B.slice(1)):(Y.t="s",Y.v=B);else if(B=="TRUE")Y.t="b",Y.v=!0;else if(B=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(k=hc(B)))Y.t="n",g.cellText!==!1&&(Y.w=B),Y.v=k;else if(!isNaN(Em(B).getDate())||j&&B.match(j)){Y.z=g.dateNF||Dr[14];var Z=0;j&&B.match(j)&&(B=roe(B,g.dateNF,B.match(j)||[]),Z=1),g.cellDates?(Y.t="d",Y.v=ls(B,Z)):(Y.t="n",Y.v=Na(ls(B,Z))),g.cellText!==!1&&(Y.w=Ol(Y.z,Y.v instanceof Date?Na(Y.v):Y.v)),g.cellNF||delete Y.z}else Y.t="s",Y.v=B;if(Y.t=="z"||(g.dense?(x[w]||(x[w]=[]),x[w][C]=Y):x[Rr({c:C,r:w})]=Y),_=N+1,A=d.charCodeAt(_),v.e.c<C&&(v.e.c=C),v.e.r<w&&(v.e.r=w),F==E)++C;else if(C=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;N<d.length;++N)switch(F=d.charCodeAt(N)){case 34:A===34&&(P=!P);break;case E:case 10:case 13:if(!P&&I())break e;break}return N-_>0&&I(),x["!ref"]=Jr(v),x}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):rp(t(d,f),f)}function o(d,f){var g="",p=f.type=="string"?[0,0,0,0]:L3(d,f);switch(f.type){case"base64":g=Zo(d);break;case"binary":g=d;break;case"buffer":f.codepage==65001?g=d.toString("utf8"):f.codepage&&typeof rv<"u"||(g=en&&Buffer.isBuffer(d)?d.toString("binary"):zf(d));break;case"array":g=x0(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?g=Hn(g.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?g=Hn(g):f.type=="binary"&&typeof rv<"u",g.slice(0,19)=="socialcalc:version:"?dU.to_sheet(f.type=="string"?g:Hn(g),f):i(g,f)}function c(d,f){return Wf(o(d,f),f)}function u(d){for(var f=[],g=yn(d["!ref"]),p,x=Array.isArray(d),v=g.s.r;v<=g.e.r;++v){for(var w=[],C=g.s.c;C<=g.e.c;++C){var k=Rr({r:v,c:C});if(p=x?(d[v]||[])[C]:d[k],!p||p.v==null){w.push("          ");continue}for(var _=(p.w||(od(p),p.w)||"").slice(0,10);_.length<10;)_+=" ";w.push(_+(C===0?" ":""))}f.push(w.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}})();function pue(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=cU.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Nm.to_workbook(e,t)}}var Xh=(function(){function e(R,z,K){if(R){fi(R,R.l||0);for(var Q=K.Enum||H;R.l<R.length;){var ae=R.read_shift(2),X=Q[ae]||Q[65535],ie=R.read_shift(2),le=R.l+ie,ce=X.f&&X.f(R,ie,K);if(R.l=le,z(ce,X,ae))return}}}function t(R,z){switch(z.type){case"base64":return r(qo(Zo(R)),z);case"binary":return r(qo(R),z);case"buffer":case"array":return r(R,z)}throw"Unsupported type "+z.type}function r(R,z){if(!R)return R;var K=z||{},Q=K.dense?[]:{},ae="Sheet1",X="",ie=0,le={},ce=[],_e=[],ne={s:{r:0,c:0},e:{r:0,c:0}},pe=K.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)K.Enum=H,e(R,function(Le,At,et){switch(et){case 0:K.vers=Le,Le>=4096&&(K.qpro=!0);break;case 6:ne=Le;break;case 204:Le&&(X=Le);break;case 222:X=Le;break;case 15:case 51:K.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:et==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=K.dateNF||Dr[14],K.cellDates&&(Le[1].t="d",Le[1].v=h2(Le[1].v))),K.qpro&&Le[3]>ie&&(Q["!ref"]=Jr(ne),le[ae]=Q,ce.push(ae),Q=K.dense?[]:{},ne={s:{r:0,c:0},e:{r:0,c:0}},ie=Le[3],ae=X||"Sheet"+(ie+1),X="");var pt=K.dense?(Q[Le[0].r]||[])[Le[0].c]:Q[Rr(Le[0])];if(pt){pt.t=Le[1].t,pt.v=Le[1].v,Le[1].z!=null&&(pt.z=Le[1].z),Le[1].f!=null&&(pt.f=Le[1].f);break}K.dense?(Q[Le[0].r]||(Q[Le[0].r]=[]),Q[Le[0].r][Le[0].c]=Le[1]):Q[Rr(Le[0])]=Le[1];break}},K);else if(R[2]==26||R[2]==14)K.Enum=W,R[2]==14&&(K.qpro=!0,R.l=0),e(R,function(Le,At,et){switch(et){case 204:ae=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>ie&&(Q["!ref"]=Jr(ne),le[ae]=Q,ce.push(ae),Q=K.dense?[]:{},ne={s:{r:0,c:0},e:{r:0,c:0}},ie=Le[3],ae="Sheet"+(ie+1)),pe>0&&Le[0].r>=pe)break;K.dense?(Q[Le[0].r]||(Q[Le[0].r]=[]),Q[Le[0].r][Le[0].c]=Le[1]):Q[Rr(Le[0])]=Le[1],ne.e.c<Le[0].c&&(ne.e.c=Le[0].c),ne.e.r<Le[0].r&&(ne.e.r=Le[0].r);break;case 27:Le[14e3]&&(_e[Le[14e3][0]]=Le[14e3][1]);break;case 1537:_e[Le[0]]=Le[1],Le[0]==ie&&(ae=Le[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(Q["!ref"]=Jr(ne),le[X||ae]=Q,ce.push(X||ae),!_e.length)return{SheetNames:ce,Sheets:le};for(var Ce={},Ae=[],Ge=0;Ge<_e.length;++Ge)le[ce[Ge]]?(Ae.push(_e[Ge]||ce[Ge]),Ce[_e[Ge]]=le[_e[Ge]]||le[ce[Ge]]):(Ae.push(_e[Ge]),Ce[_e[Ge]]={"!ref":"A1"});return{SheetNames:Ae,Sheets:Ce}}function n(R,z){var K=z||{};if(+K.codepage>=0&&uc(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var Q=Ao(),ae=yn(R["!ref"]),X=Array.isArray(R),ie=[];er(Q,0,a(1030)),er(Q,6,c(ae));for(var le=Math.min(ae.e.r,8191),ce=ae.s.r;ce<=le;++ce)for(var _e=ea(ce),ne=ae.s.c;ne<=ae.e.c;++ne){ce===ae.s.r&&(ie[ne]=Ss(ne));var pe=ie[ne]+_e,Ce=X?(R[ce]||[])[ne]:R[pe];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?er(Q,13,p(ce,ne,Ce.v)):er(Q,14,v(ce,ne,Ce.v));else{var Ae=od(Ce);er(Q,15,f(ce,ne,Ae.slice(0,239)))}}return er(Q,1),Q.end()}function s(R,z){var K=z||{};if(+K.codepage>=0&&uc(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var Q=Ao();er(Q,0,i(R));for(var ae=0,X=0;ae<R.SheetNames.length;++ae)(R.Sheets[R.SheetNames[ae]]||{})["!ref"]&&er(Q,27,M(R.SheetNames[ae],X++));var ie=0;for(ae=0;ae<R.SheetNames.length;++ae){var le=R.Sheets[R.SheetNames[ae]];if(!(!le||!le["!ref"])){for(var ce=yn(le["!ref"]),_e=Array.isArray(le),ne=[],pe=Math.min(ce.e.r,8191),Ce=ce.s.r;Ce<=pe;++Ce)for(var Ae=ea(Ce),Ge=ce.s.c;Ge<=ce.e.c;++Ge){Ce===ce.s.r&&(ne[Ge]=Ss(Ge));var Le=ne[Ge]+Ae,At=_e?(le[Ce]||[])[Ge]:le[Le];if(!(!At||At.t=="z"))if(At.t=="n")er(Q,23,I(Ce,Ge,ie,At.v));else{var et=od(At);er(Q,22,F(Ce,Ge,ie,et.slice(0,239)))}}++ie}}return er(Q,1),Q.end()}function a(R){var z=St(2);return z.write_shift(2,R),z}function i(R){var z=St(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var K=0,Q=0,ae=0,X=0;X<R.SheetNames.length;++X){var ie=R.SheetNames[X],le=R.Sheets[ie];if(!(!le||!le["!ref"])){++ae;var ce=jo(le["!ref"]);K<ce.e.r&&(K=ce.e.r),Q<ce.e.c&&(Q=ce.e.c)}}return K>8191&&(K=8191),z.write_shift(2,K),z.write_shift(1,ae),z.write_shift(1,Q),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(R,z,K){var Q={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&K.qpro?(Q.s.c=R.read_shift(1),R.l++,Q.s.r=R.read_shift(2),Q.e.c=R.read_shift(1),R.l++,Q.e.r=R.read_shift(2),Q):(Q.s.c=R.read_shift(2),Q.s.r=R.read_shift(2),z==12&&K.qpro&&(R.l+=2),Q.e.c=R.read_shift(2),Q.e.r=R.read_shift(2),z==12&&K.qpro&&(R.l+=2),Q.s.c==65535&&(Q.s.c=Q.e.c=Q.s.r=Q.e.r=0),Q)}function c(R){var z=St(8);return z.write_shift(2,R.s.c),z.write_shift(2,R.s.r),z.write_shift(2,R.e.c),z.write_shift(2,R.e.r),z}function u(R,z,K){var Q=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(Q[0].c=R.read_shift(1),Q[3]=R.read_shift(1),Q[0].r=R.read_shift(2),R.l+=2):(Q[2]=R.read_shift(1),Q[0].c=R.read_shift(2),Q[0].r=R.read_shift(2)),Q}function d(R,z,K){var Q=R.l+z,ae=u(R,z,K);if(ae[1].t="s",K.vers==20768){R.l++;var X=R.read_shift(1);return ae[1].v=R.read_shift(X,"utf8"),ae}return K.qpro&&R.l++,ae[1].v=R.read_shift(Q-R.l,"cstr"),ae}function f(R,z,K){var Q=St(7+K.length);Q.write_shift(1,255),Q.write_shift(2,z),Q.write_shift(2,R),Q.write_shift(1,39);for(var ae=0;ae<Q.length;++ae){var X=K.charCodeAt(ae);Q.write_shift(1,X>=128?95:X)}return Q.write_shift(1,0),Q}function g(R,z,K){var Q=u(R,z,K);return Q[1].v=R.read_shift(2,"i"),Q}function p(R,z,K){var Q=St(7);return Q.write_shift(1,255),Q.write_shift(2,z),Q.write_shift(2,R),Q.write_shift(2,K,"i"),Q}function x(R,z,K){var Q=u(R,z,K);return Q[1].v=R.read_shift(8,"f"),Q}function v(R,z,K){var Q=St(13);return Q.write_shift(1,255),Q.write_shift(2,z),Q.write_shift(2,R),Q.write_shift(8,K,"f"),Q}function w(R,z,K){var Q=R.l+z,ae=u(R,z,K);if(ae[1].v=R.read_shift(8,"f"),K.qpro)R.l=Q;else{var X=R.read_shift(2);N(R.slice(R.l,R.l+X),ae),R.l+=X}return ae}function C(R,z,K){var Q=z&32768;return z&=-32769,z=(Q?R:0)+(z>=8192?z-16384:z),(Q?"":"$")+(K?Ss(z):ea(z))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(R,z){fi(R,0);for(var K=[],Q=0,ae="",X="",ie="",le="";R.l<R.length;){var ce=R[R.l++];switch(ce){case 0:K.push(R.read_shift(8,"f"));break;case 1:X=C(z[0].c,R.read_shift(2),!0),ae=C(z[0].r,R.read_shift(2),!1),K.push(X+ae);break;case 2:{var _e=C(z[0].c,R.read_shift(2),!0),ne=C(z[0].r,R.read_shift(2),!1);X=C(z[0].c,R.read_shift(2),!0),ae=C(z[0].r,R.read_shift(2),!1),K.push(_e+ne+":"+X+ae)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(R.read_shift(2));break;case 6:{for(var pe="";ce=R[R.l++];)pe+=String.fromCharCode(ce);K.push('"'+pe.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:le=K.pop(),ie=K.pop(),K.push(["AND","OR"][ce-20]+"("+ie+","+le+")");break;default:if(ce<32&&_[ce])le=K.pop(),ie=K.pop(),K.push(ie+_[ce]+le);else if(k[ce]){if(Q=k[ce][1],Q==69&&(Q=R[R.l++]),Q>K.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+K.join("|")+"|");return}var Ce=K.slice(-Q);K.length-=Q,K.push(k[ce][0]+"("+Ce.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}K.length==1?z[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function E(R){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=R.read_shift(2),z[3]=R[R.l++],z[0].c=R[R.l++],z}function P(R,z){var K=E(R);return K[1].t="s",K[1].v=R.read_shift(z-4,"cstr"),K}function F(R,z,K,Q){var ae=St(6+Q.length);ae.write_shift(2,R),ae.write_shift(1,K),ae.write_shift(1,z),ae.write_shift(1,39);for(var X=0;X<Q.length;++X){var ie=Q.charCodeAt(X);ae.write_shift(1,ie>=128?95:ie)}return ae.write_shift(1,0),ae}function A(R,z){var K=E(R);K[1].v=R.read_shift(2);var Q=K[1].v>>1;if(K[1].v&1)switch(Q&7){case 0:Q=(Q>>3)*5e3;break;case 1:Q=(Q>>3)*500;break;case 2:Q=(Q>>3)/20;break;case 3:Q=(Q>>3)/200;break;case 4:Q=(Q>>3)/2e3;break;case 5:Q=(Q>>3)/2e4;break;case 6:Q=(Q>>3)/16;break;case 7:Q=(Q>>3)/64;break}return K[1].v=Q,K}function j(R,z){var K=E(R),Q=R.read_shift(4),ae=R.read_shift(4),X=R.read_shift(2);if(X==65535)return Q===0&&ae===3221225472?(K[1].t="e",K[1].v=15):Q===0&&ae===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var ie=X&32768;return X=(X&32767)-16446,K[1].v=(1-ie*2)*(ae*Math.pow(2,X+32)+Q*Math.pow(2,X)),K}function I(R,z,K,Q){var ae=St(14);if(ae.write_shift(2,R),ae.write_shift(1,K),ae.write_shift(1,z),Q==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var X=0,ie=0,le=0,ce=0;return Q<0&&(X=1,Q=-Q),ie=Math.log2(Q)|0,Q/=Math.pow(2,ie-31),ce=Q>>>0,(ce&2147483648)==0&&(Q/=2,++ie,ce=Q>>>0),Q-=ce,ce|=2147483648,ce>>>=0,Q*=Math.pow(2,32),le=Q>>>0,ae.write_shift(4,le),ae.write_shift(4,ce),ie+=16383+(X?32768:0),ae.write_shift(2,ie),ae}function B(R,z){var K=j(R);return R.l+=z-14,K}function Y(R,z){var K=E(R),Q=R.read_shift(4);return K[1].v=Q>>6,K}function Z(R,z){var K=E(R),Q=R.read_shift(8,"f");return K[1].v=Q,K}function se(R,z){var K=Z(R);return R.l+=z-10,K}function ee(R,z){return R[R.l+z-1]==0?R.read_shift(z,"cstr"):""}function te(R,z){var K=R[R.l++];K>z-1&&(K=z-1);for(var Q="";Q.length<K;)Q+=String.fromCharCode(R[R.l++]);return Q}function L(R,z,K){if(!(!K.qpro||z<21)){var Q=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var ae=R.read_shift(z-21,"cstr");return[Q,ae]}}function V(R,z){for(var K={},Q=R.l+z;R.l<Q;){var ae=R.read_shift(2);if(ae==14e3){for(K[ae]=[0,""],K[ae][0]=R.read_shift(2);R[R.l];)K[ae][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return K}function M(R,z){var K=St(5+R.length);K.write_shift(2,14e3),K.write_shift(2,z);for(var Q=0;Q<R.length;++Q){var ae=R.charCodeAt(Q);K[K.l++]=ae>127?95:ae}return K[K.l++]=0,K}var H={0:{n:"BOF",f:ua},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ee},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:L},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function xue(e){var t={},r=e.match(zi),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Lr(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=t3[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var yue=(function(){var e=av("t"),t=av("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:xn(i[1])},c=a.match(t);return c&&(o.s=xue(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}})(),vue=(function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),wue=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_ue=/<(?:\w+:)?r>/,bue=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function C3(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=xn(Hn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Hn(e),r&&(n.h=d3(n.t))):e.match(_ue)&&(n.r=Hn(e),n.t=xn(Hn((e.replace(bue,"").match(wue)||[]).join("").replace(zi,""))),r&&(n.h=vue(yue(n.r)))),n):{t:""}}var Sue=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kue=/<(?:\w+:)?(?:si|sstItem)>/g,Cue=/<\/(?:\w+:)?(?:si|sstItem)>/;function Tue(e,t){var r=[],n="";if(!e)return r;var s=e.match(Sue);if(s){n=s[2].replace(kue,"").split(Cue);for(var a=0;a!=n.length;++a){var i=C3(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Lr(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var Eue=/^\s|\s$|[\t\n\r]/;function fU(e,t){if(!t.bookSST)return"";var r=[ra];r[r.length]=Zt("sst",null,{xmlns:F0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(Eue)&&(a+=' xml:space="preserve"'),a+=">"+Ln(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Nue(e){return[e.read_shift(4),e.read_shift(4)]}function Aue(e,t){var r=[],n=!1;return md(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function jue(e,t){return t||(t=St(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Pue=Uoe;function Fue(e){var t=Ao();Ot(t,159,jue(e));for(var r=0;r<e.length;++r)Ot(t,19,Pue(e[r]));return Ot(t,160),t.end()}function hU(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ed(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Oue(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ed(e,4),t.U=ed(e,4),t.W=ed(e,4),t}function Due(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Iue(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Due(e));return t}function Rue(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Mue(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ed(e,4),t.U=ed(e,4),t.W=ed(e,4),t}function Lue(e){var t=Mue(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function gU(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function mU(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Bue(e){var t=ed(e);switch(t.Minor){case 2:return[t.Minor,$ue(e)];case 3:return[t.Minor,Uue()];case 4:return[t.Minor,zue(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function $ue(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=gU(e,r),s=mU(e,e.length-e.l);return{t:"Std",h:n,v:s}}function Uue(){throw new Error("File is password-protected: ECMA-376 Extensible")}function zue(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(zi,function(a){var i=Lr(a);switch(lu(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Wue(e,t){var r={},n=r.EncryptionVersionInfo=ed(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=gU(e,s),t-=s,r.EncryptionVerifier=mU(e,t),r}function Hue(e){var t={},r=t.EncryptionVersionInfo=ed(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function T3(e){var t=0,r,n=hU(e),s=n.length+1,a,i,o,c,u;for(r=jf(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=(t&16384)===0?0:1,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var pU=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(o^=r[c]),d*=2,--c;return o};return function(i){for(var o=hU(i),c=a(o),u=o.length,d=jf(16),f=0;f!=16;++f)d[f]=0;var g,p,x;for((u&1)===1&&(g=c>>8,d[u]=s(e[0],g),--u,g=c&255,p=o[o.length-1],d[u]=s(p,g));u>0;)--u,g=c>>8,d[u]=s(o[u],g),--u,g=c&255,d[u]=s(o[u],g);for(u=15,x=15-o.length;x>0;)g=c>>8,d[u]=s(e[x],g),--u,--x,g=c&255,d[u]=s(o[u],g),--u,--x;return d}})(),Gue=function(e,t,r,n,s){s||(s=t),n||(n=pU(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},Vue=function(e){var t=0,r=pU(e);return function(n){var s=Gue("",n,t,r);return t=s[1],s[0]}};function Kue(e,t,r,n){var s={key:ua(e),verificationBytes:ua(e)};return r.password&&(s.verifier=T3(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Vue(r.password)),s}function que(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Hue(e):n.Data=Wue(e,t),n}function Yue(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?que(e,t-2,n):Kue(e,r.biff>=8?t:t-2,r,n),n}var xU=(function(){function e(s,a){switch(a.type){case"base64":return t(Zo(s),a);case"binary":return t(s,a);case"buffer":return t(en&&Buffer.isBuffer(s)?s.toString("binary"):zf(s),a);case"array":return t(x0(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var g=/\\\w+\b/g,p=0,x,v=-1;x=g.exec(d);){switch(x[0]){case"\\cell":var w=d.slice(p,g.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var C={v:w,t:"s"};Array.isArray(o)?o[f][v]=C:o[Rr({r:f,c:v})]=C}break}p=g.lastIndex}v>u.e.c&&(u.e.c=v)}),o["!ref"]=Jr(u),o}function r(s,a){return Wf(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=yn(s["!ref"]),o,c=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Rr({r:u,c:d});o=c?(s[u]||[])[d]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(od(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function Xue(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function cv(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Que(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,u=s+a;switch(c=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,u/2]}function Jue(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function J_(e,t){if(t===0)return e;var r=Que(Xue(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),cv(Jue(r))}var yU=6,Zue=15,ede=1,Oi=yU;function uv(e){return Math.floor((e+Math.round(128/Oi)/256)*Oi)}function dv(e){return Math.floor((e-5)/Oi*100+.5)/100}function Z_(e){return Math.round((e*Oi+5)/Oi*256)/256}function Ak(e){return Z_(dv(uv(e)))}function E3(e){var t=Math.abs(e-Ak(e)),r=Oi;if(t>.005)for(Oi=ede;Oi<Zue;++Oi)Math.abs(e-Ak(e))<=t&&(t=Math.abs(e-Ak(e)),r=Oi);Oi=r}function Pf(e){e.width?(e.wpx=uv(e.width),e.wch=dv(e.wpx),e.MDW=Oi):e.wpx?(e.wch=dv(e.wpx),e.width=Z_(e.wch),e.MDW=Oi):typeof e.wch=="number"&&(e.width=Z_(e.wch),e.wpx=uv(e.width),e.MDW=Oi),e.customWidth&&delete e.customWidth}var tde=96,vU=tde;function fv(e){return e*96/vU}function Am(e){return e*vU/96}var rde={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function nde(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(zi)||[]).forEach(function(i){var o=Lr(i);switch(lu(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=as(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=as(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function sde(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(zi)||[]).forEach(function(i){var o=Lr(i);switch(lu(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function ade(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(zi)||[]).forEach(function(i){var o=Lr(i);switch(lu(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Hn(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?as(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?as(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?as(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?as(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?as(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?as(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?as(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=t3[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=as(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=qh[s.color.index];s.color.index==81&&(c=qh[1]),c||(c=qh[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=J_(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function ide(e,t,r){t.NumberFmt=[];for(var n=Us(Dr),s=0;s<n.length;++s)t.NumberFmt[n[s]]=Dr[n[s]];var a=e[0].match(zi);if(a)for(s=0;s<a.length;++s){var i=Lr(a[s]);switch(lu(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=xn(Hn(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Zu(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function ode(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Zt("numFmt",null,{numFmtId:n,formatCode:Ln(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Zt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Iw=["numFmtId","fillId","fontId","borderId","xfId"],Rw=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function lde(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(zi)||[]).forEach(function(a){var i=Lr(a),o=0;switch(lu(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Iw.length;++o)n[Iw[o]]&&(n[Iw[o]]=parseInt(n[Iw[o]],10));for(o=0;o<Rw.length;++o)n[Rw[o]]&&(n[Rw[o]]=as(n[Rw[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=as(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function cde(e){var t=[];return t[t.length]=Zt("cellXfs",null),e.forEach(function(r){t[t.length]=Zt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Zt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ude=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&ide(f,d,u),(f=o.match(s))&&ade(f,d,c,u),(f=o.match(n))&&sde(f,d,c,u),(f=o.match(a))&&nde(f,d,c,u),(f=o.match(r))&&lde(f,d,u),d}})();function wU(e,t){var r=[ra,Zt("styleSheet",null,{xmlns:F0[0],"xmlns:vt":Ta.vt})],n;return e.SSF&&(n=ode(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=cde(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function dde(e,t){var r=e.read_shift(2),n=Bi(e);return[r,n]}function fde(e,t,r){r||(r=St(6+4*t.length)),r.write_shift(2,e),Va(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function hde(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=qoe(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Koe(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Bi(e),n}function gde(e,t){t||(t=St(153)),t.write_shift(2,e.sz*20),Yoe(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Y_(e.color,t);var n=0;return n=2,t.write_shift(1,n),Va(e.name,t),t.length>t.l?t.slice(0,t.l):t}var mde=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],jk,pde=Ui;function TO(e,t){t||(t=St(84)),jk||(jk=d2(mde));var r=jk[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Y_({auto:1},t),Y_({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function xde(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function _U(e,t,r){r||(r=St(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ey(e,t){return t||(t=St(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var yde=Ui;function vde(e,t){return t||(t=St(51)),t.write_shift(1,0),ey(null,t),ey(null,t),ey(null,t),ey(null,t),ey(null,t),t.length>t.l?t.slice(0,t.l):t}function wde(e,t){return t||(t=St(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),q_(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function _de(e,t,r){var n=St(2052);return n.write_shift(4,e),q_(t,n),q_(r,n),n.length>n.l?n.slice(0,n.l):n}function bde(e,t,r){var n={};n.NumberFmt=[];for(var s in Dr)n.NumberFmt[s]=Dr[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return md(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],Zu(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=J_(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function Sde(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Ot(e,615,gc(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Ot(e,44,fde(s,t[s]))}),Ot(e,616))}}function kde(e){var t=1;Ot(e,611,gc(t)),Ot(e,43,gde({sz:12,color:{theme:1},name:"Calibri",family:2})),Ot(e,612)}function Cde(e){var t=2;Ot(e,603,gc(t)),Ot(e,45,TO({patternType:"none"})),Ot(e,45,TO({patternType:"gray125"})),Ot(e,604)}function Tde(e){var t=1;Ot(e,613,gc(t)),Ot(e,46,vde()),Ot(e,614)}function Ede(e){var t=1;Ot(e,626,gc(t)),Ot(e,47,_U({numFmtId:0},65535)),Ot(e,627)}function Nde(e,t){Ot(e,617,gc(t.length)),t.forEach(function(r){Ot(e,47,_U(r,0))}),Ot(e,618)}function Ade(e){var t=1;Ot(e,619,gc(t)),Ot(e,48,wde({xfId:0,name:"Normal"})),Ot(e,620)}function jde(e){var t=0;Ot(e,505,gc(t)),Ot(e,506)}function Pde(e){var t=0;Ot(e,508,_de(t,"TableStyleMedium9","PivotStyleMedium4")),Ot(e,509)}function Fde(e,t){var r=Ao();return Ot(r,278),Sde(r,e.SSF),kde(r),Cde(r),Tde(r),Ede(r),Nde(r,t.cellXfs),Ade(r),jde(r),Pde(r),Ot(r,279),r.end()}var Ode=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Dde(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(zi)||[]).forEach(function(s){var a=Lr(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[Ode.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Ide(){}function Rde(){}var Mde=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Lde=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Bde=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function $de(e,t,r){t.themeElements={};var n;[["clrScheme",Mde,Dde],["fontScheme",Lde,Ide],["fmtScheme",Bde,Rde]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var Ude=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function bU(e,t){(!e||e.length===0)&&(e=N3());var r,n={};if(!(r=e.match(Ude)))throw new Error("themeElements not found in theme");return $de(r[0],n,t),n.raw=e,n}function N3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ra];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function zde(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=g$(a,{type:"array"})}catch{return}var o=Yo(i,"theme/theme/theme1.xml",!0);if(o)return bU(o,r)}}function Wde(e){return e.read_shift(4)}function Hde(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Gde(e,4);break;case 2:t.xclrValue=tU(e);break;case 3:t.xclrValue=Wde(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Gde(e,t){return Ui(e,t)}function Vde(e,t){return Ui(e,t)}function Kde(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Hde(e);break;case 6:n[1]=Vde(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function qde(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(Kde(e,r-e.l));return{ixfe:n,ext:a}}function Yde(e,t){t.forEach(function(r){r[0]})}function Xde(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Bi(e)}}function Qde(e){var t=St(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Va(e.name,t),t.slice(0,t.l)}function Jde(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Zde(e){var t=St(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function efe(e,t){var r=St(8+2*t.length);return r.write_shift(4,e),Va(t,r),r.slice(0,r.l)}function tfe(e){return e.l+=4,e.read_shift(4)!=0}function rfe(e,t){var r=St(8);return r.write_shift(4,e),r.write_shift(4,1),r}function nfe(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return md(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function sfe(){var e=Ao();return Ot(e,332),Ot(e,334,gc(1)),Ot(e,335,Qde({name:"XLDAPR",version:12e4,flags:3496657072})),Ot(e,336),Ot(e,339,efe(1,"XLDAPR")),Ot(e,52),Ot(e,35,gc(514)),Ot(e,4096,gc(0)),Ot(e,4097,Sl(1)),Ot(e,36),Ot(e,53),Ot(e,340),Ot(e,337,rfe(1)),Ot(e,51,Zde([[1,0]])),Ot(e,338),Ot(e,333),e.end()}function afe(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(zi,function(o){var c=Lr(o);switch(lu(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function SU(){var e=[ra];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function ife(e){var t=[];if(!e)return t;var r=1;return(e.match(zi)||[]).forEach(function(n){var s=Lr(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function ofe(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Rr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function lfe(e,t,r){var n=[];return md(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function cfe(e,t,r,n){if(!e)return e;var s=n||{},a=!1;md(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function ufe(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var nm=1024;function kU(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Zt("xml",null,{"xmlns:v":Go.v,"xmlns:o":Go.o,"xmlns:x":Go.x,"xmlns:mv":Go.mv}).replace(/\/>/,">"),Zt("o:shapelayout",Zt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Zt("v:shapetype",[Zt("v:stroke",null,{joinstyle:"miter"}),Zt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];nm<e*1e3;)nm+=1e3;return t.forEach(function(a){var i=ks(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Zt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Zt("v:fill",c,o),d={on:"t",obscured:"t"};++nm,s=s.concat(["<v:shape"+iv({id:"_x0000_s"+nm,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Zt("v:shadow",null,d),Zt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pi("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),pi("x:AutoFill","False"),pi("x:Row",String(i.r)),pi("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function EO(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=ks(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=yn(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Jr(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}a.c.push(d)})}function dfe(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Lr(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=ks(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!f&&!!f[1]&&C3(f[1])||{r:"",t:"",h:""};u.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),u.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=g.h),n.push(u)}}}}),n}function CU(e){var t=[ra,Zt("comments",null,{xmlns:F0[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=Ln(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Ln(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(pi("t",Ln(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(pi("t",Ln(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function ffe(e,t){var r=[],n=!1,s={},a=0;return e.replace(zi,function(o,c){var u=Lr(o);switch(lu(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function hfe(e,t,r){var n=[ra,Zt("ThreadedComments",null,{xmlns:Ta.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Zt("threadedComment",pi("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function gfe(e,t){var r=[],n=!1;return e.replace(zi,function(a){var i=Lr(a);switch(lu(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function mfe(e){var t=[ra,Zt("personList",null,{xmlns:Ta.TCMNT,"xmlns:x":F0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Zt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function pfe(e){var t={};t.iauthor=e.read_shift(4);var r=R0(e);return t.rfx=r.s,t.ref=Rr(r.s),e.l+=16,t}function xfe(e,t){return t==null&&(t=St(36)),t.write_shift(4,e[1].iauthor),np(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var yfe=Bi;function vfe(e){return Va(e.slice(0,54))}function wfe(e,t){var r=[],n=[],s={},a=!1;return md(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function _fe(e){var t=Ao(),r=[];return Ot(t,628),Ot(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ot(t,632,vfe(s.a)))})}),Ot(t,631),Ot(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:ks(n[0]),e:ks(n[0])};Ot(t,635,xfe([a,s])),s.t&&s.t.length>0&&Ot(t,637,Woe(s)),Ot(t,636),delete s.iauthor})}),Ot(t,634),Ot(t,629),t.end()}var bfe="application/vnd.ms-office.vbaProject";function Sfe(e){var t=Tr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Tr.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Tr.write(t)}function kfe(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Tr.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var TU=["xlsb","xlsm","xlam","biff8","xla"];function Cfe(){return{"!type":"dialog"}}function Tfe(){return{"!type":"dialog"}}function Efe(){return{"!type":"macro"}}function Nfe(){return{"!type":"macro"}}var gm=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,s+(o?"":"$")+Ss(d)+(c?"":"$")+ea(u)}return function(s,a){return t=a,s.replace(e,r)}})(),A3=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,j3=(function(){return function(t,r){return t.replace(A3,function(n,s,a,i,o,c){var u=p3(i)-(a?0:r.c),d=m3(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",g=u==0?"":a?u+1:"["+u+"]";return s+"R"+f+"C"+g})}})();function EU(e,t){return e.replace(A3,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Ss(p3(a)+t.c))+(i=="$"?i+o:ea(m3(o)+t.r))})}function Afe(e,t,r){var n=jo(t),s=n.s,a=ks(r),i={r:a.r-s.r,c:a.c-s.c};return EU(e,i)}function jfe(e){return e.length!=1}function NO(e){return e.replace(/_xlfn\./g,"")}function la(e){e.l+=1}function Ff(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function NU(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return AU(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Ff(e),o=Ff(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function AU(e){var t=Ff(e),r=Ff(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Pfe(e,t,r){if(r.biff<8)return AU(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Ff(e),i=Ff(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function jU(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Ffe(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Ff(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Ffe(e){var t=Ff(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Ofe(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Dfe(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Ife(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function Ife(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function Rfe(e,t,r){var n=(e[e.l++]&96)>>5,s=NU(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Mfe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=NU(e,a,r);return[n,s,i]}function Lfe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Bfe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function $fe(e,t,r){var n=(e[e.l++]&96)>>5,s=Pfe(e,t-1,r);return[n,s]}function Ufe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function AO(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function zfe(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Wfe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Hfe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Gfe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Vfe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function PU(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Kfe(e){return e.read_shift(2),PU(e)}function qfe(e){return e.read_shift(2),PU(e)}function Yfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=jU(e,0,r);return[n,s]}function Xfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Dfe(e,0,r);return[n,s]}function Qfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=jU(e,0,r);return[n,s,a]}function Jfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[t0e[s],DU[s],n]}function Zfe(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:ehe(e);return[s,(a[0]===0?DU:e0e)[a[1]]]}function ehe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function the(e,t,r){e.l+=r&&r.biff==2?3:4}function rhe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function nhe(e){return e.l++,pd[e.read_shift(1)]}function she(e){return e.l++,e.read_shift(2)}function ahe(e){return e.l++,e.read_shift(1)!==0}function ihe(e){return e.l++,Ii(e)}function ohe(e,t,r){return e.l++,Xv(e,t-1,r)}function lhe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Qs(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=pd[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ii(e);break;case 2:r[1]=M0(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function che(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?R0:g2)(e));return s}function uhe(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=lhe(e,r.biff);return i}function dhe(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function fhe(e,t,r){if(r.biff==5)return hhe(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function hhe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function ghe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function mhe(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function phe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function xhe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var yhe=Ui,vhe=Ui,whe=Ui;function Jv(e,t,r){return e.l+=2,[Ofe(e)]}function P3(e){return e.l+=6,[]}var _he=Jv,bhe=P3,She=P3,khe=Jv;function FU(e){return e.l+=2,[ua(e),e.read_shift(2)&1]}var Che=Jv,The=FU,Ehe=P3,Nhe=Jv,Ahe=Jv,jhe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Phe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=jhe[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function Fhe(e){return e.l+=2,[e.read_shift(4)]}function Ohe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Dhe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Ihe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Rhe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Mhe(e){return e.l+=4,[0,0]}var jO={1:{n:"PtgExp",f:rhe},2:{n:"PtgTbl",f:whe},3:{n:"PtgAdd",f:la},4:{n:"PtgSub",f:la},5:{n:"PtgMul",f:la},6:{n:"PtgDiv",f:la},7:{n:"PtgPower",f:la},8:{n:"PtgConcat",f:la},9:{n:"PtgLt",f:la},10:{n:"PtgLe",f:la},11:{n:"PtgEq",f:la},12:{n:"PtgGe",f:la},13:{n:"PtgGt",f:la},14:{n:"PtgNe",f:la},15:{n:"PtgIsect",f:la},16:{n:"PtgUnion",f:la},17:{n:"PtgRange",f:la},18:{n:"PtgUplus",f:la},19:{n:"PtgUminus",f:la},20:{n:"PtgPercent",f:la},21:{n:"PtgParen",f:la},22:{n:"PtgMissArg",f:la},23:{n:"PtgStr",f:ohe},26:{n:"PtgSheet",f:Ohe},27:{n:"PtgEndSheet",f:Dhe},28:{n:"PtgErr",f:nhe},29:{n:"PtgBool",f:ahe},30:{n:"PtgInt",f:she},31:{n:"PtgNum",f:ihe},32:{n:"PtgArray",f:Ufe},33:{n:"PtgFunc",f:Jfe},34:{n:"PtgFuncVar",f:Zfe},35:{n:"PtgName",f:dhe},36:{n:"PtgRef",f:Yfe},37:{n:"PtgArea",f:Rfe},38:{n:"PtgMemArea",f:ghe},39:{n:"PtgMemErr",f:yhe},40:{n:"PtgMemNoMem",f:vhe},41:{n:"PtgMemFunc",f:mhe},42:{n:"PtgRefErr",f:phe},43:{n:"PtgAreaErr",f:Lfe},44:{n:"PtgRefN",f:Xfe},45:{n:"PtgAreaN",f:$fe},46:{n:"PtgMemAreaN",f:Ihe},47:{n:"PtgMemNoMemN",f:Rhe},57:{n:"PtgNameX",f:fhe},58:{n:"PtgRef3d",f:Qfe},59:{n:"PtgArea3d",f:Mfe},60:{n:"PtgRefErr3d",f:xhe},61:{n:"PtgAreaErr3d",f:Bfe},255:{}},Lhe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Bhe={1:{n:"PtgElfLel",f:FU},2:{n:"PtgElfRw",f:Nhe},3:{n:"PtgElfCol",f:_he},6:{n:"PtgElfRwV",f:Ahe},7:{n:"PtgElfColV",f:khe},10:{n:"PtgElfRadical",f:Che},11:{n:"PtgElfRadicalS",f:Ehe},13:{n:"PtgElfColS",f:bhe},15:{n:"PtgElfColSV",f:She},16:{n:"PtgElfRadicalLel",f:The},25:{n:"PtgList",f:Phe},29:{n:"PtgSxName",f:Fhe},255:{}},$he={0:{n:"PtgAttrNoop",f:Mhe},1:{n:"PtgAttrSemi",f:Vfe},2:{n:"PtgAttrIf",f:Hfe},4:{n:"PtgAttrChoose",f:zfe},8:{n:"PtgAttrGoto",f:Wfe},16:{n:"PtgAttrSum",f:the},32:{n:"PtgAttrBaxcel",f:AO},33:{n:"PtgAttrBaxcel",f:AO},64:{n:"PtgAttrSpace",f:Kfe},65:{n:"PtgAttrSpaceSemi",f:qfe},128:{n:"PtgAttrIfError",f:Gfe},255:{}};function Zv(e,t,r,n){if(n.biff<8)return Ui(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=uhe(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=che(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Ui(e,t)),a}function e1(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=jO[a]||jO[Lhe[a]],(a===24||a===25)&&(s=(a===24?Bhe:$he)[e[e.l+1]]),!s||!s.f?Ui(e,t):i.push([s.n,s.f(e,t,r)]);return i}function Uhe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var zhe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Whe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function OU(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function PO(e,t,r){var n=OU(e,t,r);return n=="#REF"?n:Whe(n,r)}function Fi(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,u,d,f=0,g=0,p,x="";if(!e[0]||!e[0][0])return"";for(var v=-1,w="",C=0,k=e[0].length;C<k;++C){var _=e[0][C];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),v>=0){switch(e[0][v][1][0]){case 0:w=Ms(" ",e[0][v][1][1]);break;case 1:w=Ms("\r",e[0][v][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}u=u+w,v=-1}o.push(u+zhe[_[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Ny(_[1][1],i,s),o.push(Ay(d,a));break;case"PtgRefN":d=r?Ny(_[1][1],r,s):_[1][1],o.push(Ay(d,a));break;case"PtgRef3d":f=_[1][1],d=Ny(_[1][2],i,s),x=PO(n,f,s),o.push(x+"!"+Ay(d,a));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],E=_[1][1];N||(N=0),N&=127;var P=N==0?[]:o.slice(-N);o.length-=N,E==="User"&&(E=P.shift()),o.push(E+"("+P.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":p=iO(_[1][1],r?{s:r}:i,s),o.push(Tk(p,s));break;case"PtgArea":p=iO(_[1][1],i,s),o.push(Tk(p,s));break;case"PtgArea3d":f=_[1][1],p=_[1][2],x=PO(n,f,s),o.push(x+"!"+Tk(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=_[1][2];var F=(n.names||[])[g-1]||(n[0]||[])[g],A=F?F.Name:"SH33TJSNAME"+String(g);A&&A.slice(0,6)=="_xlfn."&&!s.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var j=_[1][1];g=_[1][2];var I;if(s.biff<=5)j<0&&(j=-j),n[j]&&(I=n[j][g]);else{var B="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][g]&&n[j][g].itab>0&&(B=n.SheetNames[n[j][g].itab-1]+"!"):B=n.SheetNames[g-1]+"!"),n[j]&&n[j][g])B+=n[j][g].Name;else if(n[0]&&n[0][g])B+=n[0][g].Name;else{var Y=(OU(n,j,s)||"").split(";;");Y[g-1]?B=Y[g-1]:B+="SH33TJSERRX"}o.push(B);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var Z="(",se=")";if(v>=0){switch(w="",e[0][v][1][0]){case 2:Z=Ms(" ",e[0][v][1][1])+Z;break;case 3:Z=Ms("\r",e[0][v][1][1])+Z;break;case 4:se=Ms(" ",e[0][v][1][1])+se;break;case 5:se=Ms("\r",e[0][v][1][1])+se;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}o.push(Z+o.pop()+se);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var ee={c:r.c,r:r.r};if(n.sharedf[Rr(d)]){var te=n.sharedf[Rr(d)];o.push(Fi(te,i,ee,n,s))}else{var L=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Fi(u[1],i,ee,n,s)),L=!0;break}L||o.push(_[1])}break;case"PtgArray":o.push("{"+Uhe(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var V=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&V.indexOf(e[0][C][0])==-1){_=e[0][v];var M=!0;switch(_[1][0]){case 4:M=!1;case 0:w=Ms(" ",_[1][1]);break;case 5:M=!1;case 1:w=Ms("\r",_[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((M?w:"")+o.pop()+(M?"":w)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Hhe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Ui(e,t-2)];var o=e1(e,i,r);return t!==i+s&&(a=Zv(e,t-i-s,o,r)),e.l=n,[o,a]}function Ghe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Ui(e,t-2)];var o=e1(e,i,r);return t!==i+s&&(a=Zv(e,t-i-s,o,r)),e.l=n,[o,a]}function Vhe(e,t,r,n){var s=e.l+t,a=e1(e,n,r),i;return s!==e.l&&(i=Zv(e,s-e.l,a,r)),[a,i]}function Khe(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=e1(e,a,r);return a==65535?[[],Ui(e,t-2)]:(t!==a+2&&(s=Zv(e,n-a-2,i,r)),[i,s])}function qhe(e){var t;if(qu(e,e.l+6)!==65535)return[Ii(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Yhe(e){if(e==null){var t=St(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return y0(e);return y0(0)}function Pk(e,t,r){var n=e.l+t,s=cu(e);r.biff==2&&++e.l;var a=qhe(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Ghe(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Xhe(e,t,r,n,s){var a=w0(t,r,s),i=Yhe(e.v),o=St(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=St(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Ha([a,i,o,u]);return f}function m2(e,t,r){var n=e.read_shift(4),s=e1(e,n,r),a=e.read_shift(4),i=a>0?Zv(e,a,s,r):null;return[s,i]}var Qhe=m2,p2=m2,Jhe=m2,Zhe=m2,e0e={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},DU={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},t0e={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function FO(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function r0e(e){var t="of:="+e.replace(A3,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Fk(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function n0e(e){return e.replace(/\./,"!")}var Py={},mm={},Fy=typeof Map<"u";function F3(e,t,r){var n=0,s=e.length;if(r){if(Fy?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Fy?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Fy?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function x2(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Oi=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=dv(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Z_(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Qh(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Hf(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Zu(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function IU(e,t,r,n,s,a){try{n.cellNF&&(e.z=Dr[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ls(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Dr[t]==null&&Zu(eoe[t]||"General",t),e.t==="e")e.w=e.w||pd[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sv(e.v);else if(e.t==="d"){var i=Na(e.v);(i|0)===i?e.w=i.toString(10):e.w=sv(i)}else{if(e.v===void 0)return"";e.w=p0(e.v,mm)}else e.t==="d"?e.w=Ol(t,Na(e.v),mm):e.w=Ol(t,e.v,mm)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=J_(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=J_(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function s0e(e,t,r){if(e&&e["!ref"]){var n=yn(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function a0e(e,t){var r=yn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Jr(r))}var i0e=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,o0e=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,l0e=/<(?:\w:)?hyperlink [^>]*>/mg,c0e=/"(\w*:\w*)"/,u0e=/<(?:\w:)?col\b[^>]*[\/]?>/g,d0e=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,f0e=/<(?:\w:)?pageMargins[^>]*\/>/g,RU=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,h0e=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,g0e=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function m0e(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(o0e);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var g=u.match(RU);g?O3(g[0],o,s,r):(g=u.match(h0e))&&x0e(g[0],g[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(c0e);x&&a0e(o,x[1])}var v=u.match(g0e);v&&v[1]&&j0e(v[1],s);var w=[];if(t.cellStyles){var C=u.match(u0e);C&&C0e(w,C)}f&&O0e(f[1],o,t,c,a,i);var k=d.match(d0e);k&&(o["!autofilter"]=E0e(k[0]));var _=[],N=d.match(i0e);if(N)for(p=0;p!=N.length;++p)_[p]=yn(N[p].slice(N[p].indexOf('"')+1));var E=d.match(l0e);E&&b0e(o,E,n);var P=d.match(f0e);if(P&&(o["!margins"]=S0e(Lr(P[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Jr(c)),t.sheetRows>0&&o["!ref"]){var F=yn(o["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>c.e.r&&(F.e.r=c.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>c.e.c&&(F.e.c=c.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Jr(F))}return w.length>0&&(o["!cols"]=w),_.length>0&&(o["!merges"]=_),o}function p0e(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Jr(e[r])+'"/>';return t+"</mergeCells>"}function O3(e,t,r,n){var s=Lr(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=xn(Hn(s.codeName)))}function x0e(e,t,r,n,s){O3(e.slice(0,e.indexOf(">")),r,n,s)}function y0e(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Xc(Ln(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Zt("outlinePr",null,u)}!a&&!o||(s[s.length]=Zt("sheetPr",o,i))}var v0e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],w0e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _0e(e){var t={sheet:1};return v0e.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),w0e.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=T3(e.password).toString(16).toUpperCase()),Zt("sheetProtection",null,t)}function b0e(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Lr(Hn(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+xn(a.location))):(a.Target="#"+xn(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=yn(a.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Rr({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function S0e(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function k0e(e){return Qh(e),Zt("pageMargins",null,e)}function C0e(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Lr(t[n],!0);s.hidden&&(s.hidden=as(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,E3(s.width)),Pf(s);a<=i;)e[a++]=cs(s)}}function T0e(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Zt("col",null,x2(s,n)));return r[r.length]="</cols>",r.join("")}function E0e(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function N0e(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Jr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=jo(s);i.s.r==i.e.r&&(i.e.r=jo(t["!ref"]).e.r,s=Jr(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Zt("autoFilter",null,{ref:s})}var A0e=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function j0e(e,t){t.Views||(t.Views=[{}]),(e.match(A0e)||[]).forEach(function(r,n){var s=Lr(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),as(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function P0e(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Zt("sheetViews",Zt("sheetView",null,s),{})}function F0e(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=pd[e.v];break;case"d":n&&n.cellDates?s=ls(e.v,-1).toISOString():(e=cs(e),e.t="n",s=""+(e.v=Na(ls(e.v)))),typeof e.z>"u"&&(e.z=Dr[14]);break;default:s=e.v;break}var o=pi("v",Ln(s)),c={r:t},u=Hf(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=pi("v",""+F3(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Zt("f",Ln(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Zt("c",o,c)}var O0e=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=av("v"),i=av("f");return function(c,u,d,f,g,p){for(var x=0,v="",w=[],C=[],k=0,_=0,N=0,E="",P,F,A=0,j=0,I,B,Y=0,Z=0,se=Array.isArray(p.CellXf),ee,te=[],L=[],V=Array.isArray(u),M=[],H={},W=!1,R=!!d.sheetStubs,z=c.split(t),K=0,Q=z.length;K!=Q;++K){v=z[K].trim();var ae=v.length;if(ae!==0){var X=0;e:for(x=0;x<ae;++x)switch(v[x]){case">":if(v[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(F=Lr(v.slice(X,x),!0),A=F.r!=null?parseInt(F.r,10):A+1,j=-1,d.sheetRows&&d.sheetRows<A)continue;H={},W=!1,F.ht&&(W=!0,H.hpt=parseFloat(F.ht),H.hpx=Am(H.hpt)),F.hidden=="1"&&(W=!0,H.hidden=!0),F.outlineLevel!=null&&(W=!0,H.level=+F.outlineLevel),W&&(M[A-1]=H)}break;case"<":X=x;break}if(X>=x)break;if(F=Lr(v.slice(X,x),!0),A=F.r!=null?parseInt(F.r,10):A+1,j=-1,!(d.sheetRows&&d.sheetRows<A)){f.s.r>A-1&&(f.s.r=A-1),f.e.r<A-1&&(f.e.r=A-1),d&&d.cellStyles&&(H={},W=!1,F.ht&&(W=!0,H.hpt=parseFloat(F.ht),H.hpx=Am(H.hpt)),F.hidden=="1"&&(W=!0,H.hidden=!0),F.outlineLevel!=null&&(W=!0,H.level=+F.outlineLevel),W&&(M[A-1]=H)),w=v.slice(x).split(e);for(var ie=0;ie!=w.length&&w[ie].trim().charAt(0)=="<";++ie);for(w=w.slice(ie),x=0;x!=w.length;++x)if(v=w[x].trim(),v.length!==0){if(C=v.match(r),k=x,_=0,N=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,C!=null&&C.length===2){for(k=0,E=C[1],_=0;_!=E.length&&!((N=E.charCodeAt(_)-64)<1||N>26);++_)k=26*k+N;--k,j=k}else++j;for(_=0;_!=v.length&&v.charCodeAt(_)!==62;++_);if(++_,F=Lr(v.slice(0,_),!0),F.r||(F.r=Rr({r:A-1,c:j})),E=v.slice(_),P={t:""},(C=E.match(a))!=null&&C[1]!==""&&(P.v=xn(C[1])),d.cellFormula){if((C=E.match(i))!=null&&C[1]!==""){if(P.f=xn(Hn(C[1])).replace(/\r\n/g,`
`),d.xlfn||(P.f=NO(P.f)),C[0].indexOf('t="array"')>-1)P.F=(E.match(s)||[])[1],P.F.indexOf(":")>-1&&te.push([yn(P.F),P.F]);else if(C[0].indexOf('t="shared"')>-1){B=Lr(C[0]);var le=xn(Hn(C[1]));d.xlfn||(le=NO(le)),L[parseInt(B.si,10)]=[B,le,F.r]}}else(C=E.match(/<f[^>]*\/>/))&&(B=Lr(C[0]),L[B.si]&&(P.f=Afe(L[B.si][1],L[B.si][2],F.r)));var ce=ks(F.r);for(_=0;_<te.length;++_)ce.r>=te[_][0].s.r&&ce.r<=te[_][0].e.r&&ce.c>=te[_][0].s.c&&ce.c<=te[_][0].e.c&&(P.F=te[_][1])}if(F.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(R)P.t="z";else continue;else P.t=F.t||"n";switch(f.s.c>j&&(f.s.c=j),f.e.c<j&&(f.e.c=j),P.t){case"n":if(P.v==""||P.v==null){if(!R)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!R)continue;P.t="z"}else I=Py[parseInt(P.v,10)],P.v=I.t,P.r=I.r,d.cellHTML&&(P.h=I.h);break;case"str":P.t="s",P.v=P.v!=null?Hn(P.v):"",d.cellHTML&&(P.h=d3(P.v));break;case"inlineStr":C=E.match(n),P.t="s",C!=null&&(I=C3(C[1]))?(P.v=I.t,d.cellHTML&&(P.h=I.h)):P.v="";break;case"b":P.v=as(P.v);break;case"d":d.cellDates?P.v=ls(P.v,1):(P.v=Na(ls(P.v,1)),P.t="n");break;case"e":(!d||d.cellText!==!1)&&(P.w=P.v),P.v=L$[P.v];break}if(Y=Z=0,ee=null,se&&F.s!==void 0&&(ee=p.CellXf[F.s],ee!=null&&(ee.numFmtId!=null&&(Y=ee.numFmtId),d.cellStyles&&ee.fillId!=null&&(Z=ee.fillId))),IU(P,Y,Z,d,g,p),d.cellDates&&se&&P.t=="n"&&ep(Dr[Y])&&(P.t="d",P.v=h2(P.v)),F.cm&&d.xlmeta){var _e=(d.xlmeta.Cell||[])[+F.cm-1];_e&&_e.type=="XLDAPR"&&(P.D=!0)}if(V){var ne=ks(F.r);u[ne.r]||(u[ne.r]=[]),u[ne.r][ne.c]=P}else u[F.r]=P}}}}M.length>0&&(u["!rows"]=M)}})();function D0e(e,t,r,n){var s=[],a=[],i=yn(e["!ref"]),o="",c,u="",d=[],f=0,g=0,p=e["!rows"],x=Array.isArray(e),v={r:u},w,C=-1;for(g=i.s.c;g<=i.e.c;++g)d[g]=Ss(g);for(f=i.s.r;f<=i.e.r;++f){for(a=[],u=ea(f),g=i.s.c;g<=i.e.c;++g){c=d[g]+u;var k=x?(e[f]||[])[g]:e[c];k!==void 0&&(o=F0e(k,c,e,t))!=null&&a.push(o)}(a.length>0||p&&p[f])&&(v={r:u},p&&p[f]&&(w=p[f],w.hidden&&(v.hidden=1),C=-1,w.hpx?C=fv(w.hpx):w.hpt&&(C=w.hpt),C>-1&&(v.ht=C,v.customHeight=1),w.level&&(v.outlineLevel=w.level)),s[s.length]=Zt("row",a.join(""),v))}if(p)for(;f<p.length;++f)p&&p[f]&&(v={r:f+1},w=p[f],w.hidden&&(v.hidden=1),C=-1,w.hpx?C=fv(w.hpx):w.hpt&&(C=w.hpt),C>-1&&(v.ht=C,v.customHeight=1),w.level&&(v.outlineLevel=w.level),s[s.length]=Zt("row","",v));return s.join("")}function MU(e,t,r,n){var s=[ra,Zt("worksheet",null,{xmlns:F0[0],"xmlns:r":Ta.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=yn(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Jr(d)}n||(n={}),c["!comments"]=[];var f=[];y0e(c,r,e,t,s),s[s.length]=Zt("dimension",null,{ref:u}),s[s.length]=P0e(c,t,e,r),t.sheetFormat&&(s[s.length]=Zt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=T0e(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=D0e(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=_0e(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=N0e(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=p0e(c["!merges"]));var g=-1,p,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(v){v[1].Target&&(p={ref:v[0]},v[1].Target.charAt(0)!="#"&&(x=Rn(n,-1,Ln(v[1].Target).replace(/#.*$/,""),sn.HLINK),p["r:id"]="rId"+x),(g=v[1].Target.indexOf("#"))>-1&&(p.location=Ln(v[1].Target.slice(g+1))),v[1].Tooltip&&(p.tooltip=Ln(v[1].Tooltip)),s[s.length]=Zt("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=k0e(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=pi("ignoredErrors",Zt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=Rn(n,-1,"../drawings/drawing"+(e+1)+".xml",sn.DRAW),s[s.length]=Zt("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=Rn(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",sn.VML),s[s.length]=Zt("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function I0e(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function R0e(e,t,r){var n=St(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=fv(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,g=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Rr(u)];x&&(f<0&&(f=p),g=p)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,g))}var v=n.l;return n.l=c,n.write_shift(4,o),n.l=v,n.length>n.l?n.slice(0,n.l):n}function M0e(e,t,r,n){var s=R0e(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Ot(e,0,s)}var L0e=R0,B0e=np;function $0e(){}function U0e(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Hoe(e),r}function z0e(e,t,r){r==null&&(r=St(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Y_({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),O$(e,r),r.slice(0,r.l)}function W0e(e){var t=Ll(e);return[t]}function H0e(e,t,r){return r==null&&(r=St(8)),O0(t,r)}function G0e(e){var t=D0(e);return[t]}function V0e(e,t,r){return r==null&&(r=St(4)),I0(t,r)}function K0e(e){var t=Ll(e),r=e.read_shift(1);return[t,r,"b"]}function q0e(e,t,r){return r==null&&(r=St(9)),O0(t,r),r.write_shift(1,e.v?1:0),r}function Y0e(e){var t=D0(e),r=e.read_shift(1);return[t,r,"b"]}function X0e(e,t,r){return r==null&&(r=St(5)),I0(t,r),r.write_shift(1,e.v?1:0),r}function Q0e(e){var t=Ll(e),r=e.read_shift(1);return[t,r,"e"]}function J0e(e,t,r){return r==null&&(r=St(9)),O0(t,r),r.write_shift(1,e.v),r}function Z0e(e){var t=D0(e),r=e.read_shift(1);return[t,r,"e"]}function ege(e,t,r){return r==null&&(r=St(8)),I0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function tge(e){var t=Ll(e),r=e.read_shift(4);return[t,r,"s"]}function rge(e,t,r){return r==null&&(r=St(12)),O0(t,r),r.write_shift(4,t.v),r}function nge(e){var t=D0(e),r=e.read_shift(4);return[t,r,"s"]}function sge(e,t,r){return r==null&&(r=St(8)),I0(t,r),r.write_shift(4,t.v),r}function age(e){var t=Ll(e),r=Ii(e);return[t,r,"n"]}function ige(e,t,r){return r==null&&(r=St(16)),O0(t,r),y0(e.v,r),r}function LU(e){var t=D0(e),r=Ii(e);return[t,r,"n"]}function oge(e,t,r){return r==null&&(r=St(12)),I0(t,r),y0(e.v,r),r}function lge(e){var t=Ll(e),r=w3(e);return[t,r,"n"]}function cge(e,t,r){return r==null&&(r=St(12)),O0(t,r),D$(e.v,r),r}function uge(e){var t=D0(e),r=w3(e);return[t,r,"n"]}function dge(e,t,r){return r==null&&(r=St(8)),I0(t,r),D$(e.v,r),r}function fge(e){var t=Ll(e),r=x3(e);return[t,r,"is"]}function hge(e){var t=Ll(e),r=Bi(e);return[t,r,"str"]}function gge(e,t,r){return r==null&&(r=St(12+4*e.v.length)),O0(t,r),Va(e.v,r),r.length>r.l?r.slice(0,r.l):r}function mge(e){var t=D0(e),r=Bi(e);return[t,r,"str"]}function pge(e,t,r){return r==null&&(r=St(8+4*e.v.length)),I0(t,r),Va(e.v,r),r.length>r.l?r.slice(0,r.l):r}function xge(e,t,r){var n=e.l+t,s=Ll(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=p2(e,n-e.l,r);i[3]=Fi(o,null,s,r.supbooks,r)}else e.l=n;return i}function yge(e,t,r){var n=e.l+t,s=Ll(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=p2(e,n-e.l,r);i[3]=Fi(o,null,s,r.supbooks,r)}else e.l=n;return i}function vge(e,t,r){var n=e.l+t,s=Ll(e);s.r=r["!row"];var a=Ii(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=p2(e,n-e.l,r);i[3]=Fi(o,null,s,r.supbooks,r)}else e.l=n;return i}function wge(e,t,r){var n=e.l+t,s=Ll(e);s.r=r["!row"];var a=Bi(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=p2(e,n-e.l,r);i[3]=Fi(o,null,s,r.supbooks,r)}else e.l=n;return i}var _ge=R0,bge=np;function Sge(e,t){return t==null&&(t=St(4)),t.write_shift(4,e),t}function kge(e,t){var r=e.l+t,n=R0(e),s=y3(e),a=Bi(e),i=Bi(e),o=Bi(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function Cge(e,t){var r=St(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));np({s:ks(e[0]),e:ks(e[0])},r),v3("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Va(s||"",r),Va(e[1].Tooltip||"",r),Va("",r),r.slice(0,r.l)}function Tge(){}function Ege(e,t,r){var n=e.l+t,s=I$(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=Qhe(e,n-e.l,r);i[1]=o}else e.l=n;return i}function Nge(e,t,r){var n=e.l+t,s=R0(e),a=[s];if(r.cellFormula){var i=Zhe(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function Age(e,t,r){r==null&&(r=St(18));var n=x2(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var BU=["left","right","top","bottom","header","footer"];function jge(e){var t={};return BU.forEach(function(r){t[r]=Ii(e)}),t}function Pge(e,t){return t==null&&(t=St(48)),Qh(e),BU.forEach(function(r){y0(e[r],t)}),t}function Fge(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Oge(e,t,r){r==null&&(r=St(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Dge(e){var t=St(24);return t.write_shift(4,4),t.write_shift(4,1),np(e,t),t}function Ige(e,t){return t==null&&(t=St(66)),t.write_shift(2,e.password?T3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Rge(){}function Mge(){}function Lge(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,g=!1,p,x,v,w,C,k,_,N,E,P=[];o.biff=12,o["!row"]=0;var F=0,A=!1,j=[],I={},B=o.supbooks||s.supbooks||[[]];if(B.sharedf=I,B.arrayf=j,B.SheetNames=s.SheetNames||s.Sheets.map(function(V){return V.name}),!o.supbooks&&(o.supbooks=B,s.Names))for(var Y=0;Y<s.Names.length;++Y)B[0][Y+1]=s.Names[Y];var Z=[],se=[],ee=!1;hv[16]={n:"BrtShortReal",f:LU};var te;if(md(e,function(M,H,W){if(!g)switch(W){case 148:u=M;break;case 0:p=M,o.sheetRows&&o.sheetRows<=p.r&&(g=!0),N=ea(w=p.r),o["!row"]=p.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=Am(M.hpt)),se[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:M[2]},M[2]){case"n":x.v=M[1];break;case"s":_=Py[M[1]],x.v=_.t,x.r=_.r;break;case"b":x.v=!!M[1];break;case"e":x.v=M[1],o.cellText!==!1&&(x.w=pd[x.v]);break;case"str":x.t="s",x.v=M[1];break;case"is":x.t="s",x.v=M[1].t;break}if((v=i.CellXf[M[0].iStyleRef])&&IU(x,v.numFmtId,null,o,a,i),C=M[0].c==-1?C+1:M[0].c,o.dense?(c[w]||(c[w]=[]),c[w][C]=x):c[Ss(C)+N]=x,o.cellFormula){for(A=!1,F=0;F<j.length;++F){var R=j[F];p.r>=R[0].s.r&&p.r<=R[0].e.r&&C>=R[0].s.c&&C<=R[0].e.c&&(x.F=Jr(R[0]),A=!0)}!A&&M.length>3&&(x.f=M[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>C&&(d.s.c=C),d.e.r<p.r&&(d.e.r=p.r),d.e.c<C&&(d.e.c=C),o.cellDates&&v&&x.t=="n"&&ep(Dr[v.numFmtId])){var z=Mh(x.v);z&&(x.t="d",x.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}te&&(te.type=="XLDAPR"&&(x.D=!0),te=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;x={t:"z",v:void 0},C=M[0].c==-1?C+1:M[0].c,o.dense?(c[w]||(c[w]=[]),c[w][C]=x):c[Ss(C)+N]=x,d.s.r>p.r&&(d.s.r=p.r),d.s.c>C&&(d.s.c=C),d.e.r<p.r&&(d.e.r=p.r),d.e.c<C&&(d.e.c=C),te&&(te.type=="XLDAPR"&&(x.D=!0),te=void 0);break;case 176:P.push(M);break;case 49:te=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var K=n["!id"][M.relId];for(K?(M.Target=K.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=K):M.relId==""&&(M.Target="#"+M.loc),w=M.rfx.s.r;w<=M.rfx.e.r;++w)for(C=M.rfx.s.c;C<=M.rfx.e.c;++C)o.dense?(c[w]||(c[w]=[]),c[w][C]||(c[w][C]={t:"z",v:void 0}),c[w][C].l=M):(k=Rr({c:C,r:w}),c[k]||(c[k]={t:"z",v:void 0}),c[k].l=M);break;case 426:if(!o.cellFormula)break;j.push(M),E=o.dense?c[w][C]:c[Ss(C)+N],E.f=Fi(M[1],d,{r:p.r,c:C},B,o),E.F=Jr(M[0]);break;case 427:if(!o.cellFormula)break;I[Rr(M[0].s)]=M[1],E=o.dense?c[w][C]:c[Ss(C)+N],E.f=Fi(M[1],d,{r:p.r,c:C},B,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)Z[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},ee||(ee=!0,E3(M.w/256)),Pf(Z[M.e+1]);break;case 161:c["!autofilter"]={ref:Jr(M)};break;case 476:c["!margins"]=M;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),M.name&&(s.Sheets[r].CodeName=M.name),(M.above||M.left)&&(c["!outline"]={above:M.above,left:M.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),M.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!H.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Jr(u||d)),o.sheetRows&&c["!ref"]){var L=yn(c["!ref"]);o.sheetRows<=+L.e.r&&(L.e.r=o.sheetRows-1,L.e.r>d.e.r&&(L.e.r=d.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>d.e.c&&(L.e.c=d.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Jr(L))}return P.length>0&&(c["!merges"]=P),Z.length>0&&(c["!cols"]=Z),se.length>0&&(c["!rows"]=se),c}function Bge(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=cs(t),t.z=t.z||Dr[14],t.v=Na(ls(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Hf(s.cellXfs,t,s),t.l&&a["!links"].push([Rr(c),t.l]),t.c&&a["!comments"].push([Rr(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=F3(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?Ot(e,18,sge(t,c)):Ot(e,7,rge(t,c))):(c.t="str",i?Ot(e,17,pge(t,c)):Ot(e,6,gge(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?Ot(e,13,dge(t,c)):Ot(e,2,cge(t,c)):i?Ot(e,16,oge(t,c)):Ot(e,5,ige(t,c)),!0;case"b":return c.t="b",i?Ot(e,15,X0e(t,c)):Ot(e,4,q0e(t,c)),!0;case"e":return c.t="e",i?Ot(e,14,ege(t,c)):Ot(e,3,J0e(t,c)),!0}return i?Ot(e,12,V0e(t,c)):Ot(e,1,H0e(t,c)),!0}function $ge(e,t,r,n){var s=yn(t["!ref"]||"A1"),a,i="",o=[];Ot(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=ea(d),M0e(e,t,s,d);var f=!1;if(d<=s.e.r)for(var g=s.s.c;g<=s.e.c;++g){d===s.s.r&&(o[g]=Ss(g)),a=o[g]+i;var p=c?(t[d]||[])[g]:t[a];if(!p){f=!1;continue}f=Bge(e,p,d,g,n,t,f)}}Ot(e,146)}function Uge(e,t){!t||!t["!merges"]||(Ot(e,177,Sge(t["!merges"].length)),t["!merges"].forEach(function(r){Ot(e,176,bge(r))}),Ot(e,178))}function zge(e,t){!t||!t["!cols"]||(Ot(e,390),t["!cols"].forEach(function(r,n){r&&Ot(e,60,Age(n,r))}),Ot(e,391))}function Wge(e,t){!t||!t["!ref"]||(Ot(e,648),Ot(e,649,Dge(yn(t["!ref"]))),Ot(e,650))}function Hge(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Rn(r,-1,n[1].Target.replace(/#.*$/,""),sn.HLINK);Ot(e,494,Cge(n,s))}}),delete t["!links"]}function Gge(e,t,r,n){if(t["!comments"].length>0){var s=Rn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",sn.VML);Ot(e,551,v3("rId"+s)),t["!legacy"]=s}}function Vge(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Jr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=jo(a);o.s.r==o.e.r&&(o.e.r=jo(t["!ref"]).e.r,a=Jr(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ot(e,161,np(yn(a))),Ot(e,162)}}function Kge(e,t,r){Ot(e,133),Ot(e,137,Oge(t,r)),Ot(e,138),Ot(e,134)}function qge(e,t){t["!protect"]&&Ot(e,535,Ige(t["!protect"]))}function Yge(e,t,r,n){var s=Ao(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=yn(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Ot(s,129),(r.vbaraw||i["!outline"])&&Ot(s,147,z0e(o,i["!outline"])),Ot(s,148,B0e(c)),Kge(s,i,r.Workbook),zge(s,i),$ge(s,i,e,t),qge(s,i),Vge(s,i,r,e),Uge(s,i),Hge(s,i,n),i["!margins"]&&Ot(s,476,Pge(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Wge(s,i),Gge(s,i,e,n),Ot(s,130),s.end()}function Xge(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=xn((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function Qge(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var g=Xge(f);d.s.r=d.s.c=0,d.e.c=o,u=Ss(o),g[0].forEach(function(p,x){i[u+ea(x)]={t:"n",v:p,z:g[1]},c=x}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(i["!ref"]=Jr(d)),i}function Jge(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(RU);return o&&O3(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Zge(e,t){e.l+=10;var r=Bi(e);return{name:r}}function eme(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return md(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var D3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],tme=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],rme=[],nme=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function OO(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=as(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function DO(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=as(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function $U(e){DO(e.WBProps,D3),DO(e.CalcPr,nme),OO(e.WBView,tme),OO(e.Sheets,rme),mm.date1904=as(e.WBProps.date1904)}function sme(e){return!e.Workbook||!e.Workbook.WBProps?"false":as(e.Workbook.WBProps.date1904)?"true":"false"}var ame="][*?/\\".split("");function UU(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return ame.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function ime(e,t,r){e.forEach(function(n,s){UU(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function ome(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];ime(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)s0e(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var lme=/<\w+:workbook/;function cme(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(zi,function(c,u){var d=Lr(c);switch(lu(d[0])){case"<?xml":break;case"<workbook":c.match(lme)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":D3.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=as(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Hn(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=xn(Hn(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Hn(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),as(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=xn(Hn(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),F0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return $U(r),r}function zU(e){var t=[ra];t[t.length]=Zt("workbook",null,{xmlns:F0[0],"xmlns:r":Ta.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(D3.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Zt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:Ln(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Zt("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Zt("definedName",Ln(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function ume(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=yE(e),r.name=Bi(e),r}function dme(e,t){return t||(t=St(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),v3(e.strRelID,t),Va(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function fme(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Bi(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function hme(e,t){t||(t=St(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),O$(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function gme(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function mme(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=Goe(e),i=Jhe(e,0,r),o=y3(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function pme(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],hv[16]={n:"BrtFRTArchID$",f:gme},md(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Fi(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),$U(r),r.Names=a,r.supbooks=i,r}function xme(e,t){Ot(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ot(e,156,dme(s))}Ot(e,144)}function yme(e,t){t||(t=St(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Va("SheetJS",t),Va(z_.version,t),Va(z_.version,t),Va("7262",t),t.length>t.l?t.slice(0,t.l):t}function vme(e,t){t||(t=St(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function wme(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(Ot(e,135),Ot(e,158,vme(s)),Ot(e,136))}}function _me(e,t){var r=Ao();return Ot(r,131),Ot(r,128,yme()),Ot(r,153,hme(e.Workbook&&e.Workbook.WBProps||null)),wme(r,e),xme(r,e),Ot(r,132),r.end()}function bme(e,t,r){return t.slice(-4)===".bin"?pme(e,r):cme(e,r)}function Sme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Lge(e,n,r,s,a,i,o):m0e(e,n,r,s,a,i,o)}function kme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?eme(e,n,r,s,a):Jge(e,n,r,s,a)}function Cme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Efe():Nfe()}function Tme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Cfe():Tfe()}function Eme(e,t,r,n){return t.slice(-4)===".bin"?bde(e,r,n):ude(e,r,n)}function Nme(e,t,r){return bU(e,r)}function Ame(e,t,r){return t.slice(-4)===".bin"?Aue(e,r):Tue(e,r)}function jme(e,t,r){return t.slice(-4)===".bin"?wfe(e,r):dfe(e,r)}function Pme(e,t,r){return t.slice(-4)===".bin"?lfe(e):ife(e)}function Fme(e,t,r,n){return r.slice(-4)===".bin"?cfe(e,t,r,n):void 0}function Ome(e,t,r){return t.slice(-4)===".bin"?nfe(e,t,r):afe(e,t,r)}function Dme(e,t,r){return(t.slice(-4)===".bin"?_me:zU)(e)}function Ime(e,t,r,n,s){return(t.slice(-4)===".bin"?Yge:MU)(e,r,n,s)}function Rme(e,t,r){return(t.slice(-4)===".bin"?Fde:wU)(e,r)}function Mme(e,t,r){return(t.slice(-4)===".bin"?Fue:fU)(e,r)}function Lme(e,t,r){return(t.slice(-4)===".bin"?_fe:CU)(e)}function Bme(e){return(e.slice(-4)===".bin"?sfe:SU)()}var WU=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,HU=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function sc(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(WU),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(HU),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function $me(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(WU),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(HU),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Oy;function Ume(e,t){var r=Oy[e]||xn(e);return r==="General"?p0(t):Ol(r,t)}function zme(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=as(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=ls(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[xn(t)]=s}function Wme(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||pd[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sv(e.v):e.w=p0(e.v):e.w=Ume(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Oy[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ep(n)){var s=Mh(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function Hme(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=rde[n.Pattern]||n.Pattern)}e[t.ID]=t}function Gme(e,t,r,n,s,a,i,o,c,u){var d="General",f=n.StyleID,g={};u=u||{};var p=[],x=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&p.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=as(e);break;case"String":n.t="s",n.r=QF(xn(e)),n.v=e.indexOf("<")>-1?xn(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ls(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=xn(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=L$[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=QF(t||e));break}if(Wme(n,d,u),u.cellFormula!==!1)if(n.Formula){var v=xn(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=gm(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=gm("RC:RC",s):n.ArrayRange&&(n.F=gm(n.ArrayRange,s),c.push([yn(n.F),n.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(n.F=c[x][1]);u.cellStyles&&(p.forEach(function(w){!g.patternType&&w.patternType&&(g.patternType=w.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Vme(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ok(e,t){var r=t||{};tp();var n=fy(f3(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Hn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=cs(r);return i.type="string",Nm.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(At){s.indexOf("<"+At)>=0&&(a=!0)}),a)return Ppe(n,r);Oy={"General Number":"General","General Date":Dr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Dr[15],"Short Date":Dr[14],"Long Time":Dr[19],"Medium Time":Dr[18],"Short Time":Dr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Dr[2],Standard:Dr[4],Percent:Dr[10],Scientific:Dr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},f=[],g=r.dense?[]:{},p="",x={},v={},w=sc('<Data ss:Type="String">'),C=0,k=0,_=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},P={},F="",A=0,j=[],I={},B={},Y=0,Z=[],se=[],ee={},te=[],L,V=!1,M=[],H=[],W={},R=0,z=0,K={Sheets:[],WBProps:{date1904:!1}},Q={};ov.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";o=ov.exec(n);)switch(o[3]=(ae=o[3]).toLowerCase()){case"data":if(ae=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Gme(n.slice(C,o.index),F,w,c[c.length-1][0]=="comment"?ee:x,{c:k,r:_},E,te[k],v,M,r):(F="",w=sc(o[0]),C=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(se.length>0&&(x.c=se),(!r.sheetRows||r.sheetRows>_)&&x.v!==void 0&&(r.dense?(g[_]||(g[_]=[]),g[_][k]=x):g[Ss(k)+ea(_)]=x),x.HRef&&(x.l={Target:xn(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(R=k+(parseInt(x.MergeAcross,10)|0),z=_+(parseInt(x.MergeDown,10)|0),j.push({s:{c:k,r:_},e:{c:R,r:z}})),!r.sheetStubs)x.MergeAcross?k=R+1:++k;else if(x.MergeAcross||x.MergeDown){for(var X=k;X<=R;++X)for(var ie=_;ie<=z;++ie)(X>k||ie>_)&&(r.dense?(g[ie]||(g[ie]=[]),g[ie][X]={t:"z"}):g[Ss(X)+ea(ie)]={t:"z"});k=R+1}else++k;else x=$me(o[0]),x.Index&&(k=+x.Index-1),k<N.s.c&&(N.s.c=k),k>N.e.c&&(N.e.c=k),o[0].slice(-2)==="/>"&&++k,se=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<N.s.r&&(N.s.r=_),_>N.e.r&&(N.e.r=_),o[0].slice(-2)==="/>"&&(v=sc(o[0]),v.Index&&(_=+v.Index-1)),k=0,++_):(v=sc(o[0]),v.Index&&(_=+v.Index-1),W={},(v.AutoFitHeight=="0"||v.Height)&&(W.hpx=parseInt(v.Height,10),W.hpt=fv(W.hpx),H[_]=W),v.Hidden=="1"&&(W.hidden=!0,H[_]=W));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(g["!ref"]=Jr(N),r.sheetRows&&r.sheetRows<=N.e.r&&(g["!fullref"]=g["!ref"],N.e.r=r.sheetRows-1,g["!ref"]=Jr(N))),j.length&&(g["!merges"]=j),te.length>0&&(g["!cols"]=te),H.length>0&&(g["!rows"]=H),d[p]=g}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=k=0,c.push([o[3],!1]),u=sc(o[0]),p=xn(u.Name),g=r.dense?[]:{},j=[],M=[],H=[],Q={name:p,Hidden:0},K.Sheets.push(Q);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),te=[],V=!1}break;case"style":o[1]==="/"?Hme(E,P,r):P=sc(o[0]);break;case"numberformat":P.nf=xn(sc(o[0]).Format||"General"),Oy[P.nf]&&(P.nf=Oy[P.nf]);for(var le=0;le!=392&&Dr[le]!=P.nf;++le);if(le==392){for(le=57;le!=392;++le)if(Dr[le]==null){Zu(P.nf,le);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(L=sc(o[0]),L.Hidden&&(L.hidden=!0,delete L.Hidden),L.Width&&(L.wpx=parseInt(L.Width,10)),!V&&L.wpx>10){V=!0,Oi=yU;for(var ce=0;ce<te.length;++ce)te[ce]&&Pf(te[ce])}V&&Pf(L),te[L.Index-1||te.length]=L;for(var _e=0;_e<+L.Span;++_e)te[te.length]=cs(L);break;case"namedrange":if(o[1]==="/")break;K.Names||(K.Names=[]);var ne=Lr(o[0]),pe={Name:ne.Name,Ref:gm(ne.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(pe.Sheet=K.Sheets.length-1),K.Names.push(pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=sc(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ple(I,ae,n.slice(Y,o.index)):Y=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Vme(ee),se.push(ee)}else c.push([o[3],!1]),u=sc(o[0]),ee={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ce=sc(o[0]);g["!autofilter"]={ref:gm(Ce.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return BO(n,r);var Ae=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ae=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ae=!1}break;case"excelworkbook":switch(o[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ae=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ae=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(Y,o.index)){case"SheetHidden":Q.Hidden=1;break;case"SheetVeryHidden":Q.Hidden=2;break}else Y=o.index+o[0].length;break;case"header":g["!margins"]||Qh(g["!margins"]={},"xlml"),isNaN(+Lr(o[0]).Margin)||(g["!margins"].header=+Lr(o[0]).Margin);break;case"footer":g["!margins"]||Qh(g["!margins"]={},"xlml"),isNaN(+Lr(o[0]).Margin)||(g["!margins"].footer=+Lr(o[0]).Margin);break;case"pagemargins":var Ge=Lr(o[0]);g["!margins"]||Qh(g["!margins"]={},"xlml"),isNaN(+Ge.Top)||(g["!margins"].top=+Ge.Top),isNaN(+Ge.Left)||(g["!margins"].left=+Ge.Left),isNaN(+Ge.Right)||(g["!margins"].right=+Ge.Right),isNaN(+Ge.Bottom)||(g["!margins"].bottom=+Ge.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ae=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ae=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ae=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ae=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ae=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ae=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ae=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ae=!1}break;case"smarttags":break;default:Ae=!1;break}if(Ae||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?zme(B,ae,Z,n.slice(Y,o.index)):(Z=o,Y=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Le={};return!r.bookSheets&&!r.bookProps&&(Le.Sheets=d),Le.SheetNames=f,Le.Workbook=K,Le.SSF=cs(Dr),Le.Props=I,Le.Custprops=B,Le}function CE(e,t){switch(R3(t=t||{}),t.type||"base64"){case"base64":return Ok(Zo(e),t);case"binary":case"buffer":case"file":return Ok(e,t);case"array":return Ok(zf(e),t)}}function Kme(e,t){var r=[];return e.Props&&r.push(xle(e.Props,t)),e.Custprops&&r.push(yle(e.Props,e.Custprops)),r.join("")}function qme(){return""}function Yme(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Zt("NumberFormat",null,{"ss:Format":Ln(Dr[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Zt("Style",a.join(""),i))}),Zt("Styles",r.join(""))}function GU(e){return Zt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+j3(e.Ref,{r:0,c:0})})}function Xme(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(GU(s)))}return Zt("Names",r.join(""))}function Qme(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(GU(o)))}return a.join("")}function Jme(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Zt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Zt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Zt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Zt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(pi("ProtectContents","True")),e["!protect"].objects&&s.push(pi("ProtectObjects","True")),e["!protect"].scenarios&&s.push(pi("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(pi("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(pi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Zt("WorksheetOptions",s.join(""),{xmlns:Go.x})}function Zme(e){return e.map(function(t){var r=woe(t.t||""),n=Zt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Zt("Comment",n,{"ss:Author":t.a})}).join("")}function epe(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ln(j3(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=ks(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ln(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ln(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",g="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",g=String(e.v);break;case"b":f="Boolean",g=e.v?"1":"0";break;case"e":f="Error",g=pd[e.v];break;case"d":f="DateTime",g=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Dr[14]);break;case"s":f="String",g=voe(e.v||"");break}var p=Hf(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var x=e.v!=null?g:"",v=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(v+=Zme(e.c)),Zt("Cell",v,o)}function tpe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Am(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function rpe(e,t,r,n){if(!e["!ref"])return"";var s=yn(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,C){Pf(w);var k=!!w.width,_=x2(C,w),N={"ss:Index":C+1};k&&(N["ss:Width"]=uv(_.width)),w.hidden&&(N["ss:Hidden"]="1"),o.push(Zt("Column",null,N))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[tpe(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var g=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>f)&&!(a[i].s.r>u)&&!(a[i].e.c<f)&&!(a[i].e.r<u)){(a[i].s.c!=f||a[i].s.r!=u)&&(g=!0);break}if(!g){var p={r:u,c:f},x=Rr(p),v=c?(e[u]||[])[f]:e[x];d.push(epe(v,x,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function npe(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?Qme(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?rpe(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(Jme(a,t,e,r)),n.join("")}function spe(e,t){t||(t={}),e.SSF||(e.SSF=cs(Dr)),e.SSF&&(tp(),u2(e.SSF),t.revssf=f2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Hf(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Kme(e,t)),r.push(qme()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Zt("Worksheet",npe(n,t,e),{"ss:Name":Ln(e.SheetNames[n])}));return r[2]=Yme(e,t),r[3]=Xme(e),ra+Zt("Workbook",r.join(""),{xmlns:Go.ss,"xmlns:o":Go.o,"xmlns:x":Go.x,"xmlns:ss":Go.ss,"xmlns:dt":Go.dt,"xmlns:html":Go.html})}function ape(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Xoe(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Qoe(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var ipe=[60,1084,2066,2165,2175];function ope(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=qu(r,r.l),u=TE[c],d=0;u!=null&&ipe.indexOf(c)>-1;)a=qu(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=TE[c=qu(r,r.l)];var f=Ha(i);fi(f,0);var g=0;f.lens=[];for(var p=0;p<i.length;++p)f.lens.push(g),g+=i[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,s)}function zc(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Dr[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||pd[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sv(e.v):e.w=p0(e.v):e.w=Ol(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&ep(Dr[n]||String(n))){var s=Mh(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Mw(e,t,r){return{v:e,ixfe:t,t:r}}function lpe(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],u="",d={},f,g="",p,x,v,w,C={},k=[],_,N,E=[],P=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},j=function(Je){return Je<8?qh[Je]:Je<64&&P[Je-8]||qh[Je]},I=function(Je,Ye,Tt){var Nt=Ye.XF.data;if(!(!Nt||!Nt.patternType||!Tt||!Tt.cellStyles)){Ye.s={},Ye.s.patternType=Nt.patternType;var Wt;(Wt=cv(j(Nt.icvFore)))&&(Ye.s.fgColor={rgb:Wt}),(Wt=cv(j(Nt.icvBack)))&&(Ye.s.bgColor={rgb:Wt})}},B=function(Je,Ye,Tt){if(!(W>1)&&!(Tt.sheetRows&&Je.r>=Tt.sheetRows)){if(Tt.cellStyles&&Ye.XF&&Ye.XF.data&&I(Je,Ye,Tt),delete Ye.ixfe,delete Ye.XF,f=Je,g=Rr(Je),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Je.r<i.s.r&&(i.s.r=Je.r),Je.c<i.s.c&&(i.s.c=Je.c),Je.r+1>i.e.r&&(i.e.r=Je.r+1),Je.c+1>i.e.c&&(i.e.c=Je.c+1),Tt.cellFormula&&Ye.f){for(var Nt=0;Nt<k.length;++Nt)if(!(k[Nt][0].s.c>Je.c||k[Nt][0].s.r>Je.r)&&!(k[Nt][0].e.c<Je.c||k[Nt][0].e.r<Je.r)){Ye.F=Jr(k[Nt][0]),(k[Nt][0].s.c!=Je.c||k[Nt][0].s.r!=Je.r)&&delete Ye.f,Ye.f&&(Ye.f=""+Fi(k[Nt][1],i,Je,M,Y));break}}Tt.dense?(s[Je.r]||(s[Je.r]=[]),s[Je.r][Je.c]=Ye):s[g]=Ye}},Y={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Y.password=t.password);var Z,se=[],ee=[],te=[],L=[],V=!1,M=[];M.SheetNames=Y.snames,M.sharedf=Y.sharedf,M.arrayf=Y.arrayf,M.names=[],M.XTI=[];var H=0,W=0,R=0,z=[],K=[],Q;Y.codepage=1200,uc(1200);for(var ae=!1;e.l<e.length-1;){var X=e.l,ie=e.read_shift(2);if(ie===0&&H===10)break;var le=e.l===e.length?0:e.read_shift(2),ce=TE[ie];if(ce&&ce.f){if(t.bookSheets&&H===133&&ie!==133)break;if(H=ie,ce.r===2||ce.r==12){var _e=e.read_shift(2);if(le-=2,!Y.enc&&_e!==ie&&((_e&255)<<8|_e>>8)!==ie)throw new Error("rt mismatch: "+_e+"!="+ie);ce.r==12&&(e.l+=10,le-=10)}var ne={};if(ie===10?ne=ce.f(e,le,Y):ne=ope(ie,ce,e,le,Y),W==0&&[9,521,1033,2057].indexOf(H)===-1)continue;switch(ie){case 34:r.opts.Date1904=F.WBProps.date1904=ne;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=ne,!t.password)throw new Error("File is password-protected");if(ne.valid==null)throw new Error("Encryption scheme unsupported");if(!ne.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=ne;break;case 66:var pe=Number(ne);switch(pe){case 21010:pe=1200;break;case 32768:pe=1e4;break;case 32769:pe=1252;break}uc(Y.codepage=pe),ae=!0;break;case 317:Y.rrtabid=ne;break;case 25:Y.winlocked=ne;break;case 439:r.opts.RefreshAll=ne;break;case 12:r.opts.CalcCount=ne;break;case 16:r.opts.CalcDelta=ne;break;case 17:r.opts.CalcIter=ne;break;case 13:r.opts.CalcMode=ne;break;case 14:r.opts.CalcPrecision=ne;break;case 95:r.opts.CalcSaveRecalc=ne;break;case 15:Y.CalcRefMode=ne;break;case 2211:r.opts.FullCalc=ne;break;case 129:ne.fDialog&&(s["!type"]="dialog"),ne.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),ne.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:E.push(ne);break;case 430:M.push([ne]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(ne);break;case 24:case 536:Q={Name:ne.Name,Ref:Fi(ne.rgce,i,null,M,Y)},ne.itab>0&&(Q.Sheet=ne.itab-1),M.names.push(Q),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(ne),ne.Name=="_xlnm._FilterDatabase"&&ne.itab>0&&ne.rgce&&ne.rgce[0]&&ne.rgce[0][0]&&ne.rgce[0][0][0]=="PtgArea3d"&&(K[ne.itab-1]={ref:Jr(ne.rgce[0][0][1][2])});break;case 22:Y.ExternCount=ne;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(ne),M.XTI=M.XTI.concat(ne);break;case 2196:if(Y.biff<8)break;Q!=null&&(Q.Comment=ne[1]);break;case 18:s["!protect"]=ne;break;case 19:ne!==0&&Y.WTF&&console.error("Password verifier: "+ne);break;case 133:a[ne.pos]=ne,Y.snames.push(ne.name);break;case 10:{if(--W)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Jr(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ce=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Jr(i),i.e.r=Ce}i.e.r++,i.e.c++}se.length>0&&(s["!merges"]=se),ee.length>0&&(s["!objects"]=ee),te.length>0&&(s["!cols"]=te),L.length>0&&(s["!rows"]=L),F.Sheets.push(A)}u===""?d=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ne.BIFFVer]||8),Y.biffguess=ne.BIFFVer==0,ne.BIFFVer==0&&ne.dt==4096&&(Y.biff=5,ae=!0,uc(Y.codepage=28591)),Y.biff==8&&ne.BIFFVer==0&&ne.dt==16&&(Y.biff=2),W++)break;if(s=t.dense?[]:{},Y.biff<8&&!ae&&(ae=!0,uc(Y.codepage=t.codepage||1252)),Y.biff<5||ne.BIFFVer==0&&ne.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ae={pos:e.l-le,name:u};a[Ae.pos]=Ae,Y.snames.push(u)}else u=(a[X]||{name:""}).name;ne.dt==32&&(s["!type"]="chart"),ne.dt==64&&(s["!type"]="macro"),se=[],ee=[],Y.arrayf=k=[],te=[],L=[],V=!1,A={Hidden:(a[X]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[ne.r]||[])[ne.c]:s[Rr({c:ne.c,r:ne.r})])&&++ne.c,_={ixfe:ne.ixfe,XF:E[ne.ixfe]||{},v:ne.val,t:"n"},R>0&&(_.z=z[_.ixfe>>8&63]),zc(_,t,r.opts.Date1904),B({c:ne.c,r:ne.r},_,t);break;case 5:case 517:_={ixfe:ne.ixfe,XF:E[ne.ixfe],v:ne.val,t:ne.t},R>0&&(_.z=z[_.ixfe>>8&63]),zc(_,t,r.opts.Date1904),B({c:ne.c,r:ne.r},_,t);break;case 638:_={ixfe:ne.ixfe,XF:E[ne.ixfe],v:ne.rknum,t:"n"},R>0&&(_.z=z[_.ixfe>>8&63]),zc(_,t,r.opts.Date1904),B({c:ne.c,r:ne.r},_,t);break;case 189:for(var Ge=ne.c;Ge<=ne.C;++Ge){var Le=ne.rkrec[Ge-ne.c][0];_={ixfe:Le,XF:E[Le],v:ne.rkrec[Ge-ne.c][1],t:"n"},R>0&&(_.z=z[_.ixfe>>8&63]),zc(_,t,r.opts.Date1904),B({c:Ge,r:ne.r},_,t)}break;case 6:case 518:case 1030:{if(ne.val=="String"){o=ne;break}if(_=Mw(ne.val,ne.cell.ixfe,ne.tt),_.XF=E[_.ixfe],t.cellFormula){var At=ne.formula;if(At&&At[0]&&At[0][0]&&At[0][0][0]=="PtgExp"){var et=At[0][0][1][0],pt=At[0][0][1][1],lt=Rr({r:et,c:pt});C[lt]?_.f=""+Fi(ne.formula,i,ne.cell,M,Y):_.F=((t.dense?(s[et]||[])[pt]:s[lt])||{}).F}else _.f=""+Fi(ne.formula,i,ne.cell,M,Y)}R>0&&(_.z=z[_.ixfe>>8&63]),zc(_,t,r.opts.Date1904),B(ne.cell,_,t),o=ne}break;case 7:case 519:if(o)o.val=ne,_=Mw(ne,o.cell.ixfe,"s"),_.XF=E[_.ixfe],t.cellFormula&&(_.f=""+Fi(o.formula,i,o.cell,M,Y)),R>0&&(_.z=z[_.ixfe>>8&63]),zc(_,t,r.opts.Date1904),B(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(ne);var rt=Rr(ne[0].s);if(p=t.dense?(s[ne[0].s.r]||[])[ne[0].s.c]:s[rt],t.cellFormula&&p){if(!o||!rt||!p)break;p.f=""+Fi(ne[1],i,ne[0],M,Y),p.F=Jr(ne[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!o)break;C[Rr(o.cell)]=ne[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Rr(o.cell)],(p||{}).f=""+Fi(ne[0],i,f,M,Y)}}break;case 253:_=Mw(c[ne.isst].t,ne.ixfe,"s"),c[ne.isst].h&&(_.h=c[ne.isst].h),_.XF=E[_.ixfe],R>0&&(_.z=z[_.ixfe>>8&63]),zc(_,t,r.opts.Date1904),B({c:ne.c,r:ne.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:ne.ixfe,XF:E[ne.ixfe],t:"z"},R>0&&(_.z=z[_.ixfe>>8&63]),zc(_,t,r.opts.Date1904),B({c:ne.c,r:ne.r},_,t));break;case 190:if(t.sheetStubs)for(var ht=ne.c;ht<=ne.C;++ht){var Lt=ne.ixfe[ht-ne.c];_={ixfe:Lt,XF:E[Lt],t:"z"},R>0&&(_.z=z[_.ixfe>>8&63]),zc(_,t,r.opts.Date1904),B({c:ht,r:ne.r},_,t)}break;case 214:case 516:case 4:_=Mw(ne.val,ne.ixfe,"s"),_.XF=E[_.ixfe],R>0&&(_.z=z[_.ixfe>>8&63]),zc(_,t,r.opts.Date1904),B({c:ne.c,r:ne.r},_,t);break;case 0:case 512:W===1&&(i=ne);break;case 252:c=ne;break;case 1054:if(Y.biff==4){z[R++]=ne[1];for(var zt=0;zt<R+163&&Dr[zt]!=ne[1];++zt);zt>=163&&Zu(ne[1],R+163)}else Zu(ne[1],ne[0]);break;case 30:{z[R++]=ne;for(var Dt=0;Dt<R+163&&Dr[Dt]!=ne;++Dt);Dt>=163&&Zu(ne,R+163)}break;case 229:se=se.concat(ne);break;case 93:ee[ne.cmo[0]]=Y.lastobj=ne;break;case 438:Y.lastobj.TxO=ne;break;case 127:Y.lastobj.ImData=ne;break;case 440:for(w=ne[0].s.r;w<=ne[0].e.r;++w)for(v=ne[0].s.c;v<=ne[0].e.c;++v)p=t.dense?(s[w]||[])[v]:s[Rr({c:v,r:w})],p&&(p.l=ne[1]);break;case 2048:for(w=ne[0].s.r;w<=ne[0].e.r;++w)for(v=ne[0].s.c;v<=ne[0].e.c;++v)p=t.dense?(s[w]||[])[v]:s[Rr({c:v,r:w})],p&&p.l&&(p.l.Tooltip=ne[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;p=t.dense?(s[ne[0].r]||[])[ne[0].c]:s[Rr(ne[0])];var De=ee[ne[2]];p||(t.dense?(s[ne[0].r]||(s[ne[0].r]=[]),p=s[ne[0].r][ne[0].c]={t:"z"}):p=s[Rr(ne[0])]={t:"z"},i.e.r=Math.max(i.e.r,ne[0].r),i.s.r=Math.min(i.s.r,ne[0].r),i.e.c=Math.max(i.e.c,ne[0].c),i.s.c=Math.min(i.s.c,ne[0].c)),p.c||(p.c=[]),x={a:ne[1],t:De.TxO.t},p.c.push(x)}break;case 2173:Yde(E[ne.ixfe],ne.ext);break;case 125:{if(!Y.cellStyles)break;for(;ne.e>=ne.s;)te[ne.e--]={width:ne.w/256,level:ne.level||0,hidden:!!(ne.flags&1)},V||(V=!0,E3(ne.w/256)),Pf(te[ne.e+1])}break;case 520:{var Ie={};ne.level!=null&&(L[ne.r]=Ie,Ie.level=ne.level),ne.hidden&&(L[ne.r]=Ie,Ie.hidden=!0),ne.hpt&&(L[ne.r]=Ie,Ie.hpt=ne.hpt,Ie.hpx=Am(ne.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Qh(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=ne;break;case 161:s["!margins"]||Qh(s["!margins"]={}),s["!margins"].header=ne.header,s["!margins"].footer=ne.footer;break;case 574:ne.RTL&&(F.Views[0].RTL=!0);break;case 146:P=ne;break;case 2198:Z=ne;break;case 140:N=ne;break;case 442:u?A.CodeName=ne||A.name:F.WBProps.CodeName=ne||"ThisWorkbook";break}}else ce||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=le}return r.SheetNames=Us(a).sort(function(Ke,Je){return Number(Ke)-Number(Je)}).map(function(Ke){return a[Ke].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&K.forEach(function(Ke,Je){r.Sheets[r.SheetNames[Je]]["!autofilter"]=Ke}),r.Strings=c,r.SSF=cs(Dr),Y.enc&&(r.Encryption=Y.enc),Z&&(r.Themes=Z),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),M.names.length>0&&(F.Names=M.names),r.Workbook=F,r}var Dy={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function cpe(e,t,r){var n=Tr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=mO(n,vE,Dy.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Tr.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=mO(i,wE,Dy.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(H$(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function upe(e,t){var r=[],n=[],s=[],a=0,i,o=GF(vE,"n"),c=GF(wE,"n");if(e.Props)for(i=Us(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Us(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)Q$.indexOf(s[a][0])>-1||W$.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Tr.utils.cfb_add(t,"/SummaryInformation",pO(n,Dy.SI,c,wE)),(r.length||u.length)&&Tr.utils.cfb_add(t,"/DocumentSummaryInformation",pO(r,Dy.DSI,o,vE,u.length?u:null,Dy.UDI))}function VU(e,t){t||(t={}),R3(t),n3(),t.codepage&&r3(t.codepage);var r,n;if(e.FullPaths){if(Tr.find(e,"/encryption"))throw new Error("File is password-protected");r=Tr.find(e,"!CompObj"),n=Tr.find(e,"/Workbook")||Tr.find(e,"/Book")}else{switch(t.type){case"base64":e=qo(Zo(e));break;case"binary":e=qo(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}fi(e,0),n={content:e}}var s,a;if(r&&ape(r),t.bookProps&&!t.bookSheets)s={};else{var i=en?"buffer":"array";if(n&&n.content)s=lpe(n.content,t);else if((a=Tr.find(e,"PerfectOffice_MAIN"))&&a.content)s=Xh.to_workbook(a.content,(t.type=i,t));else if((a=Tr.find(e,"NativeContent_MAIN"))&&a.content)s=Xh.to_workbook(a.content,(t.type=i,t));else throw(a=Tr.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Tr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Sfe(e))}var o={};return e.FullPaths&&cpe(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function dpe(e,t){var r=t||{},n=Tr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Tr.utils.cfb_add(n,s,KU(e,r)),r.biff==8&&(e.Props||e.Custprops)&&upe(e,n),r.biff==8&&e.vbaraw&&kfe(n,Tr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var hv={0:{f:I0e},1:{f:W0e},2:{f:lge},3:{f:Q0e},4:{f:K0e},5:{f:age},6:{f:hge},7:{f:tge},8:{f:wge},9:{f:vge},10:{f:xge},11:{f:yge},12:{f:G0e},13:{f:uge},14:{f:Z0e},15:{f:Y0e},16:{f:LU},17:{f:mge},18:{f:nge},19:{f:x3},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:mme},40:{},42:{},43:{f:hde},44:{f:dde},45:{f:pde},46:{f:yde},47:{f:xde},48:{},49:{f:Loe},50:{},51:{f:Jde},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:lU},62:{f:fge},63:{f:ofe},64:{f:Rge},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ui,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Fge},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:U0e},148:{f:L0e,p:16},151:{f:Tge},152:{},153:{f:fme},154:{},155:{},156:{f:ume},157:{},158:{},159:{T:1,f:Nue},160:{T:-1},161:{T:1,f:R0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_ge},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Xde},336:{T:-1},337:{f:tfe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:yE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:oU},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Ege},427:{f:Nge},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:jge},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$0e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:kge},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:yE},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yfe},633:{T:1},634:{T:-1},635:{T:1,f:pfe},636:{T:-1},637:{f:zoe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Zge},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Mge},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},TE={6:{f:Pk},10:{f:lf},12:{f:ua},13:{f:ua},14:{f:Qs},15:{f:Qs},16:{f:Ii},17:{f:Qs},18:{f:Qs},19:{f:ua},20:{f:bO},21:{f:bO},23:{f:oU},24:{f:kO},25:{f:Qs},26:{},27:{},28:{f:Mce},29:{},34:{f:Qs},35:{f:SO},38:{f:Ii},39:{f:Ii},40:{f:Ii},41:{f:Ii},42:{f:Qs},43:{f:Qs},47:{f:Yue},49:{f:uce},51:{f:ua},60:{},61:{f:ace},64:{f:Qs},65:{f:cce},66:{f:ua},77:{},80:{},81:{},82:{},85:{f:ua},89:{},90:{},91:{},92:{f:qle},93:{f:$ce},94:{},95:{f:Qs},96:{},97:{},99:{f:Qs},125:{f:lU},128:{f:Cce},129:{f:Xle},130:{f:ua},131:{f:Qs},132:{f:Qs},133:{f:Qle},134:{},140:{f:qce},141:{f:ua},144:{},146:{f:Qce},151:{},152:{},153:{},154:{},155:{},156:{f:ua},157:{},158:{},160:{f:sue},161:{f:eue},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:_ce},190:{f:bce},193:{f:lf},197:{},198:{},199:{},200:{},201:{},202:{f:Qs},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ua},220:{},221:{f:Qs},222:{},224:{f:kce},225:{f:Kle},226:{f:lf},227:{},229:{f:Lce},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Zle},253:{f:fce},255:{f:tce},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:J$},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Qs},353:{f:lf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:jce},431:{f:Qs},432:{},433:{},434:{},437:{},438:{f:Wce},439:{f:Qs},440:{f:Hce},441:{},442:{f:Qv},443:{},444:{f:ua},445:{},446:{},448:{f:lf},449:{f:sce,r:2},450:{f:lf},512:{f:vO},513:{f:nue},515:{f:Nce},516:{f:gce},517:{f:_O},519:{f:aue},520:{f:rce},523:{},545:{f:CO},549:{f:yO},566:{},574:{f:oce},638:{f:wce},659:{},1048:{},1054:{f:pce},1084:{},1212:{f:Dce},2048:{f:Vce},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Dw},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:lf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Jce,r:12},2173:{f:qde,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Qs,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Oce,r:12},2197:{},2198:{f:zde,r:12},2199:{},2200:{},2201:{},2202:{f:Ice,r:12},2203:{f:lf},2204:{},2205:{},2206:{},2207:{},2211:{f:nce},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ua},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:tue},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Xce},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:vO},1:{},2:{f:uue},3:{f:lue},4:{f:oue},5:{f:_O},7:{f:fue},8:{},9:{f:Dw},11:{},22:{f:ua},30:{f:yce},31:{},32:{},33:{f:CO},36:{},37:{f:yO},50:{f:hue},62:{},52:{},67:{},68:{f:ua},69:{},86:{},126:{},127:{f:iue},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:gue},223:{},234:{},354:{},421:{},518:{f:Pk},521:{f:Dw},536:{f:kO},547:{f:SO},561:{},579:{},1030:{f:Pk},1033:{f:Dw},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function er(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&g3(r)&&e.push(r)}}function fpe(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return er(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function t1(e,t,r){return e||(e=St(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function hpe(e,t,r,n){var s=St(9);return t1(s,e,t),Z$(r,n||"b",s),s}function gpe(e,t,r){var n=St(8+2*r.length);return t1(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function mpe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Na(ls(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?er(e,2,due(r,n,s)):er(e,3,cue(r,n,s));return;case"b":case"e":er(e,5,hpe(r,n,t.v,t.t));return;case"s":case"str":er(e,4,gpe(r,n,(t.v||"").slice(0,255)));return}er(e,1,t1(null,r,n))}function ppe(e,t,r,n){var s=Array.isArray(t),a=yn(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Jr(a)}for(var u=a.s.r;u<=a.e.r;++u){o=ea(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=Ss(d)),i=c[d]+o;var f=s?(t[u]||[])[d]:t[i];f&&mpe(e,f,u,d)}}}function xpe(e,t){for(var r=t||{},n=Ao(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return er(n,r.biff==4?1033:r.biff==3?521:9,k3(e,16,r)),ppe(n,e.Sheets[e.SheetNames[s]],s,r),er(n,10),n.end()}function ype(e,t,r){er(e,49,dce({sz:12,name:"Arial"},r))}function vpe(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&er(e,1054,xce(s,t[s],r))})}function wpe(e,t){var r=St(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),er(e,2151,r),r=St(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),sU(yn(t["!ref"]||"A1"),r),r.write_shift(4,4),er(e,2152,r)}function _pe(e,t){for(var r=0;r<16;++r)er(e,224,wO({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){er(e,224,wO(n,0,t))})}function bpe(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];er(e,440,Gce(n)),n[1].Tooltip&&er(e,2048,Kce(n))}delete t["!links"]}function Spe(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&er(e,125,Zce(x2(s,n),s))})}}function kpe(e,t,r,n,s){var a=16+Hf(s.cellXfs,t,s);if(t.v==null&&!t.bf){er(e,513,w0(r,n,a));return}if(t.bf)er(e,6,Xhe(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Na(ls(t.v)):t.v;er(e,515,Ace(r,n,i,a));break;case"b":case"e":er(e,517,Ece(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=F3(s.Strings,t.v,s.revStrings);er(e,253,hce(r,n,o,a))}else er(e,516,mce(r,n,(t.v||"").slice(0,255),a,s));break;default:er(e,513,w0(r,n,a))}}function Cpe(e,t,r){var n=Ao(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",g=[],p=yn(a["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}er(n,2057,k3(r,16,t)),er(n,13,Sl(1)),er(n,12,Sl(100)),er(n,15,ro(!0)),er(n,17,ro(!1)),er(n,16,y0(.001)),er(n,95,ro(!0)),er(n,42,ro(!1)),er(n,43,ro(!1)),er(n,130,Sl(1)),er(n,128,Tce()),er(n,131,ro(!1)),er(n,132,ro(!1)),u&&Spe(n,a["!cols"]),er(n,512,vce(p,t)),u&&(a["!links"]=[]);for(var v=p.s.r;v<=p.e.r;++v){f=ea(v);for(var w=p.s.c;w<=p.e.c;++w){v===p.s.r&&(g[w]=Ss(w)),d=g[w]+f;var C=c?(a[v]||[])[w]:a[d];C&&(kpe(n,C,v,w,t),u&&C.l&&a["!links"].push([d,C.l]))}}var k=o.CodeName||o.name||s;return u&&er(n,574,lce((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&er(n,229,Bce(a["!merges"])),u&&bpe(n,a),er(n,442,eU(k)),u&&wpe(n,a),er(n,10),n.end()}function Tpe(e,t,r){var n=Ao(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(er(n,2057,k3(e,5,r)),r.bookType=="xla"&&er(n,135),er(n,225,o?Sl(1200):null),er(n,193,Ele(2)),c&&er(n,191),c&&er(n,192),er(n,226),er(n,92,Yle("SheetJS",r)),er(n,66,Sl(o?1200:1252)),o&&er(n,353,Sl(0)),o&&er(n,448),er(n,317,rue(e.SheetNames.length)),o&&e.vbaraw&&er(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";er(n,442,eU(u))}er(n,156,Sl(17)),er(n,25,ro(!1)),er(n,18,ro(!1)),er(n,19,Sl(0)),o&&er(n,431,ro(!1)),o&&er(n,444,Sl(0)),er(n,61,ice()),er(n,64,ro(!1)),er(n,141,Sl(0)),er(n,34,ro(sme(e)=="true")),er(n,14,ro(!0)),o&&er(n,439,ro(!1)),er(n,218,Sl(0)),ype(n,e,r),vpe(n,e.SSF,r),_pe(n,r),o&&er(n,352,ro(!1));var d=n.end(),f=Ao();o&&er(f,140,Yce()),o&&r.Strings&&fpe(f,252,ece(r.Strings)),er(f,10);var g=f.end(),p=Ao(),x=0,v=0;for(v=0;v<e.SheetNames.length;++v)x+=(o?12:11)+(o?2:1)*e.SheetNames[v].length;var w=d.length+x+g.length;for(v=0;v<e.SheetNames.length;++v){var C=a[v]||{};er(p,133,Jle({pos:w,hs:C.Hidden||0,dt:0,name:e.SheetNames[v]},r)),w+=t[v].length}var k=p.end();if(x!=k.length)throw new Error("BS8 "+x+" != "+k.length);var _=[];return d.length&&_.push(d),k.length&&_.push(k),g.length&&_.push(g),Ha(_)}function Epe(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=cs(Dr)),e&&e.SSF&&(tp(),u2(e.SSF),r.revssf=f2(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,M3(r),r.cellXfs=[],Hf(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=Cpe(s,r,e);return n.unshift(Tpe(e,n,r)),Ha(n)}function KU(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=jo(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return Epe(e,t);case 4:case 3:case 2:return xpe(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function IO(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=doe(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,g=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<c.length;++i){var v=c[i].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var C=v.split(/<\/t[dh]>/i);for(o=0;o<C.length;++o){var k=C[o].trim();if(k.match(/<t[dh]/i)){for(var _=k,N=0;_.charAt(0)=="<"&&(N=_.indexOf(">"))>-1;)_=_.slice(N+1);for(var E=0;E<x.length;++E){var P=x[E];P.s.c==d&&P.s.r<u&&u<=P.e.r&&(d=P.e.c+1,E=-1)}var F=Lr(k.slice(0,k.indexOf(">")));g=F.colspan?+F.colspan:1,((f=+F.rowspan)>1||g>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+g-1}});var A=F.t||F["data-t"]||"";if(!_.length){d+=g;continue}if(_=x$(_),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!_.length){d+=g;continue}var j={t:"s",v:_};r.raw||!_.trim().length||A=="s"||(_==="TRUE"?j={t:"b",v:!0}:_==="FALSE"?j={t:"b",v:!1}:isNaN(hc(_))?isNaN(Em(_).getDate())||(j={t:"d",v:ls(_)},r.cellDates||(j={t:"n",v:Na(j.v)}),j.z=r.dateNF||Dr[14]):j={t:"n",v:hc(_)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=j):n[Rr({r:u,c:d})]=j,d+=g}}}}return n["!ref"]=Jr(p),x.length&&(n["!merges"]=x),n}function Npe(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Rr({r,c:i}),f=n.dense?(e[r]||[])[i]:e[d],g=f&&f.v!=null&&(f.h||d3(f.w||(od(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?g='<span contenteditable="true">'+g+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+f.l.Target+'">'+g+"</a>")),p.id=(n.id||"sjs")+"-"+d,a.push(Zt("td",g,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var Ape='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',jpe="</body></html>";function Ppe(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Wf(IO(r[0],t),t);var n=$3();return r.forEach(function(s,a){U3(n,IO(s,t),"Sheet"+(a+1))}),n}function Fpe(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function qU(e,t){var r=t||{},n=r.header!=null?r.header:Ape,s=r.footer!=null?r.footer:jpe,a=[n],i=jo(e["!ref"]);r.dense=Array.isArray(e),a.push(Fpe(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(Npe(e,i,o,r));return a.push("</table>"+s),a.join("")}function YU(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?ks(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=jo(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],g=0,p=e["!rows"]||(e["!rows"]=[]),x=0,v=0,w=0,C=0,k=0,_=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&v<c;++x){var N=o[x];if(RO(N)){if(n.display)continue;p[v]={hidden:!0}}var E=N.children;for(w=C=0;w<E.length;++w){var P=E[w];if(!(n.display&&RO(P))){var F=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):x$(P.innerHTML),A=P.getAttribute("data-z")||P.getAttribute("z");for(g=0;g<f.length;++g){var j=f[g];j.s.c==C+a&&j.s.r<v+s&&v+s<=j.e.r&&(C=j.e.c+1-a,g=-1)}_=+P.getAttribute("colspan")||1,((k=+P.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:v+s,c:C+a},e:{r:v+s+(k||1)-1,c:C+a+(_||1)-1}});var I={t:"s",v:F},B=P.getAttribute("data-t")||P.getAttribute("t")||"";F!=null&&(F.length==0?I.t=B||"z":n.raw||F.trim().length==0||B=="s"||(F==="TRUE"?I={t:"b",v:!0}:F==="FALSE"?I={t:"b",v:!1}:isNaN(hc(F))?isNaN(Em(F).getDate())||(I={t:"d",v:ls(F)},n.cellDates||(I={t:"n",v:Na(I.v)}),I.z=n.dateNF||Dr[14]):I={t:"n",v:hc(F)})),I.z===void 0&&A!=null&&(I.z=A);var Y="",Z=P.getElementsByTagName("A");if(Z&&Z.length)for(var se=0;se<Z.length&&!(Z[se].hasAttribute("href")&&(Y=Z[se].getAttribute("href"),Y.charAt(0)!="#"));++se);Y&&Y.charAt(0)!="#"&&(I.l={Target:Y}),n.dense?(e[v+s]||(e[v+s]=[]),e[v+s][C+a]=I):e[Rr({c:C+a,r:v+s})]=I,u.e.c<C+a&&(u.e.c=C+a),C+=_}}++v}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,v-1+s),e["!ref"]=Jr(u),v>=c&&(e["!fullref"]=Jr((u.e.r=o.length-x+v-1+s,u))),e}function XU(e,t){var r=t||{},n=r.dense?[]:{};return YU(n,e,t)}function Ope(e,t){return Wf(XU(e,t),t)}function RO(e){var t="",r=Dpe(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Dpe(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Ipe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=xn(t.replace(/<[^>]*>/g,""));return[r]}var MO={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function QU(e,t){var r=t||{},n=f3(e),s=[],a,i,o={name:""},c="",u=0,d,f,g={},p=[],x=r.dense?[]:{},v,w,C={value:""},k="",_=0,N=[],E=-1,P=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,j={},I=[],B={},Y=0,Z=0,se=[],ee=1,te=1,L=[],V={Names:[]},M={},H=["",""],W=[],R={},z="",K=0,Q=!1,ae=!1,X=0;for(ov.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=ov.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?x["!ref"]=Jr(F):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(x["!fullref"]=x["!ref"],F.e.r=r.sheetRows-1,x["!ref"]=Jr(F)),I.length&&(x["!merges"]=I),se.length&&(x["!rows"]=se),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),g[d.name]=x,ae=!1):v[0].charAt(v[0].length-2)!=="/"&&(d=Lr(v[0],!1),E=P=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,x=r.dense?[]:{},I=[],se=[],ae=!0);break;case"table-row-group":v[1]==="/"?--A:++A;break;case"table-row":case"":if(v[1]==="/"){E+=ee,ee=1;break}if(f=Lr(v[0],!1),f.?E=f.-1:E==-1&&(E=0),ee=+f["number-rows-repeated"]||1,ee<10)for(X=0;X<ee;++X)A>0&&(se[E+X]={level:A});P=-1;break;case"covered-table-cell":v[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(x[E]||(x[E]=[]),x[E][P]={t:"z"}):x[Rr({r:E,c:P})]={t:"z"}),k="",N=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++P,C=Lr(v[0],!1),te=parseInt(C["number-columns-repeated"]||"1",10),w={t:"z",v:null},C.formula&&r.cellFormula!=!1&&(w.f=FO(xn(C.formula))),(C.||C["value-type"])=="string"&&(w.t="s",w.v=xn(C["string-value"]||""),r.dense?(x[E]||(x[E]=[]),x[E][P]=w):x[Rr({r:E,c:P})]=w),P+=te-1;else if(v[1]!=="/"){++P,k="",_=0,N=[],te=1;var ie=ee?E+ee-1:E;if(P>F.e.c&&(F.e.c=P),P<F.s.c&&(F.s.c=P),E<F.s.r&&(F.s.r=E),ie>F.e.r&&(F.e.r=ie),C=Lr(v[0],!1),W=[],R={},w={t:C.||C["value-type"],v:null},r.cellFormula)if(C.formula&&(C.formula=xn(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(Y=parseInt(C["number-matrix-rows-spanned"],10)||0,Z=parseInt(C["number-matrix-columns-spanned"],10)||0,B={s:{r:E,c:P},e:{r:E+Y-1,c:P+Z-1}},w.F=Jr(B),L.push([B,w.F])),C.formula)w.f=FO(C.formula);else for(X=0;X<L.length;++X)E>=L[X][0].s.r&&E<=L[X][0].e.r&&P>=L[X][0].s.c&&P<=L[X][0].e.c&&(w.F=L[X][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(Y=parseInt(C["number-rows-spanned"],10)||0,Z=parseInt(C["number-columns-spanned"],10)||0,B={s:{r:E,c:P},e:{r:E+Y-1,c:P+Z-1}},I.push(B)),C["number-columns-repeated"]&&(te=parseInt(C["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=as(C["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(C.value);break;case"percentage":w.t="n",w.v=parseFloat(C.value);break;case"currency":w.t="n",w.v=parseFloat(C.value);break;case"date":w.t="d",w.v=ls(C["date-value"]),r.cellDates||(w.t="n",w.v=Na(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=loe(C["time-value"])/86400,r.cellDates&&(w.t="d",w.v=h2(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(C.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",C["string-value"]!=null&&(k=xn(C["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(Q=!1,w.t==="s"&&(w.v=k||"",N.length&&(w.R=N),Q=_==0),M.Target&&(w.l=M),W.length>0&&(w.c=W,W=[]),k&&r.cellText!==!1&&(w.w=k),Q&&(w.t="z",delete w.v),(!Q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var le=0;le<ee;++le){if(te=parseInt(C["number-columns-repeated"]||"1",10),r.dense)for(x[E+le]||(x[E+le]=[]),x[E+le][P]=le==0?w:cs(w);--te>0;)x[E+le][P+te]=cs(w);else for(x[Rr({r:E+le,c:P})]=w;--te>0;)x[Rr({r:E+le,c:P+te})]=cs(w);F.e.c<=P&&(F.e.c=P)}te=parseInt(C["number-columns-repeated"]||"1",10),P+=te-1,te=0,w={},k="",N=[]}M={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;R.t=k,N.length&&(R.R=N),R.a=z,W.push(R)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);z="",K=0,k="",_=0,N=[];break;case"creator":v[1]==="/"?z=n.slice(K,v.index):K=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);k="",_=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(j[o.name]=c,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(c="",o=Lr(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Lr(v[0],!1),c+=MO[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Lr(v[0],!1),c+=MO[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,v.index);break}else u=v.index+v[0].length;break;case"named-range":i=Lr(v[0],!1),H=Fk(i["cell-range-address"]);var ce={Name:i.name,Ref:H[0]+"!"+H[1]};ae&&(ce.Sheet=p.length),V.Names.push(ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!C||!C["string-value"])){var _e=Ipe(n.slice(_,v.index));k=(k.length>0?k+`
`:"")+_e[0]}else Lr(v[0],!1),_=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{H=Fk(Lr(v[0])["target-range-address"]),g[H[0]]["!autofilter"]={ref:H[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(M=Lr(v[0],!1),!M.href)break;M.Target=xn(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(H=Fk(M.Target.slice(1)),M.Target="#"+H[0]+"!"+H[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var ne={Sheets:g,SheetNames:p,Workbook:V};return r.bookSheets&&delete ne.Sheets,ne}function LO(e,t){t=t||{},bl(e,"META-INF/manifest.xml")&&lle(ca(e,"META-INF/manifest.xml"),t);var r=Yo(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=QU(Hn(r),t);return bl(e,"meta.xml")&&(n.Props=U$(ca(e,"meta.xml"))),n}function BO(e,t){return QU(e,t)}var Rpe=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+iv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ra+t}})(),$O=(function(){var e=function(a){return Ln(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+Ln(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=jo(a["!ref"]||"A1"),g=a["!merges"]||[],p=0,x=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var v="",w=a["!rows"]||[];for(u=0;u<f.s.r;++u)v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+v+`></table:table-row>
`);for(;u<=f.e.r;++u){for(v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+v+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var C=!1,k={},_="";for(p=0;p!=g.length;++p)if(!(g[p].s.c>d)&&!(g[p].s.r>u)&&!(g[p].e.c<d)&&!(g[p].e.r<u)){(g[p].s.c!=d||g[p].s.r!=u)&&(C=!0),k["table:number-columns-spanned"]=g[p].e.c-g[p].s.c+1,k["table:number-rows-spanned"]=g[p].e.r-g[p].s.r+1;break}if(C){c.push(r);continue}var N=Rr({r:u,c:d}),E=x?(a[u]||[])[d]:a[N];if(E&&E.f&&(k["table:formula"]=Ln(r0e(E.f)),E.F&&E.F.slice(0,N.length)==N)){var P=jo(E.F);k["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,k["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!E){c.push(t);continue}switch(E.t){case"b":_=E.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=E.v?"true":"false";break;case"n":_=E.w||String(E.v||0),k["office:value-type"]="float",k["office:value"]=E.v||0;break;case"s":case"str":_=E.v==null?"":E.v,k["office:value-type"]="string";break;case"d":_=E.w||ls(E.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=ls(E.v).toISOString(),k["table:style-name"]="ce1";break;default:c.push(t);continue}var F=e(_);if(E.l&&E.l.Target){var A=E.l.Target;A=A.charAt(0)=="#"?"#"+n0e(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),F=Zt("text:a",F,{"xlink:href":A.replace(/&/g,"&amp;")})}c.push("          "+Zt("table:table-cell",Zt("text:p",F,{}),k)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Pf(f),f.ods=o;var g=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[ra],u=iv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=iv({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push($$().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(n(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function JU(e,t){if(t.bookType=="fods")return $O(e,t);var r=l3(),n="",s=[],a=[];return n="mimetype",Zr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Zr(r,n,$O(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Zr(r,n,Rpe(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Zr(r,n,ra+$$()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Zr(r,n,dle(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Zr(r,n,cle(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function EE(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Hn(zf(e))}function Mpe(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):qo(Xc(e))}function Lpe(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Of(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function UO(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Bpe(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function $pe(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function gv(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Dn(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function $s(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function wn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=gv(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=gv(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function oi(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Dn(n*8+s.type)),s.type==2&&t.push(Dn(s.data.length)),t.push(s.data))})}),Of(t)}function I3(e,t){return e?.map(function(r){return t(r.data)})||[]}function yl(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=gv(e,n),a=wn(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:$s(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=wn(o.data),u=$s(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=$s(a[3][0].data)>>>0>0),r.push(i)}return r}function Lg(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Dn(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Dn(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:Dn(i.data.length)}],n[2].push({data:oi(i.meta),type:2})});var a=oi(n);t.push(Dn(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Of(t)}function Upe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=gv(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Of(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=Of(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function vl(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Upe(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Of(t)}function Bg(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=Dn(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Of(t)}function zpe(e,t,r,n){var s=_0(e),a=s.getUint32(4,!0),i=(n>1?12:8)+UO(a&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=UO(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Wpe(e,t,r){var n=_0(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=Bpe(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function Dk(e,t){var r=new Uint8Array(32),n=_0(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,$pe(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Ik(e,t){var r=new Uint8Array(32),n=_0(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Hpe(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return zpe(e,t,r,e[0]);case 5:return Wpe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Pi(e){var t=wn(e);return gv(t[1][0].data)}function zO(e,t){var r=wn(t.data),n=$s(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=wn(i.data),c=$s(o[1][0].data)>>>0;switch(n){case 1:a[c]=EE(o[3][0].data);break;case 8:{var u=e[Pi(o[9][0].data)][0],d=wn(u.data),f=e[Pi(d[1][0].data)][0],g=$s(f.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var p=wn(f.data);a[c]=p[3].map(function(x){return EE(x.data)}).join("")}break}}),a}function Gpe(e,t){var r,n,s,a,i,o,c,u,d,f,g,p,x,v,w=wn(e),C=$s(w[1][0].data)>>>0,k=$s(w[2][0].data)>>>0,_=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&$s(w[8][0].data)>0||!1,N,E;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,E=(u=(c=w[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=w[4])==null?void 0:d[0])!=null&&f.data&&t!=1)N=(p=(g=w[4])==null?void 0:g[0])==null?void 0:p.data,E=(v=(x=w[3])==null?void 0:x[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=_?4:1,F=_0(N),A=[],j=0;j<N.length/2;++j){var I=F.getUint16(j*2,!0);I<65535&&A.push([j,I])}if(A.length!=k)throw"Expected ".concat(k," cells, found ").concat(A.length);var B=[];for(j=0;j<A.length-1;++j)B[A[j][0]]=E.subarray(A[j][1]*P,A[j+1][1]*P);return A.length>=1&&(B[A[A.length-1][0]]=E.subarray(A[A.length-1][1]*P)),{R:C,cells:B}}function Vpe(e,t){var r,n=wn(t.data),s=(r=n?.[7])!=null&&r[0]?$s(n[7][0].data)>>>0>0?1:0:-1,a=I3(n[5],function(i){return Gpe(i,s)});return{nrows:$s(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function Kpe(e,t,r){var n,s=wn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=($s(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=($s(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Jr(a);var i=wn(s[4][0].data),o=zO(e,e[Pi(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?zO(e,e[Pi(i[17][0].data)][0]):[],u=wn(i[3][0].data),d=0;u[1].forEach(function(f){var g=wn(f.data),p=e[Pi(g[2][0].data)][0],x=$s(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var v=Vpe(e,p);v.data.forEach(function(w,C){w.forEach(function(k,_){var N=Rr({r:d+C,c:_}),E=Hpe(k,o,c);E&&(r[N]=E)})}),d+=v.nrows})}function qpe(e,t){var r=wn(t.data),n={"!ref":"A1"},s=e[Pi(r[2][0].data)],a=$s(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Kpe(e,s[0],n),n}function Ype(e,t){var r,n=wn(t.data),s={name:(r=n[1])!=null&&r[0]?EE(n[1][0].data):"",sheets:[]},a=I3(n[2],Pi);return a.forEach(function(i){e[i].forEach(function(o){var c=$s(o.meta[1][0].data);c==6e3&&s.sheets.push(qpe(e,o))})}),s}function Xpe(e,t){var r=$3(),n=wn(t.data),s=I3(n[1],Pi);if(s.forEach(function(a){e[a].forEach(function(i){var o=$s(i.meta[1][0].data);if(o==2){var c=Ype(e,i);c.sheets.forEach(function(u,d){U3(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Rk(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=vl(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=yl(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&$s(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(u){var d=$s(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Xpe(a,o)}function Qpe(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&$s(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=_0(e[7][0].data),d=0,f=[],g=_0(e[4][0].data),p=0,x=[],v=0;v<t.length;++v){if(t[v]==null){u.setUint16(v*2,65535,!0),g.setUint16(v*2,65535);continue}u.setUint16(v*2,d,!0),g.setUint16(v*2,p,!0);var w,C;switch(typeof t[v]){case"string":w=Dk({t:"s",v:t[v]},r),C=Ik({t:"s",v:t[v]},r);break;case"number":w=Dk({t:"n",v:t[v]},r),C=Ik({t:"n",v:t[v]},r);break;case"boolean":w=Dk({t:"b",v:t[v]},r),C=Ik({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}f.push(w),d+=w.length,x.push(C),p+=C.length,++c}for(e[2][0].data=Dn(c);v<e[7][0].data.length/2;++v)u.setUint16(v*2,65535,!0),g.setUint16(v*2,65535,!0);return e[6][0].data=Of(f),e[3][0].data=Of(x),c}function Jpe(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=jo(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Jr(n)));var a=eb(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(z){return z.forEach(function(K){typeof K=="string"&&i.push(K)})});var o={},c=[],u=Tr.read(t.numbers,{type:"base64"});u.FileIndex.map(function(z,K){return[z,u.FullPaths[K]]}).forEach(function(z){var K=z[0],Q=z[1];if(K.type==2&&K.name.match(/\.iwa/)){var ae=K.content,X=vl(ae),ie=yl(X);ie.forEach(function(le){c.push(le.id),o[le.id]={deps:[],location:Q,type:$s(le.messages[0].meta[1][0].data)}})}}),c.sort(function(z,K){return z-K});var d=c.filter(function(z){return z>1}).map(function(z){return[z,Dn(z)]});u.FileIndex.map(function(z,K){return[z,u.FullPaths[K]]}).forEach(function(z){var K=z[0];if(z[1],!!K.name.match(/\.iwa/)){var Q=yl(vl(K.content));Q.forEach(function(ae){ae.messages.forEach(function(X){d.forEach(function(ie){ae.messages.some(function(le){return $s(le.meta[1][0].data)!=11006&&Lpe(le.data,ie[1])})&&o[ie[0]].deps.push(ae.id)})})})}});for(var f=Tr.find(u,o[1].location),g=yl(vl(f.content)),p,x=0;x<g.length;++x){var v=g[x];v.id==1&&(p=v)}var w=Pi(wn(p.messages[0].data)[1][0].data);for(f=Tr.find(u,o[w].location),g=yl(vl(f.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);for(w=Pi(wn(p.messages[0].data)[2][0].data),f=Tr.find(u,o[w].location),g=yl(vl(f.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);for(w=Pi(wn(p.messages[0].data)[2][0].data),f=Tr.find(u,o[w].location),g=yl(vl(f.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);var C=wn(p.messages[0].data);{C[6][0].data=Dn(n.e.r+1),C[7][0].data=Dn(n.e.c+1);var k=Pi(C[46][0].data),_=Tr.find(u,o[k].location),N=yl(vl(_.content));{for(var E=0;E<N.length&&N[E].id!=k;++E);if(N[E].id!=k)throw"Bad ColumnRowUIDMapArchive";var P=wn(N[E].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var F=0;F<=n.e.c;++F){var A=[];A[1]=A[2]=[{type:0,data:Dn(F+420690)}],P[1].push({type:2,data:oi(A)}),P[2].push({type:0,data:Dn(F)}),P[3].push({type:0,data:Dn(F)})}P[4]=[],P[5]=[],P[6]=[];for(var j=0;j<=n.e.r;++j)A=[],A[1]=A[2]=[{type:0,data:Dn(j+726270)}],P[4].push({type:2,data:oi(A)}),P[5].push({type:0,data:Dn(j)}),P[6].push({type:0,data:Dn(j)});N[E].messages[0].data=oi(P)}_.content=Bg(Lg(N)),_.size=_.content.length,delete C[46];var I=wn(C[4][0].data);{I[7][0].data=Dn(n.e.r+1);var B=wn(I[1][0].data),Y=Pi(B[2][0].data);_=Tr.find(u,o[Y].location),N=yl(vl(_.content));{if(N[0].id!=Y)throw"Bad HeaderStorageBucket";var Z=wn(N[0].messages[0].data);for(j=0;j<a.length;++j){var se=wn(Z[2][0].data);se[1][0].data=Dn(j),se[4][0].data=Dn(a[j].length),Z[2][j]={type:Z[2][0].type,data:oi(se)}}N[0].messages[0].data=oi(Z)}_.content=Bg(Lg(N)),_.size=_.content.length;var ee=Pi(I[2][0].data);_=Tr.find(u,o[ee].location),N=yl(vl(_.content));{if(N[0].id!=ee)throw"Bad HeaderStorageBucket";for(Z=wn(N[0].messages[0].data),F=0;F<=n.e.c;++F)se=wn(Z[2][0].data),se[1][0].data=Dn(F),se[4][0].data=Dn(n.e.r+1),Z[2][F]={type:Z[2][0].type,data:oi(se)};N[0].messages[0].data=oi(Z)}_.content=Bg(Lg(N)),_.size=_.content.length;var te=Pi(I[4][0].data);(function(){for(var z=Tr.find(u,o[te].location),K=yl(vl(z.content)),Q,ae=0;ae<K.length;++ae){var X=K[ae];X.id==te&&(Q=X)}var ie=wn(Q.messages[0].data);{ie[3]=[];var le=[];i.forEach(function(ne,pe){le[1]=[{type:0,data:Dn(pe)}],le[2]=[{type:0,data:Dn(1)}],le[3]=[{type:2,data:Mpe(ne)}],ie[3].push({type:2,data:oi(le)})})}Q.messages[0].data=oi(ie);var ce=Lg(K),_e=Bg(ce);z.content=_e,z.size=z.content.length})();var L=wn(I[3][0].data);{var V=L[1][0];delete L[2];var M=wn(V.data);{var H=Pi(M[2][0].data);(function(){for(var z=Tr.find(u,o[H].location),K=yl(vl(z.content)),Q,ae=0;ae<K.length;++ae){var X=K[ae];X.id==H&&(Q=X)}var ie=wn(Q.messages[0].data);{delete ie[6],delete L[7];var le=new Uint8Array(ie[5][0].data);ie[5]=[];for(var ce=0,_e=0;_e<=n.e.r;++_e){var ne=wn(le);ce+=Qpe(ne,a[_e],i),ne[1][0].data=Dn(_e),ie[5].push({data:oi(ne),type:2})}ie[1]=[{type:0,data:Dn(n.e.c+1)}],ie[2]=[{type:0,data:Dn(n.e.r+1)}],ie[3]=[{type:0,data:Dn(ce)}],ie[4]=[{type:0,data:Dn(n.e.r+1)}]}Q.messages[0].data=oi(ie);var pe=Lg(K),Ce=Bg(pe);z.content=Ce,z.size=z.content.length})()}V.data=oi(M)}I[3][0].data=oi(L)}C[4][0].data=oi(I)}p.messages[0].data=oi(C);var W=Lg(g),R=Bg(W);return f.content=R,f.size=f.content.length,u}function ZU(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function R3(e){ZU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function M3(e){ZU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Zpe(e){return sn.WS.indexOf(e)>-1?"sheet":e==sn.CS?"chart":e==sn.DS?"dialog":e==sn.MS?"macro":e&&e.length?e:"sheet"}function exe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Zpe(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function txe(e,t,r,n,s,a,i,o,c,u,d,f){try{a[n]=jy(Yo(e,r,!0),t);var g=ca(e,t),p;switch(o){case"sheet":p=Sme(g,t,s,c,a[n],u,d,f);break;case"chart":if(p=kme(g,t,s,c,a[n],u,d,f),!p||!p["!drawel"])break;var x=gy(p["!drawel"].Target,t),v=lv(x),w=ufe(Yo(e,x,!0),jy(Yo(e,v,!0),x)),C=gy(w,x),k=lv(C);p=Qge(Yo(e,C,!0),C,c,jy(Yo(e,k,!0),C),u,p);break;case"macro":p=Cme(g,t,s,c,a[n],u,d,f);break;case"dialog":p=Tme(g,t,s,c,a[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var _=[];a&&a[n]&&Us(a[n]).forEach(function(N){var E="";if(a[n][N].Type==sn.CMNT){E=gy(a[n][N].Target,t);var P=jme(ca(e,E,!0),E,c);if(!P||!P.length)return;EO(p,P,!1)}a[n][N].Type==sn.TCMNT&&(E=gy(a[n][N].Target,t),_=_.concat(ffe(ca(e,E,!0),c)))}),_&&_.length&&EO(p,_,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function pl(e){return e.charAt(0)=="/"?e.slice(1):e}function rxe(e,t){if(tp(),t=t||{},R3(t),bl(e,"META-INF/manifest.xml")||bl(e,"objectdata.xml"))return LO(e,t);if(bl(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Rk<"u"){if(e.FileIndex)return Rk(e);var r=Tr.utils.cfb_new();return qF(e).forEach(function(se){Zr(r,se,hoe(e,se))}),Rk(r)}throw new Error("Unsupported NUMBERS file")}if(!bl(e,"[Content_Types].xml"))throw bl(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):bl(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=qF(e),s=ile(Yo(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",ca(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!ca(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Py=[],s.sst)try{Py=Ame(ca(e,pl(s.sst)),s.sst,t)}catch(se){if(t.WTF)throw se}t.cellStyles&&s.themes.length&&(c=Nme(Yo(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=Eme(ca(e,pl(s.style)),s.style,c,t))}s.links.map(function(se){try{var ee=jy(Yo(e,lv(pl(se))),se);return Fme(ca(e,pl(se)),ee,se,t)}catch{}});var d=bme(ca(e,pl(s.workbooks[0])),s.workbooks[0],t),f={},g="";s.coreprops.length&&(g=ca(e,pl(s.coreprops[0]),!0),g&&(f=U$(g)),s.extprops.length!==0&&(g=ca(e,pl(s.extprops[0]),!0),g&&hle(g,f,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(g=Yo(e,pl(s.custprops[0]),!0),g&&(p=mle(g,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(ee){return ee.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var v={};t.bookDeps&&s.calcchain&&(v=Pme(ca(e,pl(s.calcchain)),s.calcchain));var w=0,C={},k,_;{var N=d.Sheets;f.Worksheets=N.length,f.SheetNames=[];for(var E=0;E!=N.length;++E)f.SheetNames[E]=N[E].name}var P=a?"bin":"xml",F=s.workbooks[0].lastIndexOf("/"),A=(s.workbooks[0].slice(0,F+1)+"_rels/"+s.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");bl(e,A)||(A="xl/_rels/workbook."+P+".rels");var j=jy(Yo(e,A,!0),A.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=Ome(ca(e,pl(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=gfe(ca(e,pl(s.people[0])),t)),j&&(j=exe(j,d.Sheets));var I=ca(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=f.Worksheets;++w){var B="sheet";if(j&&j[w]?(k="xl/"+j[w][1].replace(/[\/]?xl\//,""),bl(e,k)||(k=j[w][1]),bl(e,k)||(k=A.replace(/_rels\/.*$/,"")+j[w][1]),B=j[w][2]):(k="xl/worksheets/sheet"+(w+1-I)+"."+P,k=k.replace(/sheet0\./,"sheet.")),_=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(f.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Y=!1,Z=0;Z!=t.sheets.length;++Z)typeof t.sheets[Z]=="number"&&t.sheets[Z]==w&&(Y=1),typeof t.sheets[Z]=="string"&&t.sheets[Z].toLowerCase()==f.SheetNames[w].toLowerCase()&&(Y=1);if(!Y)continue e}}txe(e,k,_,f.SheetNames[w],w,C,i,B,t,d,c,u)}return x={Directory:s,Workbook:d,Props:f,Custprops:p,Deps:v,Sheets:i,SheetNames:f.SheetNames,Strings:Py,Styles:u,Themes:c,SSF:cs(Dr)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(se,ee){se=se.replace(/^Root Entry[\/]/,""),x.keys.push(se),x.files[se]=e.FileIndex[ee]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=ca(e,pl(s.vba[0]),!0):s.defaults&&s.defaults.bin===bfe&&(x.vbaraw=ca(e,"xl/vbaProject.bin",!0))),x}function nxe(e,t){var r=t||{},n="Workbook",s=Tr.find(e,n);try{if(n="/!DataSpaces/Version",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Oue(s.content),n="/!DataSpaces/DataSpaceMap",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Iue(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Rue(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Lue(s.content)}catch{}if(n="/EncryptionInfo",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Bue(s.content);if(n="/EncryptedPackage",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function sxe(e,t){return t.bookType=="ods"?JU(e,t):t.bookType=="numbers"?Jpe(e,t):t.bookType=="xlsb"?axe(e,t):ixe(e,t)}function axe(e,t){nm=1024,e&&!e.SSF&&(e.SSF=cs(Dr)),e&&e.SSF&&(tp(),u2(e.SSF),t.revssf=f2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Fy?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=TU.indexOf(t.bookType)>-1,s=b3();M3(t=t||{});var a=l3(),i="",o=0;if(t.cellXfs=[],Hf(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Zr(a,i,z$(e.Props,t)),s.coreprops.push(i),Rn(t.rels,2,i,sn.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Zr(a,i,G$(e.Props)),s.extprops.push(i),Rn(t.rels,3,i,sn.EXT_PROPS),e.Custprops!==e.Props&&Us(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Zr(a,i,V$(e.Custprops)),s.custprops.push(i),Rn(t.rels,4,i,sn.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],g=(f||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Zr(a,i,Ime(o-1,i,t,e,d)),s.sheets.push(i),Rn(t.wbrels,-1,"worksheets/sheet"+o+"."+r,sn.WS[0])}if(f){var p=f["!comments"],x=!1,v="";p&&p.length>0&&(v="xl/comments"+o+"."+r,Zr(a,v,Lme(p,v)),s.comments.push(v),Rn(d,-1,"../comments"+o+"."+r,sn.CMNT),x=!0),f["!legacy"]&&x&&Zr(a,"xl/drawings/vmlDrawing"+o+".vml",kU(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Zr(a,lv(i),hm(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Zr(a,i,Mme(t.Strings,i,t)),s.strs.push(i),Rn(t.wbrels,-1,"sharedStrings."+r,sn.SST)),i="xl/workbook."+r,Zr(a,i,Dme(e,i)),s.workbooks.push(i),Rn(t.rels,1,i,sn.WB),i="xl/theme/theme1.xml",Zr(a,i,N3(e.Themes,t)),s.themes.push(i),Rn(t.wbrels,-1,"theme/theme1.xml",sn.THEME),i="xl/styles."+r,Zr(a,i,Rme(e,i,t)),s.styles.push(i),Rn(t.wbrels,-1,"styles."+r,sn.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Zr(a,i,e.vbaraw),s.vba.push(i),Rn(t.wbrels,-1,"vbaProject.bin",sn.VBA)),i="xl/metadata."+r,Zr(a,i,Bme(i)),s.metadata.push(i),Rn(t.wbrels,-1,"metadata."+r,sn.XLMETA),Zr(a,"[Content_Types].xml",B$(s,t)),Zr(a,"_rels/.rels",hm(t.rels)),Zr(a,"xl/_rels/workbook."+r+".rels",hm(t.wbrels)),delete t.revssf,delete t.ssf,a}function ixe(e,t){nm=1024,e&&!e.SSF&&(e.SSF=cs(Dr)),e&&e.SSF&&(tp(),u2(e.SSF),t.revssf=f2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Fy?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=TU.indexOf(t.bookType)>-1,s=b3();M3(t=t||{});var a=l3(),i="",o=0;if(t.cellXfs=[],Hf(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Zr(a,i,z$(e.Props,t)),s.coreprops.push(i),Rn(t.rels,2,i,sn.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Zr(a,i,G$(e.Props)),s.extprops.push(i),Rn(t.rels,3,i,sn.EXT_PROPS),e.Custprops!==e.Props&&Us(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Zr(a,i,V$(e.Custprops)),s.custprops.push(i),Rn(t.rels,4,i,sn.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},g=e.Sheets[e.SheetNames[o-1]],p=(g||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Zr(a,i,MU(o-1,t,e,f)),s.sheets.push(i),Rn(t.wbrels,-1,"worksheets/sheet"+o+"."+r,sn.WS[0])}if(g){var x=g["!comments"],v=!1,w="";if(x&&x.length>0){var C=!1;x.forEach(function(k){k[1].forEach(function(_){_.T==!0&&(C=!0)})}),C&&(w="xl/threadedComments/threadedComment"+o+"."+r,Zr(a,w,hfe(x,d,t)),s.threadedcomments.push(w),Rn(f,-1,"../threadedComments/threadedComment"+o+"."+r,sn.TCMNT)),w="xl/comments"+o+"."+r,Zr(a,w,CU(x)),s.comments.push(w),Rn(f,-1,"../comments"+o+"."+r,sn.CMNT),v=!0}g["!legacy"]&&v&&Zr(a,"xl/drawings/vmlDrawing"+o+".vml",kU(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}f["!id"].rId1&&Zr(a,lv(i),hm(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Zr(a,i,fU(t.Strings,t)),s.strs.push(i),Rn(t.wbrels,-1,"sharedStrings."+r,sn.SST)),i="xl/workbook."+r,Zr(a,i,zU(e)),s.workbooks.push(i),Rn(t.rels,1,i,sn.WB),i="xl/theme/theme1.xml",Zr(a,i,N3(e.Themes,t)),s.themes.push(i),Rn(t.wbrels,-1,"theme/theme1.xml",sn.THEME),i="xl/styles."+r,Zr(a,i,wU(e,t)),s.styles.push(i),Rn(t.wbrels,-1,"styles."+r,sn.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Zr(a,i,e.vbaraw),s.vba.push(i),Rn(t.wbrels,-1,"vbaProject.bin",sn.VBA)),i="xl/metadata."+r,Zr(a,i,SU()),s.metadata.push(i),Rn(t.wbrels,-1,"metadata."+r,sn.XLMETA),d.length>1&&(i="xl/persons/person.xml",Zr(a,i,mfe(d)),s.people.push(i),Rn(t.wbrels,-1,"persons/person.xml",sn.PEOPLE)),Zr(a,"[Content_Types].xml",B$(s,t)),Zr(a,"_rels/.rels",hm(t.rels)),Zr(a,"xl/_rels/workbook."+r+".rels",hm(t.wbrels)),delete t.revssf,delete t.ssf,a}function L3(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Zo(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function oxe(e,t){return Tr.find(e,"EncryptedPackage")?nxe(e,t):VU(e,t)}function lxe(e,t){var r,n=e,s=t||{};return s.type||(s.type=en&&Buffer.isBuffer(e)?"buffer":"base64"),r=g$(n,s),rxe(r,s)}function ez(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return CE(e.slice(r),t);default:break e}return Nm.to_workbook(e,t)}function cxe(e,t){var r="",n=L3(e,t);switch(t.type){case"base64":r=Zo(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=x0(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Hn(r)),t.type="binary",ez(r,t)}function uxe(e,t){var r=e;return t.type=="base64"&&(r=Zo(r)),r=rv.utils.decode(1200,r.slice(2),"str"),t.type="binary",ez(r,t)}function dxe(e){return e.match(/[^\x00-\x7F]/)?Xc(e):e}function Mk(e,t,r,n){return n?(r.type="string",Nm.to_workbook(e,r)):Nm.to_workbook(t,r)}function NE(e,t){n3();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return NE(new Uint8Array(e),(r=cs(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),mm={},r.dateNF&&(mm.dateNF=r.dateNF),r.type||(r.type=en&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=en?"buffer":"binary",n=aoe(e),typeof Uint8Array<"u"&&!en&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=dxe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=cs(r),r.type="array",NE(s3(n),r)}switch((s=L3(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return oxe(Tr.read(n,r),r);break;case 9:if(s[1]<=8)return VU(n,r);break;case 60:return CE(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return pue(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return uU.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?lxe(n,r):Mk(e,n,r,a);case 239:return s[3]===60?CE(n,r):Mk(e,n,r,a);case 255:if(s[1]===254)return uxe(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Xh.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Xh.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return kE.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return xU.to_workbook(n,r);break;case 10:case 13:case 32:return cxe(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return mue.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?kE.to_workbook(n,r):Mk(e,n,r,a)}function tz(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return qv(t.file,Tr.write(e,{type:en?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Tr.write(e,t)}function fxe(e,t){var r=cs(t||{}),n=sxe(e,r);return hxe(n,r)}function hxe(e,t){var r={},n=en?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Tr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(c2(s))}return t.password&&typeof encrypt_agile<"u"?tz(encrypt_agile(s,t.password),t):t.type==="file"?qv(t.file,s):t.type=="string"?Hn(s):s}function gxe(e,t){var r=t||{},n=dpe(e,r);return tz(n,r)}function Hc(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return nv(Xc(n));case"binary":return Xc(n);case"string":return e;case"file":return qv(t.file,n,"utf8");case"buffer":return en?gd(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Hc(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function mxe(e,t){switch(t.type){case"base64":return nv(e);case"binary":return e;case"string":return e;case"file":return qv(t.file,e,"binary");case"buffer":return en?gd(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Lw(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?nv(r):t.type=="string"?Hn(r):r;case"file":return qv(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function rz(e,t){n3(),ome(e);var r=cs(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=rz(e,r);return r.type="array",c2(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Hc(spe(e,r),r);case"slk":case"sylk":return Hc(cU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Hc(qU(e.Sheets[e.SheetNames[s]],r),r);case"txt":return mxe(nz(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Hc(B3(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Hc(uU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Lw(kE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Hc(Nm.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Hc(xU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Hc(dU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Hc(JU(e,r),r);case"wk1":return Lw(Xh.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Lw(Xh.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Lw(KU(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),gxe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return fxe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function pxe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function xxe(e,t,r){var n={};return n.type="file",n.file=t,pxe(n),rz(e,n)}function yxe(e,t,r,n,s,a,i,o){var c=ea(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,g=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[p]!=null&&(g[a[p]]=u);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(v==null)if(x.t=="e"&&v===null)g[a[p]]=null;else if(u!==void 0)g[a[p]]=u;else if(d&&v===null)g[a[p]]=null;else continue;else g[a[p]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:od(x,v,o);v!=null&&(f=!1)}}return{row:g,isempty:f}}function eb(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=yn(d);break;case"number":c=yn(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var f=ea(c.s.r),g=[],p=[],x=0,v=0,w=Array.isArray(e),C=c.s.r,k=0,_={};w&&!e[C]&&(e[C]=[]);var N=u.skipHidden&&e["!cols"]||[],E=u.skipHidden&&e["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(N[k]||{}).hidden)switch(g[k]=Ss(k),r=w?e[C][k]:e[g[k]+f],n){case 1:a[k]=k-c.s.c;break;case 2:a[k]=g[k];break;case 3:a[k]=u.header[k-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=od(r,null,u),v=_[i]||0,!v)_[i]=1;else{do o=i+"_"+v++;while(_[o]);_[i]=v,_[o]=1}a[k]=o}for(C=c.s.r+s;C<=c.e.r;++C)if(!(E[C]||{}).hidden){var P=yxe(e,c,C,g,n,a,w,u);(P.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=P.row)}return p.length=x,p}var WO=/"/g;function vxe(e,t,r,n,s,a,i,o){for(var c=!0,u=[],d="",f=ea(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var p=o.dense?(e[r]||[])[g]:e[n[g]+f];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:od(p,null,o));for(var x=0,v=0;x!==d.length;++x)if((v=d.charCodeAt(x))===s||v===a||v===34||o.forceQuotes){d='"'+d.replace(WO,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(WO,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function B3(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=yn(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(g[x]||{}).hidden||(f[x]=Ss(x));for(var v=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(d=vxe(e,s,w,f,i,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((v++?o:"")+d)));return delete n.dense,r.join("")}function nz(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=B3(e,t);return r}function wxe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=yn(e["!ref"]),a="",i=[],o,c=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Ss(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=ea(d),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function sz(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?ks(n.origin):n.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var f=yn(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+s)}else i==-1&&(i=0,d.e.r=t.length-1+s);var g=n.header||[],p=0;t.forEach(function(v,w){Us(v).forEach(function(C){(p=g.indexOf(C))==-1&&(g[p=g.length]=C);var k=v[C],_="z",N="",E=Rr({c:o+p,r:i+w+s});u=mv(a,E),k&&typeof k=="object"&&!(k instanceof Date)?a[E]=k:(typeof k=="number"?_="n":typeof k=="boolean"?_="b":typeof k=="string"?_="s":k instanceof Date?(_="d",n.cellDates||(_="n",k=Na(k)),N=n.dateNF||Dr[14]):k===null&&n.nullError&&(_="e",k=0),u?(u.t=_,u.v=k,delete u.w,delete u.R,N&&(u.z=N)):a[E]=u={t:_,v:k},N&&(u.z=N))})}),d.e.c=Math.max(d.e.c,o+g.length-1);var x=ea(i);if(s)for(p=0;p<g.length;++p)a[Ss(p+o)+x]={t:"s",v:g[p]};return a["!ref"]=Jr(d),a}function _xe(e,t){return sz(null,e,t)}function mv(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ks(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?mv(e,Rr(t)):mv(e,Rr({r:t,c:r||0}))}function bxe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function $3(){return{SheetNames:[],Sheets:{}}}function U3(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(UU(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Sxe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=bxe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function kxe(e,t){return e.z=t,e}function az(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Cxe(e,t,r){return az(e,"#"+t,r)}function Txe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Exe(e,t,r,n){for(var s=typeof t!="string"?t:yn(t),a=typeof t=="string"?t:Jr(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=mv(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var u_={encode_col:Ss,encode_row:ea,encode_cell:Rr,encode_range:Jr,decode_col:p3,decode_row:m3,split_cell:Moe,decode_cell:ks,decode_range:jo,format_cell:od,sheet_add_aoa:F$,sheet_add_json:sz,sheet_add_dom:YU,aoa_to_sheet:rp,json_to_sheet:_xe,table_to_sheet:XU,table_to_book:Ope,sheet_to_csv:B3,sheet_to_txt:nz,sheet_to_json:eb,sheet_to_html:qU,sheet_to_formulae:wxe,sheet_to_row_object_array:eb,sheet_get_cell:mv,book_new:$3,book_append_sheet:U3,book_set_sheet_visibility:Sxe,cell_set_number_format:kxe,cell_set_hyperlink:az,cell_set_internal_link:Cxe,cell_add_comment:Txe,sheet_set_array_formula:Exe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const iz=({onBackToCabinet:e,selectedGrade:t,selectedClass:r,openRetestModal:n,forceRefreshOnMount:s=!1})=>{Po(),Rb();const{user:a,isAuthenticated:i}=ds(),{showNotification:o}=Aa(),c=S.useCallback(tt=>{let mt=null;if(typeof tt?.percentage=="number"&&!Number.isNaN(tt.percentage))return mt=Math.round(tt.percentage),console.debug("[TeacherResults] Using provided percentage",{percentage:tt.percentage,rounded:mt,result:tt}),mt;const Xt=tt?.retest_best_score??tt?.score,Ct=tt?.retest_best_max_score??tt?.max_score,Sr=Number(Xt??0),Ft=Number(Ct??0);return Ft>0&&(mt=Math.round(Sr/Ft*100)),mt},[]);S.useCallback(tt=>{const mt=c(tt);return mt===null?"text-gray-600":mt<50?"text-red-600 font-semibold":mt<70?"text-yellow-600":"text-green-600"},[c]),S.useCallback(tt=>{const mt=c(tt);return mt!==null&&mt<50},[c]);const[u,d]=S.useState(null),[f,g]=S.useState(!0),[p,x]=S.useState(""),[v,w]=S.useState([]),[C,k]=S.useState(null),[_,N]=S.useState(!1),[E,P]=S.useState([]),[F,A]=S.useState([]),[j,I]=S.useState([1,2]),[B,Y]=S.useState(null),[Z,se]=S.useState(null),[ee,te]=S.useState(null),[L,V]=S.useState("main"),[M,H]=S.useState(null),[W,R]=S.useState(null),z=M||t,K=W||r,[Q,ae]=S.useState(null),[X,ie]=S.useState({}),[le,ce]=S.useState(!1),[_e,ne]=S.useState(new Set),[pe,Ce]=S.useState(!0),[Ae,Ge]=S.useState(null),[Le,At]=S.useState(null),[et,pt]=S.useState(!1),[lt,rt]=S.useState(!1),[ht,Lt]=S.useState(!1),zt=S.useRef(null),[Dt,De]=S.useState(null),[Ie,Ke]=S.useState(!1),[Je,Ye]=S.useState(null),[Tt,Nt]=S.useState(!1),[Wt,or]=S.useState(null),[dr,Er]=S.useState(""),[fr,nr]=S.useState(""),[me,Ne]=S.useState(!1),[Fe,Re]=S.useState(!1),[bt,Pe]=S.useState(null),[ze,ke]=S.useState(""),[$e,Be]=S.useState(!1),[Et,It]=S.useState(new Set),[Kt,wr]=S.useState({}),[lr,Fr]=S.useState(!1),[ue,be]=S.useState(null),[xe,he]=S.useState(""),[we,Se]=S.useState(!1),[He,ct]=S.useState(null),[qe,oe]=S.useState(null),[fe,Te]=S.useState(!1),[Ee,Xe]=S.useState(!1),[ot,xt]=S.useState({}),qt=S.useRef(new Set),yt=S.useRef({}),Yt=S.useRef(null);S.useEffect(()=>{console.log(" editingColumns state changed:",Array.from(Et)),qt.current=Et},[Et]),S.useEffect(()=>{console.log(" columnScores state changed:",Kt),yt.current=Kt},[Kt]);const _r=S.useCallback(tt=>{console.log(" Toggling test collapse for:",tt),ne(mt=>{const Xt=new Set(mt);return Xt.has(tt)?(Xt.delete(tt),console.log(" Expanding test:",tt)):(Xt.add(tt),console.log(" Collapsing test:",tt)),console.log(" New collapsed tests:",Array.from(Xt)),Xt})},[]),kr=S.useCallback(()=>{if(zt.current){const{scrollLeft:tt,scrollWidth:mt,clientWidth:Xt}=zt.current;rt(tt>0),Lt(tt<mt-Xt-1)}},[]);S.useEffect(()=>{Gr()},[]),S.useEffect(()=>{if(B&&zt.current){const tt=setTimeout(kr,100);return()=>clearTimeout(tt)}},[B,kr]),S.useEffect(()=>{console.log(" Current collapsed tests state:",Array.from(_e))},[_e]);const xr=S.useCallback(async(tt,mt=!1)=>{try{ce(!0);const Xt=a?.teacher_id,Ct=`${z}/${K}`,Sr=await Cae.getTeacherStudentResults(Xt,z,Ct,tt,mt);if(Sr.success){console.log(" Results loaded for term:",tt,Sr.results?.length||0,"results"),console.log(" Students loaded:",Sr.students?.length||0,"students");const Ft=[],Hr=new Set,rn=new Set;Sr.results&&Sr.results.length>0&&Sr.results.forEach(Bt=>{Bt.test_name&&!Hr.has(Bt.test_name)&&(Hr.add(Bt.test_name),Ft.push({test_name:Bt.test_name,test_type:Bt.test_type,subject:Bt.subject})),Bt.subject&&rn.add(Bt.subject)});const nt=(Sr.students||[]).map(Bt=>{const kn={};return(Sr.results||[]).filter(Kr=>Kr.student_id===Bt.student_id).forEach(Kr=>{Kr.test_name&&(kn[Kr.test_name]={id:Kr.id,test_type:Kr.test_type,test_id:Kr.test_id,subject_id:Kr.subject_id,score:Kr.score,max_score:Kr.max_score,retest_offered:Kr.retest_offered,caught_cheating:Kr.caught_cheating,visibility_change_times:Kr.visibility_change_times,answers:Kr.answers,ai_feedback:Kr.ai_feedback,name:Kr.name,surname:Kr.surname,test_name:Kr.test_name})}),{...Bt,...kn}}),Jt={results:Sr.results||[],students:nt,class:nt,unique_tests:Ft,subjects:Array.from(rn),count:Sr.count||0,student_count:Sr.student_count||0};console.log(" Processed results data:",{uniqueTests:Ft.length,subjects:Array.from(rn),resultsCount:Sr.results?.length||0,studentsWithScores:nt.length,sampleStudent:nt[0]}),Y(Jt),ie(Jt),te(new Date)}}catch(Xt){console.error(" Error loading results for term:",Xt),Y(null),ie(null)}finally{ce(!1)}},[a,z,K]);S.useEffect(()=>{(async()=>{try{pt(!0),await xc.loadAcademicCalendar();const mt=xc.getCurrentSemesterTerms();At(mt),mt?.currentTerm&&(Ge(mt.currentTerm.id),z&&K&&xr(mt.currentTerm.id,s))}catch(mt){console.error(" Error initializing academic calendar:",mt)}finally{pt(!1)}})()},[z,K,xr,s]),S.useEffect(()=>{t&&r&&(console.log(" Props detected:",{grade:t,class:r}),Le?.currentTerm&&(Ge(Le.currentTerm.id),xr(Le.currentTerm.id,s)))},[t,r,Le,xr,s]);const Gr=S.useCallback(async()=>{console.log(" Initializing teacher results...");try{if(g(!0),x(""),!i||!a){console.log(" User not authenticated"),x("User not authenticated");return}if(a.role!==no.TEACHER){console.error(" Invalid user role for teacher results:",a.role),x("Access denied. Teacher role required.");return}console.log(" Loading teacher assignments..."),await un(),console.log(" TODO: Load academic calendar service"),console.log(" Teacher results initialization complete!")}catch(tt){console.error(" Error initializing teacher results:",tt),x("Failed to initialize teacher results")}finally{g(!1)}},[i,a]),un=S.useCallback(async()=>{console.log(" Loading teacher assignments...");try{const tt=`teacher_data_${a?.teacher_id||a?.id||""}`;let mt=Bs(tt);mt&&mt.subjects&&mt.subjects.length>0&&(mt.subjects.some(nt=>nt.subject&&nt.classes&&nt.classes.length>0)||(console.log(" Cached data has invalid subject structure, forcing refresh"),localStorage.removeItem(tt),mt=null)),mt?console.log(" Cache HIT! Using cached teacher data"):(console.log(" Cache MISS! Fetching teacher data from API"),mt=await ms.getTeacherData(),console.log(" Teacher data loaded:",mt),_s(tt,mt,Ls.teacher_subjects)),d(mt);const Xt=[];mt&&mt.subjects&&(console.log(" Teacher subjects structure:",mt.subjects),mt.subjects.forEach(rn=>{console.log(" Processing subject:",rn),rn.classes&&rn.classes.forEach(nt=>{nt.grade&&nt.class&&Xt.push({grade:nt.grade,class:nt.class,subject:rn.subject||rn.name||"Unknown Subject"})})})),A(Xt),console.log(" Available classes from teacher data:",Xt);const Ct=`teacher_tests_${a?.teacher_id||a?.id||""}`,Sr=Bs(Ct);Sr&&Sr.some(rn=>rn.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(Ct));let Ft=Bs(Ct);Ft?console.log(" Cache HIT! Using cached teacher tests"):(console.log(" Cache MISS! Fetching teacher tests from API"),Ft=await fn.getTeacherTests(),console.log(" Teacher tests loaded:",Ft),_s(Ct,Ft,Ls.teacher_tests));const Hr=Ft.flatMap(rn=>rn.assignments||[]);w(Hr),console.log(" Raw assignments data:",Hr),console.log(" Teacher assignments loaded:",Hr.length)}catch(tt){console.error(" Error loading teacher assignments:",tt),o("Failed to load teacher assignments","error")}},[o]),Xr=S.useCallback(async(tt,mt)=>{console.log(" Showing classes for grade:",tt,"class:",mt),H(tt),R(mt),k(null),Y(null),tt&&mt&&console.log(" TODO: Implement academic calendar service for term selection")},[]);S.useCallback((tt,mt)=>{console.log(" Showing semesters for class:",tt,mt),k(null),Y(null),console.log(" TODO: Implement academic calendar service for term selection")},[]),S.useCallback((tt,mt)=>{console.log(" Class clicked:",tt,mt),N(!0),console.log(" TODO: Implement academic calendar service for term selection")},[]);const cr=S.useCallback(async(tt,mt=!1)=>{!z||!K||(console.log(" Loading results for semester:",tt,"forceRefresh:",mt),k(tt),Le?.currentTerm&&await xr(Le.currentTerm.id,mt))},[z,K,Le,xr]),na=S.useCallback(()=>Le?l.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Current Semester: ",Le?.semester===1?"Semester 1":"Semester 2"]}),l.jsx("div",{className:"flex space-x-4",children:Le?.terms.map(tt=>l.jsx(at.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${tt.isCurrent?"bg-blue-600 text-white shadow-lg":Ae===tt.id?"bg-green-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>{Ge(tt.id),xr(tt.id)},whileHover:{scale:1.05},whileTap:{scale:.95},children:tt.label},tt.id))})]}):l.jsx("div",{className:"flex space-x-4 mb-6",children:l.jsx("div",{className:"px-6 py-3 rounded-lg bg-gray-200 text-gray-500",children:"Loading terms..."})}),[Le,Ae,xr]);S.useCallback(tt=>tt.reduce((mt,Xt)=>(mt[Xt.student_id]||(mt[Xt.student_id]=[]),mt[Xt.student_id].push(Xt),mt),{}),[]),S.useCallback(tt=>{if(tt.length===0)return 0;const mt=tt.reduce((Xt,Ct)=>Xt+(Ct.percentage||0),0);return Math.round(mt/tt.length)},[]),S.useCallback(tt=>{tt.score<tt.passing_score&&window.confirm("Give another try?")&&hn(tt.student_id,tt.test_id)},[]);const hn=S.useCallback(async(tt,mt)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:tt,testId:mt})})).ok&&(K&&cr(C,!0),o("Test made accessible to student","success"))}catch(Xt){console.error("Error resetting test attempt:",Xt),o("Failed to reset test attempt","error")}},[K,C,cr,o]),Gn=S.useCallback((tt,mt)=>{if(tt===null||mt===null)return"";const Xt=Math.round(tt/mt*100);return Xt>=80?"text-green-600 bg-green-50":Xt>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),Nn=S.useCallback(tt=>{De(tt),Ke(!0)},[]),Ws=S.useCallback((tt,mt="overview",Xt)=>{try{const Sr=!!tt?.ai_feedback,Ft=typeof tt?.ai_feedback;let Hr=[];if(Sr)if(Ft==="string")try{Hr=Object.keys(JSON.parse(tt.ai_feedback))}catch{Hr=["<invalid json>"]}else Ft==="object"&&(Hr=Object.keys(tt.ai_feedback||{}));console.log("[AI DEBUG] Opening speaking result",{hasAi:Sr,aiType:Ft,aiKeys:Hr})}catch{}const Ct={...tt,__initialTab:mt};Xt&&(Ct.__audioUrl=Xt),Ye(Ct),Nt(!0)},[]),Sn=S.useCallback(async(tt,mt)=>{if(!tt||!mt)return console.error("fetchTestQuestions: Missing testType or testId",{testType:tt,testId:mt}),null;const Xt=`${tt}_${mt}`;if(ot[Xt])return console.log(" Using cached questions for",Xt),ot[Xt];Xe(!0);try{console.log(" Fetching questions for",{testType:tt,testId:mt});const Ct=await fn.getTestQuestions(tt,mt);return console.log(" Questions fetched:",Ct?.length||0,"questions"),xt(Sr=>({...Sr,[Xt]:Ct})),Ct}catch(Ct){return console.error(" Error fetching test questions:",Ct),o("Failed to load test questions","error"),null}finally{Xe(!1)}},[ot,o]),ye=S.useCallback(async(tt,mt)=>{if(console.log(" Opening answer modal for:",{testResult:tt,test:mt}),console.log(" [handleViewAnswers] testResult.answers:",tt?.answers),console.log(" [handleViewAnswers] testResult.answers type:",typeof tt?.answers),console.log(" [handleViewAnswers] Full testResult keys:",tt?Object.keys(tt):"null"),tt.test_type==="drawing"||mt?.test_type==="drawing"){Nn(tt);return}if(tt.test_type==="speaking"||mt?.test_type==="speaking"){Ws(tt);return}const Xt=tt.test_type||mt?.test_type;if(Xt==="word_matching"||Xt==="matching_type"){o("Word matching and picture matching tests have separate view mechanisms","info");return}ct(tt),oe(null),Te(!0),Xe(!0);const Ct=tt.test_id||mt?.test_id;if(!Xt||!Ct){o("Unable to load test questions: Missing test type or ID","error"),Xe(!1);return}try{const Sr=await Sn(Xt,Ct);Sr?oe(Sr):o("Failed to load test questions","error")}finally{Xe(!1)}},[Sn,Nn,Ws,o]);S.useCallback((tt,mt,Xt)=>{or({resultId:tt,score:mt,maxScore:Xt}),Er(mt?.toString()||""),nr(Xt?.toString()||""),Re(!0)},[]),S.useCallback(tt=>{Er(tt)},[]),S.useCallback(tt=>{nr(tt)},[]),S.useCallback(async()=>{if(Wt){Ne(!0);try{const tt={resultId:Wt.resultId,score:parseInt(dr)||0,maxScore:parseInt(fr)||1};(await fetch(Jx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(tt)})).ok?(o("Score updated successfully","success"),K&&cr(C,!0),or(null),Er(""),nr(""),Re(!1)):o("Failed to update score","error")}catch(tt){console.error("Error updating score:",tt),o("Failed to update score","error")}finally{Ne(!1)}}},[Wt,dr,fr,K,C,cr,o]),S.useCallback(()=>{or(null),Er(""),nr(""),Re(!1)},[]);const wt=S.useCallback((tt,mt)=>{Pe({resultId:tt,score:mt}),ke(mt.toString())},[]),Nr=S.useCallback(async()=>{if(bt){Be(!0);try{const tt={resultId:bt.resultId,score:parseInt(ze)||0},mt=await fetch(Jx.UPDATE_SPEAKING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(tt)});if(mt.ok){const Xt=await mt.json();o("Speaking test score updated successfully","success"),Je&&Ye(Ct=>({...Ct,score:Xt.score,percentage:Xt.percentage})),K&&cr(C,!0),Pe(null),ke("")}else{const Xt=await mt.json();o(Xt.error||"Failed to update speaking test score","error")}}catch(tt){console.error("Error updating speaking test score:",tt),o("Failed to update speaking test score","error")}finally{Be(!1)}}},[bt,ze,K,C,cr,o]),Or=S.useCallback(()=>{Pe(null),ke("")},[]),Vn=(tt,mt)=>{console.log(" Starting column editing for drawing test:",tt),console.log(" Current editingColumns before update:",Array.from(Et)),console.log(" Results data passed to function:",mt),It(Xt=>{const Ct=new Set(Xt).add(tt);return console.log(" Updated editingColumns:",Array.from(Ct)),Ct}),console.log(" Initializing column scores for test:",tt),console.log(" Results data:",mt),console.log(" Results.class:","null"),console.log(" No results or class data available")},dn=S.useCallback(tt=>{It(mt=>{const Xt=new Set(mt);return Xt.delete(tt),Xt}),wr(mt=>{const Xt={...mt};return delete Xt[tt],Xt})},[]),Oe=S.useCallback((tt,mt,Xt,Ct)=>{const Sr=Ct.toString();yt.current[tt]||(yt.current[tt]={}),yt.current[tt][mt]||(yt.current[tt][mt]={}),yt.current[tt][mt][Xt]=Sr;const Ft=parseInt(Ct)||0;wr(Hr=>({...Hr,[tt]:{...Hr[tt],[mt]:{...Hr[tt]?.[mt],[Xt]:Ft}}}))},[]);S.useCallback(async tt=>{if(yt.current[tt]){Fr(!0);try{const mt=Object.entries(yt.current[tt]).map(([Ft,Hr])=>({resultId:Hr.resultId,score:parseInt(Hr.score)||0,maxScore:parseInt(Hr.maxScore)||100}));console.log(" Saving column scores for",tt,":",mt);const Xt=mt.map(Ft=>(console.log(" Sending update:",Ft),fetch(Jx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ft)})));(await Promise.all(Xt)).every(Ft=>Ft.ok)?(o(`Scores updated successfully for ${tt}`,"success"),K&&cr(C,!0),dn(tt)):o("Failed to update some scores","error")}catch(mt){console.error("Error updating column scores:",mt),o("Failed to update scores","error")}finally{Fr(!1)}}},[Kt,K,C,cr,o,dn]);const dt=S.useCallback((tt,mt,Xt)=>!mt||mt.length===0?l.jsx(at.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsx(at.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:l.jsxs(at.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[l.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:Ct=>{zt.current&&(zt.current.scrollLeft=Ct.target.scrollLeft)},children:l.jsx("div",{className:"min-w-full h-1",children:l.jsx("div",{className:"h-1",style:{width:`${(Xt.length+5)*120}px`}})})}),l.jsx("div",{ref:zt,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:Ct=>{kr(Ct);const Sr=Ct.target.previousElementSibling;Sr&&(Sr.scrollLeft=Ct.target.scrollLeft)},children:l.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[l.jsx("thead",{children:l.jsxs(at.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 ${pe?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[180px] bg-blue-50 cursor-pointer select-none"}`,onClick:Ct=>{Ct.preventDefault(),Ct.stopPropagation(),Ce(!pe)},title:"Toggle student name columns",children:pe?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),l.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),Xt.map((Ct,Sr)=>{const Ft=_e.has(Ct.test_name),Hr=Ct.test_type==="drawing",rn=qt.current.has(Ct.test_name);return console.log(` Rendering test ${Ct.test_name}:`,{isDrawingTest:Hr,isEditingColumn:rn,editingColumns:Array.from(qt.current),test_type:Ct.test_type}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${Ft?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:nt=>{nt.preventDefault(),nt.stopPropagation(),_r(Ct.test_name)},children:Ft?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:Ct.test_name,children:Ct.test_name.length>8?Ct.test_name.substring(0,8)+"...":Ct.test_name}),l.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})},Sr)})]})}),l.jsx("tbody",{children:l.jsx(ko,{children:mt.map((Ct,Sr)=>l.jsxs(at.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Sr%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+Sr*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[l.jsx(at.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:Ct.student_id}),pe?l.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Ft=>{Ft.preventDefault(),Ft.stopPropagation(),Ce(!1)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):l.jsxs(l.Fragment,{children:[l.jsx(at.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Ct.name}),l.jsx(at.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Ct.surname})]}),l.jsx(at.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Ct.number??Sr+1}),l.jsx(at.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:Ct.nickname||"-"}),Xt.map((Ft,Hr)=>{const rn=_e.has(Ft.test_name),nt=Ct[Ft.test_name];return rn?(console.log(" Rendering collapsed column for test:",Ft.test_name),l.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Jt=>{Jt.preventDefault(),Jt.stopPropagation(),console.log(" Clicked on collapsed arrow for:",Ft.test_name),_r(Ft.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Hr)):l.jsx(at.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},onClick:Jt=>{console.debug("[TeacherResults] Main table TD clicked",{testResult:nt,student:Ct.student_id});const Bt=nt?.test_type||Ft?.test_type;if(Bt==="drawing"||Bt==="speaking"||Bt==="word_matching"||Bt==="matching_type")return;const kn=c(nt);if(kn!==null&&kn<50){if(nt?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:Ct.student_id,test:Ft}),n({failedStudentIds:[Ct.student_id],test_type:Ft.test_type,original_test_id:nt?.test_id||Ft.test_id,subject_id:nt?.subject_id||Ft.subject_id,grade:t,class:r})}else ye(nt,Ft)},children:nt&&nt.test_type==="drawing"?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("button",{onClick:()=>Nn(nt),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const Jt=`${Ft.test_name}|${Ct.student_id}`,Bt=ue===Jt,kn=Number.isFinite(nt?.score)?nt.score:0;if(!Bt){const Vr=c(nt),Kr=Vr!==null&&Vr<50,Qn=Vr!==null&&Vr>=50&&Vr<70,Bn=nt?.retest_offered===!0,Jn=Vr===null?"text-gray-600":Kr?"text-red-600 font-semibold":Qn?"text-yellow-600":"text-green-600";return l.jsxs(at.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Jn} cursor-pointer hover:opacity-90 ${Bn?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Kr?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:fo=>{fo.preventDefault(),fo.stopPropagation(),Kr&&!Bn?n({failedStudentIds:[Ct.student_id],test_type:Ft.test_type,original_test_id:nt?.test_id||Ft.test_id,subject_id:nt?.subject_id||Ft.subject_id,grade:t,class:r}):(be(Jt),he(String(kn)))},title:Bn?"Retest offered":Kr?"Offer retest":"Double-click to edit score",children:[(()=>{const fo=nt.retest_best_score??nt.score,wc=nt.retest_best_max_score??nt.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:Kr?"text-red-700":"",children:fo}),"/",l.jsx("span",{children:wc})]})})(),nt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})}return l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:10,value:xe,onChange:Vr=>he(Vr.target.value),onBlur:async()=>{const Vr=Math.max(0,Math.min(10,parseFloat(xe||"0")));Se(!0);try{const Kr={resultId:nt?.id,score:Vr,maxScore:10},Qn=await(window.tokenManager?.getToken()||Fs.get())||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(Jx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:Qn?`Bearer ${Qn}`:""},body:JSON.stringify(Kr)})).ok)throw new Error("Failed to save")}catch{}finally{Se(!1),be(null),cr(C,!0)}},onKeyDown:async Vr=>{Vr.key==="Enter"?Vr.currentTarget.blur():Vr.key==="Escape"&&be(null)},className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",disabled:we}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",value:10,className:"w-12 px-2 py-1 text-xs border border-gray-300 bg-gray-100 rounded",disabled:!0})]})})(),nt.caught_cheating&&nt.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",nt.visibility_change_times,")"]})]}):nt&&(nt.test_type==="speaking"||Ft.test_type==="speaking")?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[(()=>{const Jt=nt?.answers;let Bt;if(typeof Jt=="string")if(/^https?:\/\//i.test(Jt))Bt=Jt;else try{Bt=JSON.parse(Jt)?.audio_url}catch{}else Jt&&typeof Jt=="object"&&(Bt=Jt.audio_url);return!Bt&&nt?.audio_url&&(Bt=nt.audio_url),l.jsx(l.Fragment,{children:l.jsx("button",{onClick:()=>Ws({...nt,__studentId:Ct.student_id},"audio",Bt),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"Results"})})})(),(()=>{const Jt=qt.current.has(Ft.test_name);return console.log(` Score cell for ${Ft.test_name}:`,{isEditing:Jt,editingColumns:Array.from(qt.current),test_name:Ft.test_name}),Jt})()?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:nt.max_score||100,value:yt.current[Ft.test_name]?.[Ct.student_id]?.score||nt.score||"",onChange:Jt=>Oe(Ft.test_name,Ct.student_id,"score",Jt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:yt.current[Ft.test_name]?.[Ct.student_id]?.maxScore||nt.max_score||100,onChange:Jt=>Oe(Ft.test_name,Ct.student_id,"maxScore",Jt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):l.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium",onDoubleClick:()=>{console.log(" Double-clicked on speaking test score:",Ft.test_name),console.log(" Results state at double-click:",B),console.log(" Test result:",nt),console.log(" Student:",Ct),console.log(" Test:",Ft),nt&&nt.id?(console.log(" Starting column editing for speaking test:",Ft.test_name),Vn(Ft.test_name)):console.log(" No test result ID found, cannot edit")},title:"Double-click to edit scores",children:[(()=>{const Jt=c(nt),Bt=Jt!==null&&Jt<50,kn=Jt!==null&&Jt>=50&&Jt<70,Vr=nt.retest_offered,Kr=Jt===null?"text-gray-600":Bt?"text-red-600 font-semibold":kn?"text-yellow-600":"text-green-600";return l.jsxs(at.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Kr} cursor-pointer hover:opacity-90 ${Vr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Bt?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:Qn=>{Qn.preventDefault(),Qn.stopPropagation(),Bt&&!Vr&&(console.log(" Offering retest for speaking test:",Ft.test_name),n({failedStudentIds:[Ct.student_id],test_type:Ft.test_type,original_test_id:nt?.test_id||Ft.test_id,subject_id:nt?.subject_id||Ft.subject_id,grade:t,class:r}))},title:Vr?"Retest offered":Bt?"Offer retest":'Use "View Results" button to review',children:[(()=>{const Qn=nt.retest_best_score??nt.score,Bn=nt.retest_best_max_score??nt.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:Bt?"text-red-700":"",children:Qn}),"/",l.jsx("span",{children:Bn})]})})(),nt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),nt.caught_cheating&&nt.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",nt.visibility_change_times,")"]})]})]}):nt&&nt.score!==null&&nt.score!==void 0?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[(()=>{const Jt=c(nt),Bt=Jt!==null&&Jt<50,kn=Jt!==null&&Jt>=50&&Jt<70,Vr=Jt===null?"text-gray-600":Bt?"text-red-600 font-semibold":kn?"text-yellow-600":"text-green-600",Kr=nt?.retest_offered===!0;return l.jsxs(at.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Vr} cursor-pointer hover:opacity-90 ${Kr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Bt?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:Qn=>{Qn.preventDefault(),Qn.stopPropagation();const Bn=nt?.test_type||Ft?.test_type;if(!(Bn==="drawing"||Bn==="speaking")){if(nt?.retest_offered){o("Retest is already offered","info");return}Bt?n({failedStudentIds:[Ct.student_id],test_type:Ft.test_type,original_test_id:nt?.test_id||Ft.test_id,subject_id:nt?.subject_id||Ft.subject_id,grade:t,class:r}):ye(nt,Ft)}},title:Kr?"Retest offered":Bt?"Offer retest":"",children:[(()=>{const Qn=nt.retest_best_score??nt.score,Bn=nt.retest_best_max_score??nt.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:Bt?"text-red-700":"",children:Qn}),"/",l.jsx("span",{children:Bn})]})})(),nt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),nt.caught_cheating&&nt.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",nt.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},Hr)})]},Sr))})})]})})]})}),[Gn,_e,_r,pe]),Rt=S.useCallback((tt,mt,Xt)=>!mt||mt.length===0?l.jsx(at.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsx(at.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:l.jsx(at.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:l.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:l.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[l.jsx("thead",{children:l.jsxs(at.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-3 text-left font-semibold text-gray-700 ${pe?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[160px] bg-blue-50 cursor-pointer select-none"}`,onClick:Ct=>{Ct.preventDefault(),Ct.stopPropagation(),Ce(!pe)},title:"Toggle student name columns",children:pe?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),l.jsx("svg",{className:"w-3 h-3 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),Xt.map((Ct,Sr)=>(Ct.test_type,qt.current.has(Ct.test_name),l.jsx(at.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+Sr*.05},children:l.jsx("div",{className:"flex flex-col space-y-1",children:l.jsx("span",{className:"text-xs",children:Ct.test_name.length>10?Ct.test_name.substring(0,10)+"...":Ct.test_name})})},Sr)))]})}),l.jsx("tbody",{children:l.jsx(ko,{children:mt.map((Ct,Sr)=>l.jsxs(at.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Sr%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+Sr*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:Ct.student_id}),pe?l.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-xs w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Ft=>{Ft.preventDefault(),Ft.stopPropagation(),Ce(!1)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):l.jsxs(l.Fragment,{children:[l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Ct.name}),l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Ct.surname})]}),l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Ct.number??Sr+1}),l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 whitespace-normal break-words",whileHover:{scale:1.01},transition:{duration:.15},children:Ct.nickname||"-"}),Xt.map((Ft,Hr)=>{const rn=_e.has(Ft.test_name),nt=Ct[Ft.test_name];return rn?l.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Jt=>{Jt.preventDefault(),Jt.stopPropagation(),_r(Ft.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Hr):l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},onClick:Jt=>{console.debug("[TeacherResults] TD clicked",{testResult:nt,student:Ct.student_id});const Bt=nt?.test_type||Ft?.test_type;if(Bt==="drawing"||Bt==="speaking")return;const kn=c(nt);if(kn!==null&&kn<50){if(nt?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:Ct.student_id}),n({failedStudentIds:[Ct.student_id],test_type:nt.test_type,original_test_id:nt.test_id,subject_id:nt.subject_id,grade:t,class:r})}else ye(nt,Ft)},children:nt&&(nt.test_type==="drawing"||Ft.test_type==="drawing"||nt.test_type==="speaking"||Ft.test_type==="speaking"||nt.score!==null&&nt.score!==void 0)?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[nt.test_type==="drawing"?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>Nn(nt),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),qt.current.has(Ft.test_name)?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:nt.max_score||100,value:yt.current[Ft.test_name]?.[Ct.student_id]?.score||nt.score||"",onChange:Jt=>Oe(Ft.test_name,Ct.student_id,"score",Jt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:yt.current[Ft.test_name]?.[Ct.student_id]?.maxScore||nt.max_score||100,onChange:Jt=>Oe(Ft.test_name,Ct.student_id,"maxScore",Jt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):(()=>{const Jt=c(nt),Bt=Jt!==null&&Jt<50,kn=Jt!==null&&Jt>=50&&Jt<70,Vr=nt.retest_offered,Kr=Jt===null?"text-gray-600":Bt?"text-red-600 font-semibold":kn?"text-yellow-600":"text-green-600";return l.jsxs(at.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${Kr} cursor-pointer hover:opacity-90 ${Vr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Bt?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>Vn(Ft.test_name),onClick:Qn=>{Qn.preventDefault(),Qn.stopPropagation();const Bn=nt?.test_type||Ft?.test_type;if(!(Bn==="drawing"||Bn==="speaking"))if(Bt){if(nt?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[Ct.student_id],test_type:Ft.test_type,original_test_id:nt?.test_id||Ft.test_id,subject_id:nt?.subject_id||Ft.subject_id,grade:t,class:r})}else ye(nt,Ft)},title:Vr?"Retest offered":Bt?"Offer retest":"Click to view answers",children:[l.jsx("span",{className:Bt?"text-red-700":"",children:nt.score}),"/",l.jsx("span",{children:nt.max_score}),nt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})()]}):nt.test_type==="speaking"||Ft.test_type==="speaking"?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>Ws({...nt,__studentId:Ct.student_id},"audio"),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View Audio"}),bt&&bt.resultId===nt.result_id?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:nt.max_score||100,value:ze,onChange:Jt=>ke(Jt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("button",{onClick:()=>Nr(),disabled:$e,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50",children:$e?"Saving...":"Save"}),l.jsx("button",{onClick:()=>Or(),disabled:$e,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):(()=>{const Jt=c(nt),Bt=Jt!==null&&Jt<50,kn=Jt!==null&&Jt>=50&&Jt<70,Vr=nt.retest_offered,Kr=Jt===null?"text-gray-600":Bt?"text-red-600 font-semibold":kn?"text-yellow-600":"text-green-600";return l.jsxs(at.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${Kr} cursor-pointer hover:opacity-90 ${Vr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Bt?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>{Pe({resultId:nt.result_id,score:nt.score}),ke(nt.score?.toString()||"")},onClick:Qn=>{Qn.preventDefault(),Qn.stopPropagation();const Bn=nt?.test_type||Ft?.test_type;if(!(Bn==="drawing"||Bn==="speaking"))if(Bt){if(nt?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[Ct.student_id],test_type:Ft.test_type,original_test_id:nt?.test_id||Ft.test_id,subject_id:nt?.subject_id||Ft.subject_id,grade:t,class:r})}else ye(nt,Ft)},title:Vr?"Retest offered":Bt?"Offer retest":"Click to view answers, double-click to edit score",children:[l.jsx("span",{className:Bt?"text-red-700":"",children:nt.score||0}),"/",l.jsx("span",{children:nt.max_score||100}),nt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})()]}):(()=>{const Jt=c(nt),Bt=Jt!==null&&Jt<50,kn=Jt!==null&&Jt>=50&&Jt<70,Vr=Jt!==null&&Jt>=70,Kr=nt?.retest_offered===!0;console.debug("[TeacherResults] Render pill",{studentId:Ct.student_id,pct:Jt,isRed:Bt,isYellow:kn,isGreen:Vr,score:nt.score,max:nt.max_score,percentageField:nt.percentage});const Bn=`px-1 py-0.5 rounded text-xs font-medium ${Jt===null?"text-gray-600":Bt?"text-red-600 font-semibold":kn?"text-yellow-600":"text-green-600"} cursor-pointer hover:opacity-90 pointer-events-auto ${Kr?"bg-blue-50 text-blue-700 border border-blue-200":""}`;return l.jsxs(at.div,{className:Bn,style:Bt?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onClick:Jn=>{Jn.preventDefault(),Jn.stopPropagation();const fo=nt?.test_type||Ft?.test_type;if(!(fo==="drawing"||fo==="speaking"))if(Bt){if(nt?.retest_offered){o("Retest is already offered","info");return}const wc=window.getComputedStyle(Jn.currentTarget).color;console.debug("[TeacherResults] Red pill clicked -> opening retest modal",{studentId:Ct.student_id,className:Bn,computedColor:wc}),n({failedStudentIds:[Ct.student_id],test_type:Ft.test_type,original_test_id:nt?.test_id||Ft.test_id,subject_id:nt?.subject_id||Ft.subject_id,grade:t,class:r})}else ye(nt,Ft)},title:Kr?"Retest offered":Bt?"Offer retest":"Click to view answers",children:[l.jsx("span",{className:Bt?"text-red-700":"",children:nt.score}),"/",l.jsx("span",{children:nt.max_score}),nt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),nt.caught_cheating&&nt.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",nt.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},Hr)})]},Sr))})})]})})})}),[Gn,_e,_r,pe]),Pt=S.useCallback(()=>{if(!B)return null;console.log(" renderResults - results:",B),console.log(" renderResults - results.class:",B.class),console.log(" renderResults - results.unique_tests:",B.unique_tests);const tt=B.class&&Array.isArray(B.class)&&B.class.length>0;if(console.log(" renderResults - hasStudentData:",tt),!tt)return console.log(" renderResults - No student data, showing no students message"),l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const mt=B.unique_tests||[];return console.log(" renderResults - uniqueTests:",mt),Yt.current=B,l.jsxs("div",{className:"space-y-6",children:[l.jsxs(at.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[l.jsxs(at.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",z,", Class ",z,"/",K,", Semester ",C]}),l.jsxs(at.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",B.subjects?.length||0," subject(s)"]}),l.jsxs(at.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[l.jsx("button",{onClick:()=>{const Xt=B.unique_tests?.map(Ct=>Ct.test_name)||[];ne(new Set(Xt))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),l.jsx("button",{onClick:()=>ne(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),l.jsxs(at.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[l.jsx(at.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),l.jsx("div",{className:"hidden md:block",children:dt("All Subjects",B.class,mt)}),l.jsx("div",{className:"md:hidden",children:Rt("All Subjects",B.class,mt)})]})]})},[B,dt,z,K,C]),mn=S.useCallback(()=>{if(!B||!B.class||!B.unique_tests)return;const tt=["Student ID","Name","Surname","No.","Nickname",...B.unique_tests.map(Hr=>Hr.test_name)],mt=B.class.map((Hr,rn)=>{const nt=[];return nt.push(Hr.student_id),nt.push(Hr.name),nt.push(Hr.surname),nt.push(Hr.number??rn+1),nt.push(Hr.nickname||"-"),B.unique_tests.forEach(Jt=>{const Bt=Hr[Jt.test_name];Bt&&Bt.score!==null&&Bt.score!==void 0?nt.push(`${Bt.score}/${Bt.max_score}`):nt.push("-")}),nt}),Xt=u_.aoa_to_sheet([tt,...mt]),Ct=u_.book_new(),Sr=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...B.unique_tests.map(()=>({wch:15}))];Xt["!cols"]=Sr,u_.book_append_sheet(Ct,Xt,"Class Results");const Ft=`class-results-${z}-${K}-semester-${C}.xlsx`;xxe(Ct,Ft),o("Excel file exported successfully!","success")},[B,z,K,C,o]);return f?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Wr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):p?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:p}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex justify-between items-center py-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",ee?ee.toLocaleString():"Never"]})]})})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),F.length>0?(()=>{const tt=F.reduce((mt,Xt)=>{const Ct=Xt.subject||"Unknown Subject";return mt[Ct]||(mt[Ct]=[]),mt[Ct].push(Xt),mt},{});return l.jsx("div",{className:"space-y-6",children:Object.entries(tt).map(([mt,Xt])=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-3 flex flex-col sm:flex-row sm:items-center items-center",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),mt]}),l.jsxs("span",{className:"ml-0 sm:ml-2 text-sm text-gray-500 mt-1 sm:mt-0",children:["(",Xt.length," classes)"]})]}),l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Xt.map((Ct,Sr)=>l.jsxs(Ze,{variant:z===Ct.grade&&K===Ct.class?"primary":"outline",onClick:()=>Xr(Ct.grade,Ct.class),className:"px-3 py-1 text-xs font-medium min-w-[60px]",children:[Ct.grade,"/",Ct.class]},`${Ct.grade}-${Ct.class}-${Sr}`))})]},mt))})})():l.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),K&&na(),K&&B&&l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[z," ",K," - Test Results ",Ae?`(Term ${Le?.terms.find(tt=>tt.id===Ae)?.term})`:""]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:mn,children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),l.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),Pt()]}),K&&!B&&l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-gray-200 border-t-blue-500"}),l.jsx("span",{className:"text-gray-600",children:"Loading results"})]})})})]})}),Dt&&Ie&&l.jsx(Sk,{children:l.jsx(qB,{drawing:Dt,isOpen:Ie,onClose:()=>Ke(!1),isTeacherView:!0,onSaveScore:async({resultId:tt,score:mt,maxScore:Xt})=>{try{const Ct=await(window.tokenManager?.getToken()||Fs.get())||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(Jx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:Ct?`Bearer ${Ct}`:""},body:JSON.stringify({resultId:tt,score:mt,maxScore:Xt})})).ok)throw new Error("Failed to save");await cr(C,!0)}catch{o("Failed to save drawing score","error")}}})}),l.jsx(Sk,{children:l.jsx(Tie,{isOpen:fe,onClose:()=>{Te(!1),ct(null),oe(null)},testResult:He,questions:qe,isLoadingQuestions:Ee})}),Je&&Tt&&l.jsx(Sk,{children:l.jsx(Cie,{result:Je,isOpen:Tt,onClose:()=>Nt(!1),initialTab:Je.__initialTab||"overview",editingSpeakingScore:bt,tempSpeakingScore:ze,isSavingSpeakingScore:$e,onStartSpeakingScoreEdit:wt,onSaveSpeakingScore:Nr,onCancelSpeakingScoreEdit:Or,onTempSpeakingScoreChange:ke})})]})},Nxe={getTestPerformance:async(e,t=null)=>{try{await xc.loadAcademicCalendar();const n=xc.getCurrentTerm()?.id;if(!n)throw new Error("No current academic period found");console.log(` Fetching test performance for teacher ${e}, period ${n}, class: ${t||"all"}`);let s=`/.netlify/functions/get-test-performance?teacher_id=${e}&academic_period_id=${n}`;if(t){const[o,c]=t.split("/"),u=o.startsWith("M")?o:`M${o}`;s+=`&grade=${u}&class=${c}`}const a=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const i=await a.json();if(!i.success)throw new Error(i.error||"Failed to fetch performance data");return console.log(` Performance data loaded: ${i.count} tests`),i.data}catch(r){throw console.error(" Error fetching test performance:",r),r}}};function oz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=oz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function us(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=oz(e))&&(n&&(n+=" "),n+=t);return n}var Lk={},Bk={},HO;function Axe(){return HO||(HO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Bk)),Bk}var $k={},GO;function lz(){return GO||(GO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})($k)),$k}var Uk={},VO;function cz(){return VO||(VO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Uk)),Uk}var zk={},KO;function z3(){return KO||(KO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],s=r.length;if(s===0)return n;let a=0,i="",o="",c=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<s;){const u=r[a];o?u==="\\"&&a+1<s?(a++,i+=r[a]):u===o?o="":i+=u:c?u==='"'||u==="'"?o=u:u==="]"?(c=!1,n.push(i),i=""):i+=u:u==="["?(c=!0,i&&(n.push(i),i="")):u==="."?i&&(n.push(i),i=""):i+=u,a++}return i&&n.push(i),n}e.toPath=t})(zk)),zk}var qO;function W3(){return qO||(qO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Axe(),r=lz(),n=cz(),s=z3();function a(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?r.isDeepKey(c)?a(o,s.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=o[c];return d===void 0?u:d}default:{if(Array.isArray(c))return i(o,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?u:d}}}function i(o,c,u){if(c.length===0)return u;let d=o;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=a})(Lk)),Lk}var Wk,YO;function jxe(){return YO||(YO=1,Wk=W3().get),Wk}var Pxe=jxe();const y2=Ml(Pxe);var Hk={exports:{}},jn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XO;function Fxe(){if(XO)return jn;XO=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,o=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,f=e?Symbol.for("react.suspense"):60113,g=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,x=e?Symbol.for("react.lazy"):60116,v=e?Symbol.for("react.block"):60121,w=e?Symbol.for("react.fundamental"):60117,C=e?Symbol.for("react.responder"):60118,k=e?Symbol.for("react.scope"):60119;function _(E){if(typeof E=="object"&&E!==null){var P=E.$$typeof;switch(P){case t:switch(E=E.type,E){case c:case u:case n:case a:case s:case f:return E;default:switch(E=E&&E.$$typeof,E){case o:case d:case x:case p:case i:return E;default:return P}}case r:return P}}}function N(E){return _(E)===u}return jn.AsyncMode=c,jn.ConcurrentMode=u,jn.ContextConsumer=o,jn.ContextProvider=i,jn.Element=t,jn.ForwardRef=d,jn.Fragment=n,jn.Lazy=x,jn.Memo=p,jn.Portal=r,jn.Profiler=a,jn.StrictMode=s,jn.Suspense=f,jn.isAsyncMode=function(E){return N(E)||_(E)===c},jn.isConcurrentMode=N,jn.isContextConsumer=function(E){return _(E)===o},jn.isContextProvider=function(E){return _(E)===i},jn.isElement=function(E){return typeof E=="object"&&E!==null&&E.$$typeof===t},jn.isForwardRef=function(E){return _(E)===d},jn.isFragment=function(E){return _(E)===n},jn.isLazy=function(E){return _(E)===x},jn.isMemo=function(E){return _(E)===p},jn.isPortal=function(E){return _(E)===r},jn.isProfiler=function(E){return _(E)===a},jn.isStrictMode=function(E){return _(E)===s},jn.isSuspense=function(E){return _(E)===f},jn.isValidElementType=function(E){return typeof E=="string"||typeof E=="function"||E===n||E===u||E===a||E===s||E===f||E===g||typeof E=="object"&&E!==null&&(E.$$typeof===x||E.$$typeof===p||E.$$typeof===i||E.$$typeof===o||E.$$typeof===d||E.$$typeof===w||E.$$typeof===C||E.$$typeof===k||E.$$typeof===v)},jn.typeOf=_,jn}var QO;function Oxe(){return QO||(QO=1,Hk.exports=Fxe()),Hk.exports}Oxe();var El=e=>e===0?0:e>0?1:-1,Dl=e=>typeof e=="number"&&e!=+e,Lh=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,$r=e=>(typeof e=="number"||e instanceof Number)&&!Dl(e),au=e=>$r(e)||typeof e=="string",Dxe=0,pv=e=>{var t=++Dxe;return"".concat(e||"").concat(t)},Df=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!$r(t)&&typeof t!="string")return n;var a;if(Lh(t)){if(r==null)return n;var i=t.indexOf("%");a=r*parseFloat(t.slice(0,i))/100}else a=+t;return Dl(a)&&(a=n),s&&r!=null&&a>r&&(a=r),a},uz=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function Hu(e,t,r){return $r(e)&&$r(t)?e+r*(t-e):t}function dz(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):y2(n,t))===r)}var Ka=e=>e===null||typeof e>"u",H3=e=>Ka(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),Ixe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function G3(e){if(typeof e!="string")return!1;var t=Ixe;return t.includes(e)}var Rxe=["viewBox","children"],JO=["points","pathLength"],Gk={svg:Rxe,polygon:JO,polyline:JO},V3=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(S.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(s=>{G3(s)&&(n[s]=(a=>r[s](r,a)))}),n},Mxe=(e,t,r)=>n=>(e(t,r,n),null),Lxe=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(s=>{var a=e[s];G3(s)&&typeof a=="function"&&(n||(n={}),n[s]=Mxe(a,t,r))}),n},Bxe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function fz(e){if(typeof e!="string")return!1;var t=Bxe;return t.includes(e)}function L0(e){var t=Object.entries(e).filter(r=>{var[n]=r;return fz(n)});return Object.fromEntries(t)}var hz=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,$xe=(e,t,r,n)=>{var s;if(typeof t=="symbol"||typeof t=="number")return!0;var a=(s=n&&Gk?.[n])!==null&&s!==void 0?s:[],i=t.startsWith("data-"),o=typeof e!="function"&&(!!n&&a.includes(t)||fz(t)),c=!!r&&G3(t);return i||o||c},wi=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(S.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var s={};return Object.keys(n).forEach(a=>{var i;$xe((i=n)===null||i===void 0?void 0:i[a],a,t,r)&&(s[a]=n[a])}),s},Uxe=["children","width","height","viewBox","className","style","title","desc"];function AE(){return AE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AE.apply(null,arguments)}function zxe(e,t){if(e==null)return{};var r,n,s=Wxe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Wxe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gz=S.forwardRef((e,t)=>{var{children:r,width:n,height:s,viewBox:a,className:i,style:o,title:c,desc:u}=e,d=zxe(e,Uxe),f=a||{width:n,height:s,x:0,y:0},g=us("recharts-surface",i);return S.createElement("svg",AE({},wi(d,!0,"svg"),{className:g,width:n,height:s,style:o,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),S.createElement("title",null,c),S.createElement("desc",null,u),r)}),Hxe=["children","className"];function jE(){return jE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jE.apply(null,arguments)}function Gxe(e,t){if(e==null)return{};var r,n,s=Vxe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Vxe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var sp=S.forwardRef((e,t)=>{var{children:r,className:n}=e,s=Gxe(e,Hxe),a=us("recharts-layer",n);return S.createElement("g",jE({className:a},wi(s,!0),{ref:t}),r)}),Kxe=S.createContext(null);function Ps(e){return function(){return e}}const PE=Math.PI,FE=2*PE,Ah=1e-6,qxe=FE-Ah;function mz(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Yxe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return mz;const r=10**t;return function(n){this._+=n[0];for(let s=1,a=n.length;s<a;++s)this._+=Math.round(arguments[s]*r)/r+n[s]}}class Xxe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?mz:Yxe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,s){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+s}`}bezierCurveTo(t,r,n,s,a,i){this._append`C${+t},${+r},${+n},${+s},${this._x1=+a},${this._y1=+i}`}arcTo(t,r,n,s,a){if(t=+t,r=+r,n=+n,s=+s,a=+a,a<0)throw new Error(`negative radius: ${a}`);let i=this._x1,o=this._y1,c=n-t,u=s-r,d=i-t,f=o-r,g=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(g>Ah)if(!(Math.abs(f*c-u*d)>Ah)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-i,x=s-o,v=c*c+u*u,w=p*p+x*x,C=Math.sqrt(v),k=Math.sqrt(g),_=a*Math.tan((PE-Math.acos((v+g-w)/(2*C*k)))/2),N=_/k,E=_/C;Math.abs(N-1)>Ah&&this._append`L${t+N*d},${r+N*f}`,this._append`A${a},${a},0,0,${+(f*p>d*x)},${this._x1=t+E*c},${this._y1=r+E*u}`}}arc(t,r,n,s,a,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(s),c=n*Math.sin(s),u=t+o,d=r+c,f=1^i,g=i?s-a:a-s;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Ah||Math.abs(this._y1-d)>Ah)&&this._append`L${u},${d}`,n&&(g<0&&(g=g%FE+FE),g>qxe?this._append`A${n},${n},0,1,${f},${t-o},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:g>Ah&&this._append`A${n},${n},0,${+(g>=PE)},${f},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+s}h${-n}Z`}toString(){return this._}}function pz(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Xxe(t)}function K3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function xz(e){this._context=e}xz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function v2(e){return new xz(e)}function yz(e){return e[0]}function vz(e){return e[1]}function wz(e,t){var r=Ps(!0),n=null,s=v2,a=null,i=pz(o);e=typeof e=="function"?e:e===void 0?yz:Ps(e),t=typeof t=="function"?t:t===void 0?vz:Ps(t);function o(c){var u,d=(c=K3(c)).length,f,g=!1,p;for(n==null&&(a=s(p=i())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===g&&((g=!g)?a.lineStart():a.lineEnd()),g&&a.point(+e(f,u,c),+t(f,u,c));if(p)return a=null,p+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:Ps(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:Ps(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Ps(!!c),o):r},o.curve=function(c){return arguments.length?(s=c,n!=null&&(a=s(n)),o):s},o.context=function(c){return arguments.length?(c==null?n=a=null:a=s(n=c),o):n},o}function Bw(e,t,r){var n=null,s=Ps(!0),a=null,i=v2,o=null,c=pz(u);e=typeof e=="function"?e:e===void 0?yz:Ps(+e),t=typeof t=="function"?t:Ps(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?vz:Ps(+r);function u(f){var g,p,x,v=(f=K3(f)).length,w,C=!1,k,_=new Array(v),N=new Array(v);for(a==null&&(o=i(k=c())),g=0;g<=v;++g){if(!(g<v&&s(w=f[g],g,f))===C)if(C=!C)p=g,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=g-1;x>=p;--x)o.point(_[x],N[x]);o.lineEnd(),o.areaEnd()}C&&(_[g]=+e(w,g,f),N[g]=+t(w,g,f),o.point(n?+n(w,g,f):_[g],r?+r(w,g,f):N[g]))}if(k)return o=null,k+""||null}function d(){return wz().defined(s).curve(i).context(a)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Ps(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Ps(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Ps(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Ps(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Ps(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Ps(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(s=typeof f=="function"?f:Ps(!!f),u):s},u.curve=function(f){return arguments.length?(i=f,a!=null&&(o=i(a)),u):i},u.context=function(f){return arguments.length?(f==null?a=o=null:o=i(a=f),u):a},u}class _z{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Qxe(e){return new _z(e,!0)}function Jxe(e){return new _z(e,!1)}function tb(){}function rb(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function bz(e){this._context=e}bz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:rb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:rb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Zxe(e){return new bz(e)}function Sz(e){this._context=e}Sz.prototype={areaStart:tb,areaEnd:tb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:rb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eye(e){return new Sz(e)}function kz(e){this._context=e}kz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:rb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tye(e){return new kz(e)}function Cz(e){this._context=e}Cz.prototype={areaStart:tb,areaEnd:tb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function rye(e){return new Cz(e)}function ZO(e){return e<0?-1:1}function eD(e,t,r){var n=e._x1-e._x0,s=t-e._x1,a=(e._y1-e._y0)/(n||s<0&&-0),i=(r-e._y1)/(s||n<0&&-0),o=(a*s+i*n)/(n+s);return(ZO(a)+ZO(i))*Math.min(Math.abs(a),Math.abs(i),.5*Math.abs(o))||0}function tD(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Vk(e,t,r){var n=e._x0,s=e._y0,a=e._x1,i=e._y1,o=(a-n)/3;e._context.bezierCurveTo(n+o,s+o*t,a-o,i-o*r,a,i)}function nb(e){this._context=e}nb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Vk(this,this._t0,tD(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Vk(this,tD(this,r=eD(this,e,t)),r);break;default:Vk(this,this._t0,r=eD(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Tz(e){this._context=new Ez(e)}(Tz.prototype=Object.create(nb.prototype)).point=function(e,t){nb.prototype.point.call(this,t,e)};function Ez(e){this._context=e}Ez.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,s,a){this._context.bezierCurveTo(t,e,n,r,a,s)}};function nye(e){return new nb(e)}function sye(e){return new Tz(e)}function Nz(e){this._context=e}Nz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=rD(e),s=rD(t),a=0,i=1;i<r;++a,++i)this._context.bezierCurveTo(n[0][a],s[0][a],n[1][a],s[1][a],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function rD(e){var t,r=e.length-1,n,s=new Array(r),a=new Array(r),i=new Array(r);for(s[0]=0,a[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,a[t]=4,i[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,a[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=s[t]/a[t-1],a[t]-=n,i[t]-=n*i[t-1];for(s[r-1]=i[r-1]/a[r-1],t=r-2;t>=0;--t)s[t]=(i[t]-s[t+1])/a[t];for(a[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-s[t+1];return[s,a]}function aye(e){return new Nz(e)}function w2(e,t){this._context=e,this._t=t}w2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function iye(e){return new w2(e,.5)}function oye(e){return new w2(e,0)}function lye(e){return new w2(e,1)}function jm(e,t){if((i=e.length)>1)for(var r=1,n,s,a=e[t[0]],i,o=a.length;r<i;++r)for(s=a,a=e[t[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(s[n][1])?s[n][0]:s[n][1]}function OE(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function cye(e,t){return e[t]}function uye(e){const t=[];return t.key=e,t}function dye(){var e=Ps([]),t=OE,r=jm,n=cye;function s(a){var i=Array.from(e.apply(this,arguments),uye),o,c=i.length,u=-1,d;for(const f of a)for(o=0,++u;o<c;++o)(i[o][u]=[0,+n(f,i[o].key,u,a)]).data=f;for(o=0,d=K3(t(i));o<c;++o)i[d[o]].index=o;return r(i,d),i}return s.keys=function(a){return arguments.length?(e=typeof a=="function"?a:Ps(Array.from(a)),s):e},s.value=function(a){return arguments.length?(n=typeof a=="function"?a:Ps(+a),s):n},s.order=function(a){return arguments.length?(t=a==null?OE:typeof a=="function"?a:Ps(Array.from(a)),s):t},s.offset=function(a){return arguments.length?(r=a??jm,s):r},s}function fye(e,t){if((n=e.length)>0){for(var r,n,s=0,a=e[0].length,i;s<a;++s){for(i=r=0;r<n;++r)i+=e[r][s][1]||0;if(i)for(r=0;r<n;++r)e[r][s][1]/=i}jm(e,t)}}function hye(e,t){if((s=e.length)>0){for(var r=0,n=e[t[0]],s,a=n.length;r<a;++r){for(var i=0,o=0;i<s;++i)o+=e[i][r][1]||0;n[r][1]+=n[r][0]=-o/2}jm(e,t)}}function gye(e,t){if(!(!((i=e.length)>0)||!((a=(s=e[t[0]]).length)>0))){for(var r=0,n=1,s,a,i;n<a;++n){for(var o=0,c=0,u=0;o<i;++o){for(var d=e[t[o]],f=d[n][1]||0,g=d[n-1][1]||0,p=(f-g)/2,x=0;x<o;++x){var v=e[t[x]],w=v[n][1]||0,C=v[n-1][1]||0;p+=w-C}c+=f,u+=p*f}s[n-1][1]+=s[n-1][0]=r,c&&(r-=u/c)}s[n-1][1]+=s[n-1][0]=r,jm(e,t)}}var Kk={},qk={},nD;function mye(){return nD||(nD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const s=new Map;for(let a=0;a<r.length;a++){const i=r[a],o=n(i);s.has(o)||s.set(o,i)}return Array.from(s.values())}e.uniqBy=t})(qk)),qk}var Yk={},sD;function Az(){return sD||(sD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Yk)),Yk}var Xk={},Qk={},Jk={},aD;function pye(){return aD||(aD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Jk)),Jk}var iD;function q3(){return iD||(iD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pye();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Qk)),Qk}var Zk={},oD;function xye(){return oD||(oD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Zk)),Zk}var lD;function yye(){return lD||(lD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=q3(),r=xye();function n(s){return r.isObjectLike(s)&&t.isArrayLike(s)}e.isArrayLikeObject=n})(Xk)),Xk}var eC={},tC={},cD;function vye(){return cD||(cD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W3();function r(n){return function(s){return t.get(s,n)}}e.property=r})(tC)),tC}var rC={},nC={},sC={},aC={},uD;function jz(){return uD||(uD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(aC)),aC}var iC={},dD;function Pz(){return dD||(dD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(iC)),iC}var oC={},fD;function Fz(){return fD||(fD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(oC)),oC}var hD;function wye(){return hD||(hD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Y3(),r=jz(),n=Pz(),s=Fz();function a(f,g,p){return typeof p!="function"?t.isMatch(f,g):i(f,g,function x(v,w,C,k,_,N){const E=p(v,w,C,k,_,N);return E!==void 0?!!E:i(v,w,x,N)},new Map)}function i(f,g,p,x){if(g===f)return!0;switch(typeof g){case"object":return o(f,g,p,x);case"function":return Object.keys(g).length>0?i(f,{...g},p,x):s.eq(f,g);default:return r.isObject(f)?typeof g=="string"?g==="":!0:s.eq(f,g)}}function o(f,g,p,x){if(g==null)return!0;if(Array.isArray(g))return u(f,g,p,x);if(g instanceof Map)return c(f,g,p,x);if(g instanceof Set)return d(f,g,p,x);const v=Object.keys(g);if(f==null)return v.length===0;if(v.length===0)return!0;if(x&&x.has(g))return x.get(g)===f;x&&x.set(g,f);try{for(let w=0;w<v.length;w++){const C=v[w];if(!n.isPrimitive(f)&&!(C in f)||g[C]===void 0&&f[C]!==void 0||g[C]===null&&f[C]!==null||!p(f[C],g[C],C,f,g,x))return!1}return!0}finally{x&&x.delete(g)}}function c(f,g,p,x){if(g.size===0)return!0;if(!(f instanceof Map))return!1;for(const[v,w]of g.entries()){const C=f.get(v);if(p(C,w,v,f,g,x)===!1)return!1}return!0}function u(f,g,p,x){if(g.length===0)return!0;if(!Array.isArray(f))return!1;const v=new Set;for(let w=0;w<g.length;w++){const C=g[w];let k=!1;for(let _=0;_<f.length;_++){if(v.has(_))continue;const N=f[_];let E=!1;if(p(N,C,w,f,g,x)&&(E=!0),E){v.add(_),k=!0;break}}if(!k)return!1}return!0}function d(f,g,p,x){return g.size===0?!0:f instanceof Set?u([...f],[...g],p,x):!1}e.isMatchWith=a,e.isSetMatch=d})(sC)),sC}var gD;function Y3(){return gD||(gD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wye();function r(n,s){return t.isMatchWith(n,s,()=>{})}e.isMatch=r})(nC)),nC}var lC={},cC={},uC={},mD;function _ye(){return mD||(mD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(uC)),uC}var dC={},pD;function Oz(){return pD||(pD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(dC)),dC}var fC={},xD;function Dz(){return xD||(xD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",s="[object Boolean]",a="[object Arguments]",i="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",g="[object ArrayBuffer]",p="[object Object]",x="[object Error]",v="[object DataView]",w="[object Uint8Array]",C="[object Uint8ClampedArray]",k="[object Uint16Array]",_="[object Uint32Array]",N="[object BigUint64Array]",E="[object Int8Array]",P="[object Int16Array]",F="[object Int32Array]",A="[object BigInt64Array]",j="[object Float32Array]",I="[object Float64Array]";e.argumentsTag=a,e.arrayBufferTag=g,e.arrayTag=d,e.bigInt64ArrayTag=A,e.bigUint64ArrayTag=N,e.booleanTag=s,e.dataViewTag=v,e.dateTag=o,e.errorTag=x,e.float32ArrayTag=j,e.float64ArrayTag=I,e.functionTag=f,e.int16ArrayTag=P,e.int32ArrayTag=F,e.int8ArrayTag=E,e.mapTag=c,e.numberTag=n,e.objectTag=p,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=i,e.uint16ArrayTag=k,e.uint32ArrayTag=_,e.uint8ArrayTag=w,e.uint8ClampedArrayTag=C})(fC)),fC}var hC={},yD;function bye(){return yD||(yD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(hC)),hC}var vD;function Iz(){return vD||(vD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_ye(),r=Oz(),n=Dz(),s=Pz(),a=bye();function i(d,f){return o(d,void 0,d,new Map,f)}function o(d,f,g,p=new Map,x=void 0){const v=x?.(d,f,g,p);if(v!==void 0)return v;if(s.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const w=new Array(d.length);p.set(d,w);for(let C=0;C<d.length;C++)w[C]=o(d[C],C,g,p,x);return Object.hasOwn(d,"index")&&(w.index=d.index),Object.hasOwn(d,"input")&&(w.input=d.input),w}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const w=new RegExp(d.source,d.flags);return w.lastIndex=d.lastIndex,w}if(d instanceof Map){const w=new Map;p.set(d,w);for(const[C,k]of d)w.set(C,o(k,C,g,p,x));return w}if(d instanceof Set){const w=new Set;p.set(d,w);for(const C of d)w.add(o(C,void 0,g,p,x));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(a.isTypedArray(d)){const w=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,w);for(let C=0;C<d.length;C++)w[C]=o(d[C],C,g,p,x);return w}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const w=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,w),c(w,d,g,p,x),w}if(typeof File<"u"&&d instanceof File){const w=new File([d],d.name,{type:d.type});return p.set(d,w),c(w,d,g,p,x),w}if(d instanceof Blob){const w=new Blob([d],{type:d.type});return p.set(d,w),c(w,d,g,p,x),w}if(d instanceof Error){const w=new d.constructor;return p.set(d,w),w.message=d.message,w.name=d.name,w.stack=d.stack,w.cause=d.cause,c(w,d,g,p,x),w}if(typeof d=="object"&&u(d)){const w=Object.create(Object.getPrototypeOf(d));return p.set(d,w),c(w,d,g,p,x),w}return d}function c(d,f,g=d,p,x){const v=[...Object.keys(f),...t.getSymbols(f)];for(let w=0;w<v.length;w++){const C=v[w],k=Object.getOwnPropertyDescriptor(d,C);(k==null||k.writable)&&(d[C]=o(f[C],C,g,p,x))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=i,e.cloneDeepWithImpl=o,e.copyProperties=c})(cC)),cC}var wD;function Sye(){return wD||(wD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Iz();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(lC)),lC}var _D;function kye(){return _D||(_D=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Y3(),r=Sye();function n(s){return s=r.cloneDeep(s),a=>t.isMatch(a,s)}e.matches=n})(rC)),rC}var gC={},mC={},pC={},bD;function Cye(){return bD||(bD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Iz(),r=Dz();function n(s,a){return t.cloneDeepWith(s,(i,o,c,u)=>{const d=a?.(i,o,c,u);if(d!==void 0)return d;if(typeof s=="object")switch(Object.prototype.toString.call(s)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new s.constructor(s?.valueOf());return t.copyProperties(f,s),f}case r.argumentsTag:{const f={};return t.copyProperties(f,s),f.length=s.length,f[Symbol.iterator]=s[Symbol.iterator],f}default:return}})}e.cloneDeepWith=n})(pC)),pC}var SD;function Tye(){return SD||(SD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Cye();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(mC)),mC}var xC={},yC={},kD;function Rz(){return kD||(kD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,s=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<s;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(yC)),yC}var vC={},CD;function Eye(){return CD||(CD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Oz();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(vC)),vC}var TD;function Nye(){return TD||(TD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lz(),r=Rz(),n=Eye(),s=z3();function a(i,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&i?.[o]==null?c=s.toPath(o):c=[o],c.length===0)return!1;let u=i;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=a})(xC)),xC}var ED;function Aye(){return ED||(ED=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Y3(),r=cz(),n=Tye(),s=W3(),a=Nye();function i(o,c){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(u){const d=s.get(u,o);return d===void 0?a.has(u,o):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=i})(gC)),gC}var ND;function jye(){return ND||(ND=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Az(),r=vye(),n=kye(),s=Aye();function a(i){if(i==null)return t.identity;switch(typeof i){case"function":return i;case"object":return Array.isArray(i)&&i.length===2?s.matchesProperty(i[0],i[1]):n.matches(i);case"string":case"symbol":case"number":return r.property(i)}}e.iteratee=a})(eC)),eC}var AD;function Pye(){return AD||(AD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mye(),r=Az(),n=yye(),s=jye();function a(i,o=r.identity){return n.isArrayLikeObject(i)?t.uniqBy(Array.from(i),s.iteratee(o)):[]}e.uniqBy=a})(Kk)),Kk}var wC,jD;function Fye(){return jD||(jD=1,wC=Pye().uniqBy),wC}var Oye=Fye();const PD=Ml(Oye);function Dye(e,t,r){return t===!0?PD(e,r):typeof t=="function"?PD(e,t):e}var _C={exports:{}},bC={},SC={exports:{}},kC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FD;function Iye(){if(FD)return kC;FD=1;var e=E0();function t(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,s=e.useEffect,a=e.useLayoutEffect,i=e.useDebugValue;function o(f,g){var p=g(),x=n({inst:{value:p,getSnapshot:g}}),v=x[0].inst,w=x[1];return a(function(){v.value=p,v.getSnapshot=g,c(v)&&w({inst:v})},[f,p,g]),s(function(){return c(v)&&w({inst:v}),f(function(){c(v)&&w({inst:v})})},[f]),i(p),p}function c(f){var g=f.getSnapshot;f=f.value;try{var p=g();return!r(f,p)}catch{return!0}}function u(f,g){return g()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return kC.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,kC}var OD;function Rye(){return OD||(OD=1,SC.exports=Iye()),SC.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DD;function Mye(){if(DD)return bC;DD=1;var e=E0(),t=Rye();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:r,s=t.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,c=e.useDebugValue;return bC.useSyncExternalStoreWithSelector=function(u,d,f,g,p){var x=a(null);if(x.current===null){var v={hasValue:!1,value:null};x.current=v}else v=x.current;x=o(function(){function C(P){if(!k){if(k=!0,_=P,P=g(P),p!==void 0&&v.hasValue){var F=v.value;if(p(F,P))return N=F}return N=P}if(F=N,n(_,P))return F;var A=g(P);return p!==void 0&&p(F,A)?(_=P,F):(_=P,N=A)}var k=!1,_,N,E=f===void 0?null:f;return[function(){return C(d())},E===null?void 0:function(){return C(E())}]},[d,f,g,p]);var w=s(u,x[0],x[1]);return i(function(){v.hasValue=!0,v.value=w},[w]),c(w),w},bC}var ID;function Lye(){return ID||(ID=1,_C.exports=Mye()),_C.exports}var Bye=Lye(),X3=S.createContext(null),$ye=e=>e,uo=()=>{var e=S.useContext(X3);return e?e.store.dispatch:$ye},d_=()=>{},Uye=()=>d_,zye=(e,t)=>e===t;function Pr(e){var t=S.useContext(X3);return Bye.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Uye,t?t.store.getState:d_,t?t.store.getState:d_,t?e:d_,zye)}function Wye(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Hye(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Gye(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var RD=e=>Array.isArray(e)?e:[e];function Vye(e){const t=Array.isArray(e[0])?e[0]:e;return Gye(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Kye(e,t){const r=[],{length:n}=e;for(let s=0;s<n;s++)r.push(e[s].apply(null,t));return r}var qye=class{constructor(e){this.value=e}deref(){return this.value}},Yye=typeof WeakRef<"u"?WeakRef:qye,Xye=0,MD=1;function $w(){return{s:Xye,v:void 0,o:null,p:null}}function Mz(e,t={}){let r=$w();const{resultEqualityCheck:n}=t;let s,a=0;function i(){let o=r;const{length:c}=arguments;for(let f=0,g=c;f<g;f++){const p=arguments[f];if(typeof p=="function"||typeof p=="object"&&p!==null){let x=o.o;x===null&&(o.o=x=new WeakMap);const v=x.get(p);v===void 0?(o=$w(),x.set(p,o)):o=v}else{let x=o.p;x===null&&(o.p=x=new Map);const v=x.get(p);v===void 0?(o=$w(),x.set(p,o)):o=v}}const u=o;let d;if(o.s===MD)d=o.v;else if(d=e.apply(null,arguments),a++,n){const f=s?.deref?.()??s;f!=null&&n(f,d)&&(d=f,a!==0&&a--),s=typeof d=="object"&&d!==null||typeof d=="function"?new Yye(d):d}return u.s=MD,u.v=d,d}return i.clearCache=()=>{r=$w(),i.resetResultsCount()},i.resultsCount=()=>a,i.resetResultsCount=()=>{a=0},i}function Qye(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...s)=>{let a=0,i=0,o,c={},u=s.pop();typeof u=="object"&&(c=u,u=s.pop()),Wye(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:g=[],argsMemoize:p=Mz,argsMemoizeOptions:x=[]}=d,v=RD(g),w=RD(x),C=Vye(s),k=f(function(){return a++,u.apply(null,arguments)},...v),_=p(function(){i++;const E=Kye(C,arguments);return o=k.apply(null,E),o},...w);return Object.assign(_,{resultFunc:u,memoizedResultFunc:k,dependencies:C,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:f,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var kt=Qye(Mz),Jye=Object.assign((e,t=kt)=>{Hye(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((i,o,c)=>(i[r[c]]=o,i),{}))},{withTypes:()=>Jye}),CC={},TC={},EC={},LD;function Zye(){return LD||(LD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,s,a)=>{if(n!==s){const i=t(n),o=t(s);if(i===o&&i===0){if(n<s)return a==="desc"?1:-1;if(n>s)return a==="desc"?-1:1}return a==="desc"?o-i:i-o}return 0};e.compareValues=r})(EC)),EC}var NC={},AC={},BD;function Lz(){return BD||(BD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(AC)),AC}var $D;function eve(){return $D||($D=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Lz(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(a,i){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||t.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||i!=null&&Object.hasOwn(i,a)}e.isKey=s})(NC)),NC}var UD;function tve(){return UD||(UD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zye(),r=eve(),n=z3();function s(a,i,o,c){if(a==null)return[];o=c?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(i)||(i=i==null?[null]:[i]),i.length===0&&(i=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const u=(p,x)=>{let v=p;for(let w=0;w<x.length&&v!=null;++w)v=v[x[w]];return v},d=(p,x)=>x==null||p==null?x:typeof p=="object"&&"key"in p?Object.hasOwn(x,p.key)?x[p.key]:u(x,p.path):typeof p=="function"?p(x):Array.isArray(p)?u(x,p):typeof x=="object"?x[p]:x,f=i.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return a.map(p=>({original:p,criteria:f.map(x=>d(x,p))})).slice().sort((p,x)=>{for(let v=0;v<f.length;v++){const w=t.compareValues(p.criteria[v],x.criteria[v],o[v]);if(w!==0)return w}return 0}).map(p=>p.original)}e.orderBy=s})(TC)),TC}var jC={},zD;function rve(){return zD||(zD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const s=[],a=Math.floor(n),i=(o,c)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&c<a?i(d,c+1):s.push(d)}};return i(r,0),s}e.flatten=t})(jC)),jC}var PC={},WD;function Bz(){return WD||(WD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rz(),r=q3(),n=jz(),s=Fz();function a(i,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?s.eq(c[o],i):!1}e.isIterateeCall=a})(PC)),PC}var HD;function nve(){return HD||(HD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tve(),r=rve(),n=Bz();function s(a,...i){const o=i.length;return o>1&&n.isIterateeCall(a,i[0],i[1])?i=[]:o>2&&n.isIterateeCall(i[0],i[1],i[2])&&(i=[i[0]]),t.orderBy(a,r.flatten(i),["asc"])}e.sortBy=s})(CC)),CC}var FC,GD;function sve(){return GD||(GD=1,FC=nve().sortBy),FC}var ave=sve();const _2=Ml(ave);var $z=e=>e.legend.settings,ive=e=>e.legend.size,ove=e=>e.legend.payload;kt([ove,$z],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?_2(n,r):n});var Uw=1;function lve(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=S.useState({height:0,left:0,top:0,width:0}),n=S.useCallback(s=>{if(s!=null){var a=s.getBoundingClientRect(),i={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(i.height-t.height)>Uw||Math.abs(i.left-t.left)>Uw||Math.abs(i.top-t.top)>Uw||Math.abs(i.width-t.width)>Uw)&&r({height:i.height,left:i.left,top:i.top,width:i.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function li(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var cve=typeof Symbol=="function"&&Symbol.observable||"@@observable",VD=cve,OC=()=>Math.random().toString(36).substring(7).split("").join("."),uve={INIT:`@@redux/INIT${OC()}`,REPLACE:`@@redux/REPLACE${OC()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${OC()}`},sb=uve;function Q3(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Uz(e,t,r){if(typeof e!="function")throw new Error(li(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(li(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(li(1));return r(Uz)(e,t)}let n=e,s=t,a=new Map,i=a,o=0,c=!1;function u(){i===a&&(i=new Map,a.forEach((w,C)=>{i.set(C,w)}))}function d(){if(c)throw new Error(li(3));return s}function f(w){if(typeof w!="function")throw new Error(li(4));if(c)throw new Error(li(5));let C=!0;u();const k=o++;return i.set(k,w),function(){if(C){if(c)throw new Error(li(6));C=!1,u(),i.delete(k),a=null}}}function g(w){if(!Q3(w))throw new Error(li(7));if(typeof w.type>"u")throw new Error(li(8));if(typeof w.type!="string")throw new Error(li(17));if(c)throw new Error(li(9));try{c=!0,s=n(s,w)}finally{c=!1}return(a=i).forEach(k=>{k()}),w}function p(w){if(typeof w!="function")throw new Error(li(10));n=w,g({type:sb.REPLACE})}function x(){const w=f;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(li(11));function k(){const N=C;N.next&&N.next(d())}return k(),{unsubscribe:w(k)}},[VD](){return this}}}return g({type:sb.INIT}),{dispatch:g,subscribe:f,getState:d,replaceReducer:p,[VD]:x}}function dve(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:sb.INIT})>"u")throw new Error(li(12));if(typeof r(void 0,{type:sb.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(li(13))})}function zz(e){const t=Object.keys(e),r={};for(let a=0;a<t.length;a++){const i=t[a];typeof e[i]=="function"&&(r[i]=e[i])}const n=Object.keys(r);let s;try{dve(r)}catch(a){s=a}return function(i={},o){if(s)throw s;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],g=r[f],p=i[f],x=g(p,o);if(typeof x>"u")throw o&&o.type,new Error(li(14));u[f]=x,c=c||x!==p}return c=c||n.length!==Object.keys(i).length,c?u:i}}function ab(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function fve(...e){return t=>(r,n)=>{const s=t(r,n);let a=()=>{throw new Error(li(15))};const i={getState:s.getState,dispatch:(c,...u)=>a(c,...u)},o=e.map(c=>c(i));return a=ab(...o)(s.dispatch),{...s,dispatch:a}}}function Wz(e){return Q3(e)&&"type"in e&&typeof e.type=="string"}var Hz=Symbol.for("immer-nothing"),KD=Symbol.for("immer-draftable"),el=Symbol.for("immer-state");function oc(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Pm=Object.getPrototypeOf;function b0(e){return!!e&&!!e[el]}function ld(e){return e?Gz(e)||Array.isArray(e)||!!e[KD]||!!e.constructor?.[KD]||r1(e)||S2(e):!1}var hve=Object.prototype.constructor.toString();function Gz(e){if(!e||typeof e!="object")return!1;const t=Pm(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===hve}function ib(e,t){b2(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function b2(e){const t=e[el];return t?t.type_:Array.isArray(e)?1:r1(e)?2:S2(e)?3:0}function DE(e,t){return b2(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Vz(e,t,r){const n=b2(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function gve(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function r1(e){return e instanceof Map}function S2(e){return e instanceof Set}function jh(e){return e.copy_||e.base_}function IE(e,t){if(r1(e))return new Map(e);if(S2(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Gz(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[el];let s=Reflect.ownKeys(n);for(let a=0;a<s.length;a++){const i=s[a],o=n[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Pm(e),n)}else{const n=Pm(e);if(n!==null&&r)return{...e};const s=Object.create(n);return Object.assign(s,e)}}function J3(e,t=!1){return k2(e)||b0(e)||!ld(e)||(b2(e)>1&&Object.defineProperties(e,{set:{value:zw},add:{value:zw},clear:{value:zw},delete:{value:zw}}),Object.freeze(e),t&&Object.values(e).forEach(r=>J3(r,!0))),e}function zw(){oc(2)}function k2(e){return Object.isFrozen(e)}var mve={};function S0(e){const t=mve[e];return t||oc(0,e),t}var xv;function Kz(){return xv}function pve(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function qD(e,t){t&&(S0("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function RE(e){ME(e),e.drafts_.forEach(xve),e.drafts_=null}function ME(e){e===xv&&(xv=e.parent_)}function YD(e){return xv=pve(xv,e)}function xve(e){const t=e[el];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function XD(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[el].modified_&&(RE(t),oc(4)),ld(e)&&(e=ob(t,e),t.parent_||lb(t,e)),t.patches_&&S0("Patches").generateReplacementPatches_(r[el].base_,e,t.patches_,t.inversePatches_)):e=ob(t,r,[]),RE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Hz?e:void 0}function ob(e,t,r){if(k2(t))return t;const n=t[el];if(!n)return ib(t,(s,a)=>QD(e,n,t,s,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return lb(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let a=s,i=!1;n.type_===3&&(a=new Set(s),s.clear(),i=!0),ib(a,(o,c)=>QD(e,n,s,o,c,r,i)),lb(e,s,!1),r&&e.patches_&&S0("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function QD(e,t,r,n,s,a,i){if(b0(s)){const o=a&&t&&t.type_!==3&&!DE(t.assigned_,n)?a.concat(n):void 0,c=ob(e,s,o);if(Vz(r,n,c),b0(c))e.canAutoFreeze_=!1;else return}else i&&r.add(s);if(ld(s)&&!k2(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;ob(e,s),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(r1(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&lb(e,s)}}function lb(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&J3(t,r)}function yve(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Kz(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,a=Z3;r&&(s=[n],a=yv);const{revoke:i,proxy:o}=Proxy.revocable(s,a);return n.draft_=o,n.revoke_=i,o}var Z3={get(e,t){if(t===el)return e;const r=jh(e);if(!DE(r,t))return vve(e,r,t);const n=r[t];return e.finalized_||!ld(n)?n:n===DC(e.base_,t)?(IC(e),e.copy_[t]=BE(n,e)):n},has(e,t){return t in jh(e)},ownKeys(e){return Reflect.ownKeys(jh(e))},set(e,t,r){const n=qz(jh(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const s=DC(jh(e),t),a=s?.[el];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(gve(r,s)&&(r!==void 0||DE(e.base_,t)))return!0;IC(e),LE(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return DC(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,IC(e),LE(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=jh(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){oc(11)},getPrototypeOf(e){return Pm(e.base_)},setPrototypeOf(){oc(12)}},yv={};ib(Z3,(e,t)=>{yv[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});yv.deleteProperty=function(e,t){return yv.set.call(this,e,t,void 0)};yv.set=function(e,t,r){return Z3.set.call(this,e[0],t,r,e[0])};function DC(e,t){const r=e[el];return(r?jh(r):e)[t]}function vve(e,t,r){const n=qz(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function qz(e,t){if(!(t in e))return;let r=Pm(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Pm(r)}}function LE(e){e.modified_||(e.modified_=!0,e.parent_&&LE(e.parent_))}function IC(e){e.copy_||(e.copy_=IE(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var wve=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const i=this;return function(c=a,...u){return i.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&oc(6),n!==void 0&&typeof n!="function"&&oc(7);let s;if(ld(t)){const a=YD(this),i=BE(t,void 0);let o=!0;try{s=r(i),o=!1}finally{o?RE(a):ME(a)}return qD(a,n),XD(s,a)}else if(!t||typeof t!="object"){if(s=r(t),s===void 0&&(s=t),s===Hz&&(s=void 0),this.autoFreeze_&&J3(s,!0),n){const a=[],i=[];S0("Patches").generateReplacementPatches_(t,s,a,i),n(a,i)}return s}else oc(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...o)=>this.produceWithPatches(i,c=>t(c,...o));let n,s;return[this.produce(t,r,(i,o)=>{n=i,s=o}),n,s]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){ld(e)||oc(8),b0(e)&&(e=td(e));const t=YD(this),r=BE(e,void 0);return r[el].isManual_=!0,ME(t),r}finishDraft(e,t){const r=e&&e[el];(!r||!r.isManual_)&&oc(9);const{scope_:n}=r;return qD(n,t),XD(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const s=t[r];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}r>-1&&(t=t.slice(r+1));const n=S0("Patches").applyPatches_;return b0(e)?n(e,t):this.produce(e,s=>n(s,t))}};function BE(e,t){const r=r1(e)?S0("MapSet").proxyMap_(e,t):S2(e)?S0("MapSet").proxySet_(e,t):yve(e,t);return(t?t.scope_:Kz()).drafts_.push(r),r}function td(e){return b0(e)||oc(10,e),Yz(e)}function Yz(e){if(!ld(e)||k2(e))return e;const t=e[el];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=IE(e,t.scope_.immer_.useStrictShallowCopy_)}else r=IE(e,!0);return ib(r,(n,s)=>{Vz(r,n,Yz(s))}),t&&(t.finalized_=!1),r}var _ve=new wve,Xz=_ve.produce;function Qz(e){return({dispatch:r,getState:n})=>s=>a=>typeof a=="function"?a(r,n,e):s(a)}var bve=Qz(),Sve=Qz,kve=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ab:ab.apply(null,arguments)};function Il(e,t){function r(...n){if(t){let s=t(...n);if(!s)throw new Error(Qo(0));return{type:e,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Wz(n)&&n.type===e,r}var Jz=class my extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,my.prototype)}static get[Symbol.species](){return my}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new my(...t[0].concat(this)):new my(...t.concat(this))}};function JD(e){return ld(e)?Xz(e,()=>{}):e}function Ww(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Cve(e){return typeof e=="boolean"}var Tve=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:s=!0,actionCreatorCheck:a=!0}=t??{};let i=new Jz;return r&&(Cve(r)?i.push(bve):i.push(Sve(r.extraArgument))),i},Eve="RTK_autoBatch",ZD=e=>t=>{setTimeout(t,e)},Nve=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let s=!0,a=!1,i=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:ZD(10):e.type==="callback"?e.queueNotification:ZD(e.timeout),u=()=>{i=!1,a&&(a=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>s&&d(),g=n.subscribe(f);return o.add(d),()=>{g(),o.delete(d)}},dispatch(d){try{return s=!d?.meta?.[Eve],a=!s,a&&(i||(i=!0,c(u))),n.dispatch(d)}finally{s=!0}}})},Ave=e=>function(r){const{autoBatch:n=!0}=r??{};let s=new Jz(e);return n&&s.push(Nve(typeof n=="object"?n:void 0)),s};function jve(e){const t=Tve(),{reducer:r=void 0,middleware:n,devTools:s=!0,preloadedState:a=void 0,enhancers:i=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(Q3(r))o=zz(r);else throw new Error(Qo(1));let c;typeof n=="function"?c=n(t):c=t();let u=ab;s&&(u=kve({trace:!1,...typeof s=="object"&&s}));const d=fve(...c),f=Ave(d);let g=typeof i=="function"?i(f):f();const p=u(...g);return Uz(o,a,p)}function Zz(e){const t={},r=[];let n;const s={addCase(a,i){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Qo(28));if(o in t)throw new Error(Qo(29));return t[o]=i,s},addAsyncThunk(a,i){return i.pending&&(t[a.pending.type]=i.pending),i.rejected&&(t[a.rejected.type]=i.rejected),i.fulfilled&&(t[a.fulfilled.type]=i.fulfilled),i.settled&&r.push({matcher:a.settled,reducer:i.settled}),s},addMatcher(a,i){return r.push({matcher:a,reducer:i}),s},addDefaultCase(a){return n=a,s}};return e(s),[t,r,n]}function Pve(e){return typeof e=="function"}function Fve(e,t){let[r,n,s]=Zz(t),a;if(Pve(e))a=()=>JD(e());else{const o=JD(e);a=()=>o}function i(o=a(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,f)=>{if(f)if(b0(d)){const p=f(d,c);return p===void 0?d:p}else{if(ld(d))return Xz(d,g=>f(g,c));{const g=f(d,c);if(g===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}}return d},o)}return i.getInitialState=a,i}var Ove="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Dve=(e=21)=>{let t="",r=e;for(;r--;)t+=Ove[Math.random()*64|0];return t},Ive=Symbol.for("rtk-slice-createasyncthunk");function Rve(e,t){return`${e}/${t}`}function Mve({creators:e}={}){const t=e?.asyncThunk?.[Ive];return function(n){const{name:s,reducerPath:a=s}=n;if(!s)throw new Error(Qo(11));const i=(typeof n.reducers=="function"?n.reducers(Bve()):n.reducers)||{},o=Object.keys(i),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(_,N){const E=typeof _=="string"?_:_.type;if(!E)throw new Error(Qo(12));if(E in c.sliceCaseReducersByType)throw new Error(Qo(13));return c.sliceCaseReducersByType[E]=N,u},addMatcher(_,N){return c.sliceMatchers.push({matcher:_,reducer:N}),u},exposeAction(_,N){return c.actionCreators[_]=N,u},exposeCaseReducer(_,N){return c.sliceCaseReducersByName[_]=N,u}};o.forEach(_=>{const N=i[_],E={reducerName:_,type:Rve(s,_),createNotation:typeof n.reducers=="function"};Uve(N)?Wve(E,N,u,t):$ve(E,N,u)});function d(){const[_={},N=[],E=void 0]=typeof n.extraReducers=="function"?Zz(n.extraReducers):[n.extraReducers],P={..._,...c.sliceCaseReducersByType};return Fve(n.initialState,F=>{for(let A in P)F.addCase(A,P[A]);for(let A of c.sliceMatchers)F.addMatcher(A.matcher,A.reducer);for(let A of N)F.addMatcher(A.matcher,A.reducer);E&&F.addDefaultCase(E)})}const f=_=>_,g=new Map,p=new WeakMap;let x;function v(_,N){return x||(x=d()),x(_,N)}function w(){return x||(x=d()),x.getInitialState()}function C(_,N=!1){function E(F){let A=F[_];return typeof A>"u"&&N&&(A=Ww(p,E,w)),A}function P(F=f){const A=Ww(g,N,()=>new WeakMap);return Ww(A,F,()=>{const j={};for(const[I,B]of Object.entries(n.selectors??{}))j[I]=Lve(B,F,()=>Ww(p,F,w),N);return j})}return{reducerPath:_,getSelectors:P,get selectors(){return P(E)},selectSlice:E}}const k={name:s,reducer:v,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:w,...C(a),injectInto(_,{reducerPath:N,...E}={}){const P=N??a;return _.inject({reducerPath:P,reducer:v},E),{...k,...C(P,!0)}}};return k}}function Lve(e,t,r,n){function s(a,...i){let o=t(a);return typeof o>"u"&&n&&(o=r()),e(o,...i)}return s.unwrapped=e,s}var rl=Mve();function Bve(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function $ve({type:e,reducerName:t,createNotation:r},n,s){let a,i;if("reducer"in n){if(r&&!zve(n))throw new Error(Qo(17));a=n.reducer,i=n.prepare}else a=n;s.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,i?Il(e,i):Il(e))}function Uve(e){return e._reducerDefinitionType==="asyncThunk"}function zve(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Wve({type:e,reducerName:t},r,n,s){if(!s)throw new Error(Qo(18));const{payloadCreator:a,fulfilled:i,pending:o,rejected:c,settled:u,options:d}=r,f=s(e,a,d);n.exposeAction(t,f),i&&n.addCase(f.fulfilled,i),o&&n.addCase(f.pending,o),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:i||Hw,pending:o||Hw,rejected:c||Hw,settled:u||Hw})}function Hw(){}var Hve="task",eW="listener",tW="completed",eA="cancelled",Gve=`task-${eA}`,Vve=`task-${tW}`,$E=`${eW}-${eA}`,Kve=`${eW}-${tW}`,C2=class{constructor(e){this.code=e,this.message=`${Hve} ${eA} (reason: ${e})`}name="TaskAbortError";message},tA=(e,t)=>{if(typeof e!="function")throw new TypeError(Qo(32))},cb=()=>{},rW=(e,t=cb)=>(e.catch(t),e),nW=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Jh=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Zh=e=>{if(e.aborted){const{reason:t}=e;throw new C2(t)}};function sW(e,t){let r=cb;return new Promise((n,s)=>{const a=()=>s(new C2(e.reason));if(e.aborted){a();return}r=nW(e,a),t.finally(()=>r()).then(n,s)}).finally(()=>{r=cb})}var qve=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof C2?"cancelled":"rejected",error:r}}finally{t?.()}},ub=e=>t=>rW(sW(e,t).then(r=>(Zh(e),r))),aW=e=>{const t=ub(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:pm}=Object,eI={},T2="listenerMiddleware",Yve=(e,t)=>{const r=n=>nW(e,()=>Jh(n,e.reason));return(n,s)=>{tA(n);const a=new AbortController;r(a);const i=qve(async()=>{Zh(e),Zh(a.signal);const o=await n({pause:ub(a.signal),delay:aW(a.signal),signal:a.signal});return Zh(a.signal),o},()=>Jh(a,Vve));return s?.autoJoin&&t.push(i.catch(cb)),{result:ub(e)(i),cancel(){Jh(a,Gve)}}}},Xve=(e,t)=>{const r=async(n,s)=>{Zh(t);let a=()=>{};const o=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,g)=>{g.unsubscribe(),c([f,g.getState(),g.getOriginalState()])}});a=()=>{d(),u()}})];s!=null&&o.push(new Promise(c=>setTimeout(c,s,null)));try{const c=await sW(t,Promise.race(o));return Zh(t),c}finally{a()}};return(n,s)=>rW(r(n,s))},iW=e=>{let{type:t,actionCreator:r,matcher:n,predicate:s,effect:a}=e;if(t)s=Il(t).match;else if(r)t=r.type,s=r.match;else if(n)s=n;else if(!s)throw new Error(Qo(21));return tA(a),{predicate:s,type:t,effect:a}},oW=pm(e=>{const{type:t,predicate:r,effect:n}=iW(e);return{id:Dve(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Qo(22))}}},{withTypes:()=>oW}),tI=(e,t)=>{const{type:r,effect:n,predicate:s}=iW(t);return Array.from(e.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===s)&&a.effect===n)},UE=e=>{e.pending.forEach(t=>{Jh(t,$E)})},Qve=e=>()=>{e.forEach(UE),e.clear()},rI=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},lW=pm(Il(`${T2}/add`),{withTypes:()=>lW}),Jve=Il(`${T2}/removeAll`),cW=pm(Il(`${T2}/remove`),{withTypes:()=>cW}),Zve=(...e)=>{console.error(`${T2}/error`,...e)},n1=(e={})=>{const t=new Map,{extra:r,onError:n=Zve}=e;tA(n);const s=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),f=>{d.unsubscribe(),f?.cancelActive&&UE(d)}),a=d=>{const f=tI(t,d)??oW(d);return s(f)};pm(a,{withTypes:()=>a});const i=d=>{const f=tI(t,d);return f&&(f.unsubscribe(),d.cancelActive&&UE(f)),!!f};pm(i,{withTypes:()=>i});const o=async(d,f,g,p)=>{const x=new AbortController,v=Xve(a,x.signal),w=[];try{d.pending.add(x),await Promise.resolve(d.effect(f,pm({},g,{getOriginalState:p,condition:(C,k)=>v(C,k).then(Boolean),take:v,delay:aW(x.signal),pause:ub(x.signal),extra:r,signal:x.signal,fork:Yve(x.signal,w),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((C,k,_)=>{C!==x&&(Jh(C,$E),_.delete(C))})},cancel:()=>{Jh(x,$E),d.pending.delete(x)},throwIfCancelled:()=>{Zh(x.signal)}})))}catch(C){C instanceof C2||rI(n,C,{raisedBy:"effect"})}finally{await Promise.all(w),Jh(x,Kve),d.pending.delete(x)}},c=Qve(t);return{middleware:d=>f=>g=>{if(!Wz(g))return f(g);if(lW.match(g))return a(g.payload);if(Jve.match(g)){c();return}if(cW.match(g))return i(g.payload);let p=d.getState();const x=()=>{if(p===eI)throw new Error(Qo(23));return p};let v;try{if(v=f(g),t.size>0){const w=d.getState(),C=Array.from(t.values());for(const k of C){let _=!1;try{_=k.predicate(g,w,p)}catch(N){_=!1,rI(n,N,{raisedBy:"predicate"})}_&&o(k,g,d,x)}}}finally{p=eI}return v},startListening:a,stopListening:i,clearListeners:c}};function Qo(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var e1e={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},uW=rl({name:"chartLayout",initialState:e1e,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,s,a;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(s=t.payload.bottom)!==null&&s!==void 0?s:0,e.margin.left=(a=t.payload.left)!==null&&a!==void 0?a:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:t1e,setLayout:r1e,setChartSize:n1e,setScale:s1e}=uW.actions,a1e=uW.reducer;function nI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function sI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nI(Object(r),!0).forEach(function(n){i1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i1e(e,t,r){return(t=o1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o1e(e){var t=l1e(e,"string");return typeof t=="symbol"?t:t+""}function l1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var db=Math.PI/180,c1e=e=>e*180/Math.PI,xi=(e,t,r,n)=>({x:e+Math.cos(-db*n)*r,y:t+Math.sin(-db*n)*r}),u1e=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},d1e=(e,t)=>{var{x:r,y:n}=e,{x:s,y:a}=t;return Math.sqrt((r-s)**2+(n-a)**2)},f1e=(e,t)=>{var{x:r,y:n}=e,{cx:s,cy:a}=t,i=d1e({x:r,y:n},{x:s,y:a});if(i<=0)return{radius:i,angle:0};var o=(r-s)/i,c=Math.acos(o);return n>a&&(c=2*Math.PI-c),{radius:i,angle:c1e(c),angleInRadian:c}},h1e=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),s=Math.floor(r/360),a=Math.min(n,s);return{startAngle:t-a*360,endAngle:r-a*360}},g1e=(e,t)=>{var{startAngle:r,endAngle:n}=t,s=Math.floor(r/360),a=Math.floor(n/360),i=Math.min(s,a);return e+i*360},m1e=(e,t)=>{var{x:r,y:n}=e,{radius:s,angle:a}=f1e({x:r,y:n},t),{innerRadius:i,outerRadius:o}=t;if(s<i||s>o||s===0)return null;var{startAngle:c,endAngle:u}=h1e(t),d=a,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?sI(sI({},t),{},{radius:s,angle:g1e(d,t)}):null};function dW(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function aI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function kl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aI(Object(r),!0).forEach(function(n){p1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p1e(e,t,r){return(t=x1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x1e(e){var t=y1e(e,"string");return typeof t=="symbol"?t:t+""}function y1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lo(e,t,r){return Ka(e)||Ka(t)?r:au(t)?y2(e,t,r):typeof t=="function"?t(e):r}var v1e=(e,t,r,n,s)=>{var a,i=-1,o=(a=t?.length)!==null&&a!==void 0?a:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&s!=null&&Math.abs(Math.abs(s[1]-s[0])-360)<=1e-6)for(var c=0;c<o;c++){var u=c>0?r[c-1].coordinate:r[o-1].coordinate,d=r[c].coordinate,f=c>=o-1?r[0].coordinate:r[c+1].coordinate,g=void 0;if(El(d-u)!==El(f-d)){var p=[];if(El(f-d)===El(s[1]-s[0])){g=f;var x=d+s[1]-s[0];p[0]=Math.min(x,(x+u)/2),p[1]=Math.max(x,(x+u)/2)}else{g=u;var v=f+s[1]-s[0];p[0]=Math.min(d,(v+d)/2),p[1]=Math.max(d,(v+d)/2)}var w=[Math.min(d,(g+d)/2),Math.max(d,(g+d)/2)];if(e>w[0]&&e<=w[1]||e>=p[0]&&e<=p[1]){({index:i}=r[c]);break}}else{var C=Math.min(u,f),k=Math.max(u,f);if(e>(C+d)/2&&e<=(k+d)/2){({index:i}=r[c]);break}}}else if(t){for(var _=0;_<o;_++)if(_===0&&e<=(t[_].coordinate+t[_+1].coordinate)/2||_>0&&_<o-1&&e>(t[_].coordinate+t[_-1].coordinate)/2&&e<=(t[_].coordinate+t[_+1].coordinate)/2||_===o-1&&e>(t[_].coordinate+t[_-1].coordinate)/2){({index:i}=t[_]);break}}return i},w1e=(e,t,r)=>{if(t&&r){var{width:n,height:s}=r,{align:a,verticalAlign:i,layout:o}=t;if((o==="vertical"||o==="horizontal"&&i==="middle")&&a!=="center"&&$r(e[a]))return kl(kl({},e),{},{[a]:e[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&i!=="middle"&&$r(e[i]))return kl(kl({},e),{},{[i]:e[i]+(s||0)})}return e},Gf=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",fW=(e,t,r,n)=>{if(n)return e.map(o=>o.coordinate);var s,a,i=e.map(o=>(o.coordinate===t&&(s=!0),o.coordinate===r&&(a=!0),o.coordinate));return s||i.push(t),a||i.push(r),i},hW=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:s,range:a,scale:i,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:g,axisType:p}=e;if(!i)return null;var x=o==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,v=s==="category"&&i.bandwidth?i.bandwidth()/x:0;if(v=p==="angleAxis"&&a&&a.length>=2?El(a[0]-a[1])*2*v:v,f||g){var w=(f||g||[]).map((C,k)=>{var _=n?n.indexOf(C):C;return{coordinate:i(_)+v,value:C,offset:v,index:k}});return w.filter(C=>!Dl(C.coordinate))}return c&&u?u.map((C,k)=>({coordinate:i(C)+v,value:C,index:k,offset:v})):i.ticks&&d!=null?i.ticks(d).map((C,k)=>({coordinate:i(C)+v,value:C,offset:v,index:k})):i.domain().map((C,k)=>({coordinate:i(C)+v,value:n?n[C]:C,index:k,offset:v}))},iI=1e-4,_1e=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),s=Math.min(n[0],n[1])-iI,a=Math.max(n[0],n[1])+iI,i=e(t[0]),o=e(t[r-1]);(i<s||i>a||o<s||o>a)&&e.domain([t[0],t[r-1]])}},b1e=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var s=0,a=0,i=0;i<t;++i){var o=Dl(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=s,e[i][r][1]=s+o,s=e[i][r][1]):(e[i][r][0]=a,e[i][r][1]=a+o,a=e[i][r][1])}},S1e=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var s=0,a=0;a<t;++a){var i=Dl(e[a][r][1])?e[a][r][0]:e[a][r][1];i>=0?(e[a][r][0]=s,e[a][r][1]=s+i,s=e[a][r][1]):(e[a][r][0]=0,e[a][r][1]=0)}},k1e={sign:b1e,expand:fye,none:jm,silhouette:hye,wiggle:gye,positive:S1e},C1e=(e,t,r)=>{var n=k1e[r],s=dye().keys(t).value((a,i)=>+lo(a,i,0)).order(OE).offset(n);return s(e)};function oI(e){var{axis:t,ticks:r,bandSize:n,entry:s,index:a,dataKey:i}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Ka(s[t.dataKey])){var o=dz(r,"value",s[t.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var c=lo(s,Ka(i)?t.dataKey:i);return Ka(c)?null:t.scale(c)}var T1e=e=>{var t=e.flat(2).filter($r);return[Math.min(...t),Math.max(...t)]},E1e=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],N1e=(e,t,r)=>{if(e!=null)return E1e(Object.keys(e).reduce((n,s)=>{var a=e[s],{stackedData:i}=a,o=i.reduce((c,u)=>{var d=dW(u,t,r),f=T1e(d);return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},lI=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,cI=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,zE=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var s=_2(t,d=>d.coordinate),a=1/0,i=1,o=s.length;i<o;i++){var c=s[i],u=s[i-1];a=Math.min((c.coordinate||0)-(u.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function uI(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:s,name:a}=e;return kl(kl({},t),{},{dataKey:r,payload:n,value:s,name:a})}function gW(e,t){if(e)return String(e);if(typeof t=="string")return t}function A1e(e,t,r,n,s){if(r==="horizontal"||r==="vertical"){var a=e>=s.left&&e<=s.left+s.width&&t>=s.top&&t<=s.top+s.height;return a?{x:e,y:t}:null}return n?m1e({x:e,y:t},n):null}var j1e=(e,t,r,n)=>{var s=t.find(u=>u&&u.index===r);if(s){if(e==="horizontal")return{x:s.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:s.coordinate};if(e==="centric"){var a=s.coordinate,{radius:i}=n;return kl(kl(kl({},n),xi(n.cx,n.cy,i,a)),{},{angle:a,radius:i})}var o=s.coordinate,{angle:c}=n;return kl(kl(kl({},n),xi(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},P1e=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,xd=e=>e.layout.width,yd=e=>e.layout.height,F1e=e=>e.layout.scale,mW=e=>e.layout.margin,E2=kt(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),N2=kt(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),O1e="data-recharts-item-index",D1e="data-recharts-item-data-key",s1=60;function dI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Gw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dI(Object(r),!0).forEach(function(n){I1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I1e(e,t,r){return(t=R1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R1e(e){var t=M1e(e,"string");return typeof t=="symbol"?t:t+""}function M1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var L1e=e=>e.brush.height;function B1e(e){var t=N2(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:s1;return r+s}return r},0)}function $1e(e){var t=N2(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:s1;return r+s}return r},0)}function U1e(e){var t=E2(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function z1e(e){var t=E2(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var _i=kt([xd,yd,mW,L1e,B1e,$1e,U1e,z1e,$z,ive],(e,t,r,n,s,a,i,o,c,u)=>{var d={left:(r.left||0)+s,right:(r.right||0)+a},f={top:(r.top||0)+i,bottom:(r.bottom||0)+o},g=Gw(Gw({},f),d),p=g.bottom;g.bottom+=n,g=w1e(g,c,u);var x=e-g.left-g.right,v=t-g.top-g.bottom;return Gw(Gw({brushBottom:p},g),{},{width:Math.max(x,0),height:Math.max(v,0)})}),W1e=kt(_i,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),pW=kt(xd,yd,(e,t)=>({x:0,y:0,width:e,height:t})),H1e=S.createContext(null),Bl=()=>S.useContext(H1e)!=null,A2=e=>e.brush,j2=kt([A2,_i,mW],(e,t,r)=>({height:e.height,x:$r(e.x)?e.x:t.left,y:$r(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:$r(e.width)?e.width:t.width})),rA=()=>{var e,t=Bl(),r=Pr(W1e),n=Pr(j2),s=(e=Pr(A2))===null||e===void 0?void 0:e.padding;return!t||!n||!s?r:{width:n.width-s.left-s.right,height:n.height-s.top-s.bottom,x:s.left,y:s.top}},G1e={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},xW=()=>{var e;return(e=Pr(_i))!==null&&e!==void 0?e:G1e},yW=()=>Pr(xd),vW=()=>Pr(yd),fs=e=>e.layout.layoutType,nA=()=>Pr(fs),V1e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},wW=rl({name:"legend",initialState:V1e,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=td(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:Q3e,setLegendSettings:J3e,addLegendPayload:K1e,removeLegendPayload:q1e}=wW.actions,Y1e=wW.reducer;function WE(){return WE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WE.apply(null,arguments)}function fI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function RC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fI(Object(r),!0).forEach(function(n){X1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X1e(e,t,r){return(t=Q1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q1e(e){var t=J1e(e,"string");return typeof t=="symbol"?t:t+""}function J1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z1e(e){return Array.isArray(e)&&au(e[0])&&au(e[1])?e.join(" ~ "):e}var ewe=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:s={},payload:a,formatter:i,itemSorter:o,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:g=!1}=e,p=()=>{if(a&&a.length){var E={padding:0,margin:0},P=(o?_2(a,o):a).map((F,A)=>{if(F.type==="none")return null;var j=F.formatter||i||Z1e,{value:I,name:B}=F,Y=I,Z=B;if(j){var se=j(I,B,F,A,a);if(Array.isArray(se))[Y,Z]=se;else if(se!=null)Y=se;else return null}var ee=RC({display:"block",paddingTop:4,paddingBottom:4,color:F.color||"#000"},n);return S.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:ee},au(Z)?S.createElement("span",{className:"recharts-tooltip-item-name"},Z):null,au(Z)?S.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,S.createElement("span",{className:"recharts-tooltip-item-value"},Y),S.createElement("span",{className:"recharts-tooltip-item-unit"},F.unit||""))});return S.createElement("ul",{className:"recharts-tooltip-item-list",style:E},P)}return null},x=RC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=RC({margin:0},s),w=!Ka(d),C=w?d:"",k=us("recharts-default-tooltip",c),_=us("recharts-tooltip-label",u);w&&f&&a!==void 0&&a!==null&&(C=f(d,a));var N=g?{role:"status","aria-live":"assertive"}:{};return S.createElement("div",WE({className:k,style:x},N),S.createElement("p",{className:_,style:v},S.isValidElement(C)?C:"".concat(C)),p())},ty="recharts-tooltip-wrapper",twe={visibility:"hidden"};function rwe(e){var{coordinate:t,translateX:r,translateY:n}=e;return us(ty,{["".concat(ty,"-right")]:$r(r)&&t&&$r(t.x)&&r>=t.x,["".concat(ty,"-left")]:$r(r)&&t&&$r(t.x)&&r<t.x,["".concat(ty,"-bottom")]:$r(n)&&t&&$r(t.y)&&n>=t.y,["".concat(ty,"-top")]:$r(n)&&t&&$r(t.y)&&n<t.y})}function hI(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(a&&$r(a[n]))return a[n];var d=r[n]-o-(s>0?s:0),f=r[n]+s;if(t[n])return i[n]?d:f;var g=c[n];if(g==null)return 0;if(i[n]){var p=d,x=g;return p<x?Math.max(f,g):Math.max(d,g)}if(u==null)return 0;var v=f+o,w=g+u;return v>w?Math.max(d,g):Math.max(f,g)}function nwe(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function swe(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:s,reverseDirection:a,tooltipBox:i,useTranslate3d:o,viewBox:c}=e,u,d,f;return i.height>0&&i.width>0&&r?(d=hI({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:s,reverseDirection:a,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),f=hI({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:s,reverseDirection:a,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),u=nwe({translateX:d,translateY:f,useTranslate3d:o})):u=twe,{cssProperties:u,cssClasses:rwe({translateX:d,translateY:f,coordinate:r})}}function gI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Vw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gI(Object(r),!0).forEach(function(n){HE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HE(e,t,r){return(t=awe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function awe(e){var t=iwe(e,"string");return typeof t=="symbol"?t:t+""}function iwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class owe extends S.PureComponent{constructor(){super(...arguments),HE(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),HE(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,s,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(s=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&s!==void 0?s:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:s,children:a,coordinate:i,hasPayload:o,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:g,viewBox:p,wrapperStyle:x,lastBoundingBox:v,innerRef:w,hasPortalFromProps:C}=this.props,{cssClasses:k,cssProperties:_}=swe({allowEscapeViewBox:r,coordinate:i,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:v.height,width:v.width},useTranslate3d:g,viewBox:p}),N=C?{}:Vw(Vw({transition:c&&t?"transform ".concat(n,"ms ").concat(s):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),E=Vw(Vw({},N),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},x);return S.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:k,style:E,ref:w},a)}}var lwe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),ap={devToolsEnabled:!1,isSsr:lwe()},_W=()=>Pr(e=>e.rootProps.accessibilityLayer);function yc(e){return Number.isFinite(e)}function fb(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function GE(){return GE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GE.apply(null,arguments)}function mI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function pI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mI(Object(r),!0).forEach(function(n){cwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cwe(e,t,r){return(t=uwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uwe(e){var t=dwe(e,"string");return typeof t=="symbol"?t:t+""}function dwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xI={curveBasisClosed:eye,curveBasisOpen:tye,curveBasis:Zxe,curveBumpX:Qxe,curveBumpY:Jxe,curveLinearClosed:rye,curveLinear:v2,curveMonotoneX:nye,curveMonotoneY:sye,curveNatural:aye,curveStep:iye,curveStepAfter:lye,curveStepBefore:oye},Kw=e=>yc(e.x)&&yc(e.y),ry=e=>e.x,ny=e=>e.y,fwe=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(H3(e));return(r==="curveMonotone"||r==="curveBump")&&t?xI["".concat(r).concat(t==="vertical"?"Y":"X")]:xI[r]||v2},hwe=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:s,connectNulls:a=!1}=e,i=fwe(t,s),o=a?r.filter(Kw):r,c;if(Array.isArray(n)){var u=a?n.filter(f=>Kw(f)):n,d=o.map((f,g)=>pI(pI({},f),{},{base:u[g]}));return s==="vertical"?c=Bw().y(ny).x1(ry).x0(f=>f.base.x):c=Bw().x(ry).y1(ny).y0(f=>f.base.y),c.defined(Kw).curve(i),c(d)}return s==="vertical"&&$r(n)?c=Bw().y(ny).x1(ry).x0(n):$r(n)?c=Bw().x(ry).y1(ny).y0(n):c=wz().x(ry).y(ny),c.defined(Kw).curve(i),c(o)},bW=e=>{var{className:t,points:r,path:n,pathRef:s}=e;if((!r||!r.length)&&!n)return null;var a=r&&r.length?hwe(e):n;return S.createElement("path",GE({},L0(e),V3(e),{className:us("recharts-curve",t),d:a===null?void 0:a,ref:s}))},gwe=["x","y","top","left","width","height","className"];function VE(){return VE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VE.apply(null,arguments)}function yI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function mwe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yI(Object(r),!0).forEach(function(n){pwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pwe(e,t,r){return(t=xwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xwe(e){var t=ywe(e,"string");return typeof t=="symbol"?t:t+""}function ywe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vwe(e,t){if(e==null)return{};var r,n,s=wwe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function wwe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _we=(e,t,r,n,s,a)=>"M".concat(e,",").concat(s,"v").concat(n,"M").concat(a,",").concat(t,"h").concat(r),bwe=e=>{var{x:t=0,y:r=0,top:n=0,left:s=0,width:a=0,height:i=0,className:o}=e,c=vwe(e,gwe),u=mwe({x:t,y:r,top:n,left:s,width:a,height:i},c);return!$r(t)||!$r(r)||!$r(a)||!$r(i)||!$r(n)||!$r(s)?null:S.createElement("path",VE({},wi(u,!0),{className:us("recharts-cross",o),d:_we(t,r,a,i,n,s)}))};function Swe(e,t,r,n){var s=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-s,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function vI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function kwe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vI(Object(r),!0).forEach(function(n){Cwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cwe(e,t,r){return(t=Twe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Twe(e){var t=Ewe(e,"string");return typeof t=="symbol"?t:t+""}function Ewe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $l(e,t){var r=kwe({},e),n=t,s=Object.keys(t),a=s.reduce((i,o)=>(i[o]===void 0&&n[o]!==void 0&&(i[o]=n[o]),i),r);return a}function Nwe(){}function wI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function _I(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wI(Object(r),!0).forEach(function(n){Awe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Awe(e,t,r){return(t=jwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jwe(e){var t=Pwe(e,"string");return typeof t=="symbol"?t:t+""}function Pwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fwe=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),Owe=(e,t,r)=>e.map(n=>"".concat(Fwe(n)," ").concat(t,"ms ").concat(r)).join(","),Dwe=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(s=>n.includes(s))),vv=(e,t)=>Object.keys(t).reduce((r,n)=>_I(_I({},r),{},{[n]:e(n,t[n])}),{});function bI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function di(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bI(Object(r),!0).forEach(function(n){Iwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Iwe(e,t,r){return(t=Rwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rwe(e){var t=Mwe(e,"string");return typeof t=="symbol"?t:t+""}function Mwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hb=(e,t,r)=>e+(t-e)*r,KE=e=>{var{from:t,to:r}=e;return t!==r},SW=(e,t,r)=>{var n=vv((s,a)=>{if(KE(a)){var[i,o]=e(a.from,a.to,a.velocity);return di(di({},a),{},{from:i,velocity:o})}return a},t);return r<1?vv((s,a)=>KE(a)?di(di({},a),{},{velocity:hb(a.velocity,n[s].velocity,r),from:hb(a.from,n[s].from,r)}):a,t):SW(e,n,r-1)};function Lwe(e,t,r,n,s,a){var i,o=n.reduce((g,p)=>di(di({},g),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),c=()=>vv((g,p)=>p.from,o),u=()=>!Object.values(o).filter(KE).length,d=null,f=g=>{i||(i=g);var p=g-i,x=p/r.dt;o=SW(r,o,x),s(di(di(di({},e),t),c())),i=g,u()||(d=a.setTimeout(f))};return()=>(d=a.setTimeout(f),()=>{d()})}function Bwe(e,t,r,n,s,a,i){var o=null,c=s.reduce((f,g)=>di(di({},f),{},{[g]:[e[g],t[g]]}),{}),u,d=f=>{u||(u=f);var g=(f-u)/n,p=vv((v,w)=>hb(...w,r(g)),c);if(a(di(di(di({},e),t),p)),g<1)o=i.setTimeout(d);else{var x=vv((v,w)=>hb(...w,r(1)),c);a(di(di(di({},e),t),x))}};return()=>(o=i.setTimeout(d),()=>{o()})}const $we=(e,t,r,n,s,a)=>{var i=Dwe(e,t);return r.isStepper===!0?Lwe(e,t,r,i,s,a):Bwe(e,t,r,n,i,s,a)};var gb=1e-4,kW=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],CW=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),SI=(e,t)=>r=>{var n=kW(e,t);return CW(n,r)},Uwe=(e,t)=>r=>{var n=kW(e,t),s=[...n.map((a,i)=>a*i).slice(1),0];return CW(s,r)},kI=function(){for(var t,r,n,s,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];if(i.length===1)switch(i[0]){case"linear":[t,n,r,s]=[0,0,1,1];break;case"ease":[t,n,r,s]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,s]=[.42,0,1,1];break;case"ease-out":[t,n,r,s]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,s]=[0,0,.58,1];break;default:{var c=i[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,s]=c[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else i.length===4&&([t,n,r,s]=i);var u=SI(t,r),d=SI(n,s),f=Uwe(t,r),g=x=>x>1?1:x<0?0:x,p=x=>{for(var v=x>1?1:x,w=v,C=0;C<8;++C){var k=u(w)-v,_=f(w);if(Math.abs(k-v)<gb||_<gb)return d(w);w=g(w-k/_)}return d(w)};return p.isStepper=!1,p},zwe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:s=17}=t,a=(i,o,c)=>{var u=-(i-o)*r,d=c*n,f=c+(u-d)*s/1e3,g=c*s/1e3+i;return Math.abs(g-o)<gb&&Math.abs(f)<gb?[o,0]:[g,f]};return a.isStepper=!0,a.dt=s,a},Wwe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return kI(e);case"spring":return zwe();default:if(e.split("(")[0]==="cubic-bezier")return kI(e)}return typeof e=="function"?e:null};function Hwe(e){var t,r=()=>null,n=!1,s=null,a=i=>{if(!n){if(Array.isArray(i)){if(!i.length)return;var o=i,[c,...u]=o;if(typeof c=="number"){s=e.setTimeout(a.bind(null,u),c);return}a(c),s=e.setTimeout(a.bind(null,u));return}typeof i=="string"&&(t=i,r(t)),typeof i=="object"&&(t=i,r(t)),typeof i=="function"&&i()}};return{stop:()=>{n=!0},start:i=>{n=!1,s&&(s(),s=null),a(i)},subscribe:i=>(r=i,()=>{r=()=>null}),getTimeoutController:()=>e}}class Gwe{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),s=null,a=i=>{i-n>=r?t(i):typeof requestAnimationFrame=="function"&&(s=requestAnimationFrame(a))};return s=requestAnimationFrame(a),()=>{cancelAnimationFrame(s)}}}function Vwe(){return Hwe(new Gwe)}var Kwe=S.createContext(Vwe);function qwe(e,t){var r=S.useContext(Kwe);return S.useMemo(()=>t??r(e),[e,t,r])}var Ywe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},CI={t:0},MC={t:1};function TW(e){var t=$l(e,Ywe),{isActive:r,canBegin:n,duration:s,easing:a,begin:i,onAnimationEnd:o,onAnimationStart:c,children:u}=t,d=qwe(t.animationId,t.animationManager),[f,g]=S.useState(r?CI:MC),p=S.useRef(null);return S.useEffect(()=>{r||g(MC)},[r]),S.useEffect(()=>{if(!r||!n)return Nwe;var x=$we(CI,MC,Wwe(a),s,g,d.getTimeoutController()),v=()=>{p.current=x()};return d.start([c,i,v,s,o]),()=>{d.stop(),p.current&&p.current(),o()}},[r,n,s,a,i,c,o,d]),u(f.t)}function EW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=S.useRef(pv(t)),n=S.useRef(e);return n.current!==e&&(r.current=pv(t),n.current=e),r.current}function TI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function EI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TI(Object(r),!0).forEach(function(n){Xwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xwe(e,t,r){return(t=Qwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qwe(e){var t=Jwe(e,"string");return typeof t=="symbol"?t:t+""}function Jwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mb(){return mb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mb.apply(null,arguments)}var NI=(e,t,r,n,s)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),i=n>=0?1:-1,o=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,u;if(a>0&&s instanceof Array){for(var d=[0,0,0,0],f=0,g=4;f<g;f++)d[f]=s[f]>a?a:s[f];u="M".concat(e,",").concat(t+i*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+o*d[0],",").concat(t)),u+="L ".concat(e+r-o*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+i*d[1])),u+="L ".concat(e+r,",").concat(t+n-i*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-o*d[2],",").concat(t+n)),u+="L ".concat(e+o*d[3],",").concat(t+n),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-i*d[3])),u+="Z"}else if(a>0&&s===+s&&s>0){var p=Math.min(a,s);u="M ".concat(e,",").concat(t+i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+o*p,",").concat(t,`
            L `).concat(e+r-o*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r,",").concat(t+i*p,`
            L `).concat(e+r,",").concat(t+n-i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r-o*p,",").concat(t+n,`
            L `).concat(e+o*p,",").concat(t+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(t+n-i*p," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return u},Zwe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},e_e=e=>{var t=$l(e,Zwe),r=S.useRef(null),[n,s]=S.useState(-1);S.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var se=r.current.getTotalLength();se&&s(se)}catch{}},[]);var{x:a,y:i,width:o,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:g,animationBegin:p,isAnimationActive:x,isUpdateAnimationActive:v}=t,w=S.useRef(o),C=S.useRef(c),k=S.useRef(a),_=S.useRef(i),N=S.useMemo(()=>({x:a,y:i,width:o,height:c,radius:u}),[a,i,o,c,u]),E=EW(N,"rectangle-");if(a!==+a||i!==+i||o!==+o||c!==+c||o===0||c===0)return null;var P=us("recharts-rectangle",d);if(!v)return S.createElement("path",mb({},wi(t,!0),{className:P,d:NI(a,i,o,c,u)}));var F=w.current,A=C.current,j=k.current,I=_.current,B="0px ".concat(n===-1?1:n,"px"),Y="".concat(n,"px 0px"),Z=Owe(["strokeDasharray"],g,typeof f=="string"?f:void 0);return S.createElement(TW,{animationId:E,key:E,canBegin:n>0,duration:g,easing:f,isActive:v,begin:p},se=>{var ee=Hu(F,o,se),te=Hu(A,c,se),L=Hu(j,a,se),V=Hu(I,i,se);r.current&&(w.current=ee,C.current=te,k.current=L,_.current=V);var M;return x?se>0?M={transition:Z,strokeDasharray:Y}:M={strokeDasharray:B}:M={strokeDasharray:Y},S.createElement("path",mb({},wi(t,!0),{className:P,d:NI(L,V,ee,te,u),ref:r,style:EI(EI({},M),t.style)}))})};function NW(e){var{cx:t,cy:r,radius:n,startAngle:s,endAngle:a}=e,i=xi(t,r,n,s),o=xi(t,r,n,a);return{points:[i,o],cx:t,cy:r,radius:n,startAngle:s,endAngle:a}}function qE(){return qE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qE.apply(null,arguments)}var t_e=(e,t)=>{var r=El(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},qw=e=>{var{cx:t,cy:r,radius:n,angle:s,sign:a,isExternal:i,cornerRadius:o,cornerIsExternal:c}=e,u=o*(i?1:-1)+n,d=Math.asin(o/u)/db,f=c?s:s+a*d,g=xi(t,r,u,f),p=xi(t,r,n,f),x=c?s-a*d:s,v=xi(t,r,u*Math.cos(d*db),x);return{center:g,circleTangency:p,lineTangency:v,theta:d}},AW=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:s,startAngle:a,endAngle:i}=e,o=t_e(a,i),c=a+o,u=xi(t,r,s,a),d=xi(t,r,s,c),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var g=xi(t,r,n,a),p=xi(t,r,n,c);f+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=c),`,
            `).concat(g.x,",").concat(g.y," Z")}else f+="L ".concat(t,",").concat(r," Z");return f},r_e=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:s,cornerRadius:a,forceCornerRadius:i,cornerIsExternal:o,startAngle:c,endAngle:u}=e,d=El(u-c),{circleTangency:f,lineTangency:g,theta:p}=qw({cx:t,cy:r,radius:s,angle:c,sign:d,cornerRadius:a,cornerIsExternal:o}),{circleTangency:x,lineTangency:v,theta:w}=qw({cx:t,cy:r,radius:s,angle:u,sign:-d,cornerRadius:a,cornerIsExternal:o}),C=o?Math.abs(c-u):Math.abs(c-u)-p-w;if(C<0)return i?"M ".concat(g.x,",").concat(g.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):AW({cx:t,cy:r,innerRadius:n,outerRadius:s,startAngle:c,endAngle:u});var k="M ".concat(g.x,",").concat(g.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(C>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(v.x,",").concat(v.y,`
  `);if(n>0){var{circleTangency:_,lineTangency:N,theta:E}=qw({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:P,lineTangency:F,theta:A}=qw({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),j=o?Math.abs(c-u):Math.abs(c-u)-E-A;if(j<0&&a===0)return"".concat(k,"L").concat(t,",").concat(r,"Z");k+="L".concat(F.x,",").concat(F.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(P.x,",").concat(P.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(j>180),",").concat(+(d>0),",").concat(_.x,",").concat(_.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"Z")}else k+="L".concat(t,",").concat(r,"Z");return k},n_e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},s_e=e=>{var t=$l(e,n_e),{cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(a<s||u===d)return null;var g=us("recharts-sector",f),p=a-s,x=Df(i,p,0,!0),v;return x>0&&Math.abs(u-d)<360?v=r_e({cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:Math.min(x,p/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d}):v=AW({cx:r,cy:n,innerRadius:s,outerRadius:a,startAngle:u,endAngle:d}),S.createElement("path",qE({},wi(t,!0),{className:g,d:v}))};function a_e(e,t,r){var n,s,a,i;if(e==="horizontal")n=t.x,a=n,s=r.top,i=r.top+r.height;else if(e==="vertical")s=t.y,i=s,n=r.left,a=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:c,innerRadius:u,outerRadius:d,angle:f}=t,g=xi(o,c,u,f),p=xi(o,c,d,f);n=g.x,s=g.y,a=p.x,i=p.y}else return NW(t);return[{x:n,y:s},{x:a,y:i}]}var LC={},BC={},$C={},AI;function i_e(){return AI||(AI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Lz();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})($C)),$C}var jI;function o_e(){return jI||(jI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=i_e();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(BC)),BC}var PI;function l_e(){return PI||(PI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Bz(),r=o_e();function n(s,a,i){i&&typeof i!="number"&&t.isIterateeCall(s,a,i)&&(a=i=void 0),s=r.toFinite(s),a===void 0?(a=s,s=0):a=r.toFinite(a),i=i===void 0?s<a?1:-1:r.toFinite(i);const o=Math.max(Math.ceil((a-s)/(i||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=s,s+=i;return c}e.range=n})(LC)),LC}var UC,FI;function c_e(){return FI||(FI=1,UC=l_e().range),UC}var u_e=c_e();const jW=Ml(u_e);function Cf(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function d_e(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function sA(e){let t,r,n;e.length!==2?(t=Cf,r=(o,c)=>Cf(e(o),c),n=(o,c)=>e(o)-c):(t=e===Cf||e===d_e?e:f_e,r=e,n=e);function s(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<0?u=f+1:d=f}while(u<d)}return u}function a(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function i(o,c,u=0,d=o.length){const f=s(o,c,u,d-1);return f>u&&n(o[f-1],c)>-n(o[f],c)?f-1:f}return{left:s,center:i,right:a}}function f_e(){return 0}function PW(e){return e===null?NaN:+e}function*h_e(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const g_e=sA(Cf),a1=g_e.right;sA(PW).center;class OI extends Map{constructor(t,r=x_e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,s]of t)this.set(n,s)}get(t){return super.get(DI(this,t))}has(t){return super.has(DI(this,t))}set(t,r){return super.set(m_e(this,t),r)}delete(t){return super.delete(p_e(this,t))}}function DI({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function m_e({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function p_e({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function x_e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function y_e(e=Cf){if(e===Cf)return FW;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function FW(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const v_e=Math.sqrt(50),w_e=Math.sqrt(10),__e=Math.sqrt(2);function pb(e,t,r){const n=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(n)),a=n/Math.pow(10,s),i=a>=v_e?10:a>=w_e?5:a>=__e?2:1;let o,c,u;return s<0?(u=Math.pow(10,-s)/i,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,s)*i,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?pb(e,t,r*2):[o,c,u]}function YE(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[s,a,i]=n?pb(t,e,r):pb(e,t,r);if(!(a>=s))return[];const o=a-s+1,c=new Array(o);if(n)if(i<0)for(let u=0;u<o;++u)c[u]=(a-u)/-i;else for(let u=0;u<o;++u)c[u]=(a-u)*i;else if(i<0)for(let u=0;u<o;++u)c[u]=(s+u)/-i;else for(let u=0;u<o;++u)c[u]=(s+u)*i;return c}function XE(e,t,r){return t=+t,e=+e,r=+r,pb(e,t,r)[2]}function QE(e,t,r){t=+t,e=+e,r=+r;const n=t<e,s=n?XE(t,e,r):XE(e,t,r);return(n?-1:1)*(s<0?1/-s:s)}function II(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function RI(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function OW(e,t,r=0,n=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(s=s===void 0?FW:y_e(s);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),g=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+g)),x=Math.min(n,Math.floor(t+(c-u)*f/c+g));OW(e,t,p,x,s)}const a=e[t];let i=r,o=n;for(sy(e,r,t),s(e[n],a)>0&&sy(e,r,n);i<o;){for(sy(e,i,o),++i,--o;s(e[i],a)<0;)++i;for(;s(e[o],a)>0;)--o}s(e[r],a)===0?sy(e,r,o):(++o,sy(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function sy(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function b_e(e,t,r){if(e=Float64Array.from(h_e(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return RI(e);if(t>=1)return II(e);var n,s=(n-1)*t,a=Math.floor(s),i=II(OW(e,a).subarray(0,a+1)),o=RI(e.subarray(a+1));return i+(o-i)*(s-a)}}function S_e(e,t,r=PW){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,s=(n-1)*t,a=Math.floor(s),i=+r(e[a],a,e),o=+r(e[a+1],a+1,e);return i+(o-i)*(s-a)}}function k_e(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var n=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(s);++n<s;)a[n]=e+n*r;return a}function Ul(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function vd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const JE=Symbol("implicit");function aA(){var e=new OI,t=[],r=[],n=JE;function s(a){let i=e.get(a);if(i===void 0){if(n!==JE)return n;e.set(a,i=t.push(a)-1)}return r[i%r.length]}return s.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new OI;for(const i of a)e.has(i)||e.set(i,t.push(i)-1);return s},s.range=function(a){return arguments.length?(r=Array.from(a),s):r.slice()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return aA(t,r).unknown(n)},Ul.apply(s,arguments),s}function iA(){var e=aA().unknown(void 0),t=e.domain,r=e.range,n=0,s=1,a,i,o=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var g=t().length,p=s<n,x=p?s:n,v=p?n:s;a=(v-x)/Math.max(1,g-c+u*2),o&&(a=Math.floor(a)),x+=(v-x-a*(g-c))*d,i=a*(1-c),o&&(x=Math.round(x),i=Math.round(i));var w=k_e(g).map(function(C){return x+a*C});return r(p?w.reverse():w)}return e.domain=function(g){return arguments.length?(t(g),f()):t()},e.range=function(g){return arguments.length?([n,s]=g,n=+n,s=+s,f()):[n,s]},e.rangeRound=function(g){return[n,s]=g,n=+n,s=+s,o=!0,f()},e.bandwidth=function(){return i},e.step=function(){return a},e.round=function(g){return arguments.length?(o=!!g,f()):o},e.padding=function(g){return arguments.length?(c=Math.min(1,u=+g),f()):c},e.paddingInner=function(g){return arguments.length?(c=Math.min(1,g),f()):c},e.paddingOuter=function(g){return arguments.length?(u=+g,f()):u},e.align=function(g){return arguments.length?(d=Math.max(0,Math.min(1,g)),f()):d},e.copy=function(){return iA(t(),[n,s]).round(o).paddingInner(c).paddingOuter(u).align(d)},Ul.apply(f(),arguments)}function DW(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return DW(t())},e}function C_e(){return DW(iA.apply(null,arguments).paddingInner(1))}function oA(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function IW(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function i1(){}var wv=.7,xb=1/wv,xm="\\s*([+-]?\\d+)\\s*",_v="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ru="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",T_e=/^#([0-9a-f]{3,8})$/,E_e=new RegExp(`^rgb\\(${xm},${xm},${xm}\\)$`),N_e=new RegExp(`^rgb\\(${ru},${ru},${ru}\\)$`),A_e=new RegExp(`^rgba\\(${xm},${xm},${xm},${_v}\\)$`),j_e=new RegExp(`^rgba\\(${ru},${ru},${ru},${_v}\\)$`),P_e=new RegExp(`^hsl\\(${_v},${ru},${ru}\\)$`),F_e=new RegExp(`^hsla\\(${_v},${ru},${ru},${_v}\\)$`),MI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};oA(i1,bv,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:LI,formatHex:LI,formatHex8:O_e,formatHsl:D_e,formatRgb:BI,toString:BI});function LI(){return this.rgb().formatHex()}function O_e(){return this.rgb().formatHex8()}function D_e(){return RW(this).formatHsl()}function BI(){return this.rgb().formatRgb()}function bv(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=T_e.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?$I(t):r===3?new To(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Yw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Yw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=E_e.exec(e))?new To(t[1],t[2],t[3],1):(t=N_e.exec(e))?new To(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=A_e.exec(e))?Yw(t[1],t[2],t[3],t[4]):(t=j_e.exec(e))?Yw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=P_e.exec(e))?WI(t[1],t[2]/100,t[3]/100,1):(t=F_e.exec(e))?WI(t[1],t[2]/100,t[3]/100,t[4]):MI.hasOwnProperty(e)?$I(MI[e]):e==="transparent"?new To(NaN,NaN,NaN,0):null}function $I(e){return new To(e>>16&255,e>>8&255,e&255,1)}function Yw(e,t,r,n){return n<=0&&(e=t=r=NaN),new To(e,t,r,n)}function I_e(e){return e instanceof i1||(e=bv(e)),e?(e=e.rgb(),new To(e.r,e.g,e.b,e.opacity)):new To}function ZE(e,t,r,n){return arguments.length===1?I_e(e):new To(e,t,r,n??1)}function To(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}oA(To,ZE,IW(i1,{brighter(e){return e=e==null?xb:Math.pow(xb,e),new To(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?wv:Math.pow(wv,e),new To(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new To(e0(this.r),e0(this.g),e0(this.b),yb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:UI,formatHex:UI,formatHex8:R_e,formatRgb:zI,toString:zI}));function UI(){return`#${Bh(this.r)}${Bh(this.g)}${Bh(this.b)}`}function R_e(){return`#${Bh(this.r)}${Bh(this.g)}${Bh(this.b)}${Bh((isNaN(this.opacity)?1:this.opacity)*255)}`}function zI(){const e=yb(this.opacity);return`${e===1?"rgb(":"rgba("}${e0(this.r)}, ${e0(this.g)}, ${e0(this.b)}${e===1?")":`, ${e})`}`}function yb(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function e0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Bh(e){return e=e0(e),(e<16?"0":"")+e.toString(16)}function WI(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new lc(e,t,r,n)}function RW(e){if(e instanceof lc)return new lc(e.h,e.s,e.l,e.opacity);if(e instanceof i1||(e=bv(e)),!e)return new lc;if(e instanceof lc)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),a=Math.max(t,r,n),i=NaN,o=a-s,c=(a+s)/2;return o?(t===a?i=(r-n)/o+(r<n)*6:r===a?i=(n-t)/o+2:i=(t-r)/o+4,o/=c<.5?a+s:2-a-s,i*=60):o=c>0&&c<1?0:i,new lc(i,o,c,e.opacity)}function M_e(e,t,r,n){return arguments.length===1?RW(e):new lc(e,t,r,n??1)}function lc(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}oA(lc,M_e,IW(i1,{brighter(e){return e=e==null?xb:Math.pow(xb,e),new lc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?wv:Math.pow(wv,e),new lc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new To(zC(e>=240?e-240:e+120,s,n),zC(e,s,n),zC(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new lc(HI(this.h),Xw(this.s),Xw(this.l),yb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=yb(this.opacity);return`${e===1?"hsl(":"hsla("}${HI(this.h)}, ${Xw(this.s)*100}%, ${Xw(this.l)*100}%${e===1?")":`, ${e})`}`}}));function HI(e){return e=(e||0)%360,e<0?e+360:e}function Xw(e){return Math.max(0,Math.min(1,e||0))}function zC(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const lA=e=>()=>e;function L_e(e,t){return function(r){return e+r*t}}function B_e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function $_e(e){return(e=+e)==1?MW:function(t,r){return r-t?B_e(t,r,e):lA(isNaN(t)?r:t)}}function MW(e,t){var r=t-e;return r?L_e(e,r):lA(isNaN(e)?t:e)}const GI=(function e(t){var r=$_e(t);function n(s,a){var i=r((s=ZE(s)).r,(a=ZE(a)).r),o=r(s.g,a.g),c=r(s.b,a.b),u=MW(s.opacity,a.opacity);return function(d){return s.r=i(d),s.g=o(d),s.b=c(d),s.opacity=u(d),s+""}}return n.gamma=e,n})(1);function U_e(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),s;return function(a){for(s=0;s<r;++s)n[s]=e[s]*(1-a)+t[s]*a;return n}}function z_e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function W_e(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,s=new Array(n),a=new Array(r),i;for(i=0;i<n;++i)s[i]=ip(e[i],t[i]);for(;i<r;++i)a[i]=t[i];return function(o){for(i=0;i<n;++i)a[i]=s[i](o);return a}}function H_e(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function vb(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function G_e(e,t){var r={},n={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=ip(e[s],t[s]):n[s]=t[s];return function(a){for(s in r)n[s]=r[s](a);return n}}var eN=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,WC=new RegExp(eN.source,"g");function V_e(e){return function(){return e}}function K_e(e){return function(t){return e(t)+""}}function q_e(e,t){var r=eN.lastIndex=WC.lastIndex=0,n,s,a,i=-1,o=[],c=[];for(e=e+"",t=t+"";(n=eN.exec(e))&&(s=WC.exec(t));)(a=s.index)>r&&(a=t.slice(r,a),o[i]?o[i]+=a:o[++i]=a),(n=n[0])===(s=s[0])?o[i]?o[i]+=s:o[++i]=s:(o[++i]=null,c.push({i,x:vb(n,s)})),r=WC.lastIndex;return r<t.length&&(a=t.slice(r),o[i]?o[i]+=a:o[++i]=a),o.length<2?c[0]?K_e(c[0].x):V_e(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)o[(f=c[d]).i]=f.x(u);return o.join("")})}function ip(e,t){var r=typeof t,n;return t==null||r==="boolean"?lA(t):(r==="number"?vb:r==="string"?(n=bv(t))?(t=n,GI):q_e:t instanceof bv?GI:t instanceof Date?H_e:z_e(t)?U_e:Array.isArray(t)?W_e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?G_e:vb)(e,t)}function cA(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Y_e(e,t){t===void 0&&(t=e,e=ip);for(var r=0,n=t.length-1,s=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(s,s=t[++r]);return function(i){var o=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return a[o](i-o)}}function X_e(e){return function(){return e}}function wb(e){return+e}var VI=[0,1];function ao(e){return e}function tN(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:X_e(isNaN(t)?NaN:.5)}function Q_e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function J_e(e,t,r){var n=e[0],s=e[1],a=t[0],i=t[1];return s<n?(n=tN(s,n),a=r(i,a)):(n=tN(n,s),a=r(a,i)),function(o){return a(n(o))}}function Z_e(e,t,r){var n=Math.min(e.length,t.length)-1,s=new Array(n),a=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)s[i]=tN(e[i],e[i+1]),a[i]=r(t[i],t[i+1]);return function(o){var c=a1(e,o,1,n)-1;return a[c](s[c](o))}}function o1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function P2(){var e=VI,t=VI,r=ip,n,s,a,i=ao,o,c,u;function d(){var g=Math.min(e.length,t.length);return i!==ao&&(i=Q_e(e[0],e[g-1])),o=g>2?Z_e:J_e,c=u=null,f}function f(g){return g==null||isNaN(g=+g)?a:(c||(c=o(e.map(n),t,r)))(n(i(g)))}return f.invert=function(g){return i(s((u||(u=o(t,e.map(n),vb)))(g)))},f.domain=function(g){return arguments.length?(e=Array.from(g,wb),d()):e.slice()},f.range=function(g){return arguments.length?(t=Array.from(g),d()):t.slice()},f.rangeRound=function(g){return t=Array.from(g),r=cA,d()},f.clamp=function(g){return arguments.length?(i=g?!0:ao,d()):i!==ao},f.interpolate=function(g){return arguments.length?(r=g,d()):r},f.unknown=function(g){return arguments.length?(a=g,f):a},function(g,p){return n=g,s=p,d()}}function uA(){return P2()(ao,ao)}function ebe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function _b(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Fm(e){return e=_b(Math.abs(e)),e?e[1]:NaN}function tbe(e,t){return function(r,n){for(var s=r.length,a=[],i=0,o=e[0],c=0;s>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),a.push(r.substring(s-=o,s+o)),!((c+=o+1)>n));)o=e[i=(i+1)%e.length];return a.reverse().join(t)}}function rbe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var nbe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Sv(e){if(!(t=nbe.exec(e)))throw new Error("invalid format: "+e);var t;return new dA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Sv.prototype=dA.prototype;function dA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}dA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function sbe(e){e:for(var t=e.length,r=1,n=-1,s;r<t;++r)switch(e[r]){case".":n=s=r;break;case"0":n===0&&(n=r),s=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(s+1):e}var LW;function abe(e,t){var r=_b(e,t);if(!r)return e+"";var n=r[0],s=r[1],a=s-(LW=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,i=n.length;return a===i?n:a>i?n+new Array(a-i+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+_b(e,Math.max(0,t+a-1))[0]}function KI(e,t){var r=_b(e,t);if(!r)return e+"";var n=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const qI={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:ebe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>KI(e*100,t),r:KI,s:abe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function YI(e){return e}var XI=Array.prototype.map,QI=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function ibe(e){var t=e.grouping===void 0||e.thousands===void 0?YI:tbe(XI.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?YI:rbe(XI.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f){f=Sv(f);var g=f.fill,p=f.align,x=f.sign,v=f.symbol,w=f.zero,C=f.width,k=f.comma,_=f.precision,N=f.trim,E=f.type;E==="n"?(k=!0,E="g"):qI[E]||(_===void 0&&(_=12),N=!0,E="g"),(w||g==="0"&&p==="=")&&(w=!0,g="0",p="=");var P=v==="$"?r:v==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",F=v==="$"?n:/[%p]/.test(E)?i:"",A=qI[E],j=/[defgprs%]/.test(E);_=_===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function I(B){var Y=P,Z=F,se,ee,te;if(E==="c")Z=A(B)+Z,B="";else{B=+B;var L=B<0||1/B<0;if(B=isNaN(B)?c:A(Math.abs(B),_),N&&(B=sbe(B)),L&&+B==0&&x!=="+"&&(L=!1),Y=(L?x==="("?x:o:x==="-"||x==="("?"":x)+Y,Z=(E==="s"?QI[8+LW/3]:"")+Z+(L&&x==="("?")":""),j){for(se=-1,ee=B.length;++se<ee;)if(te=B.charCodeAt(se),48>te||te>57){Z=(te===46?s+B.slice(se+1):B.slice(se))+Z,B=B.slice(0,se);break}}}k&&!w&&(B=t(B,1/0));var V=Y.length+B.length+Z.length,M=V<C?new Array(C-V+1).join(g):"";switch(k&&w&&(B=t(M+B,M.length?C-Z.length:1/0),M=""),p){case"<":B=Y+B+Z+M;break;case"=":B=Y+M+B+Z;break;case"^":B=M.slice(0,V=M.length>>1)+Y+B+Z+M.slice(V);break;default:B=M+Y+B+Z;break}return a(B)}return I.toString=function(){return f+""},I}function d(f,g){var p=u((f=Sv(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(Fm(g)/3)))*3,v=Math.pow(10,-x),w=QI[8+x/3];return function(C){return p(v*C)+w}}return{format:u,formatPrefix:d}}var Qw,fA,BW;obe({thousands:",",grouping:[3],currency:["$",""]});function obe(e){return Qw=ibe(e),fA=Qw.format,BW=Qw.formatPrefix,Qw}function lbe(e){return Math.max(0,-Fm(Math.abs(e)))}function cbe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Fm(t)/3)))*3-Fm(Math.abs(e)))}function ube(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Fm(t)-Fm(e))+1}function $W(e,t,r,n){var s=QE(e,t,r),a;switch(n=Sv(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=cbe(s,i))&&(n.precision=a),BW(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=ube(s,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=lbe(s))&&(n.precision=a-(n.type==="%")*2);break}}return fA(n)}function Vf(e){var t=e.domain;return e.ticks=function(r){var n=t();return YE(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var s=t();return $W(s[0],s[s.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),s=0,a=n.length-1,i=n[s],o=n[a],c,u,d=10;for(o<i&&(u=i,i=o,o=u,u=s,s=a,a=u);d-- >0;){if(u=XE(i,o,r),u===c)return n[s]=i,n[a]=o,t(n);if(u>0)i=Math.floor(i/u)*u,o=Math.ceil(o/u)*u;else if(u<0)i=Math.ceil(i*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function UW(){var e=uA();return e.copy=function(){return o1(e,UW())},Ul.apply(e,arguments),Vf(e)}function zW(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,wb),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return zW(e).unknown(t)},e=arguments.length?Array.from(e,wb):[0,1],Vf(r)}function WW(e,t){e=e.slice();var r=0,n=e.length-1,s=e[r],a=e[n],i;return a<s&&(i=r,r=n,n=i,i=s,s=a,a=i),e[r]=t.floor(s),e[n]=t.ceil(a),e}function JI(e){return Math.log(e)}function ZI(e){return Math.exp(e)}function dbe(e){return-Math.log(-e)}function fbe(e){return-Math.exp(-e)}function hbe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function gbe(e){return e===10?hbe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function mbe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function eR(e){return(t,r)=>-e(-t,r)}function hA(e){const t=e(JI,ZI),r=t.domain;let n=10,s,a;function i(){return s=mbe(n),a=gbe(n),r()[0]<0?(s=eR(s),a=eR(a),e(dbe,fbe)):e(JI,ZI),t}return t.base=function(o){return arguments.length?(n=+o,i()):n},t.domain=function(o){return arguments.length?(r(o),i()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let g=s(u),p=s(d),x,v;const w=o==null?10:+o;let C=[];if(!(n%1)&&p-g<w){if(g=Math.floor(g),p=Math.ceil(p),u>0){for(;g<=p;++g)for(x=1;x<n;++x)if(v=g<0?x/a(-g):x*a(g),!(v<u)){if(v>d)break;C.push(v)}}else for(;g<=p;++g)for(x=n-1;x>=1;--x)if(v=g>0?x/a(-g):x*a(g),!(v<u)){if(v>d)break;C.push(v)}C.length*2<w&&(C=YE(u,d,w))}else C=YE(g,p,Math.min(p-g,w)).map(a);return f?C.reverse():C},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Sv(c)).precision==null&&(c.trim=!0),c=fA(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return d=>{let f=d/a(Math.round(s(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(WW(r(),{floor:o=>a(Math.floor(s(o))),ceil:o=>a(Math.ceil(s(o)))})),t}function HW(){const e=hA(P2()).domain([1,10]);return e.copy=()=>o1(e,HW()).base(e.base()),Ul.apply(e,arguments),e}function tR(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function rR(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function gA(e){var t=1,r=e(tR(t),rR(t));return r.constant=function(n){return arguments.length?e(tR(t=+n),rR(t)):t},Vf(r)}function GW(){var e=gA(P2());return e.copy=function(){return o1(e,GW()).constant(e.constant())},Ul.apply(e,arguments)}function nR(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function pbe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function xbe(e){return e<0?-e*e:e*e}function mA(e){var t=e(ao,ao),r=1;function n(){return r===1?e(ao,ao):r===.5?e(pbe,xbe):e(nR(r),nR(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,n()):r},Vf(t)}function pA(){var e=mA(P2());return e.copy=function(){return o1(e,pA()).exponent(e.exponent())},Ul.apply(e,arguments),e}function ybe(){return pA.apply(null,arguments).exponent(.5)}function sR(e){return Math.sign(e)*e*e}function vbe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function VW(){var e=uA(),t=[0,1],r=!1,n;function s(a){var i=vbe(e(a));return isNaN(i)?n:r?Math.round(i):i}return s.invert=function(a){return e.invert(sR(a))},s.domain=function(a){return arguments.length?(e.domain(a),s):e.domain()},s.range=function(a){return arguments.length?(e.range((t=Array.from(a,wb)).map(sR)),s):t.slice()},s.rangeRound=function(a){return s.range(a).round(!0)},s.round=function(a){return arguments.length?(r=!!a,s):r},s.clamp=function(a){return arguments.length?(e.clamp(a),s):e.clamp()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return VW(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ul.apply(s,arguments),Vf(s)}function KW(){var e=[],t=[],r=[],n;function s(){var i=0,o=Math.max(1,t.length);for(r=new Array(o-1);++i<o;)r[i-1]=S_e(e,i/o);return a}function a(i){return i==null||isNaN(i=+i)?n:t[a1(r,i)]}return a.invertExtent=function(i){var o=t.indexOf(i);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},a.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let o of i)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Cf),s()},a.range=function(i){return arguments.length?(t=Array.from(i),s()):t.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return KW().domain(e).range(t).unknown(n)},Ul.apply(a,arguments)}function qW(){var e=0,t=1,r=1,n=[.5],s=[0,1],a;function i(c){return c!=null&&c<=c?s[a1(n,c,0,r)]:a}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},i.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,o()):s.slice()},i.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},i.unknown=function(c){return arguments.length&&(a=c),i},i.thresholds=function(){return n.slice()},i.copy=function(){return qW().domain([e,t]).range(s).unknown(a)},Ul.apply(Vf(i),arguments)}function YW(){var e=[.5],t=[0,1],r,n=1;function s(a){return a!=null&&a<=a?t[a1(e,a,0,n)]:r}return s.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(a){var i=t.indexOf(a);return[e[i-1],e[i]]},s.unknown=function(a){return arguments.length?(r=a,s):r},s.copy=function(){return YW().domain(e).range(t).unknown(r)},Ul.apply(s,arguments)}const HC=new Date,GC=new Date;function ja(e,t,r,n){function s(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return s.floor=a=>(e(a=new Date(+a)),a),s.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),s.round=a=>{const i=s(a),o=s.ceil(a);return a-i<o-a?i:o},s.offset=(a,i)=>(t(a=new Date(+a),i==null?1:Math.floor(i)),a),s.range=(a,i,o)=>{const c=[];if(a=s.ceil(a),o=o==null?1:Math.floor(o),!(a<i)||!(o>0))return c;let u;do c.push(u=new Date(+a)),t(a,o),e(a);while(u<a&&a<i);return c},s.filter=a=>ja(i=>{if(i>=i)for(;e(i),!a(i);)i.setTime(i-1)},(i,o)=>{if(i>=i)if(o<0)for(;++o<=0;)for(;t(i,-1),!a(i););else for(;--o>=0;)for(;t(i,1),!a(i););}),r&&(s.count=(a,i)=>(HC.setTime(+a),GC.setTime(+i),e(HC),e(GC),Math.floor(r(HC,GC))),s.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?s.filter(n?i=>n(i)%a===0:i=>s.count(0,i)%a===0):s)),s}const bb=ja(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);bb.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ja(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):bb);bb.range;const Yu=1e3,Nl=Yu*60,Xu=Nl*60,cd=Xu*24,xA=cd*7,aR=cd*30,VC=cd*365,$h=ja(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Yu)},(e,t)=>(t-e)/Yu,e=>e.getUTCSeconds());$h.range;const yA=ja(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Yu)},(e,t)=>{e.setTime(+e+t*Nl)},(e,t)=>(t-e)/Nl,e=>e.getMinutes());yA.range;const vA=ja(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Nl)},(e,t)=>(t-e)/Nl,e=>e.getUTCMinutes());vA.range;const wA=ja(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Yu-e.getMinutes()*Nl)},(e,t)=>{e.setTime(+e+t*Xu)},(e,t)=>(t-e)/Xu,e=>e.getHours());wA.range;const _A=ja(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Xu)},(e,t)=>(t-e)/Xu,e=>e.getUTCHours());_A.range;const l1=ja(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Nl)/cd,e=>e.getDate()-1);l1.range;const F2=ja(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/cd,e=>e.getUTCDate()-1);F2.range;const XW=ja(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/cd,e=>Math.floor(e/cd));XW.range;function B0(e){return ja(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Nl)/xA)}const O2=B0(0),Sb=B0(1),wbe=B0(2),_be=B0(3),Om=B0(4),bbe=B0(5),Sbe=B0(6);O2.range;Sb.range;wbe.range;_be.range;Om.range;bbe.range;Sbe.range;function $0(e){return ja(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/xA)}const D2=$0(0),kb=$0(1),kbe=$0(2),Cbe=$0(3),Dm=$0(4),Tbe=$0(5),Ebe=$0(6);D2.range;kb.range;kbe.range;Cbe.range;Dm.range;Tbe.range;Ebe.range;const bA=ja(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());bA.range;const SA=ja(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());SA.range;const ud=ja(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ud.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ja(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ud.range;const dd=ja(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());dd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ja(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});dd.range;function QW(e,t,r,n,s,a){const i=[[$h,1,Yu],[$h,5,5*Yu],[$h,15,15*Yu],[$h,30,30*Yu],[a,1,Nl],[a,5,5*Nl],[a,15,15*Nl],[a,30,30*Nl],[s,1,Xu],[s,3,3*Xu],[s,6,6*Xu],[s,12,12*Xu],[n,1,cd],[n,2,2*cd],[r,1,xA],[t,1,aR],[t,3,3*aR],[e,1,VC]];function o(u,d,f){const g=d<u;g&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),x=p?p.range(u,+d+1):[];return g?x.reverse():x}function c(u,d,f){const g=Math.abs(d-u)/f,p=sA(([,,w])=>w).right(i,g);if(p===i.length)return e.every(QE(u/VC,d/VC,f));if(p===0)return bb.every(Math.max(QE(u,d,f),1));const[x,v]=i[g/i[p-1][2]<i[p][2]/g?p-1:p];return x.every(v)}return[o,c]}const[Nbe,Abe]=QW(dd,SA,D2,XW,_A,vA),[jbe,Pbe]=QW(ud,bA,O2,l1,wA,yA);function KC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function qC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ay(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Fbe(e){var t=e.dateTime,r=e.date,n=e.time,s=e.periods,a=e.days,i=e.shortDays,o=e.months,c=e.shortMonths,u=iy(s),d=oy(s),f=iy(a),g=oy(a),p=iy(i),x=oy(i),v=iy(o),w=oy(o),C=iy(c),k=oy(c),_={a:L,A:V,b:M,B:H,c:null,d:dR,e:dR,f:t2e,g:d2e,G:h2e,H:Jbe,I:Zbe,j:e2e,L:JW,m:r2e,M:n2e,p:W,q:R,Q:gR,s:mR,S:s2e,u:a2e,U:i2e,V:o2e,w:l2e,W:c2e,x:null,X:null,y:u2e,Y:f2e,Z:g2e,"%":hR},N={a:z,A:K,b:Q,B:ae,c:null,d:fR,e:fR,f:y2e,g:N2e,G:j2e,H:m2e,I:p2e,j:x2e,L:eH,m:v2e,M:w2e,p:X,q:ie,Q:gR,s:mR,S:_2e,u:b2e,U:S2e,V:k2e,w:C2e,W:T2e,x:null,X:null,y:E2e,Y:A2e,Z:P2e,"%":hR},E={a:I,A:B,b:Y,B:Z,c:se,d:cR,e:cR,f:qbe,g:lR,G:oR,H:uR,I:uR,j:Hbe,L:Kbe,m:Wbe,M:Gbe,p:j,q:zbe,Q:Xbe,s:Qbe,S:Vbe,u:Mbe,U:Lbe,V:Bbe,w:Rbe,W:$be,x:ee,X:te,y:lR,Y:oR,Z:Ube,"%":Ybe};_.x=P(r,_),_.X=P(n,_),_.c=P(t,_),N.x=P(r,N),N.X=P(n,N),N.c=P(t,N);function P(le,ce){return function(_e){var ne=[],pe=-1,Ce=0,Ae=le.length,Ge,Le,At;for(_e instanceof Date||(_e=new Date(+_e));++pe<Ae;)le.charCodeAt(pe)===37&&(ne.push(le.slice(Ce,pe)),(Le=iR[Ge=le.charAt(++pe)])!=null?Ge=le.charAt(++pe):Le=Ge==="e"?" ":"0",(At=ce[Ge])&&(Ge=At(_e,Le)),ne.push(Ge),Ce=pe+1);return ne.push(le.slice(Ce,pe)),ne.join("")}}function F(le,ce){return function(_e){var ne=ay(1900,void 0,1),pe=A(ne,le,_e+="",0),Ce,Ae;if(pe!=_e.length)return null;if("Q"in ne)return new Date(ne.Q);if("s"in ne)return new Date(ne.s*1e3+("L"in ne?ne.L:0));if(ce&&!("Z"in ne)&&(ne.Z=0),"p"in ne&&(ne.H=ne.H%12+ne.p*12),ne.m===void 0&&(ne.m="q"in ne?ne.q:0),"V"in ne){if(ne.V<1||ne.V>53)return null;"w"in ne||(ne.w=1),"Z"in ne?(Ce=qC(ay(ne.y,0,1)),Ae=Ce.getUTCDay(),Ce=Ae>4||Ae===0?kb.ceil(Ce):kb(Ce),Ce=F2.offset(Ce,(ne.V-1)*7),ne.y=Ce.getUTCFullYear(),ne.m=Ce.getUTCMonth(),ne.d=Ce.getUTCDate()+(ne.w+6)%7):(Ce=KC(ay(ne.y,0,1)),Ae=Ce.getDay(),Ce=Ae>4||Ae===0?Sb.ceil(Ce):Sb(Ce),Ce=l1.offset(Ce,(ne.V-1)*7),ne.y=Ce.getFullYear(),ne.m=Ce.getMonth(),ne.d=Ce.getDate()+(ne.w+6)%7)}else("W"in ne||"U"in ne)&&("w"in ne||(ne.w="u"in ne?ne.u%7:"W"in ne?1:0),Ae="Z"in ne?qC(ay(ne.y,0,1)).getUTCDay():KC(ay(ne.y,0,1)).getDay(),ne.m=0,ne.d="W"in ne?(ne.w+6)%7+ne.W*7-(Ae+5)%7:ne.w+ne.U*7-(Ae+6)%7);return"Z"in ne?(ne.H+=ne.Z/100|0,ne.M+=ne.Z%100,qC(ne)):KC(ne)}}function A(le,ce,_e,ne){for(var pe=0,Ce=ce.length,Ae=_e.length,Ge,Le;pe<Ce;){if(ne>=Ae)return-1;if(Ge=ce.charCodeAt(pe++),Ge===37){if(Ge=ce.charAt(pe++),Le=E[Ge in iR?ce.charAt(pe++):Ge],!Le||(ne=Le(le,_e,ne))<0)return-1}else if(Ge!=_e.charCodeAt(ne++))return-1}return ne}function j(le,ce,_e){var ne=u.exec(ce.slice(_e));return ne?(le.p=d.get(ne[0].toLowerCase()),_e+ne[0].length):-1}function I(le,ce,_e){var ne=p.exec(ce.slice(_e));return ne?(le.w=x.get(ne[0].toLowerCase()),_e+ne[0].length):-1}function B(le,ce,_e){var ne=f.exec(ce.slice(_e));return ne?(le.w=g.get(ne[0].toLowerCase()),_e+ne[0].length):-1}function Y(le,ce,_e){var ne=C.exec(ce.slice(_e));return ne?(le.m=k.get(ne[0].toLowerCase()),_e+ne[0].length):-1}function Z(le,ce,_e){var ne=v.exec(ce.slice(_e));return ne?(le.m=w.get(ne[0].toLowerCase()),_e+ne[0].length):-1}function se(le,ce,_e){return A(le,t,ce,_e)}function ee(le,ce,_e){return A(le,r,ce,_e)}function te(le,ce,_e){return A(le,n,ce,_e)}function L(le){return i[le.getDay()]}function V(le){return a[le.getDay()]}function M(le){return c[le.getMonth()]}function H(le){return o[le.getMonth()]}function W(le){return s[+(le.getHours()>=12)]}function R(le){return 1+~~(le.getMonth()/3)}function z(le){return i[le.getUTCDay()]}function K(le){return a[le.getUTCDay()]}function Q(le){return c[le.getUTCMonth()]}function ae(le){return o[le.getUTCMonth()]}function X(le){return s[+(le.getUTCHours()>=12)]}function ie(le){return 1+~~(le.getUTCMonth()/3)}return{format:function(le){var ce=P(le+="",_);return ce.toString=function(){return le},ce},parse:function(le){var ce=F(le+="",!1);return ce.toString=function(){return le},ce},utcFormat:function(le){var ce=P(le+="",N);return ce.toString=function(){return le},ce},utcParse:function(le){var ce=F(le+="",!0);return ce.toString=function(){return le},ce}}}var iR={"-":"",_:" ",0:"0"},Ya=/^\s*\d+/,Obe=/^%/,Dbe=/[\\^$*+?|[\]().{}]/g;function bn(e,t,r){var n=e<0?"-":"",s=(n?-e:e)+"",a=s.length;return n+(a<r?new Array(r-a+1).join(t)+s:s)}function Ibe(e){return e.replace(Dbe,"\\$&")}function iy(e){return new RegExp("^(?:"+e.map(Ibe).join("|")+")","i")}function oy(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Rbe(e,t,r){var n=Ya.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Mbe(e,t,r){var n=Ya.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Lbe(e,t,r){var n=Ya.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function Bbe(e,t,r){var n=Ya.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function $be(e,t,r){var n=Ya.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function oR(e,t,r){var n=Ya.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function lR(e,t,r){var n=Ya.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Ube(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function zbe(e,t,r){var n=Ya.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Wbe(e,t,r){var n=Ya.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function cR(e,t,r){var n=Ya.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Hbe(e,t,r){var n=Ya.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function uR(e,t,r){var n=Ya.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Gbe(e,t,r){var n=Ya.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Vbe(e,t,r){var n=Ya.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Kbe(e,t,r){var n=Ya.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function qbe(e,t,r){var n=Ya.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Ybe(e,t,r){var n=Obe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Xbe(e,t,r){var n=Ya.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Qbe(e,t,r){var n=Ya.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function dR(e,t){return bn(e.getDate(),t,2)}function Jbe(e,t){return bn(e.getHours(),t,2)}function Zbe(e,t){return bn(e.getHours()%12||12,t,2)}function e2e(e,t){return bn(1+l1.count(ud(e),e),t,3)}function JW(e,t){return bn(e.getMilliseconds(),t,3)}function t2e(e,t){return JW(e,t)+"000"}function r2e(e,t){return bn(e.getMonth()+1,t,2)}function n2e(e,t){return bn(e.getMinutes(),t,2)}function s2e(e,t){return bn(e.getSeconds(),t,2)}function a2e(e){var t=e.getDay();return t===0?7:t}function i2e(e,t){return bn(O2.count(ud(e)-1,e),t,2)}function ZW(e){var t=e.getDay();return t>=4||t===0?Om(e):Om.ceil(e)}function o2e(e,t){return e=ZW(e),bn(Om.count(ud(e),e)+(ud(e).getDay()===4),t,2)}function l2e(e){return e.getDay()}function c2e(e,t){return bn(Sb.count(ud(e)-1,e),t,2)}function u2e(e,t){return bn(e.getFullYear()%100,t,2)}function d2e(e,t){return e=ZW(e),bn(e.getFullYear()%100,t,2)}function f2e(e,t){return bn(e.getFullYear()%1e4,t,4)}function h2e(e,t){var r=e.getDay();return e=r>=4||r===0?Om(e):Om.ceil(e),bn(e.getFullYear()%1e4,t,4)}function g2e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+bn(t/60|0,"0",2)+bn(t%60,"0",2)}function fR(e,t){return bn(e.getUTCDate(),t,2)}function m2e(e,t){return bn(e.getUTCHours(),t,2)}function p2e(e,t){return bn(e.getUTCHours()%12||12,t,2)}function x2e(e,t){return bn(1+F2.count(dd(e),e),t,3)}function eH(e,t){return bn(e.getUTCMilliseconds(),t,3)}function y2e(e,t){return eH(e,t)+"000"}function v2e(e,t){return bn(e.getUTCMonth()+1,t,2)}function w2e(e,t){return bn(e.getUTCMinutes(),t,2)}function _2e(e,t){return bn(e.getUTCSeconds(),t,2)}function b2e(e){var t=e.getUTCDay();return t===0?7:t}function S2e(e,t){return bn(D2.count(dd(e)-1,e),t,2)}function tH(e){var t=e.getUTCDay();return t>=4||t===0?Dm(e):Dm.ceil(e)}function k2e(e,t){return e=tH(e),bn(Dm.count(dd(e),e)+(dd(e).getUTCDay()===4),t,2)}function C2e(e){return e.getUTCDay()}function T2e(e,t){return bn(kb.count(dd(e)-1,e),t,2)}function E2e(e,t){return bn(e.getUTCFullYear()%100,t,2)}function N2e(e,t){return e=tH(e),bn(e.getUTCFullYear()%100,t,2)}function A2e(e,t){return bn(e.getUTCFullYear()%1e4,t,4)}function j2e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Dm(e):Dm.ceil(e),bn(e.getUTCFullYear()%1e4,t,4)}function P2e(){return"+0000"}function hR(){return"%"}function gR(e){return+e}function mR(e){return Math.floor(+e/1e3)}var $g,rH,nH;F2e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function F2e(e){return $g=Fbe(e),rH=$g.format,$g.parse,nH=$g.utcFormat,$g.utcParse,$g}function O2e(e){return new Date(e)}function D2e(e){return e instanceof Date?+e:+new Date(+e)}function kA(e,t,r,n,s,a,i,o,c,u){var d=uA(),f=d.invert,g=d.domain,p=u(".%L"),x=u(":%S"),v=u("%I:%M"),w=u("%I %p"),C=u("%a %d"),k=u("%b %d"),_=u("%B"),N=u("%Y");function E(P){return(c(P)<P?p:o(P)<P?x:i(P)<P?v:a(P)<P?w:n(P)<P?s(P)<P?C:k:r(P)<P?_:N)(P)}return d.invert=function(P){return new Date(f(P))},d.domain=function(P){return arguments.length?g(Array.from(P,D2e)):g().map(O2e)},d.ticks=function(P){var F=g();return e(F[0],F[F.length-1],P??10)},d.tickFormat=function(P,F){return F==null?E:u(F)},d.nice=function(P){var F=g();return(!P||typeof P.range!="function")&&(P=t(F[0],F[F.length-1],P??10)),P?g(WW(F,P)):d},d.copy=function(){return o1(d,kA(e,t,r,n,s,a,i,o,c,u))},d}function I2e(){return Ul.apply(kA(jbe,Pbe,ud,bA,O2,l1,wA,yA,$h,rH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function R2e(){return Ul.apply(kA(Nbe,Abe,dd,SA,D2,F2,_A,vA,$h,nH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function I2(){var e=0,t=1,r,n,s,a,i=ao,o=!1,c;function u(f){return f==null||isNaN(f=+f)?c:i(s===0?.5:(f=(a(f)-r)*s,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=a(e=+e),n=a(t=+t),s=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(i=f,u):i};function d(f){return function(g){var p,x;return arguments.length?([p,x]=g,i=f(p,x),u):[i(0),i(1)]}}return u.range=d(ip),u.rangeRound=d(cA),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return a=f,r=f(e),n=f(t),s=r===n?0:1/(n-r),u}}function Kf(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function sH(){var e=Vf(I2()(ao));return e.copy=function(){return Kf(e,sH())},vd.apply(e,arguments)}function aH(){var e=hA(I2()).domain([1,10]);return e.copy=function(){return Kf(e,aH()).base(e.base())},vd.apply(e,arguments)}function iH(){var e=gA(I2());return e.copy=function(){return Kf(e,iH()).constant(e.constant())},vd.apply(e,arguments)}function CA(){var e=mA(I2());return e.copy=function(){return Kf(e,CA()).exponent(e.exponent())},vd.apply(e,arguments)}function M2e(){return CA.apply(null,arguments).exponent(.5)}function oH(){var e=[],t=ao;function r(n){if(n!=null&&!isNaN(n=+n))return t((a1(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let s of n)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Cf),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,s)=>t(s/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(s,a)=>b_e(e,a/n))},r.copy=function(){return oH(t).domain(e)},vd.apply(r,arguments)}function R2(){var e=0,t=.5,r=1,n=1,s,a,i,o,c,u=ao,d,f=!1,g;function p(v){return isNaN(v=+v)?g:(v=.5+((v=+d(v))-a)*(n*v<n*a?o:c),u(f?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,r]=v,s=d(e=+e),a=d(t=+t),i=d(r=+r),o=s===a?0:.5/(a-s),c=a===i?0:.5/(i-a),n=a<s?-1:1,p):[e,t,r]},p.clamp=function(v){return arguments.length?(f=!!v,p):f},p.interpolator=function(v){return arguments.length?(u=v,p):u};function x(v){return function(w){var C,k,_;return arguments.length?([C,k,_]=w,u=Y_e(v,[C,k,_]),p):[u(0),u(.5),u(1)]}}return p.range=x(ip),p.rangeRound=x(cA),p.unknown=function(v){return arguments.length?(g=v,p):g},function(v){return d=v,s=v(e),a=v(t),i=v(r),o=s===a?0:.5/(a-s),c=a===i?0:.5/(i-a),n=a<s?-1:1,p}}function lH(){var e=Vf(R2()(ao));return e.copy=function(){return Kf(e,lH())},vd.apply(e,arguments)}function cH(){var e=hA(R2()).domain([.1,1,10]);return e.copy=function(){return Kf(e,cH()).base(e.base())},vd.apply(e,arguments)}function uH(){var e=gA(R2());return e.copy=function(){return Kf(e,uH()).constant(e.constant())},vd.apply(e,arguments)}function TA(){var e=mA(R2());return e.copy=function(){return Kf(e,TA()).exponent(e.exponent())},vd.apply(e,arguments)}function L2e(){return TA.apply(null,arguments).exponent(.5)}const py=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:iA,scaleDiverging:lH,scaleDivergingLog:cH,scaleDivergingPow:TA,scaleDivergingSqrt:L2e,scaleDivergingSymlog:uH,scaleIdentity:zW,scaleImplicit:JE,scaleLinear:UW,scaleLog:HW,scaleOrdinal:aA,scalePoint:C_e,scalePow:pA,scaleQuantile:KW,scaleQuantize:qW,scaleRadial:VW,scaleSequential:sH,scaleSequentialLog:aH,scaleSequentialPow:CA,scaleSequentialQuantile:oH,scaleSequentialSqrt:M2e,scaleSequentialSymlog:iH,scaleSqrt:ybe,scaleSymlog:GW,scaleThreshold:YW,scaleTime:I2e,scaleUtc:R2e,tickFormat:$W},Symbol.toStringTag,{value:"Module"}));var qf=e=>e.chartData,B2e=kt([qf],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),EA=(e,t,r,n)=>n?B2e(e):qf(e);function Im(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(yc(t)&&yc(r))return!0}return!1}function pR(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function $2e(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,s,a;if(yc(r))s=r;else if(typeof r=="function")return;if(yc(n))a=n;else if(typeof n=="function")return;var i=[s,a];if(Im(i))return i}}function U2e(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Im(n))return pR(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[s,a]=e,i,o;if(s==="auto")t!=null&&(i=Math.min(...t));else if($r(s))i=s;else if(typeof s=="function")try{t!=null&&(i=s(t?.[0]))}catch{}else if(typeof s=="string"&&lI.test(s)){var c=lI.exec(s);if(c==null||t==null)i=void 0;else{var u=+c[1];i=t[0]-u}}else i=t?.[0];if(a==="auto")t!=null&&(o=Math.max(...t));else if($r(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t?.[1]))}catch{}else if(typeof a=="string"&&cI.test(a)){var d=cI.exec(a);if(d==null||t==null)o=void 0;else{var f=+d[1];o=t[1]+f}}else o=t?.[1];var g=[i,o];if(Im(g))return t==null?g:pR(g,t,r)}}}var op=1e9,z2e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},AA,xs=!0,Rl="[DecimalError] ",t0=Rl+"Invalid argument: ",NA=Rl+"Exponent out of range: ",lp=Math.floor,Ph=Math.pow,W2e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Xo,Ua=1e7,ss=7,dH=9007199254740991,Cb=lp(dH/ss),pr={};pr.absoluteValue=pr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};pr.comparedTo=pr.cmp=function(e){var t,r,n,s,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,s=e.d.length,t=0,r=n<s?n:s;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===s?0:n>s^a.s<0?1:-1};pr.decimalPlaces=pr.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*ss;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};pr.dividedBy=pr.div=function(e){return rd(this,new this.constructor(e))};pr.dividedToIntegerBy=pr.idiv=function(e){var t=this,r=t.constructor;return Xn(rd(t,new r(e),0,1),r.precision)};pr.equals=pr.eq=function(e){return!this.cmp(e)};pr.exponent=function(){return ma(this)};pr.greaterThan=pr.gt=function(e){return this.cmp(e)>0};pr.greaterThanOrEqualTo=pr.gte=function(e){return this.cmp(e)>=0};pr.isInteger=pr.isint=function(){return this.e>this.d.length-2};pr.isNegative=pr.isneg=function(){return this.s<0};pr.isPositive=pr.ispos=function(){return this.s>0};pr.isZero=function(){return this.s===0};pr.lessThan=pr.lt=function(e){return this.cmp(e)<0};pr.lessThanOrEqualTo=pr.lte=function(e){return this.cmp(e)<1};pr.logarithm=pr.log=function(e){var t,r=this,n=r.constructor,s=n.precision,a=s+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Xo))throw Error(Rl+"NaN");if(r.s<1)throw Error(Rl+(r.s?"NaN":"-Infinity"));return r.eq(Xo)?new n(0):(xs=!1,t=rd(kv(r,a),kv(e,a),a),xs=!0,Xn(t,s))};pr.minus=pr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?gH(t,e):fH(t,(e.s=-e.s,e))};pr.modulo=pr.mod=function(e){var t,r=this,n=r.constructor,s=n.precision;if(e=new n(e),!e.s)throw Error(Rl+"NaN");return r.s?(xs=!1,t=rd(r,e,0,1).times(e),xs=!0,r.minus(t)):Xn(new n(r),s)};pr.naturalExponential=pr.exp=function(){return hH(this)};pr.naturalLogarithm=pr.ln=function(){return kv(this)};pr.negated=pr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};pr.plus=pr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?fH(t,e):gH(t,(e.s=-e.s,e))};pr.precision=pr.sd=function(e){var t,r,n,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(t0+e);if(t=ma(s)+1,n=s.d.length-1,r=n*ss+1,n=s.d[n],n){for(;n%10==0;n/=10)r--;for(n=s.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};pr.squareRoot=pr.sqrt=function(){var e,t,r,n,s,a,i,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(Rl+"NaN")}for(e=ma(o),xs=!1,s=Math.sqrt(+o),s==0||s==1/0?(t=Qc(o.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=lp((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(s.toString()),r=c.precision,s=i=r+3;;)if(a=n,n=a.plus(rd(o,a,i+2)).times(.5),Qc(a.d).slice(0,i)===(t=Qc(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),s==i&&t=="4999"){if(Xn(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(t!="9999")break;i+=4}return xs=!0,Xn(n,r)};pr.times=pr.mul=function(e){var t,r,n,s,a,i,o,c,u,d=this,f=d.constructor,g=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=g.length,u=p.length,c<u&&(a=g,g=p,p=a,i=c,c=u,u=i),a=[],i=c+u,n=i;n--;)a.push(0);for(n=u;--n>=0;){for(t=0,s=c+n;s>n;)o=a[s]+p[n]*g[s-n-1]+t,a[s--]=o%Ua|0,t=o/Ua|0;a[s]=(a[s]+t)%Ua|0}for(;!a[--i];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,xs?Xn(e,f.precision):e};pr.toDecimalPlaces=pr.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(iu(e,0,op),t===void 0?t=n.rounding:iu(t,0,8),Xn(r,e+ma(r)+1,t))};pr.toExponential=function(e,t){var r,n=this,s=n.constructor;return e===void 0?r=k0(n,!0):(iu(e,0,op),t===void 0?t=s.rounding:iu(t,0,8),n=Xn(new s(n),e+1,t),r=k0(n,!0,e+1)),r};pr.toFixed=function(e,t){var r,n,s=this,a=s.constructor;return e===void 0?k0(s):(iu(e,0,op),t===void 0?t=a.rounding:iu(t,0,8),n=Xn(new a(s),e+ma(s)+1,t),r=k0(n.abs(),!1,e+ma(n)+1),s.isneg()&&!s.isZero()?"-"+r:r)};pr.toInteger=pr.toint=function(){var e=this,t=e.constructor;return Xn(new t(e),ma(e)+1,t.rounding)};pr.toNumber=function(){return+this};pr.toPower=pr.pow=function(e){var t,r,n,s,a,i,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Xo);if(o=new c(o),!o.s){if(e.s<1)throw Error(Rl+"Infinity");return o}if(o.eq(Xo))return o;if(n=c.precision,e.eq(Xo))return Xn(o,n);if(t=e.e,r=e.d.length-1,i=t>=r,a=o.s,i){if((r=d<0?-d:d)<=dH){for(s=new c(Xo),t=Math.ceil(n/ss+4),xs=!1;r%2&&(s=s.times(o),yR(s.d,t)),r=lp(r/2),r!==0;)o=o.times(o),yR(o.d,t);return xs=!0,e.s<0?new c(Xo).div(s):Xn(s,n)}}else if(a<0)throw Error(Rl+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,xs=!1,s=e.times(kv(o,n+u)),xs=!0,s=hH(s),s.s=a,s};pr.toPrecision=function(e,t){var r,n,s=this,a=s.constructor;return e===void 0?(r=ma(s),n=k0(s,r<=a.toExpNeg||r>=a.toExpPos)):(iu(e,1,op),t===void 0?t=a.rounding:iu(t,0,8),s=Xn(new a(s),e,t),r=ma(s),n=k0(s,e<=r||r<=a.toExpNeg,e)),n};pr.toSignificantDigits=pr.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(iu(e,1,op),t===void 0?t=n.rounding:iu(t,0,8)),Xn(new n(r),e,t)};pr.toString=pr.valueOf=pr.val=pr.toJSON=pr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ma(e),r=e.constructor;return k0(e,t<=r.toExpNeg||t>=r.toExpPos)};function fH(e,t){var r,n,s,a,i,o,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),xs?Xn(t,f):t;if(c=e.d,u=t.d,i=e.e,s=t.e,c=c.slice(),a=i-s,a){for(a<0?(n=c,a=-a,o=u.length):(n=u,s=i,o=c.length),i=Math.ceil(f/ss),o=i>o?i+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=c.length,a=u.length,o-a<0&&(a=o,n=u,u=c,c=n),r=0;a;)r=(c[--a]=c[a]+u[a]+r)/Ua|0,c[a]%=Ua;for(r&&(c.unshift(r),++s),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=s,xs?Xn(t,f):t}function iu(e,t,r){if(e!==~~e||e<t||e>r)throw Error(t0+e)}function Qc(e){var t,r,n,s=e.length-1,a="",i=e[0];if(s>0){for(a+=i,t=1;t<s;t++)n=e[t]+"",r=ss-n.length,r&&(a+=df(r)),a+=n;i=e[t],n=i+"",r=ss-n.length,r&&(a+=df(r))}else if(i===0)return"0";for(;i%10===0;)i/=10;return a+i}var rd=(function(){function e(n,s){var a,i=0,o=n.length;for(n=n.slice();o--;)a=n[o]*s+i,n[o]=a%Ua|0,i=a/Ua|0;return i&&n.unshift(i),n}function t(n,s,a,i){var o,c;if(a!=i)c=a>i?1:-1;else for(o=c=0;o<a;o++)if(n[o]!=s[o]){c=n[o]>s[o]?1:-1;break}return c}function r(n,s,a){for(var i=0;a--;)n[a]-=i,i=n[a]<s[a]?1:0,n[a]=i*Ua+n[a]-s[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,s,a,i){var o,c,u,d,f,g,p,x,v,w,C,k,_,N,E,P,F,A,j=n.constructor,I=n.s==s.s?1:-1,B=n.d,Y=s.d;if(!n.s)return new j(n);if(!s.s)throw Error(Rl+"Division by zero");for(c=n.e-s.e,F=Y.length,E=B.length,p=new j(I),x=p.d=[],u=0;Y[u]==(B[u]||0);)++u;if(Y[u]>(B[u]||0)&&--c,a==null?k=a=j.precision:i?k=a+(ma(n)-ma(s))+1:k=a,k<0)return new j(0);if(k=k/ss+2|0,u=0,F==1)for(d=0,Y=Y[0],k++;(u<E||d)&&k--;u++)_=d*Ua+(B[u]||0),x[u]=_/Y|0,d=_%Y|0;else{for(d=Ua/(Y[0]+1)|0,d>1&&(Y=e(Y,d),B=e(B,d),F=Y.length,E=B.length),N=F,v=B.slice(0,F),w=v.length;w<F;)v[w++]=0;A=Y.slice(),A.unshift(0),P=Y[0],Y[1]>=Ua/2&&++P;do d=0,o=t(Y,v,F,w),o<0?(C=v[0],F!=w&&(C=C*Ua+(v[1]||0)),d=C/P|0,d>1?(d>=Ua&&(d=Ua-1),f=e(Y,d),g=f.length,w=v.length,o=t(f,v,g,w),o==1&&(d--,r(f,F<g?A:Y,g))):(d==0&&(o=d=1),f=Y.slice()),g=f.length,g<w&&f.unshift(0),r(v,f,w),o==-1&&(w=v.length,o=t(Y,v,F,w),o<1&&(d++,r(v,F<w?A:Y,w))),w=v.length):o===0&&(d++,v=[0]),x[u++]=d,o&&v[0]?v[w++]=B[N]||0:(v=[B[N]],w=1);while((N++<E||v[0]!==void 0)&&k--)}return x[0]||x.shift(),p.e=c,Xn(p,i?a+ma(p)+1:a)}})();function hH(e,t){var r,n,s,a,i,o,c=0,u=0,d=e.constructor,f=d.precision;if(ma(e)>16)throw Error(NA+ma(e));if(!e.s)return new d(Xo);for(xs=!1,o=f,i=new d(.03125);e.abs().gte(.1);)e=e.times(i),u+=5;for(n=Math.log(Ph(2,u))/Math.LN10*2+5|0,o+=n,r=s=a=new d(Xo),d.precision=o;;){if(s=Xn(s.times(e),o),r=r.times(++c),i=a.plus(rd(s,r,o)),Qc(i.d).slice(0,o)===Qc(a.d).slice(0,o)){for(;u--;)a=Xn(a.times(a),o);return d.precision=f,t==null?(xs=!0,Xn(a,f)):a}a=i}}function ma(e){for(var t=e.e*ss,r=e.d[0];r>=10;r/=10)t++;return t}function YC(e,t,r){if(t>e.LN10.sd())throw xs=!0,r&&(e.precision=r),Error(Rl+"LN10 precision limit exceeded");return Xn(new e(e.LN10),t)}function df(e){for(var t="";e--;)t+="0";return t}function kv(e,t){var r,n,s,a,i,o,c,u,d,f=1,g=10,p=e,x=p.d,v=p.constructor,w=v.precision;if(p.s<1)throw Error(Rl+(p.s?"NaN":"-Infinity"));if(p.eq(Xo))return new v(0);if(t==null?(xs=!1,u=w):u=t,p.eq(10))return t==null&&(xs=!0),YC(v,u);if(u+=g,v.precision=u,r=Qc(x),n=r.charAt(0),a=ma(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=Qc(p.d),n=r.charAt(0),f++;a=ma(p),n>1?(p=new v("0."+r),a++):p=new v(n+"."+r.slice(1))}else return c=YC(v,u+2,w).times(a+""),p=kv(new v(n+"."+r.slice(1)),u-g).plus(c),v.precision=w,t==null?(xs=!0,Xn(p,w)):p;for(o=i=p=rd(p.minus(Xo),p.plus(Xo),u),d=Xn(p.times(p),u),s=3;;){if(i=Xn(i.times(d),u),c=o.plus(rd(i,new v(s),u)),Qc(c.d).slice(0,u)===Qc(o.d).slice(0,u))return o=o.times(2),a!==0&&(o=o.plus(YC(v,u+2,w).times(a+""))),o=rd(o,new v(f),u),v.precision=w,t==null?(xs=!0,Xn(o,w)):o;o=c,s+=2}}function xR(e,t){var r,n,s;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(n,s),t){if(s-=n,r=r-n-1,e.e=lp(r/ss),e.d=[],n=(r+1)%ss,r<0&&(n+=ss),n<s){for(n&&e.d.push(+t.slice(0,n)),s-=ss;n<s;)e.d.push(+t.slice(n,n+=ss));t=t.slice(n),n=ss-t.length}else n-=s;for(;n--;)t+="0";if(e.d.push(+t),xs&&(e.e>Cb||e.e<-Cb))throw Error(NA+r)}else e.s=0,e.e=0,e.d=[0];return e}function Xn(e,t,r){var n,s,a,i,o,c,u,d,f=e.d;for(i=1,a=f[0];a>=10;a/=10)i++;if(n=t-i,n<0)n+=ss,s=t,u=f[d=0];else{if(d=Math.ceil((n+1)/ss),a=f.length,d>=a)return e;for(u=a=f[d],i=1;a>=10;a/=10)i++;n%=ss,s=n-ss+i}if(r!==void 0&&(a=Ph(10,i-s-1),o=u/a%10|0,c=t<0||f[d+1]!==void 0||u%a,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?s>0?u/Ph(10,i-s):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(a=ma(e),f.length=1,t=t-a-1,f[0]=Ph(10,(ss-t%ss)%ss),e.e=lp(-t/ss)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,a=1,d--):(f.length=d+1,a=Ph(10,ss-n),f[d]=s>0?(u/Ph(10,i-s)%Ph(10,s)|0)*a:0),c)for(;;)if(d==0){(f[0]+=a)==Ua&&(f[0]=1,++e.e);break}else{if(f[d]+=a,f[d]!=Ua)break;f[d--]=0,a=1}for(n=f.length;f[--n]===0;)f.pop();if(xs&&(e.e>Cb||e.e<-Cb))throw Error(NA+ma(e));return e}function gH(e,t){var r,n,s,a,i,o,c,u,d,f,g=e.constructor,p=g.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new g(e),xs?Xn(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),i=u-n,i){for(d=i<0,d?(r=c,i=-i,o=f.length):(r=f,n=u,o=c.length),s=Math.max(Math.ceil(p/ss),o)+2,i>s&&(i=s,r.length=1),r.reverse(),s=i;s--;)r.push(0);r.reverse()}else{for(s=c.length,o=f.length,d=s<o,d&&(o=s),s=0;s<o;s++)if(c[s]!=f[s]){d=c[s]<f[s];break}i=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),o=c.length,s=f.length-o;s>0;--s)c[o++]=0;for(s=f.length;s>i;){if(c[--s]<f[s]){for(a=s;a&&c[--a]===0;)c[a]=Ua-1;--c[a],c[s]+=Ua}c[s]-=f[s]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,xs?Xn(t,p):t):new g(0)}function k0(e,t,r){var n,s=ma(e),a=Qc(e.d),i=a.length;return t?(r&&(n=r-i)>0?a=a.charAt(0)+"."+a.slice(1)+df(n):i>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(s<0?"e":"e+")+s):s<0?(a="0."+df(-s-1)+a,r&&(n=r-i)>0&&(a+=df(n))):s>=i?(a+=df(s+1-i),r&&(n=r-s-1)>0&&(a=a+"."+df(n))):((n=s+1)<i&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-i)>0&&(s+1===i&&(a+="."),a+=df(n))),e.s<0?"-"+a:a}function yR(e,t){if(e.length>t)return e.length=t,!0}function mH(e){var t,r,n;function s(a){var i=this;if(!(i instanceof s))return new s(a);if(i.constructor=s,a instanceof s){i.s=a.s,i.e=a.e,i.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(t0+a);if(a>0)i.s=1;else if(a<0)a=-a,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(a===~~a&&a<1e7){i.e=0,i.d=[a];return}return xR(i,a.toString())}else if(typeof a!="string")throw Error(t0+a);if(a.charCodeAt(0)===45?(a=a.slice(1),i.s=-1):i.s=1,W2e.test(a))xR(i,a);else throw Error(t0+a)}if(s.prototype=pr,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=mH,s.config=s.set=H2e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return s.config(e),s}function H2e(e){if(!e||typeof e!="object")throw Error(Rl+"Object expected");var t,r,n,s=["precision",1,op,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((n=e[r=s[t]])!==void 0)if(lp(n)===n&&n>=s[t+1]&&n<=s[t+2])this[r]=n;else throw Error(t0+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(t0+r+": "+n);return this}var AA=mH(z2e);Xo=new AA(1);const Mn=AA;var G2e=e=>e,pH={},xH=e=>e===pH,vR=e=>function t(){return arguments.length===0||arguments.length===1&&xH(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},yH=(e,t)=>e===1?t:vR(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];var a=n.filter(i=>i!==pH).length;return a>=e?t(...n):yH(e-a,vR(function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];var u=n.map(d=>xH(d)?o.shift():d);return t(...u,...o)}))}),M2=e=>yH(e.length,e),rN=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},V2e=M2((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),K2e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return G2e;var s=r.reverse(),a=s[0],i=s.slice(1);return function(){return i.reduce((o,c)=>c(o),a(...arguments))}},nN=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),vH=e=>{var t=null,r=null;return function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t&&s.every((i,o)=>{var c;return i===((c=t)===null||c===void 0?void 0:c[o])})||(t=s,r=e(...s)),r}};function wH(e){var t;return e===0?t=1:t=Math.floor(new Mn(e).abs().log(10).toNumber())+1,t}function _H(e,t,r){for(var n=new Mn(e),s=0,a=[];n.lt(t)&&s<1e5;)a.push(n.toNumber()),n=n.add(r),s++;return a}M2((e,t,r)=>{var n=+e,s=+t;return n+r*(s-n)});M2((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});M2((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var bH=e=>{var[t,r]=e,[n,s]=[t,r];return t>r&&([n,s]=[r,t]),[n,s]},SH=(e,t,r)=>{if(e.lte(0))return new Mn(0);var n=wH(e.toNumber()),s=new Mn(10).pow(n),a=e.div(s),i=n!==1?.05:.1,o=new Mn(Math.ceil(a.div(i).toNumber())).add(r).mul(i),c=o.mul(s);return t?new Mn(c.toNumber()):new Mn(Math.ceil(c.toNumber()))},q2e=(e,t,r)=>{var n=new Mn(1),s=new Mn(e);if(!s.isint()&&r){var a=Math.abs(e);a<1?(n=new Mn(10).pow(wH(e)-1),s=new Mn(Math.floor(s.div(n).toNumber())).mul(n)):a>1&&(s=new Mn(Math.floor(e)))}else e===0?s=new Mn(Math.floor((t-1)/2)):r||(s=new Mn(Math.floor(e)));var i=Math.floor((t-1)/2),o=K2e(V2e(c=>s.add(new Mn(c-i).mul(n)).toNumber()),rN);return o(0,t)},kH=function(t,r,n,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Mn(0),tickMin:new Mn(0),tickMax:new Mn(0)};var i=SH(new Mn(r).sub(t).div(n-1),s,a),o;t<=0&&r>=0?o=new Mn(0):(o=new Mn(t).add(r).div(2),o=o.sub(new Mn(o).mod(i)));var c=Math.ceil(o.sub(t).div(i).toNumber()),u=Math.ceil(new Mn(r).sub(o).div(i).toNumber()),d=c+u+1;return d>n?kH(t,r,n,s,a+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:i,tickMin:o.sub(new Mn(c).mul(i)),tickMax:o.add(new Mn(u).mul(i))})};function Y2e(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[i,o]=bH([t,r]);if(i===-1/0||o===1/0){var c=o===1/0?[i,...rN(0,n-1).map(()=>1/0)]:[...rN(0,n-1).map(()=>-1/0),o];return t>r?nN(c):c}if(i===o)return q2e(i,n,s);var{step:u,tickMin:d,tickMax:f}=kH(i,o,a,s,0),g=_H(d,f.add(new Mn(.1).mul(u)),u);return t>r?nN(g):g}function X2e(e,t){var[r,n]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,i]=bH([r,n]);if(a===-1/0||i===1/0)return[r,n];if(a===i)return[a];var o=Math.max(t,2),c=SH(new Mn(i).sub(a).div(o-1),s,0),u=[..._H(new Mn(a),new Mn(i),c),i];return s===!1&&(u=u.map(d=>Math.round(d))),r>n?nN(u):u}var Q2e=vH(Y2e),J2e=vH(X2e),Z2e=e=>e.rootProps.barCategoryGap,L2=e=>e.rootProps.stackOffset,jA=e=>e.options.chartName,PA=e=>e.rootProps.syncId,CH=e=>e.rootProps.syncMethod,FA=e=>e.options.eventEmitter,Gu={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Wo={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},B2=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},eSe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Gu.angleAxisId,includeHidden:!1,name:void 0,reversed:Gu.reversed,scale:Gu.scale,tick:Gu.tick,tickCount:void 0,ticks:void 0,type:Gu.type,unit:void 0},tSe={allowDataOverflow:Wo.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Wo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Wo.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Wo.scale,tick:Wo.tick,tickCount:Wo.tickCount,ticks:void 0,type:Wo.type,unit:void 0},rSe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Gu.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Gu.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Gu.scale,tick:Gu.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},nSe={allowDataOverflow:Wo.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Wo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Wo.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Wo.scale,tick:Wo.tick,tickCount:Wo.tickCount,ticks:void 0,type:"category",unit:void 0},OA=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?rSe:eSe,DA=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?nSe:tSe,$2=e=>e.polarOptions,IA=kt([xd,yd,_i],u1e),TH=kt([$2,IA],(e,t)=>{if(e!=null)return Df(e.innerRadius,t,0)}),EH=kt([$2,IA],(e,t)=>{if(e!=null)return Df(e.outerRadius,t,t*.8)}),sSe=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},NH=kt([$2],sSe);kt([OA,NH],B2);var AH=kt([IA,TH,EH],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});kt([DA,AH],B2);var jH=kt([fs,$2,TH,EH,xd,yd],(e,t,r,n,s,a)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:i,cy:o,startAngle:c,endAngle:u}=t;return{cx:Df(i,s,s/2),cy:Df(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),pa=(e,t)=>t,U2=(e,t,r)=>r;function PH(e){return e?.id}var Pa=e=>{var t=fs(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},cp=e=>e.tooltip.settings.axisId,Xa=e=>{var t=Pa(e),r=cp(e);return c1(e,t,r)},FH=kt([Xa],e=>e?.dataKey);function OH(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:s,dataKey:a}=r,i=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=PH(o);u.forEach((f,g)=>{var p=a==null||s?g:String(lo(f,a,null)),x=lo(f,o.dataKey,0),v;i.has(p)?v=i.get(p):v={},Object.assign(v,{[d]:x}),i.set(p,v)})}}),Array.from(i.values())}function RA(e){return e.stackId!=null&&e.dataKey!=null}function wR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Tb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wR(Object(r),!0).forEach(function(n){aSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aSe(e,t,r){return(t=iSe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iSe(e){var t=oSe(e,"string");return typeof t=="symbol"?t:t+""}function oSe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sN=[0,"auto"],Uo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},DH=(e,t)=>e.cartesianAxis.xAxis[t],wd=(e,t)=>{var r=DH(e,t);return r??Uo},zo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:sN,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:s1},IH=(e,t)=>e.cartesianAxis.yAxis[t],_d=(e,t)=>{var r=IH(e,t);return r??zo},lSe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},MA=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??lSe},Fo=(e,t,r)=>{switch(t){case"xAxis":return wd(e,r);case"yAxis":return _d(e,r);case"zAxis":return MA(e,r);case"angleAxis":return OA(e,r);case"radiusAxis":return DA(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},cSe=(e,t,r)=>{switch(t){case"xAxis":return wd(e,r);case"yAxis":return _d(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},c1=(e,t,r)=>{switch(t){case"xAxis":return wd(e,r);case"yAxis":return _d(e,r);case"angleAxis":return OA(e,r);case"radiusAxis":return DA(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},RH=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function MH(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var LH=e=>e.graphicalItems.cartesianItems,uSe=kt([pa,U2],MH),BH=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),u1=kt([LH,Fo,uSe],BH),$H=kt([u1],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(RA)),UH=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),zH=kt([u1],UH),WH=e=>e.map(t=>t.data).filter(Boolean).flat(1),dSe=kt([u1],WH),HH=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:s}=t;return e.length>0?e:r.slice(n,s+1)},LA=kt([dSe,EA],HH),GH=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:lo(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(s=>({value:lo(s,n)}))):e.map(n=>({value:n})),z2=kt([LA,Fo,u1],GH);function VH(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function U0(e){return e.filter(t=>au(t)||t instanceof Date).map(Number).filter(t=>Dl(t)===!1)}function fSe(e,t,r){return!r||typeof t!="number"||Dl(t)?[]:r.length?U0(r.flatMap(n=>{var s=lo(e,n.dataKey),a,i;if(Array.isArray(s)?[a,i]=s:a=i=s,!(!yc(a)||!yc(i)))return[t-a,t+i]})):[]}var hSe=kt([$H,EA,Xa],OH),KH=(e,t,r)=>{var n={},s=t.reduce((a,i)=>(i.stackId==null||(a[i.stackId]==null&&(a[i.stackId]=[]),a[i.stackId].push(i)),a),n);return Object.fromEntries(Object.entries(s).map(a=>{var[i,o]=a,c=o.map(PH);return[i,{stackedData:C1e(e,c,r),graphicalItems:o}]}))},gSe=kt([hSe,$H,L2],KH),qH=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:s}=t;if(r!=="zAxis"){var a=N1e(e,n,s);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},mSe=kt([gSe,qf,pa],qH),YH=(e,t,r,n,s)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var o,c,u=(o=n[i.id])===null||o===void 0?void 0:o.filter(f=>VH(s,f)),d=lo(a,(c=t.dataKey)!==null&&c!==void 0?c:i.dataKey);return{value:d,errorDomain:fSe(a,d,u)}})).filter(Boolean):t?.dataKey!=null?e.map(a=>({value:lo(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),W2=e=>e.errorBars,XH=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>VH(r,n));kt([zH,W2,pa],XH);var pSe=kt([LA,Fo,zH,W2,pa],YH);function xSe(e){var{value:t}=e;if(au(t)||t instanceof Date)return t}var _R=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=U0(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},ySe=(e,t,r)=>{var n=e.map(xSe).filter(s=>s!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&uz(n))?jW(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},BA=e=>{var t;if(e==null||!("domain"in e))return sN;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=U0(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:sN},Eb=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=r.filter(Boolean);if(s.length!==0){var a=s.flat(),i=Math.min(...a),o=Math.max(...a);return[i,o]}},QH=e=>e.referenceElements.dots,up=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),vSe=kt([QH,pa,U2],up),JH=e=>e.referenceElements.areas,wSe=kt([JH,pa,U2],up),ZH=e=>e.referenceElements.lines,_Se=kt([ZH,pa,U2],up),eG=(e,t)=>{var r=U0(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},bSe=kt(vSe,pa,eG),tG=(e,t)=>{var r=U0(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},SSe=kt([wSe,pa],tG),rG=(e,t)=>{var r=U0(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},kSe=kt(_Se,pa,rG),CSe=kt(bSe,kSe,SSe,(e,t,r)=>Eb(e,r,t)),TSe=kt([Fo],BA),nG=(e,t,r,n,s,a,i)=>{var o=$2e(t,e.allowDataOverflow);if(o!=null)return o;var c=a==="vertical"&&i==="xAxis"||a==="horizontal"&&i==="yAxis",u=c?Eb(r,s,_R(n)):Eb(s,_R(n));return U2e(t,u,e.allowDataOverflow)},ESe=kt([Fo,TSe,mSe,pSe,CSe,fs,pa],nG),NSe=[0,1],sG=(e,t,r,n,s,a,i)=>{if(!((e==null||r==null||r.length===0)&&i===void 0)){var{dataKey:o,type:c}=e,u=Gf(t,a);return u&&o==null?jW(0,r.length):c==="category"?ySe(n,e,u):s==="expand"?NSe:i}},$A=kt([Fo,fs,LA,z2,L2,pa,ESe],sG),aG=(e,t,r,n,s)=>{if(e!=null){var{scale:a,type:i}=e;if(a==="auto")return t==="radial"&&s==="radiusAxis"?"band":t==="radial"&&s==="angleAxis"?"linear":i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":i==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(H3(a));return o in py?o:"point"}}},d1=kt([Fo,fs,RH,jA,pa],aG);function ASe(e){if(e!=null){if(e in py)return py[e]();var t="scale".concat(H3(e));if(t in py)return py[t]()}}function UA(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var s=ASe(t);if(s!=null){var a=s.domain(r).range(n);return _1e(a),a}}}var iG=(e,t,r)=>{var n=BA(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Im(e))return Q2e(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Im(e))return J2e(e,t.tickCount,t.allowDecimals)}},zA=kt([$A,c1,d1],iG),oG=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Im(t)&&Array.isArray(r)&&r.length>0){var s=t[0],a=r[0],i=t[1],o=r[r.length-1];return[Math.min(s,a),Math.max(i,o)]}return t},jSe=kt([Fo,$A,zA,pa],oG),PSe=kt(z2,Fo,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(U0(e.map(o=>o.value))).sort((o,c)=>o-c);if(n.length<2)return 1/0;var s=n[n.length-1]-n[0];if(s===0)return 1/0;for(var a=0;a<n.length-1;a++){var i=n[a+1]-n[a];r=Math.min(r,i)}return r/s}}),lG=kt(PSe,fs,Z2e,_i,(e,t,r,n)=>n,(e,t,r,n,s)=>{if(!yc(e))return 0;var a=t==="vertical"?n.height:n.width;if(s==="gap")return e*a/2;if(s==="no-gap"){var i=Df(r,e*a),o=e*a/2;return o-i-(o-i)/a*i}return 0}),FSe=(e,t)=>{var r=wd(e,t);return r==null||typeof r.padding!="string"?0:lG(e,"xAxis",t,r.padding)},OSe=(e,t)=>{var r=_d(e,t);return r==null||typeof r.padding!="string"?0:lG(e,"yAxis",t,r.padding)},DSe=kt(wd,FSe,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:s}=e;return typeof s=="string"?{left:t,right:t}:{left:((r=s.left)!==null&&r!==void 0?r:0)+t,right:((n=s.right)!==null&&n!==void 0?n:0)+t}}),ISe=kt(_d,OSe,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:s}=e;return typeof s=="string"?{top:t,bottom:t}:{top:((r=s.top)!==null&&r!==void 0?r:0)+t,bottom:((n=s.bottom)!==null&&n!==void 0?n:0)+t}}),RSe=kt([_i,DSe,j2,A2,(e,t,r)=>r],(e,t,r,n,s)=>{var{padding:a}=n;return s?[a.left,r.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),MSe=kt([_i,fs,ISe,j2,A2,(e,t,r)=>r],(e,t,r,n,s,a)=>{var{padding:i}=s;return a?[n.height-i.bottom,i.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),f1=(e,t,r,n)=>{var s;switch(t){case"xAxis":return RSe(e,r,n);case"yAxis":return MSe(e,r,n);case"zAxis":return(s=MA(e,r))===null||s===void 0?void 0:s.range;case"angleAxis":return NH(e);case"radiusAxis":return AH(e,r);default:return}},cG=kt([Fo,f1],B2),dp=kt([Fo,d1,jSe,cG],UA);kt([u1,W2,pa],XH);function uG(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var H2=(e,t)=>t,G2=(e,t,r)=>r,LSe=kt(E2,H2,G2,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(uG)),BSe=kt(N2,H2,G2,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(uG)),dG=(e,t)=>({width:e.width,height:t.height}),$Se=(e,t)=>{var r=typeof t.width=="number"?t.width:s1;return{width:r,height:e.height}},USe=kt(_i,wd,dG),zSe=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},WSe=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},HSe=kt(yd,_i,LSe,H2,G2,(e,t,r,n,s)=>{var a={},i;return r.forEach(o=>{var c=dG(t,o);i==null&&(i=zSe(t,n,e));var u=n==="top"&&!s||n==="bottom"&&s;a[o.id]=i-Number(u)*c.height,i+=(u?-1:1)*c.height}),a}),GSe=kt(xd,_i,BSe,H2,G2,(e,t,r,n,s)=>{var a={},i;return r.forEach(o=>{var c=$Se(t,o);i==null&&(i=WSe(t,n,e));var u=n==="left"&&!s||n==="right"&&s;a[o.id]=i-Number(u)*c.width,i+=(u?-1:1)*c.width}),a}),VSe=(e,t)=>{var r=wd(e,t);if(r!=null)return HSe(e,r.orientation,r.mirror)},KSe=kt([_i,wd,VSe,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var s=r?.[n];return s==null?{x:e.left,y:0}:{x:e.left,y:s}}}),qSe=(e,t)=>{var r=_d(e,t);if(r!=null)return GSe(e,r.orientation,r.mirror)},YSe=kt([_i,_d,qSe,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var s=r?.[n];return s==null?{x:0,y:e.top}:{x:s,y:e.top}}}),XSe=kt(_i,_d,(e,t)=>{var r=typeof t.width=="number"?t.width:s1;return{width:r,height:e.height}}),fG=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:s,type:a,dataKey:i}=r,o=Gf(e,n),c=t.map(u=>u.value);if(i&&o&&a==="category"&&s&&uz(c))return c}},WA=kt([fs,z2,Fo,pa],fG),hG=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:s,scale:a}=r,i=Gf(e,n);if(i&&(s==="number"||a!=="auto"))return t.map(o=>o.value)}},HA=kt([fs,z2,c1,pa],hG),bR=kt([fs,cSe,d1,dp,WA,HA,f1,zA,pa],(e,t,r,n,s,a,i,o,c)=>{if(t==null)return null;var u=Gf(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:a,duplicateDomain:s,isCategorical:u,niceTicks:o,range:i,realScaleType:r,scale:n}}),QSe=(e,t,r,n,s,a,i,o,c)=>{if(!(t==null||n==null)){var u=Gf(e,c),{type:d,ticks:f,tickCount:g}=t,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=d==="category"&&n.bandwidth?n.bandwidth()/p:0;x=c==="angleAxis"&&a!=null&&a.length>=2?El(a[0]-a[1])*2*x:x;var v=f||s;if(v){var w=v.map((C,k)=>{var _=i?i.indexOf(C):C;return{index:k,coordinate:n(_)+x,value:C,offset:x}});return w.filter(C=>!Dl(C.coordinate))}return u&&o?o.map((C,k)=>({coordinate:n(C)+x,value:C,index:k,offset:x})):n.ticks?n.ticks(g).map(C=>({coordinate:n(C)+x,value:C,offset:x})):n.domain().map((C,k)=>({coordinate:n(C)+x,value:i?i[C]:C,index:k,offset:x}))}},gG=kt([fs,c1,d1,dp,zA,f1,WA,HA,pa],QSe),JSe=(e,t,r,n,s,a,i)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=Gf(e,i),{tickCount:c}=t,u=0;return u=i==="angleAxis"&&n?.length>=2?El(n[0]-n[1])*2*u:u,o&&a?a.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:s?s[d]:d,index:f,offset:u}))}},mG=kt([fs,c1,dp,f1,WA,HA,pa],JSe),pG=kt(Fo,dp,(e,t)=>{if(!(e==null||t==null))return Tb(Tb({},e),{},{scale:t})}),ZSe=kt([Fo,d1,$A,cG],UA);kt((e,t,r)=>MA(e,r),ZSe,(e,t)=>{if(!(e==null||t==null))return Tb(Tb({},e),{},{scale:t})});var eke=kt([fs,E2,N2],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),xG=e=>e.options.defaultTooltipEventType,yG=e=>e.options.validateTooltipEventTypes;function vG(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function GA(e,t){var r=xG(e),n=yG(e);return vG(t,r,n)}function tke(e){return Pr(t=>GA(t,e))}var wG=(e,t)=>{var r,n=Number(t);if(!(Dl(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},rke=e=>e.tooltip.settings,hf={active:!1,index:null,dataKey:void 0,coordinate:void 0},nke={itemInteraction:{click:hf,hover:hf},axisInteraction:{click:hf,hover:hf},keyboardInteraction:hf,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},_G=rl({name:"tooltip",initialState:nke,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=td(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:ske,removeTooltipEntrySettings:ake,setTooltipSettingsState:ike,setActiveMouseOverItemIndex:oke,mouseLeaveItem:Z3e,mouseLeaveChart:bG,setActiveClickItemIndex:eAe,setMouseOverAxisIndex:SG,setMouseClickAxisIndex:lke,setSyncInteraction:aN,setKeyboardInteraction:iN}=_G.actions,cke=_G.reducer;function SR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Jw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SR(Object(r),!0).forEach(function(n){uke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uke(e,t,r){return(t=dke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dke(e){var t=fke(e,"string");return typeof t=="symbol"?t:t+""}function fke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hke(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function gke(e){return e.index!=null}var kG=(e,t,r,n)=>{if(t==null)return hf;var s=hke(e,t,r);if(s==null)return hf;if(s.active)return s;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(gke(s)){if(a)return Jw(Jw({},s),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Jw(Jw({},hf),{},{coordinate:s.coordinate})},VA=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!yc(n))return r;var s=0,a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(s,Math.min(n,a)))},CG=(e,t,r,n,s,a,i,o)=>{if(!(a==null||o==null)){var c=i[0],u=c==null?void 0:o(c.positions,a);if(u!=null)return u;var d=s?.[Number(a)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},TG=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var s;return r==="hover"?s=e.itemInteraction.hover.dataKey:s=e.itemInteraction.click.dataKey,s==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(a=>{var i;return((i=a.settings)===null||i===void 0?void 0:i.dataKey)===s})},h1=e=>e.options.tooltipPayloadSearcher,fp=e=>e.tooltip;function kR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function CR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kR(Object(r),!0).forEach(function(n){mke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mke(e,t,r){return(t=pke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pke(e){var t=xke(e,"string");return typeof t=="symbol"?t:t+""}function xke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yke(e,t){return e??t}var EG=(e,t,r,n,s,a,i)=>{if(!(t==null||a==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((g,p)=>{var x,{dataDefinedOnItem:v,settings:w}=p,C=yke(v,o),k=Array.isArray(C)?dW(C,u,d):C,_=(x=w?.dataKey)!==null&&x!==void 0?x:n,N=w?.nameKey,E;if(n&&Array.isArray(k)&&!Array.isArray(k[0])&&i==="axis"?E=dz(k,n,s):E=a(k,t,c,N),Array.isArray(E))E.forEach(F=>{var A=CR(CR({},w),{},{name:F.name,unit:F.unit,color:void 0,fill:void 0});g.push(uI({tooltipEntrySettings:A,dataKey:F.dataKey,payload:F.payload,value:lo(F.payload,F.dataKey),name:F.name}))});else{var P;g.push(uI({tooltipEntrySettings:w,dataKey:_,payload:E,value:lo(E,_),name:(P=lo(E,N))!==null&&P!==void 0?P:w?.name}))}return g},f)}},KA=kt([Xa,fs,RH,jA,Pa],aG),vke=kt([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),wke=kt([Pa,cp],MH),g1=kt([vke,Xa,wke],BH),_ke=kt([g1],e=>e.filter(RA)),bke=kt([g1],WH),hp=kt([bke,qf],HH),Ske=kt([_ke,qf,Xa],OH),qA=kt([hp,Xa,g1],GH),kke=kt([Xa],BA),Cke=kt([g1],e=>e.filter(RA)),Tke=kt([Ske,Cke,L2],KH),Eke=kt([Tke,qf,Pa],qH),Nke=kt([g1],UH),Ake=kt([hp,Xa,Nke,W2,Pa],YH),jke=kt([QH,Pa,cp],up),Pke=kt([jke,Pa],eG),Fke=kt([JH,Pa,cp],up),Oke=kt([Fke,Pa],tG),Dke=kt([ZH,Pa,cp],up),Ike=kt([Dke,Pa],rG),Rke=kt([Pke,Ike,Oke],Eb),Mke=kt([Xa,kke,Eke,Ake,Rke,fs,Pa],nG),NG=kt([Xa,fs,hp,qA,L2,Pa,Mke],sG),Lke=kt([NG,Xa,KA],iG),Bke=kt([Xa,NG,Lke,Pa],oG),AG=e=>{var t=Pa(e),r=cp(e),n=!1;return f1(e,t,r,n)},jG=kt([Xa,AG],B2),PG=kt([Xa,KA,Bke,jG],UA),$ke=kt([fs,qA,Xa,Pa],fG),Uke=kt([fs,qA,Xa,Pa],hG),zke=(e,t,r,n,s,a,i,o)=>{if(t){var{type:c}=t,u=Gf(e,o);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=o==="angleAxis"&&s!=null&&s?.length>=2?El(s[0]-s[1])*2*f:f,u&&i?i.map((g,p)=>({coordinate:n(g)+f,value:g,index:p,offset:f})):n.domain().map((g,p)=>({coordinate:n(g)+f,value:a?a[g]:g,index:p,offset:f}))}}},bd=kt([fs,Xa,KA,PG,AG,$ke,Uke,Pa],zke),YA=kt([xG,yG,rke],(e,t,r)=>vG(r.shared,e,t)),FG=e=>e.tooltip.settings.trigger,XA=e=>e.tooltip.settings.defaultIndex,V2=kt([fp,YA,FG,XA],kG),Cv=kt([V2,hp],VA),OG=kt([bd,Cv],wG),Wke=kt([V2],e=>{if(e)return e.dataKey}),DG=kt([fp,YA,FG,XA],TG),Hke=kt([xd,yd,fs,_i,bd,XA,DG,h1],CG),Gke=kt([V2,Hke],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Vke=kt([V2],e=>e.active),Kke=kt([DG,Cv,qf,FH,OG,h1,YA],EG),qke=kt([Kke],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function TR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ER(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TR(Object(r),!0).forEach(function(n){Yke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yke(e,t,r){return(t=Xke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xke(e){var t=Qke(e,"string");return typeof t=="symbol"?t:t+""}function Qke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jke=()=>Pr(Xa),Zke=()=>{var e=Jke(),t=Pr(bd),r=Pr(PG);return zE(ER(ER({},e),{},{scale:r}),t)},eCe=()=>Pr(jA),QA=(e,t)=>t,IG=(e,t,r)=>r,JA=(e,t,r,n)=>n,tCe=kt(bd,e=>_2(e,t=>t.coordinate)),ZA=kt([fp,QA,IG,JA],kG),RG=kt([ZA,hp],VA),rCe=(e,t,r)=>{if(t!=null){var n=fp(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},MG=kt([fp,QA,IG,JA],TG),Nb=kt([xd,yd,fs,_i,bd,JA,MG,h1],CG),nCe=kt([ZA,Nb],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),LG=kt(bd,RG,wG),sCe=kt([MG,RG,qf,FH,LG,h1,QA],EG),aCe=kt([ZA],e=>({isActive:e.active,activeIndex:e.index})),iCe=(e,t,r,n,s,a,i,o)=>{if(!(!e||!t||!n||!s||!a)){var c=A1e(e.chartX,e.chartY,t,r,o);if(c){var u=P1e(c,t),d=v1e(u,i,a,n,s),f=j1e(t,a,d,c);return{activeIndex:String(d),activeCoordinate:f}}}};function oN(){return oN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oN.apply(null,arguments)}function NR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Zw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NR(Object(r),!0).forEach(function(n){oCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oCe(e,t,r){return(t=lCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lCe(e){var t=cCe(e,"string");return typeof t=="symbol"?t:t+""}function cCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uCe(e){var{coordinate:t,payload:r,index:n,offset:s,tooltipAxisBandSize:a,layout:i,cursor:o,tooltipEventType:c,chartName:u}=e,d=t,f=r,g=n;if(!o||!d||u!=="ScatterChart"&&c!=="axis")return null;var p,x;if(u==="ScatterChart")p=d,x=bwe;else if(u==="BarChart")p=Swe(i,d,s,a),x=e_e;else if(i==="radial"){var{cx:v,cy:w,radius:C,startAngle:k,endAngle:_}=NW(d);p={cx:v,cy:w,startAngle:k,endAngle:_,innerRadius:C,outerRadius:C},x=s_e}else p={points:a_e(i,d,s)},x=bW;var N=typeof o=="object"&&"className"in o?o.className:void 0,E=Zw(Zw(Zw(Zw({stroke:"#ccc",pointerEvents:"none"},s),p),wi(o,!1)),{},{payload:f,payloadIndex:g,className:us("recharts-tooltip-cursor",N)});return S.isValidElement(o)?S.cloneElement(o,E):S.createElement(x,E)}function dCe(e){var t=Zke(),r=xW(),n=nA(),s=eCe();return S.createElement(uCe,oN({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:s}))}var BG=S.createContext(null),fCe=()=>S.useContext(BG),XC={exports:{}},AR;function hCe(){return AR||(AR=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function a(c,u,d,f,g){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new s(d,f||c,g),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],p]:c._events[x].push(p):(c._events[x]=p,c._eventsCount++),c}function i(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var g=0,p=f.length,x=new Array(p);g<p;g++)x[g]=f[g].fn;return x},o.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,d,f,g,p,x){var v=r?r+u:u;if(!this._events[v])return!1;var w=this._events[v],C=arguments.length,k,_;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),C){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,d),!0;case 3:return w.fn.call(w.context,d,f),!0;case 4:return w.fn.call(w.context,d,f,g),!0;case 5:return w.fn.call(w.context,d,f,g,p),!0;case 6:return w.fn.call(w.context,d,f,g,p,x),!0}for(_=1,k=new Array(C-1);_<C;_++)k[_-1]=arguments[_];w.fn.apply(w.context,k)}else{var N=w.length,E;for(_=0;_<N;_++)switch(w[_].once&&this.removeListener(u,w[_].fn,void 0,!0),C){case 1:w[_].fn.call(w[_].context);break;case 2:w[_].fn.call(w[_].context,d);break;case 3:w[_].fn.call(w[_].context,d,f);break;case 4:w[_].fn.call(w[_].context,d,f,g);break;default:if(!k)for(E=1,k=new Array(C-1);E<C;E++)k[E-1]=arguments[E];w[_].fn.apply(w[_].context,k)}}return!0},o.prototype.on=function(u,d,f){return a(this,u,d,f,!1)},o.prototype.once=function(u,d,f){return a(this,u,d,f,!0)},o.prototype.removeListener=function(u,d,f,g){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return i(this,p),this;var x=this._events[p];if(x.fn)x.fn===d&&(!g||x.once)&&(!f||x.context===f)&&i(this,p);else{for(var v=0,w=[],C=x.length;v<C;v++)(x[v].fn!==d||g&&!x[v].once||f&&x[v].context!==f)&&w.push(x[v]);w.length?this._events[p]=w.length===1?w[0]:w:i(this,p)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&i(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(XC)),XC.exports}var gCe=hCe();const mCe=Ml(gCe);var Tv=new mCe,lN="recharts.syncEvent.tooltip",jR="recharts.syncEvent.brush";function pCe(e,t){if(t){var r=Number.parseInt(t,10);if(!Dl(r))return e?.[r]}}var xCe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},$G=rl({name:"options",initialState:xCe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),yCe=$G.reducer,{createEventEmitter:vCe}=$G.actions;function wCe(e){return e.tooltip.syncInteraction}var _Ce={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},UG=rl({name:"chartData",initialState:_Ce,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:PR,setDataStartEndIndexes:bCe,setComputedData:tAe}=UG.actions,SCe=UG.reducer,kCe=["x","y"];function FR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Eh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FR(Object(r),!0).forEach(function(n){CCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CCe(e,t,r){return(t=TCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TCe(e){var t=ECe(e,"string");return typeof t=="symbol"?t:t+""}function ECe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NCe(e,t){if(e==null)return{};var r,n,s=ACe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function ACe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var zG=()=>{};function jCe(){var e=Pr(PA),t=Pr(FA),r=uo(),n=Pr(CH),s=Pr(bd),a=nA(),i=rA(),o=Pr(c=>c.rootProps.className);S.useEffect(()=>{if(e==null)return zG;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var g;if(i&&d!==null&&d!==void 0&&(g=d.payload)!==null&&g!==void 0&&g.coordinate){var p=d.payload.coordinate,{x,y:v}=p,w=NCe(p,kCe),C=Eh(Eh(Eh({},w),typeof x=="number"&&{x:Math.max(i.x,Math.min(x,i.x+i.width))}),typeof v=="number"&&{y:Math.max(i.y,Math.min(v,i.y+i.height))}),k=Eh(Eh({},d),{},{payload:Eh(Eh({},d.payload),{},{coordinate:C})});r(k)}else r(d);return}if(s!=null){var _;if(typeof n=="function"){var N={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},E=n(s,N);_=s[E]}else n==="value"&&(_=s.find(Z=>String(Z.value)===d.payload.label));var{coordinate:P}=d.payload;if(_==null||d.payload.active===!1||P==null||i==null){r(aN({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:F,y:A}=P,j=Math.min(F,i.x+i.width),I=Math.min(A,i.y+i.height),B={x:a==="horizontal"?_.coordinate:j,y:a==="horizontal"?I:_.coordinate},Y=aN({active:d.payload.active,coordinate:B,dataKey:d.payload.dataKey,index:String(_.index),label:d.payload.label});r(Y)}}};return Tv.on(lN,c),()=>{Tv.off(lN,c)}},[o,r,t,e,n,s,a,i])}function PCe(){var e=Pr(PA),t=Pr(FA),r=uo();S.useEffect(()=>{if(e==null)return zG;var n=(s,a,i)=>{t!==i&&e===s&&r(bCe(a))};return Tv.on(jR,n),()=>{Tv.off(jR,n)}},[r,t,e])}function FCe(){var e=uo();S.useEffect(()=>{e(vCe())},[e]),jCe(),PCe()}function OCe(e,t,r,n,s,a){var i=Pr(g=>rCe(g,e,t)),o=Pr(FA),c=Pr(PA),u=Pr(CH),d=Pr(wCe),f=d?.active;S.useEffect(()=>{if(!f&&c!=null&&o!=null){var g=aN({active:a,coordinate:r,dataKey:i,index:s,label:typeof n=="number"?String(n):n});Tv.emit(lN,c,g,o)}},[f,r,i,s,n,o,c,u,a])}function OR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function DR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OR(Object(r),!0).forEach(function(n){DCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DCe(e,t,r){return(t=ICe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ICe(e){var t=RCe(e,"string");return typeof t=="symbol"?t:t+""}function RCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MCe(e){return e.dataKey}function LCe(e,t){return S.isValidElement(e)?S.cloneElement(e,t):typeof e=="function"?S.createElement(e,t):S.createElement(ewe,t)}var IR=[],BCe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!ap.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function $Ce(e){var t=$l(e,BCe),{active:r,allowEscapeViewBox:n,animationDuration:s,animationEasing:a,content:i,filterNull:o,isAnimationActive:c,offset:u,payloadUniqBy:d,position:f,reverseDirection:g,useTranslate3d:p,wrapperStyle:x,cursor:v,shared:w,trigger:C,defaultIndex:k,portal:_,axisId:N}=t,E=uo(),P=typeof k=="number"?String(k):k;S.useEffect(()=>{E(ike({shared:w,trigger:C,axisId:N,active:r,defaultIndex:P}))},[E,w,C,N,r,P]);var F=rA(),A=_W(),j=tke(w),{activeIndex:I,isActive:B}=Pr(Q=>aCe(Q,j,C,P)),Y=Pr(Q=>sCe(Q,j,C,P)),Z=Pr(Q=>LG(Q,j,C,P)),se=Pr(Q=>nCe(Q,j,C,P)),ee=Y,te=fCe(),L=r??B,[V,M]=lve([ee,L]),H=j==="axis"?Z:void 0;OCe(j,C,se,H,I,L);var W=_??te;if(W==null)return null;var R=ee??IR;L||(R=IR),o&&R.length&&(R=Dye(ee.filter(Q=>Q.value!=null&&(Q.hide!==!0||t.includeHidden)),d,MCe));var z=R.length>0,K=S.createElement(owe,{allowEscapeViewBox:n,animationDuration:s,animationEasing:a,isAnimationActive:c,active:L,coordinate:se,hasPayload:z,offset:u,position:f,reverseDirection:g,useTranslate3d:p,viewBox:F,wrapperStyle:x,lastBoundingBox:V,innerRef:M,hasPortalFromProps:!!_},LCe(i,DR(DR({},t),{},{payload:R,label:H,active:L,coordinate:se,accessibilityLayer:A})));return S.createElement(S.Fragment,null,dT.createPortal(K,W),L&&S.createElement(dCe,{cursor:v,tooltipEventType:j,coordinate:se,payload:ee,index:I}))}var QC={},JC={},ZC={},RR;function UCe(){return RR||(RR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:s,edges:a}={}){let i,o=null;const c=a!=null&&a.includes("leading"),u=a==null||a.includes("trailing"),d=()=>{o!==null&&(r.apply(i,o),i=void 0,o=null)},f=()=>{u&&d(),v()};let g=null;const p=()=>{g!=null&&clearTimeout(g),g=setTimeout(()=>{g=null,f()},n)},x=()=>{g!==null&&(clearTimeout(g),g=null)},v=()=>{x(),i=void 0,o=null},w=()=>{d()},C=function(...k){if(s?.aborted)return;i=this,o=k;const _=g==null;p(),c&&_&&d()};return C.schedule=p,C.cancel=v,C.flush=w,s?.addEventListener("abort",v,{once:!0}),C}e.debounce=t})(ZC)),ZC}var MR;function zCe(){return MR||(MR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UCe();function r(n,s=0,a={}){typeof a!="object"&&(a={});const{leading:i=!1,trailing:o=!0,maxWait:c}=a,u=Array(2);i&&(u[0]="leading"),o&&(u[1]="trailing");let d,f=null;const g=t.debounce(function(...v){d=n.apply(this,v),f=null},s,{edges:u}),p=function(...v){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,v),f=Date.now(),g.cancel(),g.schedule(),d):(g.apply(this,v),d)},x=()=>(g.flush(),d);return p.cancel=g.cancel,p.flush=x,p}e.debounce=r})(JC)),JC}var LR;function WCe(){return LR||(LR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zCe();function r(n,s=0,a={}){const{leading:i=!0,trailing:o=!0}=a;return t.debounce(n,s,{leading:i,maxWait:s,trailing:o})}e.throttle=r})(QC)),QC}var eT,BR;function HCe(){return BR||(BR=1,eT=WCe().throttle),eT}var GCe=HCe();const VCe=Ml(GCe);var Iy=function(t,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a]};function $R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function tT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$R(Object(r),!0).forEach(function(n){KCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$R(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KCe(e,t,r){return(t=qCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qCe(e){var t=YCe(e,"string");return typeof t=="symbol"?t:t+""}function YCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XCe=S.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:s="100%",height:a="100%",minWidth:i=0,minHeight:o,maxHeight:c,children:u,debounce:d=0,id:f,className:g,onResize:p,style:x={}}=e,v=S.useRef(null),w=S.useRef();w.current=p,S.useImperativeHandle(t,()=>v.current);var[C,k]=S.useState({containerWidth:n.width,containerHeight:n.height}),_=S.useCallback((E,P)=>{k(F=>{var A=Math.round(E),j=Math.round(P);return F.containerWidth===A&&F.containerHeight===j?F:{containerWidth:A,containerHeight:j}})},[]);S.useEffect(()=>{var E=j=>{var I,{width:B,height:Y}=j[0].contentRect;_(B,Y),(I=w.current)===null||I===void 0||I.call(w,B,Y)};d>0&&(E=VCe(E,d,{trailing:!0,leading:!1}));var P=new ResizeObserver(E),{width:F,height:A}=v.current.getBoundingClientRect();return _(F,A),P.observe(v.current),()=>{P.disconnect()}},[_,d]);var N=S.useMemo(()=>{var{containerWidth:E,containerHeight:P}=C;if(E<0||P<0)return null;Iy(Lh(s)||Lh(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,a),Iy(!r||r>0,"The aspect(%s) must be greater than zero.",r);var F=Lh(s)?E:s,A=Lh(a)?P:a;return r&&r>0&&(F?A=F/r:A&&(F=A*r),c&&A>c&&(A=c)),Iy(F>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,A,s,a,i,o,r),S.Children.map(u,j=>S.cloneElement(j,{width:F,height:A,style:tT({width:F,height:A},j.props.style)}))},[r,u,a,c,o,i,C,s]);return S.createElement("div",{id:f?"".concat(f):void 0,className:us("recharts-responsive-container",g),style:tT(tT({},x),{},{width:s,height:a,minWidth:i,minHeight:o,maxHeight:c}),ref:v},S.createElement("div",{style:{width:0,height:0,overflow:"visible"}},N))});function QCe(e,t,r){return(t=JCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JCe(e){var t=ZCe(e,"string");return typeof t=="symbol"?t:t+""}function ZCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class eTe{constructor(t){QCe(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function UR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function tTe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UR(Object(r),!0).forEach(function(n){rTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rTe(e,t,r){return(t=nTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nTe(e){var t=sTe(e,"string");return typeof t=="symbol"?t:t+""}function sTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aTe={cacheSize:2e3,enableCache:!0},WG=tTe({},aTe),zR=new eTe(WG.cacheSize),iTe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},WR="recharts_measurement_span";function oTe(e,t){var r=t.fontSize||"",n=t.fontFamily||"",s=t.fontWeight||"",a=t.fontStyle||"",i=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(s,"|").concat(a,"|").concat(i,"|").concat(o)}var HR=(e,t)=>{try{var r=document.getElementById(WR);r||(r=document.createElement("span"),r.setAttribute("id",WR),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,iTe,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Ry=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||ap.isSsr)return{width:0,height:0};if(!WG.enableCache)return HR(t,r);var n=oTe(t,r),s=zR.get(n);if(s)return s;var a=HR(t,r);return zR.set(n,a),a},GR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,VR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,lTe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,cTe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,HG={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},uTe=Object.keys(HG),sm="NaN";function dTe(e,t){return e*HG[t]}class So{static parse(t){var r,[,n,s]=(r=cTe.exec(t))!==null&&r!==void 0?r:[];return new So(parseFloat(n),s??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Dl(t)&&(this.unit=""),r!==""&&!lTe.test(r)&&(this.num=NaN,this.unit=""),uTe.includes(r)&&(this.num=dTe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new So(NaN,""):new So(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new So(NaN,""):new So(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new So(NaN,""):new So(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new So(NaN,""):new So(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Dl(this.num)}}function GG(e){if(e.includes(sm))return sm;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,s,a]=(r=GR.exec(t))!==null&&r!==void 0?r:[],i=So.parse(n??""),o=So.parse(a??""),c=s==="*"?i.multiply(o):i.divide(o);if(c.isNaN())return sm;t=t.replace(GR,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,g]=(u=VR.exec(t))!==null&&u!==void 0?u:[],p=So.parse(d??""),x=So.parse(g??""),v=f==="+"?p.add(x):p.subtract(x);if(v.isNaN())return sm;t=t.replace(VR,v.toString())}return t}var KR=/\(([^()]*)\)/;function fTe(e){for(var t=e,r;(r=KR.exec(t))!=null;){var[,n]=r;t=t.replace(KR,GG(n))}return t}function hTe(e){var t=e.replace(/\s+/g,"");return t=fTe(t),t=GG(t),t}function gTe(e){try{return hTe(e)}catch{return sm}}function rT(e){var t=gTe(e.slice(5,-1));return t===sm?"":t}var mTe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],pTe=["dx","dy","angle","className","breakAll"];function cN(){return cN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cN.apply(null,arguments)}function qR(e,t){if(e==null)return{};var r,n,s=xTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function xTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var VG=/[ \f\n\r\t\v\u2028\u2029]+/,KG=e=>{var{children:t,breakAll:r,style:n}=e;try{var s=[];Ka(t)||(r?s=t.toString().split(""):s=t.toString().split(VG));var a=s.map(o=>({word:o,width:Ry(o,n).width})),i=r?0:Ry("",n).width;return{wordsWithComputedWidth:a,spaceWidth:i}}catch{return null}},yTe=(e,t,r,n,s)=>{var{maxLines:a,children:i,style:o,breakAll:c}=e,u=$r(a),d=i,f=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return B.reduce((Y,Z)=>{var{word:se,width:ee}=Z,te=Y[Y.length-1];if(te&&(n==null||s||te.width+ee+r<Number(n)))te.words.push(se),te.width+=ee+r;else{var L={words:[se],width:ee};Y.push(L)}return Y},[])},g=f(t),p=I=>I.reduce((B,Y)=>B.width>Y.width?B:Y);if(!u||s)return g;var x=g.length>a||p(g).width>Number(n);if(!x)return g;for(var v="",w=I=>{var B=d.slice(0,I),Y=KG({breakAll:c,style:o,children:B+v}).wordsWithComputedWidth,Z=f(Y),se=Z.length>a||p(Z).width>Number(n);return[se,Z]},C=0,k=d.length-1,_=0,N;C<=k&&_<=d.length-1;){var E=Math.floor((C+k)/2),P=E-1,[F,A]=w(P),[j]=w(E);if(!F&&!j&&(C=E+1),F&&j&&(k=E-1),!F&&j){N=A;break}_++}return N||g},YR=e=>{var t=Ka(e)?[]:e.toString().split(VG);return[{words:t}]},vTe=e=>{var{width:t,scaleToFit:r,children:n,style:s,breakAll:a,maxLines:i}=e;if((t||r)&&!ap.isSsr){var o,c,u=KG({breakAll:a,children:n,style:s});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;o=d,c=f}else return YR(n);return yTe({breakAll:a,children:n,maxLines:i,style:s},o,c,t,r)}return YR(n)},XR="#808080",ej=S.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:s="1em",capHeight:a="0.71em",scaleToFit:i=!1,textAnchor:o="start",verticalAnchor:c="end",fill:u=XR}=e,d=qR(e,mTe),f=S.useMemo(()=>vTe({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:i,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,i,d.style,d.width]),{dx:g,dy:p,angle:x,className:v,breakAll:w}=d,C=qR(d,pTe);if(!au(r)||!au(n)||f.length===0)return null;var k=r+($r(g)?g:0),_=n+($r(p)?p:0),N;switch(c){case"start":N=rT("calc(".concat(a,")"));break;case"middle":N=rT("calc(".concat((f.length-1)/2," * -").concat(s," + (").concat(a," / 2))"));break;default:N=rT("calc(".concat(f.length-1," * -").concat(s,")"));break}var E=[];if(i){var P=f[0].width,{width:F}=d;E.push("scale(".concat($r(F)?F/P:1,")"))}return x&&E.push("rotate(".concat(x,", ").concat(k,", ").concat(_,")")),E.length&&(C.transform=E.join(" ")),S.createElement("text",cN({},wi(C,!0),{ref:t,x:k,y:_,className:us("recharts-text",v),textAnchor:o,fill:u.includes("url")?XR:u}),f.map((A,j)=>{var I=A.words.join(w?"":" ");return S.createElement("tspan",{x:k,dy:j===0?N:s,key:"".concat(I,"-").concat(j)},I)}))});ej.displayName="Text";var wTe=["labelRef"];function _Te(e,t){if(e==null)return{};var r,n,s=bTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function bTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function QR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Js(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QR(Object(r),!0).forEach(function(n){STe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function STe(e,t,r){return(t=kTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kTe(e){var t=CTe(e,"string");return typeof t=="symbol"?t:t+""}function CTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vu(){return Vu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vu.apply(null,arguments)}var qG=S.createContext(null),TTe=e=>{var{x:t,y:r,width:n,height:s,children:a}=e,i=S.useMemo(()=>({x:t,y:r,width:n,height:s}),[t,r,n,s]);return S.createElement(qG.Provider,{value:i},a)},YG=()=>{var e=S.useContext(qG),t=rA();return e||t},ETe=S.createContext(null),NTe=()=>{var e=S.useContext(ETe),t=Pr(jH);return e||t},ATe=e=>{var{value:t,formatter:r}=e,n=Ka(e.children)?t:e.children;return typeof r=="function"?r(n):n},tj=e=>e!=null&&typeof e=="function",jTe=(e,t)=>{var r=El(t-e),n=Math.min(Math.abs(t-e),360);return r*n},PTe=(e,t,r,n,s)=>{var{offset:a,className:i}=e,{cx:o,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:g,clockWise:p}=s,x=(u+d)/2,v=jTe(f,g),w=v>=0?1:-1,C,k;switch(t){case"insideStart":C=f+w*a,k=p;break;case"insideEnd":C=g-w*a,k=!p;break;case"end":C=g+w*a,k=p;break;default:throw new Error("Unsupported position ".concat(t))}k=v<=0?k:!k;var _=xi(o,c,x,C),N=xi(o,c,x,C+(k?1:-1)*359),E="M".concat(_.x,",").concat(_.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(k?0:1,`,
    `).concat(N.x,",").concat(N.y),P=Ka(e.id)?pv("recharts-radial-line-"):e.id;return S.createElement("text",Vu({},n,{dominantBaseline:"central",className:us("recharts-radial-bar-label",i)}),S.createElement("defs",null,S.createElement("path",{id:P,d:E})),S.createElement("textPath",{xlinkHref:"#".concat(P)},r))},FTe=(e,t,r)=>{var{cx:n,cy:s,innerRadius:a,outerRadius:i,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:d,y:f}=xi(n,s,i+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"end"};var g=(a+i)/2,{x:p,y:x}=xi(n,s,g,u);return{x:p,y:x,textAnchor:"middle",verticalAnchor:"middle"}},XG=e=>"cx"in e&&$r(e.cx),OTe=(e,t)=>{var{parentViewBox:r,offset:n,position:s}=e,a;r!=null&&!XG(r)&&(a=r);var{x:i,y:o,width:c,height:u}=t,d=u>=0?1:-1,f=d*n,g=d>0?"end":"start",p=d>0?"start":"end",x=c>=0?1:-1,v=x*n,w=x>0?"end":"start",C=x>0?"start":"end";if(s==="top"){var k={x:i+c/2,y:o-d*n,textAnchor:"middle",verticalAnchor:g};return Js(Js({},k),a?{height:Math.max(o-a.y,0),width:c}:{})}if(s==="bottom"){var _={x:i+c/2,y:o+u+f,textAnchor:"middle",verticalAnchor:p};return Js(Js({},_),a?{height:Math.max(a.y+a.height-(o+u),0),width:c}:{})}if(s==="left"){var N={x:i-v,y:o+u/2,textAnchor:w,verticalAnchor:"middle"};return Js(Js({},N),a?{width:Math.max(N.x-a.x,0),height:u}:{})}if(s==="right"){var E={x:i+c+v,y:o+u/2,textAnchor:C,verticalAnchor:"middle"};return Js(Js({},E),a?{width:Math.max(a.x+a.width-E.x,0),height:u}:{})}var P=a?{width:c,height:u}:{};return s==="insideLeft"?Js({x:i+v,y:o+u/2,textAnchor:C,verticalAnchor:"middle"},P):s==="insideRight"?Js({x:i+c-v,y:o+u/2,textAnchor:w,verticalAnchor:"middle"},P):s==="insideTop"?Js({x:i+c/2,y:o+f,textAnchor:"middle",verticalAnchor:p},P):s==="insideBottom"?Js({x:i+c/2,y:o+u-f,textAnchor:"middle",verticalAnchor:g},P):s==="insideTopLeft"?Js({x:i+v,y:o+f,textAnchor:C,verticalAnchor:p},P):s==="insideTopRight"?Js({x:i+c-v,y:o+f,textAnchor:w,verticalAnchor:p},P):s==="insideBottomLeft"?Js({x:i+v,y:o+u-f,textAnchor:C,verticalAnchor:g},P):s==="insideBottomRight"?Js({x:i+c-v,y:o+u-f,textAnchor:w,verticalAnchor:g},P):s&&typeof s=="object"&&($r(s.x)||Lh(s.x))&&($r(s.y)||Lh(s.y))?Js({x:i+Df(s.x,c),y:o+Df(s.y,u),textAnchor:"end",verticalAnchor:"end"},P):Js({x:i+c/2,y:o+u/2,textAnchor:"middle",verticalAnchor:"middle"},P)},DTe={offset:5};function ff(e){var t=$l(e,DTe),{viewBox:r,position:n,value:s,children:a,content:i,className:o="",textBreakAll:c,labelRef:u}=t,d=NTe(),f=YG(),g=n==="center"?f:d??f,p=r||g;if(!p||Ka(s)&&Ka(a)&&!S.isValidElement(i)&&typeof i!="function")return null;var x=Js(Js({},t),{},{viewBox:p});if(S.isValidElement(i)){var{labelRef:v}=x,w=_Te(x,wTe);return S.cloneElement(i,w)}var C;if(typeof i=="function"){if(C=S.createElement(i,x),S.isValidElement(C))return C}else C=ATe(t);var k=XG(p),_=wi(t,!0);if(k&&(n==="insideStart"||n==="insideEnd"||n==="end"))return PTe(t,n,C,_,p);var N=k?FTe(p,t.offset,t.position):OTe(t,p);return S.createElement(ej,Vu({ref:u,className:us("recharts-label",o)},_,N,{breakAll:c}),C)}ff.displayName="Label";var ITe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?S.createElement(ff,Vu({key:"label-implicit"},n)):au(e)?S.createElement(ff,Vu({key:"label-implicit",value:e},n)):S.isValidElement(e)?e.type===ff?S.cloneElement(e,Js({key:"label-implicit"},n)):S.createElement(ff,Vu({key:"label-implicit",content:e},n)):tj(e)?S.createElement(ff,Vu({key:"label-implicit",content:e},n)):e&&typeof e=="object"?S.createElement(ff,Vu({},e,{key:"label-implicit"},n)):null};function RTe(e){var{label:t}=e,r=YG();return ITe(t,r)||null}var nT={},sT={},JR;function MTe(){return JR||(JR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(sT)),sT}var aT={},ZR;function LTe(){return ZR||(ZR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(aT)),aT}var eM;function BTe(){return eM||(eM=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MTe(),r=LTe(),n=q3();function s(a){if(n.isArrayLike(a))return t.last(r.toArray(a))}e.last=s})(nT)),nT}var iT,tM;function $Te(){return tM||(tM=1,iT=BTe().last),iT}var UTe=$Te();const zTe=Ml(UTe);var WTe=["valueAccessor"],HTe=["dataKey","clockWise","id","textBreakAll"];function Ab(){return Ab=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ab.apply(null,arguments)}function rM(e,t){if(e==null)return{};var r,n,s=GTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function GTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var VTe=e=>Array.isArray(e.value)?zTe(e.value):e.value,QG=S.createContext(void 0),KTe=QG.Provider,JG=S.createContext(void 0);JG.Provider;function qTe(){return S.useContext(QG)}function YTe(){return S.useContext(JG)}function f_(e){var{valueAccessor:t=VTe}=e,r=rM(e,WTe),{dataKey:n,clockWise:s,id:a,textBreakAll:i}=r,o=rM(r,HTe),c=qTe(),u=YTe(),d=c||u;return!d||!d.length?null:S.createElement(sp,{className:"recharts-label-list"},d.map((f,g)=>{var p,x=Ka(n)?t(f,g):lo(f&&f.payload,n),v=Ka(a)?{}:{id:"".concat(a,"-").concat(g)};return S.createElement(ff,Ab({},wi(f,!0),o,v,{fill:(p=r.fill)!==null&&p!==void 0?p:f.fill,parentViewBox:f.parentViewBox,value:x,textBreakAll:i,viewBox:f.viewBox,key:"label-".concat(g),index:g}))}))}f_.displayName="LabelList";function XTe(e){var{label:t}=e;return t?t===!0?S.createElement(f_,{key:"labelList-implicit"}):S.isValidElement(t)||tj(t)?S.createElement(f_,{key:"labelList-implicit",content:t}):typeof t=="object"?S.createElement(f_,Ab({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function uN(){return uN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uN.apply(null,arguments)}var ZG=e=>{var{cx:t,cy:r,r:n,className:s}=e,a=us("recharts-dot",s);return t===+t&&r===+r&&n===+n?S.createElement("circle",uN({},L0(e),V3(e),{className:a,cx:t,cy:r,r:n})):null},QTe={radiusAxis:{},angleAxis:{}},eV=rl({name:"polarAxis",initialState:QTe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:rAe,removeRadiusAxis:nAe,addAngleAxis:sAe,removeAngleAxis:aAe}=eV.actions,JTe=eV.reducer;function ZTe(e){var{fn:t,args:r}=e,n=uo(),s=Bl();return S.useEffect(()=>{if(!s){var a=t(r);return n(ske(a)),()=>{n(ake(a))}}},[t,r,n,s]),null}var eEe=()=>{};function tEe(e){var{legendPayload:t}=e,r=uo(),n=Bl();return S.useEffect(()=>n?eEe:(r(K1e(t)),()=>{r(q1e(t))}),[r,n,t]),null}var oT,rEe=()=>{var[e]=S.useState(()=>pv("uid-"));return e},nEe=(oT=bM.useId)!==null&&oT!==void 0?oT:rEe;function sEe(e,t){var r=nEe();return t||(e?"".concat(e,"-").concat(r):r)}var aEe=S.createContext(void 0),iEe=e=>{var{id:t,type:r,children:n}=e,s=sEe("recharts-".concat(r),t);return S.createElement(aEe.Provider,{value:s},n(s))},oEe={cartesianItems:[],polarItems:[]},tV=rl({name:"graphicalItems",initialState:oEe,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,s=td(e).cartesianItems.indexOf(r);s>-1&&(e.cartesianItems[s]=n)},removeCartesianGraphicalItem(e,t){var r=td(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=td(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:lEe,replaceCartesianGraphicalItem:cEe,removeCartesianGraphicalItem:uEe,addPolarGraphicalItem:iAe,removePolarGraphicalItem:oAe}=tV.actions,dEe=tV.reducer;function fEe(e){var t=uo(),r=S.useRef(null);return S.useEffect(()=>{r.current===null?t(lEe(e)):r.current!==e&&t(cEe({prev:r.current,next:e})),r.current=e},[t,e]),S.useEffect(()=>()=>{r.current&&(t(uEe(r.current)),r.current=null)},[t]),null}function nM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function sM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nM(Object(r),!0).forEach(function(n){hEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hEe(e,t,r){return(t=gEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gEe(e){var t=mEe(e,"string");return typeof t=="symbol"?t:t+""}function mEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pEe={xAxis:{},yAxis:{},zAxis:{}},rV=rl({name:"cartesianAxis",initialState:pEe,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=sM(sM({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:xEe,removeXAxis:yEe,addYAxis:vEe,removeYAxis:wEe,addZAxis:lAe,removeZAxis:cAe,updateYAxisWidth:_Ee}=rV.actions,bEe=rV.reducer,SEe=kt([_i],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),kEe=kt([SEe,xd,yd],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),rj=()=>Pr(kEe),CEe=()=>Pr(qke);function aM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function iM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aM(Object(r),!0).forEach(function(n){TEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TEe(e,t,r){return(t=EEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EEe(e){var t=NEe(e,"string");return typeof t=="symbol"?t:t+""}function NEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AEe=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:s,dataKey:a}=e;if(s===!1||t.x==null||t.y==null)return null;var i=iM(iM({index:r,dataKey:a,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},wi(s,!1)),V3(s)),o;return S.isValidElement(s)?o=S.cloneElement(s,i):typeof s=="function"?o=s(i):o=S.createElement(ZG,i),S.createElement(sp,{className:"recharts-active-dot"},o)};function jEe(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:s}=e,a=Pr(Cv),i=CEe();if(t==null||i==null)return null;var o=t.find(c=>i.includes(c.payload));return Ka(o)?null:AEe({point:o,childIndex:Number(a),mainColor:r,dataKey:s,activeDot:n})}var PEe={},nV=rl({name:"errorBars",initialState:PEe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:s}=t.payload;e[r]&&(e[r]=e[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?s:a))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(s=>s.dataKey!==n.dataKey||s.direction!==n.direction))}}}),{addErrorBar:uAe,replaceErrorBar:dAe,removeErrorBar:fAe}=nV.actions,FEe=nV.reducer,OEe=["children"];function DEe(e,t){if(e==null)return{};var r,n,s=IEe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function IEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var REe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},MEe=S.createContext(REe);function LEe(e){var{children:t}=e,r=DEe(e,OEe);return S.createElement(MEe.Provider,{value:r},t)}function sV(e,t){var r,n,s=Pr(u=>wd(u,e)),a=Pr(u=>_d(u,t)),i=(r=s?.allowDataOverflow)!==null&&r!==void 0?r:Uo.allowDataOverflow,o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:zo.allowDataOverflow,c=i||o;return{needClip:c,needClipX:i,needClipY:o}}function BEe(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,s=rj(),{needClipX:a,needClipY:i,needClip:o}=sV(t,r);if(!o)return null;var{x:c,y:u,width:d,height:f}=s;return S.createElement("clipPath",{id:"clipPath-".concat(n)},S.createElement("rect",{x:a?c:c-d/2,y:i?u:u-f/2,width:a?d:d*2,height:i?f:f*2}))}var $Ee=e=>{var{chartData:t}=e,r=uo(),n=Bl();return S.useEffect(()=>n?()=>{}:(r(PR(t)),()=>{r(PR(void 0))}),[t,r,n]),null},oM={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},aV=rl({name:"brush",initialState:oM,reducers:{setBrushSettings(e,t){return t.payload==null?oM:t.payload}}}),{setBrushSettings:hAe}=aV.actions,UEe=aV.reducer;function zEe(e,t,r){return(t=WEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WEe(e){var t=HEe(e,"string");return typeof t=="symbol"?t:t+""}function HEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class nj{static create(t){return new nj(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(t)+a}default:return this.scale(t)}if(r){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],s=r[r.length-1];return n<=s?t>=n&&t<=s:t>=s&&t<=n}}zEe(nj,"EPS",1e-4);function GEe(e){return(e%180+180)%180}var VEe=function(t){var{width:r,height:n}=t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=GEe(s),i=a*Math.PI/180,o=Math.atan(n/r),c=i>o&&i<Math.PI-o?n/Math.sin(i):r/Math.cos(i);return Math.abs(c)},KEe={dots:[],areas:[],lines:[]},iV=rl({name:"referenceElements",initialState:KEe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=td(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=td(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=td(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:gAe,removeDot:mAe,addArea:pAe,removeArea:xAe,addLine:yAe,removeLine:vAe}=iV.actions,qEe=iV.reducer,YEe=S.createContext(void 0),XEe=e=>{var{children:t}=e,[r]=S.useState("".concat(pv("recharts"),"-clip")),n=rj();if(n==null)return null;var{x:s,y:a,width:i,height:o}=n;return S.createElement(YEe.Provider,{value:r},S.createElement("defs",null,S.createElement("clipPath",{id:r},S.createElement("rect",{x:s,y:a,height:o,width:i}))),t)};function Rm(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function oV(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],s=0;s<e.length;s+=t)n.push(e[s]);return n}function QEe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return VEe(n,r)}function JEe(e,t,r){var n=r==="width",{x:s,y:a,width:i,height:o}=e;return t===1?{start:n?s:a,end:n?s+i:a+o}:{start:n?s+i:a+o,end:n?s:a}}function jb(e,t,r,n,s){if(e*t<e*n||e*t>e*s)return!1;var a=r();return e*(t-e*a/2-n)>=0&&e*(t+e*a/2-s)<=0}function ZEe(e,t){return oV(e,t+1)}function eNe(e,t,r,n,s){for(var a=(n||[]).slice(),{start:i,end:o}=t,c=0,u=1,d=i,f=function(){var x=n?.[c];if(x===void 0)return{v:oV(n,u)};var v=c,w,C=()=>(w===void 0&&(w=r(x,v)),w),k=x.coordinate,_=c===0||jb(e,k,C,d,o);_||(c=0,d=i,u+=1),_&&(d=k+e*(C()/2+s),c+=u)},g;u<=a.length;)if(g=f(),g)return g.v;return[]}function lM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ji(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lM(Object(r),!0).forEach(function(n){tNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tNe(e,t,r){return(t=rNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rNe(e){var t=nNe(e,"string");return typeof t=="symbol"?t:t+""}function nNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sNe(e,t,r,n,s){for(var a=(n||[]).slice(),i=a.length,{start:o}=t,{end:c}=t,u=function(g){var p=a[g],x,v=()=>(x===void 0&&(x=r(p,g)),x);if(g===i-1){var w=e*(p.coordinate+e*v()/2-c);a[g]=p=ji(ji({},p),{},{tickCoord:w>0?p.coordinate-w*e:p.coordinate})}else a[g]=p=ji(ji({},p),{},{tickCoord:p.coordinate});var C=jb(e,p.tickCoord,v,o,c);C&&(c=p.tickCoord-e*(v()/2+s),a[g]=ji(ji({},p),{},{isShow:!0}))},d=i-1;d>=0;d--)u(d);return a}function aNe(e,t,r,n,s,a){var i=(n||[]).slice(),o=i.length,{start:c,end:u}=t;if(a){var d=n[o-1],f=r(d,o-1),g=e*(d.coordinate+e*f/2-u);i[o-1]=d=ji(ji({},d),{},{tickCoord:g>0?d.coordinate-g*e:d.coordinate});var p=jb(e,d.tickCoord,()=>f,c,u);p&&(u=d.tickCoord-e*(f/2+s),i[o-1]=ji(ji({},d),{},{isShow:!0}))}for(var x=a?o-1:o,v=function(k){var _=i[k],N,E=()=>(N===void 0&&(N=r(_,k)),N);if(k===0){var P=e*(_.coordinate-e*E()/2-c);i[k]=_=ji(ji({},_),{},{tickCoord:P<0?_.coordinate-P*e:_.coordinate})}else i[k]=_=ji(ji({},_),{},{tickCoord:_.coordinate});var F=jb(e,_.tickCoord,E,c,u);F&&(c=_.tickCoord+e*(E()/2+s),i[k]=ji(ji({},_),{},{isShow:!0}))},w=0;w<x;w++)v(w);return i}function sj(e,t,r){var{tick:n,ticks:s,viewBox:a,minTickGap:i,orientation:o,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!s||!s.length||!n)return[];if($r(c)||ap.isSsr){var g;return(g=ZEe(s,$r(c)?c:0))!==null&&g!==void 0?g:[]}var p=[],x=o==="top"||o==="bottom"?"width":"height",v=d&&x==="width"?Ry(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},w=(_,N)=>{var E=typeof u=="function"?u(_.value,N):_.value;return x==="width"?QEe(Ry(E,{fontSize:t,letterSpacing:r}),v,f):Ry(E,{fontSize:t,letterSpacing:r})[x]},C=s.length>=2?El(s[1].coordinate-s[0].coordinate):1,k=JEe(a,C,x);return c==="equidistantPreserveStart"?eNe(C,k,w,s,i):(c==="preserveStart"||c==="preserveStartEnd"?p=aNe(C,k,w,s,i,c==="preserveStartEnd"):p=sNe(C,k,w,s,i),p.filter(_=>_.isShow))}var iNe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:s=0,tickMargin:a=0}=e,i=0;if(t){t.forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>i&&(i=f.width)}});var o=r?r.getBoundingClientRect().width:0,c=s+a,u=i+c+o+(r?n:0);return Math.round(u)}return 0},oNe=["axisLine","width","height","className","hide","ticks"],lNe=["viewBox"],cNe=["viewBox"];function dN(e,t){if(e==null)return{};var r,n,s=uNe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function uNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function C0(){return C0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C0.apply(null,arguments)}function cM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Sa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cM(Object(r),!0).forEach(function(n){dNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dNe(e,t,r){return(t=fNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fNe(e){var t=hNe(e,"string");return typeof t=="symbol"?t:t+""}function hNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aj={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function gNe(e){var{x:t,y:r,width:n,height:s,orientation:a,mirror:i,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=Sa(Sa(Sa({},c),wi(o,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var d=+(a==="top"&&!i||a==="bottom"&&i);u=Sa(Sa({},u),{},{x1:t,y1:r+d*s,x2:t+n,y2:r+d*s})}else{var f=+(a==="left"&&!i||a==="right"&&i);u=Sa(Sa({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+s})}return S.createElement("line",C0({},u,{className:us("recharts-cartesian-axis-line",y2(o,"className"))}))}function mNe(e,t,r,n,s,a,i,o,c){var u,d,f,g,p,x,v=o?-1:1,w=e.tickSize||i,C=$r(e.tickCoord)?e.tickCoord:e.coordinate;switch(a){case"top":u=d=e.coordinate,g=r+ +!o*s,f=g-v*w,x=f-v*c,p=C;break;case"left":f=g=e.coordinate,d=t+ +!o*n,u=d-v*w,p=u-v*c,x=C;break;case"right":f=g=e.coordinate,d=t+ +o*n,u=d+v*w,p=u+v*c,x=C;break;default:u=d=e.coordinate,g=r+ +o*s,f=g+v*w,x=f+v*c,p=C;break}return{line:{x1:u,y1:f,x2:d,y2:g},tick:{x:p,y:x}}}function pNe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function xNe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function yNe(e){var{option:t,tickProps:r,value:n}=e,s,a=us(r.className,"recharts-cartesian-axis-tick-value");if(S.isValidElement(t))s=S.cloneElement(t,Sa(Sa({},r),{},{className:a}));else if(typeof t=="function")s=t(Sa(Sa({},r),{},{className:a}));else{var i="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(i=us(i,t?.className)),s=S.createElement(ej,C0({},r,{className:i}),n)}return s}function vNe(e){var{ticks:t=[],tick:r,tickLine:n,stroke:s,tickFormatter:a,unit:i,padding:o,tickTextProps:c,orientation:u,mirror:d,x:f,y:g,width:p,height:x,tickSize:v,tickMargin:w,fontSize:C,letterSpacing:k,getTicksConfig:_,events:N}=e,E=sj(Sa(Sa({},_),{},{ticks:t}),C,k),P=pNe(u,d),F=xNe(u,d),A=L0(_),j=wi(r,!1),I=Sa(Sa({},A),{},{fill:"none"},wi(n,!1)),B=E.map((Y,Z)=>{var{line:se,tick:ee}=mNe(Y,f,g,p,x,u,v,d,w),te=Sa(Sa(Sa(Sa({textAnchor:P,verticalAnchor:F},A),{},{stroke:"none",fill:s},j),ee),{},{index:Z,payload:Y,visibleTicksCount:E.length,tickFormatter:a,padding:o},c);return S.createElement(sp,C0({className:"recharts-cartesian-axis-tick",key:"tick-".concat(Y.value,"-").concat(Y.coordinate,"-").concat(Y.tickCoord)},Lxe(N,Y,Z)),n&&S.createElement("line",C0({},I,se,{className:us("recharts-cartesian-axis-tick-line",y2(n,"className"))})),r&&S.createElement(yNe,{option:r,tickProps:te,value:"".concat(typeof a=="function"?a(Y.value,Z):Y.value).concat(i||"")}))});return B.length>0?S.createElement("g",{className:"recharts-cartesian-axis-ticks"},B):null}var wNe=S.forwardRef((e,t)=>{var{axisLine:r,width:n,height:s,className:a,hide:i,ticks:o}=e,c=dN(e,oNe),[u,d]=S.useState(""),[f,g]=S.useState(""),p=S.useRef([]);S.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var v;return iNe({ticks:p.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var x=S.useCallback(v=>{if(v){var w=v.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=Array.from(w);var C=w[0];if(C){var k=window.getComputedStyle(C),_=k.fontSize,N=k.letterSpacing;(_!==u||N!==f)&&(d(_),g(N))}}},[u,f]);return i||n!=null&&n<=0||s!=null&&s<=0?null:S.createElement(sp,{className:us("recharts-cartesian-axis",a),ref:x},S.createElement(gNe,{x:e.x,y:e.y,width:n,height:s,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:L0(e)}),S.createElement(vNe,{ticks:o,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:u,letterSpacing:f,getTicksConfig:e,events:c}),S.createElement(TTe,{x:e.x,y:e.y,width:e.width,height:e.height},S.createElement(RTe,{label:e.label}),e.children))}),_Ne=S.memo(wNe,(e,t)=>{var{viewBox:r}=e,n=dN(e,lNe),{viewBox:s}=t,a=dN(t,cNe);return Rm(r,s)&&Rm(n,a)}),ij=S.forwardRef((e,t)=>{var r=$l(e,aj);return S.createElement(_Ne,C0({},r,{ref:t}))});ij.displayName="CartesianAxis";var bNe=["x1","y1","x2","y2","key"],SNe=["offset"],kNe=["xAxisId","yAxisId"],CNe=["xAxisId","yAxisId"];function uM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Di(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uM(Object(r),!0).forEach(function(n){TNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TNe(e,t,r){return(t=ENe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ENe(e){var t=NNe(e,"string");return typeof t=="symbol"?t:t+""}function NNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uh(){return Uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uh.apply(null,arguments)}function Pb(e,t){if(e==null)return{};var r,n,s=ANe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function ANe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var jNe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:s,width:a,height:i,ry:o}=e;return S.createElement("rect",{x:n,y:s,ry:o,width:a,height:i,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function lV(e,t){var r;if(S.isValidElement(e))r=S.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:s,x2:a,y2:i,key:o}=t,c=Pb(t,bNe),u=L0(c),{offset:d}=u,f=Pb(u,SNe);r=S.createElement("line",Uh({},f,{x1:n,y1:s,x2:a,y2:i,fill:"none",key:o}))}return r}function PNe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:s}=e;if(!n||!s||!s.length)return null;var{xAxisId:a,yAxisId:i}=e,o=Pb(e,kNe),c=s.map((u,d)=>{var f=Di(Di({},o),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return lV(n,f)});return S.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function FNe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:s}=e;if(!n||!s||!s.length)return null;var{xAxisId:a,yAxisId:i}=e,o=Pb(e,CNe),c=s.map((u,d)=>{var f=Di(Di({},o),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return lV(n,f)});return S.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function ONe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:s,width:a,height:i,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=o.map(f=>Math.round(f+s-s)).sort((f,g)=>f-g);s!==u[0]&&u.unshift(0);var d=u.map((f,g)=>{var p=!u[g+1],x=p?s+i-f:u[g+1]-f;if(x<=0)return null;var v=g%t.length;return S.createElement("rect",{key:"react-".concat(g),y:f,x:n,height:x,width:a,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return S.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function DNe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:s,y:a,width:i,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+s-s)).sort((f,g)=>f-g);s!==u[0]&&u.unshift(0);var d=u.map((f,g)=>{var p=!u[g+1],x=p?s+i-f:u[g+1]-f;if(x<=0)return null;var v=g%r.length;return S.createElement("rect",{key:"react-".concat(g),x:f,y:a,width:x,height:o,stroke:"none",fill:r[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return S.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var INe=(e,t)=>{var{xAxis:r,width:n,height:s,offset:a}=e;return fW(sj(Di(Di(Di({},aj),r),{},{ticks:hW(r),viewBox:{x:0,y:0,width:n,height:s}})),a.left,a.left+a.width,t)},RNe=(e,t)=>{var{yAxis:r,width:n,height:s,offset:a}=e;return fW(sj(Di(Di(Di({},aj),r),{},{ticks:hW(r),viewBox:{x:0,y:0,width:n,height:s}})),a.top,a.top+a.height,t)},MNe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function cV(e){var t=yW(),r=vW(),n=xW(),s=Di(Di({},$l(e,MNe)),{},{x:$r(e.x)?e.x:n.left,y:$r(e.y)?e.y:n.top,width:$r(e.width)?e.width:n.width,height:$r(e.height)?e.height:n.height}),{xAxisId:a,yAxisId:i,x:o,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:g,verticalValues:p}=s,x=Bl(),v=Pr(j=>bR(j,"xAxis",a,x)),w=Pr(j=>bR(j,"yAxis",i,x));if(!$r(u)||u<=0||!$r(d)||d<=0||!$r(o)||o!==+o||!$r(c)||c!==+c)return null;var C=s.verticalCoordinatesGenerator||INe,k=s.horizontalCoordinatesGenerator||RNe,{horizontalPoints:_,verticalPoints:N}=s;if((!_||!_.length)&&typeof k=="function"){var E=g&&g.length,P=k({yAxis:w?Di(Di({},w),{},{ticks:E?g:w.ticks}):void 0,width:t,height:r,offset:n},E?!0:f);Iy(Array.isArray(P),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof P,"]")),Array.isArray(P)&&(_=P)}if((!N||!N.length)&&typeof C=="function"){var F=p&&p.length,A=C({xAxis:v?Di(Di({},v),{},{ticks:F?p:v.ticks}):void 0,width:t,height:r,offset:n},F?!0:f);Iy(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(N=A)}return S.createElement("g",{className:"recharts-cartesian-grid"},S.createElement(jNe,{fill:s.fill,fillOpacity:s.fillOpacity,x:s.x,y:s.y,width:s.width,height:s.height,ry:s.ry}),S.createElement(ONe,Uh({},s,{horizontalPoints:_})),S.createElement(DNe,Uh({},s,{verticalPoints:N})),S.createElement(PNe,Uh({},s,{offset:n,horizontalPoints:_,xAxis:v,yAxis:w})),S.createElement(FNe,Uh({},s,{offset:n,verticalPoints:N,xAxis:v,yAxis:w})))}cV.displayName="CartesianGrid";var uV=(e,t,r,n)=>pG(e,"xAxis",t,n),dV=(e,t,r,n)=>mG(e,"xAxis",t,n),fV=(e,t,r,n)=>pG(e,"yAxis",r,n),hV=(e,t,r,n)=>mG(e,"yAxis",r,n),LNe=kt([fs,uV,fV,dV,hV],(e,t,r,n,s)=>Gf(e,"xAxis")?zE(t,n,!1):zE(r,s,!1)),BNe=(e,t,r,n,s)=>s;function $Ne(e){return e.type==="line"}var UNe=kt([LH,BNe],(e,t)=>e.filter($Ne).find(r=>r.id===t)),zNe=kt([fs,uV,fV,dV,hV,UNe,LNe,EA],(e,t,r,n,s,a,i,o)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=o;if(!(a==null||t==null||r==null||n==null||s==null||n.length===0||s.length===0||i==null)){var{dataKey:f,data:g}=a,p;if(g!=null&&g.length>0?p=g:p=c?.slice(u,d+1),p!=null)return u4e({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:s,dataKey:f,bandSize:i,displayedData:p})}}),WNe=["id"],HNe=["type","layout","connectNulls","needClip"],GNe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function dM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ko(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dM(Object(r),!0).forEach(function(n){VNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VNe(e,t,r){return(t=KNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KNe(e){var t=qNe(e,"string");return typeof t=="symbol"?t:t+""}function qNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oj(e,t){if(e==null)return{};var r,n,s=YNe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function YNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function T0(){return T0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},T0.apply(null,arguments)}var XNe=e=>{var{dataKey:t,name:r,stroke:n,legendType:s,hide:a}=e;return[{inactive:a,dataKey:t,type:s,color:n,value:gW(r,t),payload:e}]};function QNe(e){var{dataKey:t,data:r,stroke:n,strokeWidth:s,fill:a,name:i,hide:o,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:s,fill:a,dataKey:t,nameKey:void 0,name:gW(i,t),hide:o,type:e.tooltipType,color:e.stroke,unit:c}}}var gV=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function JNe(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],s=0;s<t;++s)n=[...n,...r];return n}var ZNe=(e,t,r)=>{var n=r.reduce((f,g)=>f+g);if(!n)return gV(t,e);for(var s=Math.floor(e/n),a=e%n,i=t-e,o=[],c=0,u=0;c<r.length;u+=r[c],++c)if(u+r[c]>a){o=[...r.slice(0,c),a-u];break}var d=o.length%2===0?[0,i]:[i];return[...JNe(r,s),...o,...d].map(f=>"".concat(f,"px")).join(", ")};function e4e(e,t){var r;if(S.isValidElement(e))r=S.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=us("recharts-line-dot",typeof e!="boolean"?e.className:"");r=S.createElement(ZG,T0({},t,{className:n}))}return r}function t4e(e,t){return e==null?!1:t?!0:e.length===1}function r4e(e){var{clipPathId:t,points:r,props:n}=e,{dot:s,dataKey:a,needClip:i}=n;if(!t4e(r,s))return null;var{id:o}=n,c=oj(n,WNe),u=hz(s),d=L0(c),f=wi(s,!0),g=r.map((x,v)=>{var w=Ko(Ko(Ko({key:"dot-".concat(v),r:3},d),f),{},{index:v,cx:x.x,cy:x.y,dataKey:a,value:x.value,payload:x.payload,points:r});return e4e(s,w)}),p={clipPath:i?"url(#clipPath-".concat(u?"":"dots-").concat(t,")"):void 0};return S.createElement(sp,T0({className:"recharts-line-dots",key:"dots"},p),g)}function n4e(e){var{showLabels:t,children:r,points:n}=e,s=S.useMemo(()=>n?.map(a=>{var i={x:a.x,y:a.y,width:0,height:0};return Ko(Ko({},i),{},{value:a.value,payload:a.payload,viewBox:i,parentViewBox:void 0,fill:void 0})}),[n]);return S.createElement(KTe,{value:t?s:null},r)}function fM(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:s,props:a}=e,{type:i,layout:o,connectNulls:c,needClip:u}=a,d=oj(a,HNe),f=Ko(Ko({},wi(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:i,layout:o,connectNulls:c,strokeDasharray:s??a.strokeDasharray});return S.createElement(S.Fragment,null,n?.length>1&&S.createElement(bW,T0({},f,{pathRef:r})),S.createElement(r4e,{points:n,clipPathId:t,props:a}))}function s4e(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function a4e(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:s,longestAnimatedLengthRef:a}=e,{points:i,strokeDasharray:o,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:g,width:p,height:x,onAnimationEnd:v,onAnimationStart:w}=r,C=s.current,k=EW(r,"recharts-line-"),[_,N]=S.useState(!1),E=!_,P=S.useCallback(()=>{typeof v=="function"&&v(),N(!1)},[v]),F=S.useCallback(()=>{typeof w=="function"&&w(),N(!0)},[w]),A=s4e(n.current),j=a.current;return S.createElement(n4e,{points:i,showLabels:E},r.children,S.createElement(TW,{animationId:k,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:P,onAnimationStart:F,key:k},I=>{var B=Hu(j,A+j,I),Y=Math.min(B,A),Z;if(c)if(o){var se="".concat(o).split(/[,\s]+/gim).map(L=>parseFloat(L));Z=ZNe(Y,A,se)}else Z=gV(A,Y);else Z=o==null?void 0:String(o);if(C){var ee=C.length/i.length,te=I===1?i:i.map((L,V)=>{var M=Math.floor(V*ee);if(C[M]){var H=C[M];return Ko(Ko({},L),{},{x:Hu(H.x,L.x,I),y:Hu(H.y,L.y,I)})}return g?Ko(Ko({},L),{},{x:Hu(p*2,L.x,I),y:Hu(x/2,L.y,I)}):Ko(Ko({},L),{},{x:L.x,y:L.y})});return s.current=te,S.createElement(fM,{props:r,points:te,clipPathId:t,pathRef:n,strokeDasharray:Z})}return I>0&&A>0&&(s.current=i,a.current=Y),S.createElement(fM,{props:r,points:i,clipPathId:t,pathRef:n,strokeDasharray:Z})}),S.createElement(XTe,{label:r.label}))}function i4e(e){var{clipPathId:t,props:r}=e,n=S.useRef(null),s=S.useRef(0),a=S.useRef(null);return S.createElement(a4e,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:s,pathRef:a})}var o4e=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:lo(e.payload,t)});class l4e extends S.Component{render(){var t,{hide:r,dot:n,points:s,className:a,xAxisId:i,yAxisId:o,top:c,left:u,width:d,height:f,id:g,needClip:p}=this.props;if(r)return null;var x=us("recharts-line",a),v=g,{r:w=3,strokeWidth:C=2}=(t=wi(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},k=hz(n),_=w*2+C;return S.createElement(S.Fragment,null,S.createElement(sp,{className:x},p&&S.createElement("defs",null,S.createElement(BEe,{clipPathId:v,xAxisId:i,yAxisId:o}),!k&&S.createElement("clipPath",{id:"clipPath-dots-".concat(v)},S.createElement("rect",{x:u-_/2,y:c-_/2,width:d+_,height:f+_}))),S.createElement(LEe,{xAxisId:i,yAxisId:o,data:s,dataPointFormatter:o4e,errorBarOffset:0},S.createElement(i4e,{props:this.props,clipPathId:v}))),S.createElement(jEe,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var mV={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!ap.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function c4e(e){var t=$l(e,mV),{activeDot:r,animateNewValues:n,animationBegin:s,animationDuration:a,animationEasing:i,connectNulls:o,dot:c,hide:u,isAnimationActive:d,label:f,legendType:g,xAxisId:p,yAxisId:x,id:v}=t,w=oj(t,GNe),{needClip:C}=sV(p,x),k=rj(),_=nA(),N=Bl(),E=Pr(I=>zNe(I,p,x,N,v));if(_!=="horizontal"&&_!=="vertical"||E==null||k==null)return null;var{height:P,width:F,x:A,y:j}=k;return S.createElement(l4e,T0({},w,{id:v,connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:s,animationDuration:a,animationEasing:i,isAnimationActive:d,hide:u,label:f,legendType:g,xAxisId:p,yAxisId:x,points:E,layout:_,height:P,width:F,left:A,top:j,needClip:C}))}function u4e(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:s,yAxisTicks:a,dataKey:i,bandSize:o,displayedData:c}=e;return c.map((u,d)=>{var f=lo(u,i);if(t==="horizontal"){var g=oI({axis:r,ticks:s,bandSize:o,entry:u,index:d}),p=Ka(f)?null:n.scale(f);return{x:g,y:p,value:f,payload:u}}var x=Ka(f)?null:r.scale(f),v=oI({axis:n,ticks:a,bandSize:o,entry:u,index:d});return x==null||v==null?null:{x,y:v,value:f,payload:u}}).filter(Boolean)}function d4e(e){var t=$l(e,mV),r=Bl();return S.createElement(iEe,{id:t.id,type:"line"},n=>S.createElement(S.Fragment,null,S.createElement(tEe,{legendPayload:XNe(t)}),S.createElement(ZTe,{fn:QNe,args:t}),S.createElement(fEe,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),S.createElement(c4e,T0({},t,{id:n}))))}var pV=S.memo(d4e);pV.displayName="Line";var f4e=["dangerouslySetInnerHTML","ticks"],h4e=["id"],g4e=["domain"],m4e=["domain"];function fN(){return fN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fN.apply(null,arguments)}function Fb(e,t){if(e==null)return{};var r,n,s=p4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function p4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function x4e(e){var t=uo();return S.useEffect(()=>(t(xEe(e)),()=>{t(yEe(e))}),[e,t]),null}var y4e=e=>{var{xAxisId:t,className:r}=e,n=Pr(pW),s=Bl(),a="xAxis",i=Pr(w=>dp(w,a,t,s)),o=Pr(w=>gG(w,a,t,s)),c=Pr(w=>USe(w,t)),u=Pr(w=>KSe(w,t)),d=Pr(w=>DH(w,t));if(c==null||u==null||d==null)return null;var{dangerouslySetInnerHTML:f,ticks:g}=e,p=Fb(e,f4e),{id:x}=d,v=Fb(d,h4e);return S.createElement(ij,fN({},p,v,{scale:i,x:u.x,y:u.y,width:c.width,height:c.height,className:us("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o}))},v4e={allowDataOverflow:Uo.allowDataOverflow,allowDecimals:Uo.allowDecimals,allowDuplicatedCategory:Uo.allowDuplicatedCategory,height:Uo.height,hide:!1,mirror:Uo.mirror,orientation:Uo.orientation,padding:Uo.padding,reversed:Uo.reversed,scale:Uo.scale,tickCount:Uo.tickCount,type:Uo.type,xAxisId:0},w4e=e=>{var t,r,n,s,a,i=$l(e,v4e);return S.createElement(S.Fragment,null,S.createElement(x4e,{interval:(t=i.interval)!==null&&t!==void 0?t:"preserveEnd",id:i.xAxisId,scale:i.scale,type:i.type,padding:i.padding,allowDataOverflow:i.allowDataOverflow,domain:i.domain,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,includeHidden:(r=i.includeHidden)!==null&&r!==void 0?r:!1,reversed:i.reversed,ticks:i.ticks,height:i.height,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(n=i.angle)!==null&&n!==void 0?n:0,minTickGap:(s=i.minTickGap)!==null&&s!==void 0?s:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),S.createElement(y4e,i))},_4e=(e,t)=>{var{domain:r}=e,n=Fb(e,g4e),{domain:s}=t,a=Fb(t,m4e);return Rm(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(s)&&s.length===2?r[0]===s[0]&&r[1]===s[1]:Rm({domain:r},{domain:s}):!1},xV=S.memo(w4e,_4e);xV.displayName="XAxis";var b4e=["dangerouslySetInnerHTML","ticks"],S4e=["id"],k4e=["domain"],C4e=["domain"];function hN(){return hN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hN.apply(null,arguments)}function Ob(e,t){if(e==null)return{};var r,n,s=T4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function T4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function E4e(e){var t=uo();return S.useEffect(()=>(t(vEe(e)),()=>{t(wEe(e))}),[e,t]),null}var N4e=e=>{var{yAxisId:t,className:r,width:n,label:s}=e,a=S.useRef(null),i=S.useRef(null),o=Pr(pW),c=Bl(),u=uo(),d="yAxis",f=Pr(E=>dp(E,d,t,c)),g=Pr(E=>XSe(E,t)),p=Pr(E=>YSe(E,t)),x=Pr(E=>gG(E,d,t,c)),v=Pr(E=>IH(E,t));if(S.useLayoutEffect(()=>{if(!(n!=="auto"||!g||tj(s)||S.isValidElement(s)||v==null)){var E=a.current;if(E){var P=E.getCalculatedWidth();Math.round(g.width)!==Math.round(P)&&u(_Ee({id:t,width:P}))}}},[x,g,u,s,t,n,v]),g==null||p==null||v==null)return null;var{dangerouslySetInnerHTML:w,ticks:C}=e,k=Ob(e,b4e),{id:_}=v,N=Ob(v,S4e);return S.createElement(ij,hN({},k,N,{ref:a,labelRef:i,scale:f,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:g.width,height:g.height,className:us("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:x}))},A4e={allowDataOverflow:zo.allowDataOverflow,allowDecimals:zo.allowDecimals,allowDuplicatedCategory:zo.allowDuplicatedCategory,hide:!1,mirror:zo.mirror,orientation:zo.orientation,padding:zo.padding,reversed:zo.reversed,scale:zo.scale,tickCount:zo.tickCount,type:zo.type,width:zo.width,yAxisId:0},j4e=e=>{var t,r,n,s,a,i=$l(e,A4e);return S.createElement(S.Fragment,null,S.createElement(E4e,{interval:(t=i.interval)!==null&&t!==void 0?t:"preserveEnd",id:i.yAxisId,scale:i.scale,type:i.type,domain:i.domain,allowDataOverflow:i.allowDataOverflow,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,padding:i.padding,includeHidden:(r=i.includeHidden)!==null&&r!==void 0?r:!1,reversed:i.reversed,ticks:i.ticks,width:i.width,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(n=i.angle)!==null&&n!==void 0?n:0,minTickGap:(s=i.minTickGap)!==null&&s!==void 0?s:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),S.createElement(N4e,i))},P4e=(e,t)=>{var{domain:r}=e,n=Ob(e,k4e),{domain:s}=t,a=Ob(t,C4e);return Rm(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(s)&&s.length===2?r[0]===s[0]&&r[1]===s[1]:Rm({domain:r},{domain:s}):!1},yV=S.memo(j4e,P4e);yV.displayName="YAxis";var lT={exports:{}},cT={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hM;function F4e(){if(hM)return cT;hM=1;var e=E0();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,s=e.useRef,a=e.useEffect,i=e.useMemo,o=e.useDebugValue;return cT.useSyncExternalStoreWithSelector=function(c,u,d,f,g){var p=s(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=i(function(){function w(E){if(!C){if(C=!0,k=E,E=f(E),g!==void 0&&x.hasValue){var P=x.value;if(g(P,E))return _=P}return _=E}if(P=_,r(k,E))return P;var F=f(E);return g!==void 0&&g(P,F)?(k=E,P):(k=E,_=F)}var C=!1,k,_,N=d===void 0?null:d;return[function(){return w(u())},N===null?void 0:function(){return w(N())}]},[u,d,f,g]);var v=n(c,p[0],p[1]);return a(function(){x.hasValue=!0,x.value=v},[v]),o(v),v},cT}var gM;function O4e(){return gM||(gM=1,lT.exports=F4e()),lT.exports}O4e();function D4e(e){e()}function I4e(){let e=null,t=null;return{clear(){e=null,t=null},notify(){D4e(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=t={callback:r,next:null,prev:t};return s.prev?s.prev.next=s:e=s,function(){!n||e===null||(n=!1,s.next?s.next.prev=s.prev:t=s.prev,s.prev?s.prev.next=s.next:e=s.next)}}}}var mM={notify(){},get:()=>[]};function R4e(e,t){let r,n=mM,s=0,a=!1;function i(v){d();const w=n.subscribe(v);let C=!1;return()=>{C||(C=!0,w(),f())}}function o(){n.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return a}function d(){s++,r||(r=e.subscribe(c),n=I4e())}function f(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=mM)}function g(){a||(a=!0,d())}function p(){a&&(a=!1,f())}const x={addNestedSub:i,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:g,tryUnsubscribe:p,getListeners:()=>n};return x}var M4e=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",L4e=M4e(),B4e=()=>typeof navigator<"u"&&navigator.product==="ReactNative",$4e=B4e(),U4e=()=>L4e||$4e?S.useLayoutEffect:S.useEffect,z4e=U4e(),W4e=Symbol.for("react-redux-context"),H4e=typeof globalThis<"u"?globalThis:{};function G4e(){if(!S.createContext)return{};const e=H4e[W4e]??=new Map;let t=e.get(S.createContext);return t||(t=S.createContext(null),e.set(S.createContext,t)),t}var V4e=G4e();function K4e(e){const{children:t,context:r,serverState:n,store:s}=e,a=S.useMemo(()=>{const c=R4e(s);return{store:s,subscription:c,getServerState:n?()=>n:void 0}},[s,n]),i=S.useMemo(()=>s.getState(),[s]);z4e(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),i!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,i]);const o=r||V4e;return S.createElement(o.Provider,{value:a},t)}var q4e=K4e,Y4e=(e,t)=>t,lj=kt([Y4e,fs,jH,Pa,jG,bd,tCe,_i],iCe),cj=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},vV=Il("mouseClick"),wV=n1();wV.startListening({actionCreator:vV,effect:(e,t)=>{var r=e.payload,n=lj(t.getState(),cj(r));n?.activeIndex!=null&&t.dispatch(lke({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var gN=Il("mouseMove"),_V=n1();_V.startListening({actionCreator:gN,effect:(e,t)=>{var r=e.payload,n=t.getState(),s=GA(n,n.tooltip.settings.shared),a=lj(n,cj(r));s==="axis"&&(a?.activeIndex!=null?t.dispatch(SG({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):t.dispatch(bG()))}});var pM={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},bV=rl({name:"rootProps",initialState:pM,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:pM.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),X4e=bV.reducer,{updateOptions:Q4e}=bV.actions,SV=rl({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:wAe}=SV.actions,J4e=SV.reducer,kV=Il("keyDown"),CV=Il("focus"),uj=n1();uj.startListening({actionCreator:kV,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip,a=e.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var i=Number(VA(s,hp(r))),o=bd(r);if(a==="Enter"){var c=Nb(r,"axis","hover",String(s.index));t.dispatch(iN({active:!s.active,activeIndex:s.index,activeDataKey:s.dataKey,activeCoordinate:c}));return}var u=eke(r),d=u==="left-to-right"?1:-1,f=a==="ArrowRight"?1:-1,g=i+f*d;if(!(o==null||g>=o.length||g<0)){var p=Nb(r,"axis","hover",String(g));t.dispatch(iN({active:!0,activeIndex:g.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});uj.startListening({actionCreator:CV,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip;if(!s.active&&s.index==null){var a="0",i=Nb(r,"axis","hover",String(a));t.dispatch(iN({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:i}))}}}});var wl=Il("externalEvent"),TV=n1();TV.startListening({actionCreator:wl,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:Gke(r),activeDataKey:Wke(r),activeIndex:Cv(r),activeLabel:OG(r),activeTooltipIndex:Cv(r),isTooltipActive:Vke(r)};e.payload.handler(n,e.payload.reactEvent)}}});var Z4e=kt([fp],e=>e.tooltipItemPayloads),e3e=kt([Z4e,h1,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var s=e.find(o=>o.settings.dataKey===n);if(s!=null){var{positions:a}=s;if(a!=null){var i=t(a,r);return i}}}),EV=Il("touchMove"),NV=n1();NV.startListening({actionCreator:EV,effect:(e,t)=>{var r=e.payload,n=t.getState(),s=GA(n,n.tooltip.settings.shared);if(s==="axis"){var a=lj(n,cj({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&t.dispatch(SG({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(s==="item"){var i,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(O1e),d=(i=c.getAttribute(D1e))!==null&&i!==void 0?i:void 0,f=e3e(t.getState(),u,d);t.dispatch(oke({activeDataKey:d,activeIndex:u,activeCoordinate:f}))}}});var t3e=zz({brush:UEe,cartesianAxis:bEe,chartData:SCe,errorBars:FEe,graphicalItems:dEe,layout:a1e,legend:Y1e,options:yCe,polarAxis:JTe,polarOptions:J4e,referenceElements:qEe,rootProps:X4e,tooltip:cke}),r3e=function(t){return jve({reducer:t3e,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([wV.middleware,_V.middleware,uj.middleware,TV.middleware,NV.middleware]),devTools:ap.devToolsEnabled})};function n3e(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,s=Bl(),a=S.useRef(null);if(s)return r;a.current==null&&(a.current=r3e(t));var i=X3;return S.createElement(q4e,{context:i,store:a.current},r)}function s3e(e){var{layout:t,width:r,height:n,margin:s}=e,a=uo(),i=Bl();return S.useEffect(()=>{i||(a(r1e(t)),a(n1e({width:r,height:n})),a(t1e(s)))},[a,i,t,r,n,s]),null}function a3e(e){var t=uo();return S.useEffect(()=>{t(Q4e(e))},[t,e]),null}var i3e=["children"];function o3e(e,t){if(e==null)return{};var r,n,s=l3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function l3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Db(){return Db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Db.apply(null,arguments)}var c3e={width:"100%",height:"100%"},u3e=S.forwardRef((e,t)=>{var r=yW(),n=vW(),s=_W();if(!fb(r)||!fb(n))return null;var{children:a,otherAttributes:i,title:o,desc:c}=e,u,d;return typeof i.tabIndex=="number"?u=i.tabIndex:u=s?0:void 0,typeof i.role=="string"?d=i.role:d=s?"application":void 0,S.createElement(gz,Db({},i,{title:o,desc:c,role:d,tabIndex:u,width:r,height:n,style:c3e,ref:t}),a)}),d3e=e=>{var{children:t}=e,r=Pr(j2);if(!r)return null;var{width:n,height:s,y:a,x:i}=r;return S.createElement(gz,{width:n,height:s,x:i,y:a},t)},xM=S.forwardRef((e,t)=>{var{children:r}=e,n=o3e(e,i3e),s=Bl();return s?S.createElement(d3e,null,r):S.createElement(u3e,Db({ref:t},n),r)});function f3e(){var e=uo(),[t,r]=S.useState(null),n=Pr(F1e);return S.useEffect(()=>{if(t!=null){var s=t.getBoundingClientRect(),a=s.width/t.offsetWidth;yc(a)&&a!==n&&e(s1e(a))}},[t,e,n]),r}function yM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function h3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yM(Object(r),!0).forEach(function(n){g3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g3e(e,t,r){return(t=m3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m3e(e){var t=p3e(e,"string");return typeof t=="symbol"?t:t+""}function p3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x3e=S.forwardRef((e,t)=>{var{children:r,className:n,height:s,onClick:a,onContextMenu:i,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:g,onTouchEnd:p,onTouchMove:x,onTouchStart:v,style:w,width:C}=e,k=uo(),[_,N]=S.useState(null),[E,P]=S.useState(null);FCe();var F=f3e(),A=S.useCallback(R=>{F(R),typeof t=="function"&&t(R),N(R),P(R)},[F,t,N,P]),j=S.useCallback(R=>{k(vV(R)),k(wl({handler:a,reactEvent:R}))},[k,a]),I=S.useCallback(R=>{k(gN(R)),k(wl({handler:u,reactEvent:R}))},[k,u]),B=S.useCallback(R=>{k(bG()),k(wl({handler:d,reactEvent:R}))},[k,d]),Y=S.useCallback(R=>{k(gN(R)),k(wl({handler:f,reactEvent:R}))},[k,f]),Z=S.useCallback(()=>{k(CV())},[k]),se=S.useCallback(R=>{k(kV(R.key))},[k]),ee=S.useCallback(R=>{k(wl({handler:i,reactEvent:R}))},[k,i]),te=S.useCallback(R=>{k(wl({handler:o,reactEvent:R}))},[k,o]),L=S.useCallback(R=>{k(wl({handler:c,reactEvent:R}))},[k,c]),V=S.useCallback(R=>{k(wl({handler:g,reactEvent:R}))},[k,g]),M=S.useCallback(R=>{k(wl({handler:v,reactEvent:R}))},[k,v]),H=S.useCallback(R=>{k(EV(R)),k(wl({handler:x,reactEvent:R}))},[k,x]),W=S.useCallback(R=>{k(wl({handler:p,reactEvent:R}))},[k,p]);return S.createElement(BG.Provider,{value:_},S.createElement(Kxe.Provider,{value:E},S.createElement("div",{className:us("recharts-wrapper",n),style:h3e({position:"relative",cursor:"default",width:C,height:s},w),onClick:j,onContextMenu:ee,onDoubleClick:te,onFocus:Z,onKeyDown:se,onMouseDown:L,onMouseEnter:I,onMouseLeave:B,onMouseMove:Y,onMouseUp:V,onTouchEnd:W,onTouchMove:H,onTouchStart:M,ref:A},r)))}),y3e=["children","className","width","height","style","compact","title","desc"];function v3e(e,t){if(e==null)return{};var r,n,s=w3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function w3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _3e=S.forwardRef((e,t)=>{var{children:r,className:n,width:s,height:a,style:i,compact:o,title:c,desc:u}=e,d=v3e(e,y3e),f=L0(d);return o?S.createElement(xM,{otherAttributes:f,title:c,desc:u},r):S.createElement(x3e,{className:n,style:i,width:s,height:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},S.createElement(xM,{otherAttributes:f,title:c,desc:u,ref:t},S.createElement(XEe,null,r)))}),b3e=["width","height"];function mN(){return mN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mN.apply(null,arguments)}function S3e(e,t){if(e==null)return{};var r,n,s=k3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function k3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var C3e={top:5,right:5,bottom:5,left:5},T3e={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:C3e,reverseStackOrder:!1,syncMethod:"index"},E3e=S.forwardRef(function(t,r){var n,s=$l(t.categoricalChartProps,T3e),{width:a,height:i}=s,o=S3e(s,b3e);if(!fb(a)||!fb(i))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,categoricalChartProps:g}=t,p={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,eventEmitter:void 0};return S.createElement(n3e,{preloadedState:{options:p},reduxStoreName:(n=g.id)!==null&&n!==void 0?n:c},S.createElement($Ee,{chartData:g.data}),S.createElement(s3e,{width:a,height:i,layout:s.layout,margin:s.margin}),S.createElement(a3e,{accessibilityLayer:s.accessibilityLayer,barCategoryGap:s.barCategoryGap,maxBarSize:s.maxBarSize,stackOffset:s.stackOffset,barGap:s.barGap,barSize:s.barSize,syncId:s.syncId,syncMethod:s.syncMethod,className:s.className}),S.createElement(_3e,mN({},o,{width:a,height:i,ref:r})))}),N3e=["axis"],A3e=S.forwardRef((e,t)=>S.createElement(E3e,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:N3e,tooltipPayloadSearcher:pCe,categoricalChartProps:e,ref:t}));const j3e=({data:e=[],loading:t=!1,error:r=null})=>{if(t)return l.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"400px"},children:l.jsx("div",{className:"spinner-border text-primary",role:"status",children:l.jsx("span",{className:"visually-hidden",children:"Loading..."})})});if(r)return l.jsxs("div",{className:"alert alert-danger",role:"alert",children:[l.jsx("h5",{className:"alert-heading",children:"Error Loading Performance Data"}),l.jsx("p",{children:r})]});if(!e||e.length===0)return l.jsx("div",{className:"text-center text-muted",style:{height:"400px",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsxs("div",{children:[l.jsx("h5",{children:"No Test Data Available"}),l.jsx("p",{children:"No tests have been completed yet for the current term."})]})});const n=e.map(s=>({testName:s.test_name,testDate:s.submitted_at,averageScore:parseFloat(s.average_score),totalStudents:s.total_students,testId:s.test_id}));return l.jsxs("div",{className:"test-performance-graph",children:[l.jsx("div",{style:{width:"100%",height:"400px"},children:l.jsx(XCe,{children:l.jsxs(A3e,{data:n,margin:{top:20,right:30,left:20,bottom:20},children:[l.jsx(cV,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),l.jsx(xV,{dataKey:"testDate",tickFormatter:s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric"}),stroke:"#666",fontSize:12}),l.jsx(yV,{domain:[0,100],tickFormatter:s=>`${s}%`,stroke:"#666",fontSize:12}),l.jsx($Ce,{formatter:(s,a)=>[`${parseFloat(s).toFixed(1)}%`,"Average Score"],labelFormatter:s=>{const a=n.find(i=>i.testDate===s);if(a){const i=new Date(s);return`${a.testName} (${i.toLocaleDateString("en-US",{month:"long",day:"numeric"})})`}return s},contentStyle:{backgroundColor:"#fff",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),l.jsx(pV,{type:"monotone",dataKey:"averageScore",stroke:"#007bff",strokeWidth:3,connectNulls:!0,dot:{r:6,fill:"#007bff",stroke:"#fff",strokeWidth:2},activeDot:{r:8,fill:"#ff6b35",stroke:"#fff",strokeWidth:2}})]})})}),l.jsx("div",{className:"mt-3",children:l.jsxs("div",{className:"row",children:[l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Total Tests: "}),l.jsx("strong",{children:n.length})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Average Score: "}),l.jsx("strong",{children:n.length>0?(()=>{const s=n.filter(i=>i.averageScore!==null&&i.averageScore!==void 0&&!isNaN(i.averageScore));return s.length===0?"N/A":`${(s.reduce((i,o)=>i+o.averageScore,0)/s.length).toFixed(1)}%`})():"N/A"})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Best Test: "}),l.jsx("strong",{children:n.length>0?(()=>{const s=n.filter(a=>a.averageScore!==null&&a.averageScore!==void 0&&!isNaN(a.averageScore));return s.length===0?"N/A":s.reduce((a,i)=>i.averageScore>a.averageScore?i:a).testName})():"N/A"})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Latest Test: "}),l.jsx("strong",{children:n.length>0?n[n.length-1].testName:"N/A"})]})})]})})]})},vM=({onBackToLogin:e})=>{const t=Po(),{user:r,isAuthenticated:n,logout:s,getCurrentTeacherUsername:a}=ds(),{teacherData:i,loadTeacherData:o}=o2(),{activeTests:c,loadActiveTests:u}=Vv(),{showNotification:d,notifications:f}=Aa(),[g,p]=S.useState(!0),[x,v]=S.useState(""),[w,C]=S.useState("main"),[k,_]=S.useState([]),[N,E]=S.useState([]),[P,F]=S.useState(null),[A,j]=S.useState(null),[I,B]=S.useState(null),[Y,Z]=S.useState(!1),[se,ee]=S.useState(!1),[te,L]=S.useState(null),[V,M]=S.useState([]),[H,W]=S.useState(null),[R,z]=S.useState(!1),[K,Q]=S.useState(!1),[ae,X]=S.useState(null),[ie,le]=S.useState(!1),[ce,_e]=S.useState(null),[ne,pe]=S.useState(null),[Ce,Ae]=S.useState([]),[Ge,Le]=S.useState(!1),[At,et]=S.useState(null),[pt,lt]=S.useState([]),[rt,ht]=S.useState(!1),[Lt,zt]=S.useState(null),[Dt,De]=S.useState(null),[Ie,Ke]=S.useState(!1),[Je,Ye]=S.useState(!1),[Tt,Nt]=S.useState(0),[Wt,or]=S.useState(!1),[dr,Er]=S.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[fr,nr]=S.useState([]),[me,Ne]=S.useState([]),[Fe,Re]=S.useState(!1),[bt,Pe]=S.useState(!1),[ze,ke]=S.useState(null),[$e,Be]=S.useState([]),[Et,It]=S.useState(!1),[Kt,wr]=S.useState("subject");S.useEffect(()=>{Se()},[]),S.useEffect(()=>{const Oe=dt=>{Ie&&!dt.target.closest(".relative")&&Ke(!1),Je&&!dt.target.closest(".relative")&&Ye(!1)};return document.addEventListener("mousedown",Oe),()=>{document.removeEventListener("mousedown",Oe)}},[Ie,Je]);const lr=S.useCallback(()=>{ge.debug(" showChangePasswordTab called"),or(!0),Ke(!1),Ye(!1)},[]),Fr=S.useCallback(()=>{ge.debug(" hideChangePasswordTab called"),or(!1),Er({currentPassword:"",newPassword:"",confirmPassword:""})},[]),ue=S.useCallback(async()=>{if(!r)return;const{currentPassword:Oe,newPassword:dt,confirmPassword:Rt}=dr;if(!Oe||!dt||!Rt){d("Please fill in all fields","error");return}if(dt!==Rt){d("New passwords do not match","error");return}if(dt.length<6){d("New password must be at least 6 characters long","error");return}const Pt=/[a-zA-Z]/.test(dt),mn=/[0-9]/.test(dt);if(!Pt||!mn){d("New password must contain both letters and numbers","error");return}try{const tt=await ms.changePassword({username:r.username,currentPassword:Oe,newPassword:dt});tt.success?(d("Password changed successfully!","success"),Fr()):d(tt.message||"Failed to change password","error")}catch(tt){ge.error("Password change error:",tt),d("Failed to change password. Please try again.","error")}},[r,dr,d]),be=S.useCallback(Oe=>{const{name:dt,value:Rt}=Oe.target;Er(Pt=>({...Pt,[dt]:Rt}))},[]),xe=S.useCallback(async()=>{ge.debug(" Loading teacher data...");try{const Oe=await ms.getTeacherData();return ge.debug(" Teacher data loaded:",Oe),pe(new Date),Oe}catch(Oe){throw ge.error(" Error loading teacher data:",Oe),Oe}},[]),he=S.useCallback(async(Oe=null)=>{ge.debug(" Loading teacher subjects...");try{if(!Oe){const Pt=`teacher_subjects_${r?.teacher_id||r?.id||""}`,mn=Bs(Pt);if(mn)return ge.debug(" Using cached teacher subjects"),_(mn),mn}let dt=Oe,Rt;if(Oe?(ge.debug(" Using passed teacher data for subjects"),Rt=ms.getTeacherSubjects(Oe.subjects)):(ge.debug(" No teacher data passed, fetching from API"),dt=await ms.getTeacherData(),ge.debug(" Raw teacher data:",dt),Rt=ms.getTeacherSubjects(dt.subjects)),ge.debug(" Teacher subjects loaded:",Rt),_(Rt),!Oe){const Pt=`teacher_subjects_${r?.teacher_id||r?.id||""}`;_s(Pt,Rt,Ls.teacher_subjects)}return ge.debug(" Available classes for performance chart:",Rt[0]?.classes||[]),ge.debug(" Performance chart will load when user clicks on a class"),Rt}catch(dt){throw ge.error(" Error loading teacher subjects:",dt),dt}},[r?.teacher_id,r?.id]),we=S.useCallback(async()=>{ge.debug(" Loading teacher active tests...");try{const Oe=`teacher_tests_${r?.teacher_id||r?.id||""}`,dt=Bs(Oe);dt&&dt.some(mn=>mn.test_type==="drawing")&&(ge.debug(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(Oe));const Rt=Bs(Oe);if(Rt)return ge.debug(" Using cached teacher tests"),E(Rt),Rt;const Pt=await fn.getTeacherTests();return ge.debug(" Teacher tests loaded:",Pt),E(Pt),_s(Oe,Pt,Ls.teacher_tests),Pt}catch(Oe){throw ge.error(" Error loading teacher tests:",Oe),Oe}},[r?.teacher_id,r?.id]),Se=S.useCallback(async()=>{ge.debug(" Initializing Teacher Cabinet...");try{if(p(!0),v(""),!n||!r){ge.debug(" User not authenticated"),v("User not authenticated");return}if(r.role!==no.TEACHER){ge.error(" Invalid user role for teacher cabinet:",r.role),v("Access denied. Teacher role required.");return}ge.debug(" Loading teacher data...");const Oe=await xe();ge.debug(" Loading subjects and tests in parallel...");const[dt,Rt]=await Promise.allSettled([he(Oe),we()]);let Pt=!1;dt.status==="rejected"&&(ge.warn(" Subjects loading failed:",dt.reason),Pt=!0),Rt.status==="rejected"&&(ge.warn(" Tests loading failed:",Rt.reason),Pt=!0),Pt&&d("Some data failed to load, but you can continue","warning"),ge.debug(" Teacher Cabinet initialization complete!")}catch(Oe){ge.error(" Error initializing teacher cabinet:",Oe),v("Failed to initialize teacher cabinet")}finally{p(!1)}},[n,r,xe,he,we,d]),He=S.useCallback(()=>{ge.debug(" Showing subject selection prompt..."),Z(!0),ct(),wr("subject")},[]),ct=S.useCallback(async()=>{ge.debug(" Loading available subjects..."),Re(!0);try{const Oe=await ms.getSubjectsForSelection();nr(Oe),ge.debug(" Available subjects loaded:",Oe)}catch(Oe){ge.error(" Error loading available subjects:",Oe),d("Failed to load subjects","error")}finally{Re(!1)}},[]),qe=S.useCallback(Oe=>{if(!Oe){ke(null);return}const dt=fr.find(Rt=>Rt.subject_id==Oe);dt&&(ke(dt),Be([]),wr("classes"))},[fr]),oe=S.useCallback((Oe,dt)=>{Be(Rt=>Rt.some(Pt=>Pt.grade===Oe&&Pt.class===dt)?Rt.filter(Pt=>!(Pt.grade===Oe&&Pt.class===dt)):[...Rt,{grade:Oe,class:dt}])},[]),fe=S.useCallback(()=>{if(!ze||$e.length===0){d("Please select at least one class","warning");return}const Oe={subject_id:parseInt(ze.subject_id),subject_name:ze.subject,classes:$e};Ne(dt=>[...dt,Oe]),ke(null),Be([]),wr("subject"),d(`Added ${ze.subject} with ${$e.length} classes`,"success")},[ze,$e]),Te=S.useCallback(Oe=>{Ne(dt=>dt.filter((Rt,Pt)=>Pt!==Oe))},[]),Ee=S.useCallback(async(Oe,dt,Rt)=>{ge.debug(" Deleting teacher subject:",{subjectId:Oe,grade:dt,classNumber:Rt});try{const Pt={subjectId:Oe,grade:dt,class:Rt};ge.debug(" Sending delete request with data:",Pt);const mn=await ms.deleteTeacherSubject(Pt);if(mn.success)d("Subject assignment deleted successfully!","success"),await he();else throw new Error(mn.error||"Failed to delete subject assignment")}catch(Pt){ge.error(" Error deleting subject assignment:",Pt),d("Error deleting subject assignment. Please try again.","error")}},[he,d]),Xe=S.useCallback((Oe,dt,Rt,Pt)=>{_e({subjectId:Oe,subjectName:dt,grade:Rt,classNumber:Pt}),le(!0)},[]),ot=S.useCallback(async()=>{ce&&(await Ee(ce.subjectId,ce.grade,ce.classNumber),le(!1),_e(null))},[ce,Ee]),xt=S.useCallback(()=>{le(!1),_e(null)},[]),qt=S.useCallback(async()=>{if(me.length===0){d("Please select at least one subject","warning");return}Pe(!0);try{const Oe=await ms.saveTeacherSubjects(me);if(Oe.success)d("Subjects saved successfully!","success"),Z(!1),Ne([]),wr("subject"),await he();else throw new Error(Oe.error||"Failed to save subjects")}catch(Oe){ge.error(" Error saving teacher subjects:",Oe),d("Failed to save subjects","error")}finally{Pe(!1)}},[me,he]);S.useCallback(async Oe=>{ge.debug(" Saving teacher subjects:",Oe);try{const dt=await ms.saveTeacherSubjects(Oe);if(dt.success)d("Subjects saved successfully!","success"),await he(),Z(!1);else throw new Error(dt.error||"Failed to save subjects")}catch(dt){ge.error(" Error saving teacher subjects:",dt),d("Failed to save subjects","error")}},[he]);const yt=S.useCallback(()=>{ge.debug(" Showing active tests..."),C("tests")},[]),Yt=S.useCallback(async Oe=>{ge.debug(" Showing test details:",Oe),L(Oe),ee(!0),M([]),W(null),z(!0);try{if(["input","true_false","multiple_choice"].includes(Oe.test_type)){const dt=await fn.getTestQuestionsWithInfo(Oe.test_type,Oe.test_id);M(dt.questions||[]),W(dt.testInfo||null),ge.debug(" Test questions and info loaded:",{questionsCount:dt.questions?.length||0,testInfo:dt.testInfo})}}catch(dt){console.error("Error loading test questions:",dt),d("Error loading test questions. Please try again.","error")}finally{z(!1)}},[d]);S.useCallback(async(Oe,dt,Rt)=>{ge.debug(" Removing class assignment:",Oe,dt,Rt);try{const Pt=await fn.removeClassAssignment(Oe,dt,Rt);if(Pt.success)d("Assignment removed successfully!","success"),await we();else throw new Error(Pt.error||"Failed to remove assignment")}catch(Pt){ge.error(" Error removing class assignment:",Pt),d("Failed to remove assignment","error")}},[we]);const _r=S.useCallback(async(Oe,dt)=>{ge.debug(" Marking test as completed:",Oe,dt),et(dt);try{const Rt=await fn.markTestCompleted(Oe,dt);if(Rt.success){d("Test marked as completed!","success");const Pt=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(Pt),ge.debug(" Cleared teacher tests cache"),await we()}else throw new Error(Rt.error||"Failed to mark test as completed")}catch(Rt){ge.error(" Error marking test as completed:",Rt),d("Failed to mark test as completed","error")}finally{et(null)}},[we,d,r?.teacher_id,r?.id]),kr=S.useCallback(async()=>{ge.debug(" Refreshing active tests data...");try{const Oe=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(Oe),ge.debug(" Cache cleared, forcing fresh API call"),ge.debug(" Making direct API call to get-teacher-active-tests with noCache");const dt=await fn.getTeacherTests(!0);ge.debug(" Direct API call returned:",dt),E(dt),ge.debug(" activeTestsData state updated:",dt),d(`Tests refreshed successfully! Found ${dt?.length||0} tests.`,"success")}catch(Oe){ge.error(" Error refreshing tests:",Oe),d("Failed to refresh tests","error")}},[r?.teacher_id,r?.id]),xr=S.useCallback(async(Oe=null)=>{if(r?.teacher_id){ht(!0),zt(null);try{ge.debug(" Loading test performance data for class:",Oe);const dt=await Nxe.getTestPerformance(r.teacher_id,Oe);lt(dt),ge.debug(" Test performance data loaded:",dt.length,"tests")}catch(dt){ge.error(" Error loading test performance data:",dt),zt(dt.message)}finally{ht(!1)}}},[r?.teacher_id]);S.useCallback((Oe,dt)=>{ge.debug(" Showing class results:",Oe,dt),ge.debug(" Class click - grade:",Oe,"className:",dt),j(Oe),B(dt),C("results");const Rt=`${Oe}/${dt}`;ge.debug(" Loading performance data for clicked class:",Rt),De(Rt),xr(Rt)},[xr]);const[Gr,un]=S.useState([]),[Xr,cr]=S.useState([]),na=S.useCallback(async()=>{try{const dt=await(await mi(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestAssignments(r.teacher_id);un(dt)}catch(Oe){ge.warn("Failed to load retests",Oe)}},[r]);S.useCallback(async Oe=>{try{const Rt=await(await mi(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestTargets(Oe);cr(Rt)}catch(dt){ge.warn("Failed to load retest targets",dt)}},[]);const[hn,Gn]=S.useState(!1),[Nn,Ws]=S.useState(!1);S.useEffect(()=>{ge.debug("[TeacherCabinet] showRetestModal state changed:",hn)},[hn]);const[Sn,ye]=S.useState({test_type:"",original_test_id:"",subject_id:"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:[]}),wt=S.useCallback(async Oe=>{ge.debug("[TeacherCabinet] openRetestModal called with:",Oe);const{test_type:dt,original_test_id:Rt,subject_id:Pt,failedStudentIds:mn=[],grade:tt,class:mt}=Oe||{};ye({test_type:dt||"multiple_choice",original_test_id:Rt||"",subject_id:Pt||"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:mn}),tt!==void 0&&j(tt),mt!==void 0&&B(mt),ge.debug("[TeacherCabinet] Setting showRetestModal to true"),Gn(!0)},[]),Nr=S.useCallback(async()=>{Ws(!0);try{const Oe=await mi(()=>import("./retestService-C6b0YDiD.js"),[]),dt=new Date,Rt=new Date(dt.getTime()+Sn.window_days*24*60*60*1e3),Pt={...Sn,teacher_id:r.teacher_id,grade:A,class:I,window_start:dt.toISOString(),window_end:Rt.toISOString()};ge.debug("[Retest][TeacherCabinet] Prepared payload:",JSON.stringify(Pt)),ge.debug("[Retest][TeacherCabinet] Selected students count:",(Pt.student_ids||[]).length,"IDs:",Pt.student_ids),await Oe.retestService.createRetestAssignment(Pt),d("Retest created","success"),Gn(!1),na(),Nt(mn=>mn+1)}catch(Oe){ge.error("Create retest error",Oe),d(Oe.message||"Failed to create retest","error")}finally{Ws(!1)}},[Sn,A,I,na]);if(g)return l.jsxs("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(Wr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]}),l.jsx("div",{className:"flex flex-wrap gap-2"})]});if(x)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:x}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs(at.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(at.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(at.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),l.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",a()||""]})]}),l.jsxs(at.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx("div",{className:"hidden md:block",children:l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>Ke(!Ie),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[l.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:Ie?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),Ie&&l.jsxs(at.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("button",{onClick:()=>{Ke(!1),lr()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{Ke(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})}),l.jsxs("div",{className:"md:hidden",children:[l.jsx("button",{onClick:()=>Ye(!Je),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Je&&l.jsxs(at.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:a()||"Teacher"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),l.jsxs("button",{onClick:()=>{Ye(!1),lr()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{Ye(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})]})]})})}),l.jsx(at.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:l.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((Oe,dt)=>l.jsxs(at.button,{onClick:()=>Oe.key==="tests"?yt():C(Oe.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 flex-1 sm:flex-none ${w===Oe.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+dt*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[l.jsx("span",{className:"sm:hidden",children:Oe.shortLabel}),l.jsx("span",{className:"hidden sm:inline",children:Oe.label})]},Oe.key))})})}),l.jsx(at.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:l.jsxs(ko,{mode:"wait",children:[w==="main"&&l.jsx(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Or()},"main"),w==="subjects"&&l.jsx(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Vn()},"subjects"),w==="tests"&&l.jsx(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:dn()},"tests"),w==="results"&&l.jsx(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:l.jsx(iz,{selectedGrade:A,selectedClass:I,onBackToCabinet:()=>C("main"),openRetestModal:wt,forceRefreshOnMount:Tt>0},Tt)},"results")]})}),Y&&l.jsx(fa,{isOpen:Y,onClose:()=>{Z(!1),wr("subject"),Ne([]),ke(null),Be([])},title:"Select Subjects and Classes",size:"large",children:l.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[Kt==="subject"&&l.jsxs(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),Fe?l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):l.jsxs("select",{value:ze?.subject_id||"",onChange:Oe=>qe(Oe.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Select a subject"}),fr.map(Oe=>l.jsx("option",{value:Oe.subject_id,children:Oe.subject},Oe.subject_id))]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(Ze,{variant:"primary",onClick:()=>wr("classes"),disabled:!ze,children:"Next: Select Classes"})]})]}),Kt==="classes"&&ze&&l.jsxs(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",ze.subject]}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),l.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:l.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6,7].map(Oe=>{let dt;return Oe===1||Oe===2||Oe===3?dt=[15,16]:Oe===4||Oe===5||Oe===6?dt=[13,14]:Oe===7?dt=[69]:dt=[],l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",Oe]}),l.jsx("div",{className:"space-y-1",children:dt.map(Rt=>l.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[l.jsx("input",{type:"checkbox",checked:$e.some(Pt=>Pt.grade===Oe.toString()&&Pt.class===Rt.toString()),onChange:()=>oe(Oe.toString(),Rt.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",Rt]})]},Rt))})]},Oe)})})})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(Ze,{variant:"outline",onClick:()=>wr("subject"),children:"Back to Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(Ze,{variant:"primary",onClick:fe,disabled:$e.length===0,children:"Add Subject"})]})]})]}),me.length>0&&l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),l.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:me.map((Oe,dt)=>l.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:Oe.subject_name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",Oe.classes.map(Rt=>`Grade ${Rt.grade} Class ${Rt.class}`).join(", ")]})]}),l.jsx("button",{onClick:()=>Te(dt),className:"text-red-600 hover:text-red-800 p-1",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},dt))})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(Ze,{variant:"outline",onClick:()=>wr("subject"),children:"Add More Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(Ze,{variant:"primary",onClick:qt,disabled:bt,className:"relative",children:bt?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save All Subjects"})]})]})]})]})}),hn&&l.jsxs(fa,{isOpen:hn,onClose:()=>Gn(!1),title:"Create Retest",size:"medium",children:[l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retest Window"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:Sn.window_days,onChange:Oe=>ye(dt=>({...dt,window_days:Number(Oe.target.value)})),children:[l.jsx("option",{value:1,children:"1 day"}),l.jsx("option",{value:2,children:"2 days"}),l.jsx("option",{value:3,children:"3 days"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Attempts"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:Sn.max_attempts,onChange:Oe=>ye(dt=>({...dt,max_attempts:Number(Oe.target.value)})),children:[l.jsx("option",{value:1,children:"1 attempt"}),l.jsx("option",{value:2,children:"2 attempts"}),l.jsx("option",{value:3,children:"3 attempts"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students can retry immediately if they fail"})]})]})}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:()=>Gn(!1),disabled:Nn,className:"px-4 py-2 text-sm rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),l.jsx("button",{onClick:Nr,disabled:Nn,className:"px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:Nn?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm"}),"Creating Retest..."]}):"Create Retest"})]})]}),se&&te&&l.jsxs(fa,{isOpen:se,onClose:()=>ee(!1),title:"Test Details",size:"large",children:[l.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto pr-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:te.test_name})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),l.jsx("p",{className:"text-sm text-gray-900",children:te.subject})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Type:"}),l.jsx("p",{className:"text-sm text-gray-900",children:te.test_type})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),l.jsx("p",{className:"text-sm text-gray-900",children:new Date(te.created_at).toLocaleDateString()})]}),(H||te)&&l.jsx("div",{className:"space-y-2",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[["input","true_false","multiple_choice"].includes(te.test_type)&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Shuffled:"}),l.jsx("span",{className:`text-sm font-semibold ${H?.is_shuffled||te.is_shuffled?"text-green-600":"text-gray-400"}`,children:H?.is_shuffled||te.is_shuffled?" Yes":" No"})]}),(H?.allowed_time||te.allowed_time)&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Timer:"}),l.jsxs("span",{className:"text-sm font-semibold text-blue-600",children:[" ",Math.floor((H?.allowed_time||te.allowed_time)/60)," minutes"]})]}),!(H?.allowed_time||te.allowed_time)&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Timer:"}),l.jsx("span",{className:"text-sm font-semibold text-gray-400",children:" Not set"})]})]})}),te.assignments&&te.assignments.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:te.assignments.map((Oe,dt)=>l.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[Oe.grade,"/",Oe.class]},dt))})]}),["input","true_false","multiple_choice"].includes(te.test_type)&&l.jsxs("div",{className:"mt-6 border-t pt-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions and Correct Answers"}),R?l.jsx("div",{className:"flex justify-center items-center py-8",children:l.jsx(Wr,{size:"md"})}):V.length>0?l.jsx("div",{className:"space-y-4",children:V.map((Oe,dt)=>{if(te.test_type==="multiple_choice"){const Rt=Oe.correct_answer;return l.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsxs("span",{className:"text-sm font-semibold text-gray-700 min-w-[2rem]",children:["Q",dt+1,":"]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm text-gray-900 mb-2",children:Oe.question}),l.jsxs("div",{className:"mt-2",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Options:"}),l.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:Oe.options&&Oe.options.map((Pt,mn)=>{const tt=String.fromCharCode(97+mn).toUpperCase();return l.jsxs("div",{className:`p-2 rounded ${tt===Rt?"bg-green-100 border-2 border-green-500":"bg-white border border-gray-200"}`,children:[l.jsxs("span",{className:"font-semibold",children:[tt,":"]})," ",Pt,tt===Rt&&l.jsx("span",{className:"ml-2 text-green-700 font-bold",children:" Correct"})]},mn)})})]})]})]})},Oe.question_id||dt)}if(te.test_type==="true_false"){const Rt=Oe.correct_answer,Pt=Rt===!0||Rt==="true"||Rt===1||Rt==="1";return l.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsxs("span",{className:"text-sm font-semibold text-gray-700 min-w-[2rem]",children:["Q",dt+1,":"]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm text-gray-900 mb-2",children:Oe.question}),l.jsx("div",{className:"mt-2",children:l.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded ${Pt?"bg-green-100 border-2 border-green-500":"bg-red-100 border-2 border-red-500"}`,children:l.jsxs("span",{className:"text-sm font-semibold",children:["Correct Answer: ",Pt?"True":"False"]})})})]})]})},Oe.question_id||dt)}if(te.test_type==="input"){const Rt=Oe.correct_answers||[];return l.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsxs("span",{className:"text-sm font-semibold text-gray-700 min-w-[2rem]",children:["Q",dt+1,":"]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm text-gray-900 mb-2",children:Oe.question}),l.jsxs("div",{className:"mt-2",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Correct Answer(s):"}),Rt.length>0?l.jsx("div",{className:"flex flex-wrap gap-2",children:Rt.map((Pt,mn)=>l.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded bg-green-100 border-2 border-green-500 text-sm font-semibold text-green-800",children:Pt},mn))}):l.jsx("span",{className:"text-sm text-gray-400 italic",children:"No correct answers specified"})]})]})]})},Oe.question_id||dt)}return null})}):l.jsx("p",{className:"text-sm text-gray-500 italic",children:"No questions available for this test."})]})]}),l.jsx("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t",children:l.jsx(Ze,{variant:"outline",onClick:()=>ee(!1),children:"Close"})})]}),ie&&ce&&l.jsx(fa,{isOpen:ie,onClose:xt,title:"Delete Subject Assignment",size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:l.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Subject Assignment"}),l.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the assignment for"," ",l.jsx("span",{className:"font-semibold text-gray-900",children:ce.subjectName})," ","in Grade ",ce.grade,", Class ",ce.classNumber,"?"]}),l.jsx("p",{className:"text-xs text-red-600",children:"This action cannot be undone."})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx(Ze,{variant:"outline",onClick:xt,children:"Cancel"}),l.jsx(Ze,{variant:"danger",onClick:ot,children:"Delete Assignment"})]})]})}),l.jsx(at.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:f.map(Oe=>l.jsx(at.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:l.jsx("div",{className:`p-4 rounded-lg shadow-lg ${Oe.type==="success"?"bg-green-600 text-white":Oe.type==="error"?"bg-red-600 text-white":Oe.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:Oe.message}),l.jsx("button",{onClick:()=>setNotifications(dt=>dt.filter(Rt=>Rt.id!==Oe.id)),className:"ml-4 text-white hover:text-gray-200",children:""})]})})},Oe.id))}),Wt&&l.jsx(fa,{isOpen:Wt,onClose:Fr,title:"Change Password",size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",name:"currentPassword",value:dr.currentPassword,onChange:be,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter current password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",name:"newPassword",value:dr.newPassword,onChange:be,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter new password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",name:"confirmPassword",value:dr.confirmPassword,onChange:be,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Confirm new password"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:Fr,className:"flex-1",children:"Cancel"}),l.jsx(Ze,{type:"button",onClick:ue,className:"flex-1",children:"Change Password"})]})]})})]});function Or(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsxs(jt,{children:[l.jsx(jt.Header,{children:l.jsx(jt.Title,{children:"My Subjects & Classes"})}),l.jsx(jt.Body,{children:k.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),l.jsx(Ze,{variant:"outline",onClick:()=>C("subjects"),children:"Manage Subjects"})]}):l.jsx("div",{className:"space-y-6",children:k.map((Oe,dt)=>l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+dt*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Oe.name}),l.jsxs("span",{className:"text-sm text-gray-500",children:[Oe.classes?.length||0," classes"]})]}),Oe.classes&&Oe.classes.length>0?l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Oe.classes.map((Rt,Pt)=>l.jsx(at.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+dt*.1+Pt*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:l.jsxs(Ze,{variant:"outline",size:"sm",onClick:()=>{j(Rt.grade),B(Rt.class),C("results")},className:"font-medium",children:[Rt.grade,"/",Rt.class]})},Pt))}):l.jsx("div",{className:"text-center py-4 text-gray-500",children:l.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},Oe.id))})})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:l.jsxs(jt,{children:[l.jsxs(jt.Header,{children:[l.jsx(jt.Title,{children:"Test Performance Overview"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Test performance over time with average scores"})]}),l.jsx(jt.Body,{children:k.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"mb-2",children:l.jsx("img",{src:"/pics/Graph.png",alt:"Performance Graph",className:"w-16 h-16 object-contain mx-auto"})}),l.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const Oe=[];return k.forEach(dt=>{dt.classes&&dt.classes.forEach(Rt=>{const Pt=`${Rt.grade}/${Rt.class}`;Oe.find(mn=>mn.key===Pt)||Oe.push({key:Pt,grade:Rt.grade,class:Rt.class,subject:dt.name})})}),Oe})().map((Oe,dt)=>l.jsxs("button",{onClick:()=>{ge.debug(" Class button clicked:",Oe.key),De(Oe.key),xr(Oe.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${Dt===Oe.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[Oe.grade,"/",Oe.class]},Oe.key))}),Dt?l.jsx("div",{className:"mt-4",children:l.jsx(j3e,{data:pt,loading:rt,error:Lt})}):l.jsxs("div",{className:"mt-4 text-center text-muted py-4",children:[l.jsx("div",{className:"mb-2",children:l.jsx("img",{src:"/pics/Graph.png",alt:"Performance Graph",className:"w-16 h-16 object-contain mx-auto"})}),l.jsx("p",{className:"text-gray-500",children:"Select a class above to view test performance data"})]})]})})]})})]})}function Vn(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(jt,{children:l.jsx(jt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(jt.Title,{children:"Subject Management"}),l.jsx(Ze,{variant:"primary",onClick:He,children:"Add Subject"})]})})})}),k.length===0?l.jsx(at.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(jt,{children:l.jsx(jt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(at.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),l.jsx(Ze,{variant:"primary",onClick:He,size:"lg",children:"Add Your First Subject"})]})})})}):l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:l.jsxs(jt,{children:[l.jsx(jt.Header,{children:l.jsx(jt.Title,{children:"Your Subjects"})}),l.jsx(jt.Body,{children:l.jsx("div",{className:"space-y-4",children:k.map((Oe,dt)=>l.jsx(at.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+dt*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:l.jsx("div",{className:"flex justify-between items-start",children:l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:Oe.name}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Oe.classes?.map((Rt,Pt)=>l.jsxs(at.div,{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+dt*.1+Pt*.05,duration:.2},whileHover:{scale:1.1},children:[l.jsxs("span",{children:[Rt.grade," - ",Rt.className]}),l.jsx("button",{onClick:()=>Xe(Oe.id,Oe.name,Rt.grade,Rt.class),className:"ml-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete this subject assignment",children:l.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},Pt))||l.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},dt))})})]})})]})}function dn(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(jt,{children:l.jsx(jt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(jt.Title,{children:"Active Tests"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Ze,{variant:"outline",onClick:kr,children:"Refresh"}),l.jsx(Ze,{variant:"primary",onClick:()=>t("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),N.length===0?l.jsx(at.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(jt,{children:l.jsx(jt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(at.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),l.jsx(Ze,{variant:"primary",onClick:()=>t("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:N.map((Oe,dt)=>l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+dt*.1,duration:.3},whileHover:{scale:1.01},children:l.jsx(jt,{children:l.jsx(jt.Body,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"flex-1 flex items-center space-x-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0 max-w-xs truncate",title:Oe.test_name,children:Oe.test_name}),l.jsx("span",{className:"hidden sm:inline-block bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:Oe.test_type}),l.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[l.jsx("span",{className:"font-medium",children:"Assignments:"}),l.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:Oe.assignments?.length||0})]}),Oe.assignments&&Oe.assignments.length>0&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[l.jsx("span",{className:"font-medium",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1",children:Oe.assignments.map((Rt,Pt)=>l.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[Rt.grade,"/",Rt.class]},Pt))})]}),l.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(Oe.created_at).toLocaleDateString()})]})]}),l.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[l.jsx("div",{className:"sm:hidden",children:l.jsx(Ze,{variant:"outline",onClick:()=>Yt(Oe),size:"sm",className:"text-xs",title:`Type: ${Oe.test_type} | Assignments: ${Oe.assignments?.length||0} | Classes: ${Oe.assignments?.map(Rt=>`${Rt.grade}/${Rt.class}`).join(", ")||"None"} | ${new Date(Oe.created_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}`,children:"Details"})}),l.jsx("div",{className:"hidden sm:block",children:l.jsx(Ze,{variant:"outline",onClick:()=>Yt(Oe),size:"sm",children:"Details"})}),l.jsx(Ze,{variant:"success",onClick:()=>_r(Oe.test_type,Oe.test_id),size:"sm",disabled:At===Oe.test_id,children:At===Oe.test_id?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Completing..."]}):"Complete"})]})]})})})},dt))})]})}},P3e={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing",fillBlanks:"fill_blanks",speaking:"speaking"},wM=()=>{const{user:e}=ds();uae();const{notifications:t,showNotification:r,removeNotification:n}=Aa(),[s,a]=S.useState(!1),[i,o]=S.useState(!1),[c,u]=S.useState("typeSelection"),[d,f]=S.useState(!1),[g,p]=S.useState(null),[x,v]=S.useState([]),[w,C]=S.useState(!1),[k,_]=S.useState(!1),[N,E]=S.useState(!1),[P,F]=S.useState(!1),[A,j]=S.useState({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:"",isShuffled:!1}),[I,B]=S.useState([]),[Y,Z]=S.useState(null);S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null);const se=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" Setting up test creation event listeners..."),W(),console.log(" Test creation initialization complete")},[e,r]),ee=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" showTestTypeSelection called - starting new test creation"),o(!1),console.log(" Reset testAssignmentCompleted flag to false"),a(!0),console.log(" Set isInTestCreation flag to true"),te(),u("typeSelection"),V("testTypeSelection")},[e,r]),te=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log(" Disabling navigation buttons..."),f(!0)},[e]),L=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log(" Enabling navigation buttons..."),f(!1)},[e]),V=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("  saveTestCreationState called with step:",oe),console.log("  Call stack:",new Error().stack);const fe={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},Te={isInTestCreation:!0,currentStep:oe,timestamp:Date.now(),excelState:fe};localStorage.setItem("test_creation_state",JSON.stringify(Te)),console.log(" Saved test creation state:",Te);const Ee={};switch(oe){case"testTypeSelection":break;case"multipleChoiceForm":Ee.testName=A.testName||"",Ee.numQuestions=A.numQuestions||"",Ee.numOptions=A.numOptions||"",Ee.questions=A.questions||{};break;case"trueFalseForm":Ee.testName=A.testName||"",Ee.numQuestions=A.numQuestions||"",Ee.questions=A.questions||{};break;case"inputForm":Ee.testName=A.testName||"",Ee.numQuestions=A.numQuestions||"",Ee.questions=A.questions||{};break;case"formCreation":Ee.testName=A.testName||"",Ee.numQuestions=A.numQuestions||"",Ee.numOptions=A.numOptions||"",Ee.questions=A.questions||{},Ee.enableTimer=!!A.enableTimer,Ee.timerMinutes=A.timerMinutes||"",Ee.isShuffled=!!A.isShuffled;break;case"assignment":case"testAssignment":Ee.testName=A.testName||"",Ee.numQuestions=A.numQuestions||"",Ee.numOptions=A.numOptions||"",Ee.questions=A.questions||{};break;default:console.log(" Unknown step in saveTestCreationState:",oe);break}Object.keys(Ee).length>0&&(localStorage.setItem(`form_data_${oe}`,JSON.stringify(Ee)),console.log(" Saved form data for step:",oe,Ee))},[e,A]),M=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const oe=[];for(let fe=0;fe<localStorage.length;fe++){const Te=localStorage.key(fe);Te&&(Te.includes("test")||Te.includes("form")||Te.includes("question"))&&oe.push(Te)}oe.forEach(fe=>{localStorage.removeItem(fe),console.log(" Removed localStorage key:",fe)}),console.log(" Cleared test creation state from localStorage")},[e]);S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log(" Clearing all test form fields..."),j({testName:"",numQuestions:0,numOptions:0,questions:{}}),p(null),B([]),Z(null),console.log(" Cleared all test form fields")},[e]);const H=S.useCallback(()=>{console.log(" Resetting Excel upload state..."),Ye({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(fe=>{const Te=document.querySelector(`.excel-upload-btn[data-test-type="${fe}"]`);Te&&(Te.style.display="none",console.log(" Excel button hidden for:",fe));const Ee=document.querySelector(`.excel-hint[data-test-type="${fe}"]`);Ee&&(Ee.style.display="none",console.log(" Excel hint hidden for:",fe));const Xe=document.querySelector(`.excel-file-input[data-test-type="${fe}"]`);Xe&&(Xe.value="",console.log(" File input cleared for:",fe))}),console.log(" Excel upload state reset complete")},[]),W=S.useCallback(()=>{console.log(" Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions","enableTimer","timerMinutes","isShuffled"].forEach(fe=>{const Te=document.getElementById(fe);Te&&Te.addEventListener("input",()=>{console.log(` Auto-save triggered for field: ${fe}`)})}),console.log(" Form auto-save setup complete")},[]);S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("  saveFormDataForStep called with step:",oe),console.log("  Call stack:",new Error().stack);const fe={};switch(oe){case"testTypeSelection":break;case"multipleChoiceForm":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.numOptions=A.numOptions||"",fe.questions=A.questions||{};break;case"trueFalseForm":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.questions=A.questions||{};break;case"inputForm":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.questions=A.questions||{};break;case"formCreation":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.numOptions=A.numOptions||"",fe.questions=A.questions||{};break;default:console.log(" Unknown step for form data save:",oe);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:oe,data:fe,timestamp:Date.now()})),console.log(" Saved form data for step:",oe,fe)},[e,A]);const R=S.useCallback(async oe=>{console.log(" Restoring form data for step:",oe);try{const fe=localStorage.getItem(`form_data_${oe}`);if(fe){const Te=JSON.parse(fe);console.log(" Restored form data:",Te),j(Ee=>{const Xe={...Ee,...Te};return console.log(" Updated formData with restored data:",Xe),console.log(" Matching test data in restored data:",Xe.matchingTestData),Xe}),Object.keys(Te).forEach(Ee=>{const Xe=document.getElementById(Ee);Xe&&Te[Ee]!==void 0&&(Xe.value=Te[Ee])}),console.log(" Form data restored for step:",oe)}else console.log(" No saved data found for step:",oe)}catch(fe){console.error(" Error restoring form data:",fe)}},[e]),z=S.useCallback(()=>{console.log(" Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(Te=>{const Ee=document.getElementById(Te);Ee&&Ee.addEventListener("input",()=>{console.log(` Auto-save triggered for MC field: ${Te}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(Te=>{Te.addEventListener("input",()=>{console.log(" Auto-save triggered for MC question field")})}),console.log(" Multiple choice form auto-save setup complete")},[]),K=S.useCallback(()=>{console.log(" Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(fe=>{fe.addEventListener("input",()=>{console.log(" Auto-save triggered for TF question field")})}),console.log(" True/false form auto-save setup complete")},[]),Q=S.useCallback(()=>{console.log(" Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(fe=>{fe.addEventListener("input",()=>{console.log(" Auto-save triggered for Input question field")})}),console.log(" Input form auto-save setup complete")},[]),ae=S.useCallback(oe=>{console.log(" showExcelUploadButton called with testType:",oe);const fe=oe==="multiple-choice"?"multipleChoice":oe==="true-false"?"trueFalse":oe==="input"?"input":oe;Ye(Te=>({...Te,[fe]:{...Te[fe],buttonVisible:!0}}))},[]),X=S.useCallback(oe=>{console.log(" showExcelHint called with testType:",oe);const fe=oe==="multiple-choice"?"multipleChoice":oe==="true-false"?"trueFalse":oe==="input"?"input":oe;Ye(Te=>({...Te,[fe]:{...Te[fe],hintVisible:!0}}))},[]),ie=S.useCallback(async(oe,fe,Te)=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:oe,testType:fe,testId:Te}),v(oe),console.log(" Test assignment options displayed for:",{testType:fe,testId:Te,classesCount:oe.length})},[e]),le=S.useCallback(async(oe,fe)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",e.teacher_id);const Ee=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log("Teacher subjects response:",Ee),Ee.success&&Ee.subjects&&Ee.subjects.length>0?(console.log("Teacher subjects loaded:",Ee.subjects),v(Ee.subjects),ie(Ee.subjects,oe,fe)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(Te){console.error("Error loading teacher grades and classes:",Te),r("Error loading teacher grades and classes","error")}},[e,r,ie]),ce=S.useCallback(async()=>{if(console.log(" Loading available classes..."),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}try{const fe=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log(" Teacher subjects response:",fe),fe.success&&fe.subjects&&fe.subjects.length>0?(console.log(" Teacher subjects loaded:",fe.subjects),v(fe.subjects)):(console.log("No teacher subjects found"),v([]),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(oe){console.error(" Error loading available classes:",oe),r("Failed to load available classes","error")}},[e,r]);S.useCallback(async(oe,fe)=>{if(i){o(!1);return}if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}te(),V("testAssignment"),Z(fe),p(oe),u("testAssignment"),le(oe,fe),console.log(" Test assignment interface shown for:",{testType:oe,testId:fe})},[i,e,te,V,le]);const _e=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log(" Displaying teacher active tests:",oe),oe.length===0){Le([]);return}Le(oe),console.log(" Active tests displayed:",oe.length,"tests")},[e]);S.useCallback(async(oe,fe)=>{try{console.log(" Loading test questions for:",{testType:oe,testId:fe});const Te=await fn.getTestQuestions(fe,oe);return console.log(" Test questions loaded:",Te),Te}catch(Te){throw console.error("Error loading test questions:",Te),Te}},[]),S.useCallback((oe,fe,Te,Ee)=>{console.log(" Showing teacher test details modal:",{testType:oe,testId:fe,testName:Te,questionsCount:Ee.length}),console.log("Test Details:",{testType:oe,testId:fe,testName:Te,questions:Ee.map(Xe=>({id:Xe.question_id,question:Xe.question,correctAnswer:Xe.correct_answer}))}),r(`Test details for "${Te}" loaded successfully.`,"success")},[r]);const ne=S.useCallback(async()=>{console.log(" DEBUG: loadTeacherActiveTests called");try{console.log(" DEBUG: Fetching teacher active tests using JWT authentication...");const oe=await fn.getTeacherTests();console.log(" DEBUG: Tests loaded:",oe),oe&&oe.length>0?(console.log(" DEBUG: Success! Displaying",oe.length,"tests"),_e(oe)):(console.log(" DEBUG: No tests found"),Le([]))}catch(oe){console.error(" DEBUG: Error loading active tests:",oe),r("Error loading active tests.","error")}},[r,_e]),pe=S.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}}),B([]),o(!1),a(!1),M()},[r,M]),Ce=S.useCallback(async(oe,fe)=>{if(console.log(" === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log(" Test Type:",oe),console.log(" Test ID:",fe),console.log(" Current formData:",A),console.log(" Selected Classes:",I),console.log(" User:",e),!e||!e.teacher_id){console.error(" No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}if(console.log(" Teacher ID:",e.teacher_id),I.length===0){console.warn(" No classes selected"),r("Please select at least one class.","warning");return}try{console.log(" Preparing test + assignment request..."),await xc.loadAcademicCalendar();const Ee=xc.getCurrentTerm()?.id;if(!Ee)throw new Error("No current academic period found");const Xe=I.map(yt=>{const Yt={grade:parseInt(yt.grade),class:parseInt(yt.class),subject_id:parseInt(yt.subject_id),academic_period_id:Ee,due_date:null};return console.log(" Created assignment:",Yt),Yt});if(console.log(" Final assignments array:",Xe),oe==="matching"){console.log(" Processing matching test..."),console.log(" Setting isAssigningTest to true for matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xr=>setTimeout(xr,100));const yt=A.matchingTestData;if(console.log(" Matching test data from formData:",yt),!yt){console.error(" Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log(" Matching test data found, processing...");let Yt;yt.processedQuestions?(console.log(" Using pre-processed questions from MatchingTestCreator"),Yt=yt.processedQuestions):(console.log(" Converting blocks to questions (fallback)..."),console.log(" Blocks:",yt.blocks),console.log(" Words:",yt.words),console.log(" Arrows:",yt.arrows),Yt=yt.blocks.map((xr,Gr)=>{const un=yt.words.find(hn=>hn.blockId===xr.id)?.word||`Word ${Gr+1}`,Xr=yt.arrows.some(hn=>hn.startBlock===xr.id),cr=yt.arrows.find(hn=>hn.startBlock===xr.id)||null,na={question_id:Gr+1,word:un,block_coordinates:{x:xr.x,y:xr.y,width:xr.width,height:xr.height},has_arrow:Xr,arrow:cr?{startX:cr.startX,startY:cr.startY,endX:cr.endX,endY:cr.endY,style:cr.style||{}}:null};return console.log(` Question ${Gr+1}:`,na),na})),console.log(" Final questions array:",Yt);const _r={teacher_id:e.teacher_id,test_name:A.testName,image_url:yt.imageUrl,num_blocks:yt.blocks.length,questions:Yt,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Xe};console.log(" Final matching test data payload:",_r),console.log(" Calling testService.saveMatchingTest...");const kr=await fn.saveMatchingTest(_r);console.log(" API Response:",kr),kr.success?(console.log(" Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),o(!0),Ae()):(console.error(" Failed to create matching test:",kr.message),r("Error creating and assigning matching test: "+kr.message,"error")),F(!1);return}if(oe==="wordMatching"){console.log(" Processing word matching test..."),console.log(" Setting isAssigningTest to true for word matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xr=>setTimeout(xr,100));const yt=A.wordMatchingData;if(console.log(" Word matching test data from formData:",yt),!yt){console.error(" Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log(" Word matching test data found, processing...");const Yt=yt.wordPairs.map((xr,Gr)=>({question_id:Gr+1,left_word:xr.leftWord,right_word:xr.rightWord}));console.log(" Final word matching questions array:",Yt);const _r={teacher_id:e.teacher_id,test_type:"word_matching",test_name:A.testName,num_questions:yt.wordPairs.length,interaction_type:yt.interactionType||"drag",questions:Yt,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Xe};console.log(" Final word matching test data payload:",_r),console.log(" Calling testService.assignTestToClasses for word matching...");const kr=await fn.assignTestToClasses(_r);console.log(" API Response:",kr),kr.success?(console.log(" Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),o(!0),Ae()):(console.error(" Failed to create word matching test:",kr.message),r("Error creating and assigning word matching test: "+kr.message,"error")),F(!1);return}if(oe==="drawing"){console.log(" Processing drawing test..."),console.log(" Setting isAssigningTest to true for drawing test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xr=>setTimeout(xr,100));const yt=A.drawingData;if(console.log(" Drawing test data from formData:",yt),!yt){console.error(" Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log(" Drawing test data found, processing...");const Yt=yt.questions||[];console.log(" Drawing questions array:",Yt);const _r={teacher_id:e.teacher_id,test_type:"drawing",test_name:A.testName,num_questions:yt.num_questions,passing_score:yt.passing_score,questions:Yt,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Xe};console.log(" Final drawing test data payload:",_r),console.log(" Calling testService.assignTestToClasses...");const kr=await fn.assignTestToClasses(_r);console.log(" API Response:",kr),kr.success?(console.log(" Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),o(!0),Ae()):(console.error(" Failed to create drawing test:",kr.message),r("Error creating and assigning drawing test: "+kr.message,"error")),F(!1);return}if(oe==="fillBlanks"){console.log(" Processing fill blanks test..."),console.log(" Setting isAssigningTest to true for fill blanks test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xr=>setTimeout(xr,100));const yt=A.fillBlanksData;if(console.log(" Fill blanks test data from formData:",yt),!yt){console.error(" Fill blanks test data not found in formData"),r("Fill blanks test data not found. Please recreate the test.","error");return}console.log(" Fill blanks test data found, processing...");const Yt=yt.blanks||[];console.log(" Fill blanks questions array:",Yt);const _r={teacher_id:e.teacher_id,test_type:"fill_blanks",test_name:A.testName,test_text:yt.test_text,num_questions:yt.num_questions,num_blanks:yt.num_blanks,separate_type:yt.separate_type,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,questions:Yt,assignments:Xe};console.log(" Final fill blanks test data payload:",_r),console.log(" Calling testService.assignTestToClasses...");const kr=await fn.assignTestToClasses(_r);console.log(" API Response:",kr),kr.success?(console.log(" Fill blanks test created and assigned successfully!"),r("Fill blanks test created and assigned successfully!","success"),o(!0),Ae()):(console.error(" Failed to create fill blanks test:",kr.message),r("Error creating and assigning fill blanks test: "+kr.message,"error")),F(!1);return}if(oe==="speaking"){console.log(" Processing speaking test..."),console.log(" Setting isAssigningTest to true for speaking test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xr=>setTimeout(xr,100));const yt=A.speakingData;if(console.log(" Speaking test data from formData:",yt),!yt){console.error(" Speaking test data not found in formData"),r("Speaking test data not found. Please recreate the test.","error");return}console.log(" Speaking test data found, processing...");const Yt={teacher_id:e.teacher_id,test_type:"speaking",test_name:A.testName,time_limit:yt.time_limit,min_duration:yt.min_duration,max_duration:yt.max_duration,max_attempts:yt.max_attempts,min_words:yt.min_words,passing_score:yt.passing_score,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,questions:yt.questions,assignments:Xe};console.log(" Final speaking test data payload:",Yt),console.log(" Calling save-speaking-test-with-assignments for speaking test...");const kr=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-speaking-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Yt)})).json();console.log(" API Response:",kr),kr.success?(console.log(" Speaking test created and assigned successfully!"),r("Speaking test created and assigned successfully!","success"),o(!0),Ae()):(console.error(" Failed to create speaking test:",kr.message),r("Error creating and assigning speaking test: "+kr.message,"error")),F(!1);return}console.log(" Processing non-matching test..."),console.log(" Form data questions:",A.questions);const ot=Object.keys(A.questions).map(yt=>{const Yt=A.questions[yt];console.log(` Processing question ${yt}:`,Yt);let _r;if(oe==="input")_r={correct_answers:Yt.correct_answers||[Yt.correctAnswer||""]};else if(oe==="trueFalse"){const xr=Yt.correct_answer||Yt.correctAnswer||Yt.correct_answers?.[0]||"";_r={correct_answer:xr==="true"}}else _r={correct_answer:Yt.correctAnswer||Yt.correct_answer||Yt.correct_answers?.[0]||""};const kr={question_id:parseInt(yt),question:Yt.question,..._r,options:Yt.options||[]};return console.log(` Question ${yt} correct_answers:`,Yt.correct_answers),console.log(` Question ${yt} correctAnswer:`,Yt.correctAnswer),console.log(` Converted question ${yt}:`,kr),kr});console.log(" Final questions array:",ot);const xt={teacher_id:e.teacher_id,test_type:P3e[oe],test_name:A.testName,num_questions:A.numQuestions,num_options:A.numOptions,questions:ot,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,is_shuffled:!!A.isShuffled,assignments:Xe};console.log(" Final test data payload:",xt),console.log(" Setting isAssigningTest to true..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(yt=>setTimeout(yt,100)),console.log(" Calling testService.assignTestToClasses...");const qt=await fn.assignTestToClasses(xt);console.log(" API Response:",qt),qt.success?(console.log(" Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),o(!0),Ae()):(console.error(" Failed to create and assign test:",qt.message),r("Error creating and assigning test: "+qt.message,"error"))}catch(Te){console.error(" Exception in assignTestToClasses:",Te),console.error("Error creating and assigning test:",Te),r("Error creating and assigning test. Please try again.","error")}finally{F(!1)}console.log(" === ASSIGN TEST TO CLASSES DEBUG END ===")},[e,I,A,r,pe]),Ae=S.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),o(!1),u("typeSelection"),p(null),Z(null),B([]),L(),M(),pe(),console.log(" Returned to main cabinet")}catch(oe){console.error("Error returning to main cabinet:",oe)}},[L,M,pe]),[Ge,Le]=S.useState([]),[At,et]=S.useState(!1);S.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await ne(),r("Active tests data refreshed.","success")}catch(oe){console.error("Error refreshing active tests data:",oe),r("Error refreshing data.","error")}},[ne,r]);const[pt,lt]=S.useState([]),[rt,ht]=S.useState([]),[Lt,zt]=S.useState(!1),[Dt,De]=S.useState(!1),Ie=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",oe),lt(oe),console.log(" Existing subjects displayed in selection:",oe.length,"subjects")},[e]);S.useCallback(async()=>{try{console.log("Loading existing subjects...");const oe=await ms.getTeacherSubjects();console.log("Existing subjects loaded:",oe),oe&&oe.length>0?Ie(oe):(console.log("No existing subjects found"),lt([]))}catch(oe){console.error("Error loading existing subjects:",oe),r("Error loading subjects.","error")}},[r,Ie]);const Ke=S.useCallback(oe=>{console.log("Checking for outside click...");const fe=document.getElementById("dropdownMenu"),Te=document.querySelector("[data-menu-button]");fe&&!fe.contains(oe.target)&&!Te?.contains(oe.target)&&(console.log("Outside click detected, closing menu"),fe.classList.remove("show"),document.removeEventListener("click",Ke))},[]),[Je,Ye]=S.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),Tt=S.useCallback((oe,fe)=>{const Te=oe.target.files[0];if(!Te)return;if(!Te.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),oe.target.value="";return}if(Te.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),oe.target.value="";return}E(!0);const Ee=new FileReader;Ee.onload=function(Xe){try{console.log(" File loaded, processing data...");const ot=new Uint8Array(Xe.target.result),xt=NE(ot,{type:"array"}),qt=xt.SheetNames[0],yt=xt.Sheets[qt],Yt=u_.sheet_to_json(yt,{header:1});console.log(" Parsed Excel data:",Yt),Wt(Yt,fe),E(!1)}catch(ot){console.error("Error processing Excel file:",ot),r("Error reading Excel file: "+ot.message,"error"),oe.target.value="",E(!1)}},Ee.onerror=function(){r("Failed to read file","error"),oe.target.value="",E(!1)},Ee.readAsArrayBuffer(Te)},[r]),Nt=S.useCallback(()=>{console.log(" Initializing Excel upload for all test types...");const oe=document.querySelectorAll(".excel-upload-btn");console.log(` Found ${oe.length} Excel upload buttons`),oe.forEach((fe,Te)=>{const Ee=fe.dataset.testType,Xe=document.querySelector(`.excel-file-input[data-test-type="${Ee}"]`);console.log(` Processing button ${Te+1}: testType=${Ee}, fileInput=${Xe?"found":"not found"}`),Xe?(fe._excelClickHandler&&fe.removeEventListener("click",fe._excelClickHandler),Xe._excelChangeHandler&&Xe.removeEventListener("change",Xe._excelChangeHandler),fe._excelClickHandler=()=>{console.log(` Excel upload button clicked for test type: ${Ee}`),Xe.click()},Xe._excelChangeHandler=ot=>{console.log(` File input changed for test type: ${Ee}`),Tt(ot,Ee)},fe.addEventListener("click",fe._excelClickHandler),Xe.addEventListener("change",Xe._excelChangeHandler),console.log(` Excel upload initialized for test type: ${Ee}`)):console.warn(` File input not found for test type: ${Ee}`)}),console.log(" Excel upload initialization complete")},[Tt]),Wt=S.useCallback((oe,fe)=>{const Te=oe.filter(yt=>Array.isArray(yt)&&yt.length>0&&yt.some(Yt=>Yt&&Yt.toString().trim()!==""));console.log(" Original Excel data rows:",oe.length),console.log(" Filtered Excel data rows:",Te.length);const Xe=or(Te,fe).dataRows;if(Xe.length===0){const yt="No data rows found after header processing. Please check your Excel file.";r(yt,"error"),alert(yt),Fe(fe);return}console.log(` Processing Excel data for test type: ${fe}`),console.log(" Data rows after header processing:",Xe);const ot=fr(Xe,fe);if(console.log(" Recognition result:",ot),!ot.recognized){console.log(` Excel data recognition failed for test type: ${fe}`);const yt="Excel data recognition failed. Please check your file format.";r(yt,"error"),alert(yt),Fe(fe);return}console.log(` Excel data recognition successful for test type: ${fe}`);const xt=Xe.length,qt=Ne(fe);if(qt===0)console.log(` No question count specified, using CSV count: ${xt}`),j(yt=>({...yt,numQuestions:xt}));else if(xt!==qt){const yt=`Your CSV file has ${xt} data rows, but you specified ${qt} questions.

Please either:
1. Change your question count to ${xt}, or
2. Fix your CSV file to have exactly ${qt} data rows

Then try uploading again.`;r(yt,"error"),Fe(fe);return}Re(Xe,fe)},[r]),or=S.useCallback((oe,fe)=>{if(oe.length===0)return{hasHeaders:!1,headerRow:null,dataRows:oe};const Te=oe[0],Ee=dr(fe);if(Er(Te,Ee).isLikelyHeader){const ot=`The first row of your Excel file looks like it contains headers:

"${Te.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(ot))return{hasHeaders:!0,headerRow:Te,dataRows:oe.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:oe}},[]),dr=S.useCallback(oe=>{switch(oe){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),Er=S.useCallback((oe,fe)=>{if(!oe||oe.length===0)return{isLikelyHeader:!1};if(oe.length<fe.expectedColumns)return{isLikelyHeader:!1};const Te=oe.join(" ").toLowerCase(),Ee=fe.keywords.filter(ot=>Te.includes(ot.toLowerCase()));return{isLikelyHeader:Ee.length>fe.keywords.length/2,keywordMatches:Ee}},[]),fr=S.useCallback((oe,fe)=>{if(oe.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(` Checking data pattern for test type: ${fe}`),console.log(" Excel data to validate:",oe);const Te=nr(oe,fe);if(console.log(" Recognition result:",Te),!Te.matches){const Ee=`Your Excel file doesn't match the expected format.

Required format:
${me(fe)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log(" Data pattern validation failed:",Ee),console.log(" Calling showNotification with message:",Ee),r(Ee,"error"),console.log(" showNotification called"),alert(Ee),{recognized:!1,data:[]}}return console.log(` Data pattern validation passed for test type: ${fe}`),{recognized:!0,data:oe}},[r]),nr=S.useCallback((oe,fe)=>{if(fe==="multipleChoice")for(let Te=0;Te<oe.length;Te++){const Ee=oe[Te];if(Ee.length<4)return{matches:!1,issue:`Row ${Te+1} has ${Ee.length} columns but needs at least 4`};if(!Ee[0]||Ee[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};if(!Ee[1]||Ee[1].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no correct answer in column 2`}}else if(fe==="trueFalse")for(let Te=0;Te<oe.length;Te++){const Ee=oe[Te];if(Ee.length<2)return{matches:!1,issue:`Row ${Te+1} has ${Ee.length} columns but needs at least 2`};if(!Ee[0]||Ee[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};const Xe=Ee[1]?.toString().trim().toLowerCase();if(!Xe||!["true","false","t","f"].includes(Xe))return{matches:!1,issue:`Row ${Te+1} has invalid correct answer in column 2 (must be True/False)`}}else if(fe==="input")for(let Te=0;Te<oe.length;Te++){const Ee=oe[Te];if(Ee.length<2)return{matches:!1,issue:`Row ${Te+1} has ${Ee.length} columns but needs at least 2`};if(!Ee[0]||Ee[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};if(!Ee[1]||Ee[1].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no correct answer in column 2`}}return{matches:!0}},[]),me=S.useCallback(oe=>{switch(oe){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),Ne=S.useCallback(oe=>A.numQuestions||0,[A.numQuestions]),Fe=S.useCallback(oe=>{console.log(` Clearing file input for test type: ${oe}`)},[]),Re=S.useCallback((oe,fe)=>{switch(console.log(` populateFromExcelForTestType called with testType: ${fe}`),fe){case"multipleChoice":case"multiple-choice":bt(oe);break;case"trueFalse":case"true-false":Pe(oe);break;case"input":ze(oe);break;default:console.log(` Unknown test type: ${fe}`)}},[]),bt=S.useCallback(oe=>{console.log(" populateMultipleChoiceFromExcel called with:",oe);const fe=Math.max(...oe.map(Xe=>Xe.length-2)),Te=Math.min(fe,6);console.log(` Excel data has ${fe} option columns, using ${Te} options`),j(Xe=>({...Xe,numOptions:Te}));const Ee={};oe.forEach((Xe,ot)=>{const xt=ot+1;console.log(` Row ${ot+1} data:`,Xe);const qt={question:(Xe[0]||"").toString().trim(),options:[],correctAnswer:(Xe[1]||"").toString().trim().toUpperCase()};console.log(` Question ${xt} correctAnswer:`,qt.correctAnswer),["A","B","C","D","E","F"].slice(0,Te).forEach((_r,kr)=>{const xr=(Xe[kr+2]||"").toString().trim();console.log(` Option ${kr} (${_r}):`,xr),qt.options.push(xr)}),Ee[xt]=qt}),j(Xe=>{const ot={...Xe,questions:Ee};return console.log(" Updating form data with:",ot),ot}),console.log(" Populated multiple choice questions from Excel:",Ee),r(`Successfully loaded ${oe.length} questions from CSV file!`,"success"),z(),ke("multiple-choice")},[A.numOptions,z,r]),Pe=S.useCallback(oe=>{console.log(" populateTrueFalseFromExcel called with:",oe);const fe={};oe.forEach((Te,Ee)=>{const Xe=Ee+1,ot={question:(Te[0]||"").toString().trim(),correctAnswer:Te[1]?.toString().trim().toLowerCase()==="true"?"true":"false"};fe[Xe]=ot}),j(Te=>({...Te,questions:fe})),console.log(" Populated true/false questions from Excel:",fe),r(`Successfully loaded ${oe.length} questions from CSV file!`,"success"),K(),ke("true-false")},[K,r]),ze=S.useCallback(oe=>{console.log(" populateInputFromExcel called with:",oe);const fe={};oe.forEach((Te,Ee)=>{const Xe=Ee+1,ot=[];for(let qt=1;qt<Te.length;qt++){const yt=(Te[qt]||"").toString().trim();yt&&ot.push(yt)}const xt={question:(Te[0]||"").toString().trim(),correctAnswer:ot[0]||"",correct_answers:ot};console.log(` Excel question ${Xe} data:`,xt),fe[Xe]=xt}),j(Te=>({...Te,questions:fe})),console.log(" Populated input questions from Excel:",fe),r(`Successfully loaded ${oe.length} questions from Excel file!`,"success"),Q(),ke("input")},[Q,r]),ke=S.useCallback(oe=>{switch(console.log(` Reattaching form event listeners for test type: ${oe}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(Te=>{Te.removeEventListener("input",()=>{}),Te.removeAttribute("data-listener-attached")}),oe){case"multiple-choice":z();break;case"true-false":K();break;case"input":Q();break;default:console.warn("Unknown test type for event listener reattachment:",oe)}console.log(` Form event listeners reattached for test type: ${oe}`)},[z,K,Q]),$e=S.useCallback(()=>{const oe=localStorage.getItem("test_creation_state");if(!oe)return console.log(" No test creation state found in localStorage"),!1;try{const fe=JSON.parse(oe);console.log(" Found test creation state:",fe);const Te=Date.now()-fe.timestamp,Ee=1800*1e3;if(Te>Ee)return console.log(" Test creation state is too old, clearing it"),M(),!1;switch(a(!0),console.log(" Restored isInTestCreation flag to true"),te(),fe.excelState&&H(),fe.currentStep){case"testTypeSelection":console.log(" Restoring test type selection step"),u("typeSelection");break;case"multipleChoiceForm":console.log(" Restoring multiple choice form step"),p("multipleChoice"),u("formCreation");break;case"trueFalseForm":console.log(" Restoring true/false form step"),p("trueFalse"),u("formCreation");break;case"inputForm":console.log(" Restoring input form step"),p("input"),u("formCreation");break;case"testAssignment":case"assignment":console.log(" Restoring test assignment step"),console.log(" Cannot restore test assignment step without test data, going back to type selection"),u("typeSelection");break;default:console.log(" Unknown step in state, defaulting to type selection"),u("typeSelection")}return R(fe.currentStep),!0}catch(fe){return console.error(" Error restoring test creation state:",fe),M(),!1}},[M,te,H,R]);S.useEffect(()=>{console.log(" Initializing Teacher Tests..."),se(),$e(),ce(),Nt()},[se,$e,ce,Nt]),S.useEffect(()=>{A.numQuestions>0&&g&&g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&(console.log(" Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{Nt()},100))},[A.numQuestions,g,Nt]);const Be=oe=>{console.log(" Test type selected:",oe),console.log(" Setting testType to:",oe),p(oe),u("formCreation"),j({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:""}),V("formCreation"),setTimeout(()=>{Nt()},100)},Et=(oe,fe)=>{j(Te=>({...Te,[oe]:fe}))},It=(oe,fe,Te)=>{j(Ee=>({...Ee,questions:{...Ee.questions,[oe]:{...Ee.questions[oe],[fe]:Te}}}))},Kt=(oe,fe,Te,Ee=0)=>{const Xe={};for(let ot=1;ot<=Te;ot++)oe==="multipleChoice"?Xe[ot]={question:"",options:Array.from({length:Ee},()=>""),correctAnswer:""}:oe==="trueFalse"?Xe[ot]={question:"",correctAnswer:""}:oe==="input"&&(Xe[ot]={question:"",correct_answers:[""]});j(ot=>({...ot,questions:Xe})),oe==="multipleChoice"?(ae("multiple-choice"),X("multiple-choice")):oe==="trueFalse"?(ae("true-false"),X("true-false")):oe==="input"&&(ae("input"),X("input"))},wr=async()=>{if(!g||!A.testName||!A.numQuestions){r("Please fill in all required fields","error");return}console.log(" Test form completed, proceeding to assignment step"),V("testAssignment",A),u("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},lr=(oe,fe,Te,Ee,Xe)=>{B(Te?ot=>[...ot,{grade:oe,class:fe,subject_id:Ee,subject:Xe}]:ot=>ot.filter(xt=>!(xt.grade===oe&&xt.class===fe&&xt.subject_id===Ee)))},Fr=S.useCallback(async oe=>{console.log(" [DEBUG] handleMatchingTestSave called"),console.log(" [DEBUG] Received testData:",oe),console.log(" [DEBUG] Current formData:",A),console.log(" [DEBUG] Current testType:",g),console.log(" [DEBUG] Current user:",e),console.log(" [DEBUG] Current currentStep:",c),_(!0);try{const fe=oe.blocks.map((Xe,ot)=>{const xt=oe.words.find(Yt=>Yt.blockId===Xe.id)?.word||`Word ${ot+1}`,qt=oe.arrows.some(Yt=>Yt.startBlock===Xe.id),yt=oe.arrows.find(Yt=>Yt.startBlock===Xe.id)||null;return{question_id:ot+1,word:xt,block_coordinates:{x:Xe.x,y:Xe.y,width:Xe.width,height:Xe.height},has_arrow:qt,arrow:yt?{startX:yt.startX,startY:yt.startY,endX:yt.endX,endY:yt.endY,style:yt.style||{}}:null}}),Te={teacher_id:e.teacher_id,test_name:A.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:oe.imageUrl,num_blocks:oe.blocks.length,questions:fe,assignments:[]};console.log(" Sending matching test payload:",Te);const Ee={...A,testName:Te.test_name,numQuestions:Te.num_blocks,numOptions:0,questions:fe.reduce((Xe,ot,xt)=>(Xe[xt+1]={question:ot.word,correctAnswer:ot.word,options:[]},Xe),{}),matchingTestData:oe};console.log(" Assignment form data:",Ee),j(Ee),V("testAssignment",Ee),console.log(" Setting current step to testAssignment"),u("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(fe){console.error(" Error saving matching test:",fe),r("Failed to save matching test: "+fe.message,"error")}finally{_(!1)}},[e,A,g,r,V]),ue=S.useCallback(()=>{console.log(" Cancelling matching test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),be=S.useCallback(async oe=>{console.log(" [DEBUG] handleWordMatchingTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,wordMatchingData:oe,numQuestions:oe.numQuestions||oe.wordPairs?.length||0})),u("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(fe){console.error("Error saving word matching test:",fe),r("Failed to save word matching test: "+fe.message,"error")}finally{_(!1)}},[r]),xe=S.useCallback(()=>{console.log(" Cancelling word matching test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),he=S.useCallback(async oe=>{console.log(" [DEBUG] handleDrawingTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,drawingData:oe,numQuestions:oe.num_questions||oe.questions?.length||0})),u("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(fe){console.error(" Error saving drawing test:",fe),r("Error saving drawing test","error")}finally{_(!1)}},[r]),we=S.useCallback(()=>{console.log(" Cancelling drawing test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Se=S.useCallback(()=>{console.log(" Cancelling fill blanks test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),He=S.useCallback(async oe=>{console.log(" [DEBUG] handleFillBlanksTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,fillBlanksData:oe,numQuestions:oe.num_questions||oe.blanks?.length||0})),u("testAssignment"),r("Fill blanks test created! Now assign it to classes.","success")}catch(fe){console.error(" Error saving fill blanks test:",fe),r("Error saving fill blanks test","error")}finally{_(!1)}},[r]),ct=S.useCallback(()=>{console.log(" Cancelling speaking test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),qe=S.useCallback(async oe=>{console.log(" [DEBUG] handleSpeakingTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,speakingData:oe,numQuestions:oe.questions?.length||0})),u("testAssignment"),r("Speaking test created! Now assign it to classes.","success")}catch(fe){console.error(" Error saving speaking test:",fe),r("Error saving speaking test","error")}finally{_(!1)}},[r]);return l.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[l.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs(ko,{mode:"wait",children:[c==="typeSelection"&&l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs(Ze,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsx("div",{className:"flex-1"})]}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),l.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Picture Matching",description:"Labeling pictures",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Matching word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"},{type:"fillBlanks",title:"Fill Blanks",description:"Text with multiple choice blanks",icon:"/pics/fill-blanks.png"},{type:"speaking",title:"Speaking Test",description:"Audio recording with AI-powered feedback",icon:"/pics/speaking.png"}].map(({type:oe,title:fe,description:Te,icon:Ee})=>l.jsx(at.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>Be(oe),children:l.jsxs(jt,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[l.jsx("div",{className:"mb-3 flex justify-center",children:l.jsx("img",{src:Ee,alt:fe,className:"w-12 h-12 object-contain"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:fe}),l.jsx("p",{className:"text-sm text-gray-600",children:Te})]})},oe))})]}),c==="formCreation"&&l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"flex space-x-2",children:l.jsx(Ze,{variant:"outline",onClick:ee,children:" Back to Test Types"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",g==="multipleChoice"?"Multiple Choice":g==="trueFalse"?"True/False":g==="input"?"Input":g==="drawing"?"Drawing":g==="fillBlanks"?"Fill Blanks":g==="wordMatching"?"Word Matching":g==="speaking"?"Speaking":"Picture Matching"," Test"]}),l.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),l.jsx("input",{type:"text",value:A.testName,onChange:oe=>Et("testName",oe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),g!=="matching"&&g!=="wordMatching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),l.jsx("input",{type:"number",min:"1",max:"50",value:A.numQuestions,onChange:oe=>{const fe=parseInt(oe.target.value)||0;Et("numQuestions",fe),fe>0&&Kt(g,A.testName,fe,A.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),g==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),l.jsx("input",{type:"number",min:"2",max:"6",value:A.numOptions,onChange:oe=>{const fe=parseInt(oe.target.value)||0;Et("numOptions",fe),fe>0&&fe<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),A.numQuestions>0&&Kt(g,A.testName,A.numQuestions,fe)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]}),g!=="speaking"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("label",{className:"inline-flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:!!A.enableTimer,onChange:oe=>Et("enableTimer",oe.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Enable timer for this test"})]}),A.enableTimer&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"Time (minutes):"}),l.jsx("input",{type:"number",min:"1",max:"1440",value:A.timerMinutes,onChange:oe=>Et("timerMinutes",oe.target.value.replace(/[^0-9]/g,"")),className:"w-28 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 30"})]})]}),g!=="drawing"&&g!=="matching"&&g!=="wordMatching"&&g!=="fillBlanks"&&g!=="speaking"&&l.jsx("div",{className:"flex items-center space-x-2",children:l.jsxs("label",{className:"inline-flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:!!A.isShuffled,onChange:oe=>Et("isShuffled",oe.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Shuffle questions during test"})]})})]})]})}),g==="matching"&&l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Picture Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),l.jsx(ote,{testName:A.testName,onTestSaved:Fr,onCancel:ue,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]})}),g==="wordMatching"&&l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),l.jsx(cae,{testName:A.testName,onTestSaved:be,onCancel:xe,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]})}),g==="drawing"&&l.jsxs(jt,{children:[console.log(" Rendering DrawingTestCreator, testType:",g),l.jsx(Jse,{testName:A.testName,onTestSaved:he,onCancel:we,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]}),g==="fillBlanks"&&l.jsxs(jt,{children:[console.log(" Rendering FillBlanksTestCreator, testType:",g),l.jsx(rae,{testName:A.testName,allowedTime:A.enableTimer&&parseInt(A.timerMinutes)||null,onTestSaved:He,onCancel:Se,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]}),g==="speaking"&&l.jsxs(jt,{children:[console.log(" Rendering SpeakingTestCreator, testType:",g),l.jsx(sae,{testName:A.testName,onTestSaved:qe,onCancel:ct,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&A.numQuestions>0&&l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),l.jsxs("div",{className:"space-y-6",children:[g==="multipleChoice"&&Je.multipleChoice?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Multiple Choice Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),l.jsx("div",{children:"Column 3: Option A text"}),l.jsx("div",{children:"Column 4: Option B text"}),l.jsx("div",{children:"Column 5: Option C text"}),l.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),g==="trueFalse"&&Je.trueFalse?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-xs text-blue-800",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),g==="input"&&Je.input?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Input Test Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Answer 1"}),l.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&A.numQuestions>0&&l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),A.numQuestions>0&&l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),l.jsx("div",{className:"space-y-6",children:Object.keys(A.questions).map(oe=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",oe]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),l.jsx("textarea",{value:A.questions[oe]?.question||"",onChange:fe=>It(oe,"question",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text"})]}),g==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),l.jsx("div",{className:"space-y-2",children:A.questions[oe]?.options?.map((fe,Te)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+Te),":"]}),l.jsx("input",{type:"text",value:fe,onChange:Ee=>{const Xe=[...A.questions[oe].options];Xe[Te]=Ee.target.value,It(oe,"options",Xe)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+Te)}`})]},Te))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),g==="multipleChoice"?l.jsx("div",{children:l.jsxs("select",{value:A.questions[oe]?.correctAnswer||"",onChange:fe=>It(oe,"correctAnswer",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),A.questions[oe]?.options?.map((fe,Te)=>l.jsx("option",{value:String.fromCharCode(65+Te),children:String.fromCharCode(65+Te)},Te))]})}):g==="trueFalse"?l.jsxs("select",{value:A.questions[oe]?.correctAnswer||"",onChange:fe=>It(oe,"correctAnswer",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),l.jsx("option",{value:"true",children:"True"}),l.jsx("option",{value:"false",children:"False"})]}):l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("input",{type:"text",value:A.questions[oe]?.correct_answers?.[0]||"",onChange:fe=>{const Ee=[...A.questions[oe]?.correct_answers||[""]];Ee[0]=fe.target.value,It(oe,"correct_answers",Ee)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer"}),A.questions[oe]?.correct_answers?.slice(1).map((fe,Te)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"text",value:fe,onChange:Ee=>{const Xe=[...A.questions[oe]?.correct_answers||[]];Xe[Te+1]=Ee.target.value,It(oe,"correct_answers",Xe)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${Te+2}`}),l.jsx("button",{type:"button",onClick:()=>{const Ee=[...A.questions[oe]?.correct_answers||[]];Ee.splice(Te+1,1),It(oe,"correct_answers",Ee)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},Te))||[],l.jsx("button",{type:"button",onClick:()=>{const Te=[...A.questions[oe]?.correct_answers||[""],""];It(oe,"correct_answers",Te)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},oe))})]})}),A.testName&&A.numQuestions>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(Ze,{onClick:wr,disabled:k,className:"px-8",children:k?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),c==="testAssignment"&&l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs(Ze,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),l.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),l.jsx(Ze,{variant:"outline",onClick:()=>u("formCreation"),children:" Back to Test Form"})]}),l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),x.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),l.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),l.jsx("div",{className:"mt-4",children:l.jsx(Ze,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):l.jsx("div",{className:"space-y-6",children:x.map(oe=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:oe.subject}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:oe.classes.map(fe=>l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:I.some(Te=>Te.grade===fe.grade&&Te.class===fe.class&&Te.subject_id===oe.subject_id),onChange:Te=>lr(fe.grade,fe.class,Te.target.checked,oe.subject_id,oe.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-sm text-gray-700",children:[fe.grade,"/",fe.class]})]},`${fe.grade}-${fe.class}-${oe.subject_id}`))})]},oe.subject_id))})]})}),I.length>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(Ze,{onClick:()=>Ce(g,null),disabled:w,className:"px-8",children:w?l.jsxs(l.Fragment,{children:[l.jsx(Wr,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${I.length} Class${I.length>1?"es":""}`})})]})]})}),console.log(" Checking isAssigningTest:",P),P&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),k&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:t.map(oe=>l.jsx(mc,{type:oe.type,message:oe.message,duration:oe.duration,onClose:()=>n(oe.id)},oe.id))})]})},F3e=({onDataLoaded:e,onError:t})=>{const r=Po(),{user:n,isAuthenticated:s}=ds(),{teacherData:a,loadTeacherData:i}=o2(),[o,c]=S.useState(!0),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,x]=S.useState(null),[v,w]=S.useState([]),[C,k]=S.useState([]),[_,N]=S.useState([]),[E,P]=S.useState(null),[F,A]=S.useState(0);S.useEffect(()=>{se()},[]),S.useCallback(async te=>{console.log(" Teacher login attempt...");try{const L=await ms.teacherLogin(te);if(L.success)return Z("Login successful!","success"),await j(),L;throw new Error(L.error||"Login failed")}catch(L){throw console.error(" Teacher login error:",L),Z("Login failed. Please check your credentials.","error"),L}},[]);const j=S.useCallback(async()=>{console.log(" Loading teacher data...");try{if(c(!0),d(""),!s||!n){console.log(" User not authenticated"),d("User not authenticated");return}if(n.role!==no.TEACHER){console.error(" Invalid user role for teacher data:",n.role),d("Access denied. Teacher role required.");return}console.log(" Fetching teacher data from service...");const te=await ms.getTeacherData();if(te&&te.success)console.log(" Teacher data loaded successfully:",te),x(te.teacher||n),te.subjects&&(w(te.subjects),console.log(" Teacher subjects loaded:",te.subjects.length)),te.grades&&k(te.grades),te.classes&&N(te.classes),P(new Date),A(L=>L+1),e&&e(te),Z("Teacher data loaded successfully!","success");else throw new Error(te?.error||"Failed to load teacher data")}catch(te){console.error(" Error loading teacher data:",te);const L=te.message||"Failed to load teacher data";d(L),t&&t(te),Z(L,"error")}finally{c(!1)}},[s,n,e,t]),I=S.useCallback(()=>{console.log(" Returning to main cabinet..."),r("/teacher/cabinet")},[r]);S.useCallback(te=>{console.log(" Showing main cabinet with subjects:",te),te&&w(te),r("/teacher/cabinet")},[r]);const B=S.useCallback(()=>(console.log(" Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(L=>({id:L,name:`Grade ${L}`,classes:Y(L)}))),[]),Y=S.useCallback(te=>Array.from({length:10},(V,M)=>M+1).map(V=>({id:`${te}-${V}`,name:`Class ${V}`,grade:te,classNumber:V})),[]),Z=S.useCallback((te,L)=>{const V={id:Date.now(),message:te,type:L,timestamp:new Date};g(M=>[...M,V]),setTimeout(()=>{g(M=>M.filter(H=>H.id!==V.id))},P0.NOTIFICATION_DURATION)},[]),se=S.useCallback(async()=>{console.log(" Initializing teacher data..."),await j()},[j]),ee=S.useCallback(async()=>{console.log(" Refreshing teacher data..."),await j()},[j]);return S.useCallback(async te=>{console.log(" Updating teacher profile:",te);try{const L=await ms.updateUserProfile(te);if(L.success)return x(V=>({...V,...te})),Z("Profile updated successfully!","success"),L;throw new Error(L.error||"Failed to update profile")}catch(L){throw console.error(" Error updating teacher profile:",L),Z("Failed to update profile","error"),L}},[]),S.useCallback(async te=>{console.log(" Changing teacher password...");try{const L=await ms.changePassword(te);if(L.success)return Z("Password changed successfully!","success"),L;throw new Error(L.error||"Failed to change password")}catch(L){throw console.error(" Error changing teacher password:",L),Z("Failed to change password","error"),L}},[]),o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Wr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):u?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:u}),l.jsxs("div",{className:"flex space-x-3 justify-center",children:[l.jsx(Ze,{variant:"primary",onClick:ee,children:"Retry"}),l.jsx(Ze,{variant:"outline",onClick:I,children:"Go Back"})]})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",E?E.toLocaleString():"Never"," | Version: ",F]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:ee,children:"Refresh Data"}),l.jsx(Ze,{variant:"outline",onClick:I,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),p?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.name||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.username||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.email||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.role||"N/A"})]})]}):l.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",v.length,")"]}),v.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map((te,L)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:te.name}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:te.description||"No description"}),te.classes&&te.classes.length>0&&l.jsxs("div",{className:"mt-2",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:te.classes.map((V,M)=>l.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[V.grade," - ",V.className]},M))})]})]},L))}):l.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:B().map(te=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:te.name}),l.jsx("div",{className:"grid grid-cols-5 gap-1",children:te.classes.map(L=>l.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",L),children:L.classNumber},L.id))})]},te.id))})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:v.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-green-600",children:C.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:_.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:F}),l.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:f.map(te=>l.jsx(mc,{type:te.type,message:te.message,onClose:()=>g(L=>L.filter(V=>V.id!==te.id))},te.id))})]})},O3e=({onBackToCabinet:e})=>{const t=Po(),{user:r,isAuthenticated:n}=ds(),{teacherData:s}=o2(),[a,i]=S.useState(!0),[o,c]=S.useState(""),[u,d]=S.useState([]),[f,g]=S.useState([]),[p,x]=S.useState([]),[v,w]=S.useState([]),[C,k]=S.useState(null),[_,N]=S.useState([]),[E,P]=S.useState(!1),[F,A]=S.useState(!1),[j,I]=S.useState(!1),[B,Y]=S.useState(!1),[Z,se]=S.useState(null),[ee,te]=S.useState(!0),[L,V]=S.useState(null);S.useEffect(()=>{Le()},[]),S.useCallback(et=>{console.log(" Rendering existing subjects:",et),g(et)},[]);const M=S.useCallback(()=>{console.log(" Showing subject selection prompt..."),P(!0),te(!1),H()},[]),H=S.useCallback(async()=>{console.log(" Loading existing subjects...");try{const et=await ms.getTeacherSubjects();et.success&&et.subjects&&et.subjects.length>0?(console.log(" Existing subjects found:",et.subjects),W(et.subjects)):(console.log(" No existing subjects found"),w([]))}catch(et){console.error(" Error loading existing subjects:",et),Ge("Failed to load existing subjects","error")}},[]),W=S.useCallback(et=>{console.log(" Rendering subject selection:",et);const pt=[];et.forEach(lt=>{lt.classes&&Array.isArray(lt.classes)&&lt.classes.forEach(rt=>{pt.push({id:`${lt.subject_id}-${rt.grade}-${rt.class}`,subjectId:lt.subject_id,subjectName:lt.subject,grade:rt.grade,class:rt.class,displayText:`${lt.subject} - ${rt.grade}/${rt.class}`})})}),w(pt),console.log(" Processed subjects for selection:",pt)},[]),R=S.useCallback(async et=>{if(console.log(" Saving teacher subjects:",et),!et||et.length===0){Ge("Please select at least one subject and class combination.","warning");return}try{const pt=et.reduce((rt,ht)=>{const Lt=rt.find(zt=>zt.subject_id===ht.subjectId);return Lt?Lt.classes.push({grade:ht.grade,class:ht.class}):rt.push({subject_id:ht.subjectId,classes:[{grade:ht.grade,class:ht.class}]}),rt},[]);console.log(" Transformed data for backend:",pt);const lt=await ms.saveTeacherSubjects(pt);if(lt.success)Ge("Subjects saved successfully!","success"),P(!1),te(!0),V(new Date),await H();else throw new Error(lt.error||"Failed to save subjects")}catch(pt){console.error(" Error saving subjects:",pt),Ge("Error saving subjects. Please try again.","error")}},[]),z=S.useCallback(()=>{console.log(" Toggling subject dropdown..."),A(et=>!et),I(!1)},[]),K=S.useCallback(async()=>{console.log(" Loading subjects for dropdown...");try{const et=await ms.getAllSubjects();if(et.success)x(et.subjects||[]),console.log(" Available subjects loaded:",et.subjects?.length||0);else throw new Error(et.error||"Failed to load subjects")}catch(et){console.error(" Error loading subjects for dropdown:",et),Ge("Failed to load subjects","error")}},[]),Q=S.useCallback(et=>{console.log(" Subject selected:",et);const pt=p.find(lt=>lt.subject_id===parseInt(et));pt&&(k(pt),I(!0),A(!1),ae())},[p]),ae=S.useCallback(()=>{console.log(" Loading grades and classes...")},[]),X=S.useCallback((et,pt)=>{console.log(" Saving classes for subject:",et,pt);const lt={id:`${et.subject_id}-${Date.now()}`,subjectId:et.subject_id,subjectName:et.subject,grade:pt.grade,class:pt.class,displayText:`${et.subject} - ${pt.grade}/${pt.class}`};w(rt=>[...rt,lt]),k(null),N([]),I(!1),le(`Added ${et.subject} for ${pt.grade}/${pt.class}`)},[]),ie=S.useCallback(()=>{console.log(" Resetting subject selection..."),k(null),N([]),A(!1),I(!1)},[]),le=S.useCallback(et=>{console.log(" Showing message:",et),Ge(et,"success")},[]),ce=S.useCallback(et=>{console.log(" Showing confirmation modal:",et),se(et),Y(!0)},[]),_e=S.useCallback(()=>{console.log(" Hiding confirmation modal..."),Y(!1),se(null)},[]),ne=S.useCallback(()=>{console.log(" Confirming save subjects..."),_e(),R(v)},[v,R,_e]),pe=S.useCallback(()=>{console.log(" Cancelling save subjects..."),_e()},[_e]),Ce=S.useCallback(et=>{console.log(" Removing subject:",et),w(pt=>pt.filter(lt=>lt.id!==et)),Ge("Subject removed","info")},[]);S.useCallback(()=>{console.log(" Showing edit subjects button..."),te(!0)},[]),S.useCallback(()=>{console.log(" Hiding edit subjects button..."),te(!1)},[]);const Ae=S.useCallback(et=>{console.log(" Generating class buttons for grade:",et);let pt;return et===1||et===2?pt=["15","16"]:et===3?pt=["15","16"]:et===4?pt=["13","14"]:et===5||et===6?pt=["13","14"]:pt=[],pt.map(lt=>({id:`${et}-${lt}`,grade:et,class:lt,displayText:`${et}/${lt}`}))},[]);S.useCallback((et,pt)=>{console.log(" Showing class results:",et,pt),t("/teacher/results")},[t]);const Ge=S.useCallback((et,pt)=>{const lt={id:Date.now(),message:et,type:pt,timestamp:new Date};d(rt=>[...rt,lt]),setTimeout(()=>{d(rt=>rt.filter(ht=>ht.id!==lt.id))},P0.NOTIFICATION_DURATION)},[]),Le=S.useCallback(async()=>{console.log(" Initializing teacher subjects...");try{if(i(!0),c(""),!n||!r){console.log(" User not authenticated"),c("User not authenticated");return}if(r.role!==no.TEACHER){console.error(" Invalid user role for teacher subjects:",r.role),c("Access denied. Teacher role required.");return}await H(),await K(),console.log(" Teacher subjects initialization complete!")}catch(et){console.error(" Error initializing teacher subjects:",et),c("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,H,K]),At=S.useCallback(()=>{e?e():t("/teacher/cabinet")},[e,t]);return a?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Wr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:o}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",L?L.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[ee&&l.jsx(Ze,{variant:"primary",onClick:M,children:"Edit Subjects"}),l.jsx(Ze,{variant:"outline",onClick:At,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[!E&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs(Ze,{variant:"primary",onClick:M,className:"px-6 py-2",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),f.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map((et,pt)=>l.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:et.subject}),et.classes&&et.classes.length>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:et.classes.map((lt,rt)=>l.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",lt.grade," - Class ",lt.class]},rt))})]})]}),l.jsx("div",{className:"ml-4",children:l.jsx(Ze,{variant:"outline",size:"sm",onClick:()=>Ce(et.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},pt))}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:l.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),l.jsxs(Ze,{variant:"primary",onClick:M,className:"px-6 py-3",children:[l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),E&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs(Ze,{variant:"outline",onClick:z,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[l.jsx("span",{className:"text-gray-900 font-medium",children:C?C.subject:"Select a subject"}),l.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),F&&l.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:p.map(et=>l.jsx("button",{onClick:()=>Q(et.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:l.jsx("span",{className:"text-gray-900 font-medium",children:et.subject})},et.subject_id))})]})]}),j&&C&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-6",children:[l.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",C.subject]}),l.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(et=>l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:l.jsx("span",{className:"text-white font-bold text-xs",children:et})}),l.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",et]})]}),l.jsx("div",{className:"space-y-3",children:Ae(et).map(pt=>l.jsx(Ze,{variant:"outline",size:"sm",onClick:()=>X(C,pt),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:pt.displayText},pt.id))})]},et))})]}),v.length>0&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(et=>l.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"flex-1",children:l.jsx("span",{className:"text-sm font-semibold text-purple-900",children:et.displayText})}),l.jsx(Ze,{variant:"outline",size:"sm",onClick:()=>Ce(et.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},et.id))})]}),l.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[l.jsx("div",{className:"text-sm text-gray-500",children:v.length>0?`${v.length} subject${v.length>1?"s":""} selected`:"No subjects selected"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs(Ze,{variant:"outline",onClick:()=>{P(!1),te(!0),ie()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),l.jsxs(Ze,{variant:"primary",onClick:()=>ce({type:"save",data:v}),disabled:v.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),j?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),B&&l.jsx(fa,{isOpen:B,onClose:_e,title:"Confirm Save",variant:"confirmation",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",Z?.data?.length||0," subject assignments?"]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:pe,children:"Cancel"}),l.jsx(Ze,{variant:"primary",onClick:ne,children:"Save"})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:u.map(et=>l.jsx(mc,{type:et.type,message:et.message,onClose:()=>d(pt=>pt.filter(lt=>lt.id!==et.id))},et.id))})]})},D3e=()=>{const{user:e,role:t,isAuthenticated:r,isLoading:n}=ds(),[s,a]=S.useState("cabinet");return!r||t!=="teacher"?l.jsx(ym,{to:"/login",replace:!0}):n?l.jsxs("div",{className:"teacher-app-loading",children:[l.jsx(Wr,{}),l.jsx("p",{children:"Loading teacher interface..."})]}):l.jsx("div",{className:"teacher-app",children:l.jsxs(yN,{children:[l.jsx(Rs,{path:"/",element:l.jsx(vM,{})}),l.jsx(Rs,{path:"/cabinet",element:l.jsx(vM,{})}),l.jsx(Rs,{path:"/tests",element:l.jsx(wM,{})}),l.jsx(Rs,{path:"/tests/create",element:l.jsx(wM,{})}),l.jsx(Rs,{path:"/data",element:l.jsx(F3e,{})}),l.jsx(Rs,{path:"/subjects",element:l.jsx(O3e,{})}),l.jsx(Rs,{path:"/results",element:l.jsx(iz,{})}),l.jsx(Rs,{path:"*",element:l.jsx(ym,{to:"/teacher",replace:!0})})]})})},Ue={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},I3e=()=>{const{user:e,isAdmin:t,logout:r}=ds(),{get:n,post:s,delete:a}=tl(),i=S.useCallback(async()=>{try{g({type:"info",message:"Checking for overdue assignments..."});const ye=await s("/.netlify/functions/check-overdue-assignments",{});if(ye&&ye.success){const wt=ye.overdue_count||0;wt>0?g({type:"success",message:`Found and marked ${wt} overdue assignments as inactive.`}):g({type:"info",message:"No overdue assignments found."})}else g({type:"error",message:ye?.error||"Failed to check assignments"})}catch(ye){g({type:"error",message:"Failed to check assignments"}),console.error("Check overdue assignments error:",ye)}},[s]),[o,c]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(null),[p,x]=S.useState(!1),[v,w]=S.useState(!1),[C,k]=S.useState(!1),[_,N]=S.useState(!1),[E,P]=S.useState(""),[F,A]=S.useState(null),[j,I]=S.useState({}),[B,Y]=S.useState(null),[Z,se]=S.useState({}),[ee,te]=S.useState(null),[L,V]=S.useState({}),[M,H]=S.useState([]),[W,R]=S.useState(""),[z,K]=S.useState(""),[Q,ae]=S.useState(""),[X,ie]=S.useState("all"),[le,ce]=S.useState(!0),[_e,ne]=S.useState(!1),[pe,Ce]=S.useState([]),[Ae,Ge]=S.useState(""),[Le,At]=S.useState(""),[et,pt]=S.useState(""),[lt,rt]=S.useState(new Set),[ht,Lt]=S.useState(!1),[zt,Dt]=S.useState(!1),[De,Ie]=S.useState([]),[Ke,Je]=S.useState([]),[Ye,Tt]=S.useState([]),[Nt,Wt]=S.useState([]),[or,dr]=S.useState(!1),[Er,fr]=S.useState(!1),[nr,me]=S.useState(!1),[Ne,Fe]=S.useState(!1),[Re,bt]=S.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[Pe,ze]=S.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[ke,$e]=S.useState({subject_id:"",subject:"",description:"",is_active:!0}),[Be,Et]=S.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});S.useEffect(()=>{console.log(" AdminCabinet component mounted - initializing..."),It()},[]),S.useEffect(()=>{const ye=wt=>{ht&&!wt.target.closest(".admin-menu")&&Lt(!1)};return document.addEventListener("mousedown",ye),()=>{document.removeEventListener("mousedown",ye)}},[ht]);const It=S.useCallback(async()=>{try{c(!0),await Fr(),console.log("Admin app initialized")}catch(ye){d("Failed to initialize admin app"),console.error("Admin app initialization error:",ye)}finally{c(!1)}},[]),Kt=S.useCallback(()=>{Lt(ye=>!ye)},[]),wr=S.useCallback(()=>{Dt(!0),Lt(!1)},[]),lr=S.useCallback(()=>{Dt(!1)},[]),Fr=S.useCallback(async()=>{try{await Promise.all([ue(),be(),xe(),he()])}catch(ye){console.error("Error loading admin data:",ye),d("Failed to load admin data")}},[]),ue=S.useCallback(async()=>{try{const ye="admin_users_",wt=Bs(ye);if(wt){console.log(" Using cached users data"),Ie(wt);return}const Nr=await n("/.netlify/functions/get-all-users");console.log(" Users response:",Nr);const Or=Nr.users||[];Ie(Or),_s(ye,Or,Ls.admin_users),console.log(" Users set to state:",Or)}catch(ye){console.error("Error loading users:",ye)}},[n]),be=S.useCallback(async()=>{try{const ye="admin_teachers_",wt=Bs(ye);if(wt){console.log(" Using cached teachers data"),Je(wt);return}const Nr=await n("/.netlify/functions/get-all-teachers");console.log(" Teachers response:",Nr);const Or=Nr.teachers||[];Je(Or),_s(ye,Or,Ls.admin_teachers),console.log(" Teachers set to state:",Or)}catch(ye){console.error("Error loading teachers:",ye)}},[n]),xe=S.useCallback(async()=>{try{const ye="admin_subjects_",wt=Bs(ye);if(wt){console.log(" Using cached subjects data"),Tt(wt);return}const Nr=await n("/.netlify/functions/get-all-subjects");console.log(" Subjects response:",Nr);const Or=Nr.subjects||[];Tt(Or),_s(ye,Or,Ls.admin_subjects),console.log(" Subjects set to state:",Or)}catch(ye){console.error("Error loading subjects:",ye)}},[n]),he=S.useCallback(async()=>{try{const ye="admin_academic_years_",wt=Bs(ye);if(wt){console.log(" Using cached academic years data"),Wt(wt);return}const Nr=await xc.loadAcademicCalendar();Nr&&Array.isArray(Nr)?(Wt(Nr),_s(ye,Nr,Ls.admin_academic_years)):console.error("Failed to load academic calendar")}catch(ye){console.error("Error loading academic year:",ye)}},[]),we=S.useCallback(async()=>{try{if(N(!_),!_){const ye=Date.now(),[wt,Nr]=await Promise.all([n(`/.netlify/functions/get-all-tests?t=${ye}`),n(`/.netlify/functions/get-test-assignments?t=${ye}`)]);console.log(" Active tests response:",wt),console.log(" Assignments response:",Nr);const Or=wt.tests||[],dn=(Nr.assignments||[]).reduce((dt,Rt)=>{const Pt=`${Rt.test_type}-${Rt.test_id}`;return dt[Pt]||(dt[Pt]=[]),dt[Pt].push(Rt),dt},{}),Oe=Or.map(dt=>{const Rt=`${dt.test_type}-${dt.test_id}`,Pt=dn[Rt]||[],mn=Pt.some(tt=>tt.is_active);return{...dt,is_active:mn,assignments:Pt}});H(Oe),console.log(" All tests with status set to state:",Oe)}}catch(ye){console.error("Error loading tests:",ye),g({type:"error",message:"Failed to load tests"})}},[n,_]),Se=S.useCallback((ye,wt)=>{bt(Nr=>({...Nr,[ye]:wt}))},[]),He=S.useCallback((ye,wt)=>{ze(Nr=>({...Nr,[ye]:wt}))},[]),ct=S.useCallback((ye,wt)=>{$e(Nr=>({...Nr,[ye]:wt}))},[]);S.useCallback(()=>{console.log(" Testing local storage...");try{const ye={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(ye));const wt=JSON.parse(localStorage.getItem("test"));console.log(" Local storage test successful:",wt),g({type:"success",message:"Local storage test successful"})}catch(ye){console.error(" Local storage test failed:",ye),g({type:"error",message:"Local storage test failed"})}},[]),S.useCallback(()=>{console.log(" Clearing local storage...");try{localStorage.clear(),console.log(" Local storage cleared"),g({type:"success",message:"Local storage cleared"})}catch(ye){console.error(" Error clearing local storage:",ye),g({type:"error",message:"Error clearing local storage"})}},[]),S.useCallback(async()=>{console.log(" Checking teacher subjects...");try{const wt=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log(" Teachers data:",wt),g({type:"success",message:`Found ${wt.length} teachers`})}catch(ye){console.error(" Error checking teacher subjects:",ye),g({type:"error",message:"Error checking teacher subjects"})}},[n]);const qe=S.useCallback(async ye=>{ye.preventDefault();try{console.log(" Submitting user:",Re);const wt=await s("/.netlify/functions/add-user",Re);wt.success?(g({type:"success",message:"User added successfully"}),dr(!1),bt({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),ue()):g({type:"error",message:wt.message||"Failed to add user"})}catch(wt){console.error(" Error adding user:",wt),g({type:"error",message:"Error adding user"})}},[Re,s,ue]),oe=S.useCallback(async ye=>{ye.preventDefault();try{console.log(" Submitting teacher:",Pe);const wt=await s("/.netlify/functions/add-teacher",Pe);wt.success?(g({type:"success",message:"Teacher added successfully"}),fr(!1),ze({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),be()):g({type:"error",message:wt.message||"Failed to add teacher"})}catch(wt){console.error(" Error adding teacher:",wt),g({type:"error",message:"Error adding teacher"})}},[Pe,s,be]),fe=S.useCallback(async ye=>{ye.preventDefault();try{console.log(" Submitting subject:",ke);const wt=await s("/.netlify/functions/add-subject",ke);wt.success?(g({type:"success",message:"Subject added successfully"}),me(!1),$e({subject_id:"",subject:"",description:"",is_active:!0}),xe()):g({type:"error",message:wt.message||"Failed to add subject"})}catch(wt){console.error(" Error adding subject:",wt),g({type:"error",message:"Error adding subject"})}},[ke,s,xe]),Te=S.useCallback(ye=>{A(ye),I({name:ye.name||"",surname:ye.surname||"",grade:ye.grade||"",class:ye.class||"",student_id:ye.student_id||"",nickname:ye.nickname||"",password:ye.password||"",is_active:ye.is_active!==void 0?ye.is_active:!0})},[]),Ee=S.useCallback(async()=>{try{const ye=[];Object.keys(j).forEach(wt=>{wt!=="student_id"&&j[wt]!==F[wt]&&ye.push({fieldName:wt,newValue:j[wt]})});for(const wt of ye)await s("/.netlify/functions/update-user",{userId:F.student_id,fieldName:wt.fieldName,newValue:wt.newValue});g({type:"success",message:"User updated successfully!"}),A(null),I({}),ue()}catch{g({type:"error",message:"Failed to update user"})}},[j,F,s,ue]),Xe=S.useCallback(async ye=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:ye})).success&&(g({type:"success",message:"User deleted successfully!"}),ue())}catch{g({type:"error",message:"Failed to delete user"})}},[s,ue]),ot=S.useCallback(ye=>{Y(ye),se({teacher_id:ye.teacher_id||"",username:ye.username||"",password:ye.password||"",first_name:ye.first_name||"",last_name:ye.last_name||"",is_active:ye.is_active!==void 0?ye.is_active:!0})},[]),xt=S.useCallback(async()=>{try{const ye=[];Object.keys(Z).forEach(wt=>{wt!=="teacher_id"&&Z[wt]!==B[wt]&&ye.push({fieldName:wt,newValue:Z[wt]})});for(const wt of ye)await s("/.netlify/functions/update-teacher",{teacherId:B.teacher_id,fieldName:wt.fieldName,newValue:wt.newValue});g({type:"success",message:"Teacher updated successfully!"}),Y(null),se({}),be()}catch{g({type:"error",message:"Failed to update teacher"})}},[Z,B,s,be]),qt=S.useCallback(async ye=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:ye})).success&&(g({type:"success",message:"Teacher deleted successfully!"}),be())}catch{g({type:"error",message:"Failed to delete teacher"})}},[s,be]),yt=S.useCallback(ye=>{te(ye),V({subject_id:ye.subject_id||"",subject:ye.subject||""})},[]),Yt=S.useCallback(async()=>{try{const ye=[];Object.keys(L).forEach(wt=>{wt!=="subject_id"&&L[wt]!==ee[wt]&&ye.push({fieldName:wt,newValue:L[wt]})});for(const wt of ye)await s("/.netlify/functions/update-subject",{subjectId:ee.subject_id,fieldName:wt.fieldName,newValue:wt.newValue});g({type:"success",message:"Subject updated successfully!"}),te(null),V({}),xe()}catch{g({type:"error",message:"Failed to update subject"})}},[L,ee,s,xe]),_r=S.useCallback(async ye=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const wt=await s("/.netlify/functions/delete-subject",{subjectId:ye});wt.success?(g({type:"success",message:"Subject deleted successfully!"}),xe()):g({type:"error",message:wt.message||"Failed to delete subject"})}catch{g({type:"error",message:"Failed to delete subject"})}},[s,xe]),kr=S.useCallback((ye,wt)=>{Et(Nr=>({...Nr,[ye]:wt}))},[]),xr=S.useCallback(async ye=>{if(ye.preventDefault(),!Be.startDate||!Be.endDate||!Be.teacherId){g({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const wt=await s("/.netlify/functions/delete-test-data",Be);wt.success?(g({type:"success",message:`Successfully deleted ${wt.deletedCount} test records!`}),Fe(!1),Et({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):g({type:"error",message:wt.message||"Failed to delete test data"})}catch{g({type:"error",message:"Failed to delete test data"})}},[Be,s]),Gr=S.useCallback(async(ye,wt,Nr)=>{try{const Or=Date.now(),Vn=await n(`/.netlify/functions/get-test-assignments?t=${Or}`);if(Vn.success&&Vn.assignments){const dn=Vn.assignments.filter(Oe=>Oe.test_id===parseInt(ye)&&Oe.test_type===wt);if(dn.length===0){g({type:"error",message:"No assignments found for this test"});return}for(const Oe of dn){const dt=await s("/.netlify/functions/remove-assignment",{teacher_id:Nr,assignment_id:Oe.assignment_id,test_type:wt,test_id:ye});if(!dt.success){g({type:"error",message:`Failed to complete test: ${dt.message}`});return}}g({type:"success",message:"Test marked as complete successfully!"}),await we()}else g({type:"error",message:"Failed to get test assignments"})}catch(Or){console.error("Error completing test:",Or),g({type:"error",message:"Failed to complete test"})}},[s,n,we]),un=S.useCallback(async(ye,wt,Nr)=>{try{const Or=Date.now(),Vn=await n(`/.netlify/functions/get-test-assignments?t=${Or}`);if(Vn.success&&Vn.assignments){const dn=Vn.assignments.filter(Oe=>Oe.test_id===parseInt(ye)&&Oe.test_type===wt);if(dn.length===0){g({type:"error",message:"No assignments found for this test"});return}for(const Oe of dn){const dt=await s("/.netlify/functions/remove-assignment",{teacher_id:Nr,assignment_id:Oe.assignment_id,test_type:wt,test_id:ye,mark_active:!0});if(!dt.success){g({type:"error",message:`Failed to reactivate test: ${dt.message}`});return}}g({type:"success",message:"Test marked as active successfully!"}),await we()}else g({type:"error",message:"Failed to get test assignments"})}catch(Or){console.error("Error reactivating test:",Or),g({type:"error",message:"Failed to reactivate test"})}},[s,n,we]),Xr=S.useCallback(async(ye=!1)=>{try{const wt=Date.now(),Nr=await n(`/.netlify/functions/get-all-tests?t=${wt}`);console.log(" Actual tests response:",Nr),Ce(Nr.tests||[]),console.log(" Actual tests set to state:",Nr.tests||[])}catch(wt){console.error("Error loading actual tests:",wt),g({type:"error",message:"Failed to load tests"})}},[n]),cr=S.useCallback(async(ye,wt,Nr)=>{try{const Or=await s("/.netlify/functions/delete-test",{test_id:ye,test_type:wt,teacher_id:Nr});if(Or.success){g({type:"success",message:"Test deleted successfully!"});const Vn=`${wt}-${ye}-${Nr}`;rt(dn=>{const Oe=new Set(dn);return Oe.delete(Vn),Oe}),await Xr(!0)}else g({type:"error",message:`Failed to delete test: ${Or.message}`})}catch(Or){console.error("Error deleting test:",Or),g({type:"error",message:"Failed to delete test"})}},[s,Xr]),na=S.useCallback((ye,wt,Nr)=>{const Or=`${wt}-${ye}-${Nr}`;rt(Vn=>{const dn=new Set(Vn);return dn.has(Or)?dn.delete(Or):dn.add(Or),dn})},[]),hn=E?De.filter(ye=>ye.grade.toString()===E):De,Gn=M.filter(ye=>{const wt=X==="all"?!0:X==="active"?ye.is_active:!ye.is_active,Nr=!W||ye.teacher_id===W,Or=!z||new Date(ye.created_at)>=new Date(z),Vn=!Q||new Date(ye.created_at)<=new Date(Q+"T23:59:59");return wt&&Nr&&Or&&Vn}),Nn=pe.filter(ye=>{const wt=!Ae||ye.teacher_id===Ae,Nr=!Le||new Date(ye.created_at)>=new Date(Le),Or=!et||new Date(ye.created_at)<=new Date(et+"T23:59:59");return wt&&Nr&&Or}),Ws=S.useCallback(()=>{if(lt.size===Nn.length&&Nn.length>0)rt(new Set);else{const ye=Nn.map(wt=>`${wt.test_type}-${wt.test_id}-${wt.teacher_id}`);rt(new Set(ye))}},[lt.size,Nn]),Sn=S.useCallback(async()=>{if(lt.size!==0&&window.confirm(`Are you sure you want to delete ${lt.size} test(s)?`))try{const ye=Array.from(lt).map(wt=>{const[Nr,Or,Vn]=wt.split("-");return s("/.netlify/functions/delete-test",{test_id:parseInt(Or),test_type:Nr,teacher_id:Vn})});await Promise.all(ye),g({type:"success",message:`Successfully deleted ${lt.size} test(s)!`}),rt(new Set),await Xr(!0)}catch(ye){console.error("Error deleting marked tests:",ye),g({type:"error",message:"Failed to delete some tests. Please try again."})}},[lt,s,Xr]);return l.jsxs(at.div,{id:"admin-cabinet-main",className:Ue.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(at.div,{className:Ue.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:Ue.headerContent,children:l.jsxs("div",{className:Ue.headerFlex,children:[l.jsxs(at.div,{className:Ue.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(at.div,{className:Ue.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:e?.username?.charAt(0)||"A"})})}),l.jsxs("div",{children:[l.jsx("h1",{className:Ue.adminText,children:e?.username||"Administrator"}),l.jsx("p",{className:Ue.adminSubtext,children:"Administrator Dashboard"})]})]}),l.jsxs(at.div,{className:Ue.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:Kt,className:Ue.menuButton,style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(at.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:ht?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(ko,{children:ht&&l.jsx(at.div,{className:Ue.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(at.button,{onClick:wr,className:Ue.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(at.button,{onClick:()=>{Kt(),r()},className:Ue.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),o&&l.jsx(Wr,{text:"Loading..."}),u&&l.jsx(mc,{type:"error",message:u,onClose:()=>d(null)}),f&&l.jsx(mc,{type:f.type,message:f.message,onClose:()=>g(null)}),zt&&l.jsx("div",{className:Ue.modalOverlay,children:l.jsxs("div",{className:Ue.modalContent,children:[l.jsx("h2",{className:Ue.modalTitle,children:"Change Password"}),l.jsxs("form",{className:"space-y-4",children:[l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{htmlFor:"currentPassword",className:Ue.formLabel,children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",className:Ue.formInput})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{htmlFor:"newPassword",className:Ue.formLabel,children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",className:Ue.formInput})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{htmlFor:"confirmPassword",className:Ue.formLabel,children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",className:Ue.formInput})]}),l.jsxs("div",{className:Ue.modalActions,children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:lr,className:"flex-1",children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),l.jsx(at.div,{className:Ue.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:l.jsxs("div",{className:"space-y-6",children:[l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:l.jsxs(jt,{className:Ue.cardContainer,children:[l.jsx(jt.Header,{className:Ue.cardHeader,children:l.jsx(jt.Title,{className:Ue.cardTitle,children:"User Management"})}),l.jsxs(jt.Body,{className:Ue.cardBody,children:[l.jsxs("div",{className:Ue.buttonGroup,children:[l.jsx(Ze,{variant:"primary",onClick:()=>dr(!0),className:Ue.buttonPrimary,children:"Add User"}),l.jsx(Ze,{variant:"secondary",onClick:()=>{ue(),x(!p)},className:Ue.buttonSecondary,children:p?"Hide Users Table":"Get All Users "})]}),l.jsx(ko,{children:or&&l.jsxs(at.div,{className:Ue.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),l.jsxs("form",{onSubmit:qe,className:"space-y-4",children:[l.jsxs("div",{className:Ue.formGrid,children:[l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Grade"}),l.jsx("input",{type:"text",value:Re.grade,onChange:ye=>Se("grade",ye.target.value),className:Ue.formInput,placeholder:"Enter grade"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Class"}),l.jsx("input",{type:"text",value:Re.class,onChange:ye=>Se("class",ye.target.value),className:Ue.formInput,placeholder:"Enter class"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Number"}),l.jsx("input",{type:"text",value:Re.number,onChange:ye=>Se("number",ye.target.value),className:Ue.formInput,placeholder:"Enter number"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Student ID"}),l.jsx("input",{type:"text",value:Re.student_id,onChange:ye=>Se("student_id",ye.target.value),className:Ue.formInput,placeholder:"Enter student ID"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Name"}),l.jsx("input",{type:"text",value:Re.name,onChange:ye=>Se("name",ye.target.value),className:Ue.formInput,placeholder:"Enter name"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Surname"}),l.jsx("input",{type:"text",value:Re.surname,onChange:ye=>Se("surname",ye.target.value),className:Ue.formInput,placeholder:"Enter surname"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Nickname"}),l.jsx("input",{type:"text",value:Re.nickname,onChange:ye=>Se("nickname",ye.target.value),className:Ue.formInput,placeholder:"Enter nickname"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:Re.password,onChange:ye=>Se("password",ye.target.value),className:Ue.formInput,placeholder:"Enter password"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"userActive",checked:Re.is_active,onChange:ye=>Se("is_active",ye.target.checked),className:Ue.formCheckbox}),l.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:Ue.formActions,children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:()=>dr(!1),className:Ue.buttonSecondary,children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",className:Ue.buttonPrimary,children:"Add User"})]})]})]})}),p&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",hn.length," of ",De.length,")"]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),l.jsxs("select",{value:E,onChange:ye=>P(ye.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Grades"}),[...new Set(De.map(ye=>ye.grade))].sort().map(ye=>l.jsxs("option",{value:ye,children:["Grade ",ye]},ye))]})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:l.jsxs("table",{className:Ue.table,children:[l.jsx("thead",{className:Ue.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Ue.tableHeaderCell,children:"Name"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Grade"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Class"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Student ID"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Number"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Nickname"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Ue.tableBody,children:hn.map((ye,wt)=>l.jsxs("tr",{className:Ue.tableRow,children:[l.jsxs("td",{className:Ue.tableCell,children:[ye.name," ",ye.surname]}),l.jsx("td",{className:Ue.tableCell,children:ye.grade}),l.jsx("td",{className:Ue.tableCell,children:ye.class}),l.jsx("td",{className:Ue.tableCell,children:ye.student_id}),l.jsx("td",{className:Ue.tableCell,children:ye.number}),l.jsx("td",{className:Ue.tableCell,children:ye.nickname}),l.jsx("td",{className:Ue.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>Te(ye),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>Xe(ye.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ye.id||wt))})]})})})]})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(jt,{className:Ue.cardContainer,children:[l.jsxs(jt.Header,{className:Ue.cardHeader,children:[l.jsx(jt.Title,{className:Ue.cardTitle,children:"Teacher Management"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:i,className:"px-3 py-1.5 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs whitespace-nowrap",title:"Check and mark overdue assignments (7+ days old) as inactive",children:"Check Overdue Assignments"}),l.jsx(Ze,{variant:"primary",onClick:()=>fr(!0),className:"text-xs whitespace-nowrap",children:"Add Teacher"}),l.jsx(Ze,{variant:"secondary",onClick:()=>{be(),w(!v)},className:"text-xs whitespace-nowrap",children:v?"Hide Teachers Table":"Get All Teachers "})]})]}),l.jsxs(jt.Body,{className:Ue.cardBody,children:[l.jsx(ko,{children:Er&&l.jsxs(at.div,{className:Ue.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),l.jsxs("form",{onSubmit:oe,className:"space-y-4",children:[l.jsxs("div",{className:Ue.formGrid,children:[l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Teacher ID"}),l.jsx("input",{type:"text",value:Pe.teacher_id,onChange:ye=>He("teacher_id",ye.target.value),className:Ue.formInput,placeholder:"Enter teacher ID"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Username"}),l.jsx("input",{type:"text",value:Pe.username,onChange:ye=>He("username",ye.target.value),className:Ue.formInput,placeholder:"Enter username"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:Pe.password,onChange:ye=>He("password",ye.target.value),className:Ue.formInput,placeholder:"Enter password"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"First Name"}),l.jsx("input",{type:"text",value:Pe.first_name,onChange:ye=>He("first_name",ye.target.value),className:Ue.formInput,placeholder:"Enter first name"})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Last Name"}),l.jsx("input",{type:"text",value:Pe.last_name,onChange:ye=>He("last_name",ye.target.value),className:Ue.formInput,placeholder:"Enter last name"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacherActive",checked:Pe.is_active,onChange:ye=>He("is_active",ye.target.checked),className:Ue.formCheckbox}),l.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:Ue.formActions,children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:()=>fr(!1),className:Ue.buttonSecondary,children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",className:Ue.buttonPrimary,children:"Add Teacher"})]})]})]})}),F&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),l.jsx("input",{type:"text",value:j.name,onChange:ye=>I({...j,name:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),l.jsx("input",{type:"text",value:j.surname,onChange:ye=>I({...j,surname:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),l.jsx("input",{type:"number",value:j.grade,onChange:ye=>I({...j,grade:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("input",{type:"number",value:j.class,onChange:ye=>I({...j,class:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),l.jsx("input",{type:"text",value:j.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),l.jsx("input",{type:"text",value:j.nickname,onChange:ye=>I({...j,nickname:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:j.password,onChange:ye=>I({...j,password:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"is_active",checked:j.is_active,onChange:ye=>I({...j,is_active:ye.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{A(null),I({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:Ee,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),v&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",Ke.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Ue.table,children:[l.jsx("thead",{className:Ue.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Ue.tableHeaderCell,children:"Teacher ID"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Name"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Username"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Password"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Status"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Ue.tableBody,children:Ke.map((ye,wt)=>l.jsxs("tr",{className:Ue.tableRow,children:[l.jsx("td",{className:Ue.tableCell,children:ye.teacher_id}),l.jsxs("td",{className:Ue.tableCell,children:[ye.first_name," ",ye.last_name]}),l.jsx("td",{className:Ue.tableCell,children:ye.username}),l.jsx("td",{className:Ue.tableCell,children:ye.password}),l.jsx("td",{className:Ue.tableCell,children:l.jsx("span",{className:ye.is_active?Ue.statusActive:Ue.statusInactive,children:ye.is_active?"Active":"Inactive"})}),l.jsx("td",{className:Ue.tableCell,children:new Date(ye.created_at).toLocaleDateString()}),l.jsx("td",{className:Ue.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>ot(ye),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>qt(ye.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ye.teacher_id||wt))})]})})})]})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:l.jsxs(jt,{className:Ue.cardContainer,children:[l.jsx(jt.Header,{className:Ue.cardHeader,children:l.jsx(jt.Title,{className:Ue.cardTitle,children:"Subject Management"})}),l.jsxs(jt.Body,{className:Ue.cardBody,children:[l.jsxs("div",{className:Ue.buttonGroup,children:[l.jsx(Ze,{variant:"primary",onClick:()=>me(!0),className:Ue.buttonPrimary,children:"Add Subject"}),l.jsx(Ze,{variant:"secondary",onClick:()=>{xe(),k(!C)},className:Ue.buttonSecondary,children:C?"Hide Subjects Table":"Get All Subjects "})]}),l.jsx(ko,{children:nr&&l.jsxs(at.div,{className:Ue.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),l.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Subject Name"}),l.jsx("input",{type:"text",value:ke.subject,onChange:ye=>ct("subject",ye.target.value),className:Ue.formInput,placeholder:"Enter subject name",required:!0}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),l.jsxs("div",{className:Ue.formActions,children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:()=>me(!1),className:Ue.buttonSecondary,children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",className:Ue.buttonPrimary,children:"Add Subject"})]})]})]})}),B&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),l.jsx("input",{type:"text",value:Z.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),l.jsx("input",{type:"text",value:Z.username,onChange:ye=>se({...Z,username:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:Z.password,onChange:ye=>se({...Z,password:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),l.jsx("input",{type:"text",value:Z.first_name,onChange:ye=>se({...Z,first_name:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),l.jsx("input",{type:"text",value:Z.last_name,onChange:ye=>se({...Z,last_name:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:Z.is_active,onChange:ye=>se({...Z,is_active:ye.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{Y(null),se({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:xt,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),ee&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),l.jsx("input",{type:"text",value:L.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),l.jsx("input",{type:"text",value:L.subject,onChange:ye=>V({...L,subject:ye.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>te(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),l.jsx("button",{onClick:Yt,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),C&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",Ye.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Ue.table,children:[l.jsx("thead",{className:Ue.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Ue.tableHeaderCell,children:"Subject ID"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Subject Name"}),l.jsx("th",{className:Ue.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Ue.tableBody,children:Ye.map((ye,wt)=>l.jsxs("tr",{className:Ue.tableRow,children:[l.jsx("td",{className:Ue.tableCell,children:ye.subject_id}),l.jsx("td",{className:Ue.tableCell,children:ye.subject}),l.jsx("td",{className:Ue.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>yt(ye),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>_r(ye.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ye.subject_id||wt))})]})})})]})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(jt,{className:Ue.cardContainer,children:[l.jsx(jt.Header,{className:Ue.cardHeader,children:l.jsx(jt.Title,{className:Ue.cardTitle,children:"Test Data Deletion"})}),l.jsxs(jt.Body,{className:Ue.cardBody,children:[l.jsx("div",{className:Ue.buttonGroup,children:l.jsx(Ze,{variant:"danger",onClick:()=>Fe(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),l.jsx(ko,{children:Ne&&l.jsxs(at.div,{className:Ue.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),l.jsxs("form",{onSubmit:xr,className:"space-y-4",children:[l.jsxs("div",{className:Ue.formGrid,children:[l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Start Date *"}),l.jsx("input",{type:"date",value:Be.startDate,onChange:ye=>kr("startDate",ye.target.value),className:Ue.formInput,required:!0})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"End Date *"}),l.jsx("input",{type:"date",value:Be.endDate,onChange:ye=>kr("endDate",ye.target.value),className:Ue.formInput,required:!0})]})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Teacher ID *"}),l.jsxs("select",{value:Be.teacherId,onChange:ye=>kr("teacherId",ye.target.value),className:Ue.formInput,required:!0,children:[l.jsx("option",{value:"",children:"Select a teacher"}),Ke.map(ye=>l.jsxs("option",{value:ye.teacher_id,children:[ye.teacher_id," - ",ye.first_name," ",ye.last_name]},ye.teacher_id))]})]}),l.jsxs("div",{className:Ue.formGroup,children:[l.jsx("label",{className:Ue.formLabel,children:"Subject (Optional)"}),l.jsxs("select",{value:Be.subjectId,onChange:ye=>kr("subjectId",ye.target.value),className:Ue.formInput,children:[l.jsx("option",{value:"",children:"All subjects"}),Ye.map(ye=>l.jsx("option",{value:ye.subject_id,children:ye.subject},ye.subject_id))]})]}),l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),l.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[l.jsx("p",{children:"This will permanently delete:"}),l.jsxs("ul",{className:"list-disc list-inside mt-1",children:[l.jsx("li",{children:"All test records within the date range"}),l.jsx("li",{children:"All test questions and answers"}),l.jsx("li",{children:"All test results and submissions"}),l.jsx("li",{children:"All test assignments"}),l.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),l.jsxs("div",{className:Ue.formActions,children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:()=>Fe(!1),className:Ue.buttonSecondary,children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:l.jsxs(jt,{className:Ue.cardContainer,children:[l.jsx(jt.Header,{className:Ue.cardHeader,children:l.jsx(jt.Title,{className:Ue.cardTitle,children:"Assignments Management"})}),l.jsxs(jt.Body,{className:Ue.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(Ze,{variant:"primary",onClick:we,className:Ue.buttonPrimary,children:_?"Hide Assignments Table":"Get All Assignments "})}),_&&l.jsx("div",{className:"mb-4",children:l.jsx("p",{className:"text-sm text-gray-600",children:"Showing all tests (Active and Completed)"})}),_&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Assignments (",Gn.length," of ",M.length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:X,onChange:ye=>ie(ye.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"all",children:"All"}),l.jsx("option",{value:"active",children:"Active"}),l.jsx("option",{value:"completed",children:"Completed"})]}),l.jsxs("select",{value:W,onChange:ye=>R(ye.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),Ke.map(ye=>l.jsxs("option",{value:ye.teacher_id,children:[ye.first_name," ",ye.last_name]},ye.teacher_id))]}),l.jsx("input",{type:"date",value:z,onChange:ye=>K(ye.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:Q,onChange:ye=>ae(ye.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:Ue.table,children:[l.jsx("thead",{className:Ue.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Type"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider text-center",children:"Questions"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Created"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:Ue.tableBody,children:Gn.map((ye,wt)=>l.jsxs("tr",{className:Ue.tableRow,children:[l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900 max-w-xs truncate",title:ye.test_name,children:ye.test_name}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:ye.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:ye.teacher_name}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900 text-center",children:ye.num_questions}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:new Date(ye.created_at).toLocaleDateString()}),l.jsx("td",{className:"px-4 py-3 text-xs",children:l.jsx("div",{className:"flex space-x-2",children:ye.is_active?l.jsx("button",{onClick:()=>Gr(ye.test_id,ye.test_type,ye.teacher_id),className:"text-xs font-medium px-2 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):l.jsx("button",{onClick:()=>un(ye.test_id,ye.test_type,ye.teacher_id),className:"text-xs font-medium px-2 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Mark Active"})})})]},`${ye.test_type}-${ye.test_id}-${wt}`))})]})})})]})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(jt,{className:Ue.cardContainer,children:[l.jsx(jt.Header,{className:Ue.cardHeader,children:l.jsx(jt.Title,{className:Ue.cardTitle,children:"Test Management"})}),l.jsxs(jt.Body,{className:Ue.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(Ze,{variant:"primary",onClick:()=>{_e||Xr(),ne(!_e)},className:Ue.buttonPrimary,children:_e?"Hide Tests Table":"Get All Tests "})}),_e&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",Nn.length," of ",pe.length,")"]}),lt.size>0&&l.jsxs(Ze,{variant:"danger",onClick:Sn,className:"text-sm px-4 py-2",children:["Delete Marked (",lt.size,")"]})]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:Ae,onChange:ye=>Ge(ye.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),Ke.map(ye=>l.jsxs("option",{value:ye.teacher_id,children:[ye.first_name," ",ye.last_name]},ye.teacher_id))]}),l.jsx("input",{type:"date",value:Le,onChange:ye=>At(ye.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:et,onChange:ye=>pt(ye.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:Ue.table,children:[l.jsx("thead",{className:Ue.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:l.jsx("input",{type:"checkbox",checked:lt.size===Nn.length&&Nn.length>0,onChange:Ws,className:"cursor-pointer"})}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Type"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider text-center",children:"Questions"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Created"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:Ue.tableBody,children:Nn.map((ye,wt)=>l.jsxs("tr",{className:Ue.tableRow,children:[l.jsx("td",{className:Ue.tableCell,children:l.jsx("input",{type:"checkbox",checked:lt.has(`${ye.test_type}-${ye.test_id}-${ye.teacher_id}`),onChange:()=>na(ye.test_id,ye.test_type,ye.teacher_id),className:"cursor-pointer"})}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900 max-w-xs truncate",title:ye.test_name,children:ye.test_name}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:ye.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:ye.teacher_name}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900 text-center",children:ye.num_questions}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:new Date(ye.created_at).toLocaleDateString()}),l.jsx("td",{className:"px-4 py-3 text-xs",children:l.jsx("div",{className:"flex space-x-2",children:l.jsx("button",{onClick:()=>cr(ye.test_id,ye.test_type,ye.teacher_id),className:"text-xs font-medium px-2 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete"})})})]},`${ye.test_type}-${ye.test_id}-${wt}`))})]})})})]})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(jt,{className:Ue.cardContainer,children:[l.jsx(jt.Header,{className:Ue.cardHeader,children:l.jsx(jt.Title,{className:Ue.cardTitle,children:"Debug & Testing"})}),l.jsx(jt.Body,{className:Ue.cardBody})]})})]})})]})},R3e=()=>{const{isAdmin:e,getCurrentAdminId:t,logout:r}=ds(),{get:n}=tl(),{showNotification:s}=Aa();S.useEffect(()=>{a()},[]);const a=S.useCallback(async()=>{if(console.log(" Initializing Admin Application..."),!e()){console.error(" User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await o(),c(),u(),console.log(" Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(d){console.error(" Error initializing admin app:",d),s("Failed to initialize admin dashboard","error")}},[e,t,r,s,n]),i=S.useCallback(()=>{console.log(" Initializing global event listeners...");const d=f=>{f.ctrlKey&&f.key==="k"&&(f.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[]),o=S.useCallback(async()=>{try{console.log(" Loading admin data...");const[d,f,g,p]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),xc.loadAcademicCalendar()]);d.status==="fulfilled"&&d.value?.success&&console.log(" Users loaded:",d.value.users?.length||0),f.status==="fulfilled"&&f.value?.success&&console.log(" Teachers loaded:",f.value.teachers?.length||0),g.status==="fulfilled"&&g.value?.success&&console.log(" Subjects loaded:",g.value.subjects?.length||0),p.status==="fulfilled"&&Array.isArray(p.value)&&console.log(" Academic years loaded:",p.value.length||0),console.log(" Admin data loading completed")}catch(d){throw console.error(" Error loading admin data:",d),d}},[n]),c=S.useCallback(()=>{console.log(" Initializing test deletion functionality..."),console.log(" Test deletion functionality initialized")},[]),u=S.useCallback(()=>{console.log(" Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const f=document.getElementById("allSubjectsContainer"),g=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!f){console.error(" allSubjectsContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const f=document.getElementById("addSubjectForm");f&&(f.style.display="block")},window.hideAddSubjectForm=()=>{const f=document.getElementById("addSubjectForm"),g=document.getElementById("newSubjectForm");f&&(f.style.display="none"),g&&g.reset()},window.showAddAcademicYearForm=()=>{const f=document.getElementById("addAcademicYearForm");f&&(f.style.display="block")},window.hideAddAcademicYearForm=()=>{const f=document.getElementById("addAcademicYearForm"),g=document.getElementById("newAcademicYearForm");f&&(f.style.display="none"),g&&g.reset()},window.toggleUsersContent=()=>{const f=document.getElementById("allUsersContainer"),g=document.querySelector('button[onclick="toggleUsersContent()"]');if(!f){console.error(" allUsersContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const f=document.getElementById("addUserForm");f&&(f.style.display="block")},window.hideAddUserForm=()=>{const f=document.getElementById("addUserForm"),g=document.getElementById("newUserForm");f&&(f.style.display="none"),g&&g.reset()},window.showAddTeacherForm=()=>{const f=document.getElementById("addTeacherForm");f&&(f.style.display="block")},window.hideAddTeacherForm=()=>{const f=document.getElementById("addTeacherForm"),g=document.getElementById("newTeacherForm");f&&(f.style.display="none"),g&&g.reset()},window.toggleTeachersContent=()=>{const f=document.getElementById("allTeachersContainer"),g=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!f){console.error(" allTeachersContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const f=document.getElementById("allTestsContainer"),g=document.querySelector('button[onclick="toggleTestsContent()"]');if(!f){console.error(" allTestsContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const f=document.getElementById("allAssignmentsContainer"),g=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!f){console.error(" allAssignmentsContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const f=document.getElementById("allResultsContainer"),g=document.querySelector('button[onclick="toggleResultsContent()"]');if(!f){console.error(" allResultsContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Results":"Hide Results"};const d={};window.toggleSection=f=>{console.log(` toggleSection called with sectionId: ${f}`);const g=Date.now();if(d[f]&&g-d[f]<300){console.log(` Ignoring rapid successive call for ${f}`);return}d[f]=g;const p=document.getElementById(f);if(!p){console.error(` Section with id '${f}' not found!`);return}const x=p.style.display!=="none";p.style.display=x?"none":"block";const v=document.querySelector(`button[onclick="toggleSection('${f}')"]`);v&&(v.textContent=x?"Show":"Hide")},window.addClickListeners=()=>{console.log(" Adding click listeners to section headers...");const f=document.querySelectorAll(".section-header");console.log(` Found ${f.length} section headers`),f.forEach((g,p)=>{const x=g.textContent.trim();if(console.log(` Processing header ${p+1}:`,x),g.dataset.listenerAdded==="true"){console.log(` Skipping header ${x} - listener already added`);return}g.addEventListener("click",()=>{const v=g.dataset.sectionId;v&&window.toggleSection(v)}),g.dataset.listenerAdded="true",console.log(` Added click listener to header: ${x}`)})},window.makeFieldEditable=f=>{const g=f.textContent;f.dataset.field;const p=document.createElement("input");p.type="text",p.value=g,p.className="editable-input";const x=document.createElement("button");x.textContent="Save",x.className="btn-save",x.onclick=()=>window.saveField(f,p,x,v);const v=document.createElement("button");v.textContent="Cancel",v.className="btn-cancel",v.onclick=()=>{f.textContent=g,f.style.display="block",p.remove(),x.remove(),v.remove()},f.style.display="none",f.parentNode.insertBefore(p,f),f.parentNode.insertBefore(x,f),f.parentNode.insertBefore(v,f)},window.saveField=(f,g,p,x)=>{const v=g.value.trim(),w=f.dataset.field,C=f.dataset.recordId;if(!v){alert("Field cannot be empty");return}console.log(`Saving field ${w} for record ${C} with value: ${v}`),f.textContent=v,f.style.display="block",g.remove(),p.remove(),x.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const f=localStorage.getItem("test");return localStorage.removeItem("test"),console.log(" localStorage is working"),!0}catch(f){return console.error(" localStorage error:",f),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log(" localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const f={};for(let v=0;v<localStorage.length;v++){const w=localStorage.key(v);f[w]=localStorage.getItem(w)}const g=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),p=URL.createObjectURL(g),x=document.createElement("a");x.href=p,x.download="localStorage-backup.json",x.click(),URL.revokeObjectURL(p)},console.log(" Admin functions exposed globally")},[]);return e()?l.jsx(I3e,{}):l.jsxs("div",{className:"admin-error",children:[l.jsx("h2",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access the admin dashboard."}),l.jsx("button",{onClick:r,children:"Return to Login"})]})},uT=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,role:n,isLoading:s}=ds();return s?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?t&&!t.includes(n)?l.jsx(ym,{to:"/unauthorized",replace:!0}):e:l.jsx(ym,{to:"/login",replace:!0})},M3e=()=>l.jsxs("div",{className:"unauthorized-page",children:[l.jsx("h1",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access this page."})]}),L3e=()=>l.jsx(BM,{children:l.jsx(MB,{children:l.jsx(IB,{children:l.jsx(ZK,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:l.jsx("div",{className:"app",children:l.jsxs(yN,{children:[l.jsx(Rs,{path:"/login",element:l.jsx(xae,{})}),l.jsx(Rs,{path:"/unauthorized",element:l.jsx(M3e,{})}),l.jsx(Rs,{path:"/student/*",element:l.jsx(uT,{allowedRoles:["student"],children:l.jsx(kie,{})})}),l.jsx(Rs,{path:"/teacher/*",element:l.jsx(uT,{allowedRoles:["teacher"],children:l.jsx(D3e,{})})}),l.jsx(Rs,{path:"/admin/*",element:l.jsx(uT,{allowedRoles:["admin"],children:l.jsx(R3e,{})})}),l.jsx(Rs,{path:"/",element:l.jsx(ym,{to:"/login",replace:!0})}),l.jsx(Rs,{path:"*",element:l.jsx(ym,{to:"/login",replace:!0})})]})})})})})});class B3e{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data",this.startIntegrityMonitoring()}startIntegrityMonitoring(){setInterval(()=>{this.performIntegrityCheck().catch(t=>{console.error("Integrity check failed:",t)})},3e4)}async performIntegrityCheck(){try{const t=await Fs.get();t&&!this.validateTokenFormat(t)&&(console.warn("Integrity check failed - corrupted token detected"),await this.restoreFromBackup()||(console.warn("No valid backup available - clearing authentication"),await this.clearAuth()))}catch(t){console.error("Error during integrity check:",t)}}async getToken(){const t=await Fs.get();return t&&!this.validateTokenFormat(t)?(console.warn("Corrupted token detected in storage - clearing it"),this.clearAuth(),null):t}getTokenSync(){return null}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}async setToken(t){if(!this.validateTokenFormat(t))return console.error("Invalid token format - refusing to store corrupted token"),!1;try{this.decodeToken(t);const r=await Fs.get();if(r)try{localStorage.setItem(`${this.tokenKey}_backup`,r)}catch{}const n=await Fs.set(t);return n?console.log("Token stored successfully with secure storage (hash verification, retry, write verification)"):console.error("Failed to store token - secure storage failed"),n}catch(r){return console.error("Failed to store token - token is corrupted:",r),!1}}async restoreFromBackup(){try{const t=localStorage.getItem(`${this.tokenKey}_backup`);if(t&&this.validateTokenFormat(t))return console.log("Restoring token from backup"),await Fs.set(t)}catch(t){console.warn("Failed to restore from backup",t)}return!1}validateTokenFormat(t){if(!t||typeof t!="string")return console.warn("Token validation failed: not a string"),!1;if(!t.includes("."))return console.warn("Token validation failed: not a JWT format"),!1;const r=t.split(".");if(r.length!==3)return console.warn("Token validation failed: not 3 parts"),!1;for(let n=0;n<r.length;n++)try{atob(r[n].replace(/-/g,"+").replace(/_/g,"/"))}catch{return console.warn(`Token validation failed: part ${n} is not valid base64`),!1}return!0}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){return this.setToken(t)?(this.setUserData({role:r}),localStorage.setItem("accessToken",t),!0):(console.error("Failed to set token - token validation failed"),!1)}async isAuthenticated(){const t=await this.getToken();if(!t)return!1;try{if(typeof t!="string"||!t.includes("."))return console.warn("Invalid token format - not a JWT"),this.clearAuth(),!1;const r=t.split(".");if(r.length!==3)return console.warn("Invalid token format - not 3 parts"),this.clearAuth(),!1;const n=JSON.parse(atob(r[1])),s=Date.now()/1e3;return n.exp>s}catch(r){return console.error("Error decoding token:",r),console.warn("Token appears to be corrupted - clearing authentication"),this.clearAuth(),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}async clearAuth(){try{await Fs.clear(),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey),localStorage.removeItem(`${this.tokenKey}_backup`)}catch(t){console.error("Failed to clear localStorage - possible corruption:",t),this.forceClearAllAuthData()}}forceClearAllAuthData(){["auth_token","accessToken","userRole","userData","refresh_token","auth_token_backup"].forEach(r=>{try{localStorage.removeItem(r)}catch(n){console.warn(`Failed to remove ${r}:`,n)}})}logout(){this.clearAuth(),window.location.href="/login"}async getAuthHeader(){const t=await this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=await this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401)if(await this.refreshToken()){const o=await this.getToken();return s.Authorization=`Bearer ${o}`,fetch(t,{...r,headers:s})}else throw this.logout(),new Error("Authentication failed");return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return await this.setToken(n.token),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}async getAccessToken(){return await this.getToken()}decodeToken(t){try{if(typeof t!="string"||!t.includes("."))return console.warn("Invalid token format - not a JWT"),this.clearAuth(),null;const r=t.split(".");return r.length!==3?(console.warn("Invalid token format - not 3 parts"),this.clearAuth(),null):JSON.parse(atob(r[1]))}catch(r){return console.error("Error decoding token:",r),console.warn("Token appears to be corrupted - clearing authentication"),this.clearAuth(),null}}async init(){return await this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{await this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}}const AV=new B3e;window.tokenManager=AV;if(typeof document<"u"){const e=async()=>{await AV.init()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()}class jV{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const t=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",t),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),t?(this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),t=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${t?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(t,r){console.log(`Function ${t} already available in main script for ${r}`),this.loadedFunctions.add(t)}setupRoleBasedUI(){let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),t=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!t&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(t){const r=`Access denied. This function requires ${t} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(t){return this.blockedFunctions.has(t)}isFunctionLoaded(t){return this.loadedFunctions.has(t)}getCurrentRole(){return this.currentRole}hasRole(t){return this.currentRole===t}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const t=window.tokenManager.getUserRole();return t?(console.log("[DEBUG] Setting role after login:",t),this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",t),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new jV;typeof h_<"u"&&h_.exports&&(h_.exports=jV);const $3e=()=>{const e={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(e))},U3e=()=>{$3e(),oK.createRoot(document.getElementById("root")).render(l.jsx(Is.StrictMode,{children:l.jsx(L3e,{})}))};U3e()});export default z3e();
