var _P=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Fte=_P((Ute,R1)=>{function mN(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var I1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Rv={exports:{}},bg={},Iv={exports:{}},Rr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pk;function bP(){if(pk)return Rr;pk=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function m(V){return V===null||typeof V!="object"?null:(V=p&&V[p]||V["@@iterator"],typeof V=="function"?V:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,w={};function S(V,H,X){this.props=V,this.context=H,this.refs=w,this.updater=X||y}S.prototype.isReactComponent={},S.prototype.setState=function(V,H){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,H,"setState")},S.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function E(){}E.prototype=S.prototype;function k(V,H,X){this.props=V,this.context=H,this.refs=w,this.updater=X||y}var _=k.prototype=new E;_.constructor=k,v(_,S.prototype),_.isPureReactComponent=!0;var N=Array.isArray,F=Object.prototype.hasOwnProperty,A={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function T(V,H,X){var se,ie={},ae=null,Q=null;if(H!=null)for(se in H.ref!==void 0&&(Q=H.ref),H.key!==void 0&&(ae=""+H.key),H)F.call(H,se)&&!R.hasOwnProperty(se)&&(ie[se]=H[se]);var le=arguments.length-2;if(le===1)ie.children=X;else if(1<le){for(var _e=Array(le),ke=0;ke<le;ke++)_e[ke]=arguments[ke+2];ie.children=_e}if(V&&V.defaultProps)for(se in le=V.defaultProps,le)ie[se]===void 0&&(ie[se]=le[se]);return{$$typeof:e,type:V,key:ae,ref:Q,props:ie,_owner:A.current}}function D(V,H){return{$$typeof:e,type:V.type,key:H,ref:V.ref,props:V.props,_owner:V._owner}}function L(V){return typeof V=="object"&&V!==null&&V.$$typeof===e}function O(V){var H={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(X){return H[X]})}var G=/\/+/g;function K(V,H){return typeof V=="object"&&V!==null&&V.key!=null?O(""+V.key):H.toString(36)}function te(V,H,X,se,ie){var ae=typeof V;(ae==="undefined"||ae==="boolean")&&(V=null);var Q=!1;if(V===null)Q=!0;else switch(ae){case"string":case"number":Q=!0;break;case"object":switch(V.$$typeof){case e:case t:Q=!0}}if(Q)return Q=V,ie=ie(Q),V=se===""?"."+K(Q,0):se,N(ie)?(X="",V!=null&&(X=V.replace(G,"$&/")+"/"),te(ie,H,X,"",function(ke){return ke})):ie!=null&&(L(ie)&&(ie=D(ie,X+(!ie.key||Q&&Q.key===ie.key?"":(""+ie.key).replace(G,"$&/")+"/")+V)),H.push(ie)),1;if(Q=0,se=se===""?".":se+":",N(V))for(var le=0;le<V.length;le++){ae=V[le];var _e=se+K(ae,le);Q+=te(ae,H,X,_e,ie)}else if(_e=m(V),typeof _e=="function")for(V=_e.call(V),le=0;!(ae=V.next()).done;)ae=ae.value,_e=se+K(ae,le++),Q+=te(ae,H,X,_e,ie);else if(ae==="object")throw H=String(V),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return Q}function Z(V,H,X){if(V==null)return V;var se=[],ie=0;return te(V,se,"","",function(ae){return H.call(X,ae,ie++)}),se}function J(V){if(V._status===-1){var H=V._result;H=H(),H.then(function(X){(V._status===0||V._status===-1)&&(V._status=1,V._result=X)},function(X){(V._status===0||V._status===-1)&&(V._status=2,V._result=X)}),V._status===-1&&(V._status=0,V._result=H)}if(V._status===1)return V._result.default;throw V._result}var I={current:null},W={transition:null},B={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:W,ReactCurrentOwner:A};function Y(){throw Error("act(...) is not supported in production builds of React.")}return Rr.Children={map:Z,forEach:function(V,H,X){Z(V,function(){H.apply(this,arguments)},X)},count:function(V){var H=0;return Z(V,function(){H++}),H},toArray:function(V){return Z(V,function(H){return H})||[]},only:function(V){if(!L(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},Rr.Component=S,Rr.Fragment=r,Rr.Profiler=s,Rr.PureComponent=k,Rr.StrictMode=n,Rr.Suspense=c,Rr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,Rr.act=Y,Rr.cloneElement=function(V,H,X){if(V==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+V+".");var se=v({},V.props),ie=V.key,ae=V.ref,Q=V._owner;if(H!=null){if(H.ref!==void 0&&(ae=H.ref,Q=A.current),H.key!==void 0&&(ie=""+H.key),V.type&&V.type.defaultProps)var le=V.type.defaultProps;for(_e in H)F.call(H,_e)&&!R.hasOwnProperty(_e)&&(se[_e]=H[_e]===void 0&&le!==void 0?le[_e]:H[_e])}var _e=arguments.length-2;if(_e===1)se.children=X;else if(1<_e){le=Array(_e);for(var ke=0;ke<_e;ke++)le[ke]=arguments[ke+2];se.children=le}return{$$typeof:e,type:V.type,key:ie,ref:ae,props:se,_owner:Q}},Rr.createContext=function(V){return V={$$typeof:i,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},V.Provider={$$typeof:a,_context:V},V.Consumer=V},Rr.createElement=T,Rr.createFactory=function(V){var H=T.bind(null,V);return H.type=V,H},Rr.createRef=function(){return{current:null}},Rr.forwardRef=function(V){return{$$typeof:o,render:V}},Rr.isValidElement=L,Rr.lazy=function(V){return{$$typeof:f,_payload:{_status:-1,_result:V},_init:J}},Rr.memo=function(V,H){return{$$typeof:d,type:V,compare:H===void 0?null:H}},Rr.startTransition=function(V){var H=W.transition;W.transition={};try{V()}finally{W.transition=H}},Rr.unstable_act=Y,Rr.useCallback=function(V,H){return I.current.useCallback(V,H)},Rr.useContext=function(V){return I.current.useContext(V)},Rr.useDebugValue=function(){},Rr.useDeferredValue=function(V){return I.current.useDeferredValue(V)},Rr.useEffect=function(V,H){return I.current.useEffect(V,H)},Rr.useId=function(){return I.current.useId()},Rr.useImperativeHandle=function(V,H,X){return I.current.useImperativeHandle(V,H,X)},Rr.useInsertionEffect=function(V,H){return I.current.useInsertionEffect(V,H)},Rr.useLayoutEffect=function(V,H){return I.current.useLayoutEffect(V,H)},Rr.useMemo=function(V,H){return I.current.useMemo(V,H)},Rr.useReducer=function(V,H,X){return I.current.useReducer(V,H,X)},Rr.useRef=function(V){return I.current.useRef(V)},Rr.useState=function(V){return I.current.useState(V)},Rr.useSyncExternalStore=function(V,H,X){return I.current.useSyncExternalStore(V,H,X)},Rr.useTransition=function(){return I.current.useTransition()},Rr.version="18.3.1",Rr}var xk;function _y(){return xk||(xk=1,Iv.exports=bP()),Iv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yk;function SP(){if(yk)return bg;yk=1;var e=_y(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(o,c,d){var f,p={},m=null,y=null;d!==void 0&&(m=""+d),c.key!==void 0&&(m=""+c.key),c.ref!==void 0&&(y=c.ref);for(f in c)n.call(c,f)&&!a.hasOwnProperty(f)&&(p[f]=c[f]);if(o&&o.defaultProps)for(f in c=o.defaultProps,c)p[f]===void 0&&(p[f]=c[f]);return{$$typeof:t,type:o,key:m,ref:y,props:p,_owner:s.current}}return bg.Fragment=r,bg.jsx=i,bg.jsxs=i,bg}var vk;function kP(){return vk||(vk=1,Rv.exports=SP()),Rv.exports}var l=kP(),C=_y();const Cs=wp(C),CP=mN({__proto__:null,default:Cs},[C]);var Yx={},Mv={exports:{}},gi={},Lv={exports:{}},Ov={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wk;function TP(){return wk||(wk=1,(function(e){function t(W,B){var Y=W.length;W.push(B);e:for(;0<Y;){var V=Y-1>>>1,H=W[V];if(0<s(H,B))W[V]=B,W[Y]=H,Y=V;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var B=W[0],Y=W.pop();if(Y!==B){W[0]=Y;e:for(var V=0,H=W.length,X=H>>>1;V<X;){var se=2*(V+1)-1,ie=W[se],ae=se+1,Q=W[ae];if(0>s(ie,Y))ae<H&&0>s(Q,ie)?(W[V]=Q,W[ae]=Y,V=ae):(W[V]=ie,W[se]=Y,V=se);else if(ae<H&&0>s(Q,Y))W[V]=Q,W[ae]=Y,V=ae;else break e}}return B}function s(W,B){var Y=W.sortIndex-B.sortIndex;return Y!==0?Y:W.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],d=[],f=1,p=null,m=3,y=!1,v=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(W){for(var B=r(d);B!==null;){if(B.callback===null)n(d);else if(B.startTime<=W)n(d),B.sortIndex=B.expirationTime,t(c,B);else break;B=r(d)}}function N(W){if(w=!1,_(W),!v)if(r(c)!==null)v=!0,J(F);else{var B=r(d);B!==null&&I(N,B.startTime-W)}}function F(W,B){v=!1,w&&(w=!1,E(T),T=-1),y=!0;var Y=m;try{for(_(B),p=r(c);p!==null&&(!(p.expirationTime>B)||W&&!O());){var V=p.callback;if(typeof V=="function"){p.callback=null,m=p.priorityLevel;var H=V(p.expirationTime<=B);B=e.unstable_now(),typeof H=="function"?p.callback=H:p===r(c)&&n(c),_(B)}else n(c);p=r(c)}if(p!==null)var X=!0;else{var se=r(d);se!==null&&I(N,se.startTime-B),X=!1}return X}finally{p=null,m=Y,y=!1}}var A=!1,R=null,T=-1,D=5,L=-1;function O(){return!(e.unstable_now()-L<D)}function G(){if(R!==null){var W=e.unstable_now();L=W;var B=!0;try{B=R(!0,W)}finally{B?K():(A=!1,R=null)}}else A=!1}var K;if(typeof k=="function")K=function(){k(G)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,Z=te.port2;te.port1.onmessage=G,K=function(){Z.postMessage(null)}}else K=function(){S(G,0)};function J(W){R=W,A||(A=!0,K())}function I(W,B){T=S(function(){W(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){v||y||(v=!0,J(F))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(W){switch(m){case 1:case 2:case 3:var B=3;break;default:B=m}var Y=m;m=B;try{return W()}finally{m=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,B){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Y=m;m=W;try{return B()}finally{m=Y}},e.unstable_scheduleCallback=function(W,B,Y){var V=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?V+Y:V):Y=V,W){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=Y+H,W={id:f++,callback:B,priorityLevel:W,startTime:Y,expirationTime:H,sortIndex:-1},Y>V?(W.sortIndex=Y,t(d,W),r(c)===null&&W===r(d)&&(w?(E(T),T=-1):w=!0,I(N,Y-V))):(W.sortIndex=H,t(c,W),v||y||(v=!0,J(F))),W},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(W){var B=m;return function(){var Y=m;m=B;try{return W.apply(this,arguments)}finally{m=Y}}}})(Ov)),Ov}var _k;function g2(){return _k||(_k=1,Lv.exports=TP()),Lv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bk;function EP(){if(bk)return gi;bk=1;var e=_y(),t=g2();function r(u){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+u,b=1;b<arguments.length;b++)h+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(u,h){i(u,h),i(u+"Capture",h)}function i(u,h){for(s[u]=h,u=0;u<h.length;u++)n.add(h[u])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(u){return c.call(p,u)?!0:c.call(f,u)?!1:d.test(u)?p[u]=!0:(f[u]=!0,!1)}function y(u,h,b,P){if(b!==null&&b.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return P?!1:b!==null?!b.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function v(u,h,b,P){if(h===null||typeof h>"u"||y(u,h,b,P))return!0;if(P)return!1;if(b!==null)switch(b.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function w(u,h,b,P,U,q,ue){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=P,this.attributeNamespace=U,this.mustUseProperty=b,this.propertyName=u,this.type=h,this.sanitizeURL=q,this.removeEmptyString=ue}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){S[u]=new w(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var h=u[0];S[h]=new w(h,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){S[u]=new w(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){S[u]=new w(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){S[u]=new w(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){S[u]=new w(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){S[u]=new w(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){S[u]=new w(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){S[u]=new w(u,5,!1,u.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function k(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var h=u.replace(E,k);S[h]=new w(h,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var h=u.replace(E,k);S[h]=new w(h,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var h=u.replace(E,k);S[h]=new w(h,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){S[u]=new w(u,1,!1,u.toLowerCase(),null,!1,!1)}),S.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){S[u]=new w(u,1,!1,u.toLowerCase(),null,!0,!0)});function _(u,h,b,P){var U=S.hasOwnProperty(h)?S[h]:null;(U!==null?U.type!==0:P||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(v(h,b,U,P)&&(b=null),P||U===null?m(h)&&(b===null?u.removeAttribute(h):u.setAttribute(h,""+b)):U.mustUseProperty?u[U.propertyName]=b===null?U.type===3?!1:"":b:(h=U.attributeName,P=U.attributeNamespace,b===null?u.removeAttribute(h):(U=U.type,b=U===3||U===4&&b===!0?"":""+b,P?u.setAttributeNS(P,h,b):u.setAttribute(h,b))))}var N=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),A=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),O=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),I=Symbol.for("react.offscreen"),W=Symbol.iterator;function B(u){return u===null||typeof u!="object"?null:(u=W&&u[W]||u["@@iterator"],typeof u=="function"?u:null)}var Y=Object.assign,V;function H(u){if(V===void 0)try{throw Error()}catch(b){var h=b.stack.trim().match(/\n( *(at )?)/);V=h&&h[1]||""}return`
`+V+u}var X=!1;function se(u,h){if(!u||X)return"";X=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(rt){var P=rt}Reflect.construct(u,[],h)}else{try{h.call()}catch(rt){P=rt}u.call(h.prototype)}else{try{throw Error()}catch(rt){P=rt}u()}}catch(rt){if(rt&&P&&typeof rt.stack=="string"){for(var U=rt.stack.split(`
`),q=P.stack.split(`
`),ue=U.length-1,Ee=q.length-1;1<=ue&&0<=Ee&&U[ue]!==q[Ee];)Ee--;for(;1<=ue&&0<=Ee;ue--,Ee--)if(U[ue]!==q[Ee]){if(ue!==1||Ee!==1)do if(ue--,Ee--,0>Ee||U[ue]!==q[Ee]){var Ie=`
`+U[ue].replace(" at new "," at ");return u.displayName&&Ie.includes("<anonymous>")&&(Ie=Ie.replace("<anonymous>",u.displayName)),Ie}while(1<=ue&&0<=Ee);break}}}finally{X=!1,Error.prepareStackTrace=b}return(u=u?u.displayName||u.name:"")?H(u):""}function ie(u){switch(u.tag){case 5:return H(u.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return u=se(u.type,!1),u;case 11:return u=se(u.type.render,!1),u;case 1:return u=se(u.type,!0),u;default:return""}}function ae(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case R:return"Fragment";case A:return"Portal";case D:return"Profiler";case T:return"StrictMode";case K:return"Suspense";case te:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case O:return(u.displayName||"Context")+".Consumer";case L:return(u._context.displayName||"Context")+".Provider";case G:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case Z:return h=u.displayName||null,h!==null?h:ae(u.type)||"Memo";case J:h=u._payload,u=u._init;try{return ae(u(h))}catch{}}return null}function Q(u){var h=u.type;switch(u.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=h.render,u=u.displayName||u.name||"",h.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ae(h);case 8:return h===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function le(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function _e(u){var h=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function ke(u){var h=_e(u)?"checked":"value",b=Object.getOwnPropertyDescriptor(u.constructor.prototype,h),P=""+u[h];if(!u.hasOwnProperty(h)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var U=b.get,q=b.set;return Object.defineProperty(u,h,{configurable:!0,get:function(){return U.call(this)},set:function(ue){P=""+ue,q.call(this,ue)}}),Object.defineProperty(u,h,{enumerable:b.enumerable}),{getValue:function(){return P},setValue:function(ue){P=""+ue},stopTracking:function(){u._valueTracker=null,delete u[h]}}}}function Oe(u){u._valueTracker||(u._valueTracker=ke(u))}function ge(u){if(!u)return!1;var h=u._valueTracker;if(!h)return!0;var b=h.getValue(),P="";return u&&(P=_e(u)?u.checked?"true":"false":u.value),u=P,u!==b?(h.setValue(u),!0):!1}function ye(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Ke(u,h){var b=h.checked;return Y({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??u._wrapperState.initialChecked})}function Xe(u,h){var b=h.defaultValue==null?"":h.defaultValue,P=h.checked!=null?h.checked:h.defaultChecked;b=le(h.value!=null?h.value:b),u._wrapperState={initialChecked:P,initialValue:b,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function lt(u,h){h=h.checked,h!=null&&_(u,"checked",h,!1)}function Ye(u,h){lt(u,h);var b=le(h.value),P=h.type;if(b!=null)P==="number"?(b===0&&u.value===""||u.value!=b)&&(u.value=""+b):u.value!==""+b&&(u.value=""+b);else if(P==="submit"||P==="reset"){u.removeAttribute("value");return}h.hasOwnProperty("value")?Me(u,h.type,b):h.hasOwnProperty("defaultValue")&&Me(u,h.type,le(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(u.defaultChecked=!!h.defaultChecked)}function We(u,h,b){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var P=h.type;if(!(P!=="submit"&&P!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+u._wrapperState.initialValue,b||h===u.value||(u.value=h),u.defaultValue=h}b=u.name,b!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,b!==""&&(u.name=b)}function Me(u,h,b){(h!=="number"||ye(u.ownerDocument)!==u)&&(b==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+b&&(u.defaultValue=""+b))}var je=Array.isArray;function De(u,h,b,P){if(u=u.options,h){h={};for(var U=0;U<b.length;U++)h["$"+b[U]]=!0;for(b=0;b<u.length;b++)U=h.hasOwnProperty("$"+u[b].value),u[b].selected!==U&&(u[b].selected=U),U&&P&&(u[b].defaultSelected=!0)}else{for(b=""+le(b),h=null,U=0;U<u.length;U++){if(u[U].value===b){u[U].selected=!0,P&&(u[U].defaultSelected=!0);return}h!==null||u[U].disabled||(h=u[U])}h!==null&&(h.selected=!0)}}function Ge(u,h){if(h.dangerouslySetInnerHTML!=null)throw Error(r(91));return Y({},h,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function ct(u,h){var b=h.value;if(b==null){if(b=h.children,h=h.defaultValue,b!=null){if(h!=null)throw Error(r(92));if(je(b)){if(1<b.length)throw Error(r(93));b=b[0]}h=b}h==null&&(h=""),b=h}u._wrapperState={initialValue:le(b)}}function at(u,h){var b=le(h.value),P=le(h.defaultValue);b!=null&&(b=""+b,b!==u.value&&(u.value=b),h.defaultValue==null&&u.defaultValue!==b&&(u.defaultValue=b)),P!=null&&(u.defaultValue=""+P)}function wt(u){var h=u.textContent;h===u._wrapperState.initialValue&&h!==""&&h!==null&&(u.value=h)}function Ft(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kt(u,h){return u==null||u==="http://www.w3.org/1999/xhtml"?Ft(h):u==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var bt,At=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,b,P,U){MSApp.execUnsafeLocalFunction(function(){return u(h,b,P,U)})}:u})(function(u,h){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=h;else{for(bt=bt||document.createElement("div"),bt.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=bt.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;h.firstChild;)u.appendChild(h.firstChild)}});function gt(u,h){if(h){var b=u.firstChild;if(b&&b===u.lastChild&&b.nodeType===3){b.nodeValue=h;return}}u.textContent=h}var kt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gt=["Webkit","ms","Moz","O"];Object.keys(kt).forEach(function(u){Gt.forEach(function(h){h=h+u.charAt(0).toUpperCase()+u.substring(1),kt[h]=kt[u]})});function $t(u,h,b){return h==null||typeof h=="boolean"||h===""?"":b||typeof h!="number"||h===0||kt.hasOwnProperty(u)&&kt[u]?(""+h).trim():h+"px"}function Be(u,h){u=u.style;for(var b in h)if(h.hasOwnProperty(b)){var P=b.indexOf("--")===0,U=$t(b,h[b],P);b==="float"&&(b="cssFloat"),P?u.setProperty(b,U):u[b]=U}}var it=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ut(u,h){if(h){if(it[u]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(r(137,u));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(r(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(r(61))}if(h.style!=null&&typeof h.style!="object")throw Error(r(62))}}function St(u,h){if(u.indexOf("-")===-1)return typeof h.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mt=null;function Ot(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Te=null,ve=null,Ne=null;function Fe(u){if(u=ud(u)){if(typeof Te!="function")throw Error(r(280));var h=u.stateNode;h&&(h=ys(h),Te(u.stateNode,u.type,h))}}function dt(u){ve?Ne?Ne.push(u):Ne=[u]:ve=u}function Wt(){if(ve){var u=ve,h=Ne;if(Ne=ve=null,Fe(u),h)for(u=0;u<h.length;u++)Fe(h[u])}}function Et(u,h){return u(h)}function nr(){}var Qt=!1;function Zt(u,h,b){if(Qt)return u(h,b);Qt=!0;try{return Et(u,h,b)}finally{Qt=!1,(ve!==null||Ne!==null)&&(nr(),Wt())}}function Nr(u,h){var b=u.stateNode;if(b===null)return null;var P=ys(b);if(P===null)return null;b=P[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(P=!P.disabled)||(u=u.type,P=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!P;break e;default:u=!1}if(u)return null;if(b&&typeof b!="function")throw Error(r(231,h,typeof b));return b}var Mr=!1;if(o)try{var cr={};Object.defineProperty(cr,"passive",{get:function(){Mr=!0}}),window.addEventListener("test",cr,cr),window.removeEventListener("test",cr,cr)}catch{Mr=!1}function Fr(u,h,b,P,U,q,ue,Ee,Ie){var rt=Array.prototype.slice.call(arguments,3);try{h.apply(b,rt)}catch(_t){this.onError(_t)}}var Pr=!1,Cn=null,ce=!1,be=null,pe={onError:function(u){Pr=!0,Cn=u}};function we(u,h,b,P,U,q,ue,Ee,Ie){Pr=!1,Cn=null,Fr.apply(pe,arguments)}function Ce(u,h,b,P,U,q,ue,Ee,Ie){if(we.apply(this,arguments),Pr){if(Pr){var rt=Cn;Pr=!1,Cn=null}else throw Error(r(198));ce||(ce=!0,be=rt)}}function oe(u){var h=u,b=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(b=h.return),u=h.return;while(u)}return h.tag===3?b:null}function me(u){if(u.tag===13){var h=u.memoizedState;if(h===null&&(u=u.alternate,u!==null&&(h=u.memoizedState)),h!==null)return h.dehydrated}return null}function re(u){if(oe(u)!==u)throw Error(r(188))}function ne(u){var h=u.alternate;if(!h){if(h=oe(u),h===null)throw Error(r(188));return h!==u?null:u}for(var b=u,P=h;;){var U=b.return;if(U===null)break;var q=U.alternate;if(q===null){if(P=U.return,P!==null){b=P;continue}break}if(U.child===q.child){for(q=U.child;q;){if(q===b)return re(U),u;if(q===P)return re(U),h;q=q.sibling}throw Error(r(188))}if(b.return!==P.return)b=U,P=q;else{for(var ue=!1,Ee=U.child;Ee;){if(Ee===b){ue=!0,b=U,P=q;break}if(Ee===P){ue=!0,P=U,b=q;break}Ee=Ee.sibling}if(!ue){for(Ee=q.child;Ee;){if(Ee===b){ue=!0,b=q,P=U;break}if(Ee===P){ue=!0,P=q,b=U;break}Ee=Ee.sibling}if(!ue)throw Error(r(189))}}if(b.alternate!==P)throw Error(r(190))}if(b.tag!==3)throw Error(r(188));return b.stateNode.current===b?u:h}function fe(u){return u=ne(u),u!==null?de(u):null}function de(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var h=de(u);if(h!==null)return h;u=u.sibling}return null}var Pe=t.unstable_scheduleCallback,Ve=t.unstable_cancelCallback,Ae=t.unstable_shouldYield,Ue=t.unstable_requestPaint,ze=t.unstable_now,pt=t.unstable_getCurrentPriorityLevel,Bt=t.unstable_ImmediatePriority,sr=t.unstable_UserBlockingPriority,rr=t.unstable_NormalPriority,Gr=t.unstable_LowPriority,Lr=t.unstable_IdlePriority,yr=null,Tr=null;function Ur(u){if(Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(yr,u,void 0,(u.current.flags&128)===128)}catch{}}var he=Math.clz32?Math.clz32:st,Se=Math.log,Ze=Math.LN2;function st(u){return u>>>=0,u===0?32:31-(Se(u)/Ze|0)|0}var zt=64,Er=4194304;function vr(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function va(u,h){var b=u.pendingLanes;if(b===0)return 0;var P=0,U=u.suspendedLanes,q=u.pingedLanes,ue=b&268435455;if(ue!==0){var Ee=ue&~U;Ee!==0?P=vr(Ee):(q&=ue,q!==0&&(P=vr(q)))}else ue=b&~U,ue!==0?P=vr(ue):q!==0&&(P=vr(q));if(P===0)return 0;if(h!==0&&h!==P&&(h&U)===0&&(U=P&-P,q=h&-h,U>=q||U===16&&(q&4194240)!==0))return h;if((P&4)!==0&&(P|=b&16),h=u.entangledLanes,h!==0)for(u=u.entanglements,h&=P;0<h;)b=31-he(h),U=1<<b,P|=u[b],h&=~U;return P}function Ui(u,h){switch(u){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fl(u,h){for(var b=u.suspendedLanes,P=u.pingedLanes,U=u.expirationTimes,q=u.pendingLanes;0<q;){var ue=31-he(q),Ee=1<<ue,Ie=U[ue];Ie===-1?((Ee&b)===0||(Ee&P)!==0)&&(U[ue]=Ui(Ee,h)):Ie<=h&&(u.expiredLanes|=Ee),q&=~Ee}}function Bs(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function Dn(){var u=zt;return zt<<=1,(zt&4194240)===0&&(zt=64),u}function Us(u){for(var h=[],b=0;31>b;b++)h.push(u);return h}function Pl(u,h,b){u.pendingLanes|=h,h!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,h=31-he(h),u[h]=b}function nv(u,h){var b=u.pendingLanes&~h;u.pendingLanes=h,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=h,u.mutableReadLanes&=h,u.entangledLanes&=h,h=u.entanglements;var P=u.eventTimes;for(u=u.expirationTimes;0<b;){var U=31-he(b),q=1<<U;h[U]=0,P[U]=-1,u[U]=-1,b&=~q}}function P0(u,h){var b=u.entangledLanes|=h;for(u=u.entanglements;b;){var P=31-he(b),U=1<<P;U&h|u[P]&h&&(u[P]|=h),b&=~U}}var zr=0;function Xu(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Fc,Pc,Yp,Jp,Cf,Tf=!1,Dc=[],ii=null,Vo=null,$i=null,Dr=new Map,Rc=new Map,Wi=[],Qp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zp(u,h){switch(u){case"focusin":case"focusout":ii=null;break;case"dragenter":case"dragleave":Vo=null;break;case"mouseover":case"mouseout":$i=null;break;case"pointerover":case"pointerout":Dr.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rc.delete(h.pointerId)}}function Yu(u,h,b,P,U,q){return u===null||u.nativeEvent!==q?(u={blockedOn:h,domEventName:b,eventSystemFlags:P,nativeEvent:q,targetContainers:[U]},h!==null&&(h=ud(h),h!==null&&Pc(h)),u):(u.eventSystemFlags|=P,h=u.targetContainers,U!==null&&h.indexOf(U)===-1&&h.push(U),u)}function ps(u,h,b,P,U){switch(h){case"focusin":return ii=Yu(ii,u,h,b,P,U),!0;case"dragenter":return Vo=Yu(Vo,u,h,b,P,U),!0;case"mouseover":return $i=Yu($i,u,h,b,P,U),!0;case"pointerover":var q=U.pointerId;return Dr.set(q,Yu(Dr.get(q)||null,u,h,b,P,U)),!0;case"gotpointercapture":return q=U.pointerId,Rc.set(q,Yu(Rc.get(q)||null,u,h,b,P,U)),!0}return!1}function Ef(u){var h=rl(u.target);if(h!==null){var b=oe(h);if(b!==null){if(h=b.tag,h===13){if(h=me(b),h!==null){u.blockedOn=h,Cf(u.priority,function(){Yp(b)});return}}else if(h===3&&b.stateNode.current.memoizedState.isDehydrated){u.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Nf(u){if(u.blockedOn!==null)return!1;for(var h=u.targetContainers;0<h.length;){var b=Ff(u.domEventName,u.eventSystemFlags,h[0],u.nativeEvent);if(b===null){b=u.nativeEvent;var P=new b.constructor(b.type,b);Mt=P,b.target.dispatchEvent(P),Mt=null}else return h=ud(b),h!==null&&Pc(h),u.blockedOn=b,!1;h.shift()}return!0}function Af(u,h,b){Nf(u)&&b.delete(h)}function sv(){Tf=!1,ii!==null&&Nf(ii)&&(ii=null),Vo!==null&&Nf(Vo)&&(Vo=null),$i!==null&&Nf($i)&&($i=null),Dr.forEach(Af),Rc.forEach(Af)}function Ko(u,h){u.blockedOn===h&&(u.blockedOn=null,Tf||(Tf=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,sv)))}function wa(u){function h(U){return Ko(U,u)}if(0<Dc.length){Ko(Dc[0],u);for(var b=1;b<Dc.length;b++){var P=Dc[b];P.blockedOn===u&&(P.blockedOn=null)}}for(ii!==null&&Ko(ii,u),Vo!==null&&Ko(Vo,u),$i!==null&&Ko($i,u),Dr.forEach(h),Rc.forEach(h),b=0;b<Wi.length;b++)P=Wi[b],P.blockedOn===u&&(P.blockedOn=null);for(;0<Wi.length&&(b=Wi[0],b.blockedOn===null);)Ef(b),b.blockedOn===null&&Wi.shift()}var Ic=N.ReactCurrentBatchConfig,jf=!0;function ki(u,h,b,P){var U=zr,q=Ic.transition;Ic.transition=null;try{zr=1,Mc(u,h,b,P)}finally{zr=U,Ic.transition=q}}function yo(u,h,b,P){var U=zr,q=Ic.transition;Ic.transition=null;try{zr=4,Mc(u,h,b,P)}finally{zr=U,Ic.transition=q}}function Mc(u,h,b,P){if(jf){var U=Ff(u,h,b,P);if(U===null)Kf(u,h,P,Lc,b),Zp(u,P);else if(ps(U,u,h,b,P))P.stopPropagation();else if(Zp(u,P),h&4&&-1<Qp.indexOf(u)){for(;U!==null;){var q=ud(U);if(q!==null&&Fc(q),q=Ff(u,h,b,P),q===null&&Kf(u,h,P,Lc,b),q===U)break;U=q}U!==null&&P.stopPropagation()}else Kf(u,h,P,null,b)}}var Lc=null;function Ff(u,h,b,P){if(Lc=null,u=Ot(P),u=rl(u),u!==null)if(h=oe(u),h===null)u=null;else if(b=h.tag,b===13){if(u=me(h),u!==null)return u;u=null}else if(b===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;u=null}else h!==u&&(u=null);return Lc=u,null}function ex(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pt()){case Bt:return 1;case sr:return 4;case rr:case Gr:return 16;case Lr:return 536870912;default:return 16}default:return 16}}var Ns=null,qo=null,vo=null;function Ju(){if(vo)return vo;var u,h=qo,b=h.length,P,U="value"in Ns?Ns.value:Ns.textContent,q=U.length;for(u=0;u<b&&h[u]===U[u];u++);var ue=b-u;for(P=1;P<=ue&&h[b-P]===U[q-P];P++);return vo=U.slice(u,1<P?1-P:void 0)}function Dl(u){var h=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&h===13&&(u=13)):u=h,u===10&&(u=13),32<=u||u===13?u:0}function ta(){return!0}function Ua(){return!1}function ns(u){function h(b,P,U,q,ue){this._reactName=b,this._targetInst=U,this.type=P,this.nativeEvent=q,this.target=ue,this.currentTarget=null;for(var Ee in u)u.hasOwnProperty(Ee)&&(b=u[Ee],this[Ee]=b?b(q):q[Ee]);return this.isDefaultPrevented=(q.defaultPrevented!=null?q.defaultPrevented:q.returnValue===!1)?ta:Ua,this.isPropagationStopped=Ua,this}return Y(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=ta)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=ta)},persist:function(){},isPersistent:ta}),h}var _a={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ci=ns(_a),Ti=Y({},_a,{view:0,detail:0}),tx=ns(Ti),Qu,Zu,As,ra=Y({},Ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Il,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==As&&(As&&u.type==="mousemove"?(Qu=u.screenX-As.screenX,Zu=u.screenY-As.screenY):Zu=Qu=0,As=u),Qu)},movementY:function(u){return"movementY"in u?u.movementY:Zu}}),xn=ns(ra),ed=Y({},ra,{dataTransfer:0}),Ei=ns(ed),rx=Y({},Ti,{relatedTarget:0}),Pf=ns(rx),D0=Y({},_a,{animationName:0,elapsedTime:0,pseudoElement:0}),R0=ns(D0),nx=Y({},_a,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),Df=ns(nx),sx=Y({},_a,{data:0}),Rl=ns(sx),I0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},av={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iv(u){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(u):(u=Rf[u])?!!h[u]:!1}function Il(){return iv}var If=Y({},Ti,{key:function(u){if(u.key){var h=I0[u.key]||u.key;if(h!=="Unidentified")return h}return u.type==="keypress"?(u=Dl(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?av[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Il,charCode:function(u){return u.type==="keypress"?Dl(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Dl(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),ax=ns(If),ix=Y({},ra,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ml=ns(ix),ox=Y({},Ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Il}),Mf=ns(ox),Lf=Y({},_a,{propertyName:0,elapsedTime:0,pseudoElement:0}),Oc=ns(Lf),M0=Y({},ra,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),L0=ns(M0),lx=[9,13,27,32],td=o&&"CompositionEvent"in window,Ll=null;o&&"documentMode"in document&&(Ll=document.documentMode);var Bc=o&&"TextEvent"in window&&!Ll,$a=o&&(!td||Ll&&8<Ll&&11>=Ll),Xo=" ",Of=!1;function O0(u,h){switch(u){case"keyup":return lx.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ni(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Wa=!1;function B0(u,h){switch(u){case"compositionend":return Ni(h);case"keypress":return h.which!==32?null:(Of=!0,Xo);case"textInput":return u=h.data,u===Xo&&Of?null:u;default:return null}}function cx(u,h){if(Wa)return u==="compositionend"||!td&&O0(u,h)?(u=Ju(),vo=qo=Ns=null,Wa=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return $a&&h.locale!=="ko"?null:h.data;default:return null}}var wo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _o(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h==="input"?!!wo[u.type]:h==="textarea"}function rd(u,h,b,P){dt(P),h=qf(h,"onChange"),0<h.length&&(b=new Ci("onChange","change",null,b,P),u.push({event:b,listeners:h}))}var Uc=null,Yo=null;function ux(u){Y0(u,0)}function Jo(u){var h=as(u);if(ge(h))return u}function oi(u,h){if(u==="change")return h}var $c=!1;if(o){var Qo;if(o){var li="oninput"in document;if(!li){var Bf=document.createElement("div");Bf.setAttribute("oninput","return;"),li=typeof Bf.oninput=="function"}Qo=li}else Qo=!1;$c=Qo&&(!document.documentMode||9<document.documentMode)}function Ol(){Uc&&(Uc.detachEvent("onpropertychange",U0),Yo=Uc=null)}function U0(u){if(u.propertyName==="value"&&Jo(Yo)){var h=[];rd(h,Yo,u,Ot(u)),Zt(ux,h)}}function $0(u,h,b){u==="focusin"?(Ol(),Uc=h,Yo=b,Uc.attachEvent("onpropertychange",U0)):u==="focusout"&&Ol()}function Tn(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Jo(Yo)}function Uf(u,h){if(u==="click")return Jo(h)}function W0(u,h){if(u==="input"||u==="change")return Jo(h)}function z0(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var ba=typeof Object.is=="function"?Object.is:z0;function Bl(u,h){if(ba(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var b=Object.keys(u),P=Object.keys(h);if(b.length!==P.length)return!1;for(P=0;P<b.length;P++){var U=b[P];if(!c.call(h,U)||!ba(u[U],h[U]))return!1}return!0}function Zo(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function wn(u,h){var b=Zo(u);u=0;for(var P;b;){if(b.nodeType===3){if(P=u+b.textContent.length,u<=h&&P>=h)return{node:b,offset:h-u};u=P}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=Zo(b)}}function Vn(u,h){return u&&h?u===h?!0:u&&u.nodeType===3?!1:h&&h.nodeType===3?Vn(u,h.parentNode):"contains"in u?u.contains(h):u.compareDocumentPosition?!!(u.compareDocumentPosition(h)&16):!1:!1}function ss(){for(var u=window,h=ye();h instanceof u.HTMLIFrameElement;){try{var b=typeof h.contentWindow.location.href=="string"}catch{b=!1}if(b)u=h.contentWindow;else break;h=ye(u.document)}return h}function Wc(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h&&(h==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||h==="textarea"||u.contentEditable==="true")}function nd(u){var h=ss(),b=u.focusedElem,P=u.selectionRange;if(h!==b&&b&&b.ownerDocument&&Vn(b.ownerDocument.documentElement,b)){if(P!==null&&Wc(b)){if(h=P.start,u=P.end,u===void 0&&(u=h),"selectionStart"in b)b.selectionStart=h,b.selectionEnd=Math.min(u,b.value.length);else if(u=(h=b.ownerDocument||document)&&h.defaultView||window,u.getSelection){u=u.getSelection();var U=b.textContent.length,q=Math.min(P.start,U);P=P.end===void 0?q:Math.min(P.end,U),!u.extend&&q>P&&(U=P,P=q,q=U),U=wn(b,q);var ue=wn(b,P);U&&ue&&(u.rangeCount!==1||u.anchorNode!==U.node||u.anchorOffset!==U.offset||u.focusNode!==ue.node||u.focusOffset!==ue.offset)&&(h=h.createRange(),h.setStart(U.node,U.offset),u.removeAllRanges(),q>P?(u.addRange(h),u.extend(ue.node,ue.offset)):(h.setEnd(ue.node,ue.offset),u.addRange(h)))}}for(h=[],u=b;u=u.parentNode;)u.nodeType===1&&h.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<h.length;b++)u=h[b],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var sd=o&&"documentMode"in document&&11>=document.documentMode,zc=null,xs=null,Ul=null,ad=!1;function $f(u,h,b){var P=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;ad||zc==null||zc!==ye(P)||(P=zc,"selectionStart"in P&&Wc(P)?P={start:P.selectionStart,end:P.selectionEnd}:(P=(P.ownerDocument&&P.ownerDocument.defaultView||window).getSelection(),P={anchorNode:P.anchorNode,anchorOffset:P.anchorOffset,focusNode:P.focusNode,focusOffset:P.focusOffset}),Ul&&Bl(Ul,P)||(Ul=P,P=qf(xs,"onSelect"),0<P.length&&(h=new Ci("onSelect","select",null,h,b),u.push({event:h,listeners:P}),h.target=zc)))}function za(u,h){var b={};return b[u.toLowerCase()]=h.toLowerCase(),b["Webkit"+u]="webkit"+h,b["Moz"+u]="moz"+h,b}var js={animationend:za("Animation","AnimationEnd"),animationiteration:za("Animation","AnimationIteration"),animationstart:za("Animation","AnimationStart"),transitionend:za("Transition","TransitionEnd")},$l={},Wf={};o&&(Wf=document.createElement("div").style,"AnimationEvent"in window||(delete js.animationend.animation,delete js.animationiteration.animation,delete js.animationstart.animation),"TransitionEvent"in window||delete js.transitionend.transition);function Hc(u){if($l[u])return $l[u];if(!js[u])return u;var h=js[u],b;for(b in h)if(h.hasOwnProperty(b)&&b in Wf)return $l[u]=h[b];return u}var H0=Hc("animationend"),G0=Hc("animationiteration"),V0=Hc("animationstart"),K0=Hc("transitionend"),q0=new Map,X0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bo(u,h){q0.set(u,h),a(h,[u])}for(var zf=0;zf<X0.length;zf++){var Wl=X0[zf],dx=Wl.toLowerCase(),Hf=Wl[0].toUpperCase()+Wl.slice(1);bo(dx,"on"+Hf)}bo(H0,"onAnimationEnd"),bo(G0,"onAnimationIteration"),bo(V0,"onAnimationStart"),bo("dblclick","onDoubleClick"),bo("focusin","onFocus"),bo("focusout","onBlur"),bo(K0,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var el="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fx=new Set("cancel close invalid load scroll toggle".split(" ").concat(el));function Gf(u,h,b){var P=u.type||"unknown-event";u.currentTarget=b,Ce(P,h,void 0,u),u.currentTarget=null}function Y0(u,h){h=(h&4)!==0;for(var b=0;b<u.length;b++){var P=u[b],U=P.event;P=P.listeners;e:{var q=void 0;if(h)for(var ue=P.length-1;0<=ue;ue--){var Ee=P[ue],Ie=Ee.instance,rt=Ee.currentTarget;if(Ee=Ee.listener,Ie!==q&&U.isPropagationStopped())break e;Gf(U,Ee,rt),q=Ie}else for(ue=0;ue<P.length;ue++){if(Ee=P[ue],Ie=Ee.instance,rt=Ee.currentTarget,Ee=Ee.listener,Ie!==q&&U.isPropagationStopped())break e;Gf(U,Ee,rt),q=Ie}}}if(ce)throw u=be,ce=!1,be=null,u}function dn(u,h){var b=h[Yf];b===void 0&&(b=h[Yf]=new Set);var P=u+"__bubble";b.has(P)||(J0(h,u,2,!1),b.add(P))}function Vf(u,h,b){var P=0;h&&(P|=4),J0(b,u,P,h)}var id="_reactListening"+Math.random().toString(36).slice(2);function zl(u){if(!u[id]){u[id]=!0,n.forEach(function(b){b!=="selectionchange"&&(fx.has(b)||Vf(b,!1,u),Vf(b,!0,u))});var h=u.nodeType===9?u:u.ownerDocument;h===null||h[id]||(h[id]=!0,Vf("selectionchange",!1,h))}}function J0(u,h,b,P){switch(ex(h)){case 1:var U=ki;break;case 4:U=yo;break;default:U=Mc}b=U.bind(null,h,b,u),U=void 0,!Mr||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(U=!0),P?U!==void 0?u.addEventListener(h,b,{capture:!0,passive:U}):u.addEventListener(h,b,!0):U!==void 0?u.addEventListener(h,b,{passive:U}):u.addEventListener(h,b,!1)}function Kf(u,h,b,P,U){var q=P;if((h&1)===0&&(h&2)===0&&P!==null)e:for(;;){if(P===null)return;var ue=P.tag;if(ue===3||ue===4){var Ee=P.stateNode.containerInfo;if(Ee===U||Ee.nodeType===8&&Ee.parentNode===U)break;if(ue===4)for(ue=P.return;ue!==null;){var Ie=ue.tag;if((Ie===3||Ie===4)&&(Ie=ue.stateNode.containerInfo,Ie===U||Ie.nodeType===8&&Ie.parentNode===U))return;ue=ue.return}for(;Ee!==null;){if(ue=rl(Ee),ue===null)return;if(Ie=ue.tag,Ie===5||Ie===6){P=q=ue;continue e}Ee=Ee.parentNode}}P=P.return}Zt(function(){var rt=q,_t=Ot(b),Tt=[];e:{var vt=q0.get(u);if(vt!==void 0){var Vt=Ci,Jt=u;switch(u){case"keypress":if(Dl(b)===0)break e;case"keydown":case"keyup":Vt=ax;break;case"focusin":Jt="focus",Vt=Pf;break;case"focusout":Jt="blur",Vt=Pf;break;case"beforeblur":case"afterblur":Vt=Pf;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Vt=xn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Vt=Ei;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Vt=Mf;break;case H0:case G0:case V0:Vt=R0;break;case K0:Vt=Oc;break;case"scroll":Vt=tx;break;case"wheel":Vt=L0;break;case"copy":case"cut":case"paste":Vt=Df;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Vt=Ml}var er=(h&4)!==0,cs=!er&&u==="scroll",qe=er?vt!==null?vt+"Capture":null:vt;er=[];for(var Le=rt,Je;Le!==null;){Je=Le;var jt=Je.stateNode;if(Je.tag===5&&jt!==null&&(Je=jt,qe!==null&&(jt=Nr(Le,qe),jt!=null&&er.push(Gc(Le,jt,Je)))),cs)break;Le=Le.return}0<er.length&&(vt=new Vt(vt,Jt,null,b,_t),Tt.push({event:vt,listeners:er}))}}if((h&7)===0){e:{if(vt=u==="mouseover"||u==="pointerover",Vt=u==="mouseout"||u==="pointerout",vt&&b!==Mt&&(Jt=b.relatedTarget||b.fromElement)&&(rl(Jt)||Jt[Hi]))break e;if((Vt||vt)&&(vt=_t.window===_t?_t:(vt=_t.ownerDocument)?vt.defaultView||vt.parentWindow:window,Vt?(Jt=b.relatedTarget||b.toElement,Vt=rt,Jt=Jt?rl(Jt):null,Jt!==null&&(cs=oe(Jt),Jt!==cs||Jt.tag!==5&&Jt.tag!==6)&&(Jt=null)):(Vt=null,Jt=rt),Vt!==Jt)){if(er=xn,jt="onMouseLeave",qe="onMouseEnter",Le="mouse",(u==="pointerout"||u==="pointerover")&&(er=Ml,jt="onPointerLeave",qe="onPointerEnter",Le="pointer"),cs=Vt==null?vt:as(Vt),Je=Jt==null?vt:as(Jt),vt=new er(jt,Le+"leave",Vt,b,_t),vt.target=cs,vt.relatedTarget=Je,jt=null,rl(_t)===rt&&(er=new er(qe,Le+"enter",Jt,b,_t),er.target=Je,er.relatedTarget=cs,jt=er),cs=jt,Vt&&Jt)t:{for(er=Vt,qe=Jt,Le=0,Je=er;Je;Je=Hl(Je))Le++;for(Je=0,jt=qe;jt;jt=Hl(jt))Je++;for(;0<Le-Je;)er=Hl(er),Le--;for(;0<Je-Le;)qe=Hl(qe),Je--;for(;Le--;){if(er===qe||qe!==null&&er===qe.alternate)break t;er=Hl(er),qe=Hl(qe)}er=null}else er=null;Vt!==null&&hx(Tt,vt,Vt,er,!1),Jt!==null&&cs!==null&&hx(Tt,cs,Jt,er,!0)}}e:{if(vt=rt?as(rt):window,Vt=vt.nodeName&&vt.nodeName.toLowerCase(),Vt==="select"||Vt==="input"&&vt.type==="file")var tr=oi;else if(_o(vt))if($c)tr=W0;else{tr=Tn;var or=$0}else(Vt=vt.nodeName)&&Vt.toLowerCase()==="input"&&(vt.type==="checkbox"||vt.type==="radio")&&(tr=Uf);if(tr&&(tr=tr(u,rt))){rd(Tt,tr,b,_t);break e}or&&or(u,vt,rt),u==="focusout"&&(or=vt._wrapperState)&&or.controlled&&vt.type==="number"&&Me(vt,"number",vt.value)}switch(or=rt?as(rt):window,u){case"focusin":(_o(or)||or.contentEditable==="true")&&(zc=or,xs=rt,Ul=null);break;case"focusout":Ul=xs=zc=null;break;case"mousedown":ad=!0;break;case"contextmenu":case"mouseup":case"dragend":ad=!1,$f(Tt,b,_t);break;case"selectionchange":if(sd)break;case"keydown":case"keyup":$f(Tt,b,_t)}var lr;if(td)e:{switch(u){case"compositionstart":var mr="onCompositionStart";break e;case"compositionend":mr="onCompositionEnd";break e;case"compositionupdate":mr="onCompositionUpdate";break e}mr=void 0}else Wa?O0(u,b)&&(mr="onCompositionEnd"):u==="keydown"&&b.keyCode===229&&(mr="onCompositionStart");mr&&($a&&b.locale!=="ko"&&(Wa||mr!=="onCompositionStart"?mr==="onCompositionEnd"&&Wa&&(lr=Ju()):(Ns=_t,qo="value"in Ns?Ns.value:Ns.textContent,Wa=!0)),or=qf(rt,mr),0<or.length&&(mr=new Rl(mr,u,null,b,_t),Tt.push({event:mr,listeners:or}),lr?mr.data=lr:(lr=Ni(b),lr!==null&&(mr.data=lr)))),(lr=Bc?B0(u,b):cx(u,b))&&(rt=qf(rt,"onBeforeInput"),0<rt.length&&(_t=new Rl("onBeforeInput","beforeinput",null,b,_t),Tt.push({event:_t,listeners:rt}),_t.data=lr))}Y0(Tt,h)})}function Gc(u,h,b){return{instance:u,listener:h,currentTarget:b}}function qf(u,h){for(var b=h+"Capture",P=[];u!==null;){var U=u,q=U.stateNode;U.tag===5&&q!==null&&(U=q,q=Nr(u,b),q!=null&&P.unshift(Gc(u,q,U)),q=Nr(u,h),q!=null&&P.push(Gc(u,q,U))),u=u.return}return P}function Hl(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function hx(u,h,b,P,U){for(var q=h._reactName,ue=[];b!==null&&b!==P;){var Ee=b,Ie=Ee.alternate,rt=Ee.stateNode;if(Ie!==null&&Ie===P)break;Ee.tag===5&&rt!==null&&(Ee=rt,U?(Ie=Nr(b,q),Ie!=null&&ue.unshift(Gc(b,Ie,Ee))):U||(Ie=Nr(b,q),Ie!=null&&ue.push(Gc(b,Ie,Ee)))),b=b.return}ue.length!==0&&u.push({event:h,listeners:ue})}var ov=/\r\n?/g,gx=/\u0000|\uFFFD/g;function Q0(u){return(typeof u=="string"?u:""+u).replace(ov,`
`).replace(gx,"")}function od(u,h,b){if(h=Q0(h),Q0(u)!==h&&b)throw Error(r(425))}function Gl(){}var Z0=null,eg=null;function tg(u,h){return u==="textarea"||u==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var Ha=typeof setTimeout=="function"?setTimeout:void 0,rg=typeof clearTimeout=="function"?clearTimeout:void 0,ld=typeof Promise=="function"?Promise:void 0,mx=typeof queueMicrotask=="function"?queueMicrotask:typeof ld<"u"?function(u){return ld.resolve(null).then(u).catch(px)}:Ha;function px(u){setTimeout(function(){throw u})}function Xf(u,h){var b=h,P=0;do{var U=b.nextSibling;if(u.removeChild(b),U&&U.nodeType===8)if(b=U.data,b==="/$"){if(P===0){u.removeChild(U),wa(h);return}P--}else b!=="$"&&b!=="$?"&&b!=="$!"||P++;b=U}while(b);wa(h)}function zi(u){for(;u!=null;u=u.nextSibling){var h=u.nodeType;if(h===1||h===3)break;if(h===8){if(h=u.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return u}function Vl(u){u=u.previousSibling;for(var h=0;u;){if(u.nodeType===8){var b=u.data;if(b==="$"||b==="$!"||b==="$?"){if(h===0)return u;h--}else b==="/$"&&h++}u=u.previousSibling}return null}var tl=Math.random().toString(36).slice(2),ci="__reactFiber$"+tl,cd="__reactProps$"+tl,Hi="__reactContainer$"+tl,Yf="__reactEvents$"+tl,xx="__reactListeners$"+tl,yx="__reactHandles$"+tl;function rl(u){var h=u[ci];if(h)return h;for(var b=u.parentNode;b;){if(h=b[Hi]||b[ci]){if(b=h.alternate,h.child!==null||b!==null&&b.child!==null)for(u=Vl(u);u!==null;){if(b=u[ci])return b;u=Vl(u)}return h}u=b,b=u.parentNode}return null}function ud(u){return u=u[ci]||u[Hi],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function as(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(r(33))}function ys(u){return u[cd]||null}var Jf=[],Kl=-1;function So(u){return{current:u}}function fn(u){0>Kl||(u.current=Jf[Kl],Jf[Kl]=null,Kl--)}function nn(u,h){Kl++,Jf[Kl]=u.current,u.current=h}var Gi={},Fs=So(Gi),$s=So(!1),nl=Gi;function ql(u,h){var b=u.type.contextTypes;if(!b)return Gi;var P=u.stateNode;if(P&&P.__reactInternalMemoizedUnmaskedChildContext===h)return P.__reactInternalMemoizedMaskedChildContext;var U={},q;for(q in b)U[q]=h[q];return P&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=h,u.__reactInternalMemoizedMaskedChildContext=U),U}function Ws(u){return u=u.childContextTypes,u!=null}function Vc(){fn($s),fn(Fs)}function ng(u,h,b){if(Fs.current!==Gi)throw Error(r(168));nn(Fs,h),nn($s,b)}function Qf(u,h,b){var P=u.stateNode;if(h=h.childContextTypes,typeof P.getChildContext!="function")return b;P=P.getChildContext();for(var U in P)if(!(U in h))throw Error(r(108,Q(u)||"Unknown",U));return Y({},b,P)}function Xl(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||Gi,nl=Fs.current,nn(Fs,u),nn($s,$s.current),!0}function vx(u,h,b){var P=u.stateNode;if(!P)throw Error(r(169));b?(u=Qf(u,h,nl),P.__reactInternalMemoizedMergedChildContext=u,fn($s),fn(Fs),nn(Fs,u)):fn($s),nn($s,b)}var Vi=null,Kc=!1,Zf=!1;function dd(u){Vi===null?Vi=[u]:Vi.push(u)}function ko(u){Kc=!0,dd(u)}function sl(){if(!Zf&&Vi!==null){Zf=!0;var u=0,h=zr;try{var b=Vi;for(zr=1;u<b.length;u++){var P=b[u];do P=P(!0);while(P!==null)}Vi=null,Kc=!1}catch(U){throw Vi!==null&&(Vi=Vi.slice(u+1)),Pe(Bt,sl),U}finally{zr=h,Zf=!1}}return null}var na=[],Yl=0,al=null,il=0,sa=[],aa=0,ol=null,Ga=1,_n="";function Jl(u,h){na[Yl++]=il,na[Yl++]=al,al=u,il=h}function wx(u,h,b){sa[aa++]=Ga,sa[aa++]=_n,sa[aa++]=ol,ol=u;var P=Ga;u=_n;var U=32-he(P)-1;P&=~(1<<U),b+=1;var q=32-he(h)+U;if(30<q){var ue=U-U%5;q=(P&(1<<ue)-1).toString(32),P>>=ue,U-=ue,Ga=1<<32-he(h)+U|b<<U|P,_n=q+u}else Ga=1<<q|b<<U|P,_n=u}function qc(u){u.return!==null&&(Jl(u,1),wx(u,1,0))}function vs(u){for(;u===al;)al=na[--Yl],na[Yl]=null,il=na[--Yl],na[Yl]=null;for(;u===ol;)ol=sa[--aa],sa[aa]=null,_n=sa[--aa],sa[aa]=null,Ga=sa[--aa],sa[aa]=null}var Va=null,Lt=null,Zr=!1,Ka=null;function sg(u,h){var b=Zi(5,null,null,0);b.elementType="DELETED",b.stateNode=h,b.return=u,h=u.deletions,h===null?(u.deletions=[b],u.flags|=16):h.push(b)}function _x(u,h){switch(u.tag){case 5:var b=u.type;return h=h.nodeType!==1||b.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(u.stateNode=h,Va=u,Lt=zi(h.firstChild),!0):!1;case 6:return h=u.pendingProps===""||h.nodeType!==3?null:h,h!==null?(u.stateNode=h,Va=u,Lt=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(b=ol!==null?{id:Ga,overflow:_n}:null,u.memoizedState={dehydrated:h,treeContext:b,retryLane:1073741824},b=Zi(18,null,null,0),b.stateNode=h,b.return=u,u.child=b,Va=u,Lt=null,!0):!1;default:return!1}}function Ql(u){return(u.mode&1)!==0&&(u.flags&128)===0}function Xc(u){if(Zr){var h=Lt;if(h){var b=h;if(!_x(u,h)){if(Ql(u))throw Error(r(418));h=zi(b.nextSibling);var P=Va;h&&_x(u,h)?sg(P,b):(u.flags=u.flags&-4097|2,Zr=!1,Va=u)}}else{if(Ql(u))throw Error(r(418));u.flags=u.flags&-4097|2,Zr=!1,Va=u}}}function eh(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;Va=u}function fd(u){if(u!==Va)return!1;if(!Zr)return eh(u),Zr=!0,!1;var h;if((h=u.tag!==3)&&!(h=u.tag!==5)&&(h=u.type,h=h!=="head"&&h!=="body"&&!tg(u.type,u.memoizedProps)),h&&(h=Lt)){if(Ql(u))throw ag(),Error(r(418));for(;h;)sg(u,h),h=zi(h.nextSibling)}if(eh(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));e:{for(u=u.nextSibling,h=0;u;){if(u.nodeType===8){var b=u.data;if(b==="/$"){if(h===0){Lt=zi(u.nextSibling);break e}h--}else b!=="$"&&b!=="$!"&&b!=="$?"||h++}u=u.nextSibling}Lt=null}}else Lt=Va?zi(u.stateNode.nextSibling):null;return!0}function ag(){for(var u=Lt;u;)u=zi(u.nextSibling)}function Zl(){Lt=Va=null,Zr=!1}function hd(u){Ka===null?Ka=[u]:Ka.push(u)}var ig=N.ReactCurrentBatchConfig;function Bn(u,h,b){if(u=b.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(r(309));var P=b.stateNode}if(!P)throw Error(r(147,u));var U=P,q=""+u;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===q?h.ref:(h=function(ue){var Ee=U.refs;ue===null?delete Ee[q]:Ee[q]=ue},h._stringRef=q,h)}if(typeof u!="string")throw Error(r(284));if(!b._owner)throw Error(r(290,u))}return u}function Sa(u,h){throw u=Object.prototype.toString.call(h),Error(r(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u))}function Ai(u){var h=u._init;return h(u._payload)}function th(u){function h(qe,Le){if(u){var Je=qe.deletions;Je===null?(qe.deletions=[Le],qe.flags|=16):Je.push(Le)}}function b(qe,Le){if(!u)return null;for(;Le!==null;)h(qe,Le),Le=Le.sibling;return null}function P(qe,Le){for(qe=new Map;Le!==null;)Le.key!==null?qe.set(Le.key,Le):qe.set(Le.index,Le),Le=Le.sibling;return qe}function U(qe,Le){return qe=mu(qe,Le),qe.index=0,qe.sibling=null,qe}function q(qe,Le,Je){return qe.index=Je,u?(Je=qe.alternate,Je!==null?(Je=Je.index,Je<Le?(qe.flags|=2,Le):Je):(qe.flags|=2,Le)):(qe.flags|=1048576,Le)}function ue(qe){return u&&qe.alternate===null&&(qe.flags|=2),qe}function Ee(qe,Le,Je,jt){return Le===null||Le.tag!==6?(Le=Nv(Je,qe.mode,jt),Le.return=qe,Le):(Le=U(Le,Je),Le.return=qe,Le)}function Ie(qe,Le,Je,jt){var tr=Je.type;return tr===R?_t(qe,Le,Je.props.children,jt,Je.key):Le!==null&&(Le.elementType===tr||typeof tr=="object"&&tr!==null&&tr.$$typeof===J&&Ai(tr)===Le.type)?(jt=U(Le,Je.props),jt.ref=Bn(qe,Le,Je),jt.return=qe,jt):(jt=Wx(Je.type,Je.key,Je.props,null,qe.mode,jt),jt.ref=Bn(qe,Le,Je),jt.return=qe,jt)}function rt(qe,Le,Je,jt){return Le===null||Le.tag!==4||Le.stateNode.containerInfo!==Je.containerInfo||Le.stateNode.implementation!==Je.implementation?(Le=Av(Je,qe.mode,jt),Le.return=qe,Le):(Le=U(Le,Je.children||[]),Le.return=qe,Le)}function _t(qe,Le,Je,jt,tr){return Le===null||Le.tag!==7?(Le=kd(Je,qe.mode,jt,tr),Le.return=qe,Le):(Le=U(Le,Je),Le.return=qe,Le)}function Tt(qe,Le,Je){if(typeof Le=="string"&&Le!==""||typeof Le=="number")return Le=Nv(""+Le,qe.mode,Je),Le.return=qe,Le;if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case F:return Je=Wx(Le.type,Le.key,Le.props,null,qe.mode,Je),Je.ref=Bn(qe,null,Le),Je.return=qe,Je;case A:return Le=Av(Le,qe.mode,Je),Le.return=qe,Le;case J:var jt=Le._init;return Tt(qe,jt(Le._payload),Je)}if(je(Le)||B(Le))return Le=kd(Le,qe.mode,Je,null),Le.return=qe,Le;Sa(qe,Le)}return null}function vt(qe,Le,Je,jt){var tr=Le!==null?Le.key:null;if(typeof Je=="string"&&Je!==""||typeof Je=="number")return tr!==null?null:Ee(qe,Le,""+Je,jt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case F:return Je.key===tr?Ie(qe,Le,Je,jt):null;case A:return Je.key===tr?rt(qe,Le,Je,jt):null;case J:return tr=Je._init,vt(qe,Le,tr(Je._payload),jt)}if(je(Je)||B(Je))return tr!==null?null:_t(qe,Le,Je,jt,null);Sa(qe,Je)}return null}function Vt(qe,Le,Je,jt,tr){if(typeof jt=="string"&&jt!==""||typeof jt=="number")return qe=qe.get(Je)||null,Ee(Le,qe,""+jt,tr);if(typeof jt=="object"&&jt!==null){switch(jt.$$typeof){case F:return qe=qe.get(jt.key===null?Je:jt.key)||null,Ie(Le,qe,jt,tr);case A:return qe=qe.get(jt.key===null?Je:jt.key)||null,rt(Le,qe,jt,tr);case J:var or=jt._init;return Vt(qe,Le,Je,or(jt._payload),tr)}if(je(jt)||B(jt))return qe=qe.get(Je)||null,_t(Le,qe,jt,tr,null);Sa(Le,jt)}return null}function Jt(qe,Le,Je,jt){for(var tr=null,or=null,lr=Le,mr=Le=0,qs=null;lr!==null&&mr<Je.length;mr++){lr.index>mr?(qs=lr,lr=null):qs=lr.sibling;var Xr=vt(qe,lr,Je[mr],jt);if(Xr===null){lr===null&&(lr=qs);break}u&&lr&&Xr.alternate===null&&h(qe,lr),Le=q(Xr,Le,mr),or===null?tr=Xr:or.sibling=Xr,or=Xr,lr=qs}if(mr===Je.length)return b(qe,lr),Zr&&Jl(qe,mr),tr;if(lr===null){for(;mr<Je.length;mr++)lr=Tt(qe,Je[mr],jt),lr!==null&&(Le=q(lr,Le,mr),or===null?tr=lr:or.sibling=lr,or=lr);return Zr&&Jl(qe,mr),tr}for(lr=P(qe,lr);mr<Je.length;mr++)qs=Vt(lr,qe,mr,Je[mr],jt),qs!==null&&(u&&qs.alternate!==null&&lr.delete(qs.key===null?mr:qs.key),Le=q(qs,Le,mr),or===null?tr=qs:or.sibling=qs,or=qs);return u&&lr.forEach(function(pu){return h(qe,pu)}),Zr&&Jl(qe,mr),tr}function er(qe,Le,Je,jt){var tr=B(Je);if(typeof tr!="function")throw Error(r(150));if(Je=tr.call(Je),Je==null)throw Error(r(151));for(var or=tr=null,lr=Le,mr=Le=0,qs=null,Xr=Je.next();lr!==null&&!Xr.done;mr++,Xr=Je.next()){lr.index>mr?(qs=lr,lr=null):qs=lr.sibling;var pu=vt(qe,lr,Xr.value,jt);if(pu===null){lr===null&&(lr=qs);break}u&&lr&&pu.alternate===null&&h(qe,lr),Le=q(pu,Le,mr),or===null?tr=pu:or.sibling=pu,or=pu,lr=qs}if(Xr.done)return b(qe,lr),Zr&&Jl(qe,mr),tr;if(lr===null){for(;!Xr.done;mr++,Xr=Je.next())Xr=Tt(qe,Xr.value,jt),Xr!==null&&(Le=q(Xr,Le,mr),or===null?tr=Xr:or.sibling=Xr,or=Xr);return Zr&&Jl(qe,mr),tr}for(lr=P(qe,lr);!Xr.done;mr++,Xr=Je.next())Xr=Vt(lr,qe,mr,Xr.value,jt),Xr!==null&&(u&&Xr.alternate!==null&&lr.delete(Xr.key===null?mr:Xr.key),Le=q(Xr,Le,mr),or===null?tr=Xr:or.sibling=Xr,or=Xr);return u&&lr.forEach(function(wP){return h(qe,wP)}),Zr&&Jl(qe,mr),tr}function cs(qe,Le,Je,jt){if(typeof Je=="object"&&Je!==null&&Je.type===R&&Je.key===null&&(Je=Je.props.children),typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case F:e:{for(var tr=Je.key,or=Le;or!==null;){if(or.key===tr){if(tr=Je.type,tr===R){if(or.tag===7){b(qe,or.sibling),Le=U(or,Je.props.children),Le.return=qe,qe=Le;break e}}else if(or.elementType===tr||typeof tr=="object"&&tr!==null&&tr.$$typeof===J&&Ai(tr)===or.type){b(qe,or.sibling),Le=U(or,Je.props),Le.ref=Bn(qe,or,Je),Le.return=qe,qe=Le;break e}b(qe,or);break}else h(qe,or);or=or.sibling}Je.type===R?(Le=kd(Je.props.children,qe.mode,jt,Je.key),Le.return=qe,qe=Le):(jt=Wx(Je.type,Je.key,Je.props,null,qe.mode,jt),jt.ref=Bn(qe,Le,Je),jt.return=qe,qe=jt)}return ue(qe);case A:e:{for(or=Je.key;Le!==null;){if(Le.key===or)if(Le.tag===4&&Le.stateNode.containerInfo===Je.containerInfo&&Le.stateNode.implementation===Je.implementation){b(qe,Le.sibling),Le=U(Le,Je.children||[]),Le.return=qe,qe=Le;break e}else{b(qe,Le);break}else h(qe,Le);Le=Le.sibling}Le=Av(Je,qe.mode,jt),Le.return=qe,qe=Le}return ue(qe);case J:return or=Je._init,cs(qe,Le,or(Je._payload),jt)}if(je(Je))return Jt(qe,Le,Je,jt);if(B(Je))return er(qe,Le,Je,jt);Sa(qe,Je)}return typeof Je=="string"&&Je!==""||typeof Je=="number"?(Je=""+Je,Le!==null&&Le.tag===6?(b(qe,Le.sibling),Le=U(Le,Je),Le.return=qe,qe=Le):(b(qe,Le),Le=Nv(Je,qe.mode,jt),Le.return=qe,qe=Le),ue(qe)):b(qe,Le)}return cs}var ec=th(!0),ui=th(!1),gd=So(null),qa=null,Yc=null,rh=null;function nh(){rh=Yc=qa=null}function sh(u){var h=gd.current;fn(gd),u._currentValue=h}function ah(u,h,b){for(;u!==null;){var P=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,P!==null&&(P.childLanes|=h)):P!==null&&(P.childLanes&h)!==h&&(P.childLanes|=h),u===b)break;u=u.return}}function Co(u,h){qa=u,rh=Yc=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&h)!==0&&(ee=!0),u.firstContext=null)}function ia(u){var h=u._currentValue;if(rh!==u)if(u={context:u,memoizedValue:h,next:null},Yc===null){if(qa===null)throw Error(r(308));Yc=u,qa.dependencies={lanes:0,firstContext:u}}else Yc=Yc.next=u;return h}var Ki=null;function Jc(u){Ki===null?Ki=[u]:Ki.push(u)}function md(u,h,b,P){var U=h.interleaved;return U===null?(b.next=b,Jc(h)):(b.next=U.next,U.next=b),h.interleaved=b,Xa(u,P)}function Xa(u,h){u.lanes|=h;var b=u.alternate;for(b!==null&&(b.lanes|=h),b=u,u=u.return;u!==null;)u.childLanes|=h,b=u.alternate,b!==null&&(b.childLanes|=h),b=u,u=u.return;return b.tag===3?b.stateNode:null}var qi=!1;function pd(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ih(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Xi(u,h){return{eventTime:u,lane:h,tag:0,payload:null,callback:null,next:null}}function Yi(u,h,b){var P=u.updateQueue;if(P===null)return null;if(P=P.shared,(Vr&2)!==0){var U=P.pending;return U===null?h.next=h:(h.next=U.next,U.next=h),P.pending=h,Xa(u,b)}return U=P.interleaved,U===null?(h.next=h,Jc(P)):(h.next=U.next,U.next=h),P.interleaved=h,Xa(u,b)}function oh(u,h,b){if(h=h.updateQueue,h!==null&&(h=h.shared,(b&4194240)!==0)){var P=h.lanes;P&=u.pendingLanes,b|=P,h.lanes=b,P0(u,b)}}function xd(u,h){var b=u.updateQueue,P=u.alternate;if(P!==null&&(P=P.updateQueue,b===P)){var U=null,q=null;if(b=b.firstBaseUpdate,b!==null){do{var ue={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};q===null?U=q=ue:q=q.next=ue,b=b.next}while(b!==null);q===null?U=q=h:q=q.next=h}else U=q=h;b={baseState:P.baseState,firstBaseUpdate:U,lastBaseUpdate:q,shared:P.shared,effects:P.effects},u.updateQueue=b;return}u=b.lastBaseUpdate,u===null?b.firstBaseUpdate=h:u.next=h,b.lastBaseUpdate=h}function Qc(u,h,b,P){var U=u.updateQueue;qi=!1;var q=U.firstBaseUpdate,ue=U.lastBaseUpdate,Ee=U.shared.pending;if(Ee!==null){U.shared.pending=null;var Ie=Ee,rt=Ie.next;Ie.next=null,ue===null?q=rt:ue.next=rt,ue=Ie;var _t=u.alternate;_t!==null&&(_t=_t.updateQueue,Ee=_t.lastBaseUpdate,Ee!==ue&&(Ee===null?_t.firstBaseUpdate=rt:Ee.next=rt,_t.lastBaseUpdate=Ie))}if(q!==null){var Tt=U.baseState;ue=0,_t=rt=Ie=null,Ee=q;do{var vt=Ee.lane,Vt=Ee.eventTime;if((P&vt)===vt){_t!==null&&(_t=_t.next={eventTime:Vt,lane:0,tag:Ee.tag,payload:Ee.payload,callback:Ee.callback,next:null});e:{var Jt=u,er=Ee;switch(vt=h,Vt=b,er.tag){case 1:if(Jt=er.payload,typeof Jt=="function"){Tt=Jt.call(Vt,Tt,vt);break e}Tt=Jt;break e;case 3:Jt.flags=Jt.flags&-65537|128;case 0:if(Jt=er.payload,vt=typeof Jt=="function"?Jt.call(Vt,Tt,vt):Jt,vt==null)break e;Tt=Y({},Tt,vt);break e;case 2:qi=!0}}Ee.callback!==null&&Ee.lane!==0&&(u.flags|=64,vt=U.effects,vt===null?U.effects=[Ee]:vt.push(Ee))}else Vt={eventTime:Vt,lane:vt,tag:Ee.tag,payload:Ee.payload,callback:Ee.callback,next:null},_t===null?(rt=_t=Vt,Ie=Tt):_t=_t.next=Vt,ue|=vt;if(Ee=Ee.next,Ee===null){if(Ee=U.shared.pending,Ee===null)break;vt=Ee,Ee=vt.next,vt.next=null,U.lastBaseUpdate=vt,U.shared.pending=null}}while(!0);if(_t===null&&(Ie=Tt),U.baseState=Ie,U.firstBaseUpdate=rt,U.lastBaseUpdate=_t,h=U.shared.interleaved,h!==null){U=h;do ue|=U.lane,U=U.next;while(U!==h)}else q===null&&(U.shared.lanes=0);wd|=ue,u.lanes=ue,u.memoizedState=Tt}}function Rn(u,h,b){if(u=h.effects,h.effects=null,u!==null)for(h=0;h<u.length;h++){var P=u[h],U=P.callback;if(U!==null){if(P.callback=null,P=b,typeof U!="function")throw Error(r(191,U));U.call(P)}}}var wr={},sn=So(wr),bn=So(wr),Un=So(wr);function is(u){if(u===wr)throw Error(r(174));return u}function ll(u,h){switch(nn(Un,h),nn(bn,u),nn(sn,wr),u=h.nodeType,u){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:Kt(null,"");break;default:u=u===8?h.parentNode:h,h=u.namespaceURI||null,u=u.tagName,h=Kt(h,u)}fn(sn),nn(sn,h)}function Sn(){fn(sn),fn(bn),fn(Un)}function Zc(u){is(Un.current);var h=is(sn.current),b=Kt(h,u.type);h!==b&&(nn(bn,u),nn(sn,b))}function To(u){bn.current===u&&(fn(sn),fn(bn))}var hn=So(0);function eu(u){for(var h=u;h!==null;){if(h.tag===13){var b=h.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var tc=[];function zs(){for(var u=0;u<tc.length;u++)tc[u]._workInProgressVersionPrimary=null;tc.length=0}var tu=N.ReactCurrentDispatcher,yd=N.ReactCurrentBatchConfig,oa=0,rn=null,In=null,Kn=null,ji=!1,cl=!1,di=0,lh=0;function qn(){throw Error(r(321))}function vd(u,h){if(h===null)return!1;for(var b=0;b<h.length&&b<u.length;b++)if(!ba(u[b],h[b]))return!1;return!0}function ru(u,h,b,P,U,q){if(oa=q,rn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,tu.current=u===null||u.memoizedState===null?cv:fl,u=b(P,U),cl){q=0;do{if(cl=!1,di=0,25<=q)throw Error(r(301));q+=1,Kn=In=null,h.updateQueue=null,tu.current=hh,u=b(P,U)}while(cl)}if(tu.current=iu,h=In!==null&&In.next!==null,oa=0,Kn=In=rn=null,ji=!1,h)throw Error(r(300));return u}function nu(){var u=di!==0;return di=0,u}function yn(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kn===null?rn.memoizedState=Kn=u:Kn=Kn.next=u,Kn}function os(){if(In===null){var u=rn.alternate;u=u!==null?u.memoizedState:null}else u=In.next;var h=Kn===null?rn.memoizedState:Kn.next;if(h!==null)Kn=h,In=u;else{if(u===null)throw Error(r(310));In=u,u={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},Kn===null?rn.memoizedState=Kn=u:Kn=Kn.next=u}return Kn}function Hs(u,h){return typeof h=="function"?h(u):h}function Gs(u){var h=os(),b=h.queue;if(b===null)throw Error(r(311));b.lastRenderedReducer=u;var P=In,U=P.baseQueue,q=b.pending;if(q!==null){if(U!==null){var ue=U.next;U.next=q.next,q.next=ue}P.baseQueue=U=q,b.pending=null}if(U!==null){q=U.next,P=P.baseState;var Ee=ue=null,Ie=null,rt=q;do{var _t=rt.lane;if((oa&_t)===_t)Ie!==null&&(Ie=Ie.next={lane:0,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null}),P=rt.hasEagerState?rt.eagerState:u(P,rt.action);else{var Tt={lane:_t,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null};Ie===null?(Ee=Ie=Tt,ue=P):Ie=Ie.next=Tt,rn.lanes|=_t,wd|=_t}rt=rt.next}while(rt!==null&&rt!==q);Ie===null?ue=P:Ie.next=Ee,ba(P,h.memoizedState)||(ee=!0),h.memoizedState=P,h.baseState=ue,h.baseQueue=Ie,b.lastRenderedState=P}if(u=b.interleaved,u!==null){U=u;do q=U.lane,rn.lanes|=q,wd|=q,U=U.next;while(U!==u)}else U===null&&(b.lanes=0);return[h.memoizedState,b.dispatch]}function ch(u){var h=os(),b=h.queue;if(b===null)throw Error(r(311));b.lastRenderedReducer=u;var P=b.dispatch,U=b.pending,q=h.memoizedState;if(U!==null){b.pending=null;var ue=U=U.next;do q=u(q,ue.action),ue=ue.next;while(ue!==U);ba(q,h.memoizedState)||(ee=!0),h.memoizedState=q,h.baseQueue===null&&(h.baseState=q),b.lastRenderedState=q}return[q,P]}function uh(){}function dh(u,h){var b=rn,P=os(),U=h(),q=!ba(P.memoizedState,U);if(q&&(P.memoizedState=U,ee=!0),P=P.queue,ug(og.bind(null,b,P,u),[u]),P.getSnapshot!==h||q||Kn!==null&&Kn.memoizedState.tag&1){if(b.flags|=2048,su(9,Eo.bind(null,b,P,U,h),void 0,null),Ks===null)throw Error(r(349));(oa&30)!==0||bx(b,h,U)}return U}function bx(u,h,b){u.flags|=16384,u={getSnapshot:h,value:b},h=rn.updateQueue,h===null?(h={lastEffect:null,stores:null},rn.updateQueue=h,h.stores=[u]):(b=h.stores,b===null?h.stores=[u]:b.push(u))}function Eo(u,h,b,P){h.value=b,h.getSnapshot=P,lg(h)&&fh(u)}function og(u,h,b){return b(function(){lg(h)&&fh(u)})}function lg(u){var h=u.getSnapshot;u=u.value;try{var b=h();return!ba(u,b)}catch{return!0}}function fh(u){var h=Xa(u,1);h!==null&&Fo(h,u,1,-1)}function ul(u){var h=yn();return typeof u=="function"&&(u=u()),h.memoizedState=h.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hs,lastRenderedState:u},h.queue=u,u=u.dispatch=Nx.bind(null,rn,u),[h.memoizedState,u]}function su(u,h,b,P){return u={tag:u,create:h,destroy:b,deps:P,next:null},h=rn.updateQueue,h===null?(h={lastEffect:null,stores:null},rn.updateQueue=h,h.lastEffect=u.next=u):(b=h.lastEffect,b===null?h.lastEffect=u.next=u:(P=b.next,b.next=u,u.next=P,h.lastEffect=u)),u}function cg(){return os().memoizedState}function au(u,h,b,P){var U=yn();rn.flags|=u,U.memoizedState=su(1|h,b,void 0,P===void 0?null:P)}function rc(u,h,b,P){var U=os();P=P===void 0?null:P;var q=void 0;if(In!==null){var ue=In.memoizedState;if(q=ue.destroy,P!==null&&vd(P,ue.deps)){U.memoizedState=su(h,b,q,P);return}}rn.flags|=u,U.memoizedState=su(1|h,b,q,P)}function Sx(u,h){return au(8390656,8,u,h)}function ug(u,h){return rc(2048,8,u,h)}function dg(u,h){return rc(4,2,u,h)}function fg(u,h){return rc(4,4,u,h)}function dl(u,h){if(typeof h=="function")return u=u(),h(u),function(){h(null)};if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function kx(u,h,b){return b=b!=null?b.concat([u]):null,rc(4,4,dl.bind(null,h,u),b)}function No(){}function hg(u,h){var b=os();h=h===void 0?null:h;var P=b.memoizedState;return P!==null&&h!==null&&vd(h,P[1])?P[0]:(b.memoizedState=[u,h],u)}function vn(u,h){var b=os();h=h===void 0?null:h;var P=b.memoizedState;return P!==null&&h!==null&&vd(h,P[1])?P[0]:(u=u(),b.memoizedState=[u,h],u)}function Cx(u,h,b){return(oa&21)===0?(u.baseState&&(u.baseState=!1,ee=!0),u.memoizedState=b):(ba(b,h)||(b=Dn(),rn.lanes|=b,wd|=b,u.baseState=!0),h)}function Tx(u,h){var b=zr;zr=b!==0&&4>b?b:4,u(!0);var P=yd.transition;yd.transition={};try{u(!1),h()}finally{zr=b,yd.transition=P}}function Ex(){return os().memoizedState}function lv(u,h,b){var P=hu(u);if(b={lane:P,action:b,hasEagerState:!1,eagerState:null,next:null},gg(u))Ax(h,b);else if(b=md(u,h,b,P),b!==null){var U=Ja();Fo(b,u,P,U),Ya(b,h,P)}}function Nx(u,h,b){var P=hu(u),U={lane:P,action:b,hasEagerState:!1,eagerState:null,next:null};if(gg(u))Ax(h,U);else{var q=u.alternate;if(u.lanes===0&&(q===null||q.lanes===0)&&(q=h.lastRenderedReducer,q!==null))try{var ue=h.lastRenderedState,Ee=q(ue,b);if(U.hasEagerState=!0,U.eagerState=Ee,ba(Ee,ue)){var Ie=h.interleaved;Ie===null?(U.next=U,Jc(h)):(U.next=Ie.next,Ie.next=U),h.interleaved=U;return}}catch{}finally{}b=md(u,h,U,P),b!==null&&(U=Ja(),Fo(b,u,P,U),Ya(b,h,P))}}function gg(u){var h=u.alternate;return u===rn||h!==null&&h===rn}function Ax(u,h){cl=ji=!0;var b=u.pending;b===null?h.next=h:(h.next=b.next,b.next=h),u.pending=h}function Ya(u,h,b){if((b&4194240)!==0){var P=h.lanes;P&=u.pendingLanes,b|=P,h.lanes=b,P0(u,b)}}var iu={readContext:ia,useCallback:qn,useContext:qn,useEffect:qn,useImperativeHandle:qn,useInsertionEffect:qn,useLayoutEffect:qn,useMemo:qn,useReducer:qn,useRef:qn,useState:qn,useDebugValue:qn,useDeferredValue:qn,useTransition:qn,useMutableSource:qn,useSyncExternalStore:qn,useId:qn,unstable_isNewReconciler:!1},cv={readContext:ia,useCallback:function(u,h){return yn().memoizedState=[u,h===void 0?null:h],u},useContext:ia,useEffect:Sx,useImperativeHandle:function(u,h,b){return b=b!=null?b.concat([u]):null,au(4194308,4,dl.bind(null,h,u),b)},useLayoutEffect:function(u,h){return au(4194308,4,u,h)},useInsertionEffect:function(u,h){return au(4,2,u,h)},useMemo:function(u,h){var b=yn();return h=h===void 0?null:h,u=u(),b.memoizedState=[u,h],u},useReducer:function(u,h,b){var P=yn();return h=b!==void 0?b(h):h,P.memoizedState=P.baseState=h,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:h},P.queue=u,u=u.dispatch=lv.bind(null,rn,u),[P.memoizedState,u]},useRef:function(u){var h=yn();return u={current:u},h.memoizedState=u},useState:ul,useDebugValue:No,useDeferredValue:function(u){return yn().memoizedState=u},useTransition:function(){var u=ul(!1),h=u[0];return u=Tx.bind(null,u[1]),yn().memoizedState=u,[h,u]},useMutableSource:function(){},useSyncExternalStore:function(u,h,b){var P=rn,U=yn();if(Zr){if(b===void 0)throw Error(r(407));b=b()}else{if(b=h(),Ks===null)throw Error(r(349));(oa&30)!==0||bx(P,h,b)}U.memoizedState=b;var q={value:b,getSnapshot:h};return U.queue=q,Sx(og.bind(null,P,q,u),[u]),P.flags|=2048,su(9,Eo.bind(null,P,q,b,h),void 0,null),b},useId:function(){var u=yn(),h=Ks.identifierPrefix;if(Zr){var b=_n,P=Ga;b=(P&~(1<<32-he(P)-1)).toString(32)+b,h=":"+h+"R"+b,b=di++,0<b&&(h+="H"+b.toString(32)),h+=":"}else b=lh++,h=":"+h+"r"+b.toString(32)+":";return u.memoizedState=h},unstable_isNewReconciler:!1},fl={readContext:ia,useCallback:hg,useContext:ia,useEffect:ug,useImperativeHandle:kx,useInsertionEffect:dg,useLayoutEffect:fg,useMemo:vn,useReducer:Gs,useRef:cg,useState:function(){return Gs(Hs)},useDebugValue:No,useDeferredValue:function(u){var h=os();return Cx(h,In.memoizedState,u)},useTransition:function(){var u=Gs(Hs)[0],h=os().memoizedState;return[u,h]},useMutableSource:uh,useSyncExternalStore:dh,useId:Ex,unstable_isNewReconciler:!1},hh={readContext:ia,useCallback:hg,useContext:ia,useEffect:ug,useImperativeHandle:kx,useInsertionEffect:dg,useLayoutEffect:fg,useMemo:vn,useReducer:ch,useRef:cg,useState:function(){return ch(Hs)},useDebugValue:No,useDeferredValue:function(u){var h=os();return In===null?h.memoizedState=u:Cx(h,In.memoizedState,u)},useTransition:function(){var u=ch(Hs)[0],h=os().memoizedState;return[u,h]},useMutableSource:uh,useSyncExternalStore:dh,useId:Ex,unstable_isNewReconciler:!1};function Ps(u,h){if(u&&u.defaultProps){h=Y({},h),u=u.defaultProps;for(var b in u)h[b]===void 0&&(h[b]=u[b]);return h}return h}function ou(u,h,b,P){h=u.memoizedState,b=b(P,h),b=b==null?h:Y({},h,b),u.memoizedState=b,u.lanes===0&&(u.updateQueue.baseState=b)}var lu={isMounted:function(u){return(u=u._reactInternals)?oe(u)===u:!1},enqueueSetState:function(u,h,b){u=u._reactInternals;var P=Ja(),U=hu(u),q=Xi(P,U);q.payload=h,b!=null&&(q.callback=b),h=Yi(u,q,U),h!==null&&(Fo(h,u,U,P),oh(h,u,U))},enqueueReplaceState:function(u,h,b){u=u._reactInternals;var P=Ja(),U=hu(u),q=Xi(P,U);q.tag=1,q.payload=h,b!=null&&(q.callback=b),h=Yi(u,q,U),h!==null&&(Fo(h,u,U,P),oh(h,u,U))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var b=Ja(),P=hu(u),U=Xi(b,P);U.tag=2,h!=null&&(U.callback=h),h=Yi(u,U,P),h!==null&&(Fo(h,u,P,b),oh(h,u,P))}};function gh(u,h,b,P,U,q,ue){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(P,q,ue):h.prototype&&h.prototype.isPureReactComponent?!Bl(b,P)||!Bl(U,q):!0}function jx(u,h,b){var P=!1,U=Gi,q=h.contextType;return typeof q=="object"&&q!==null?q=ia(q):(U=Ws(h)?nl:Fs.current,P=h.contextTypes,q=(P=P!=null)?ql(u,U):Gi),h=new h(b,q),u.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=lu,u.stateNode=h,h._reactInternals=u,P&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=U,u.__reactInternalMemoizedMaskedChildContext=q),h}function mg(u,h,b,P){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(b,P),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(b,P),h.state!==u&&lu.enqueueReplaceState(h,h.state,null)}function mh(u,h,b,P){var U=u.stateNode;U.props=b,U.state=u.memoizedState,U.refs={},pd(u);var q=h.contextType;typeof q=="object"&&q!==null?U.context=ia(q):(q=Ws(h)?nl:Fs.current,U.context=ql(u,q)),U.state=u.memoizedState,q=h.getDerivedStateFromProps,typeof q=="function"&&(ou(u,h,q,b),U.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof U.getSnapshotBeforeUpdate=="function"||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(h=U.state,typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount(),h!==U.state&&lu.enqueueReplaceState(U,U.state,null),Qc(u,b,U,P),U.state=u.memoizedState),typeof U.componentDidMount=="function"&&(u.flags|=4194308)}function nc(u,h){try{var b="",P=h;do b+=ie(P),P=P.return;while(P);var U=b}catch(q){U=`
Error generating stack: `+q.message+`
`+q.stack}return{value:u,source:h,stack:U,digest:null}}function ph(u,h,b){return{value:u,source:null,stack:b??null,digest:h??null}}function cu(u,h){try{console.error(h.value)}catch(b){setTimeout(function(){throw b})}}var uv=typeof WeakMap=="function"?WeakMap:Map;function Fx(u,h,b){b=Xi(-1,b),b.tag=3,b.payload={element:null};var P=h.value;return b.callback=function(){Mx||(Mx=!0,wv=P),cu(u,h)},b}function g(u,h,b){b=Xi(-1,b),b.tag=3;var P=u.type.getDerivedStateFromError;if(typeof P=="function"){var U=h.value;b.payload=function(){return P(U)},b.callback=function(){cu(u,h)}}var q=u.stateNode;return q!==null&&typeof q.componentDidCatch=="function"&&(b.callback=function(){cu(u,h),typeof P!="function"&&(du===null?du=new Set([this]):du.add(this));var ue=h.stack;this.componentDidCatch(h.value,{componentStack:ue!==null?ue:""})}),b}function x(u,h,b){var P=u.pingCache;if(P===null){P=u.pingCache=new uv;var U=new Set;P.set(h,U)}else U=P.get(h),U===void 0&&(U=new Set,P.set(h,U));U.has(b)||(U.add(b),u=cP.bind(null,u,h,b),h.then(u,u))}function j(u){do{var h;if((h=u.tag===13)&&(h=u.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return u;u=u.return}while(u!==null);return null}function M(u,h,b,P,U){return(u.mode&1)===0?(u===h?u.flags|=65536:(u.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(h=Xi(-1,1),h.tag=2,Yi(b,h,1))),b.lanes|=1),u):(u.flags|=65536,u.lanes=U,u)}var z=N.ReactCurrentOwner,ee=!1;function xe(u,h,b,P){h.child=u===null?ui(h,null,b,P):ec(h,u.child,b,P)}function $e(u,h,b,P,U){b=b.render;var q=h.ref;return Co(h,U),P=ru(u,h,b,P,q,U),b=nu(),u!==null&&!ee?(h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~U,Vs(u,h,U)):(Zr&&b&&qc(h),h.flags|=1,xe(u,h,P,U),h.child)}function nt(u,h,b,P,U){if(u===null){var q=b.type;return typeof q=="function"&&!Ev(q)&&q.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(h.tag=15,h.type=q,Nt(u,h,q,P,U)):(u=Wx(b.type,null,P,h,h.mode,U),u.ref=h.ref,u.return=h,h.child=u)}if(q=u.child,(u.lanes&U)===0){var ue=q.memoizedProps;if(b=b.compare,b=b!==null?b:Bl,b(ue,P)&&u.ref===h.ref)return Vs(u,h,U)}return h.flags|=1,u=mu(q,P),u.ref=h.ref,u.return=h,h.child=u}function Nt(u,h,b,P,U){if(u!==null){var q=u.memoizedProps;if(Bl(q,P)&&u.ref===h.ref)if(ee=!1,h.pendingProps=P=q,(u.lanes&U)!==0)(u.flags&131072)!==0&&(ee=!0);else return h.lanes=u.lanes,Vs(u,h,U)}return Ut(u,h,b,P,U)}function Xt(u,h,b){var P=h.pendingProps,U=P.children,q=u!==null?u.memoizedState:null;if(P.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},nn(yh,Fi),Fi|=b;else{if((b&1073741824)===0)return u=q!==null?q.baseLanes|b:b,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:u,cachePool:null,transitions:null},h.updateQueue=null,nn(yh,Fi),Fi|=u,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},P=q!==null?q.baseLanes:b,nn(yh,Fi),Fi|=P}else q!==null?(P=q.baseLanes|b,h.memoizedState=null):P=b,nn(yh,Fi),Fi|=P;return xe(u,h,U,b),h.child}function pr(u,h){var b=h.ref;(u===null&&b!==null||u!==null&&u.ref!==b)&&(h.flags|=512,h.flags|=2097152)}function Ut(u,h,b,P,U){var q=Ws(b)?nl:Fs.current;return q=ql(h,q),Co(h,U),b=ru(u,h,b,P,q,U),P=nu(),u!==null&&!ee?(h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~U,Vs(u,h,U)):(Zr&&P&&qc(h),h.flags|=1,xe(u,h,b,U),h.child)}function gn(u,h,b,P,U){if(Ws(b)){var q=!0;Xl(h)}else q=!1;if(Co(h,U),h.stateNode===null)Or(u,h),jx(h,b,P),mh(h,b,P,U),P=!0;else if(u===null){var ue=h.stateNode,Ee=h.memoizedProps;ue.props=Ee;var Ie=ue.context,rt=b.contextType;typeof rt=="object"&&rt!==null?rt=ia(rt):(rt=Ws(b)?nl:Fs.current,rt=ql(h,rt));var _t=b.getDerivedStateFromProps,Tt=typeof _t=="function"||typeof ue.getSnapshotBeforeUpdate=="function";Tt||typeof ue.UNSAFE_componentWillReceiveProps!="function"&&typeof ue.componentWillReceiveProps!="function"||(Ee!==P||Ie!==rt)&&mg(h,ue,P,rt),qi=!1;var vt=h.memoizedState;ue.state=vt,Qc(h,P,ue,U),Ie=h.memoizedState,Ee!==P||vt!==Ie||$s.current||qi?(typeof _t=="function"&&(ou(h,b,_t,P),Ie=h.memoizedState),(Ee=qi||gh(h,b,Ee,P,vt,Ie,rt))?(Tt||typeof ue.UNSAFE_componentWillMount!="function"&&typeof ue.componentWillMount!="function"||(typeof ue.componentWillMount=="function"&&ue.componentWillMount(),typeof ue.UNSAFE_componentWillMount=="function"&&ue.UNSAFE_componentWillMount()),typeof ue.componentDidMount=="function"&&(h.flags|=4194308)):(typeof ue.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=P,h.memoizedState=Ie),ue.props=P,ue.state=Ie,ue.context=rt,P=Ee):(typeof ue.componentDidMount=="function"&&(h.flags|=4194308),P=!1)}else{ue=h.stateNode,ih(u,h),Ee=h.memoizedProps,rt=h.type===h.elementType?Ee:Ps(h.type,Ee),ue.props=rt,Tt=h.pendingProps,vt=ue.context,Ie=b.contextType,typeof Ie=="object"&&Ie!==null?Ie=ia(Ie):(Ie=Ws(b)?nl:Fs.current,Ie=ql(h,Ie));var Vt=b.getDerivedStateFromProps;(_t=typeof Vt=="function"||typeof ue.getSnapshotBeforeUpdate=="function")||typeof ue.UNSAFE_componentWillReceiveProps!="function"&&typeof ue.componentWillReceiveProps!="function"||(Ee!==Tt||vt!==Ie)&&mg(h,ue,P,Ie),qi=!1,vt=h.memoizedState,ue.state=vt,Qc(h,P,ue,U);var Jt=h.memoizedState;Ee!==Tt||vt!==Jt||$s.current||qi?(typeof Vt=="function"&&(ou(h,b,Vt,P),Jt=h.memoizedState),(rt=qi||gh(h,b,rt,P,vt,Jt,Ie)||!1)?(_t||typeof ue.UNSAFE_componentWillUpdate!="function"&&typeof ue.componentWillUpdate!="function"||(typeof ue.componentWillUpdate=="function"&&ue.componentWillUpdate(P,Jt,Ie),typeof ue.UNSAFE_componentWillUpdate=="function"&&ue.UNSAFE_componentWillUpdate(P,Jt,Ie)),typeof ue.componentDidUpdate=="function"&&(h.flags|=4),typeof ue.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof ue.componentDidUpdate!="function"||Ee===u.memoizedProps&&vt===u.memoizedState||(h.flags|=4),typeof ue.getSnapshotBeforeUpdate!="function"||Ee===u.memoizedProps&&vt===u.memoizedState||(h.flags|=1024),h.memoizedProps=P,h.memoizedState=Jt),ue.props=P,ue.state=Jt,ue.context=Ie,P=rt):(typeof ue.componentDidUpdate!="function"||Ee===u.memoizedProps&&vt===u.memoizedState||(h.flags|=4),typeof ue.getSnapshotBeforeUpdate!="function"||Ee===u.memoizedProps&&vt===u.memoizedState||(h.flags|=1024),P=!1)}return en(u,h,b,P,q,U)}function en(u,h,b,P,U,q){pr(u,h);var ue=(h.flags&128)!==0;if(!P&&!ue)return U&&vx(h,b,!1),Vs(u,h,q);P=h.stateNode,z.current=h;var Ee=ue&&typeof b.getDerivedStateFromError!="function"?null:P.render();return h.flags|=1,u!==null&&ue?(h.child=ec(h,u.child,null,q),h.child=ec(h,null,Ee,q)):xe(u,h,Ee,q),h.memoizedState=P.state,U&&vx(h,b,!0),h.child}function la(u){var h=u.stateNode;h.pendingContext?ng(u,h.pendingContext,h.pendingContext!==h.context):h.context&&ng(u,h.context,!1),ll(u,h.containerInfo)}function Ji(u,h,b,P,U){return Zl(),hd(U),h.flags|=256,xe(u,h,b,P),h.child}var et={dehydrated:null,treeContext:null,retryLane:0};function He(u){return{baseLanes:u,cachePool:null,transitions:null}}function ot(u,h,b){var P=h.pendingProps,U=hn.current,q=!1,ue=(h.flags&128)!==0,Ee;if((Ee=ue)||(Ee=u!==null&&u.memoizedState===null?!1:(U&2)!==0),Ee?(q=!0,h.flags&=-129):(u===null||u.memoizedState!==null)&&(U|=1),nn(hn,U&1),u===null)return Xc(h),u=h.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((h.mode&1)===0?h.lanes=1:u.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(ue=P.children,u=P.fallback,q?(P=h.mode,q=h.child,ue={mode:"hidden",children:ue},(P&1)===0&&q!==null?(q.childLanes=0,q.pendingProps=ue):q=zx(ue,P,0,null),u=kd(u,P,b,null),q.return=h,u.return=h,q.sibling=u,h.child=q,h.child.memoizedState=He(b),h.memoizedState=et,u):Ht(h,ue));if(U=u.memoizedState,U!==null&&(Ee=U.dehydrated,Ee!==null))return br(u,h,ue,P,Ee,U,b);if(q){q=P.fallback,ue=h.mode,U=u.child,Ee=U.sibling;var Ie={mode:"hidden",children:P.children};return(ue&1)===0&&h.child!==U?(P=h.child,P.childLanes=0,P.pendingProps=Ie,h.deletions=null):(P=mu(U,Ie),P.subtreeFlags=U.subtreeFlags&14680064),Ee!==null?q=mu(Ee,q):(q=kd(q,ue,b,null),q.flags|=2),q.return=h,P.return=h,P.sibling=q,h.child=P,P=q,q=h.child,ue=u.child.memoizedState,ue=ue===null?He(b):{baseLanes:ue.baseLanes|b,cachePool:null,transitions:ue.transitions},q.memoizedState=ue,q.childLanes=u.childLanes&~b,h.memoizedState=et,P}return q=u.child,u=q.sibling,P=mu(q,{mode:"visible",children:P.children}),(h.mode&1)===0&&(P.lanes=b),P.return=h,P.sibling=null,u!==null&&(b=h.deletions,b===null?(h.deletions=[u],h.flags|=16):b.push(u)),h.child=P,h.memoizedState=null,P}function Ht(u,h){return h=zx({mode:"visible",children:h},u.mode,0,null),h.return=u,u.child=h}function ar(u,h,b,P){return P!==null&&hd(P),ec(h,u.child,null,b),u=Ht(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function br(u,h,b,P,U,q,ue){if(b)return h.flags&256?(h.flags&=-257,P=ph(Error(r(422))),ar(u,h,ue,P)):h.memoizedState!==null?(h.child=u.child,h.flags|=128,null):(q=P.fallback,U=h.mode,P=zx({mode:"visible",children:P.children},U,0,null),q=kd(q,U,ue,null),q.flags|=2,P.return=h,q.return=h,P.sibling=q,h.child=P,(h.mode&1)!==0&&ec(h,u.child,null,ue),h.child.memoizedState=He(ue),h.memoizedState=et,q);if((h.mode&1)===0)return ar(u,h,ue,null);if(U.data==="$!"){if(P=U.nextSibling&&U.nextSibling.dataset,P)var Ee=P.dgst;return P=Ee,q=Error(r(419)),P=ph(q,P,void 0),ar(u,h,ue,P)}if(Ee=(ue&u.childLanes)!==0,ee||Ee){if(P=Ks,P!==null){switch(ue&-ue){case 4:U=2;break;case 16:U=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:U=32;break;case 536870912:U=268435456;break;default:U=0}U=(U&(P.suspendedLanes|ue))!==0?0:U,U!==0&&U!==q.retryLane&&(q.retryLane=U,Xa(u,U),Fo(P,u,U,-1))}return Tv(),P=ph(Error(r(421))),ar(u,h,ue,P)}return U.data==="$?"?(h.flags|=128,h.child=u.child,h=uP.bind(null,u),U._reactRetry=h,null):(u=q.treeContext,Lt=zi(U.nextSibling),Va=h,Zr=!0,Ka=null,u!==null&&(sa[aa++]=Ga,sa[aa++]=_n,sa[aa++]=ol,Ga=u.id,_n=u.overflow,ol=h),h=Ht(h,P.children),h.flags|=4096,h)}function xr(u,h,b){u.lanes|=h;var P=u.alternate;P!==null&&(P.lanes|=h),ah(u.return,h,b)}function $r(u,h,b,P,U){var q=u.memoizedState;q===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:P,tail:b,tailMode:U}:(q.isBackwards=h,q.rendering=null,q.renderingStartTime=0,q.last=P,q.tail=b,q.tailMode=U)}function ls(u,h,b){var P=h.pendingProps,U=P.revealOrder,q=P.tail;if(xe(u,h,P.children,b),P=hn.current,(P&2)!==0)P=P&1|2,h.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&xr(u,b,h);else if(u.tag===19)xr(u,b,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break e;for(;u.sibling===null;){if(u.return===null||u.return===h)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}P&=1}if(nn(hn,P),(h.mode&1)===0)h.memoizedState=null;else switch(U){case"forwards":for(b=h.child,U=null;b!==null;)u=b.alternate,u!==null&&eu(u)===null&&(U=b),b=b.sibling;b=U,b===null?(U=h.child,h.child=null):(U=b.sibling,b.sibling=null),$r(h,!1,U,b,q);break;case"backwards":for(b=null,U=h.child,h.child=null;U!==null;){if(u=U.alternate,u!==null&&eu(u)===null){h.child=U;break}u=U.sibling,U.sibling=b,b=U,U=u}$r(h,!0,b,null,q);break;case"together":$r(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Or(u,h){(h.mode&1)===0&&u!==null&&(u.alternate=null,h.alternate=null,h.flags|=2)}function Vs(u,h,b){if(u!==null&&(h.dependencies=u.dependencies),wd|=h.lanes,(b&h.childLanes)===0)return null;if(u!==null&&h.child!==u.child)throw Error(r(153));if(h.child!==null){for(u=h.child,b=mu(u,u.pendingProps),h.child=b,b.return=h;u.sibling!==null;)u=u.sibling,b=b.sibling=mu(u,u.pendingProps),b.return=h;b.sibling=null}return h.child}function dv(u,h,b){switch(h.tag){case 3:la(h),Zl();break;case 5:Zc(h);break;case 1:Ws(h.type)&&Xl(h);break;case 4:ll(h,h.stateNode.containerInfo);break;case 10:var P=h.type._context,U=h.memoizedProps.value;nn(gd,P._currentValue),P._currentValue=U;break;case 13:if(P=h.memoizedState,P!==null)return P.dehydrated!==null?(nn(hn,hn.current&1),h.flags|=128,null):(b&h.child.childLanes)!==0?ot(u,h,b):(nn(hn,hn.current&1),u=Vs(u,h,b),u!==null?u.sibling:null);nn(hn,hn.current&1);break;case 19:if(P=(b&h.childLanes)!==0,(u.flags&128)!==0){if(P)return ls(u,h,b);h.flags|=128}if(U=h.memoizedState,U!==null&&(U.rendering=null,U.tail=null,U.lastEffect=null),nn(hn,hn.current),P)break;return null;case 22:case 23:return h.lanes=0,Xt(u,h,b)}return Vs(u,h,b)}var $S,fv,WS,zS;$S=function(u,h){for(var b=h.child;b!==null;){if(b.tag===5||b.tag===6)u.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===h)break;for(;b.sibling===null;){if(b.return===null||b.return===h)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},fv=function(){},WS=function(u,h,b,P){var U=u.memoizedProps;if(U!==P){u=h.stateNode,is(sn.current);var q=null;switch(b){case"input":U=Ke(u,U),P=Ke(u,P),q=[];break;case"select":U=Y({},U,{value:void 0}),P=Y({},P,{value:void 0}),q=[];break;case"textarea":U=Ge(u,U),P=Ge(u,P),q=[];break;default:typeof U.onClick!="function"&&typeof P.onClick=="function"&&(u.onclick=Gl)}ut(b,P);var ue;b=null;for(rt in U)if(!P.hasOwnProperty(rt)&&U.hasOwnProperty(rt)&&U[rt]!=null)if(rt==="style"){var Ee=U[rt];for(ue in Ee)Ee.hasOwnProperty(ue)&&(b||(b={}),b[ue]="")}else rt!=="dangerouslySetInnerHTML"&&rt!=="children"&&rt!=="suppressContentEditableWarning"&&rt!=="suppressHydrationWarning"&&rt!=="autoFocus"&&(s.hasOwnProperty(rt)?q||(q=[]):(q=q||[]).push(rt,null));for(rt in P){var Ie=P[rt];if(Ee=U?.[rt],P.hasOwnProperty(rt)&&Ie!==Ee&&(Ie!=null||Ee!=null))if(rt==="style")if(Ee){for(ue in Ee)!Ee.hasOwnProperty(ue)||Ie&&Ie.hasOwnProperty(ue)||(b||(b={}),b[ue]="");for(ue in Ie)Ie.hasOwnProperty(ue)&&Ee[ue]!==Ie[ue]&&(b||(b={}),b[ue]=Ie[ue])}else b||(q||(q=[]),q.push(rt,b)),b=Ie;else rt==="dangerouslySetInnerHTML"?(Ie=Ie?Ie.__html:void 0,Ee=Ee?Ee.__html:void 0,Ie!=null&&Ee!==Ie&&(q=q||[]).push(rt,Ie)):rt==="children"?typeof Ie!="string"&&typeof Ie!="number"||(q=q||[]).push(rt,""+Ie):rt!=="suppressContentEditableWarning"&&rt!=="suppressHydrationWarning"&&(s.hasOwnProperty(rt)?(Ie!=null&&rt==="onScroll"&&dn("scroll",u),q||Ee===Ie||(q=[])):(q=q||[]).push(rt,Ie))}b&&(q=q||[]).push("style",b);var rt=q;(h.updateQueue=rt)&&(h.flags|=4)}},zS=function(u,h,b,P){b!==P&&(h.flags|=4)};function pg(u,h){if(!Zr)switch(u.tailMode){case"hidden":h=u.tail;for(var b=null;h!==null;)h.alternate!==null&&(b=h),h=h.sibling;b===null?u.tail=null:b.sibling=null;break;case"collapsed":b=u.tail;for(var P=null;b!==null;)b.alternate!==null&&(P=b),b=b.sibling;P===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:P.sibling=null}}function ka(u){var h=u.alternate!==null&&u.alternate.child===u.child,b=0,P=0;if(h)for(var U=u.child;U!==null;)b|=U.lanes|U.childLanes,P|=U.subtreeFlags&14680064,P|=U.flags&14680064,U.return=u,U=U.sibling;else for(U=u.child;U!==null;)b|=U.lanes|U.childLanes,P|=U.subtreeFlags,P|=U.flags,U.return=u,U=U.sibling;return u.subtreeFlags|=P,u.childLanes=b,h}function ZF(u,h,b){var P=h.pendingProps;switch(vs(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ka(h),null;case 1:return Ws(h.type)&&Vc(),ka(h),null;case 3:return P=h.stateNode,Sn(),fn($s),fn(Fs),zs(),P.pendingContext&&(P.context=P.pendingContext,P.pendingContext=null),(u===null||u.child===null)&&(fd(h)?h.flags|=4:u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Ka!==null&&(Sv(Ka),Ka=null))),fv(u,h),ka(h),null;case 5:To(h);var U=is(Un.current);if(b=h.type,u!==null&&h.stateNode!=null)WS(u,h,b,P,U),u.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!P){if(h.stateNode===null)throw Error(r(166));return ka(h),null}if(u=is(sn.current),fd(h)){P=h.stateNode,b=h.type;var q=h.memoizedProps;switch(P[ci]=h,P[cd]=q,u=(h.mode&1)!==0,b){case"dialog":dn("cancel",P),dn("close",P);break;case"iframe":case"object":case"embed":dn("load",P);break;case"video":case"audio":for(U=0;U<el.length;U++)dn(el[U],P);break;case"source":dn("error",P);break;case"img":case"image":case"link":dn("error",P),dn("load",P);break;case"details":dn("toggle",P);break;case"input":Xe(P,q),dn("invalid",P);break;case"select":P._wrapperState={wasMultiple:!!q.multiple},dn("invalid",P);break;case"textarea":ct(P,q),dn("invalid",P)}ut(b,q),U=null;for(var ue in q)if(q.hasOwnProperty(ue)){var Ee=q[ue];ue==="children"?typeof Ee=="string"?P.textContent!==Ee&&(q.suppressHydrationWarning!==!0&&od(P.textContent,Ee,u),U=["children",Ee]):typeof Ee=="number"&&P.textContent!==""+Ee&&(q.suppressHydrationWarning!==!0&&od(P.textContent,Ee,u),U=["children",""+Ee]):s.hasOwnProperty(ue)&&Ee!=null&&ue==="onScroll"&&dn("scroll",P)}switch(b){case"input":Oe(P),We(P,q,!0);break;case"textarea":Oe(P),wt(P);break;case"select":case"option":break;default:typeof q.onClick=="function"&&(P.onclick=Gl)}P=U,h.updateQueue=P,P!==null&&(h.flags|=4)}else{ue=U.nodeType===9?U:U.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=Ft(b)),u==="http://www.w3.org/1999/xhtml"?b==="script"?(u=ue.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof P.is=="string"?u=ue.createElement(b,{is:P.is}):(u=ue.createElement(b),b==="select"&&(ue=u,P.multiple?ue.multiple=!0:P.size&&(ue.size=P.size))):u=ue.createElementNS(u,b),u[ci]=h,u[cd]=P,$S(u,h,!1,!1),h.stateNode=u;e:{switch(ue=St(b,P),b){case"dialog":dn("cancel",u),dn("close",u),U=P;break;case"iframe":case"object":case"embed":dn("load",u),U=P;break;case"video":case"audio":for(U=0;U<el.length;U++)dn(el[U],u);U=P;break;case"source":dn("error",u),U=P;break;case"img":case"image":case"link":dn("error",u),dn("load",u),U=P;break;case"details":dn("toggle",u),U=P;break;case"input":Xe(u,P),U=Ke(u,P),dn("invalid",u);break;case"option":U=P;break;case"select":u._wrapperState={wasMultiple:!!P.multiple},U=Y({},P,{value:void 0}),dn("invalid",u);break;case"textarea":ct(u,P),U=Ge(u,P),dn("invalid",u);break;default:U=P}ut(b,U),Ee=U;for(q in Ee)if(Ee.hasOwnProperty(q)){var Ie=Ee[q];q==="style"?Be(u,Ie):q==="dangerouslySetInnerHTML"?(Ie=Ie?Ie.__html:void 0,Ie!=null&&At(u,Ie)):q==="children"?typeof Ie=="string"?(b!=="textarea"||Ie!=="")&&gt(u,Ie):typeof Ie=="number"&&gt(u,""+Ie):q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&q!=="autoFocus"&&(s.hasOwnProperty(q)?Ie!=null&&q==="onScroll"&&dn("scroll",u):Ie!=null&&_(u,q,Ie,ue))}switch(b){case"input":Oe(u),We(u,P,!1);break;case"textarea":Oe(u),wt(u);break;case"option":P.value!=null&&u.setAttribute("value",""+le(P.value));break;case"select":u.multiple=!!P.multiple,q=P.value,q!=null?De(u,!!P.multiple,q,!1):P.defaultValue!=null&&De(u,!!P.multiple,P.defaultValue,!0);break;default:typeof U.onClick=="function"&&(u.onclick=Gl)}switch(b){case"button":case"input":case"select":case"textarea":P=!!P.autoFocus;break e;case"img":P=!0;break e;default:P=!1}}P&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return ka(h),null;case 6:if(u&&h.stateNode!=null)zS(u,h,u.memoizedProps,P);else{if(typeof P!="string"&&h.stateNode===null)throw Error(r(166));if(b=is(Un.current),is(sn.current),fd(h)){if(P=h.stateNode,b=h.memoizedProps,P[ci]=h,(q=P.nodeValue!==b)&&(u=Va,u!==null))switch(u.tag){case 3:od(P.nodeValue,b,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&od(P.nodeValue,b,(u.mode&1)!==0)}q&&(h.flags|=4)}else P=(b.nodeType===9?b:b.ownerDocument).createTextNode(P),P[ci]=h,h.stateNode=P}return ka(h),null;case 13:if(fn(hn),P=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(Zr&&Lt!==null&&(h.mode&1)!==0&&(h.flags&128)===0)ag(),Zl(),h.flags|=98560,q=!1;else if(q=fd(h),P!==null&&P.dehydrated!==null){if(u===null){if(!q)throw Error(r(318));if(q=h.memoizedState,q=q!==null?q.dehydrated:null,!q)throw Error(r(317));q[ci]=h}else Zl(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;ka(h),q=!1}else Ka!==null&&(Sv(Ka),Ka=null),q=!0;if(!q)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=b,h):(P=P!==null,P!==(u!==null&&u.memoizedState!==null)&&P&&(h.child.flags|=8192,(h.mode&1)!==0&&(u===null||(hn.current&1)!==0?Ds===0&&(Ds=3):Tv())),h.updateQueue!==null&&(h.flags|=4),ka(h),null);case 4:return Sn(),fv(u,h),u===null&&zl(h.stateNode.containerInfo),ka(h),null;case 10:return sh(h.type._context),ka(h),null;case 17:return Ws(h.type)&&Vc(),ka(h),null;case 19:if(fn(hn),q=h.memoizedState,q===null)return ka(h),null;if(P=(h.flags&128)!==0,ue=q.rendering,ue===null)if(P)pg(q,!1);else{if(Ds!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(ue=eu(u),ue!==null){for(h.flags|=128,pg(q,!1),P=ue.updateQueue,P!==null&&(h.updateQueue=P,h.flags|=4),h.subtreeFlags=0,P=b,b=h.child;b!==null;)q=b,u=P,q.flags&=14680066,ue=q.alternate,ue===null?(q.childLanes=0,q.lanes=u,q.child=null,q.subtreeFlags=0,q.memoizedProps=null,q.memoizedState=null,q.updateQueue=null,q.dependencies=null,q.stateNode=null):(q.childLanes=ue.childLanes,q.lanes=ue.lanes,q.child=ue.child,q.subtreeFlags=0,q.deletions=null,q.memoizedProps=ue.memoizedProps,q.memoizedState=ue.memoizedState,q.updateQueue=ue.updateQueue,q.type=ue.type,u=ue.dependencies,q.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),b=b.sibling;return nn(hn,hn.current&1|2),h.child}u=u.sibling}q.tail!==null&&ze()>vh&&(h.flags|=128,P=!0,pg(q,!1),h.lanes=4194304)}else{if(!P)if(u=eu(ue),u!==null){if(h.flags|=128,P=!0,b=u.updateQueue,b!==null&&(h.updateQueue=b,h.flags|=4),pg(q,!0),q.tail===null&&q.tailMode==="hidden"&&!ue.alternate&&!Zr)return ka(h),null}else 2*ze()-q.renderingStartTime>vh&&b!==1073741824&&(h.flags|=128,P=!0,pg(q,!1),h.lanes=4194304);q.isBackwards?(ue.sibling=h.child,h.child=ue):(b=q.last,b!==null?b.sibling=ue:h.child=ue,q.last=ue)}return q.tail!==null?(h=q.tail,q.rendering=h,q.tail=h.sibling,q.renderingStartTime=ze(),h.sibling=null,b=hn.current,nn(hn,P?b&1|2:b&1),h):(ka(h),null);case 22:case 23:return Cv(),P=h.memoizedState!==null,u!==null&&u.memoizedState!==null!==P&&(h.flags|=8192),P&&(h.mode&1)!==0?(Fi&1073741824)!==0&&(ka(h),h.subtreeFlags&6&&(h.flags|=8192)):ka(h),null;case 24:return null;case 25:return null}throw Error(r(156,h.tag))}function eP(u,h){switch(vs(h),h.tag){case 1:return Ws(h.type)&&Vc(),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return Sn(),fn($s),fn(Fs),zs(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 5:return To(h),null;case 13:if(fn(hn),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(r(340));Zl()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return fn(hn),null;case 4:return Sn(),null;case 10:return sh(h.type._context),null;case 22:case 23:return Cv(),null;case 24:return null;default:return null}}var Px=!1,Ca=!1,tP=typeof WeakSet=="function"?WeakSet:Set,Yt=null;function xh(u,h){var b=u.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(P){Xn(u,h,P)}else b.current=null}function hv(u,h,b){try{b()}catch(P){Xn(u,h,P)}}var HS=!1;function rP(u,h){if(Z0=jf,u=ss(),Wc(u)){if("selectionStart"in u)var b={start:u.selectionStart,end:u.selectionEnd};else e:{b=(b=u.ownerDocument)&&b.defaultView||window;var P=b.getSelection&&b.getSelection();if(P&&P.rangeCount!==0){b=P.anchorNode;var U=P.anchorOffset,q=P.focusNode;P=P.focusOffset;try{b.nodeType,q.nodeType}catch{b=null;break e}var ue=0,Ee=-1,Ie=-1,rt=0,_t=0,Tt=u,vt=null;t:for(;;){for(var Vt;Tt!==b||U!==0&&Tt.nodeType!==3||(Ee=ue+U),Tt!==q||P!==0&&Tt.nodeType!==3||(Ie=ue+P),Tt.nodeType===3&&(ue+=Tt.nodeValue.length),(Vt=Tt.firstChild)!==null;)vt=Tt,Tt=Vt;for(;;){if(Tt===u)break t;if(vt===b&&++rt===U&&(Ee=ue),vt===q&&++_t===P&&(Ie=ue),(Vt=Tt.nextSibling)!==null)break;Tt=vt,vt=Tt.parentNode}Tt=Vt}b=Ee===-1||Ie===-1?null:{start:Ee,end:Ie}}else b=null}b=b||{start:0,end:0}}else b=null;for(eg={focusedElem:u,selectionRange:b},jf=!1,Yt=h;Yt!==null;)if(h=Yt,u=h.child,(h.subtreeFlags&1028)!==0&&u!==null)u.return=h,Yt=u;else for(;Yt!==null;){h=Yt;try{var Jt=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(Jt!==null){var er=Jt.memoizedProps,cs=Jt.memoizedState,qe=h.stateNode,Le=qe.getSnapshotBeforeUpdate(h.elementType===h.type?er:Ps(h.type,er),cs);qe.__reactInternalSnapshotBeforeUpdate=Le}break;case 3:var Je=h.stateNode.containerInfo;Je.nodeType===1?Je.textContent="":Je.nodeType===9&&Je.documentElement&&Je.removeChild(Je.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(jt){Xn(h,h.return,jt)}if(u=h.sibling,u!==null){u.return=h.return,Yt=u;break}Yt=h.return}return Jt=HS,HS=!1,Jt}function xg(u,h,b){var P=h.updateQueue;if(P=P!==null?P.lastEffect:null,P!==null){var U=P=P.next;do{if((U.tag&u)===u){var q=U.destroy;U.destroy=void 0,q!==void 0&&hv(h,b,q)}U=U.next}while(U!==P)}}function Dx(u,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var b=h=h.next;do{if((b.tag&u)===u){var P=b.create;b.destroy=P()}b=b.next}while(b!==h)}}function gv(u){var h=u.ref;if(h!==null){var b=u.stateNode;switch(u.tag){case 5:u=b;break;default:u=b}typeof h=="function"?h(u):h.current=u}}function GS(u){var h=u.alternate;h!==null&&(u.alternate=null,GS(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&(delete h[ci],delete h[cd],delete h[Yf],delete h[xx],delete h[yx])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function VS(u){return u.tag===5||u.tag===3||u.tag===4}function KS(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||VS(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function mv(u,h,b){var P=u.tag;if(P===5||P===6)u=u.stateNode,h?b.nodeType===8?b.parentNode.insertBefore(u,h):b.insertBefore(u,h):(b.nodeType===8?(h=b.parentNode,h.insertBefore(u,b)):(h=b,h.appendChild(u)),b=b._reactRootContainer,b!=null||h.onclick!==null||(h.onclick=Gl));else if(P!==4&&(u=u.child,u!==null))for(mv(u,h,b),u=u.sibling;u!==null;)mv(u,h,b),u=u.sibling}function pv(u,h,b){var P=u.tag;if(P===5||P===6)u=u.stateNode,h?b.insertBefore(u,h):b.appendChild(u);else if(P!==4&&(u=u.child,u!==null))for(pv(u,h,b),u=u.sibling;u!==null;)pv(u,h,b),u=u.sibling}var ca=null,Ao=!1;function uu(u,h,b){for(b=b.child;b!==null;)qS(u,h,b),b=b.sibling}function qS(u,h,b){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(yr,b)}catch{}switch(b.tag){case 5:Ca||xh(b,h);case 6:var P=ca,U=Ao;ca=null,uu(u,h,b),ca=P,Ao=U,ca!==null&&(Ao?(u=ca,b=b.stateNode,u.nodeType===8?u.parentNode.removeChild(b):u.removeChild(b)):ca.removeChild(b.stateNode));break;case 18:ca!==null&&(Ao?(u=ca,b=b.stateNode,u.nodeType===8?Xf(u.parentNode,b):u.nodeType===1&&Xf(u,b),wa(u)):Xf(ca,b.stateNode));break;case 4:P=ca,U=Ao,ca=b.stateNode.containerInfo,Ao=!0,uu(u,h,b),ca=P,Ao=U;break;case 0:case 11:case 14:case 15:if(!Ca&&(P=b.updateQueue,P!==null&&(P=P.lastEffect,P!==null))){U=P=P.next;do{var q=U,ue=q.destroy;q=q.tag,ue!==void 0&&((q&2)!==0||(q&4)!==0)&&hv(b,h,ue),U=U.next}while(U!==P)}uu(u,h,b);break;case 1:if(!Ca&&(xh(b,h),P=b.stateNode,typeof P.componentWillUnmount=="function"))try{P.props=b.memoizedProps,P.state=b.memoizedState,P.componentWillUnmount()}catch(Ee){Xn(b,h,Ee)}uu(u,h,b);break;case 21:uu(u,h,b);break;case 22:b.mode&1?(Ca=(P=Ca)||b.memoizedState!==null,uu(u,h,b),Ca=P):uu(u,h,b);break;default:uu(u,h,b)}}function XS(u){var h=u.updateQueue;if(h!==null){u.updateQueue=null;var b=u.stateNode;b===null&&(b=u.stateNode=new tP),h.forEach(function(P){var U=dP.bind(null,u,P);b.has(P)||(b.add(P),P.then(U,U))})}}function jo(u,h){var b=h.deletions;if(b!==null)for(var P=0;P<b.length;P++){var U=b[P];try{var q=u,ue=h,Ee=ue;e:for(;Ee!==null;){switch(Ee.tag){case 5:ca=Ee.stateNode,Ao=!1;break e;case 3:ca=Ee.stateNode.containerInfo,Ao=!0;break e;case 4:ca=Ee.stateNode.containerInfo,Ao=!0;break e}Ee=Ee.return}if(ca===null)throw Error(r(160));qS(q,ue,U),ca=null,Ao=!1;var Ie=U.alternate;Ie!==null&&(Ie.return=null),U.return=null}catch(rt){Xn(U,h,rt)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)YS(h,u),h=h.sibling}function YS(u,h){var b=u.alternate,P=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(jo(h,u),hl(u),P&4){try{xg(3,u,u.return),Dx(3,u)}catch(er){Xn(u,u.return,er)}try{xg(5,u,u.return)}catch(er){Xn(u,u.return,er)}}break;case 1:jo(h,u),hl(u),P&512&&b!==null&&xh(b,b.return);break;case 5:if(jo(h,u),hl(u),P&512&&b!==null&&xh(b,b.return),u.flags&32){var U=u.stateNode;try{gt(U,"")}catch(er){Xn(u,u.return,er)}}if(P&4&&(U=u.stateNode,U!=null)){var q=u.memoizedProps,ue=b!==null?b.memoizedProps:q,Ee=u.type,Ie=u.updateQueue;if(u.updateQueue=null,Ie!==null)try{Ee==="input"&&q.type==="radio"&&q.name!=null&&lt(U,q),St(Ee,ue);var rt=St(Ee,q);for(ue=0;ue<Ie.length;ue+=2){var _t=Ie[ue],Tt=Ie[ue+1];_t==="style"?Be(U,Tt):_t==="dangerouslySetInnerHTML"?At(U,Tt):_t==="children"?gt(U,Tt):_(U,_t,Tt,rt)}switch(Ee){case"input":Ye(U,q);break;case"textarea":at(U,q);break;case"select":var vt=U._wrapperState.wasMultiple;U._wrapperState.wasMultiple=!!q.multiple;var Vt=q.value;Vt!=null?De(U,!!q.multiple,Vt,!1):vt!==!!q.multiple&&(q.defaultValue!=null?De(U,!!q.multiple,q.defaultValue,!0):De(U,!!q.multiple,q.multiple?[]:"",!1))}U[cd]=q}catch(er){Xn(u,u.return,er)}}break;case 6:if(jo(h,u),hl(u),P&4){if(u.stateNode===null)throw Error(r(162));U=u.stateNode,q=u.memoizedProps;try{U.nodeValue=q}catch(er){Xn(u,u.return,er)}}break;case 3:if(jo(h,u),hl(u),P&4&&b!==null&&b.memoizedState.isDehydrated)try{wa(h.containerInfo)}catch(er){Xn(u,u.return,er)}break;case 4:jo(h,u),hl(u);break;case 13:jo(h,u),hl(u),U=u.child,U.flags&8192&&(q=U.memoizedState!==null,U.stateNode.isHidden=q,!q||U.alternate!==null&&U.alternate.memoizedState!==null||(vv=ze())),P&4&&XS(u);break;case 22:if(_t=b!==null&&b.memoizedState!==null,u.mode&1?(Ca=(rt=Ca)||_t,jo(h,u),Ca=rt):jo(h,u),hl(u),P&8192){if(rt=u.memoizedState!==null,(u.stateNode.isHidden=rt)&&!_t&&(u.mode&1)!==0)for(Yt=u,_t=u.child;_t!==null;){for(Tt=Yt=_t;Yt!==null;){switch(vt=Yt,Vt=vt.child,vt.tag){case 0:case 11:case 14:case 15:xg(4,vt,vt.return);break;case 1:xh(vt,vt.return);var Jt=vt.stateNode;if(typeof Jt.componentWillUnmount=="function"){P=vt,b=vt.return;try{h=P,Jt.props=h.memoizedProps,Jt.state=h.memoizedState,Jt.componentWillUnmount()}catch(er){Xn(P,b,er)}}break;case 5:xh(vt,vt.return);break;case 22:if(vt.memoizedState!==null){ZS(Tt);continue}}Vt!==null?(Vt.return=vt,Yt=Vt):ZS(Tt)}_t=_t.sibling}e:for(_t=null,Tt=u;;){if(Tt.tag===5){if(_t===null){_t=Tt;try{U=Tt.stateNode,rt?(q=U.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none"):(Ee=Tt.stateNode,Ie=Tt.memoizedProps.style,ue=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null,Ee.style.display=$t("display",ue))}catch(er){Xn(u,u.return,er)}}}else if(Tt.tag===6){if(_t===null)try{Tt.stateNode.nodeValue=rt?"":Tt.memoizedProps}catch(er){Xn(u,u.return,er)}}else if((Tt.tag!==22&&Tt.tag!==23||Tt.memoizedState===null||Tt===u)&&Tt.child!==null){Tt.child.return=Tt,Tt=Tt.child;continue}if(Tt===u)break e;for(;Tt.sibling===null;){if(Tt.return===null||Tt.return===u)break e;_t===Tt&&(_t=null),Tt=Tt.return}_t===Tt&&(_t=null),Tt.sibling.return=Tt.return,Tt=Tt.sibling}}break;case 19:jo(h,u),hl(u),P&4&&XS(u);break;case 21:break;default:jo(h,u),hl(u)}}function hl(u){var h=u.flags;if(h&2){try{e:{for(var b=u.return;b!==null;){if(VS(b)){var P=b;break e}b=b.return}throw Error(r(160))}switch(P.tag){case 5:var U=P.stateNode;P.flags&32&&(gt(U,""),P.flags&=-33);var q=KS(u);pv(u,q,U);break;case 3:case 4:var ue=P.stateNode.containerInfo,Ee=KS(u);mv(u,Ee,ue);break;default:throw Error(r(161))}}catch(Ie){Xn(u,u.return,Ie)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function nP(u,h,b){Yt=u,JS(u)}function JS(u,h,b){for(var P=(u.mode&1)!==0;Yt!==null;){var U=Yt,q=U.child;if(U.tag===22&&P){var ue=U.memoizedState!==null||Px;if(!ue){var Ee=U.alternate,Ie=Ee!==null&&Ee.memoizedState!==null||Ca;Ee=Px;var rt=Ca;if(Px=ue,(Ca=Ie)&&!rt)for(Yt=U;Yt!==null;)ue=Yt,Ie=ue.child,ue.tag===22&&ue.memoizedState!==null?ek(U):Ie!==null?(Ie.return=ue,Yt=Ie):ek(U);for(;q!==null;)Yt=q,JS(q),q=q.sibling;Yt=U,Px=Ee,Ca=rt}QS(u)}else(U.subtreeFlags&8772)!==0&&q!==null?(q.return=U,Yt=q):QS(u)}}function QS(u){for(;Yt!==null;){var h=Yt;if((h.flags&8772)!==0){var b=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:Ca||Dx(5,h);break;case 1:var P=h.stateNode;if(h.flags&4&&!Ca)if(b===null)P.componentDidMount();else{var U=h.elementType===h.type?b.memoizedProps:Ps(h.type,b.memoizedProps);P.componentDidUpdate(U,b.memoizedState,P.__reactInternalSnapshotBeforeUpdate)}var q=h.updateQueue;q!==null&&Rn(h,q,P);break;case 3:var ue=h.updateQueue;if(ue!==null){if(b=null,h.child!==null)switch(h.child.tag){case 5:b=h.child.stateNode;break;case 1:b=h.child.stateNode}Rn(h,ue,b)}break;case 5:var Ee=h.stateNode;if(b===null&&h.flags&4){b=Ee;var Ie=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":Ie.autoFocus&&b.focus();break;case"img":Ie.src&&(b.src=Ie.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var rt=h.alternate;if(rt!==null){var _t=rt.memoizedState;if(_t!==null){var Tt=_t.dehydrated;Tt!==null&&wa(Tt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Ca||h.flags&512&&gv(h)}catch(vt){Xn(h,h.return,vt)}}if(h===u){Yt=null;break}if(b=h.sibling,b!==null){b.return=h.return,Yt=b;break}Yt=h.return}}function ZS(u){for(;Yt!==null;){var h=Yt;if(h===u){Yt=null;break}var b=h.sibling;if(b!==null){b.return=h.return,Yt=b;break}Yt=h.return}}function ek(u){for(;Yt!==null;){var h=Yt;try{switch(h.tag){case 0:case 11:case 15:var b=h.return;try{Dx(4,h)}catch(Ie){Xn(h,b,Ie)}break;case 1:var P=h.stateNode;if(typeof P.componentDidMount=="function"){var U=h.return;try{P.componentDidMount()}catch(Ie){Xn(h,U,Ie)}}var q=h.return;try{gv(h)}catch(Ie){Xn(h,q,Ie)}break;case 5:var ue=h.return;try{gv(h)}catch(Ie){Xn(h,ue,Ie)}}}catch(Ie){Xn(h,h.return,Ie)}if(h===u){Yt=null;break}var Ee=h.sibling;if(Ee!==null){Ee.return=h.return,Yt=Ee;break}Yt=h.return}}var sP=Math.ceil,Rx=N.ReactCurrentDispatcher,xv=N.ReactCurrentOwner,Qi=N.ReactCurrentBatchConfig,Vr=0,Ks=null,ws=null,ua=0,Fi=0,yh=So(0),Ds=0,yg=null,wd=0,Ix=0,yv=0,vg=null,fi=null,vv=0,vh=1/0,sc=null,Mx=!1,wv=null,du=null,Lx=!1,fu=null,Ox=0,wg=0,_v=null,Bx=-1,Ux=0;function Ja(){return(Vr&6)!==0?ze():Bx!==-1?Bx:Bx=ze()}function hu(u){return(u.mode&1)===0?1:(Vr&2)!==0&&ua!==0?ua&-ua:ig.transition!==null?(Ux===0&&(Ux=Dn()),Ux):(u=zr,u!==0||(u=window.event,u=u===void 0?16:ex(u.type)),u)}function Fo(u,h,b,P){if(50<wg)throw wg=0,_v=null,Error(r(185));Pl(u,b,P),((Vr&2)===0||u!==Ks)&&(u===Ks&&((Vr&2)===0&&(Ix|=b),Ds===4&&gu(u,ua)),hi(u,P),b===1&&Vr===0&&(h.mode&1)===0&&(vh=ze()+500,Kc&&sl()))}function hi(u,h){var b=u.callbackNode;Fl(u,h);var P=va(u,u===Ks?ua:0);if(P===0)b!==null&&Ve(b),u.callbackNode=null,u.callbackPriority=0;else if(h=P&-P,u.callbackPriority!==h){if(b!=null&&Ve(b),h===1)u.tag===0?ko(rk.bind(null,u)):dd(rk.bind(null,u)),mx(function(){(Vr&6)===0&&sl()}),b=null;else{switch(Xu(P)){case 1:b=Bt;break;case 4:b=sr;break;case 16:b=rr;break;case 536870912:b=Lr;break;default:b=rr}b=uk(b,tk.bind(null,u))}u.callbackPriority=h,u.callbackNode=b}}function tk(u,h){if(Bx=-1,Ux=0,(Vr&6)!==0)throw Error(r(327));var b=u.callbackNode;if(wh()&&u.callbackNode!==b)return null;var P=va(u,u===Ks?ua:0);if(P===0)return null;if((P&30)!==0||(P&u.expiredLanes)!==0||h)h=$x(u,P);else{h=P;var U=Vr;Vr|=2;var q=sk();(Ks!==u||ua!==h)&&(sc=null,vh=ze()+500,bd(u,h));do try{oP();break}catch(Ee){nk(u,Ee)}while(!0);nh(),Rx.current=q,Vr=U,ws!==null?h=0:(Ks=null,ua=0,h=Ds)}if(h!==0){if(h===2&&(U=Bs(u),U!==0&&(P=U,h=bv(u,U))),h===1)throw b=yg,bd(u,0),gu(u,P),hi(u,ze()),b;if(h===6)gu(u,P);else{if(U=u.current.alternate,(P&30)===0&&!aP(U)&&(h=$x(u,P),h===2&&(q=Bs(u),q!==0&&(P=q,h=bv(u,q))),h===1))throw b=yg,bd(u,0),gu(u,P),hi(u,ze()),b;switch(u.finishedWork=U,u.finishedLanes=P,h){case 0:case 1:throw Error(r(345));case 2:Sd(u,fi,sc);break;case 3:if(gu(u,P),(P&130023424)===P&&(h=vv+500-ze(),10<h)){if(va(u,0)!==0)break;if(U=u.suspendedLanes,(U&P)!==P){Ja(),u.pingedLanes|=u.suspendedLanes&U;break}u.timeoutHandle=Ha(Sd.bind(null,u,fi,sc),h);break}Sd(u,fi,sc);break;case 4:if(gu(u,P),(P&4194240)===P)break;for(h=u.eventTimes,U=-1;0<P;){var ue=31-he(P);q=1<<ue,ue=h[ue],ue>U&&(U=ue),P&=~q}if(P=U,P=ze()-P,P=(120>P?120:480>P?480:1080>P?1080:1920>P?1920:3e3>P?3e3:4320>P?4320:1960*sP(P/1960))-P,10<P){u.timeoutHandle=Ha(Sd.bind(null,u,fi,sc),P);break}Sd(u,fi,sc);break;case 5:Sd(u,fi,sc);break;default:throw Error(r(329))}}}return hi(u,ze()),u.callbackNode===b?tk.bind(null,u):null}function bv(u,h){var b=vg;return u.current.memoizedState.isDehydrated&&(bd(u,h).flags|=256),u=$x(u,h),u!==2&&(h=fi,fi=b,h!==null&&Sv(h)),u}function Sv(u){fi===null?fi=u:fi.push.apply(fi,u)}function aP(u){for(var h=u;;){if(h.flags&16384){var b=h.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var P=0;P<b.length;P++){var U=b[P],q=U.getSnapshot;U=U.value;try{if(!ba(q(),U))return!1}catch{return!1}}}if(b=h.child,h.subtreeFlags&16384&&b!==null)b.return=h,h=b;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function gu(u,h){for(h&=~yv,h&=~Ix,u.suspendedLanes|=h,u.pingedLanes&=~h,u=u.expirationTimes;0<h;){var b=31-he(h),P=1<<b;u[b]=-1,h&=~P}}function rk(u){if((Vr&6)!==0)throw Error(r(327));wh();var h=va(u,0);if((h&1)===0)return hi(u,ze()),null;var b=$x(u,h);if(u.tag!==0&&b===2){var P=Bs(u);P!==0&&(h=P,b=bv(u,P))}if(b===1)throw b=yg,bd(u,0),gu(u,h),hi(u,ze()),b;if(b===6)throw Error(r(345));return u.finishedWork=u.current.alternate,u.finishedLanes=h,Sd(u,fi,sc),hi(u,ze()),null}function kv(u,h){var b=Vr;Vr|=1;try{return u(h)}finally{Vr=b,Vr===0&&(vh=ze()+500,Kc&&sl())}}function _d(u){fu!==null&&fu.tag===0&&(Vr&6)===0&&wh();var h=Vr;Vr|=1;var b=Qi.transition,P=zr;try{if(Qi.transition=null,zr=1,u)return u()}finally{zr=P,Qi.transition=b,Vr=h,(Vr&6)===0&&sl()}}function Cv(){Fi=yh.current,fn(yh)}function bd(u,h){u.finishedWork=null,u.finishedLanes=0;var b=u.timeoutHandle;if(b!==-1&&(u.timeoutHandle=-1,rg(b)),ws!==null)for(b=ws.return;b!==null;){var P=b;switch(vs(P),P.tag){case 1:P=P.type.childContextTypes,P!=null&&Vc();break;case 3:Sn(),fn($s),fn(Fs),zs();break;case 5:To(P);break;case 4:Sn();break;case 13:fn(hn);break;case 19:fn(hn);break;case 10:sh(P.type._context);break;case 22:case 23:Cv()}b=b.return}if(Ks=u,ws=u=mu(u.current,null),ua=Fi=h,Ds=0,yg=null,yv=Ix=wd=0,fi=vg=null,Ki!==null){for(h=0;h<Ki.length;h++)if(b=Ki[h],P=b.interleaved,P!==null){b.interleaved=null;var U=P.next,q=b.pending;if(q!==null){var ue=q.next;q.next=U,P.next=ue}b.pending=P}Ki=null}return u}function nk(u,h){do{var b=ws;try{if(nh(),tu.current=iu,ji){for(var P=rn.memoizedState;P!==null;){var U=P.queue;U!==null&&(U.pending=null),P=P.next}ji=!1}if(oa=0,Kn=In=rn=null,cl=!1,di=0,xv.current=null,b===null||b.return===null){Ds=1,yg=h,ws=null;break}e:{var q=u,ue=b.return,Ee=b,Ie=h;if(h=ua,Ee.flags|=32768,Ie!==null&&typeof Ie=="object"&&typeof Ie.then=="function"){var rt=Ie,_t=Ee,Tt=_t.tag;if((_t.mode&1)===0&&(Tt===0||Tt===11||Tt===15)){var vt=_t.alternate;vt?(_t.updateQueue=vt.updateQueue,_t.memoizedState=vt.memoizedState,_t.lanes=vt.lanes):(_t.updateQueue=null,_t.memoizedState=null)}var Vt=j(ue);if(Vt!==null){Vt.flags&=-257,M(Vt,ue,Ee,q,h),Vt.mode&1&&x(q,rt,h),h=Vt,Ie=rt;var Jt=h.updateQueue;if(Jt===null){var er=new Set;er.add(Ie),h.updateQueue=er}else Jt.add(Ie);break e}else{if((h&1)===0){x(q,rt,h),Tv();break e}Ie=Error(r(426))}}else if(Zr&&Ee.mode&1){var cs=j(ue);if(cs!==null){(cs.flags&65536)===0&&(cs.flags|=256),M(cs,ue,Ee,q,h),hd(nc(Ie,Ee));break e}}q=Ie=nc(Ie,Ee),Ds!==4&&(Ds=2),vg===null?vg=[q]:vg.push(q),q=ue;do{switch(q.tag){case 3:q.flags|=65536,h&=-h,q.lanes|=h;var qe=Fx(q,Ie,h);xd(q,qe);break e;case 1:Ee=Ie;var Le=q.type,Je=q.stateNode;if((q.flags&128)===0&&(typeof Le.getDerivedStateFromError=="function"||Je!==null&&typeof Je.componentDidCatch=="function"&&(du===null||!du.has(Je)))){q.flags|=65536,h&=-h,q.lanes|=h;var jt=g(q,Ee,h);xd(q,jt);break e}}q=q.return}while(q!==null)}ik(b)}catch(tr){h=tr,ws===b&&b!==null&&(ws=b=b.return);continue}break}while(!0)}function sk(){var u=Rx.current;return Rx.current=iu,u===null?iu:u}function Tv(){(Ds===0||Ds===3||Ds===2)&&(Ds=4),Ks===null||(wd&268435455)===0&&(Ix&268435455)===0||gu(Ks,ua)}function $x(u,h){var b=Vr;Vr|=2;var P=sk();(Ks!==u||ua!==h)&&(sc=null,bd(u,h));do try{iP();break}catch(U){nk(u,U)}while(!0);if(nh(),Vr=b,Rx.current=P,ws!==null)throw Error(r(261));return Ks=null,ua=0,Ds}function iP(){for(;ws!==null;)ak(ws)}function oP(){for(;ws!==null&&!Ae();)ak(ws)}function ak(u){var h=ck(u.alternate,u,Fi);u.memoizedProps=u.pendingProps,h===null?ik(u):ws=h,xv.current=null}function ik(u){var h=u;do{var b=h.alternate;if(u=h.return,(h.flags&32768)===0){if(b=ZF(b,h,Fi),b!==null){ws=b;return}}else{if(b=eP(b,h),b!==null){b.flags&=32767,ws=b;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{Ds=6,ws=null;return}}if(h=h.sibling,h!==null){ws=h;return}ws=h=u}while(h!==null);Ds===0&&(Ds=5)}function Sd(u,h,b){var P=zr,U=Qi.transition;try{Qi.transition=null,zr=1,lP(u,h,b,P)}finally{Qi.transition=U,zr=P}return null}function lP(u,h,b,P){do wh();while(fu!==null);if((Vr&6)!==0)throw Error(r(327));b=u.finishedWork;var U=u.finishedLanes;if(b===null)return null;if(u.finishedWork=null,u.finishedLanes=0,b===u.current)throw Error(r(177));u.callbackNode=null,u.callbackPriority=0;var q=b.lanes|b.childLanes;if(nv(u,q),u===Ks&&(ws=Ks=null,ua=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||Lx||(Lx=!0,uk(rr,function(){return wh(),null})),q=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||q){q=Qi.transition,Qi.transition=null;var ue=zr;zr=1;var Ee=Vr;Vr|=4,xv.current=null,rP(u,b),YS(b,u),nd(eg),jf=!!Z0,eg=Z0=null,u.current=b,nP(b),Ue(),Vr=Ee,zr=ue,Qi.transition=q}else u.current=b;if(Lx&&(Lx=!1,fu=u,Ox=U),q=u.pendingLanes,q===0&&(du=null),Ur(b.stateNode),hi(u,ze()),h!==null)for(P=u.onRecoverableError,b=0;b<h.length;b++)U=h[b],P(U.value,{componentStack:U.stack,digest:U.digest});if(Mx)throw Mx=!1,u=wv,wv=null,u;return(Ox&1)!==0&&u.tag!==0&&wh(),q=u.pendingLanes,(q&1)!==0?u===_v?wg++:(wg=0,_v=u):wg=0,sl(),null}function wh(){if(fu!==null){var u=Xu(Ox),h=Qi.transition,b=zr;try{if(Qi.transition=null,zr=16>u?16:u,fu===null)var P=!1;else{if(u=fu,fu=null,Ox=0,(Vr&6)!==0)throw Error(r(331));var U=Vr;for(Vr|=4,Yt=u.current;Yt!==null;){var q=Yt,ue=q.child;if((Yt.flags&16)!==0){var Ee=q.deletions;if(Ee!==null){for(var Ie=0;Ie<Ee.length;Ie++){var rt=Ee[Ie];for(Yt=rt;Yt!==null;){var _t=Yt;switch(_t.tag){case 0:case 11:case 15:xg(8,_t,q)}var Tt=_t.child;if(Tt!==null)Tt.return=_t,Yt=Tt;else for(;Yt!==null;){_t=Yt;var vt=_t.sibling,Vt=_t.return;if(GS(_t),_t===rt){Yt=null;break}if(vt!==null){vt.return=Vt,Yt=vt;break}Yt=Vt}}}var Jt=q.alternate;if(Jt!==null){var er=Jt.child;if(er!==null){Jt.child=null;do{var cs=er.sibling;er.sibling=null,er=cs}while(er!==null)}}Yt=q}}if((q.subtreeFlags&2064)!==0&&ue!==null)ue.return=q,Yt=ue;else e:for(;Yt!==null;){if(q=Yt,(q.flags&2048)!==0)switch(q.tag){case 0:case 11:case 15:xg(9,q,q.return)}var qe=q.sibling;if(qe!==null){qe.return=q.return,Yt=qe;break e}Yt=q.return}}var Le=u.current;for(Yt=Le;Yt!==null;){ue=Yt;var Je=ue.child;if((ue.subtreeFlags&2064)!==0&&Je!==null)Je.return=ue,Yt=Je;else e:for(ue=Le;Yt!==null;){if(Ee=Yt,(Ee.flags&2048)!==0)try{switch(Ee.tag){case 0:case 11:case 15:Dx(9,Ee)}}catch(tr){Xn(Ee,Ee.return,tr)}if(Ee===ue){Yt=null;break e}var jt=Ee.sibling;if(jt!==null){jt.return=Ee.return,Yt=jt;break e}Yt=Ee.return}}if(Vr=U,sl(),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(yr,u)}catch{}P=!0}return P}finally{zr=b,Qi.transition=h}}return!1}function ok(u,h,b){h=nc(b,h),h=Fx(u,h,1),u=Yi(u,h,1),h=Ja(),u!==null&&(Pl(u,1,h),hi(u,h))}function Xn(u,h,b){if(u.tag===3)ok(u,u,b);else for(;h!==null;){if(h.tag===3){ok(h,u,b);break}else if(h.tag===1){var P=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof P.componentDidCatch=="function"&&(du===null||!du.has(P))){u=nc(b,u),u=g(h,u,1),h=Yi(h,u,1),u=Ja(),h!==null&&(Pl(h,1,u),hi(h,u));break}}h=h.return}}function cP(u,h,b){var P=u.pingCache;P!==null&&P.delete(h),h=Ja(),u.pingedLanes|=u.suspendedLanes&b,Ks===u&&(ua&b)===b&&(Ds===4||Ds===3&&(ua&130023424)===ua&&500>ze()-vv?bd(u,0):yv|=b),hi(u,h)}function lk(u,h){h===0&&((u.mode&1)===0?h=1:(h=Er,Er<<=1,(Er&130023424)===0&&(Er=4194304)));var b=Ja();u=Xa(u,h),u!==null&&(Pl(u,h,b),hi(u,b))}function uP(u){var h=u.memoizedState,b=0;h!==null&&(b=h.retryLane),lk(u,b)}function dP(u,h){var b=0;switch(u.tag){case 13:var P=u.stateNode,U=u.memoizedState;U!==null&&(b=U.retryLane);break;case 19:P=u.stateNode;break;default:throw Error(r(314))}P!==null&&P.delete(h),lk(u,b)}var ck;ck=function(u,h,b){if(u!==null)if(u.memoizedProps!==h.pendingProps||$s.current)ee=!0;else{if((u.lanes&b)===0&&(h.flags&128)===0)return ee=!1,dv(u,h,b);ee=(u.flags&131072)!==0}else ee=!1,Zr&&(h.flags&1048576)!==0&&wx(h,il,h.index);switch(h.lanes=0,h.tag){case 2:var P=h.type;Or(u,h),u=h.pendingProps;var U=ql(h,Fs.current);Co(h,b),U=ru(null,h,P,u,U,b);var q=nu();return h.flags|=1,typeof U=="object"&&U!==null&&typeof U.render=="function"&&U.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,Ws(P)?(q=!0,Xl(h)):q=!1,h.memoizedState=U.state!==null&&U.state!==void 0?U.state:null,pd(h),U.updater=lu,h.stateNode=U,U._reactInternals=h,mh(h,P,u,b),h=en(null,h,P,!0,q,b)):(h.tag=0,Zr&&q&&qc(h),xe(null,h,U,b),h=h.child),h;case 16:P=h.elementType;e:{switch(Or(u,h),u=h.pendingProps,U=P._init,P=U(P._payload),h.type=P,U=h.tag=hP(P),u=Ps(P,u),U){case 0:h=Ut(null,h,P,u,b);break e;case 1:h=gn(null,h,P,u,b);break e;case 11:h=$e(null,h,P,u,b);break e;case 14:h=nt(null,h,P,Ps(P.type,u),b);break e}throw Error(r(306,P,""))}return h;case 0:return P=h.type,U=h.pendingProps,U=h.elementType===P?U:Ps(P,U),Ut(u,h,P,U,b);case 1:return P=h.type,U=h.pendingProps,U=h.elementType===P?U:Ps(P,U),gn(u,h,P,U,b);case 3:e:{if(la(h),u===null)throw Error(r(387));P=h.pendingProps,q=h.memoizedState,U=q.element,ih(u,h),Qc(h,P,null,b);var ue=h.memoizedState;if(P=ue.element,q.isDehydrated)if(q={element:P,isDehydrated:!1,cache:ue.cache,pendingSuspenseBoundaries:ue.pendingSuspenseBoundaries,transitions:ue.transitions},h.updateQueue.baseState=q,h.memoizedState=q,h.flags&256){U=nc(Error(r(423)),h),h=Ji(u,h,P,b,U);break e}else if(P!==U){U=nc(Error(r(424)),h),h=Ji(u,h,P,b,U);break e}else for(Lt=zi(h.stateNode.containerInfo.firstChild),Va=h,Zr=!0,Ka=null,b=ui(h,null,P,b),h.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Zl(),P===U){h=Vs(u,h,b);break e}xe(u,h,P,b)}h=h.child}return h;case 5:return Zc(h),u===null&&Xc(h),P=h.type,U=h.pendingProps,q=u!==null?u.memoizedProps:null,ue=U.children,tg(P,U)?ue=null:q!==null&&tg(P,q)&&(h.flags|=32),pr(u,h),xe(u,h,ue,b),h.child;case 6:return u===null&&Xc(h),null;case 13:return ot(u,h,b);case 4:return ll(h,h.stateNode.containerInfo),P=h.pendingProps,u===null?h.child=ec(h,null,P,b):xe(u,h,P,b),h.child;case 11:return P=h.type,U=h.pendingProps,U=h.elementType===P?U:Ps(P,U),$e(u,h,P,U,b);case 7:return xe(u,h,h.pendingProps,b),h.child;case 8:return xe(u,h,h.pendingProps.children,b),h.child;case 12:return xe(u,h,h.pendingProps.children,b),h.child;case 10:e:{if(P=h.type._context,U=h.pendingProps,q=h.memoizedProps,ue=U.value,nn(gd,P._currentValue),P._currentValue=ue,q!==null)if(ba(q.value,ue)){if(q.children===U.children&&!$s.current){h=Vs(u,h,b);break e}}else for(q=h.child,q!==null&&(q.return=h);q!==null;){var Ee=q.dependencies;if(Ee!==null){ue=q.child;for(var Ie=Ee.firstContext;Ie!==null;){if(Ie.context===P){if(q.tag===1){Ie=Xi(-1,b&-b),Ie.tag=2;var rt=q.updateQueue;if(rt!==null){rt=rt.shared;var _t=rt.pending;_t===null?Ie.next=Ie:(Ie.next=_t.next,_t.next=Ie),rt.pending=Ie}}q.lanes|=b,Ie=q.alternate,Ie!==null&&(Ie.lanes|=b),ah(q.return,b,h),Ee.lanes|=b;break}Ie=Ie.next}}else if(q.tag===10)ue=q.type===h.type?null:q.child;else if(q.tag===18){if(ue=q.return,ue===null)throw Error(r(341));ue.lanes|=b,Ee=ue.alternate,Ee!==null&&(Ee.lanes|=b),ah(ue,b,h),ue=q.sibling}else ue=q.child;if(ue!==null)ue.return=q;else for(ue=q;ue!==null;){if(ue===h){ue=null;break}if(q=ue.sibling,q!==null){q.return=ue.return,ue=q;break}ue=ue.return}q=ue}xe(u,h,U.children,b),h=h.child}return h;case 9:return U=h.type,P=h.pendingProps.children,Co(h,b),U=ia(U),P=P(U),h.flags|=1,xe(u,h,P,b),h.child;case 14:return P=h.type,U=Ps(P,h.pendingProps),U=Ps(P.type,U),nt(u,h,P,U,b);case 15:return Nt(u,h,h.type,h.pendingProps,b);case 17:return P=h.type,U=h.pendingProps,U=h.elementType===P?U:Ps(P,U),Or(u,h),h.tag=1,Ws(P)?(u=!0,Xl(h)):u=!1,Co(h,b),jx(h,P,U),mh(h,P,U,b),en(null,h,P,!0,u,b);case 19:return ls(u,h,b);case 22:return Xt(u,h,b)}throw Error(r(156,h.tag))};function uk(u,h){return Pe(u,h)}function fP(u,h,b,P){this.tag=u,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=P,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zi(u,h,b,P){return new fP(u,h,b,P)}function Ev(u){return u=u.prototype,!(!u||!u.isReactComponent)}function hP(u){if(typeof u=="function")return Ev(u)?1:0;if(u!=null){if(u=u.$$typeof,u===G)return 11;if(u===Z)return 14}return 2}function mu(u,h){var b=u.alternate;return b===null?(b=Zi(u.tag,h,u.key,u.mode),b.elementType=u.elementType,b.type=u.type,b.stateNode=u.stateNode,b.alternate=u,u.alternate=b):(b.pendingProps=h,b.type=u.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=u.flags&14680064,b.childLanes=u.childLanes,b.lanes=u.lanes,b.child=u.child,b.memoizedProps=u.memoizedProps,b.memoizedState=u.memoizedState,b.updateQueue=u.updateQueue,h=u.dependencies,b.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},b.sibling=u.sibling,b.index=u.index,b.ref=u.ref,b}function Wx(u,h,b,P,U,q){var ue=2;if(P=u,typeof u=="function")Ev(u)&&(ue=1);else if(typeof u=="string")ue=5;else e:switch(u){case R:return kd(b.children,U,q,h);case T:ue=8,U|=8;break;case D:return u=Zi(12,b,h,U|2),u.elementType=D,u.lanes=q,u;case K:return u=Zi(13,b,h,U),u.elementType=K,u.lanes=q,u;case te:return u=Zi(19,b,h,U),u.elementType=te,u.lanes=q,u;case I:return zx(b,U,q,h);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case L:ue=10;break e;case O:ue=9;break e;case G:ue=11;break e;case Z:ue=14;break e;case J:ue=16,P=null;break e}throw Error(r(130,u==null?u:typeof u,""))}return h=Zi(ue,b,h,U),h.elementType=u,h.type=P,h.lanes=q,h}function kd(u,h,b,P){return u=Zi(7,u,P,h),u.lanes=b,u}function zx(u,h,b,P){return u=Zi(22,u,P,h),u.elementType=I,u.lanes=b,u.stateNode={isHidden:!1},u}function Nv(u,h,b){return u=Zi(6,u,null,h),u.lanes=b,u}function Av(u,h,b){return h=Zi(4,u.children!==null?u.children:[],u.key,h),h.lanes=b,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}function gP(u,h,b,P,U){this.tag=h,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Us(0),this.expirationTimes=Us(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Us(0),this.identifierPrefix=P,this.onRecoverableError=U,this.mutableSourceEagerHydrationData=null}function jv(u,h,b,P,U,q,ue,Ee,Ie){return u=new gP(u,h,b,Ee,Ie),h===1?(h=1,q===!0&&(h|=8)):h=0,q=Zi(3,null,null,h),u.current=q,q.stateNode=u,q.memoizedState={element:P,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},pd(q),u}function mP(u,h,b){var P=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:A,key:P==null?null:""+P,children:u,containerInfo:h,implementation:b}}function dk(u){if(!u)return Gi;u=u._reactInternals;e:{if(oe(u)!==u||u.tag!==1)throw Error(r(170));var h=u;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(Ws(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(r(171))}if(u.tag===1){var b=u.type;if(Ws(b))return Qf(u,b,h)}return h}function fk(u,h,b,P,U,q,ue,Ee,Ie){return u=jv(b,P,!0,u,U,q,ue,Ee,Ie),u.context=dk(null),b=u.current,P=Ja(),U=hu(b),q=Xi(P,U),q.callback=h??null,Yi(b,q,U),u.current.lanes=U,Pl(u,U,P),hi(u,P),u}function Hx(u,h,b,P){var U=h.current,q=Ja(),ue=hu(U);return b=dk(b),h.context===null?h.context=b:h.pendingContext=b,h=Xi(q,ue),h.payload={element:u},P=P===void 0?null:P,P!==null&&(h.callback=P),u=Yi(U,h,ue),u!==null&&(Fo(u,U,ue,q),oh(u,U,ue)),ue}function Gx(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function hk(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var b=u.retryLane;u.retryLane=b!==0&&b<h?b:h}}function Fv(u,h){hk(u,h),(u=u.alternate)&&hk(u,h)}function pP(){return null}var gk=typeof reportError=="function"?reportError:function(u){console.error(u)};function Pv(u){this._internalRoot=u}Vx.prototype.render=Pv.prototype.render=function(u){var h=this._internalRoot;if(h===null)throw Error(r(409));Hx(u,h,null,null)},Vx.prototype.unmount=Pv.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var h=u.containerInfo;_d(function(){Hx(null,u,null,null)}),h[Hi]=null}};function Vx(u){this._internalRoot=u}Vx.prototype.unstable_scheduleHydration=function(u){if(u){var h=Jp();u={blockedOn:null,target:u,priority:h};for(var b=0;b<Wi.length&&h!==0&&h<Wi[b].priority;b++);Wi.splice(b,0,u),b===0&&Ef(u)}};function Dv(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function Kx(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function mk(){}function xP(u,h,b,P,U){if(U){if(typeof P=="function"){var q=P;P=function(){var rt=Gx(ue);q.call(rt)}}var ue=fk(h,P,u,0,null,!1,!1,"",mk);return u._reactRootContainer=ue,u[Hi]=ue.current,zl(u.nodeType===8?u.parentNode:u),_d(),ue}for(;U=u.lastChild;)u.removeChild(U);if(typeof P=="function"){var Ee=P;P=function(){var rt=Gx(Ie);Ee.call(rt)}}var Ie=jv(u,0,!1,null,null,!1,!1,"",mk);return u._reactRootContainer=Ie,u[Hi]=Ie.current,zl(u.nodeType===8?u.parentNode:u),_d(function(){Hx(h,Ie,b,P)}),Ie}function qx(u,h,b,P,U){var q=b._reactRootContainer;if(q){var ue=q;if(typeof U=="function"){var Ee=U;U=function(){var Ie=Gx(ue);Ee.call(Ie)}}Hx(h,ue,u,U)}else ue=xP(b,h,u,U,P);return Gx(ue)}Fc=function(u){switch(u.tag){case 3:var h=u.stateNode;if(h.current.memoizedState.isDehydrated){var b=vr(h.pendingLanes);b!==0&&(P0(h,b|1),hi(h,ze()),(Vr&6)===0&&(vh=ze()+500,sl()))}break;case 13:_d(function(){var P=Xa(u,1);if(P!==null){var U=Ja();Fo(P,u,1,U)}}),Fv(u,1)}},Pc=function(u){if(u.tag===13){var h=Xa(u,134217728);if(h!==null){var b=Ja();Fo(h,u,134217728,b)}Fv(u,134217728)}},Yp=function(u){if(u.tag===13){var h=hu(u),b=Xa(u,h);if(b!==null){var P=Ja();Fo(b,u,h,P)}Fv(u,h)}},Jp=function(){return zr},Cf=function(u,h){var b=zr;try{return zr=u,h()}finally{zr=b}},Te=function(u,h,b){switch(h){case"input":if(Ye(u,b),h=b.name,b.type==="radio"&&h!=null){for(b=u;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<b.length;h++){var P=b[h];if(P!==u&&P.form===u.form){var U=ys(P);if(!U)throw Error(r(90));ge(P),Ye(P,U)}}}break;case"textarea":at(u,b);break;case"select":h=b.value,h!=null&&De(u,!!b.multiple,h,!1)}},Et=kv,nr=_d;var yP={usingClientEntryPoint:!1,Events:[ud,as,ys,dt,Wt,kv]},_g={findFiberByHostInstance:rl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vP={bundleType:_g.bundleType,version:_g.version,rendererPackageName:_g.rendererPackageName,rendererConfig:_g.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=fe(u),u===null?null:u.stateNode},findFiberByHostInstance:_g.findFiberByHostInstance||pP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xx.isDisabled&&Xx.supportsFiber)try{yr=Xx.inject(vP),Tr=Xx}catch{}}return gi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yP,gi.createPortal=function(u,h){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dv(h))throw Error(r(200));return mP(u,h,null,b)},gi.createRoot=function(u,h){if(!Dv(u))throw Error(r(299));var b=!1,P="",U=gk;return h!=null&&(h.unstable_strictMode===!0&&(b=!0),h.identifierPrefix!==void 0&&(P=h.identifierPrefix),h.onRecoverableError!==void 0&&(U=h.onRecoverableError)),h=jv(u,1,!1,null,null,b,!1,P,U),u[Hi]=h.current,zl(u.nodeType===8?u.parentNode:u),new Pv(h)},gi.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(r(188)):(u=Object.keys(u).join(","),Error(r(268,u)));return u=fe(h),u=u===null?null:u.stateNode,u},gi.flushSync=function(u){return _d(u)},gi.hydrate=function(u,h,b){if(!Kx(h))throw Error(r(200));return qx(null,u,h,!0,b)},gi.hydrateRoot=function(u,h,b){if(!Dv(u))throw Error(r(405));var P=b!=null&&b.hydratedSources||null,U=!1,q="",ue=gk;if(b!=null&&(b.unstable_strictMode===!0&&(U=!0),b.identifierPrefix!==void 0&&(q=b.identifierPrefix),b.onRecoverableError!==void 0&&(ue=b.onRecoverableError)),h=fk(h,null,u,1,b??null,U,!1,q,ue),u[Hi]=h.current,zl(u),P)for(u=0;u<P.length;u++)b=P[u],U=b._getVersion,U=U(b._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[b,U]:h.mutableSourceEagerHydrationData.push(b,U);return new Vx(h)},gi.render=function(u,h,b){if(!Kx(h))throw Error(r(200));return qx(null,u,h,!1,b)},gi.unmountComponentAtNode=function(u){if(!Kx(u))throw Error(r(40));return u._reactRootContainer?(_d(function(){qx(null,null,u,!1,function(){u._reactRootContainer=null,u[Hi]=null})}),!0):!1},gi.unstable_batchedUpdates=kv,gi.unstable_renderSubtreeIntoContainer=function(u,h,b,P){if(!Kx(b))throw Error(r(200));if(u==null||u._reactInternals===void 0)throw Error(r(38));return qx(u,h,b,!1,P)},gi.version="18.3.1-next-f1338f8080-20240426",gi}var Sk;function pN(){if(Sk)return Mv.exports;Sk=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Mv.exports=EP(),Mv.exports}var kk;function NP(){if(kk)return Yx;kk=1;var e=pN();return Yx.createRoot=e.createRoot,Yx.hydrateRoot=e.hydrateRoot,Yx}var AP=NP();const jP=wp(AP);var Ck=pN();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wm(){return Wm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wm.apply(this,arguments)}var _u;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(_u||(_u={}));const Tk="popstate";function FP(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return Xw("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:yN(s)}return DP(t,r,null,e)}function Es(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function xN(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function PP(){return Math.random().toString(36).substr(2,8)}function Ek(e,t){return{usr:e.state,key:e.key,idx:t}}function Xw(e,t,r,n){return r===void 0&&(r=null),Wm({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?f0(t):t,{state:r,key:t&&t.key||n||PP()})}function yN(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function f0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function DP(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=_u.Pop,c=null,d=f();d==null&&(d=0,i.replaceState(Wm({},i.state,{idx:d}),""));function f(){return(i.state||{idx:null}).idx}function p(){o=_u.Pop;let S=f(),E=S==null?null:S-d;d=S,c&&c({action:o,location:w.location,delta:E})}function m(S,E){o=_u.Push;let k=Xw(w.location,S,E);d=f()+1;let _=Ek(k,d),N=w.createHref(k);try{i.pushState(_,"",N)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(N)}a&&c&&c({action:o,location:w.location,delta:1})}function y(S,E){o=_u.Replace;let k=Xw(w.location,S,E);d=f();let _=Ek(k,d),N=w.createHref(k);i.replaceState(_,"",N),a&&c&&c({action:o,location:w.location,delta:0})}function v(S){let E=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof S=="string"?S:yN(S);return k=k.replace(/ $/,"%20"),Es(E,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,E)}let w={get action(){return o},get location(){return e(s,i)},listen(S){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Tk,p),c=S,()=>{s.removeEventListener(Tk,p),c=null}},createHref(S){return t(s,S)},createURL:v,encodeLocation(S){let E=v(S);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:m,replace:y,go(S){return i.go(S)}};return w}var Nk;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Nk||(Nk={}));function RP(e,t,r){return r===void 0&&(r="/"),IP(e,t,r)}function IP(e,t,r,n){let s=typeof t=="string"?f0(t):t,a=_N(s.pathname||"/",r);if(a==null)return null;let i=vN(e);MP(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let d=qP(a);o=GP(i[c],d)}return o}function vN(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(Es(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Od([n,c.relativePath]),f=r.concat(c);a.children&&a.children.length>0&&(Es(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),vN(a.children,t,f,d)),!(a.path==null&&!a.index)&&t.push({path:d,score:zP(d,a.index),routesMeta:f})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of wN(a.path))s(a,i,c)}),t}function wN(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=wN(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function MP(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:HP(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const LP=/^:[\w-]+$/,OP=3,BP=2,UP=1,$P=10,WP=-2,Ak=e=>e==="*";function zP(e,t){let r=e.split("/"),n=r.length;return r.some(Ak)&&(n+=WP),t&&(n+=BP),r.filter(s=>!Ak(s)).reduce((s,a)=>s+(LP.test(a)?OP:a===""?UP:$P),n)}function HP(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function GP(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],d=o===n.length-1,f=a==="/"?t:t.slice(a.length)||"/",p=VP({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},f),m=c.route;if(!p)return null;Object.assign(s,p.params),i.push({params:s,pathname:Od([a,p.pathname]),pathnameBase:QP(Od([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=Od([a,p.pathnameBase]))}return i}function VP(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=KP(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((d,f,p)=>{let{paramName:m,isOptional:y}=f;if(m==="*"){let w=o[p]||"";i=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const v=o[p];return y&&!v?d[m]=void 0:d[m]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:i,pattern:e}}function KP(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),xN(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function qP(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return xN(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function _N(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function XP(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?f0(e):e;return{pathname:r?r.startsWith("/")?r:YP(r,t):t,search:ZP(n),hash:eD(s)}}function YP(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Bv(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function JP(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function bN(e,t){let r=JP(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function SN(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=f0(e):(s=Wm({},e),Es(!s.pathname||!s.pathname.includes("?"),Bv("?","pathname","search",s)),Es(!s.pathname||!s.pathname.includes("#"),Bv("#","pathname","hash",s)),Es(!s.search||!s.search.includes("#"),Bv("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let p=t.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}o=p>=0?t[p]:"/"}let c=XP(s,o),d=i&&i!=="/"&&i.endsWith("/"),f=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||f)&&(c.pathname+="/"),c}const Od=e=>e.join("/").replace(/\/\/+/g,"/"),QP=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ZP=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,eD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function tD(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const kN=["post","put","patch","delete"];new Set(kN);const rD=["get",...kN];new Set(rD);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zm(){return zm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zm.apply(this,arguments)}const m2=C.createContext(null),nD=C.createContext(null),_p=C.createContext(null),by=C.createContext(null),Bu=C.createContext({outlet:null,matches:[],isDataRoute:!1}),CN=C.createContext(null);function bp(){return C.useContext(by)!=null}function Sy(){return bp()||Es(!1),C.useContext(by).location}function TN(e){C.useContext(_p).static||C.useLayoutEffect(e)}function Bi(){let{isDataRoute:e}=C.useContext(Bu);return e?pD():sD()}function sD(){bp()||Es(!1);let e=C.useContext(m2),{basename:t,future:r,navigator:n}=C.useContext(_p),{matches:s}=C.useContext(Bu),{pathname:a}=Sy(),i=JSON.stringify(bN(s,r.v7_relativeSplatPath)),o=C.useRef(!1);return TN(()=>{o.current=!0}),C.useCallback(function(d,f){if(f===void 0&&(f={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let p=SN(d,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:Od([t,p.pathname])),(f.replace?n.replace:n.push)(p,f.state,f)},[t,n,i,a,e])}function p2(){let{matches:e}=C.useContext(Bu),t=e[e.length-1];return t?t.params:{}}function aD(e,t){return iD(e,t)}function iD(e,t,r,n){bp()||Es(!1);let{navigator:s}=C.useContext(_p),{matches:a}=C.useContext(Bu),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let d=Sy(),f;if(t){var p;let S=typeof t=="string"?f0(t):t;c==="/"||(p=S.pathname)!=null&&p.startsWith(c)||Es(!1),f=S}else f=d;let m=f.pathname||"/",y=m;if(c!=="/"){let S=c.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(S.length).join("/")}let v=RP(e,{pathname:y}),w=dD(v&&v.map(S=>Object.assign({},S,{params:Object.assign({},o,S.params),pathname:Od([c,s.encodeLocation?s.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?c:Od([c,s.encodeLocation?s.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),a,r,n);return t&&w?C.createElement(by.Provider,{value:{location:zm({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:_u.Pop}},w):w}function oD(){let e=mD(),t=tD(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:s},r):null,null)}const lD=C.createElement(oD,null);class cD extends C.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?C.createElement(Bu.Provider,{value:this.props.routeContext},C.createElement(CN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uD(e){let{routeContext:t,match:r,children:n}=e,s=C.useContext(m2);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),C.createElement(Bu.Provider,{value:t},n)}function dD(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let f=i.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);f>=0||Es(!1),i=i.slice(0,Math.min(i.length,f+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let p=i[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=f),p.route.id){let{loaderData:m,errors:y}=r,v=p.route.loader&&m[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||v){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((f,p,m)=>{let y,v=!1,w=null,S=null;r&&(y=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||lD,c&&(d<0&&m===0?(xD("route-fallback"),v=!0,S=null):d===m&&(v=!0,S=p.route.hydrateFallbackElement||null)));let E=t.concat(i.slice(0,m+1)),k=()=>{let _;return y?_=w:v?_=S:p.route.Component?_=C.createElement(p.route.Component,null):p.route.element?_=p.route.element:_=f,C.createElement(uD,{match:p,routeContext:{outlet:f,matches:E,isDataRoute:r!=null},children:_})};return r&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?C.createElement(cD,{location:r.location,revalidation:r.revalidation,component:w,error:y,children:k(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):k()},null)}var EN=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(EN||{}),NN=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(NN||{});function fD(e){let t=C.useContext(m2);return t||Es(!1),t}function hD(e){let t=C.useContext(nD);return t||Es(!1),t}function gD(e){let t=C.useContext(Bu);return t||Es(!1),t}function AN(e){let t=gD(),r=t.matches[t.matches.length-1];return r.route.id||Es(!1),r.route.id}function mD(){var e;let t=C.useContext(CN),r=hD(),n=AN();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function pD(){let{router:e}=fD(EN.UseNavigateStable),t=AN(NN.UseNavigateStable),r=C.useRef(!1);return TN(()=>{r.current=!0}),C.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,zm({fromRouteId:t},a)))},[e,t])}const jk={};function xD(e,t,r){jk[e]||(jk[e]=!0)}function yD(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function Zh(e){let{to:t,replace:r,state:n,relative:s}=e;bp()||Es(!1);let{future:a,static:i}=C.useContext(_p),{matches:o}=C.useContext(Bu),{pathname:c}=Sy(),d=Bi(),f=SN(t,bN(o,a.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(f);return C.useEffect(()=>d(JSON.parse(p),{replace:r,state:n,relative:s}),[d,p,s,r,n]),null}function fs(e){Es(!1)}function vD(e){let{basename:t="/",children:r=null,location:n,navigationType:s=_u.Pop,navigator:a,static:i=!1,future:o}=e;bp()&&Es(!1);let c=t.replace(/^\/*/,"/"),d=C.useMemo(()=>({basename:c,navigator:a,static:i,future:zm({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=f0(n));let{pathname:f="/",search:p="",hash:m="",state:y=null,key:v="default"}=n,w=C.useMemo(()=>{let S=_N(f,c);return S==null?null:{location:{pathname:S,search:p,hash:m,state:y,key:v},navigationType:s}},[c,f,p,m,y,v,s]);return w==null?null:C.createElement(_p.Provider,{value:d},C.createElement(by.Provider,{children:r,value:w}))}function x2(e){let{children:t,location:r}=e;return aD(Yw(t),r)}new Promise(()=>{});function Yw(e,t){t===void 0&&(t=[]);let r=[];return C.Children.forEach(e,(n,s)=>{if(!C.isValidElement(n))return;let a=[...t,s];if(n.type===C.Fragment){r.push.apply(r,Yw(n.props.children,a));return}n.type!==fs&&Es(!1),!n.props.index||!n.props.children||Es(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Yw(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const wD="6";try{window.__reactRouterVersion=wD}catch{}const _D="startTransition",Fk=CP[_D];function bD(e){let{basename:t,children:r,future:n,window:s}=e,a=C.useRef();a.current==null&&(a.current=FP({window:s,v5Compat:!0}));let i=a.current,[o,c]=C.useState({action:i.action,location:i.location}),{v7_startTransition:d}=n||{},f=C.useCallback(p=>{d&&Fk?Fk(()=>c(p)):c(p)},[c,d]);return C.useLayoutEffect(()=>i.listen(f),[i,f]),C.useEffect(()=>yD(n),[n]),C.createElement(vD,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var Pk;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Pk||(Pk={}));var Dk;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Dk||(Dk={}));const Nn={student_subjects:1800*1e3,student_active_tests:600*1e3,student_results_table:600*1e3,teacher_subjects:900*1e3,teacher_classes:900*1e3,teacher_tests:600*1e3,teacher_results_table:600*1e3,admin_users:1200*1e3,admin_teachers:1200*1e3,admin_subjects:1800*1e3,admin_academic_years:3600*1e3,admin_tests:900*1e3,admin_results_table:null,admin_teacher_id:3600*1e3,all_tests:1200*1e3,subjects_dropdown:1800*1e3,grades_classes:3600*1e3,test_progress:120*1e3,anti_cheating:120*1e3,word_matching_test:600*1e3},Mn=e=>{try{const t=localStorage.getItem(e);if(!t)return console.log("💾 Cache: No data found for key:",e),null;const{data:r,timestamp:n,ttl:s}=JSON.parse(t),a=Date.now()-n;return a>s?(console.log("💾 Cache: Data expired for key:",e,"age:",a,"ttl:",s),localStorage.removeItem(e),null):(console.log("💾 Cache: Data found for key:",e,"age:",a,"ttl:",s),r)}catch(t){return console.log("💾 Cache: Corrupted data for key:",e,t),localStorage.removeItem(e),null}},kn=(e,t,r)=>{try{console.log("💾 Cache: Setting data for key:",e,"ttl:",r),localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log("💾 Cache: Data cached successfully for key:",e)}catch{console.log("💾 Cache: Storage full, cleaning old data for key:",e),jN();try{localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log("💾 Cache: Data cached after cleanup for key:",e)}catch{console.warn("Storage full, cannot cache data")}}},jN=()=>{const e=Date.now(),t=Object.keys(localStorage);t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:o}=JSON.parse(a);e-i>o&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=e-10080*60*1e3;t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const o=localStorage.getItem(i);if(o){const{timestamp:c}=JSON.parse(o);return{key:i,timestamp:c}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,o)=>i.timestamp-o.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},y2=e=>{Object.keys(localStorage).forEach(r=>{r.includes(e)&&localStorage.removeItem(r)})},h0=(e,t,r)=>{const n=`test_progress_${e}_${t}_${r}`,s=`anti_cheating_${e}_${t}_${r}`;localStorage.removeItem(n),localStorage.removeItem(s),console.log(`Cleared test data for ${t}_${r}`)},FN=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:Nn,cleanupOldData:jN,clearTestData:h0,clearUserData:y2,getCachedData:Mn,setCachedData:kn},Symbol.toStringTag,{value:"Module"})),PN=C.createContext(),DN=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState(null),[a,i]=C.useState(localStorage.getItem("token")),[o,c]=C.useState(!1),[d,f]=C.useState(!0),[p,m]=C.useState(null);C.useEffect(()=>{console.log("[AUTH] Initializing application session..."),S()},[]),C.useEffect(()=>{if(o&&a){console.log("[AUTH] Setting up proactive token refresh...");let V=!1;const H=setInterval(async()=>{if(o&&a&&!V){V=!0;try{const X=a||localStorage.getItem("auth_token");if(X&&y(X))console.log("[AUTH] Token expired, attempting refresh..."),await v()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(X)try{const ie=JSON.parse(atob(X.split(".")[1])).exp*1e3,ae=Date.now(),Q=ie-ae;Q<300*1e3&&Q>0&&(console.log(`[AUTH] Token expires in ${Math.round(Q/1e3)} seconds, refreshing...`),await v()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(se){console.error("[AUTH] Error parsing token for expiration check:",se)}}catch(X){console.error("[AUTH] Error in proactive refresh:",X)}finally{V=!1}}},300*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(H)}}},[o,a]);const y=V=>{if(!V)return!0;try{const H=JSON.parse(atob(V.split(".")[1])),X=Date.now()/1e3;return H.exp<=X}catch(H){return console.error("[AUTH] Error decoding token:",H),!0}},v=async()=>{const V=localStorage.getItem("refresh_token");if(!V)return console.log("[AUTH] No refresh token found"),!1;try{const H=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:V})});if(H.ok){const X=await H.json();console.log("[AUTH] Token refresh successful"),localStorage.setItem("auth_token",X.accessToken),localStorage.setItem("refresh_token",X.refreshToken),localStorage.setItem("accessToken",X.accessToken);try{window.tokenManager&&(window.tokenManager.setToken(X.accessToken),X.refreshToken&&window.tokenManager.setRefreshToken(X.refreshToken))}catch{}return i(X.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",H.status),!1}catch(H){return console.error("[AUTH] Token refresh error:",H),!1}},w=async(V,H={})=>{const X=a||localStorage.getItem("auth_token");if(!X)throw new Error("No authentication token found");const se={"Content-Type":"application/json",Authorization:`Bearer ${X}`,...H.headers},ie=await fetch(V,{...H,headers:se});if(ie.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await v()){const Q=localStorage.getItem("auth_token");return se.Authorization=`Bearer ${Q}`,fetch(V,{...H,headers:se})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return ie},S=async()=>{try{console.log("[AUTH] Starting session initialization..."),f(!0);const V=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),H=localStorage.getItem("user_data")||localStorage.getItem("userData"),X=H?JSON.parse(H).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!V,hasUser:!!H,role:X}),V&&X&&H)try{const se=JSON.parse(H);if(y(V))if(console.log("[AUTH] Token expired, attempting refresh..."),await v()){console.log("[AUTH] Token refreshed successfully");const ae=localStorage.getItem("auth_token");i(ae)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(V);else i(V);s(X),r(se);try{if(window.tokenManager){window.tokenManager.setToken(localStorage.getItem("auth_token"));const ie=localStorage.getItem("refresh_token");ie&&window.tokenManager.setRefreshToken(ie)}}catch{}c(!0),await _(se,X)}catch(se){console.error("[AUTH] Error parsing stored user data:",se),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),c(!1)}}catch(V){console.error("[AUTH] Session initialization error:",V),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),c(!1)}finally{console.log("[AUTH] Session initialization complete"),f(!1)}},E=async V=>{try{if(f(!0),m(null),window.forceLogout||window.preventAutoLogin){console.log("⚠️ Login blocked - force logout in progress"),m("Please wait for the logout process to complete.");return}console.log("Attempting login with:",V.username);let H,X;V.username==="admin"?(H={ok:!0,json:()=>({success:!0,token:"test-token"})},X="admin"):(H=await authService.teacherLogin(V),X="teacher");const se=await H.json();await k(H,X,se)}catch(H){T(H)}finally{f(!1)}},k=async(V,H,X)=>{try{if(V.ok&&X.success&&X.token){i(X.token),s(H),r(X),c(!0),localStorage.setItem("auth_token",X.accessToken||X.token),localStorage.setItem("refresh_token",X.refreshToken),localStorage.setItem("user_data",JSON.stringify(X)),localStorage.setItem("accessToken",X.accessToken||X.token);try{const se=Date.now(),ie=10080*60*1e3,ae=[];for(let Q=0;Q<localStorage.length;Q++){const le=localStorage.key(Q);if(!(!le||!(le.startsWith("test_progress_")||le.startsWith("test_timer_")||le.startsWith("test_shuffle_order_")||le.startsWith("student_results_table_")||le.startsWith("anti_cheating_"))))try{const ke=localStorage.getItem(le);if(!ke){ae.push(le);continue}let Oe=null;if(ke.startsWith("{")||ke.startsWith("[")){const ge=JSON.parse(ke),ye=ge.timestamp||ge.lastSaved||ge.lastTickAt||ge.createdAt||ge.updatedAt||ge.startedAt||ge.started_at;ye&&(Oe=new Date(ye).getTime())}if(!Oe){const ge=`${le}__ts`,ye=localStorage.getItem(ge);ye&&(Oe=parseInt(ye)||null)}if(!Oe)continue;se-Oe>ie&&ae.push(le)}catch{}}ae.forEach(Q=>{try{localStorage.removeItem(Q)}catch{}})}catch(se){console.warn("LocalStorage cleanup skipped:",se)}return await _(X,H),!0}else{const se=X.message||V.statusText||"Login failed";return T(new Error(se)),!1}}catch(se){return T(se),!1}},_=async(V,H)=>{try{switch(H){case"admin":console.log("Admin login successful, role:",V.role),console.log("Admin logged in:",V);break;case"teacher":console.log("Teacher login successful, role:",V.role),console.log("Teacher data:",V.teacher),await F(V),await R();break;case"student":console.log("Student login successful"),N(V);break;default:console.warn("Unknown user role:",H)}}catch(X){console.error("Post-login actions error:",X)}},N=V=>{r(V),console.log("Student info populated:",V)},F=async V=>{r(V),console.log("Teacher info populated:",V)},A=async()=>{try{console.log("Initializing teacher cabinet...")}catch(V){console.error("Error initializing teacher cabinet:",V)}},R=async()=>{try{console.log("Checking teacher subjects...")}catch(V){console.error("Error checking teacher subjects:",V)}},T=V=>{m(V.message||"Login failed"),D()},D=()=>{m(null),f(!1)},L=C.useCallback(()=>{O()},[]),O=()=>{r(null),s(null),i(null),c(!1),m(null);const V=t?.student_id||t?.teacher_id||t?.admin_id||t?.id;V&&y2(V),localStorage.removeItem("token"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&window.tokenManager.clearAuth(),setTimeout(()=>{G()},100)},G=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},K=()=>t?.id||null,te=()=>n==="admin"?t:null,Z=()=>n==="admin",J=()=>Z()?t?.admin_id:null,I=()=>n==="teacher"?t?.username:null,W=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof E,logout:typeof L,getCurrentTeacherId:typeof K,isAdmin:typeof Z,getCurrentAdmin:typeof te,getCurrentAdminId:typeof J,getCurrentTeacherUsername:typeof I})};C.useEffect(()=>(window.logout=L,window.getCurrentTeacherId=K,window.getCurrentAdmin=te,window.isAdmin=Z,window.getCurrentAdminId=J,window.getCurrentTeacherUsername=I,window.checkFunctionAvailability=W,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[L]);const B=C.useCallback(V=>{console.log("Setting user data from external auth:",V),r(V),s(V.role),i(V.token),c(!0),f(!1),m(null),localStorage.setItem("auth_token",V.token),localStorage.setItem("user_data",JSON.stringify(V)),localStorage.setItem("accessToken",V.token)},[]),Y={user:t,role:n,token:a,isAuthenticated:o,isLoading:d,error:p,login:E,setUserData:B,logout:L,resetLoginForm:D,forceCompleteLogout:O,initializeApplicationSession:S,makeAuthenticatedRequest:w,populateStudentInfo:N,populateTeacherInfo:F,initializeTeacherCabinet:A,checkTeacherSubjects:R,getCurrentTeacherId:K,getCurrentAdmin:te,isAdmin:Z,getCurrentAdminId:J,getCurrentTeacherUsername:I,handleLoginResponse:k,handlePostLoginActions:_,handleLoginFailure:T,resetInterfaceAfterSessionClear:G,checkFunctionAvailability:W};return l.jsx(PN.Provider,{value:Y,children:e})},Gn=()=>{const e=C.useContext(PN);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};class SD{constructor(){this.baseURL="http://localhost:8888/.netlify/functions",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}getHeaders(){const t=localStorage.getItem("token");return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}async sendRequest(t,r){try{return await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error("❌ Network error:",n),n}}async request(t,r={}){const n=`${this.baseURL}${t}`,s={method:"GET",headers:this.getHeaders(),timeout:this.timeout,...r};let a;for(let i=0;i<this.retryCount;i++)try{const o=new AbortController,c=setTimeout(()=>o.abort(),this.timeout),d=await fetch(n,{...s,signal:o.signal});if(clearTimeout(c),!d.ok)throw new Error(`HTTP error! status: ${d.status}`);return await d.json()}catch(o){if(a=o,o.name==="AbortError")throw new Error("Request timeout");i<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${i+1}/${this.retryCount})`),await new Promise(c=>setTimeout(c,this.retryDelay*Math.pow(2,i))))}throw a}async get(t,r={}){return this.request(t,{...r,method:"GET"})}async post(t,r,n={}){return this.request(t,{...n,method:"POST",body:JSON.stringify(r)})}async put(t,r,n={}){return this.request(t,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(t,r={}){return this.request(t,{...r,method:"DELETE"})}async patch(t,r,n={}){return this.request(t,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(t,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${t}`,i={method:"POST",headers:{...localStorage.getItem("token")&&{Authorization:`Bearer ${localStorage.getItem("token")}`}},body:s,...n};try{const o=await fetch(a,i);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw o}}async downloadFile(t,r,n={}){const s=`${this.baseURL}${t}`,a={method:"GET",headers:this.getHeaders(),...n};try{const i=await fetch(s,a);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.blob(),c=window.URL.createObjectURL(o),d=document.createElement("a");d.href=c,d.download=r,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(c)}catch(i){throw i}}ensureDebugOutput(){let t=document.getElementById("debug-output");return t||(t=document.createElement("div"),t.id="debug-output",t.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",t.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(t)),t}async testDbConnection(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,message:"Database connection failed",error:t.message}}}async testStudentLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testTeacherLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testAdminLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetTeacherSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetClassResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentTestResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testEndpoints(){const t=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of t)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(t){const r=this.ensureDebugOutput();try{let n;switch(t){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${t}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${t}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${t}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const t=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;t.innerHTML=r}}const Yn=new SD,v2=C.createContext({});function w2(e){const t=C.useRef(null);return t.current===null&&(t.current=e()),t.current}const _2=typeof window<"u",RN=_2?C.useLayoutEffect:C.useEffect,ky=C.createContext(null);function b2(e,t){e.indexOf(t)===-1&&e.push(t)}function S2(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const _c=(e,t,r)=>r>t?t:r<e?e:r;let k2=()=>{};const bc={},IN=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function MN(e){return typeof e=="object"&&e!==null}const LN=e=>/^0[^.\s]+$/u.test(e);function C2(e){let t;return()=>(t===void 0&&(t=e()),t)}const fo=e=>e,kD=(e,t)=>r=>t(e(r)),Sp=(...e)=>e.reduce(kD),Hm=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class T2{constructor(){this.subscriptions=[]}add(t){return b2(this.subscriptions,t),()=>S2(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const bl=e=>e*1e3,Sl=e=>e/1e3;function ON(e,t){return t?e*(1e3/t):0}const BN=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,CD=1e-7,TD=12;function ED(e,t,r,n,s){let a,i,o=0;do i=t+(r-t)/2,a=BN(i,n,s)-e,a>0?r=i:t=i;while(Math.abs(a)>CD&&++o<TD);return i}function kp(e,t,r,n){if(e===t&&r===n)return fo;const s=a=>ED(a,0,1,e,r);return a=>a===0||a===1?a:BN(s(a),t,n)}const UN=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,$N=e=>t=>1-e(1-t),WN=kp(.33,1.53,.69,.99),E2=$N(WN),zN=UN(E2),HN=e=>(e*=2)<1?.5*E2(e):.5*(2-Math.pow(2,-10*(e-1))),N2=e=>1-Math.sin(Math.acos(e)),GN=$N(N2),VN=UN(N2),ND=kp(.42,0,1,1),AD=kp(0,0,.58,1),KN=kp(.42,0,.58,1),jD=e=>Array.isArray(e)&&typeof e[0]!="number",qN=e=>Array.isArray(e)&&typeof e[0]=="number",FD={linear:fo,easeIn:ND,easeInOut:KN,easeOut:AD,circIn:N2,circInOut:VN,circOut:GN,backIn:E2,backInOut:zN,backOut:WN,anticipate:HN},PD=e=>typeof e=="string",Rk=e=>{if(qN(e)){k2(e.length===4);const[t,r,n,s]=e;return kp(t,r,n,s)}else if(PD(e))return FD[e];return e},Jx=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function DD(e,t){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(f){i.has(f)&&(d.schedule(f),e()),f(o)}const d={schedule:(f,p=!1,m=!1)=>{const v=m&&s?r:n;return p&&i.add(f),v.has(f)||v.add(f),f},cancel:f=>{n.delete(f),i.delete(f)},process:f=>{if(o=f,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(c),r.clear(),s=!1,a&&(a=!1,d.process(f))}};return d}const RD=40;function XN(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=Jx.reduce((_,N)=>(_[N]=DD(a),_),{}),{setup:o,read:c,resolveKeyframes:d,preUpdate:f,update:p,preRender:m,render:y,postRender:v}=i,w=()=>{const _=bc.useManualTiming?s.timestamp:performance.now();r=!1,bc.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(_-s.timestamp,RD),1)),s.timestamp=_,s.isProcessing=!0,o.process(s),c.process(s),d.process(s),f.process(s),p.process(s),m.process(s),y.process(s),v.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(w))},S=()=>{r=!0,n=!0,s.isProcessing||e(w)};return{schedule:Jx.reduce((_,N)=>{const F=i[N];return _[N]=(A,R=!1,T=!1)=>(r||S(),F.schedule(A,R,T)),_},{}),cancel:_=>{for(let N=0;N<Jx.length;N++)i[Jx[N]].cancel(_)},state:s,steps:i}}const{schedule:Ln,cancel:Fu,state:fa,steps:Uv}=XN(typeof requestAnimationFrame<"u"?requestAnimationFrame:fo,!0);let k1;function ID(){k1=void 0}const vi={now:()=>(k1===void 0&&vi.set(fa.isProcessing||bc.useManualTiming?fa.timestamp:performance.now()),k1),set:e=>{k1=e,queueMicrotask(ID)}},YN=e=>t=>typeof t=="string"&&t.startsWith(e),A2=YN("--"),MD=YN("var(--"),j2=e=>MD(e)?LD.test(e.split("/*")[0].trim()):!1,LD=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,g0={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Gm={...g0,transform:e=>_c(0,1,e)},Qx={...g0,default:1},km=e=>Math.round(e*1e5)/1e5,F2=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function OD(e){return e==null}const BD=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,P2=(e,t)=>r=>!!(typeof r=="string"&&BD.test(r)&&r.startsWith(e)||t&&!OD(r)&&Object.prototype.hasOwnProperty.call(r,t)),JN=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(F2);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},UD=e=>_c(0,255,e),$v={...g0,transform:e=>Math.round(UD(e))},Rd={test:P2("rgb","red"),parse:JN("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+$v.transform(e)+", "+$v.transform(t)+", "+$v.transform(r)+", "+km(Gm.transform(n))+")"};function $D(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const Jw={test:P2("#"),parse:$D,transform:Rd.transform},Cp=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),wu=Cp("deg"),kl=Cp("%"),hr=Cp("px"),WD=Cp("vh"),zD=Cp("vw"),Ik={...kl,parse:e=>kl.parse(e)/100,transform:e=>kl.transform(e*100)},Dh={test:P2("hsl","hue"),parse:JN("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+kl.transform(km(t))+", "+kl.transform(km(r))+", "+km(Gm.transform(n))+")"},ks={test:e=>Rd.test(e)||Jw.test(e)||Dh.test(e),parse:e=>Rd.test(e)?Rd.parse(e):Dh.test(e)?Dh.parse(e):Jw.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Rd.transform(e):Dh.transform(e),getAnimatableNone:e=>{const t=ks.parse(e);return t.alpha=0,ks.transform(t)}},HD=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function GD(e){return isNaN(e)&&typeof e=="string"&&(e.match(F2)?.length||0)+(e.match(HD)?.length||0)>0}const QN="number",ZN="color",VD="var",KD="var(",Mk="${}",qD=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Vm(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=t.replace(qD,c=>(ks.test(c)?(n.color.push(a),s.push(ZN),r.push(ks.parse(c))):c.startsWith(KD)?(n.var.push(a),s.push(VD),r.push(c)):(n.number.push(a),s.push(QN),r.push(parseFloat(c))),++a,Mk)).split(Mk);return{values:r,split:o,indexes:n,types:s}}function e5(e){return Vm(e).values}function t5(e){const{split:t,types:r}=Vm(e),n=t.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=t[i],s[i]!==void 0){const o=r[i];o===QN?a+=km(s[i]):o===ZN?a+=ks.transform(s[i]):a+=s[i]}return a}}const XD=e=>typeof e=="number"?0:ks.test(e)?ks.getAnimatableNone(e):e;function YD(e){const t=e5(e);return t5(e)(t.map(XD))}const Pu={test:GD,parse:e5,createTransformer:t5,getAnimatableNone:YD};function Wv(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function JD({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,i=0;if(!t)s=a=i=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;s=Wv(c,o,e+1/3),a=Wv(c,o,e),i=Wv(c,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function M1(e,t){return r=>r>0?t:e}const $n=(e,t,r)=>e+(t-e)*r,zv=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},QD=[Jw,Rd,Dh],ZD=e=>QD.find(t=>t.test(e));function Lk(e){const t=ZD(e);if(!t)return!1;let r=t.parse(e);return t===Dh&&(r=JD(r)),r}const Ok=(e,t)=>{const r=Lk(e),n=Lk(t);if(!r||!n)return M1(e,t);const s={...r};return a=>(s.red=zv(r.red,n.red,a),s.green=zv(r.green,n.green,a),s.blue=zv(r.blue,n.blue,a),s.alpha=$n(r.alpha,n.alpha,a),Rd.transform(s))},Qw=new Set(["none","hidden"]);function eR(e,t){return Qw.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function tR(e,t){return r=>$n(e,t,r)}function D2(e){return typeof e=="number"?tR:typeof e=="string"?j2(e)?M1:ks.test(e)?Ok:sR:Array.isArray(e)?r5:typeof e=="object"?ks.test(e)?Ok:rR:M1}function r5(e,t){const r=[...e],n=r.length,s=e.map((a,i)=>D2(a)(a,t[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function rR(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=D2(e[s])(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function nR(e,t){const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],i=e.indexes[a][n[a]],o=e.values[i]??0;r[s]=o,n[a]++}return r}const sR=(e,t)=>{const r=Pu.createTransformer(t),n=Vm(e),s=Vm(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?Qw.has(e)&&!s.values.length||Qw.has(t)&&!n.values.length?eR(e,t):Sp(r5(nR(n,s),s.values),r):M1(e,t)};function n5(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?$n(e,t,r):D2(e)(e,t)}const aR=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>Ln.update(t,r),stop:()=>Fu(t),now:()=>fa.isProcessing?fa.timestamp:vi.now()}},s5=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let a=0;a<s;a++)n+=Math.round(e(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},L1=2e4;function R2(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<L1;)t+=r,n=e.next(t);return t>=L1?1/0:t}function iR(e,t=100,r){const n=r({...e,keyframes:[0,t]}),s=Math.min(R2(n),L1);return{type:"keyframes",ease:a=>n.next(s*a).value/t,duration:Sl(s)}}const oR=5;function a5(e,t,r){const n=Math.max(t-oR,0);return ON(r-e(n),t-n)}const Jn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Hv=.001;function lR({duration:e=Jn.duration,bounce:t=Jn.bounce,velocity:r=Jn.velocity,mass:n=Jn.mass}){let s,a,i=1-t;i=_c(Jn.minDamping,Jn.maxDamping,i),e=_c(Jn.minDuration,Jn.maxDuration,Sl(e)),i<1?(s=d=>{const f=d*i,p=f*e,m=f-r,y=Zw(d,i),v=Math.exp(-p);return Hv-m/y*v},a=d=>{const p=d*i*e,m=p*r+r,y=Math.pow(i,2)*Math.pow(d,2)*e,v=Math.exp(-p),w=Zw(Math.pow(d,2),i);return(-s(d)+Hv>0?-1:1)*((m-y)*v)/w}):(s=d=>{const f=Math.exp(-d*e),p=(d-r)*e+1;return-Hv+f*p},a=d=>{const f=Math.exp(-d*e),p=(r-d)*(e*e);return f*p});const o=5/e,c=uR(s,a,o);if(e=bl(e),isNaN(c))return{stiffness:Jn.stiffness,damping:Jn.damping,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:i*2*Math.sqrt(n*d),duration:e}}}const cR=12;function uR(e,t,r){let n=r;for(let s=1;s<cR;s++)n=n-e(n)/t(n);return n}function Zw(e,t){return e*Math.sqrt(1-t*t)}const dR=["duration","bounce"],fR=["stiffness","damping","mass"];function Bk(e,t){return t.some(r=>e[r]!==void 0)}function hR(e){let t={velocity:Jn.velocity,stiffness:Jn.stiffness,damping:Jn.damping,mass:Jn.mass,isResolvedFromDuration:!1,...e};if(!Bk(e,fR)&&Bk(e,dR))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*_c(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:Jn.mass,stiffness:s,damping:a}}else{const r=lR(e);t={...t,...r,mass:Jn.mass},t.isResolvedFromDuration=!0}return t}function O1(e=Jn.visualDuration,t=Jn.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:c,damping:d,mass:f,duration:p,velocity:m,isResolvedFromDuration:y}=hR({...r,velocity:-Sl(r.velocity||0)}),v=m||0,w=d/(2*Math.sqrt(c*f)),S=i-a,E=Sl(Math.sqrt(c/f)),k=Math.abs(S)<5;n||(n=k?Jn.restSpeed.granular:Jn.restSpeed.default),s||(s=k?Jn.restDelta.granular:Jn.restDelta.default);let _;if(w<1){const F=Zw(E,w);_=A=>{const R=Math.exp(-w*E*A);return i-R*((v+w*E*S)/F*Math.sin(F*A)+S*Math.cos(F*A))}}else if(w===1)_=F=>i-Math.exp(-E*F)*(S+(v+E*S)*F);else{const F=E*Math.sqrt(w*w-1);_=A=>{const R=Math.exp(-w*E*A),T=Math.min(F*A,300);return i-R*((v+w*E*S)*Math.sinh(T)+F*S*Math.cosh(T))/F}}const N={calculatedDuration:y&&p||null,next:F=>{const A=_(F);if(y)o.done=F>=p;else{let R=F===0?v:0;w<1&&(R=F===0?bl(v):a5(_,F,A));const T=Math.abs(R)<=n,D=Math.abs(i-A)<=s;o.done=T&&D}return o.value=o.done?i:A,o},toString:()=>{const F=Math.min(R2(N),L1),A=s5(R=>N.next(F*R).value,F,30);return F+"ms "+A},toTransition:()=>{}};return N}O1.applyToOptions=e=>{const t=iR(e,100,O1);return e.ease=t.ease,e.duration=bl(t.duration),e.type="keyframes",e};function e_({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:c,restDelta:d=.5,restSpeed:f}){const p=e[0],m={done:!1,value:p},y=T=>o!==void 0&&T<o||c!==void 0&&T>c,v=T=>o===void 0?c:c===void 0||Math.abs(o-T)<Math.abs(c-T)?o:c;let w=r*t;const S=p+w,E=i===void 0?S:i(S);E!==S&&(w=E-p);const k=T=>-w*Math.exp(-T/n),_=T=>E+k(T),N=T=>{const D=k(T),L=_(T);m.done=Math.abs(D)<=d,m.value=m.done?E:L};let F,A;const R=T=>{y(m.value)&&(F=T,A=O1({keyframes:[m.value,v(m.value)],velocity:a5(_,T,m.value),damping:s,stiffness:a,restDelta:d,restSpeed:f}))};return R(0),{calculatedDuration:null,next:T=>{let D=!1;return!A&&F===void 0&&(D=!0,N(T),R(T)),F!==void 0&&T>=F?A.next(T-F):(!D&&N(T),m)}}}function gR(e,t,r){const n=[],s=r||bc.mix||n5,a=e.length-1;for(let i=0;i<a;i++){let o=s(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||fo:t;o=Sp(c,o)}n.push(o)}return n}function mR(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(k2(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=gR(t,n,s),c=o.length,d=f=>{if(i&&f<e[0])return t[0];let p=0;if(c>1)for(;p<e.length-2&&!(f<e[p+1]);p++);const m=Hm(e[p],e[p+1],f);return o[p](m)};return r?f=>d(_c(e[0],e[a-1],f)):d}function pR(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Hm(0,t,n);e.push($n(r,1,s))}}function xR(e){const t=[0];return pR(t,e.length-1),t}function yR(e,t){return e.map(r=>r*t)}function vR(e,t){return e.map(()=>t||KN).splice(0,e.length-1)}function Cm({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=jD(n)?n.map(Rk):Rk(n),a={done:!1,value:t[0]},i=yR(r&&r.length===t.length?r:xR(t),e),o=mR(i,t,{ease:Array.isArray(s)?s:vR(t,s)});return{calculatedDuration:e,next:c=>(a.value=o(c),a.done=c>=e,a)}}const wR=e=>e!==null;function I2(e,{repeat:t,repeatType:r="loop"},n,s=1){const a=e.filter(wR),o=s<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const _R={decay:e_,inertia:e_,tween:Cm,keyframes:Cm,spring:O1};function i5(e){typeof e.type=="string"&&(e.type=_R[e.type])}class M2{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const bR=e=>e/100;class L2 extends M2{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==vi.now()&&this.tick(vi.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;i5(t);const{type:r=Cm,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=t;let{keyframes:o}=t;const c=r||Cm;c!==Cm&&typeof o[0]!="number"&&(this.mixKeyframes=Sp(bR,n5(o[0],o[1])),o=[0,100]);const d=c({...t,keyframes:o});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...o].reverse(),velocity:-i})),d.calculatedDuration===null&&(d.calculatedDuration=R2(d));const{calculatedDuration:f}=d;this.calculatedDuration=f,this.resolvedDuration=f+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=d}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:d=0,keyframes:f,repeat:p,repeatType:m,repeatDelay:y,type:v,onUpdate:w,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const E=this.currentTime-d*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?E<0:E>s;this.currentTime=Math.max(E,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let _=this.currentTime,N=n;if(p){const T=Math.min(this.currentTime,s)/o;let D=Math.floor(T),L=T%1;!L&&T>=1&&(L=1),L===1&&D--,D=Math.min(D,p+1),!!(D%2)&&(m==="reverse"?(L=1-L,y&&(L-=y/o)):m==="mirror"&&(N=i)),_=_c(0,1,L)*o}const F=k?{done:!1,value:f[0]}:N.next(_);a&&(F.value=a(F.value));let{done:A}=F;!k&&c!==null&&(A=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&A);return R&&v!==e_&&(F.value=I2(f,this.options,S,this.speed)),w&&w(F.value),R&&this.finish(),F}then(t,r){return this.finished.then(t,r)}get duration(){return Sl(this.calculatedDuration)}get time(){return Sl(this.currentTime)}set time(t){t=bl(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(vi.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Sl(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=aR,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(vi.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function SR(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Id=e=>e*180/Math.PI,t_=e=>{const t=Id(Math.atan2(e[1],e[0]));return r_(t)},kR={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:t_,rotateZ:t_,skewX:e=>Id(Math.atan(e[1])),skewY:e=>Id(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},r_=e=>(e=e%360,e<0&&(e+=360),e),Uk=t_,$k=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Wk=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),CR={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:$k,scaleY:Wk,scale:e=>($k(e)+Wk(e))/2,rotateX:e=>r_(Id(Math.atan2(e[6],e[5]))),rotateY:e=>r_(Id(Math.atan2(-e[2],e[0]))),rotateZ:Uk,rotate:Uk,skewX:e=>Id(Math.atan(e[4])),skewY:e=>Id(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function n_(e){return e.includes("scale")?1:0}function s_(e,t){if(!e||e==="none")return n_(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=CR,s=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=kR,s=o}if(!s)return n_(t);const a=n[t],i=s[1].split(",").map(ER);return typeof a=="function"?a(i):i[a]}const TR=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return s_(r,t)};function ER(e){return parseFloat(e.trim())}const m0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],p0=new Set(m0),zk=e=>e===g0||e===hr,NR=new Set(["x","y","z"]),AR=m0.filter(e=>!NR.has(e));function jR(e){const t=[];return AR.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const Bd={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>s_(t,"x"),y:(e,{transform:t})=>s_(t,"y")};Bd.translateX=Bd.x;Bd.translateY=Bd.y;const Ud=new Set;let a_=!1,i_=!1,o_=!1;function o5(){if(i_){const e=Array.from(Ud).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=jR(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{n.getValue(a)?.set(i)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}i_=!1,a_=!1,Ud.forEach(e=>e.complete(o_)),Ud.clear()}function l5(){Ud.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(i_=!0)})}function FR(){o_=!0,l5(),o5(),o_=!1}class O2{constructor(t,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Ud.add(this),a_||(a_=!0,Ln.read(l5),Ln.resolveKeyframes(o5))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;if(t[0]===null){const a=s?.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(n&&r){const o=n.readValue(r,i);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=i),s&&a===void 0&&s.set(t[0])}SR(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Ud.delete(this)}cancel(){this.state==="scheduled"&&(Ud.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const PR=e=>e.startsWith("--");function DR(e,t,r){PR(t)?e.style.setProperty(t,r):e.style[t]=r}const RR=C2(()=>window.ScrollTimeline!==void 0),IR={};function MR(e,t){const r=C2(e);return()=>IR[t]??r()}const c5=MR(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ym=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,Hk={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ym([0,.65,.55,1]),circOut:ym([.55,0,1,.45]),backIn:ym([.31,.01,.66,-.59]),backOut:ym([.33,1.53,.69,.99])};function u5(e,t){if(e)return typeof e=="function"?c5()?s5(e,t):"ease-out":qN(e)?ym(e):Array.isArray(e)?e.map(r=>u5(r,t)||Hk.easeOut):Hk[e]}function LR(e,t,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:c}={},d=void 0){const f={[t]:r};c&&(f.offset=c);const p=u5(o,s);Array.isArray(p)&&(f.easing=p);const m={delay:n,duration:s,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),e.animate(f,m)}function d5(e){return typeof e=="function"&&"applyToOptions"in e}function OR({type:e,...t}){return d5(e)&&c5()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class BR extends M2{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,k2(typeof t.type!="string");const d=OR(t);this.animation=LR(r,n,s,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const f=I2(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(f):DR(r,n,f),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return Sl(Number(t))}get time(){return Sl(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=bl(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&RR()?(this.animation.timeline=t,fo):r(this)}}const f5={anticipate:HN,backInOut:zN,circInOut:VN};function UR(e){return e in f5}function $R(e){typeof e.ease=="string"&&UR(e.ease)&&(e.ease=f5[e.ease])}const Gk=10;class WR extends BR{constructor(t){$R(t),i5(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new L2({...i,autoplay:!1}),c=bl(this.finishedTime??this.time);r.setWithVelocity(o.sample(c-Gk).value,o.sample(c).value,Gk),o.stop()}}const Vk=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Pu.test(e)||e==="0")&&!e.startsWith("url("));function zR(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function HR(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=Vk(s,t),o=Vk(a,t);return!i||!o?!1:zR(e)||(r==="spring"||d5(r))&&n}function l_(e){e.duration=0,e.type}const GR=new Set(["opacity","clipPath","filter","transform"]),VR=C2(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function KR(e){const{motionValue:t,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=t.owner.getProps();return VR()&&r&&GR.has(r)&&(r!=="transform"||!d)&&!c&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const qR=40;class XR extends M2{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:c,motionValue:d,element:f,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=vi.now();const m={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:c,motionValue:d,element:f,...p},y=f?.KeyframeResolver||O2;this.keyframeResolver=new y(o,(v,w,S)=>this.onKeyframesResolved(v,w,m,!S),c,d,f),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:c,isHandoff:d,onUpdate:f}=n;this.resolvedAt=vi.now(),HR(t,a,i,o)||((bc.instantAnimations||!c)&&f?.(I2(t,n,r)),t[0]=t[t.length-1],l_(n),n.repeat=0);const m={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>qR?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},y=!d&&KR(m)?new WR({...m,element:m.motionValue.owner.current}):new L2(m);y.finished.then(()=>this.notifyFinished()).catch(fo),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),FR()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const YR=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function JR(e){const t=YR.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function h5(e,t,r=1){const[n,s]=JR(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const i=a.trim();return IN(i)?parseFloat(i):i}return j2(s)?h5(s,t,r+1):s}function B2(e,t){return e?.[t]??e?.default??e}const g5=new Set(["width","height","top","left","right","bottom",...m0]),QR={test:e=>e==="auto",parse:e=>e},m5=e=>t=>t.test(e),p5=[g0,hr,kl,wu,zD,WD,QR],Kk=e=>p5.find(m5(e));function ZR(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||LN(e):!0}const e7=new Set(["brightness","contrast","saturate","opacity"]);function t7(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(F2)||[];if(!n)return e;const s=r.replace(n,"");let a=e7.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const r7=/\b([a-z-]*)\(.*?\)/gu,c_={...Pu,getAnimatableNone:e=>{const t=e.match(r7);return t?t.map(t7).join(" "):e}},qk={...g0,transform:Math.round},n7={rotate:wu,rotateX:wu,rotateY:wu,rotateZ:wu,scale:Qx,scaleX:Qx,scaleY:Qx,scaleZ:Qx,skew:wu,skewX:wu,skewY:wu,distance:hr,translateX:hr,translateY:hr,translateZ:hr,x:hr,y:hr,z:hr,perspective:hr,transformPerspective:hr,opacity:Gm,originX:Ik,originY:Ik,originZ:hr},U2={borderWidth:hr,borderTopWidth:hr,borderRightWidth:hr,borderBottomWidth:hr,borderLeftWidth:hr,borderRadius:hr,radius:hr,borderTopLeftRadius:hr,borderTopRightRadius:hr,borderBottomRightRadius:hr,borderBottomLeftRadius:hr,width:hr,maxWidth:hr,height:hr,maxHeight:hr,top:hr,right:hr,bottom:hr,left:hr,padding:hr,paddingTop:hr,paddingRight:hr,paddingBottom:hr,paddingLeft:hr,margin:hr,marginTop:hr,marginRight:hr,marginBottom:hr,marginLeft:hr,backgroundPositionX:hr,backgroundPositionY:hr,...n7,zIndex:qk,fillOpacity:Gm,strokeOpacity:Gm,numOctaves:qk},s7={...U2,color:ks,backgroundColor:ks,outlineColor:ks,fill:ks,stroke:ks,borderColor:ks,borderTopColor:ks,borderRightColor:ks,borderBottomColor:ks,borderLeftColor:ks,filter:c_,WebkitFilter:c_},x5=e=>s7[e];function y5(e,t){let r=x5(e);return r!==c_&&(r=Pu),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const a7=new Set(["auto","none","0"]);function i7(e,t,r){let n=0,s;for(;n<e.length&&!s;){const a=e[n];typeof a=="string"&&!a7.has(a)&&Vm(a).values.length&&(s=e[n]),n++}if(s&&r)for(const a of t)e[a]=y5(r,s)}class o7 extends O2{constructor(t,r,n,s,a){super(t,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let d=t[c];if(typeof d=="string"&&(d=d.trim(),j2(d))){const f=h5(d,r.current);f!==void 0&&(t[c]=f),c===t.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!g5.has(n)||t.length!==2)return;const[s,a]=t,i=Kk(s),o=Kk(a);if(i!==o)if(zk(i)&&zk(o))for(let c=0;c<t.length;c++){const d=t[c];typeof d=="string"&&(t[c]=parseFloat(d))}else Bd[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||ZR(t[s]))&&n.push(s);n.length&&i7(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Bd[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=Bd[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,c])=>{t.getValue(o).set(c)}),this.resolveNoneKeyframes()}}function l7(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const s=r?.[e]??n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const v5=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function w5(e){return MN(e)&&"offsetHeight"in e}const Xk=30,c7=e=>!isNaN(parseFloat(e));class u7{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=vi.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=vi.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=c7(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new T2);const n=this.events[t].add(r);return t==="change"?()=>{n(),Ln.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=vi.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Xk)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Xk);return ON(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function e0(e,t){return new u7(e,t)}const{schedule:$2}=XN(queueMicrotask,!1),Ro={x:!1,y:!1};function _5(){return Ro.x||Ro.y}function d7(e){return e==="x"||e==="y"?Ro[e]?null:(Ro[e]=!0,()=>{Ro[e]=!1}):Ro.x||Ro.y?null:(Ro.x=Ro.y=!0,()=>{Ro.x=Ro.y=!1})}function b5(e,t){const r=l7(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function Yk(e){return!(e.pointerType==="touch"||_5())}function f7(e,t,r={}){const[n,s,a]=b5(e,r),i=o=>{if(!Yk(o))return;const{target:c}=o,d=t(c,o);if(typeof d!="function"||!c)return;const f=p=>{Yk(p)&&(d(p),c.removeEventListener("pointerleave",f))};c.addEventListener("pointerleave",f,s)};return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const S5=(e,t)=>t?e===t?!0:S5(e,t.parentElement):!1,W2=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,h7=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function g7(e){return h7.has(e.tagName)||e.tabIndex!==-1}const C1=new WeakSet;function Jk(e){return t=>{t.key==="Enter"&&e(t)}}function Gv(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const m7=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=Jk(()=>{if(C1.has(r))return;Gv(r,"down");const s=Jk(()=>{Gv(r,"up")}),a=()=>Gv(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function Qk(e){return W2(e)&&!_5()}function p7(e,t,r={}){const[n,s,a]=b5(e,r),i=o=>{const c=o.currentTarget;if(!Qk(o))return;C1.add(c);const d=t(c,o),f=(y,v)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),C1.has(c)&&C1.delete(c),Qk(y)&&typeof d=="function"&&d(y,{success:v})},p=y=>{f(y,c===window||c===document||r.useGlobalTarget||S5(c,y.target))},m=y=>{f(y,!1)};window.addEventListener("pointerup",p,s),window.addEventListener("pointercancel",m,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),w5(o)&&(o.addEventListener("focus",d=>m7(d,s)),!g7(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function k5(e){return MN(e)&&"ownerSVGElement"in e}function x7(e){return k5(e)&&e.tagName==="svg"}const Pa=e=>!!(e&&e.getVelocity),y7=[...p5,ks,Pu],v7=e=>y7.find(m5(e)),z2=C.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class w7 extends C.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=w5(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function _7({children:e,isPresent:t,anchorX:r,root:n}){const s=C.useId(),a=C.useRef(null),i=C.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=C.useContext(z2);return C.useInsertionEffect(()=>{const{width:c,height:d,top:f,left:p,right:m}=i.current;if(t||!a.current||!c||!d)return;const y=r==="left"?`left: ${p}`:`right: ${m}`;a.current.dataset.motionPopId=s;const v=document.createElement("style");o&&(v.nonce=o);const w=n??document.head;return w.appendChild(v),v.sheet&&v.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            ${y}px !important;
            top: ${f}px !important;
          }
        `),()=>{w.contains(v)&&w.removeChild(v)}},[t]),l.jsx(w7,{isPresent:t,childRef:a,sizeRef:i,children:C.cloneElement(e,{ref:a})})}const b7=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:o,root:c})=>{const d=w2(S7),f=C.useId();let p=!0,m=C.useMemo(()=>(p=!1,{id:f,initial:t,isPresent:r,custom:s,onExitComplete:y=>{d.set(y,!0);for(const v of d.values())if(!v)return;n&&n()},register:y=>(d.set(y,!1),()=>d.delete(y))}),[r,d,n]);return a&&p&&(m={...m}),C.useMemo(()=>{d.forEach((y,v)=>d.set(v,!1))},[r]),C.useEffect(()=>{!r&&!d.size&&n&&n()},[r]),i==="popLayout"&&(e=l.jsx(_7,{isPresent:r,anchorX:o,root:c,children:e})),l.jsx(ky.Provider,{value:m,children:e})};function S7(){return new Map}function C5(e=!0){const t=C.useContext(ky);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,a=C.useId();C.useEffect(()=>{if(e)return s(a)},[e]);const i=C.useCallback(()=>e&&n&&n(a),[a,n,e]);return!r&&n?[!1,i]:[!0]}const Zx=e=>e.key||"";function Zk(e){const t=[];return C.Children.forEach(e,r=>{C.isValidElement(r)&&t.push(r)}),t}const yi=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:c})=>{const[d,f]=C5(i),p=C.useMemo(()=>Zk(e),[e]),m=i&&!d?[]:p.map(Zx),y=C.useRef(!0),v=C.useRef(p),w=w2(()=>new Map),[S,E]=C.useState(p),[k,_]=C.useState(p);RN(()=>{y.current=!1,v.current=p;for(let A=0;A<k.length;A++){const R=Zx(k[A]);m.includes(R)?w.delete(R):w.get(R)!==!0&&w.set(R,!1)}},[k,m.length,m.join("-")]);const N=[];if(p!==S){let A=[...p];for(let R=0;R<k.length;R++){const T=k[R],D=Zx(T);m.includes(D)||(A.splice(R,0,T),N.push(T))}return a==="wait"&&N.length&&(A=N),_(Zk(A)),E(p),null}const{forceRender:F}=C.useContext(v2);return l.jsx(l.Fragment,{children:k.map(A=>{const R=Zx(A),T=i&&!d?!1:p===k||m.includes(R),D=()=>{if(w.has(R))w.set(R,!0);else return;let L=!0;w.forEach(O=>{O||(L=!1)}),L&&(F?.(),_(v.current),i&&f?.(),n&&n())};return l.jsx(b7,{isPresent:T,initial:!y.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:a,root:c,onExitComplete:T?void 0:D,anchorX:o,children:A},R)})})},T5=C.createContext({strict:!1}),eC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},t0={};for(const e in eC)t0[e]={isEnabled:t=>eC[e].some(r=>!!t[r])};function k7(e){for(const t in e)t0[t]={...t0[t],...e[t]}}const C7=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function B1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||C7.has(e)}let E5=e=>!B1(e);function T7(e){typeof e=="function"&&(E5=t=>t.startsWith("on")?!B1(t):e(t))}try{T7(require("@emotion/is-prop-valid").default)}catch{}function E7(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(E5(s)||r===!0&&B1(s)||!t&&!B1(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}const Cy=C.createContext({});function Ty(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Km(e){return typeof e=="string"||Array.isArray(e)}const H2=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],G2=["initial",...H2];function Ey(e){return Ty(e.animate)||G2.some(t=>Km(e[t]))}function N5(e){return!!(Ey(e)||e.variants)}function N7(e,t){if(Ey(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Km(r)?r:void 0,animate:Km(n)?n:void 0}}return e.inherit!==!1?t:{}}function A7(e){const{initial:t,animate:r}=N7(e,C.useContext(Cy));return C.useMemo(()=>({initial:t,animate:r}),[tC(t),tC(r)])}function tC(e){return Array.isArray(e)?e.join(" "):e}const qm={};function j7(e){for(const t in e)qm[t]=e[t],A2(t)&&(qm[t].isCSSVariable=!0)}function A5(e,{layout:t,layoutId:r}){return p0.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!qm[e]||e==="opacity")}const F7={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},P7=m0.length;function D7(e,t,r){let n="",s=!0;for(let a=0;a<P7;a++){const i=m0[a],o=e[i];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(i.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||r){const d=v5(o,U2[i]);if(!c){s=!1;const f=F7[i]||i;n+=`${f}(${d}) `}r&&(t[i]=d)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function V2(e,t,r){const{style:n,vars:s,transformOrigin:a}=e;let i=!1,o=!1;for(const c in t){const d=t[c];if(p0.has(c)){i=!0;continue}else if(A2(c)){s[c]=d;continue}else{const f=v5(d,U2[c]);c.startsWith("origin")?(o=!0,a[c]=f):n[c]=f}}if(t.transform||(i||r?n.transform=D7(t,e.transform,r):n.transform&&(n.transform="none")),o){const{originX:c="50%",originY:d="50%",originZ:f=0}=a;n.transformOrigin=`${c} ${d} ${f}`}}const K2=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function j5(e,t,r){for(const n in t)!Pa(t[n])&&!A5(n,r)&&(e[n]=t[n])}function R7({transformTemplate:e},t){return C.useMemo(()=>{const r=K2();return V2(r,t,e),Object.assign({},r.vars,r.style)},[t])}function I7(e,t){const r=e.style||{},n={};return j5(n,r,e),Object.assign(n,R7(e,t)),n}function M7(e,t){const r={},n=I7(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const L7={offset:"stroke-dashoffset",array:"stroke-dasharray"},O7={offset:"strokeDashoffset",array:"strokeDasharray"};function B7(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?L7:O7;e[a.offset]=hr.transform(-n);const i=hr.transform(t),o=hr.transform(r);e[a.array]=`${i} ${o}`}function F5(e,{attrX:t,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...o},c,d,f){if(V2(e,o,d),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:m}=e;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=f?.transformBox??"fill-box",delete p.transformBox),t!==void 0&&(p.x=t),r!==void 0&&(p.y=r),n!==void 0&&(p.scale=n),s!==void 0&&B7(p,s,a,i,!1)}const P5=()=>({...K2(),attrs:{}}),D5=e=>typeof e=="string"&&e.toLowerCase()==="svg";function U7(e,t,r,n){const s=C.useMemo(()=>{const a=P5();return F5(a,t,D5(n),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};j5(a,e.style,e),s.style={...a,...s.style}}return s}const $7=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function q2(e){return typeof e!="string"||e.includes("-")?!1:!!($7.indexOf(e)>-1||/[A-Z]/u.test(e))}function W7(e,t,r,{latestValues:n},s,a=!1){const o=(q2(e)?U7:M7)(t,n,s,e),c=E7(t,typeof e=="string",a),d=e!==C.Fragment?{...c,...o,ref:r}:{},{children:f}=t,p=C.useMemo(()=>Pa(f)?f.get():f,[f]);return C.createElement(e,{...d,children:p})}function rC(e){const t=[{},{}];return e?.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function X2(e,t,r,n){if(typeof t=="function"){const[s,a]=rC(n);t=t(r!==void 0?r:e.custom,s,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,a]=rC(n);t=t(r!==void 0?r:e.custom,s,a)}return t}function T1(e){return Pa(e)?e.get():e}function z7({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,s){return{latestValues:H7(r,n,s,e),renderState:t()}}function H7(e,t,r,n){const s={},a=n(e,{});for(const m in a)s[m]=T1(a[m]);let{initial:i,animate:o}=e;const c=Ey(e),d=N5(e);t&&d&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let f=r?r.initial===!1:!1;f=f||i===!1;const p=f?o:i;if(p&&typeof p!="boolean"&&!Ty(p)){const m=Array.isArray(p)?p:[p];for(let y=0;y<m.length;y++){const v=X2(e,m[y]);if(v){const{transitionEnd:w,transition:S,...E}=v;for(const k in E){let _=E[k];if(Array.isArray(_)){const N=f?_.length-1:0;_=_[N]}_!==null&&(s[k]=_)}for(const k in w)s[k]=w[k]}}}return s}const R5=e=>(t,r)=>{const n=C.useContext(Cy),s=C.useContext(ky),a=()=>z7(e,t,n,s);return r?a():w2(a)};function Y2(e,t,r){const{style:n}=e,s={};for(const a in n)(Pa(n[a])||t.style&&Pa(t.style[a])||A5(a,e)||r?.getValue(a)?.liveStyle!==void 0)&&(s[a]=n[a]);return s}const G7=R5({scrapeMotionValuesFromProps:Y2,createRenderState:K2});function I5(e,t,r){const n=Y2(e,t,r);for(const s in e)if(Pa(e[s])||Pa(t[s])){const a=m0.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=e[s]}return n}const V7=R5({scrapeMotionValuesFromProps:I5,createRenderState:P5}),K7=Symbol.for("motionComponentSymbol");function Rh(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function q7(e,t,r){return C.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Rh(r)&&(r.current=n))},[t])}const J2=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),X7="framerAppearId",M5="data-"+J2(X7),L5=C.createContext({});function Y7(e,t,r,n,s){const{visualElement:a}=C.useContext(Cy),i=C.useContext(T5),o=C.useContext(ky),c=C.useContext(z2).reducedMotion,d=C.useRef(null);n=n||i.renderer,!d.current&&n&&(d.current=n(e,{visualState:t,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const f=d.current,p=C.useContext(L5);f&&!f.projection&&s&&(f.type==="html"||f.type==="svg")&&J7(d.current,r,s,p);const m=C.useRef(!1);C.useInsertionEffect(()=>{f&&m.current&&f.update(r,o)});const y=r[M5],v=C.useRef(!!y&&!window.MotionHandoffIsComplete?.(y)&&window.MotionHasOptimisedAnimation?.(y));return RN(()=>{f&&(m.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),v.current&&f.animationState&&f.animationState.animateChanges())}),C.useEffect(()=>{f&&(!v.current&&f.animationState&&f.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(y)}),v.current=!1),f.enteringChildren=void 0)}),f}function J7(e,t,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:d,layoutCrossfade:f}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:O5(e.parent)),e.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&Rh(o),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:f,layoutScroll:c,layoutRoot:d})}function O5(e){if(e)return e.options.allowProjection!==!1?e.projection:O5(e.parent)}function Vv(e,{forwardMotionProps:t=!1}={},r,n){r&&k7(r);const s=q2(e)?V7:G7;function a(o,c){let d;const f={...C.useContext(z2),...o,layoutId:Q7(o)},{isStatic:p}=f,m=A7(o),y=s(o,p);if(!p&&_2){Z7();const v=e9(f);d=v.MeasureLayout,m.visualElement=Y7(e,y,f,n,v.ProjectionNode)}return l.jsxs(Cy.Provider,{value:m,children:[d&&m.visualElement?l.jsx(d,{visualElement:m.visualElement,...f}):null,W7(e,o,q7(y,m.visualElement,c),y,p,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=C.forwardRef(a);return i[K7]=e,i}function Q7({layoutId:e}){const t=C.useContext(v2).id;return t&&e!==void 0?t+"-"+e:e}function Z7(e,t){C.useContext(T5).strict}function e9(e){const{drag:t,layout:r}=t0;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function t9(e,t){if(typeof Proxy>"u")return Vv;const r=new Map,n=(a,i)=>Vv(a,i,e,t),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,Vv(i,void 0,e,t)),r.get(i))})}function B5({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function r9({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function n9(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function Kv(e){return e===void 0||e===1}function u_({scale:e,scaleX:t,scaleY:r}){return!Kv(e)||!Kv(t)||!Kv(r)}function Ad(e){return u_(e)||U5(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function U5(e){return nC(e.x)||nC(e.y)}function nC(e){return e&&e!=="0%"}function U1(e,t,r){const n=e-r,s=t*n;return r+s}function sC(e,t,r,n,s){return s!==void 0&&(e=U1(e,s,n)),U1(e,r,n)+t}function d_(e,t=0,r=1,n,s){e.min=sC(e.min,t,r,n,s),e.max=sC(e.max,t,r,n,s)}function $5(e,{x:t,y:r}){d_(e.x,t.translate,t.scale,t.originPoint),d_(e.y,r.translate,r.scale,r.originPoint)}const aC=.999999999999,iC=1.0000000000001;function s9(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Mh(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,$5(e,i)),n&&Ad(a.latestValues)&&Mh(e,a.latestValues))}t.x<iC&&t.x>aC&&(t.x=1),t.y<iC&&t.y>aC&&(t.y=1)}function Ih(e,t){e.min=e.min+t,e.max=e.max+t}function oC(e,t,r,n,s=.5){const a=$n(e.min,e.max,s);d_(e,t,r,a,n)}function Mh(e,t){oC(e.x,t.x,t.scaleX,t.scale,t.originX),oC(e.y,t.y,t.scaleY,t.scale,t.originY)}function W5(e,t){return B5(n9(e.getBoundingClientRect(),t))}function a9(e,t,r){const n=W5(e,r),{scroll:s}=t;return s&&(Ih(n.x,s.offset.x),Ih(n.y,s.offset.y)),n}const lC=()=>({translate:0,scale:1,origin:0,originPoint:0}),Lh=()=>({x:lC(),y:lC()}),cC=()=>({min:0,max:0}),ds=()=>({x:cC(),y:cC()}),f_={current:null},z5={current:!1};function i9(){if(z5.current=!0,!!_2)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>f_.current=e.matches;e.addEventListener("change",t),t()}else f_.current=!1}const o9=new WeakMap;function l9(e,t,r){for(const n in t){const s=t[n],a=r[n];if(Pa(s))e.addValue(n,s);else if(Pa(a))e.addValue(n,e0(s,{owner:e}));else if(a!==s)if(e.hasValue(n)){const i=e.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=e.getStaticValue(n);e.addValue(n,e0(i!==void 0?i:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const uC=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class c9{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=O2,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=vi.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,Ln.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=d,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=Ey(r),this.isVariantNode=N5(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:f,...p}=this.scrapeMotionValuesFromProps(r,{},this);for(const m in p){const y=p[m];c[m]!==void 0&&Pa(y)&&y.set(c[m])}}mount(t){this.current=t,o9.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),z5.current||i9(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:f_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Fu(this.notifyUpdate),Fu(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=p0.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Ln.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in t0){const r=t0[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ds()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<uC.length;n++){const s=uC[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=t[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=l9(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=e0(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(IN(n)||LN(n))?n=parseFloat(n):!v7(n)&&Pu.test(r)&&(n=y5(t,r)),this.setBaseTarget(t,Pa(n)?n.get():n)),Pa(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=X2(this.props,r,this.presenceContext?.custom);a&&(n=a[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Pa(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new T2),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){$2.render(this.render)}}class H5 extends c9{constructor(){super(...arguments),this.KeyframeResolver=o7}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Pa(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function G5(e,{style:t,vars:r},n,s){const a=e.style;let i;for(i in t)a[i]=t[i];s?.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function u9(e){return window.getComputedStyle(e)}class d9 extends H5{constructor(){super(...arguments),this.type="html",this.renderInstance=G5}readValueFromInstance(t,r){if(p0.has(r))return this.projection?.isProjecting?n_(r):TR(t,r);{const n=u9(t),s=(A2(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return W5(t,r)}build(t,r,n){V2(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return Y2(t,r,n)}}const V5=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function f9(e,t,r,n){G5(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(V5.has(s)?s:J2(s),t.attrs[s])}class h9 extends H5{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ds}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(p0.has(r)){const n=x5(r);return n&&n.default||0}return r=V5.has(r)?r:J2(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return I5(t,r,n)}build(t,r,n){F5(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,s){f9(t,r,n,s)}mount(t){this.isSVGTag=D5(t.tagName),super.mount(t)}}const g9=(e,t)=>q2(e)?new h9(t):new d9(t,{allowProjection:e!==C.Fragment});function Wh(e,t,r){const n=e.getProps();return X2(n,t,r!==void 0?r:n.custom,e)}const h_=e=>Array.isArray(e);function m9(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,e0(r))}function p9(e){return h_(e)?e[e.length-1]||0:e}function x9(e,t){const r=Wh(e,t);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=p9(a[i]);m9(e,i,o)}}function y9(e){return!!(Pa(e)&&e.add)}function g_(e,t){const r=e.getValue("willChange");if(y9(r))return r.add(t);if(!r&&bc.WillChange){const n=new bc.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function K5(e){return e.props[M5]}const v9=e=>e!==null;function w9(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(v9),a=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[a]}const _9={type:"spring",stiffness:500,damping:25,restSpeed:10},b9=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),S9={type:"keyframes",duration:.8},k9={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},C9=(e,{keyframes:t})=>t.length>2?S9:p0.has(e)?e.startsWith("scale")?b9(t[1]):_9:k9;function T9({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:c,elapsed:d,...f}){return!!Object.keys(f).length}const Q2=(e,t,r,n={},s,a)=>i=>{const o=B2(n,e)||{},c=o.delay||n.delay||0;let{elapsed:d=0}=n;d=d-bl(c);const f={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-d,onUpdate:m=>{t.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:a?void 0:s};T9(o)||Object.assign(f,C9(e,f)),f.duration&&(f.duration=bl(f.duration)),f.repeatDelay&&(f.repeatDelay=bl(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(l_(f),f.delay===0&&(p=!0)),(bc.instantAnimations||bc.skipAnimations)&&(p=!0,l_(f),f.delay=0),f.allowFlatten=!o.type&&!o.ease,p&&!a&&t.get()!==void 0){const m=w9(f.keyframes,o);if(m!==void 0){Ln.update(()=>{f.onUpdate(m),f.onComplete()});return}}return o.isSync?new L2(f):new XR(f)};function E9({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function q5(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...o}=t;n&&(a=n);const c=[],d=s&&e.animationState&&e.animationState.getState()[s];for(const f in o){const p=e.getValue(f,e.latestValues[f]??null),m=o[f];if(m===void 0||d&&E9(d,f))continue;const y={delay:r,...B2(a||{},f)},v=p.get();if(v!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===v&&!y.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const E=K5(e);if(E){const k=window.MotionHandoffAnimation(E,f,Ln);k!==null&&(y.startTime=k,w=!0)}}g_(e,f),p.start(Q2(f,p,m,e.shouldReduceMotion&&g5.has(f)?{type:!1}:y,e,w));const S=p.animation;S&&c.push(S)}return i&&Promise.all(c).then(()=>{Ln.update(()=>{i&&x9(e,i)})}),c}function X5(e,t,r,n=0,s=1){const a=Array.from(e).sort((d,f)=>d.sortNodePosition(f)).indexOf(t),i=e.size,o=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:o-a*n}function m_(e,t,r={}){const n=Wh(e,t,r.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(q5(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:p}=s;return N9(e,t,c,d,f,p,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,d]=o==="beforeChildren"?[a,i]:[i,a];return c().then(()=>d())}else return Promise.all([a(),i(r.delay)])}function N9(e,t,r=0,n=0,s=0,a=1,i){const o=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),o.push(m_(c,t,{...i,delay:r+(typeof n=="function"?0:n)+X5(e.variantChildren,c,n,s,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(o)}function A9(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>m_(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=m_(e,t,r);else{const s=typeof t=="function"?Wh(e,t,r.custom):t;n=Promise.all(q5(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function Y5(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const j9=G2.length;function J5(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?J5(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<j9;r++){const n=G2[r],s=e.props[n];(Km(s)||s===!1)&&(t[n]=s)}return t}const F9=[...H2].reverse(),P9=H2.length;function D9(e){return t=>Promise.all(t.map(({animation:r,options:n})=>A9(e,r,n)))}function R9(e){let t=D9(e),r=dC(),n=!0;const s=c=>(d,f)=>{const p=Wh(e,f,c==="exit"?e.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:y,...v}=p;d={...d,...v,...y}}return d};function a(c){t=c(e)}function i(c){const{props:d}=e,f=J5(e.parent)||{},p=[],m=new Set;let y={},v=1/0;for(let S=0;S<P9;S++){const E=F9[S],k=r[E],_=d[E]!==void 0?d[E]:f[E],N=Km(_),F=E===c?k.isActive:null;F===!1&&(v=S);let A=_===f[E]&&_!==d[E]&&N;if(A&&n&&e.manuallyAnimateOnMount&&(A=!1),k.protectedKeys={...y},!k.isActive&&F===null||!_&&!k.prevProp||Ty(_)||typeof _=="boolean")continue;const R=I9(k.prevProp,_);let T=R||E===c&&k.isActive&&!A&&N||S>v&&N,D=!1;const L=Array.isArray(_)?_:[_];let O=L.reduce(s(E),{});F===!1&&(O={});const{prevResolvedValues:G={}}=k,K={...G,...O},te=I=>{T=!0,m.has(I)&&(D=!0,m.delete(I)),k.needsAnimating[I]=!0;const W=e.getValue(I);W&&(W.liveStyle=!1)};for(const I in K){const W=O[I],B=G[I];if(y.hasOwnProperty(I))continue;let Y=!1;h_(W)&&h_(B)?Y=!Y5(W,B):Y=W!==B,Y?W!=null?te(I):m.add(I):W!==void 0&&m.has(I)?te(I):k.protectedKeys[I]=!0}k.prevProp=_,k.prevResolvedValues=O,k.isActive&&(y={...y,...O}),n&&e.blockInitialAnimation&&(T=!1);const Z=A&&R;T&&(!Z||D)&&p.push(...L.map(I=>{const W={type:E};if(typeof I=="string"&&n&&!Z&&e.manuallyAnimateOnMount&&e.parent){const{parent:B}=e,Y=Wh(B,I);if(B.enteringChildren&&Y){const{delayChildren:V}=Y.transition||{};W.delay=X5(B.enteringChildren,e,V)}}return{animation:I,options:W}}))}if(m.size){const S={};if(typeof d.initial!="boolean"){const E=Wh(e,Array.isArray(d.initial)?d.initial[0]:d.initial);E&&E.transition&&(S.transition=E.transition)}m.forEach(E=>{const k=e.getBaseTarget(E),_=e.getValue(E);_&&(_.liveStyle=!0),S[E]=k??null}),p.push({animation:S})}let w=!!p.length;return n&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(w=!1),n=!1,w?t(p):Promise.resolve()}function o(c,d){if(r[c].isActive===d)return Promise.resolve();e.variantChildren?.forEach(p=>p.animationState?.setActive(c,d)),r[c].isActive=d;const f=i(c);for(const p in r)r[p].protectedKeys={};return f}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=dC(),n=!0}}}function I9(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Y5(t,e):!1}function Cd(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function dC(){return{animate:Cd(!0),whileInView:Cd(),whileHover:Cd(),whileTap:Cd(),whileDrag:Cd(),whileFocus:Cd(),exit:Cd()}}class Uu{constructor(t){this.isMounted=!1,this.node=t}update(){}}class M9 extends Uu{constructor(t){super(t),t.animationState||(t.animationState=R9(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Ty(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let L9=0;class O9 extends Uu{constructor(){super(...arguments),this.id=L9++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const B9={animation:{Feature:M9},exit:{Feature:O9}};function Xm(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function Tp(e){return{point:{x:e.pageX,y:e.pageY}}}const U9=e=>t=>W2(t)&&e(t,Tp(t));function Tm(e,t,r,n){return Xm(e,t,U9(r),n)}const Q5=1e-4,$9=1-Q5,W9=1+Q5,Z5=.01,z9=0-Z5,H9=0+Z5;function ti(e){return e.max-e.min}function G9(e,t,r){return Math.abs(e-t)<=r}function fC(e,t,r,n=.5){e.origin=n,e.originPoint=$n(t.min,t.max,e.origin),e.scale=ti(r)/ti(t),e.translate=$n(r.min,r.max,e.origin)-e.originPoint,(e.scale>=$9&&e.scale<=W9||isNaN(e.scale))&&(e.scale=1),(e.translate>=z9&&e.translate<=H9||isNaN(e.translate))&&(e.translate=0)}function Em(e,t,r,n){fC(e.x,t.x,r.x,n?n.originX:void 0),fC(e.y,t.y,r.y,n?n.originY:void 0)}function hC(e,t,r){e.min=r.min+t.min,e.max=e.min+ti(t)}function V9(e,t,r){hC(e.x,t.x,r.x),hC(e.y,t.y,r.y)}function gC(e,t,r){e.min=t.min-r.min,e.max=e.min+ti(t)}function Nm(e,t,r){gC(e.x,t.x,r.x),gC(e.y,t.y,r.y)}function ao(e){return[e("x"),e("y")]}const e6=({current:e})=>e?e.ownerDocument.defaultView:null,mC=(e,t)=>Math.abs(e-t);function K9(e,t){const r=mC(e.x,t.x),n=mC(e.y,t.y);return Math.sqrt(r**2+n**2)}class t6{constructor(t,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Xv(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,v=K9(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!v)return;const{point:w}=m,{timestamp:S}=fa;this.history.push({...w,timestamp:S});const{onStart:E,onMove:k}=this.handlers;y||(E&&E(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,m)},this.handlePointerMove=(m,y)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=qv(y,this.transformPagePoint),Ln.update(this.updatePoint,!0)},this.handlePointerUp=(m,y)=>{this.end();const{onEnd:v,onSessionEnd:w,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=Xv(m.type==="pointercancel"?this.lastMoveEventInfo:qv(y,this.transformPagePoint),this.history);this.startEvent&&v&&v(m,E),w&&w(m,E)},!W2(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const o=Tp(t),c=qv(o,this.transformPagePoint),{point:d}=c,{timestamp:f}=fa;this.history=[{...d,timestamp:f}];const{onSessionStart:p}=r;p&&p(t,Xv(c,this.history)),this.removeListeners=Sp(Tm(this.contextWindow,"pointermove",this.handlePointerMove),Tm(this.contextWindow,"pointerup",this.handlePointerUp),Tm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Fu(this.updatePoint)}}function qv(e,t){return t?{point:t(e.point)}:e}function pC(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Xv({point:e},t){return{point:e,delta:pC(e,r6(t)),offset:pC(e,q9(t)),velocity:X9(t,.1)}}function q9(e){return e[0]}function r6(e){return e[e.length-1]}function X9(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=r6(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>bl(t)));)r--;if(!n)return{x:0,y:0};const a=Sl(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function Y9(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?$n(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?$n(r,e,n.max):Math.min(e,r)),e}function xC(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function J9(e,{top:t,left:r,bottom:n,right:s}){return{x:xC(e.x,r,s),y:xC(e.y,t,n)}}function yC(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function Q9(e,t){return{x:yC(e.x,t.x),y:yC(e.y,t.y)}}function Z9(e,t){let r=.5;const n=ti(e),s=ti(t);return s>n?r=Hm(t.min,t.max-n,e.min):n>s&&(r=Hm(e.min,e.max-s,t.min)),_c(0,1,r)}function eI(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const p_=.35;function tI(e=p_){return e===!1?e=0:e===!0&&(e=p_),{x:vC(e,"left","right"),y:vC(e,"top","bottom")}}function vC(e,t,r){return{min:wC(e,t),max:wC(e,r)}}function wC(e,t){return typeof e=="number"?e:e[t]||0}const rI=new WeakMap;class nI{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ds(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Tp(p).point)},i=(p,m)=>{const{drag:y,dragPropagation:v,onDragStart:w}=this.getProps();if(y&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=d7(y),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ao(E=>{let k=this.getAxisMotionValue(E).get()||0;if(kl.test(k)){const{projection:_}=this.visualElement;if(_&&_.layout){const N=_.layout.layoutBox[E];N&&(k=ti(N)*(parseFloat(k)/100))}}this.originPoint[E]=k}),w&&Ln.postRender(()=>w(p,m)),g_(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},o=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:y,dragDirectionLock:v,onDirectionLock:w,onDrag:S}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:E}=m;if(v&&this.currentDirection===null){this.currentDirection=sI(E),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",m.point,E),this.updateAxis("y",m.point,E),this.visualElement.render(),S&&S(p,m)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>ao(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:f}=this.getProps();this.panSession=new t6(t,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,distanceThreshold:n,contextWindow:e6(this.visualElement)})}stop(t,r){const n=t||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&Ln.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!e1(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=Y9(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&Rh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=J9(n.layoutBox,t):this.constraints=!1,this.elastic=tI(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&ao(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=eI(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Rh(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=a9(n,s.root,this.visualElement.getTransformPagePoint());let i=Q9(s.layout.layoutBox,a);if(r){const o=r(r9(i));this.hasMutatedConstraints=!!o,o&&(i=B5(o))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},d=ao(f=>{if(!e1(f,r,this.currentDirection))return;let p=c&&c[f]||{};i&&(p={min:0,max:0});const m=s?200:1e6,y=s?40:1e7,v={type:"inertia",velocity:n?t[f]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(f,v)});return Promise.all(d).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return g_(this.visualElement,t),n.start(Q2(t,n,0,r,this.visualElement,!1))}stopAnimation(){ao(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){ao(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){ao(r=>{const{drag:n}=this.getProps();if(!e1(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(t[r]-$n(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Rh(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ao(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();s[i]=Z9({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ao(i=>{if(!e1(i,t,null))return;const o=this.getAxisMotionValue(i),{min:c,max:d}=this.constraints[i];o.set($n(c,d,s[i]))})}addListeners(){if(!this.visualElement.current)return;rI.set(this.visualElement,this);const t=this.visualElement.current,r=Tm(t,"pointerdown",c=>{const{drag:d,dragListener:f=!0}=this.getProps();d&&f&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();Rh(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Ln.read(n);const i=Xm(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(ao(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=c[f].translate,p.set(p.get()+c[f].translate))}),this.visualElement.render())}));return()=>{i(),r(),a(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=p_,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function e1(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function sI(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class aI extends Uu{constructor(t){super(t),this.removeGroupControls=fo,this.removeListeners=fo,this.controls=new nI(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||fo}unmount(){this.removeGroupControls(),this.removeListeners()}}const _C=e=>(t,r)=>{e&&Ln.postRender(()=>e(t,r))};class iI extends Uu{constructor(){super(...arguments),this.removePointerDownListener=fo}onPointerDown(t){this.session=new t6(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:e6(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:_C(t),onStart:_C(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&Ln.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=Tm(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const E1={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function bC(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Sg={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(hr.test(e))e=parseFloat(e);else return e;const r=bC(e,t.target.x),n=bC(e,t.target.y);return`${r}% ${n}%`}},oI={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Pu.parse(e);if(s.length>5)return n;const a=Pu.createTransformer(e),i=typeof s[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;s[0+i]/=o,s[1+i]/=c;const d=$n(o,c,.5);return typeof s[2+i]=="number"&&(s[2+i]/=d),typeof s[3+i]=="number"&&(s[3+i]/=d),a(s)}};let Yv=!1;class lI extends C.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;j7(cI),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),Yv&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),E1.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,Yv=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||Ln.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),$2.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;Yv=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function n6(e){const[t,r]=C5(),n=C.useContext(v2);return l.jsx(lI,{...e,layoutGroup:n,switchLayoutGroup:C.useContext(L5),isPresent:t,safeToRemove:r})}const cI={borderRadius:{...Sg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Sg,borderTopRightRadius:Sg,borderBottomLeftRadius:Sg,borderBottomRightRadius:Sg,boxShadow:oI};function uI(e,t,r){const n=Pa(e)?e:e0(e);return n.start(Q2("",n,t,r)),n.animation}const dI=(e,t)=>e.depth-t.depth;class fI{constructor(){this.children=[],this.isDirty=!1}add(t){b2(this.children,t),this.isDirty=!0}remove(t){S2(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(dI),this.isDirty=!1,this.children.forEach(t)}}function hI(e,t){const r=vi.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(Fu(n),e(a-t))};return Ln.setup(n,!0),()=>Fu(n)}const s6=["TopLeft","TopRight","BottomLeft","BottomRight"],gI=s6.length,SC=e=>typeof e=="string"?parseFloat(e):e,kC=e=>typeof e=="number"||hr.test(e);function mI(e,t,r,n,s,a){s?(e.opacity=$n(0,r.opacity??1,pI(n)),e.opacityExit=$n(t.opacity??1,0,xI(n))):a&&(e.opacity=$n(t.opacity??1,r.opacity??1,n));for(let i=0;i<gI;i++){const o=`border${s6[i]}Radius`;let c=CC(t,o),d=CC(r,o);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||kC(c)===kC(d)?(e[o]=Math.max($n(SC(c),SC(d),n),0),(kl.test(d)||kl.test(c))&&(e[o]+="%")):e[o]=d}(t.rotate||r.rotate)&&(e.rotate=$n(t.rotate||0,r.rotate||0,n))}function CC(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const pI=a6(0,.5,GN),xI=a6(.5,.95,fo);function a6(e,t,r){return n=>n<e?0:n>t?1:r(Hm(e,t,n))}function TC(e,t){e.min=t.min,e.max=t.max}function eo(e,t){TC(e.x,t.x),TC(e.y,t.y)}function EC(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function NC(e,t,r,n,s){return e-=t,e=U1(e,1/r,n),s!==void 0&&(e=U1(e,1/s,n)),e}function yI(e,t=0,r=1,n=.5,s,a=e,i=e){if(kl.test(t)&&(t=parseFloat(t),t=$n(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=$n(a.min,a.max,n);e===a&&(o-=t),e.min=NC(e.min,t,r,o,s),e.max=NC(e.max,t,r,o,s)}function AC(e,t,[r,n,s],a,i){yI(e,t[r],t[n],t[s],t.scale,a,i)}const vI=["x","scaleX","originX"],wI=["y","scaleY","originY"];function jC(e,t,r,n){AC(e.x,t,vI,r?r.x:void 0,n?n.x:void 0),AC(e.y,t,wI,r?r.y:void 0,n?n.y:void 0)}function FC(e){return e.translate===0&&e.scale===1}function i6(e){return FC(e.x)&&FC(e.y)}function PC(e,t){return e.min===t.min&&e.max===t.max}function _I(e,t){return PC(e.x,t.x)&&PC(e.y,t.y)}function DC(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function o6(e,t){return DC(e.x,t.x)&&DC(e.y,t.y)}function RC(e){return ti(e.x)/ti(e.y)}function IC(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class bI{constructor(){this.members=[]}add(t){b2(this.members,t),t.scheduleRender()}remove(t){if(S2(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function SI(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y,i=r?.z||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:d,rotate:f,rotateX:p,rotateY:m,skewX:y,skewY:v}=r;d&&(n=`perspective(${d}px) ${n}`),f&&(n+=`rotate(${f}deg) `),p&&(n+=`rotateX(${p}deg) `),m&&(n+=`rotateY(${m}deg) `),y&&(n+=`skewX(${y}deg) `),v&&(n+=`skewY(${v}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(n+=`scale(${o}, ${c})`),n||"none"}const Jv=["","X","Y","Z"],kI=1e3;let CI=0;function Qv(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function l6(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=K5(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Ln,!(s||a))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&l6(n)}function c6({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=t?.()){this.id=CI++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(NI),this.nodes.forEach(PI),this.nodes.forEach(DI),this.nodes.forEach(AI)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new fI)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new T2),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=k5(i)&&!x7(i),this.instance=i;const{layoutId:o,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),e){let f,p=0;const m=()=>this.root.updateBlockedByResize=!1;Ln.read(()=>{p=window.innerWidth}),e(i,()=>{const y=window.innerWidth;y!==p&&(p=y,this.root.updateBlockedByResize=!0,f&&f(),f=hI(m,250),E1.hasAnimatedSinceResize&&(E1.hasAnimatedSinceResize=!1,this.nodes.forEach(OC)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&d&&(o||c)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||d.getDefaultTransition()||OI,{onLayoutAnimationStart:w,onLayoutAnimationComplete:S}=d.getProps(),E=!this.targetLayout||!o6(this.targetLayout,y),k=!p&&m;if(this.options.layoutRoot||this.resumeFrom||k||p&&(E||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...B2(v,"layout"),onPlay:w,onComplete:S};(d.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(f,k)}else p||OC(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Fu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(RI),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&l6(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(MC);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(LC);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(FI),this.nodes.forEach(TI),this.nodes.forEach(EI)):this.nodes.forEach(LC),this.clearAllSnapshots();const o=vi.now();fa.delta=_c(0,1e3/60,o-fa.timestamp),fa.timestamp=o,fa.isProcessing=!0,Uv.update.process(fa),Uv.preRender.process(fa),Uv.render.process(fa),fa.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,$2.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(jI),this.sharedNodes.forEach(II)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ln.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ln.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ti(this.snapshot.measuredBox.x)&&!ti(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ds(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!i6(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,f=d!==this.prevTransformTemplateValue;i&&this.instance&&(o||Ad(this.latestValues)||f)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),BI(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return ds();const o=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(UI))){const{scroll:d}=this.root;d&&(Ih(o.x,d.offset.x),Ih(o.y,d.offset.y))}return o}removeElementScroll(i){const o=ds();if(eo(o,i),this.scroll?.wasRoot)return o;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:f,options:p}=d;d!==this.root&&f&&p.layoutScroll&&(f.wasRoot&&eo(o,i),Ih(o.x,f.offset.x),Ih(o.y,f.offset.y))}return o}applyTransform(i,o=!1){const c=ds();eo(c,i);for(let d=0;d<this.path.length;d++){const f=this.path[d];!o&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Mh(c,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Ad(f.latestValues)&&Mh(c,f.latestValues)}return Ad(this.latestValues)&&Mh(c,this.latestValues),c}removeTransform(i){const o=ds();eo(o,i);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Ad(d.latestValues))continue;u_(d.latestValues)&&d.updateSnapshot();const f=ds(),p=d.measurePageBox();eo(f,p),jC(o,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,f)}return Ad(this.latestValues)&&jC(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==fa.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:p}=this.options;if(!(!this.layout||!(f||p))){if(this.resolvedRelativeTargetAt=fa.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ds(),this.relativeTargetOrigin=ds(),Nm(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),eo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ds(),this.targetWithTransforms=ds()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),V9(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):eo(this.target,this.layout.layoutBox),$5(this.target,this.targetDelta)):eo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ds(),this.relativeTargetOrigin=ds(),Nm(this.relativeTargetOrigin,this.target,m.target),eo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||u_(this.parent.latestValues)||U5(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const i=this.getLead(),o=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===fa.timestamp&&(c=!1),c)return;const{layout:d,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||f))return;eo(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;s9(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=ds());const{target:y}=i;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(EC(this.prevProjectionDelta.x,this.projectionDelta.x),EC(this.prevProjectionDelta.y,this.projectionDelta.y)),Em(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!IC(this.projectionDelta.x,this.prevProjectionDelta.x)||!IC(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Lh(),this.projectionDelta=Lh(),this.projectionDeltaWithTransform=Lh()}setAnimationOrigin(i,o=!1){const c=this.snapshot,d=c?c.latestValues:{},f={...this.latestValues},p=Lh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=ds(),y=c?c.source:void 0,v=this.layout?this.layout.source:void 0,w=y!==v,S=this.getStack(),E=!S||S.members.length<=1,k=!!(w&&!E&&this.options.crossfade===!0&&!this.path.some(LI));this.animationProgress=0;let _;this.mixTargetDelta=N=>{const F=N/1e3;BC(p.x,i.x,F),BC(p.y,i.y,F),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Nm(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),MI(this.relativeTarget,this.relativeTargetOrigin,m,F),_&&_I(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=ds()),eo(_,this.relativeTarget)),w&&(this.animationValues=f,mI(f,d,this.latestValues,F,k,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Fu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ln.update(()=>{E1.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=e0(0)),this.currentAnimation=uI(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(kI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:d,latestValues:f}=i;if(!(!o||!c||!d)){if(this!==i&&this.layout&&d&&u6(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||ds();const p=ti(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+p;const m=ti(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+m}eo(o,c),Mh(o,f),Em(this.projectionDeltaWithTransform,this.layoutCorrected,o,f)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new bI),this.sharedNodes.get(i).add(o);const d=o.options.initialPromotionConfig;o.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const d={};c.z&&Qv("z",i,d,this.animationValues);for(let f=0;f<Jv.length;f++)Qv(`rotate${Jv[f]}`,i,d,this.animationValues),Qv(`skew${Jv[f]}`,i,d,this.animationValues);i.render();for(const f in d)i.setStaticValue(f,d[f]),this.animationValues&&(this.animationValues[f]=d[f]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=T1(o?.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=T1(o?.pointerEvents)||""),this.hasProjected&&!Ad(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const f=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=SI(this.projectionDeltaWithTransform,this.treeScale,f);c&&(p=c(f,p)),i.transform=p;const{x:m,y}=this.projectionDelta;i.transformOrigin=`${m.origin*100}% ${y.origin*100}% 0`,d.animationValues?i.opacity=d===this?f.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:i.opacity=d===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const v in qm){if(f[v]===void 0)continue;const{correct:w,applyTo:S,isCSSVariable:E}=qm[v],k=p==="none"?f[v]:w(f[v],d);if(S){const _=S.length;for(let N=0;N<_;N++)i[S[N]]=k}else E?this.options.visualElement.renderState.vars[v]=k:i[v]=k}this.options.layoutId&&(i.pointerEvents=d===this?T1(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(MC),this.root.sharedNodes.clear()}}}function TI(e){e.updateLayout()}function EI(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:n}=e.layout,{animationType:s}=e.options,a=t.source!==e.layout.source;s==="size"?ao(f=>{const p=a?t.measuredBox[f]:t.layoutBox[f],m=ti(p);p.min=r[f].min,p.max=p.min+m}):u6(s,t.layoutBox,r)&&ao(f=>{const p=a?t.measuredBox[f]:t.layoutBox[f],m=ti(r[f]);p.max=p.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const i=Lh();Em(i,r,t.layoutBox);const o=Lh();a?Em(o,e.applyTransform(n,!0),t.measuredBox):Em(o,r,t.layoutBox);const c=!i6(i);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:p,layout:m}=f;if(p&&m){const y=ds();Nm(y,t.layoutBox,p.layoutBox);const v=ds();Nm(v,r,m.layoutBox),o6(y,v)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=v,e.relativeTargetOrigin=y,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:i,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function NI(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function AI(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function jI(e){e.clearSnapshot()}function MC(e){e.clearMeasurements()}function LC(e){e.isLayoutDirty=!1}function FI(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function OC(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function PI(e){e.resolveTargetDelta()}function DI(e){e.calcProjection()}function RI(e){e.resetSkewAndRotation()}function II(e){e.removeLeadSnapshot()}function BC(e,t,r){e.translate=$n(t.translate,0,r),e.scale=$n(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function UC(e,t,r,n){e.min=$n(t.min,r.min,n),e.max=$n(t.max,r.max,n)}function MI(e,t,r,n){UC(e.x,t.x,r.x,n),UC(e.y,t.y,r.y,n)}function LI(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const OI={duration:.45,ease:[.4,0,.1,1]},$C=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),WC=$C("applewebkit/")&&!$C("chrome/")?Math.round:fo;function zC(e){e.min=WC(e.min),e.max=WC(e.max)}function BI(e){zC(e.x),zC(e.y)}function u6(e,t,r){return e==="position"||e==="preserve-aspect"&&!G9(RC(t),RC(r),.2)}function UI(e){return e!==e.root&&e.scroll?.wasRoot}const $I=c6({attachResizeListener:(e,t)=>Xm(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Zv={current:void 0},d6=c6({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Zv.current){const e=new $I({});e.mount(window),e.setOptions({layoutScroll:!0}),Zv.current=e}return Zv.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),WI={pan:{Feature:iI},drag:{Feature:aI,ProjectionNode:d6,MeasureLayout:n6}};function HC(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&Ln.postRender(()=>a(t,Tp(t)))}class zI extends Uu{mount(){const{current:t}=this.node;t&&(this.unmount=f7(t,(r,n)=>(HC(this.node,n,"Start"),s=>HC(this.node,s,"End"))))}unmount(){}}class HI extends Uu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Sp(Xm(this.node.current,"focus",()=>this.onFocus()),Xm(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function GC(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&Ln.postRender(()=>a(t,Tp(t)))}class GI extends Uu{mount(){const{current:t}=this.node;t&&(this.unmount=p7(t,(r,n)=>(GC(this.node,n,"Start"),(s,{success:a})=>GC(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const x_=new WeakMap,ew=new WeakMap,VI=e=>{const t=x_.get(e.target);t&&t(e)},KI=e=>{e.forEach(VI)};function qI({root:e,...t}){const r=e||document;ew.has(r)||ew.set(r,{});const n=ew.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(KI,{root:e,...t})),n[s]}function XI(e,t,r){const n=qI(t);return x_.set(e,r),n.observe(e),()=>{x_.delete(e),n.unobserve(e)}}const YI={some:0,all:1};class JI extends Uu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:YI[s]},o=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),m=d?f:p;m&&m(c)};return XI(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(QI(t,r))&&this.startObserver()}unmount(){}}function QI({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const ZI={inView:{Feature:JI},tap:{Feature:GI},focus:{Feature:HI},hover:{Feature:zI}},eM={layout:{ProjectionNode:d6,MeasureLayout:n6}},tM={...B9,...ZI,...WI,...eM},Qe=t9(tM,g9),tt=({children:e,variant:t="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const o="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",c={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},d={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg",icon:"p-0 flex items-center justify-center"},f=s?"opacity-50 cursor-not-allowed":"";return l.jsx(Qe.button,{className:`${o} ${c[t]} ${d[r]} ${f} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:e})},Sr=({size:e="md",color:t="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return l.jsx(Qe.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[e]} ${s[t]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},Wo=({type:e="info",message:t="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[o,c]=C.useState(!0),[d,f]=C.useState(!1),p=C.useRef(null),m=C.useRef(null);C.useEffect(()=>{if(r>0)return m.current=setTimeout(()=>{y()},r),()=>{m.current&&clearTimeout(m.current)}},[r]);const y=C.useCallback(()=>{d||(f(!0),m.current&&clearTimeout(m.current),setTimeout(()=>{c(!1),s&&s()},300))},[d,s]),v=C.useCallback(E=>{E.key==="Escape"&&y()},[y]);if(!o)return null;const w=["notification",`notification-${e}`,o?"notification-visible":"",d?"notification-exiting":"",a].filter(Boolean).join(" "),S=()=>{switch(e){case"success":return"✓";case"error":return"✕";case"warning":return"⚠";case"info":default:return"ℹ"}};return l.jsx("div",{ref:p,className:w,role:"alert","aria-live":"polite",onKeyDown:v,tabIndex:-1,...i,children:l.jsxs("div",{className:"notification-content",children:[l.jsx("div",{className:"notification-icon","aria-hidden":"true",children:S()}),l.jsx("div",{className:"notification-body",children:l.jsx("div",{className:"notification-message",children:t})}),n&&l.jsx("button",{className:"notification-close",onClick:y,type:"button","aria-label":"Close notification",children:"×"})]})})},Oa=()=>{const[e,t]=C.useState([]),r=C.useCallback((a,i="info",o={})=>{const c=Date.now()+Math.random(),d={id:c,message:a,type:i,...o};return t(f=>[...f,d]),o.duration!==0&&setTimeout(()=>{n(c)},o.duration||3e3),c},[]),n=C.useCallback(a=>{t(i=>i.filter(o=>o.id!==a))},[]),s=C.useCallback(()=>{t([])},[]);return{notifications:e,showNotification:r,removeNotification:n,clearAllNotifications:s}},Ho=()=>{const[e,t]=C.useState(!1),[r,n]=C.useState(null),[s,a]=C.useState(null),i=C.useRef(null);C.useRef(new Map);const o=C.useRef(0),c=3,d=1e3,f=C.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);C.useEffect(()=>f,[f]);const p=C.useCallback(async(J,I={})=>{try{t(!0),n(null),i.current=new AbortController;const W=I.method||"POST",B={method:W,headers:{"Content-Type":"application/json",...I.headers},signal:i.current.signal,...I};W!=="GET"&&W!=="HEAD"&&(B.body=JSON.stringify(I.data||{})),console.log(`[API] Making request to: ${J}`,B);const Y=await fetch(J,B);if(!Y.ok)throw new Error(`HTTP error! status: ${Y.status}`);const V=await Y.json();if(console.log("[API] Response received:",V),V.success)return a(V),o.current=0,V;throw new Error(V.error||V.message||"Request failed")}catch(W){if(W.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",W),n(W.message||"Request failed"),o.current<c){o.current++;const B=d*Math.pow(2,o.current-1);return console.log(`[API] Retrying in ${B}ms (attempt ${o.current}/${c})`),await new Promise(Y=>setTimeout(Y,B)),p(J,I)}throw W}finally{t(!1),i.current=null}},[]),m=C.useCallback(async(J,I={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(J,I)}catch(W){throw console.error("[API] Authenticated request failed:",W),W}},[]),y=C.useCallback(async(J,I)=>{try{const W=`/.netlify/functions/get-test-questions?test_type=${J}&test_id=${I}`;console.log(`[API] Getting test info for ${J}_${I}`);const Y=await(await m(W)).json();if(Y.success)return console.log("[API] Test info retrieved successfully:",Y.test_info),Y.test_info;throw new Error(Y.error||"Failed to get test info")}catch(W){throw console.error("[API] Failed to get test info:",W),W}},[m]),v=C.useCallback(async(J,I)=>{try{const W=`/.netlify/functions/get-test-questions?test_type=${J}&test_id=${I}`;console.log(`[API] Getting test questions for ${J}_${I}`);const Y=await(await m(W)).json();if(Y.success)return console.log("[API] Test questions retrieved successfully:",Y.questions),Y.questions;throw new Error(Y.error||"Failed to get test questions")}catch(W){throw console.error("[API] Failed to get test questions:",W),W}},[m]),w=C.useCallback(async()=>{try{const J="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const W=await(await m(J)).json();if(W.success)return console.log("[API] Student active tests loaded successfully:",W.tests),W.tests;throw new Error(W.error||"Failed to load student active tests")}catch(J){throw console.error("[API] Failed to load student active tests:",J),J}},[m]),S=C.useCallback(async(J,I,W)=>{try{let B;switch(J){case"true_false":B="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":B="/.netlify/functions/submit-multiple-choice-test";break;case"input":B="/.netlify/functions/submit-input-test";break;case"matching_type":B="/.netlify/functions/submit-matching-type-test";break;default:throw new Error(`Unknown test type: ${J}`)}console.log(`[API] Submitting ${J} test:`,W);const V=await(await m(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(W)})).json();if(V.success)return console.log("[API] Test submitted successfully:",V),V;throw new Error(V.error||"Failed to submit test")}catch(B){throw console.error("[API] Failed to submit test:",B),B}},[m]),E=C.useCallback(async J=>{try{const I="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",J);const B=await(await m(I,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)})).json();if(B.success)return console.log("[API] Multiple choice test saved successfully:",B),B;throw new Error(B.error||"Failed to save multiple choice test")}catch(I){throw console.error("[API] Failed to save multiple choice test:",I),I}},[m]),k=C.useCallback(async J=>{try{const I="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",J);const B=await(await m(I,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)})).json();if(B.success)return console.log("[API] True/false test saved successfully:",B),B;throw new Error(B.error||"Failed to save true/false test")}catch(I){throw console.error("[API] Failed to save true/false test:",I),I}},[m]),_=C.useCallback(async J=>{try{const I="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",J);const B=await(await m(I,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)})).json();if(B.success)return console.log("[API] Input test saved successfully:",B),B;throw new Error(B.error||"Failed to save input test")}catch(I){throw console.error("[API] Failed to save input test:",I),I}},[m]),N=C.useCallback(async J=>{try{const I="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",J);const B=await(await m(I,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)})).json();if(B.success)return console.log("[API] Test assigned successfully:",B),B;throw new Error(B.error||"Failed to assign test")}catch(I){throw console.error("[API] Failed to assign test:",I),I}},[m]),F=C.useCallback(async()=>{try{const J="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const W=await(await m(J)).json();if(W.success)return console.log("[API] Teacher active tests loaded successfully:",W.tests),W.tests;throw new Error(W.error||"Failed to load teacher active tests")}catch(J){throw console.error("[API] Failed to load teacher active tests:",J),J}},[m]),A=C.useCallback(async()=>{try{const J="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const W=await(await m(J)).json();if(W.success)return console.log("[API] All users loaded successfully:",W.users),W.users;throw new Error(W.error||"Failed to get all users")}catch(J){throw console.error("[API] Failed to get all users:",J),J}},[m]),R=C.useCallback(async()=>{try{const J="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const W=await(await m(J)).json();if(W.success)return console.log("[API] All teachers loaded successfully:",W.teachers),W.teachers;throw new Error(W.error||"Failed to get all teachers")}catch(J){throw console.error("[API] Failed to get all teachers:",J),J}},[m]),T=C.useCallback(async()=>{try{const J="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const W=await(await m(J)).json();if(W.success)return console.log("[API] All subjects loaded successfully:",W.subjects),W.subjects;throw new Error(W.error||"Failed to get all subjects")}catch(J){throw console.error("[API] Failed to get all subjects:",J),J}},[m]),D=C.useCallback(()=>{n(null)},[]),L=C.useCallback(()=>{a(null)},[]),O=C.useCallback(()=>{t(!1),n(null),a(null),o.current=0,f()},[f]),G=C.useCallback(async(J,I={})=>{const B=await(await m(J,{...I,method:"GET"})).json();if(B.success)return B;throw new Error(B.error||"Request failed")},[m]),K=C.useCallback(async(J,I,W={})=>{const Y=await(await m(J,{...W,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})).json();if(Y.success)return Y;throw new Error(Y.error||"Request failed")},[m]),te=C.useCallback(async(J,I,W={})=>{const Y=await(await m(J,{...W,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})).json();if(Y.success)return Y;throw new Error(Y.error||"Request failed")},[m]),Z=C.useCallback(async(J,I={})=>{const B=await(await m(J,{...I,method:"DELETE"})).json();if(B.success)return B;throw new Error(B.error||"Request failed")},[m]);return{loading:e,error:r,data:s,sendRequest:p,makeAuthenticatedRequest:m,get:G,post:K,put:te,delete:Z,getTestInfo:y,getTestQuestions:v,loadStudentActiveTests:w,submitTest:S,saveMultipleChoiceTest:E,saveTrueFalseTest:k,saveInputTest:_,assignTestToClasses:N,loadTeacherActiveTests:F,getAllUsers:A,getAllTeachers:R,getAllSubjects:T,clearError:D,clearData:L,reset:O,cleanup:f}},rM="modulepreload",nM=function(e){return"/"+e},VC={},$d=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let d=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};var i=d;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");s=d(r.map(f=>{if(f=nM(f),f in VC)return;VC[f]=!0;const p=f.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${m}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":rM,p||(y.as="script"),y.crossOrigin="",y.href=f,c&&y.setAttribute("nonce",c),document.head.appendChild(y),p)return new Promise((v,w)=>{y.addEventListener("load",v),y.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})};var N1={exports:{}},kg={},tw={},rw={},KC;function jr(){return KC||(KC=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof I1<"u"?I1:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return e.Konva.angleDeg?s*t:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var s;return(s=e.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(s){e.glob.Konva=s}};const n=s=>{e.Konva[s.prototype.getClassName()]=s};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})(rw)),rw}var nw={},qC;function rs(){return qC||(qC=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=jr();class r{constructor(N=[1,0,0,1,0,0]){this.dirty=!1,this.m=N&&N.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(N){N.m[0]=this.m[0],N.m[1]=this.m[1],N.m[2]=this.m[2],N.m[3]=this.m[3],N.m[4]=this.m[4],N.m[5]=this.m[5]}point(N){const F=this.m;return{x:F[0]*N.x+F[2]*N.y+F[4],y:F[1]*N.x+F[3]*N.y+F[5]}}translate(N,F){return this.m[4]+=this.m[0]*N+this.m[2]*F,this.m[5]+=this.m[1]*N+this.m[3]*F,this}scale(N,F){return this.m[0]*=N,this.m[1]*=N,this.m[2]*=F,this.m[3]*=F,this}rotate(N){const F=Math.cos(N),A=Math.sin(N),R=this.m[0]*F+this.m[2]*A,T=this.m[1]*F+this.m[3]*A,D=this.m[0]*-A+this.m[2]*F,L=this.m[1]*-A+this.m[3]*F;return this.m[0]=R,this.m[1]=T,this.m[2]=D,this.m[3]=L,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(N,F){const A=this.m[0]+this.m[2]*F,R=this.m[1]+this.m[3]*F,T=this.m[2]+this.m[0]*N,D=this.m[3]+this.m[1]*N;return this.m[0]=A,this.m[1]=R,this.m[2]=T,this.m[3]=D,this}multiply(N){const F=this.m[0]*N.m[0]+this.m[2]*N.m[1],A=this.m[1]*N.m[0]+this.m[3]*N.m[1],R=this.m[0]*N.m[2]+this.m[2]*N.m[3],T=this.m[1]*N.m[2]+this.m[3]*N.m[3],D=this.m[0]*N.m[4]+this.m[2]*N.m[5]+this.m[4],L=this.m[1]*N.m[4]+this.m[3]*N.m[5]+this.m[5];return this.m[0]=F,this.m[1]=A,this.m[2]=R,this.m[3]=T,this.m[4]=D,this.m[5]=L,this}invert(){const N=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),F=this.m[3]*N,A=-this.m[1]*N,R=-this.m[2]*N,T=this.m[0]*N,D=N*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),L=N*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=F,this.m[1]=A,this.m[2]=R,this.m[3]=T,this.m[4]=D,this.m[5]=L,this}getMatrix(){return this.m}decompose(){const N=this.m[0],F=this.m[1],A=this.m[2],R=this.m[3],T=this.m[4],D=this.m[5],L=N*R-F*A,O={x:T,y:D,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(N!=0||F!=0){const G=Math.sqrt(N*N+F*F);O.rotation=F>0?Math.acos(N/G):-Math.acos(N/G),O.scaleX=G,O.scaleY=L/G,O.skewX=(N*A+F*R)/L,O.skewY=0}else if(A!=0||R!=0){const G=Math.sqrt(A*A+R*R);O.rotation=Math.PI/2-(R>0?Math.acos(-A/G):-Math.acos(A/G)),O.scaleX=L/G,O.scaleY=G,O.skewX=0,O.skewY=(N*A+F*R)/L}return O.rotation=e.Util._getRotation(O.rotation),O}}e.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",o=Math.PI/180,c=180/Math.PI,d="#",f="",p="0",m="Konva warning: ",y="Konva error: ",v="rgb(",w={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let E=[];const k=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(_){setTimeout(_,60)};e.Util={_isElement(_){return!!(_&&_.nodeType==1)},_isFunction(_){return!!(_&&_.constructor&&_.call&&_.apply)},_isPlainObject(_){return!!_&&_.constructor===Object},_isArray(_){return Object.prototype.toString.call(_)===n},_isNumber(_){return Object.prototype.toString.call(_)===s&&!isNaN(_)&&isFinite(_)},_isString(_){return Object.prototype.toString.call(_)===a},_isBoolean(_){return Object.prototype.toString.call(_)===i},isObject(_){return _ instanceof Object},isValidSelector(_){if(typeof _!="string")return!1;const N=_[0];return N==="#"||N==="."||N===N.toUpperCase()},_sign(_){return _===0||_>0?1:-1},requestAnimFrame(_){E.push(_),E.length===1&&k(function(){const N=E;E=[],N.forEach(function(F){F()})})},createCanvasElement(){const _=document.createElement("canvas");try{_.style=_.style||{}}catch{}return _},createImageElement(){return document.createElement("img")},_isInDocument(_){for(;_=_.parentNode;)if(_==document)return!0;return!1},_urlToImage(_,N){const F=e.Util.createImageElement();F.onload=function(){N(F)},F.src=_},_rgbToHex(_,N,F){return((1<<24)+(_<<16)+(N<<8)+F).toString(16).slice(1)},_hexToRgb(_){_=_.replace(d,f);const N=parseInt(_,16);return{r:N>>16&255,g:N>>8&255,b:N&255}},getRandomColor(){let _=(Math.random()*16777215<<0).toString(16);for(;_.length<6;)_=p+_;return d+_},getRGB(_){let N;return _ in w?(N=w[_],{r:N[0],g:N[1],b:N[2]}):_[0]===d?this._hexToRgb(_.substring(1)):_.substr(0,4)===v?(N=S.exec(_.replace(/ /g,"")),{r:parseInt(N[1],10),g:parseInt(N[2],10),b:parseInt(N[3],10)}):{r:0,g:0,b:0}},colorToRGBA(_){return _=_||"black",e.Util._namedColorToRBA(_)||e.Util._hex3ColorToRGBA(_)||e.Util._hex4ColorToRGBA(_)||e.Util._hex6ColorToRGBA(_)||e.Util._hex8ColorToRGBA(_)||e.Util._rgbColorToRGBA(_)||e.Util._rgbaColorToRGBA(_)||e.Util._hslColorToRGBA(_)},_namedColorToRBA(_){const N=w[_.toLowerCase()];return N?{r:N[0],g:N[1],b:N[2],a:1}:null},_rgbColorToRGBA(_){if(_.indexOf("rgb(")===0){_=_.match(/rgb\(([^)]+)\)/)[1];const N=_.split(/ *, */).map(Number);return{r:N[0],g:N[1],b:N[2],a:1}}},_rgbaColorToRGBA(_){if(_.indexOf("rgba(")===0){_=_.match(/rgba\(([^)]+)\)/)[1];const N=_.split(/ *, */).map((F,A)=>F.slice(-1)==="%"?A===3?parseInt(F)/100:parseInt(F)/100*255:Number(F));return{r:N[0],g:N[1],b:N[2],a:N[3]}}},_hex8ColorToRGBA(_){if(_[0]==="#"&&_.length===9)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:parseInt(_.slice(7,9),16)/255}},_hex6ColorToRGBA(_){if(_[0]==="#"&&_.length===7)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:1}},_hex4ColorToRGBA(_){if(_[0]==="#"&&_.length===5)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:parseInt(_[4]+_[4],16)/255}},_hex3ColorToRGBA(_){if(_[0]==="#"&&_.length===4)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:1}},_hslColorToRGBA(_){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(_)){const[N,...F]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(_),A=Number(F[0])/360,R=Number(F[1])/100,T=Number(F[2])/100;let D,L,O;if(R===0)return O=T*255,{r:Math.round(O),g:Math.round(O),b:Math.round(O),a:1};T<.5?D=T*(1+R):D=T+R-T*R;const G=2*T-D,K=[0,0,0];for(let te=0;te<3;te++)L=A+1/3*-(te-1),L<0&&L++,L>1&&L--,6*L<1?O=G+(D-G)*6*L:2*L<1?O=D:3*L<2?O=G+(D-G)*(2/3-L)*6:O=G,K[te]=O*255;return{r:Math.round(K[0]),g:Math.round(K[1]),b:Math.round(K[2]),a:1}}},haveIntersection(_,N){return!(N.x>_.x+_.width||N.x+N.width<_.x||N.y>_.y+_.height||N.y+N.height<_.y)},cloneObject(_){const N={};for(const F in _)this._isPlainObject(_[F])?N[F]=this.cloneObject(_[F]):this._isArray(_[F])?N[F]=this.cloneArray(_[F]):N[F]=_[F];return N},cloneArray(_){return _.slice(0)},degToRad(_){return _*o},radToDeg(_){return _*c},_degToRad(_){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(_)},_radToDeg(_){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(_)},_getRotation(_){return t.Konva.angleDeg?e.Util.radToDeg(_):_},_capitalize(_){return _.charAt(0).toUpperCase()+_.slice(1)},throw(_){throw new Error(y+_)},error(_){console.error(y+_)},warn(_){t.Konva.showWarnings&&console.warn(m+_)},each(_,N){for(const F in _)N(F,_[F])},_inRange(_,N,F){return N<=_&&_<F},_getProjectionToSegment(_,N,F,A,R,T){let D,L,O;const G=(_-F)*(_-F)+(N-A)*(N-A);if(G==0)D=_,L=N,O=(R-F)*(R-F)+(T-A)*(T-A);else{const K=((R-_)*(F-_)+(T-N)*(A-N))/G;K<0?(D=_,L=N,O=(_-R)*(_-R)+(N-T)*(N-T)):K>1?(D=F,L=A,O=(F-R)*(F-R)+(A-T)*(A-T)):(D=_+K*(F-_),L=N+K*(A-N),O=(D-R)*(D-R)+(L-T)*(L-T))}return[D,L,O]},_getProjectionToLine(_,N,F){const A=e.Util.cloneObject(_);let R=Number.MAX_VALUE;return N.forEach(function(T,D){if(!F&&D===N.length-1)return;const L=N[(D+1)%N.length],O=e.Util._getProjectionToSegment(T.x,T.y,L.x,L.y,_.x,_.y),G=O[0],K=O[1],te=O[2];te<R&&(A.x=G,A.y=K,R=te)}),A},_prepareArrayForTween(_,N,F){const A=[],R=[];if(_.length>N.length){const D=N;N=_,_=D}for(let D=0;D<_.length;D+=2)A.push({x:_[D],y:_[D+1]});for(let D=0;D<N.length;D+=2)R.push({x:N[D],y:N[D+1]});const T=[];return R.forEach(function(D){const L=e.Util._getProjectionToLine(D,A,F);T.push(L.x),T.push(L.y)}),T},_prepareToStringify(_){let N;_.visitedByCircularReferenceRemoval=!0;for(const F in _)if(_.hasOwnProperty(F)&&_[F]&&typeof _[F]=="object"){if(N=Object.getOwnPropertyDescriptor(_,F),_[F].visitedByCircularReferenceRemoval||e.Util._isElement(_[F]))if(N.configurable)delete _[F];else return null;else if(e.Util._prepareToStringify(_[F])===null)if(N.configurable)delete _[F];else return null}return delete _.visitedByCircularReferenceRemoval,_},_assign(_,N){for(const F in N)_[F]=N[F];return _},_getFirstPointerId(_){return _.touches?_.changedTouches[0].identifier:_.pointerId||999},releaseCanvas(..._){t.Konva.releaseCanvasOnDestroy&&_.forEach(N=>{N.width=0,N.height=0})},drawRoundedRectPath(_,N,F,A){let R=0,T=0,D=0,L=0;typeof A=="number"?R=T=D=L=Math.min(A,N/2,F/2):(R=Math.min(A[0]||0,N/2,F/2),T=Math.min(A[1]||0,N/2,F/2),L=Math.min(A[2]||0,N/2,F/2),D=Math.min(A[3]||0,N/2,F/2)),_.moveTo(R,0),_.lineTo(N-T,0),_.arc(N-T,T,T,Math.PI*3/2,0,!1),_.lineTo(N,F-L),_.arc(N-L,F-L,L,0,Math.PI/2,!1),_.lineTo(D,F),_.arc(D,F-D,D,Math.PI/2,Math.PI,!1),_.lineTo(0,R),_.arc(R,R,R,Math.PI,Math.PI*3/2,!1)}}})(nw)),nw}var Cg={},ac={},ic={},XC;function f6(){if(XC)return ic;XC=1,Object.defineProperty(ic,"__esModule",{value:!0}),ic.HitContext=ic.SceneContext=ic.Context=void 0;const e=rs(),t=jr();function r(E){const k=[],_=E.length,N=e.Util;for(let F=0;F<_;F++){let A=E[F];N._isNumber(A)?A=Math.round(A*1e3)/1e3:N._isString(A)||(A=A+""),k.push(A)}return k}const n=",",s="(",a=")",i="([",o="])",c=";",d="()",f="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],m=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],y=100;let v=class{constructor(k){this.canvas=k,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(k){k.fillEnabled()&&this._fill(k)}_fill(k){}strokeShape(k){k.hasStroke()&&this._stroke(k)}_stroke(k){}fillStrokeShape(k){k.attrs.fillAfterStrokeEnabled?(this.strokeShape(k),this.fillShape(k)):(this.fillShape(k),this.strokeShape(k))}getTrace(k,_){let N=this.traceArr,F=N.length,A="",R,T,D,L;for(R=0;R<F;R++)T=N[R],D=T.method,D?(L=T.args,A+=D,k?A+=d:e.Util._isArray(L[0])?A+=i+L.join(n)+o:(_&&(L=L.map(O=>typeof O=="number"?Math.floor(O):O)),A+=s+L.join(n)+a)):(A+=T.property,k||(A+=f+T.val)),A+=c;return A}clearTrace(){this.traceArr=[]}_trace(k){let _=this.traceArr,N;_.push(k),N=_.length,N>=y&&_.shift()}reset(){const k=this.getCanvas().getPixelRatio();this.setTransform(1*k,0,0,1*k,0,0)}getCanvas(){return this.canvas}clear(k){const _=this.getCanvas();k?this.clearRect(k.x||0,k.y||0,k.width||0,k.height||0):this.clearRect(0,0,_.getWidth()/_.pixelRatio,_.getHeight()/_.pixelRatio)}_applyLineCap(k){const _=k.attrs.lineCap;_&&this.setAttr("lineCap",_)}_applyOpacity(k){const _=k.getAbsoluteOpacity();_!==1&&this.setAttr("globalAlpha",_)}_applyLineJoin(k){const _=k.attrs.lineJoin;_&&this.setAttr("lineJoin",_)}setAttr(k,_){this._context[k]=_}arc(k,_,N,F,A,R){this._context.arc(k,_,N,F,A,R)}arcTo(k,_,N,F,A){this._context.arcTo(k,_,N,F,A)}beginPath(){this._context.beginPath()}bezierCurveTo(k,_,N,F,A,R){this._context.bezierCurveTo(k,_,N,F,A,R)}clearRect(k,_,N,F){this._context.clearRect(k,_,N,F)}clip(...k){this._context.clip.apply(this._context,k)}closePath(){this._context.closePath()}createImageData(k,_){const N=arguments;if(N.length===2)return this._context.createImageData(k,_);if(N.length===1)return this._context.createImageData(k)}createLinearGradient(k,_,N,F){return this._context.createLinearGradient(k,_,N,F)}createPattern(k,_){return this._context.createPattern(k,_)}createRadialGradient(k,_,N,F,A,R){return this._context.createRadialGradient(k,_,N,F,A,R)}drawImage(k,_,N,F,A,R,T,D,L){const O=arguments,G=this._context;O.length===3?G.drawImage(k,_,N):O.length===5?G.drawImage(k,_,N,F,A):O.length===9&&G.drawImage(k,_,N,F,A,R,T,D,L)}ellipse(k,_,N,F,A,R,T,D){this._context.ellipse(k,_,N,F,A,R,T,D)}isPointInPath(k,_,N,F){return N?this._context.isPointInPath(N,k,_,F):this._context.isPointInPath(k,_,F)}fill(...k){this._context.fill.apply(this._context,k)}fillRect(k,_,N,F){this._context.fillRect(k,_,N,F)}strokeRect(k,_,N,F){this._context.strokeRect(k,_,N,F)}fillText(k,_,N,F){F?this._context.fillText(k,_,N,F):this._context.fillText(k,_,N)}measureText(k){return this._context.measureText(k)}getImageData(k,_,N,F){return this._context.getImageData(k,_,N,F)}lineTo(k,_){this._context.lineTo(k,_)}moveTo(k,_){this._context.moveTo(k,_)}rect(k,_,N,F){this._context.rect(k,_,N,F)}roundRect(k,_,N,F,A){this._context.roundRect(k,_,N,F,A)}putImageData(k,_,N){this._context.putImageData(k,_,N)}quadraticCurveTo(k,_,N,F){this._context.quadraticCurveTo(k,_,N,F)}restore(){this._context.restore()}rotate(k){this._context.rotate(k)}save(){this._context.save()}scale(k,_){this._context.scale(k,_)}setLineDash(k){this._context.setLineDash?this._context.setLineDash(k):"mozDash"in this._context?this._context.mozDash=k:"webkitLineDash"in this._context&&(this._context.webkitLineDash=k)}getLineDash(){return this._context.getLineDash()}setTransform(k,_,N,F,A,R){this._context.setTransform(k,_,N,F,A,R)}stroke(k){k?this._context.stroke(k):this._context.stroke()}strokeText(k,_,N,F){this._context.strokeText(k,_,N,F)}transform(k,_,N,F,A,R){this._context.transform(k,_,N,F,A,R)}translate(k,_){this._context.translate(k,_)}_enableTrace(){let k=this,_=p.length,N=this.setAttr,F,A;const R=function(T){let D=k[T],L;k[T]=function(){return A=r(Array.prototype.slice.call(arguments,0)),L=D.apply(k,arguments),k._trace({method:T,args:A}),L}};for(F=0;F<_;F++)R(p[F]);k.setAttr=function(){N.apply(k,arguments);const T=arguments[0];let D=arguments[1];(T==="shadowOffsetX"||T==="shadowOffsetY"||T==="shadowBlur")&&(D=D/this.canvas.getPixelRatio()),k._trace({property:T,val:D})}}_applyGlobalCompositeOperation(k){const _=k.attrs.globalCompositeOperation;!_||_==="source-over"||this.setAttr("globalCompositeOperation",_)}};ic.Context=v,m.forEach(function(E){Object.defineProperty(v.prototype,E,{get(){return this._context[E]},set(k){this._context[E]=k}})});class w extends v{constructor(k,{willReadFrequently:_=!1}={}){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:_})}_fillColor(k){const _=k.fill();this.setAttr("fillStyle",_),k._fillFunc(this)}_fillPattern(k){this.setAttr("fillStyle",k._getFillPattern()),k._fillFunc(this)}_fillLinearGradient(k){const _=k._getLinearGradient();_&&(this.setAttr("fillStyle",_),k._fillFunc(this))}_fillRadialGradient(k){const _=k._getRadialGradient();_&&(this.setAttr("fillStyle",_),k._fillFunc(this))}_fill(k){const _=k.fill(),N=k.getFillPriority();if(_&&N==="color"){this._fillColor(k);return}const F=k.getFillPatternImage();if(F&&N==="pattern"){this._fillPattern(k);return}const A=k.getFillLinearGradientColorStops();if(A&&N==="linear-gradient"){this._fillLinearGradient(k);return}const R=k.getFillRadialGradientColorStops();if(R&&N==="radial-gradient"){this._fillRadialGradient(k);return}_?this._fillColor(k):F?this._fillPattern(k):A?this._fillLinearGradient(k):R&&this._fillRadialGradient(k)}_strokeLinearGradient(k){const _=k.getStrokeLinearGradientStartPoint(),N=k.getStrokeLinearGradientEndPoint(),F=k.getStrokeLinearGradientColorStops(),A=this.createLinearGradient(_.x,_.y,N.x,N.y);if(F){for(let R=0;R<F.length;R+=2)A.addColorStop(F[R],F[R+1]);this.setAttr("strokeStyle",A)}}_stroke(k){const _=k.dash(),N=k.getStrokeScaleEnabled();if(k.hasStroke()){if(!N){this.save();const A=this.getCanvas().getPixelRatio();this.setTransform(A,0,0,A,0,0)}this._applyLineCap(k),_&&k.dashEnabled()&&(this.setLineDash(_),this.setAttr("lineDashOffset",k.dashOffset())),this.setAttr("lineWidth",k.strokeWidth()),k.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),k.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(k):this.setAttr("strokeStyle",k.stroke()),k._strokeFunc(this),N||this.restore()}}_applyShadow(k){var _,N,F;const A=(_=k.getShadowRGBA())!==null&&_!==void 0?_:"black",R=(N=k.getShadowBlur())!==null&&N!==void 0?N:5,T=(F=k.getShadowOffset())!==null&&F!==void 0?F:{x:0,y:0},D=k.getAbsoluteScale(),L=this.canvas.getPixelRatio(),O=D.x*L,G=D.y*L;this.setAttr("shadowColor",A),this.setAttr("shadowBlur",R*Math.min(Math.abs(O),Math.abs(G))),this.setAttr("shadowOffsetX",T.x*O),this.setAttr("shadowOffsetY",T.y*G)}}ic.SceneContext=w;class S extends v{constructor(k){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:!0})}_fill(k){this.save(),this.setAttr("fillStyle",k.colorKey),k._fillFuncHit(this),this.restore()}strokeShape(k){k.hasHitStroke()&&this._stroke(k)}_stroke(k){if(k.hasHitStroke()){const _=k.getStrokeScaleEnabled();if(!_){this.save();const A=this.getCanvas().getPixelRatio();this.setTransform(A,0,0,A,0,0)}this._applyLineCap(k);const N=k.hitStrokeWidth(),F=N==="auto"?k.strokeWidth():N;this.setAttr("lineWidth",F),this.setAttr("strokeStyle",k.colorKey),k._strokeFuncHit(this),_||this.restore()}}}return ic.HitContext=S,ic}var YC;function Ny(){if(YC)return ac;YC=1,Object.defineProperty(ac,"__esModule",{value:!0}),ac.HitCanvas=ac.SceneCanvas=ac.Canvas=void 0;const e=rs(),t=f6(),r=jr();let n;function s(){if(n)return n;const c=e.Util.createCanvasElement(),d=c.getContext("2d");return n=(function(){const f=r.Konva._global.devicePixelRatio||1,p=d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1;return f/p})(),e.Util.releaseCanvas(c),n}let a=class{constructor(d){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const p=(d||{}).pixelRatio||r.Konva.pixelRatio||s();this.pixelRatio=p,this._canvas=e.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(d){const f=this.pixelRatio;this.pixelRatio=d,this.setSize(this.getWidth()/f,this.getHeight()/f)}setWidth(d){this.width=this._canvas.width=d*this.pixelRatio,this._canvas.style.width=d+"px";const f=this.pixelRatio;this.getContext()._context.scale(f,f)}setHeight(d){this.height=this._canvas.height=d*this.pixelRatio,this._canvas.style.height=d+"px";const f=this.pixelRatio;this.getContext()._context.scale(f,f)}getWidth(){return this.width}getHeight(){return this.height}setSize(d,f){this.setWidth(d||0),this.setHeight(f||0)}toDataURL(d,f){try{return this._canvas.toDataURL(d,f)}catch{try{return this._canvas.toDataURL()}catch(m){return e.Util.error("Unable to get data URL. "+m.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};ac.Canvas=a;class i extends a{constructor(d={width:0,height:0,willReadFrequently:!1}){super(d),this.context=new t.SceneContext(this,{willReadFrequently:d.willReadFrequently}),this.setSize(d.width,d.height)}}ac.SceneCanvas=i;class o extends a{constructor(d={width:0,height:0}){super(d),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(d.width,d.height)}}return ac.HitCanvas=o,ac}var sw={},JC;function Z2(){return JC||(JC=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=jr(),r=rs();e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];e.DD._dragElements.forEach((a,i)=>{const{node:o}=a,c=o.getStage();c.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const d=c._changedPointerPositions.find(f=>f.id===a.pointerId);if(d){if(a.dragStatus!=="dragging"){const f=o.dragDistance();if(Math.max(Math.abs(d.x-a.startPointerPos.x),Math.abs(d.y-a.startPointerPos.y))<f||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),s.push(o)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];e.DD._dragElements.forEach(a=>{const{node:i}=a,o=i.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(f=>f.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const d=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;d&&s.indexOf(d)===-1&&s.push(d)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(sw)),sw}var aw={},mi={},QC;function Wr(){if(QC)return mi;QC=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.RGBComponent=n,mi.alphaComponent=s,mi.getNumberValidator=a,mi.getNumberOrArrayOfNumbersValidator=i,mi.getNumberOrAutoValidator=o,mi.getStringValidator=c,mi.getStringOrGradientValidator=d,mi.getFunctionValidator=f,mi.getNumberArrayValidator=p,mi.getBooleanValidator=m,mi.getComponentValidator=y;const e=jr(),t=rs();function r(v){return t.Util._isString(v)?'"'+v+'"':Object.prototype.toString.call(v)==="[object Number]"||t.Util._isBoolean(v)?v:Object.prototype.toString.call(v)}function n(v){return v>255?255:v<0?0:Math.round(v)}function s(v){return v>1?1:v<1e-4?1e-4:v}function a(){if(e.Konva.isUnminified)return function(v,w){return t.Util._isNumber(v)||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a number.'),v}}function i(v){if(e.Konva.isUnminified)return function(w,S){let E=t.Util._isNumber(w),k=t.Util._isArray(w)&&w.length==v;return!E&&!k&&t.Util.warn(r(w)+' is a not valid value for "'+S+'" attribute. The value should be a number or Array<number>('+v+")"),w}}function o(){if(e.Konva.isUnminified)return function(v,w){return t.Util._isNumber(v)||v==="auto"||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a number or "auto".'),v}}function c(){if(e.Konva.isUnminified)return function(v,w){return t.Util._isString(v)||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a string.'),v}}function d(){if(e.Konva.isUnminified)return function(v,w){const S=t.Util._isString(v),E=Object.prototype.toString.call(v)==="[object CanvasGradient]"||v&&v.addColorStop;return S||E||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a string or a native gradient.'),v}}function f(){if(e.Konva.isUnminified)return function(v,w){return t.Util._isFunction(v)||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a function.'),v}}function p(){if(e.Konva.isUnminified)return function(v,w){const S=Int8Array?Object.getPrototypeOf(Int8Array):null;return S&&v instanceof S||(t.Util._isArray(v)?v.forEach(function(E){t.Util._isNumber(E)||t.Util.warn('"'+w+'" attribute has non numeric element '+E+". Make sure that all elements are numbers.")}):t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a array of numbers.')),v}}function m(){if(e.Konva.isUnminified)return function(v,w){return v===!0||v===!1||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a boolean.'),v}}function y(v){if(e.Konva.isUnminified)return function(w,S){return w==null||t.Util.isObject(w)||t.Util.warn(r(w)+' is a not valid value for "'+S+'" attribute. The value should be an object with properties '+v),w}}return mi}var ZC;function Br(){return ZC||(ZC=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=rs(),r=Wr(),n="get",s="set";e.Factory={addGetterSetter(a,i,o,c,d){e.Factory.addGetter(a,i,o),e.Factory.addSetter(a,i,c,d),e.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,o){const c=n+t.Util._capitalize(i);a.prototype[c]=a.prototype[c]||function(){const d=this.attrs[i];return d===void 0?o:d}},addSetter(a,i,o,c){const d=s+t.Util._capitalize(i);a.prototype[d]||e.Factory.overWriteSetter(a,i,o,c)},overWriteSetter(a,i,o,c){const d=s+t.Util._capitalize(i);a.prototype[d]=function(f){return o&&f!==void 0&&f!==null&&(f=o.call(this,f,i)),this._setAttr(i,f),c&&c.call(this),this}},addComponentsGetterSetter(a,i,o,c,d){const f=o.length,p=t.Util._capitalize,m=n+p(i),y=s+p(i);a.prototype[m]=function(){const w={};for(let S=0;S<f;S++){const E=o[S];w[E]=this.getAttr(i+p(E))}return w};const v=(0,r.getComponentValidator)(o);a.prototype[y]=function(w){const S=this.attrs[i];c&&(w=c.call(this,w,i)),v&&v.call(this,w,i);for(const E in w)w.hasOwnProperty(E)&&this._setAttr(i+p(E),w[E]);return w||o.forEach(E=>{this._setAttr(i+p(E),void 0)}),this._fireChangeEvent(i,S,w),d&&d.call(this),this},e.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const o=t.Util._capitalize(i),c=s+o,d=n+o;a.prototype[i]=function(){return arguments.length?(this[c](arguments[0]),this):this[d]()}},addDeprecatedGetterSetter(a,i,o,c){t.Util.error("Adding deprecated "+i);const d=n+t.Util._capitalize(i),f=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[d]=function(){t.Util.error(f);const p=this.attrs[i];return p===void 0?o:p},e.Factory.addSetter(a,i,c,function(){t.Util.error(f)}),e.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){t.Util.each(i,function(o,c){const d=a.prototype[c],f=n+t.Util._capitalize(o),p=s+t.Util._capitalize(o);function m(){d.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}a.prototype[o]=m,a.prototype[f]=m,a.prototype[p]=m})},afterSetFilter(){this._filterUpToDate=!1}}})(aw)),aw}var eT;function gs(){if(eT)return Cg;eT=1,Object.defineProperty(Cg,"__esModule",{value:!0}),Cg.Node=void 0;const e=Ny(),t=Z2(),r=Br(),n=jr(),s=rs(),a=Wr(),i="absoluteOpacity",o="allEventListeners",c="absoluteTransform",d="absoluteScale",f="canvas",p="Change",m="children",y="konva",v="listening",w="mouseenter",S="mouseleave",E="pointerenter",k="pointerleave",_="touchenter",N="touchleave",F="set",A="Shape",R=" ",T="stage",D="transform",L="Stage",O="visible",G=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(R);let K=1,te=class y_{constructor(I){this._id=K++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(I),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(I){(I===D||I===c)&&this._cache.get(I)?this._cache.get(I).dirty=!0:I?this._cache.delete(I):this._cache.clear()}_getCache(I,W){let B=this._cache.get(I);return(B===void 0||(I===D||I===c)&&B.dirty===!0)&&(B=W.call(this),this._cache.set(I,B)),B}_calculate(I,W,B){if(!this._attachedDepsListeners.get(I)){const Y=W.map(V=>V+"Change.konva").join(R);this.on(Y,()=>{this._clearCache(I)}),this._attachedDepsListeners.set(I,!0)}return this._getCache(I,B)}_getCanvasCache(){return this._cache.get(f)}_clearSelfAndDescendantCache(I){this._clearCache(I),I===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(f)){const{scene:I,filter:W,hit:B,buffer:Y}=this._cache.get(f);s.Util.releaseCanvas(I,W,B,Y),this._cache.delete(f)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(I){const W=I||{};let B={};(W.x===void 0||W.y===void 0||W.width===void 0||W.height===void 0)&&(B=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let Y=Math.ceil(W.width||B.width),V=Math.ceil(W.height||B.height),H=W.pixelRatio,X=W.x===void 0?Math.floor(B.x):W.x,se=W.y===void 0?Math.floor(B.y):W.y,ie=W.offset||0,ae=W.drawBorder||!1,Q=W.hitCanvasPixelRatio||1;if(!Y||!V){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const le=Math.abs(Math.round(B.x)-X)>.5?1:0,_e=Math.abs(Math.round(B.y)-se)>.5?1:0;Y+=ie*2+le,V+=ie*2+_e,X-=ie,se-=ie;const ke=new e.SceneCanvas({pixelRatio:H,width:Y,height:V}),Oe=new e.SceneCanvas({pixelRatio:H,width:0,height:0,willReadFrequently:!0}),ge=new e.HitCanvas({pixelRatio:Q,width:Y,height:V}),ye=ke.getContext(),Ke=ge.getContext(),Xe=new e.SceneCanvas({width:ke.width/ke.pixelRatio+Math.abs(X),height:ke.height/ke.pixelRatio+Math.abs(se),pixelRatio:ke.pixelRatio}),lt=Xe.getContext();return ge.isCache=!0,ke.isCache=!0,this._cache.delete(f),this._filterUpToDate=!1,W.imageSmoothingEnabled===!1&&(ke.getContext()._context.imageSmoothingEnabled=!1,Oe.getContext()._context.imageSmoothingEnabled=!1),ye.save(),Ke.save(),lt.save(),ye.translate(-X,-se),Ke.translate(-X,-se),lt.translate(-X,-se),Xe.x=X,Xe.y=se,this._isUnderCache=!0,this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(d),this.drawScene(ke,this,Xe),this.drawHit(ge,this),this._isUnderCache=!1,ye.restore(),Ke.restore(),ae&&(ye.save(),ye.beginPath(),ye.rect(0,0,Y,V),ye.closePath(),ye.setAttr("strokeStyle","red"),ye.setAttr("lineWidth",5),ye.stroke(),ye.restore()),this._cache.set(f,{scene:ke,filter:Oe,hit:ge,buffer:Xe,x:X,y:se}),this._requestDraw(),this}isCached(){return this._cache.has(f)}getClientRect(I){throw new Error('abstract "getClientRect" method call')}_transformedRect(I,W){const B=[{x:I.x,y:I.y},{x:I.x+I.width,y:I.y},{x:I.x+I.width,y:I.y+I.height},{x:I.x,y:I.y+I.height}];let Y=1/0,V=1/0,H=-1/0,X=-1/0;const se=this.getAbsoluteTransform(W);return B.forEach(function(ie){const ae=se.point(ie);Y===void 0&&(Y=H=ae.x,V=X=ae.y),Y=Math.min(Y,ae.x),V=Math.min(V,ae.y),H=Math.max(H,ae.x),X=Math.max(X,ae.y)}),{x:Y,y:V,width:H-Y,height:X-V}}_drawCachedSceneCanvas(I){I.save(),I._applyOpacity(this),I._applyGlobalCompositeOperation(this);const W=this._getCanvasCache();I.translate(W.x,W.y);const B=this._getCachedSceneCanvas(),Y=B.pixelRatio;I.drawImage(B._canvas,0,0,B.width/Y,B.height/Y),I.restore()}_drawCachedHitCanvas(I){const W=this._getCanvasCache(),B=W.hit;I.save(),I.translate(W.x,W.y),I.drawImage(B._canvas,0,0,B.width/B.pixelRatio,B.height/B.pixelRatio),I.restore()}_getCachedSceneCanvas(){let I=this.filters(),W=this._getCanvasCache(),B=W.scene,Y=W.filter,V=Y.getContext(),H,X,se,ie;if(I){if(!this._filterUpToDate){const ae=B.pixelRatio;Y.setSize(B.width/B.pixelRatio,B.height/B.pixelRatio);try{for(H=I.length,V.clear(),V.drawImage(B._canvas,0,0,B.getWidth()/ae,B.getHeight()/ae),X=V.getImageData(0,0,Y.getWidth(),Y.getHeight()),se=0;se<H;se++){if(ie=I[se],typeof ie!="function"){s.Util.error("Filter should be type of function, but got "+typeof ie+" instead. Please check correct filters");continue}ie.call(this,X),V.putImageData(X,0,0)}}catch(Q){s.Util.error("Unable to apply filter. "+Q.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return Y}return B}on(I,W){if(this._cache&&this._cache.delete(o),arguments.length===3)return this._delegate.apply(this,arguments);const B=I.split(R);for(let Y=0;Y<B.length;Y++){const H=B[Y].split("."),X=H[0],se=H[1]||"";this.eventListeners[X]||(this.eventListeners[X]=[]),this.eventListeners[X].push({name:se,handler:W})}return this}off(I,W){let B=(I||"").split(R),Y=B.length,V,H,X,se,ie,ae;if(this._cache&&this._cache.delete(o),!I)for(H in this.eventListeners)this._off(H);for(V=0;V<Y;V++)if(X=B[V],se=X.split("."),ie=se[0],ae=se[1],ie)this.eventListeners[ie]&&this._off(ie,ae,W);else for(H in this.eventListeners)this._off(H,ae,W);return this}dispatchEvent(I){const W={target:this,type:I.type,evt:I};return this.fire(I.type,W),this}addEventListener(I,W){return this.on(I,function(B){W.call(this,B.evt)}),this}removeEventListener(I){return this.off(I),this}_delegate(I,W,B){const Y=this;this.on(I,function(V){const H=V.target.findAncestors(W,!0,Y);for(let X=0;X<H.length;X++)V=s.Util.cloneObject(V),V.currentTarget=H[X],B.call(H[X],V)})}remove(){return this.isDragging()&&this.stopDrag(),t.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(d),this._clearSelfAndDescendantCache(T),this._clearSelfAndDescendantCache(O),this._clearSelfAndDescendantCache(v)}_remove(){this._clearCaches();const I=this.getParent();I&&I.children&&(I.children.splice(this.index,1),I._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(I){const W="get"+s.Util._capitalize(I);return s.Util._isFunction(this[W])?this[W]():this.attrs[I]}getAncestors(){let I=this.getParent(),W=[];for(;I;)W.push(I),I=I.getParent();return W}getAttrs(){return this.attrs||{}}setAttrs(I){return this._batchTransformChanges(()=>{let W,B;if(!I)return this;for(W in I)W!==m&&(B=F+s.Util._capitalize(W),s.Util._isFunction(this[B])?this[B](I[W]):this._setAttr(W,I[W]))}),this}isListening(){return this._getCache(v,this._isListening)}_isListening(I){if(!this.listening())return!1;const B=this.getParent();return B&&B!==I&&this!==I?B._isListening(I):!0}isVisible(){return this._getCache(O,this._isVisible)}_isVisible(I){if(!this.visible())return!1;const B=this.getParent();return B&&B!==I&&this!==I?B._isVisible(I):!0}shouldDrawHit(I,W=!1){if(I)return this._isVisible(I)&&this._isListening(I);const B=this.getLayer();let Y=!1;t.DD._dragElements.forEach(H=>{H.dragStatus==="dragging"&&(H.node.nodeType==="Stage"||H.node.getLayer()===B)&&(Y=!0)});const V=!W&&!n.Konva.hitOnDragEnabled&&(Y||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!V}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let I=this.getDepth(),W=this,B=0,Y,V,H,X;function se(ae){for(Y=[],V=ae.length,H=0;H<V;H++)X=ae[H],B++,X.nodeType!==A&&(Y=Y.concat(X.getChildren().slice())),X._id===W._id&&(H=V);Y.length>0&&Y[0].getDepth()<=I&&se(Y)}const ie=this.getStage();return W.nodeType!==L&&ie&&se(ie.getChildren()),B}getDepth(){let I=0,W=this.parent;for(;W;)I++,W=W.parent;return I}_batchTransformChanges(I){this._batchingTransformChange=!0,I(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(D),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(I){return this._batchTransformChanges(()=>{this.x(I.x),this.y(I.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const I=this.getStage();if(!I)return null;const W=I.getPointerPosition();if(!W)return null;const B=this.getAbsoluteTransform().copy();return B.invert(),B.point(W)}getAbsolutePosition(I){let W=!1,B=this.parent;for(;B;){if(B.isCached()){W=!0;break}B=B.parent}W&&!I&&(I=!0);const Y=this.getAbsoluteTransform(I).getMatrix(),V=new s.Transform,H=this.offset();return V.m=Y.slice(),V.translate(H.x,H.y),V.getTranslation()}setAbsolutePosition(I){const{x:W,y:B,...Y}=this._clearTransform();this.attrs.x=W,this.attrs.y=B,this._clearCache(D);const V=this._getAbsoluteTransform().copy();return V.invert(),V.translate(I.x,I.y),I={x:this.attrs.x+V.getTranslation().x,y:this.attrs.y+V.getTranslation().y},this._setTransform(Y),this.setPosition({x:I.x,y:I.y}),this._clearCache(D),this._clearSelfAndDescendantCache(c),this}_setTransform(I){let W;for(W in I)this.attrs[W]=I[W]}_clearTransform(){const I={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,I}move(I){let W=I.x,B=I.y,Y=this.x(),V=this.y();return W!==void 0&&(Y+=W),B!==void 0&&(V+=B),this.setPosition({x:Y,y:V}),this}_eachAncestorReverse(I,W){let B=[],Y=this.getParent(),V,H;if(!(W&&W._id===this._id)){for(B.unshift(this);Y&&(!W||Y._id!==W._id);)B.unshift(Y),Y=Y.parent;for(V=B.length,H=0;H<V;H++)I(B[H])}}rotate(I){return this.rotation(this.rotation()+I),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const I=this.index,W=this.parent.getChildren().length;return I<W-1?(this.parent.children.splice(I,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const I=this.index,W=this.parent.getChildren().length;return I<W-1?(this.parent.children.splice(I,1),this.parent.children.splice(I+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const I=this.index;return I>0?(this.parent.children.splice(I,1),this.parent.children.splice(I-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const I=this.index;return I>0?(this.parent.children.splice(I,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(I){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(I<0||I>=this.parent.children.length)&&s.Util.warn("Unexpected value "+I+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const W=this.index;return this.parent.children.splice(W,1),this.parent.children.splice(I,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(i,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let I=this.opacity();const W=this.getParent();return W&&!W._isUnderCache&&(I*=W.getAbsoluteOpacity()),I}moveTo(I){return this.getParent()!==I&&(this._remove(),I.add(this)),this}toObject(){let I=this.getAttrs(),W,B,Y,V,H;const X={attrs:{},className:this.getClassName()};for(W in I)B=I[W],H=s.Util.isObject(B)&&!s.Util._isPlainObject(B)&&!s.Util._isArray(B),!H&&(Y=typeof this[W]=="function"&&this[W],delete I[W],V=Y?Y.call(this):null,I[W]=B,V!==B&&(X.attrs[W]=B));return s.Util._prepareToStringify(X)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(I,W,B){const Y=[];W&&this._isMatch(I)&&Y.push(this);let V=this.parent;for(;V;){if(V===B)return Y;V._isMatch(I)&&Y.push(V),V=V.parent}return Y}isAncestorOf(I){return!1}findAncestor(I,W,B){return this.findAncestors(I,W,B)[0]}_isMatch(I){if(!I)return!1;if(typeof I=="function")return I(this);let W=I.replace(/ /g,"").split(","),B=W.length,Y,V;for(Y=0;Y<B;Y++)if(V=W[Y],s.Util.isValidSelector(V)||(s.Util.warn('Selector "'+V+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),V.charAt(0)==="#"){if(this.id()===V.slice(1))return!0}else if(V.charAt(0)==="."){if(this.hasName(V.slice(1)))return!0}else if(this.className===V||this.nodeType===V)return!0;return!1}getLayer(){const I=this.getParent();return I?I.getLayer():null}getStage(){return this._getCache(T,this._getStage)}_getStage(){const I=this.getParent();return I?I.getStage():null}fire(I,W={},B){return W.target=W.target||this,B?this._fireAndBubble(I,W):this._fire(I,W),this}getAbsoluteTransform(I){return I?this._getAbsoluteTransform(I):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(I){let W;if(I)return W=new s.Transform,this._eachAncestorReverse(function(B){const Y=B.transformsEnabled();Y==="all"?W.multiply(B.getTransform()):Y==="position"&&W.translate(B.x()-B.offsetX(),B.y()-B.offsetY())},I),W;{W=this._cache.get(c)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(W):W.reset();const B=this.transformsEnabled();if(B==="all")W.multiply(this.getTransform());else if(B==="position"){const Y=this.attrs.x||0,V=this.attrs.y||0,H=this.attrs.offsetX||0,X=this.attrs.offsetY||0;W.translate(Y-H,V-X)}return W.dirty=!1,W}}getAbsoluteScale(I){let W=this;for(;W;)W._isUnderCache&&(I=W),W=W.getParent();const Y=this.getAbsoluteTransform(I).decompose();return{x:Y.scaleX,y:Y.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(D,this._getTransform)}_getTransform(){var I,W;const B=this._cache.get(D)||new s.Transform;B.reset();const Y=this.x(),V=this.y(),H=n.Konva.getAngle(this.rotation()),X=(I=this.attrs.scaleX)!==null&&I!==void 0?I:1,se=(W=this.attrs.scaleY)!==null&&W!==void 0?W:1,ie=this.attrs.skewX||0,ae=this.attrs.skewY||0,Q=this.attrs.offsetX||0,le=this.attrs.offsetY||0;return(Y!==0||V!==0)&&B.translate(Y,V),H!==0&&B.rotate(H),(ie!==0||ae!==0)&&B.skew(ie,ae),(X!==1||se!==1)&&B.scale(X,se),(Q!==0||le!==0)&&B.translate(-1*Q,-1*le),B.dirty=!1,B}clone(I){let W=s.Util.cloneObject(this.attrs),B,Y,V,H,X;for(B in I)W[B]=I[B];const se=new this.constructor(W);for(B in this.eventListeners)for(Y=this.eventListeners[B],V=Y.length,H=0;H<V;H++)X=Y[H],X.name.indexOf(y)<0&&(se.eventListeners[B]||(se.eventListeners[B]=[]),se.eventListeners[B].push(X));return se}_toKonvaCanvas(I){I=I||{};const W=this.getClientRect(),B=this.getStage(),Y=I.x!==void 0?I.x:Math.floor(W.x),V=I.y!==void 0?I.y:Math.floor(W.y),H=I.pixelRatio||1,X=new e.SceneCanvas({width:I.width||Math.ceil(W.width)||(B?B.width():0),height:I.height||Math.ceil(W.height)||(B?B.height():0),pixelRatio:H}),se=X.getContext(),ie=new e.SceneCanvas({width:X.width/X.pixelRatio+Math.abs(Y),height:X.height/X.pixelRatio+Math.abs(V),pixelRatio:X.pixelRatio});return I.imageSmoothingEnabled===!1&&(se._context.imageSmoothingEnabled=!1),se.save(),(Y||V)&&se.translate(-1*Y,-1*V),this.drawScene(X,void 0,ie),se.restore(),X}toCanvas(I){return this._toKonvaCanvas(I)._canvas}toDataURL(I){I=I||{};const W=I.mimeType||null,B=I.quality||null,Y=this._toKonvaCanvas(I).toDataURL(W,B);return I.callback&&I.callback(Y),Y}toImage(I){return new Promise((W,B)=>{try{const Y=I?.callback;Y&&delete I.callback,s.Util._urlToImage(this.toDataURL(I),function(V){W(V),Y?.(V)})}catch(Y){B(Y)}})}toBlob(I){return new Promise((W,B)=>{try{const Y=I?.callback;Y&&delete I.callback,this.toCanvas(I).toBlob(V=>{W(V),Y?.(V)},I?.mimeType,I?.quality)}catch(Y){B(Y)}})}setSize(I){return this.width(I.width),this.height(I.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(I,W,B){let Y=this.eventListeners[I],V,H,X;for(V=0;V<Y.length;V++)if(H=Y[V].name,X=Y[V].handler,(H!=="konva"||W==="konva")&&(!W||H===W)&&(!B||B===X)){if(Y.splice(V,1),Y.length===0){delete this.eventListeners[I];break}V--}}_fireChangeEvent(I,W,B){this._fire(I+p,{oldVal:W,newVal:B})}addName(I){if(!this.hasName(I)){const W=this.name(),B=W?W+" "+I:I;this.name(B)}return this}hasName(I){if(!I)return!1;const W=this.name();return W?(W||"").split(/\s/g).indexOf(I)!==-1:!1}removeName(I){const W=(this.name()||"").split(/\s/g),B=W.indexOf(I);return B!==-1&&(W.splice(B,1),this.name(W.join(" "))),this}setAttr(I,W){const B=this[F+s.Util._capitalize(I)];return s.Util._isFunction(B)?B.call(this,W):this._setAttr(I,W),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const I=this.getLayer()||this.getStage();I?.batchDraw()}}_setAttr(I,W){const B=this.attrs[I];B===W&&!s.Util.isObject(W)||(W==null?delete this.attrs[I]:this.attrs[I]=W,this._shouldFireChangeEvents&&this._fireChangeEvent(I,B,W),this._requestDraw())}_setComponentAttr(I,W,B){let Y;B!==void 0&&(Y=this.attrs[I],Y||(this.attrs[I]=this.getAttr(I)),this.attrs[I][W]=B,this._fireChangeEvent(I,Y,B))}_fireAndBubble(I,W,B){W&&this.nodeType===A&&(W.target=this);const Y=[w,S,E,k,_,N];if(!(Y.indexOf(I)!==-1&&(B&&(this===B||this.isAncestorOf&&this.isAncestorOf(B))||this.nodeType==="Stage"&&!B))){this._fire(I,W);const H=Y.indexOf(I)!==-1&&B&&B.isAncestorOf&&B.isAncestorOf(this)&&!B.isAncestorOf(this.parent);(W&&!W.cancelBubble||!W)&&this.parent&&this.parent.isListening()&&!H&&(B&&B.parent?this._fireAndBubble.call(this.parent,I,W,B):this._fireAndBubble.call(this.parent,I,W))}}_getProtoListeners(I){var W,B,Y;const V=(W=this._cache.get(o))!==null&&W!==void 0?W:{};let H=V?.[I];if(H===void 0){H=[];let X=Object.getPrototypeOf(this);for(;X;){const se=(Y=(B=X.eventListeners)===null||B===void 0?void 0:B[I])!==null&&Y!==void 0?Y:[];H.push(...se),X=Object.getPrototypeOf(X)}V[I]=H,this._cache.set(o,V)}return H}_fire(I,W){W=W||{},W.currentTarget=this,W.type=I;const B=this._getProtoListeners(I);if(B)for(let V=0;V<B.length;V++)B[V].handler.call(this,W);const Y=this.eventListeners[I];if(Y)for(let V=0;V<Y.length;V++)Y[V].handler.call(this,W)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(I){const W=I?I.pointerId:void 0,B=this.getStage(),Y=this.getAbsolutePosition();if(!B)return;const V=B._getPointerById(W)||B._changedPointerPositions[0]||Y;t.DD._dragElements.set(this._id,{node:this,startPointerPos:V,offset:{x:V.x-Y.x,y:V.y-Y.y},dragStatus:"ready",pointerId:W})}startDrag(I,W=!0){t.DD._dragElements.has(this._id)||this._createDragElement(I);const B=t.DD._dragElements.get(this._id);B.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:I&&I.evt},W)}_setDragPosition(I,W){const B=this.getStage()._getPointerById(W.pointerId);if(!B)return;let Y={x:B.x-W.offset.x,y:B.y-W.offset.y};const V=this.dragBoundFunc();if(V!==void 0){const H=V.call(this,Y,I);H?Y=H:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==Y.x||this._lastPos.y!==Y.y)&&(this.setAbsolutePosition(Y),this._requestDraw()),this._lastPos=Y}stopDrag(I){const W=t.DD._dragElements.get(this._id);W&&(W.dragStatus="stopped"),t.DD._endDragBefore(I),t.DD._endDragAfter(I)}setDraggable(I){this._setAttr("draggable",I),this._dragChange()}isDragging(){const I=t.DD._dragElements.get(this._id);return I?I.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(I){if(!(!(I.evt.button!==void 0)||n.Konva.dragButtons.indexOf(I.evt.button)>=0)||this.isDragging())return;let Y=!1;t.DD._dragElements.forEach(V=>{this.isAncestorOf(V.node)&&(Y=!0)}),Y||this._createDragElement(I)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const W=t.DD._dragElements.get(this._id),B=W&&W.dragStatus==="dragging",Y=W&&W.dragStatus==="ready";B?this.stopDrag():Y&&t.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(I={x:0,y:0}){const W=this.getStage();if(!W)return!1;const B={x:-I.x,y:-I.y,width:W.width()+2*I.x,height:W.height()+2*I.y};return s.Util.haveIntersection(B,this.getClientRect())}static create(I,W){return s.Util._isString(I)&&(I=JSON.parse(I)),this._createNode(I,W)}static _createNode(I,W){let B=y_.prototype.getClassName.call(I),Y=I.children,V,H,X;W&&(I.attrs.container=W),n.Konva[B]||(s.Util.warn('Can not find a node with class name "'+B+'". Fallback to "Shape".'),B="Shape");const se=n.Konva[B];if(V=new se(I.attrs),Y)for(H=Y.length,X=0;X<H;X++)V.add(y_._createNode(Y[X]));return V}};Cg.Node=te,te.prototype.nodeType="Node",te.prototype._attrsAffectingSize=[],te.prototype.eventListeners={},te.prototype.on.call(te.prototype,G,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(D),this._clearSelfAndDescendantCache(c)}),te.prototype.on.call(te.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(O)}),te.prototype.on.call(te.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(v)}),te.prototype.on.call(te.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(i)});const Z=r.Factory.addGetterSetter;return Z(te,"zIndex"),Z(te,"absolutePosition"),Z(te,"position"),Z(te,"x",0,(0,a.getNumberValidator)()),Z(te,"y",0,(0,a.getNumberValidator)()),Z(te,"globalCompositeOperation","source-over",(0,a.getStringValidator)()),Z(te,"opacity",1,(0,a.getNumberValidator)()),Z(te,"name","",(0,a.getStringValidator)()),Z(te,"id","",(0,a.getStringValidator)()),Z(te,"rotation",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(te,"scale",["x","y"]),Z(te,"scaleX",1,(0,a.getNumberValidator)()),Z(te,"scaleY",1,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(te,"skew",["x","y"]),Z(te,"skewX",0,(0,a.getNumberValidator)()),Z(te,"skewY",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(te,"offset",["x","y"]),Z(te,"offsetX",0,(0,a.getNumberValidator)()),Z(te,"offsetY",0,(0,a.getNumberValidator)()),Z(te,"dragDistance",void 0,(0,a.getNumberValidator)()),Z(te,"width",0,(0,a.getNumberValidator)()),Z(te,"height",0,(0,a.getNumberValidator)()),Z(te,"listening",!0,(0,a.getBooleanValidator)()),Z(te,"preventDefault",!0,(0,a.getBooleanValidator)()),Z(te,"filters",void 0,function(J){return this._filterUpToDate=!1,J}),Z(te,"visible",!0,(0,a.getBooleanValidator)()),Z(te,"transformsEnabled","all",(0,a.getStringValidator)()),Z(te,"size"),Z(te,"dragBoundFunc"),Z(te,"draggable",!1,(0,a.getBooleanValidator)()),r.Factory.backCompat(te,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Cg}var Tg={},tT;function Ay(){if(tT)return Tg;tT=1,Object.defineProperty(Tg,"__esModule",{value:!0}),Tg.Container=void 0;const e=Br(),t=gs(),r=Wr();let n=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(a){const i=this.children||[];return a?i.filter(a):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.destroy()}),this.children=[],this._requestDraw(),this}add(...a){if(a.length===0)return this;if(a.length>1){for(let o=0;o<a.length;o++)this.add(a[o]);return this}const i=a[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(a){return this._generalFind(a,!1)}findOne(a){const i=this._generalFind(a,!0);return i.length>0?i[0]:void 0}_generalFind(a,i){const o=[];return this._descendants(c=>{const d=c._isMatch(a);return d&&o.push(c),!!(d&&i)}),o}_descendants(a){let i=!1;const o=this.getChildren();for(const c of o){if(i=a(c),i)return!0;if(c.hasChildren()&&(i=c._descendants(a),i))return!0}return!1}toObject(){const a=t.Node.prototype.toObject.call(this);return a.children=[],this.getChildren().forEach(i=>{a.children.push(i.toObject())}),a}isAncestorOf(a){let i=a.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(a){const i=t.Node.prototype.clone.call(this,a);return this.getChildren().forEach(function(o){i.add(o.clone())}),i}getAllIntersections(a){const i=[];return this.find("Shape").forEach(o=>{o.isVisible()&&o.intersects(a)&&i.push(o)}),i}_clearSelfAndDescendantCache(a){var i;super._clearSelfAndDescendantCache(a),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(o){o._clearSelfAndDescendantCache(a)}))}_setChildrenIndices(){var a;(a=this.children)===null||a===void 0||a.forEach(function(i,o){i.index=o}),this._requestDraw()}drawScene(a,i,o){const c=this.getLayer(),d=a||c&&c.getCanvas(),f=d&&d.getContext(),p=this._getCanvasCache(),m=p&&p.scene,y=d&&d.isCache;if(!this.isVisible()&&!y)return this;if(m){f.save();const v=this.getAbsoluteTransform(i).getMatrix();f.transform(v[0],v[1],v[2],v[3],v[4],v[5]),this._drawCachedSceneCanvas(f),f.restore()}else this._drawChildren("drawScene",d,i,o);return this}drawHit(a,i){if(!this.shouldDrawHit(i))return this;const o=this.getLayer(),c=a||o&&o.hitCanvas,d=c&&c.getContext(),f=this._getCanvasCache();if(f&&f.hit){d.save();const m=this.getAbsoluteTransform(i).getMatrix();d.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(d),d.restore()}else this._drawChildren("drawHit",c,i);return this}_drawChildren(a,i,o,c){var d;const f=i&&i.getContext(),p=this.clipWidth(),m=this.clipHeight(),y=this.clipFunc(),v=typeof p=="number"&&typeof m=="number"||y,w=o===this;if(v){f.save();const E=this.getAbsoluteTransform(o);let k=E.getMatrix();f.transform(k[0],k[1],k[2],k[3],k[4],k[5]),f.beginPath();let _;if(y)_=y.call(this,f,this);else{const N=this.clipX(),F=this.clipY();f.rect(N||0,F||0,p,m)}f.clip.apply(f,_),k=E.copy().invert().getMatrix(),f.transform(k[0],k[1],k[2],k[3],k[4],k[5])}const S=!w&&this.globalCompositeOperation()!=="source-over"&&a==="drawScene";S&&(f.save(),f._applyGlobalCompositeOperation(this)),(d=this.children)===null||d===void 0||d.forEach(function(E){E[a](i,o,c)}),S&&f.restore(),v&&f.restore()}getClientRect(a={}){var i;const o=a.skipTransform,c=a.relativeTo;let d,f,p,m,y={x:1/0,y:1/0,width:0,height:0};const v=this;(i=this.children)===null||i===void 0||i.forEach(function(E){if(!E.visible())return;const k=E.getClientRect({relativeTo:v,skipShadow:a.skipShadow,skipStroke:a.skipStroke});k.width===0&&k.height===0||(d===void 0?(d=k.x,f=k.y,p=k.x+k.width,m=k.y+k.height):(d=Math.min(d,k.x),f=Math.min(f,k.y),p=Math.max(p,k.x+k.width),m=Math.max(m,k.y+k.height)))});const w=this.find("Shape");let S=!1;for(let E=0;E<w.length;E++)if(w[E]._isVisible(this)){S=!0;break}return S&&d!==void 0?y={x:d,y:f,width:p-d,height:m-f}:y={x:0,y:0,width:0,height:0},o?y:this._transformedRect(y,c)}};return Tg.Container=n,e.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),e.Factory.addGetterSetter(n,"clipX",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipY",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipWidth",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipHeight",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipFunc"),Tg}var iw={},xu={},rT;function h6(){if(rT)return xu;rT=1,Object.defineProperty(xu,"__esModule",{value:!0}),xu.getCapturedShape=n,xu.createEvent=s,xu.hasPointerCapture=a,xu.setPointerCapture=i,xu.releaseCapture=o;const e=jr(),t=new Map,r=e.Konva._global.PointerEvent!==void 0;function n(c){return t.get(c)}function s(c){return{evt:c,pointerId:c.pointerId}}function a(c,d){return t.get(c)===d}function i(c,d){o(c),d.getStage()&&(t.set(c,d),r&&d._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function o(c,d){const f=t.get(c);if(!f)return;const p=f.getStage();p&&p.content,t.delete(c),r&&f._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return xu}var nT;function sM(){return nT||(nT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=rs(),r=Br(),n=Ay(),s=jr(),a=Ny(),i=Z2(),o=jr(),c=h6(),d="Stage",f="string",p="px",m="mouseout",y="mouseleave",v="mouseover",w="mouseenter",S="mousemove",E="mousedown",k="mouseup",_="pointermove",N="pointerdown",F="pointerup",A="pointercancel",R="lostpointercapture",T="pointerout",D="pointerleave",L="pointerover",O="pointerenter",G="contextmenu",K="touchstart",te="touchend",Z="touchmove",J="touchcancel",I="wheel",W=5,B=[[w,"_pointerenter"],[E,"_pointerdown"],[S,"_pointermove"],[k,"_pointerup"],[y,"_pointerleave"],[K,"_pointerdown"],[Z,"_pointermove"],[te,"_pointerup"],[J,"_pointercancel"],[v,"_pointerover"],[I,"_wheel"],[G,"_contextmenu"],[N,"_pointerdown"],[_,"_pointermove"],[F,"_pointerup"],[A,"_pointercancel"],[D,"_pointerleave"],[R,"_lostpointercapture"]],Y={mouse:{[T]:m,[D]:y,[L]:v,[O]:w,[_]:S,[N]:E,[F]:k,[A]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[T]:"touchout",[D]:"touchleave",[L]:"touchover",[O]:"touchenter",[_]:Z,[N]:K,[F]:te,[A]:J,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[T]:T,[D]:D,[L]:L,[O]:O,[_]:_,[N]:N,[F]:F,[A]:A,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},V=ae=>ae.indexOf("pointer")>=0?"pointer":ae.indexOf("touch")>=0?"touch":"mouse",H=ae=>{const Q=V(ae);if(Q==="pointer")return s.Konva.pointerEventsEnabled&&Y.pointer;if(Q==="touch")return Y.touch;if(Q==="mouse")return Y.mouse};function X(ae={}){return(ae.clipFunc||ae.clipWidth||ae.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ae}const se="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class ie extends n.Container{constructor(Q){super(X(Q)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{X(this.attrs)}),this._checkVisibility()}_validateAdd(Q){const le=Q.getType()==="Layer",_e=Q.getType()==="FastLayer";le||_e||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const Q=this.visible()?"":"none";this.content.style.display=Q}setContainer(Q){if(typeof Q===f){let le;if(Q.charAt(0)==="."){const _e=Q.slice(1);Q=document.getElementsByClassName(_e)[0]}else Q.charAt(0)!=="#"?le=Q:le=Q.slice(1),Q=document.getElementById(le);if(!Q)throw"Can not find container in document with id "+le}return this._setAttr("container",Q),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),Q.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const Q=this.children,le=Q.length;for(let _e=0;_e<le;_e++)Q[_e].clear();return this}clone(Q){return Q||(Q={}),Q.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,Q)}destroy(){super.destroy();const Q=this.content;Q&&t.Util._isInDocument(Q)&&this.container().removeChild(Q);const le=e.stages.indexOf(this);return le>-1&&e.stages.splice(le,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const Q=this._pointerPositions[0]||this._changedPointerPositions[0];return Q?{x:Q.x,y:Q.y}:(t.Util.warn(se),null)}_getPointerById(Q){return this._pointerPositions.find(le=>le.id===Q)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(Q){Q=Q||{},Q.x=Q.x||0,Q.y=Q.y||0,Q.width=Q.width||this.width(),Q.height=Q.height||this.height();const le=new a.SceneCanvas({width:Q.width,height:Q.height,pixelRatio:Q.pixelRatio||1}),_e=le.getContext()._context,ke=this.children;return(Q.x||Q.y)&&_e.translate(-1*Q.x,-1*Q.y),ke.forEach(function(Oe){if(!Oe.isVisible())return;const ge=Oe._toKonvaCanvas(Q);_e.drawImage(ge._canvas,Q.x,Q.y,ge.getWidth()/ge.getPixelRatio(),ge.getHeight()/ge.getPixelRatio())}),le}getIntersection(Q){if(!Q)return null;const le=this.children,_e=le.length,ke=_e-1;for(let Oe=ke;Oe>=0;Oe--){const ge=le[Oe].getIntersection(Q);if(ge)return ge}return null}_resizeDOM(){const Q=this.width(),le=this.height();this.content&&(this.content.style.width=Q+p,this.content.style.height=le+p),this.bufferCanvas.setSize(Q,le),this.bufferHitCanvas.setSize(Q,le),this.children.forEach(_e=>{_e.setSize({width:Q,height:le}),_e.draw()})}add(Q,...le){if(arguments.length>1){for(let ke=0;ke<arguments.length;ke++)this.add(arguments[ke]);return this}super.add(Q);const _e=this.children.length;return _e>W&&t.Util.warn("The stage has "+_e+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),Q.setSize({width:this.width(),height:this.height()}),Q.draw(),s.Konva.isBrowser&&this.content.appendChild(Q.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(Q){return c.hasPointerCapture(Q,this)}setPointerCapture(Q){c.setPointerCapture(Q,this)}releaseCapture(Q){c.releaseCapture(Q,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&B.forEach(([Q,le])=>{this.content.addEventListener(Q,_e=>{this[le](_e)},{passive:!1})})}_pointerenter(Q){this.setPointersPositions(Q);const le=H(Q.type);le&&this._fire(le.pointerenter,{evt:Q,target:this,currentTarget:this})}_pointerover(Q){this.setPointersPositions(Q);const le=H(Q.type);le&&this._fire(le.pointerover,{evt:Q,target:this,currentTarget:this})}_getTargetShape(Q){let le=this[Q+"targetShape"];return le&&!le.getStage()&&(le=null),le}_pointerleave(Q){const le=H(Q.type),_e=V(Q.type);if(!le)return;this.setPointersPositions(Q);const ke=this._getTargetShape(_e),Oe=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;ke&&Oe?(ke._fireAndBubble(le.pointerout,{evt:Q}),ke._fireAndBubble(le.pointerleave,{evt:Q}),this._fire(le.pointerleave,{evt:Q,target:this,currentTarget:this}),this[_e+"targetShape"]=null):Oe&&(this._fire(le.pointerleave,{evt:Q,target:this,currentTarget:this}),this._fire(le.pointerout,{evt:Q,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(Q){const le=H(Q.type),_e=V(Q.type);if(!le)return;this.setPointersPositions(Q);let ke=!1;this._changedPointerPositions.forEach(Oe=>{const ge=this.getIntersection(Oe);if(i.DD.justDragged=!1,s.Konva["_"+_e+"ListenClick"]=!0,!ge||!ge.isListening()){this[_e+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&ge.setPointerCapture(Oe.id),this[_e+"ClickStartShape"]=ge,ge._fireAndBubble(le.pointerdown,{evt:Q,pointerId:Oe.id}),ke=!0;const ye=Q.type.indexOf("touch")>=0;ge.preventDefault()&&Q.cancelable&&ye&&Q.preventDefault()}),ke||this._fire(le.pointerdown,{evt:Q,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(Q){const le=H(Q.type),_e=V(Q.type);if(!le||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&Q.cancelable&&Q.preventDefault(),this.setPointersPositions(Q),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const Oe={};let ge=!1;const ye=this._getTargetShape(_e);this._changedPointerPositions.forEach(Ke=>{const Xe=c.getCapturedShape(Ke.id)||this.getIntersection(Ke),lt=Ke.id,Ye={evt:Q,pointerId:lt},We=ye!==Xe;if(We&&ye&&(ye._fireAndBubble(le.pointerout,{...Ye},Xe),ye._fireAndBubble(le.pointerleave,{...Ye},Xe)),Xe){if(Oe[Xe._id])return;Oe[Xe._id]=!0}Xe&&Xe.isListening()?(ge=!0,We&&(Xe._fireAndBubble(le.pointerover,{...Ye},ye),Xe._fireAndBubble(le.pointerenter,{...Ye},ye),this[_e+"targetShape"]=Xe),Xe._fireAndBubble(le.pointermove,{...Ye})):ye&&(this._fire(le.pointerover,{evt:Q,target:this,currentTarget:this,pointerId:lt}),this[_e+"targetShape"]=null)}),ge||this._fire(le.pointermove,{evt:Q,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(Q){const le=H(Q.type),_e=V(Q.type);if(!le)return;this.setPointersPositions(Q);const ke=this[_e+"ClickStartShape"],Oe=this[_e+"ClickEndShape"],ge={};let ye=!1;this._changedPointerPositions.forEach(Ke=>{const Xe=c.getCapturedShape(Ke.id)||this.getIntersection(Ke);if(Xe){if(Xe.releaseCapture(Ke.id),ge[Xe._id])return;ge[Xe._id]=!0}const lt=Ke.id,Ye={evt:Q,pointerId:lt};let We=!1;s.Konva["_"+_e+"InDblClickWindow"]?(We=!0,clearTimeout(this[_e+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+_e+"InDblClickWindow"]=!0,clearTimeout(this[_e+"DblTimeout"])),this[_e+"DblTimeout"]=setTimeout(function(){s.Konva["_"+_e+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),Xe&&Xe.isListening()?(ye=!0,this[_e+"ClickEndShape"]=Xe,Xe._fireAndBubble(le.pointerup,{...Ye}),s.Konva["_"+_e+"ListenClick"]&&ke&&ke===Xe&&(Xe._fireAndBubble(le.pointerclick,{...Ye}),We&&Oe&&Oe===Xe&&Xe._fireAndBubble(le.pointerdblclick,{...Ye}))):(this[_e+"ClickEndShape"]=null,s.Konva["_"+_e+"ListenClick"]&&this._fire(le.pointerclick,{evt:Q,target:this,currentTarget:this,pointerId:lt}),We&&this._fire(le.pointerdblclick,{evt:Q,target:this,currentTarget:this,pointerId:lt}))}),ye||this._fire(le.pointerup,{evt:Q,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+_e+"ListenClick"]=!1,Q.cancelable&&_e!=="touch"&&_e!=="pointer"&&Q.preventDefault()}_contextmenu(Q){this.setPointersPositions(Q);const le=this.getIntersection(this.getPointerPosition());le&&le.isListening()?le._fireAndBubble(G,{evt:Q}):this._fire(G,{evt:Q,target:this,currentTarget:this})}_wheel(Q){this.setPointersPositions(Q);const le=this.getIntersection(this.getPointerPosition());le&&le.isListening()?le._fireAndBubble(I,{evt:Q}):this._fire(I,{evt:Q,target:this,currentTarget:this})}_pointercancel(Q){this.setPointersPositions(Q);const le=c.getCapturedShape(Q.pointerId)||this.getIntersection(this.getPointerPosition());le&&le._fireAndBubble(F,c.createEvent(Q)),c.releaseCapture(Q.pointerId)}_lostpointercapture(Q){c.releaseCapture(Q.pointerId)}setPointersPositions(Q){const le=this._getContentPosition();let _e=null,ke=null;Q=Q||window.event,Q.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(Q.touches,Oe=>{this._pointerPositions.push({id:Oe.identifier,x:(Oe.clientX-le.left)/le.scaleX,y:(Oe.clientY-le.top)/le.scaleY})}),Array.prototype.forEach.call(Q.changedTouches||Q.touches,Oe=>{this._changedPointerPositions.push({id:Oe.identifier,x:(Oe.clientX-le.left)/le.scaleX,y:(Oe.clientY-le.top)/le.scaleY})})):(_e=(Q.clientX-le.left)/le.scaleX,ke=(Q.clientY-le.top)/le.scaleY,this.pointerPos={x:_e,y:ke},this._pointerPositions=[{x:_e,y:ke,id:t.Util._getFirstPointerId(Q)}],this._changedPointerPositions=[{x:_e,y:ke,id:t.Util._getFirstPointerId(Q)}])}_setPointerPosition(Q){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(Q)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const Q=this.content.getBoundingClientRect();return{top:Q.top,left:Q.left,scaleX:Q.width/this.content.clientWidth||1,scaleY:Q.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const Q=this.container();if(!Q)throw"Stage has no container. A container is required.";Q.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),Q.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(Q){Q.batchDraw()}),this}}e.Stage=ie,ie.prototype.nodeType=d,(0,o._registerNode)(ie),r.Factory.addGetterSetter(ie,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(ae=>{ae.batchDraw()})})})(iw)),iw}var Eg={},ow={},sT;function ea(){return sT||(sT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=jr(),r=rs(),n=Br(),s=gs(),a=Wr(),i=jr(),o=h6(),c="hasShadow",d="shadowRGBA",f="patternImage",p="linearGradient",m="radialGradient";let y;function v(){return y||(y=r.Util.createCanvasElement().getContext("2d"),y)}e.shapes={};function w(D){const L=this.attrs.fillRule;L?D.fill(L):D.fill()}function S(D){D.stroke()}function E(D){const L=this.attrs.fillRule;L?D.fill(L):D.fill()}function k(D){D.stroke()}function _(){this._clearCache(c)}function N(){this._clearCache(d)}function F(){this._clearCache(f)}function A(){this._clearCache(p)}function R(){this._clearCache(m)}class T extends s.Node{constructor(L){super(L);let O;for(;O=r.Util.getRandomColor(),!(O&&!(O in e.shapes)););this.colorKey=O,e.shapes[O]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(f,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const O=v().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(O&&O.setTransform){const G=new r.Transform;G.translate(this.fillPatternX(),this.fillPatternY()),G.rotate(t.Konva.getAngle(this.fillPatternRotation())),G.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),G.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const K=G.getMatrix(),te=typeof DOMMatrix>"u"?{a:K[0],b:K[1],c:K[2],d:K[3],e:K[4],f:K[5]}:new DOMMatrix(K);O.setTransform(te)}return O}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const L=this.fillLinearGradientColorStops();if(L){const O=v(),G=this.fillLinearGradientStartPoint(),K=this.fillLinearGradientEndPoint(),te=O.createLinearGradient(G.x,G.y,K.x,K.y);for(let Z=0;Z<L.length;Z+=2)te.addColorStop(L[Z],L[Z+1]);return te}}_getRadialGradient(){return this._getCache(m,this.__getRadialGradient)}__getRadialGradient(){const L=this.fillRadialGradientColorStops();if(L){const O=v(),G=this.fillRadialGradientStartPoint(),K=this.fillRadialGradientEndPoint(),te=O.createRadialGradient(G.x,G.y,this.fillRadialGradientStartRadius(),K.x,K.y,this.fillRadialGradientEndRadius());for(let Z=0;Z<L.length;Z+=2)te.addColorStop(L[Z],L[Z+1]);return te}}getShadowRGBA(){return this._getCache(d,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const L=r.Util.colorToRGBA(this.shadowColor());if(L)return"rgba("+L.r+","+L.g+","+L.b+","+L.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const L=this.hitStrokeWidth();return L==="auto"?this.hasStroke():this.strokeEnabled()&&!!L}intersects(L){const O=this.getStage();if(!O)return!1;const G=O.bufferHitCanvas;return G.getContext().clear(),this.drawHit(G,void 0,!0),G.context.getImageData(Math.round(L.x),Math.round(L.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(L){var O;if(!((O=this.attrs.perfectDrawEnabled)!==null&&O!==void 0?O:!0))return!1;const K=L||this.hasFill(),te=this.hasStroke(),Z=this.getAbsoluteOpacity()!==1;if(K&&te&&Z)return!0;const J=this.hasShadow(),I=this.shadowForStrokeEnabled();return!!(K&&te&&J&&I)}setStrokeHitEnabled(L){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),L?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const L=this.size();return{x:this._centroid?-L.width/2:0,y:this._centroid?-L.height/2:0,width:L.width,height:L.height}}getClientRect(L={}){let O=!1,G=this.getParent();for(;G;){if(G.isCached()){O=!0;break}G=G.getParent()}const K=L.skipTransform,te=L.relativeTo||O&&this.getStage()||void 0,Z=this.getSelfRect(),I=!L.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,W=Z.width+I,B=Z.height+I,Y=!L.skipShadow&&this.hasShadow(),V=Y?this.shadowOffsetX():0,H=Y?this.shadowOffsetY():0,X=W+Math.abs(V),se=B+Math.abs(H),ie=Y&&this.shadowBlur()||0,ae=X+ie*2,Q=se+ie*2,le={width:ae,height:Q,x:-(I/2+ie)+Math.min(V,0)+Z.x,y:-(I/2+ie)+Math.min(H,0)+Z.y};return K?le:this._transformedRect(le,te)}drawScene(L,O,G){const K=this.getLayer(),te=L||K.getCanvas(),Z=te.getContext(),J=this._getCanvasCache(),I=this.getSceneFunc(),W=this.hasShadow();let B;const Y=O===this;if(!this.isVisible()&&!Y)return this;if(J){Z.save();const V=this.getAbsoluteTransform(O).getMatrix();return Z.transform(V[0],V[1],V[2],V[3],V[4],V[5]),this._drawCachedSceneCanvas(Z),Z.restore(),this}if(!I)return this;if(Z.save(),this._useBufferCanvas()){B=this.getStage();const V=G||B.bufferCanvas,H=V.getContext();H.clear(),H.save(),H._applyLineJoin(this);const X=this.getAbsoluteTransform(O).getMatrix();H.transform(X[0],X[1],X[2],X[3],X[4],X[5]),I.call(this,H,this),H.restore();const se=V.pixelRatio;W&&Z._applyShadow(this),Z._applyOpacity(this),Z._applyGlobalCompositeOperation(this),Z.drawImage(V._canvas,V.x||0,V.y||0,V.width/se,V.height/se)}else{if(Z._applyLineJoin(this),!Y){const V=this.getAbsoluteTransform(O).getMatrix();Z.transform(V[0],V[1],V[2],V[3],V[4],V[5]),Z._applyOpacity(this),Z._applyGlobalCompositeOperation(this)}W&&Z._applyShadow(this),I.call(this,Z,this)}return Z.restore(),this}drawHit(L,O,G=!1){if(!this.shouldDrawHit(O,G))return this;const K=this.getLayer(),te=L||K.hitCanvas,Z=te&&te.getContext(),J=this.hitFunc()||this.sceneFunc(),I=this._getCanvasCache(),W=I&&I.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),W){Z.save();const Y=this.getAbsoluteTransform(O).getMatrix();return Z.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),this._drawCachedHitCanvas(Z),Z.restore(),this}if(!J)return this;if(Z.save(),Z._applyLineJoin(this),!(this===O)){const Y=this.getAbsoluteTransform(O).getMatrix();Z.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5])}return J.call(this,Z,this),Z.restore(),this}drawHitFromCache(L=0){const O=this._getCanvasCache(),G=this._getCachedSceneCanvas(),K=O.hit,te=K.getContext(),Z=K.getWidth(),J=K.getHeight();te.clear(),te.drawImage(G._canvas,0,0,Z,J);try{const I=te.getImageData(0,0,Z,J),W=I.data,B=W.length,Y=r.Util._hexToRgb(this.colorKey);for(let V=0;V<B;V+=4)W[V+3]>L?(W[V]=Y.r,W[V+1]=Y.g,W[V+2]=Y.b,W[V+3]=255):W[V+3]=0;te.putImageData(I,0,0)}catch(I){r.Util.error("Unable to draw hit graph from cached scene canvas. "+I.message)}return this}hasPointerCapture(L){return o.hasPointerCapture(L,this)}setPointerCapture(L){o.setPointerCapture(L,this)}releaseCapture(L){o.releaseCapture(L,this)}}e.Shape=T,T.prototype._fillFunc=w,T.prototype._strokeFunc=S,T.prototype._fillFuncHit=E,T.prototype._strokeFuncHit=k,T.prototype._centroid=!1,T.prototype.nodeType="Shape",(0,i._registerNode)(T),T.prototype.eventListeners={},T.prototype.on.call(T.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),T.prototype.on.call(T.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",N),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",F),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",A),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",R),n.Factory.addGetterSetter(T,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(T,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(T,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(T,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(T,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(T,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(T,"lineJoin"),n.Factory.addGetterSetter(T,"lineCap"),n.Factory.addGetterSetter(T,"sceneFunc"),n.Factory.addGetterSetter(T,"hitFunc"),n.Factory.addGetterSetter(T,"dash"),n.Factory.addGetterSetter(T,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(T,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(T,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(T,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternImage"),n.Factory.addGetterSetter(T,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(T,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(T,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(T,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(T,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(T,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(T,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(T,"fillEnabled",!0),n.Factory.addGetterSetter(T,"strokeEnabled",!0),n.Factory.addGetterSetter(T,"shadowEnabled",!0),n.Factory.addGetterSetter(T,"dashEnabled",!0),n.Factory.addGetterSetter(T,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(T,"fillPriority","color"),n.Factory.addComponentsGetterSetter(T,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(T,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(T,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(T,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(T,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(T,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(T,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(T,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(T,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(T,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(T,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(T,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(T,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(T,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(T,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(T,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(T,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(T,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(T,"fillPatternRotation",0),n.Factory.addGetterSetter(T,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(T,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(ow)),ow}var aT;function g6(){if(aT)return Eg;aT=1,Object.defineProperty(Eg,"__esModule",{value:!0}),Eg.Layer=void 0;const e=rs(),t=Ay(),r=gs(),n=Br(),s=Ny(),a=Wr(),i=ea(),o=jr(),c="#",d="beforeDraw",f="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],m=p.length;class y extends t.Container{constructor(w){super(w),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(w){return this.getContext().clear(w),this.getHitCanvas().getContext().clear(w),this}setZIndex(w){super.setZIndex(w);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),w<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[w+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);const w=this.getStage();return w&&w.content&&(w.content.removeChild(this.getNativeCanvasElement()),w.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!r.Node.prototype.moveUp.call(this))return!1;const S=this.getStage();return!S||!S.content?!1:(S.content.removeChild(this.getNativeCanvasElement()),this.index<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[this.index+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){const w=this.getStage();if(w){const S=w.children;w.content&&(w.content.removeChild(this.getNativeCanvasElement()),w.content.insertBefore(this.getNativeCanvasElement(),S[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){const w=this.getStage();if(w){const S=w.children;w.content&&(w.content.removeChild(this.getNativeCanvasElement()),w.content.insertBefore(this.getNativeCanvasElement(),S[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const w=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),w&&w.parentNode&&e.Util._isInDocument(w)&&w.parentNode.removeChild(w),this}getStage(){return this.parent}setSize({width:w,height:S}){return this.canvas.setSize(w,S),this.hitCanvas.setSize(w,S),this._setSmoothEnabled(),this}_validateAdd(w){const S=w.getType();S!=="Group"&&S!=="Shape"&&e.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(w){return w=w||{},w.width=w.width||this.getWidth(),w.height=w.height||this.getHeight(),w.x=w.x!==void 0?w.x:this.x(),w.y=w.y!==void 0?w.y:this.y(),r.Node.prototype._toKonvaCanvas.call(this,w)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){e.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){e.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,e.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(w){if(!this.isListening()||!this.isVisible())return null;let S=1,E=!1;for(;;){for(let k=0;k<m;k++){const _=p[k],N=this._getIntersection({x:w.x+_.x*S,y:w.y+_.y*S}),F=N.shape;if(F)return F;if(E=!!N.antialiased,!N.antialiased)break}if(E)S+=1;else return null}}_getIntersection(w){const S=this.hitCanvas.pixelRatio,E=this.hitCanvas.context.getImageData(Math.round(w.x*S),Math.round(w.y*S),1,1).data,k=E[3];if(k===255){const _=e.Util._rgbToHex(E[0],E[1],E[2]),N=i.shapes[c+_];return N?{shape:N}:{antialiased:!0}}else if(k>0)return{antialiased:!0};return{}}drawScene(w,S,E){const k=this.getLayer(),_=w||k&&k.getCanvas();return this._fire(d,{node:this}),this.clearBeforeDraw()&&_.getContext().clear(),t.Container.prototype.drawScene.call(this,_,S,E),this._fire(f,{node:this}),this}drawHit(w,S){const E=this.getLayer(),k=w||E&&E.hitCanvas;return E&&E.clearBeforeDraw()&&E.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,k,S),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(w){e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(w)}getHitGraphEnabled(w){return e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const w=this.parent;!!this.hitCanvas._canvas.parentNode?w.content.removeChild(this.hitCanvas._canvas):w.content.appendChild(this.hitCanvas._canvas)}destroy(){return e.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return Eg.Layer=y,y.prototype.nodeType="Layer",(0,o._registerNode)(y),n.Factory.addGetterSetter(y,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(y,"clearBeforeDraw",!0),n.Factory.addGetterSetter(y,"hitGraphEnabled",!0,(0,a.getBooleanValidator)()),Eg}var Ng={},iT;function aM(){if(iT)return Ng;iT=1,Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.FastLayer=void 0;const e=rs(),t=g6(),r=jr();class n extends t.Layer{constructor(a){super(a),this.listening(!1),e.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}return Ng.FastLayer=n,n.prototype.nodeType="FastLayer",(0,r._registerNode)(n),Ng}var Ag={},oT;function eb(){if(oT)return Ag;oT=1,Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.Group=void 0;const e=rs(),t=Ay(),r=jr();class n extends t.Container{_validateAdd(a){const i=a.getType();i!=="Group"&&i!=="Shape"&&e.Util.throw("You may only add groups and shapes to groups.")}}return Ag.Group=n,n.prototype.nodeType="Group",(0,r._registerNode)(n),Ag}var jg={},lT;function tb(){if(lT)return jg;lT=1,Object.defineProperty(jg,"__esModule",{value:!0}),jg.Animation=void 0;const e=jr(),t=rs(),r=(function(){return e.glob.performance&&e.glob.performance.now?function(){return e.glob.performance.now()}:function(){return new Date().getTime()}})();let n=class Eh{constructor(a,i){this.id=Eh.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=a,this.setLayers(i)}setLayers(a){let i=[];return a&&(i=Array.isArray(a)?a:[a]),this.layers=i,this}getLayers(){return this.layers}addLayer(a){const i=this.layers,o=i.length;for(let c=0;c<o;c++)if(i[c]._id===a._id)return!1;return this.layers.push(a),!0}isRunning(){const i=Eh.animations,o=i.length;for(let c=0;c<o;c++)if(i[c].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),Eh._addAnimation(this),this}stop(){return Eh._removeAnimation(this),this}_updateFrameObject(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(a){this.animations.push(a),this._handleAnimation()}static _removeAnimation(a){const i=a.id,o=this.animations,c=o.length;for(let d=0;d<c;d++)if(o[d].id===i){this.animations.splice(d,1);break}}static _runFrames(){const a={},i=this.animations;for(let o=0;o<i.length;o++){const c=i[o],d=c.layers,f=c.func;c._updateFrameObject(r());const p=d.length;let m;if(f?m=f.call(c,c.frame)!==!1:m=!0,!!m)for(let y=0;y<p;y++){const v=d[y];v._id!==void 0&&(a[v._id]=v)}}for(const o in a)a.hasOwnProperty(o)&&a[o].batchDraw()}static _animationLoop(){const a=Eh;a.animations.length?(a._runFrames(),t.Util.requestAnimFrame(a._animationLoop)):a.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return jg.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,jg}var lw={},cT;function iM(){return cT||(cT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=rs(),r=tb(),n=gs(),s=jr(),a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,o=2,c=3,d=["fill","stroke","shadowColor"];let f=0;class p{constructor(v,w,S,E,k,_,N){this.prop=v,this.propFunc=w,this.begin=E,this._pos=E,this.duration=_,this._change=0,this.prevPos=0,this.yoyo=N,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=S,this._change=k-this.begin,this.pause()}fire(v){const w=this[v];w&&w()}setTime(v){v>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():v<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=v,this.update())}getTime(){return this._time}setPosition(v){this.prevPos=this._pos,this.propFunc(v),this._pos=v}getPosition(v){return v===void 0&&(v=this._time),this.func(v,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(v){this.pause(),this._time=v,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const v=this.getTimer()-this._startTime;this.state===o?this.setTime(v):this.state===c&&this.setTime(this.duration-v)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class m{constructor(v){const w=this,S=v.node,E=S._id,k=v.easing||e.Easings.Linear,_=!!v.yoyo;let N,F;typeof v.duration>"u"?N=.3:v.duration===0?N=.001:N=v.duration,this.node=S,this._id=f++;const A=S.getLayer()||(S instanceof s.Konva.Stage?S.getLayers():null);A||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){w.tween.onEnterFrame()},A),this.tween=new p(F,function(R){w._tweenFunc(R)},k,0,1,N*1e3,_),this._addListeners(),m.attrs[E]||(m.attrs[E]={}),m.attrs[E][this._id]||(m.attrs[E][this._id]={}),m.tweens[E]||(m.tweens[E]={});for(F in v)a[F]===void 0&&this._addAttr(F,v[F]);this.reset(),this.onFinish=v.onFinish,this.onReset=v.onReset,this.onUpdate=v.onUpdate}_addAttr(v,w){const S=this.node,E=S._id;let k,_,N,F,A;const R=m.tweens[E][v];R&&delete m.attrs[E][R][v];let T=S.getAttr(v);if(t.Util._isArray(w))if(k=[],_=Math.max(w.length,T.length),v==="points"&&w.length!==T.length&&(w.length>T.length?(F=T,T=t.Util._prepareArrayForTween(T,w,S.closed())):(N=w,w=t.Util._prepareArrayForTween(w,T,S.closed()))),v.indexOf("fill")===0)for(let D=0;D<_;D++)if(D%2===0)k.push(w[D]-T[D]);else{const L=t.Util.colorToRGBA(T[D]);A=t.Util.colorToRGBA(w[D]),T[D]=L,k.push({r:A.r-L.r,g:A.g-L.g,b:A.b-L.b,a:A.a-L.a})}else for(let D=0;D<_;D++)k.push(w[D]-T[D]);else d.indexOf(v)!==-1?(T=t.Util.colorToRGBA(T),A=t.Util.colorToRGBA(w),k={r:A.r-T.r,g:A.g-T.g,b:A.b-T.b,a:A.a-T.a}):k=w-T;m.attrs[E][this._id][v]={start:T,diff:k,end:w,trueEnd:N,trueStart:F},m.tweens[E][v]=this._id}_tweenFunc(v){const w=this.node,S=m.attrs[w._id][this._id];let E,k,_,N,F,A,R,T;for(E in S){if(k=S[E],_=k.start,N=k.diff,T=k.end,t.Util._isArray(_))if(F=[],R=Math.max(_.length,T.length),E.indexOf("fill")===0)for(A=0;A<R;A++)A%2===0?F.push((_[A]||0)+N[A]*v):F.push("rgba("+Math.round(_[A].r+N[A].r*v)+","+Math.round(_[A].g+N[A].g*v)+","+Math.round(_[A].b+N[A].b*v)+","+(_[A].a+N[A].a*v)+")");else for(A=0;A<R;A++)F.push((_[A]||0)+N[A]*v);else d.indexOf(E)!==-1?F="rgba("+Math.round(_.r+N.r*v)+","+Math.round(_.g+N.g*v)+","+Math.round(_.b+N.b*v)+","+(_.a+N.a*v)+")":F=_+N*v;w.setAttr(E,F)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const v=this.node,w=m.attrs[v._id][this._id];w.points&&w.points.trueEnd&&v.setAttr("points",w.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const v=this.node,w=m.attrs[v._id][this._id];w.points&&w.points.trueStart&&v.points(w.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(v){return this.tween.seek(v*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const v=this.node._id,w=this._id,S=m.tweens[v];this.pause(),this.anim&&this.anim.stop();for(const E in S)delete m.tweens[v][E];delete m.attrs[v][w],m.tweens[v]&&(Object.keys(m.tweens[v]).length===0&&delete m.tweens[v],Object.keys(m.attrs[v]).length===0&&delete m.attrs[v])}}e.Tween=m,m.attrs={},m.tweens={},n.Node.prototype.to=function(y){const v=y.onFinish;y.node=this,y.onFinish=function(){this.destroy(),v&&v()},new m(y).play()},e.Easings={BackEaseIn(y,v,w,S){return w*(y/=S)*y*((1.70158+1)*y-1.70158)+v},BackEaseOut(y,v,w,S){return w*((y=y/S-1)*y*((1.70158+1)*y+1.70158)+1)+v},BackEaseInOut(y,v,w,S){let E=1.70158;return(y/=S/2)<1?w/2*(y*y*(((E*=1.525)+1)*y-E))+v:w/2*((y-=2)*y*(((E*=1.525)+1)*y+E)+2)+v},ElasticEaseIn(y,v,w,S,E,k){let _=0;return y===0?v:(y/=S)===1?v+w:(k||(k=S*.3),!E||E<Math.abs(w)?(E=w,_=k/4):_=k/(2*Math.PI)*Math.asin(w/E),-(E*Math.pow(2,10*(y-=1))*Math.sin((y*S-_)*(2*Math.PI)/k))+v)},ElasticEaseOut(y,v,w,S,E,k){let _=0;return y===0?v:(y/=S)===1?v+w:(k||(k=S*.3),!E||E<Math.abs(w)?(E=w,_=k/4):_=k/(2*Math.PI)*Math.asin(w/E),E*Math.pow(2,-10*y)*Math.sin((y*S-_)*(2*Math.PI)/k)+w+v)},ElasticEaseInOut(y,v,w,S,E,k){let _=0;return y===0?v:(y/=S/2)===2?v+w:(k||(k=S*(.3*1.5)),!E||E<Math.abs(w)?(E=w,_=k/4):_=k/(2*Math.PI)*Math.asin(w/E),y<1?-.5*(E*Math.pow(2,10*(y-=1))*Math.sin((y*S-_)*(2*Math.PI)/k))+v:E*Math.pow(2,-10*(y-=1))*Math.sin((y*S-_)*(2*Math.PI)/k)*.5+w+v)},BounceEaseOut(y,v,w,S){return(y/=S)<1/2.75?w*(7.5625*y*y)+v:y<2/2.75?w*(7.5625*(y-=1.5/2.75)*y+.75)+v:y<2.5/2.75?w*(7.5625*(y-=2.25/2.75)*y+.9375)+v:w*(7.5625*(y-=2.625/2.75)*y+.984375)+v},BounceEaseIn(y,v,w,S){return w-e.Easings.BounceEaseOut(S-y,0,w,S)+v},BounceEaseInOut(y,v,w,S){return y<S/2?e.Easings.BounceEaseIn(y*2,0,w,S)*.5+v:e.Easings.BounceEaseOut(y*2-S,0,w,S)*.5+w*.5+v},EaseIn(y,v,w,S){return w*(y/=S)*y+v},EaseOut(y,v,w,S){return-w*(y/=S)*(y-2)+v},EaseInOut(y,v,w,S){return(y/=S/2)<1?w/2*y*y+v:-w/2*(--y*(y-2)-1)+v},StrongEaseIn(y,v,w,S){return w*(y/=S)*y*y*y*y+v},StrongEaseOut(y,v,w,S){return w*((y=y/S-1)*y*y*y*y+1)+v},StrongEaseInOut(y,v,w,S){return(y/=S/2)<1?w/2*y*y*y*y*y+v:w/2*((y-=2)*y*y*y*y+2)+v},Linear(y,v,w,S){return w*y/S+v}}})(lw)),lw}var uT;function v_(){return uT||(uT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=jr(),r=rs(),n=gs(),s=Ay(),a=sM(),i=g6(),o=aM(),c=eb(),d=Z2(),f=ea(),p=tb(),m=iM(),y=f6(),v=Ny();e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:o.FastLayer,Group:c.Group,DD:d.DD,Shape:f.Shape,shapes:f.shapes,Animation:p.Animation,Tween:m.Tween,Easings:m.Easings,Context:y.Context,Canvas:v.Canvas}),e.default=e.Konva})(tw)),tw}var Fg={},dT;function oM(){if(dT)return Fg;dT=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.Arc=void 0;const e=Br(),t=ea(),r=jr(),n=Wr(),s=jr();class a extends t.Shape{_sceneFunc(o){const c=r.Konva.getAngle(this.angle()),d=this.clockwise();o.beginPath(),o.arc(0,0,this.outerRadius(),0,c,d),o.arc(0,0,this.innerRadius(),c,0,!d),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}getSelfRect(){const o=this.innerRadius(),c=this.outerRadius(),d=this.clockwise(),f=r.Konva.getAngle(d?360-this.angle():this.angle()),p=Math.cos(Math.min(f,Math.PI)),m=1,y=Math.sin(Math.min(Math.max(Math.PI,f),3*Math.PI/2)),v=Math.sin(Math.min(f,Math.PI/2)),w=p*(p>0?o:c),S=m*c,E=y*(y>0?o:c),k=v*(v>0?c:o);return{x:w,y:d?-1*k:E,width:S-w,height:k-E}}}return Fg.Arc=a,a.prototype._centroid=!0,a.prototype.className="Arc",a.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1,(0,n.getBooleanValidator)()),Fg}var Pg={},Dg={},fT;function m6(){if(fT)return Dg;fT=1,Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.Line=void 0;const e=Br(),t=jr(),r=ea(),n=Wr();function s(o,c,d,f,p,m,y){const v=Math.sqrt(Math.pow(d-o,2)+Math.pow(f-c,2)),w=Math.sqrt(Math.pow(p-d,2)+Math.pow(m-f,2)),S=y*v/(v+w),E=y*w/(v+w),k=d-S*(p-o),_=f-S*(m-c),N=d+E*(p-o),F=f+E*(m-c);return[k,_,N,F]}function a(o,c){const d=o.length,f=[];for(let p=2;p<d-2;p+=2){const m=s(o[p-2],o[p-1],o[p],o[p+1],o[p+2],o[p+3],c);isNaN(m[0])||(f.push(m[0]),f.push(m[1]),f.push(o[p]),f.push(o[p+1]),f.push(m[2]),f.push(m[3]))}return f}class i extends r.Shape{constructor(c){super(c),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(c){const d=this.points(),f=d.length,p=this.tension(),m=this.closed(),y=this.bezier();if(!f)return;let v=0;if(c.beginPath(),c.moveTo(d[0],d[1]),p!==0&&f>4){const w=this.getTensionPoints(),S=w.length;for(v=m?0:4,m||c.quadraticCurveTo(w[0],w[1],w[2],w[3]);v<S-2;)c.bezierCurveTo(w[v++],w[v++],w[v++],w[v++],w[v++],w[v++]);m||c.quadraticCurveTo(w[S-2],w[S-1],d[f-2],d[f-1])}else if(y)for(v=2;v<f;)c.bezierCurveTo(d[v++],d[v++],d[v++],d[v++],d[v++],d[v++]);else for(v=2;v<f;v+=2)c.lineTo(d[v],d[v+1]);m?(c.closePath(),c.fillStrokeShape(this)):c.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():a(this.points(),this.tension())}_getTensionPointsClosed(){const c=this.points(),d=c.length,f=this.tension(),p=s(c[d-2],c[d-1],c[0],c[1],c[2],c[3],f),m=s(c[d-4],c[d-3],c[d-2],c[d-1],c[0],c[1],f),y=a(c,f);return[p[2],p[3]].concat(y).concat([m[0],m[1],c[d-2],c[d-1],m[2],m[3],p[0],p[1],c[0],c[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let c=this.points();if(c.length<4)return{x:c[0]||0,y:c[1]||0,width:0,height:0};this.tension()!==0?c=[c[0],c[1],...this._getTensionPoints(),c[c.length-2],c[c.length-1]]:c=this.points();let d=c[0],f=c[0],p=c[1],m=c[1],y,v;for(let w=0;w<c.length/2;w++)y=c[w*2],v=c[w*2+1],d=Math.min(d,y),f=Math.max(f,y),p=Math.min(p,v),m=Math.max(m,v);return{x:d,y:p,width:f-d,height:m-p}}}return Dg.Line=i,i.prototype.className="Line",i.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(i),e.Factory.addGetterSetter(i,"closed",!1),e.Factory.addGetterSetter(i,"bezier",!1),e.Factory.addGetterSetter(i,"tension",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"points",[],(0,n.getNumberArrayValidator)()),Dg}var Rg={},cw={},hT;function lM(){return hT||(hT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(i,o,c)=>{let d,f;const m=c/2;d=0;for(let y=0;y<20;y++)f=m*e.tValues[20][y]+m,d+=e.cValues[20][y]*n(i,o,f);return m*d};e.getCubicArcLength=t;const r=(i,o,c)=>{c===void 0&&(c=1);const d=i[0]-2*i[1]+i[2],f=o[0]-2*o[1]+o[2],p=2*i[1]-2*i[0],m=2*o[1]-2*o[0],y=4*(d*d+f*f),v=4*(d*p+f*m),w=p*p+m*m;if(y===0)return c*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(o[2]-o[0],2));const S=v/(2*y),E=w/y,k=c+S,_=E-S*S,N=k*k+_>0?Math.sqrt(k*k+_):0,F=S*S+_>0?Math.sqrt(S*S+_):0,A=S+Math.sqrt(S*S+_)!==0?_*Math.log(Math.abs((k+N)/(S+F))):0;return Math.sqrt(y)/2*(k*N-S*F+A)};e.getQuadraticArcLength=r;function n(i,o,c){const d=s(1,c,i),f=s(1,c,o),p=d*d+f*f;return Math.sqrt(p)}const s=(i,o,c)=>{const d=c.length-1;let f,p;if(d===0)return 0;if(i===0){p=0;for(let m=0;m<=d;m++)p+=e.binomialCoefficients[d][m]*Math.pow(1-o,d-m)*Math.pow(o,m)*c[m];return p}else{f=new Array(d);for(let m=0;m<d;m++)f[m]=d*(c[m+1]-c[m]);return s(i-1,o,f)}},a=(i,o,c)=>{let d=1,f=i/o,p=(i-c(f))/o,m=0;for(;d>.001;){const y=c(f+p),v=Math.abs(i-y)/o;if(v<d)d=v,f+=p;else{const w=c(f-p),S=Math.abs(i-w)/o;S<d?(d=S,f-=p):p/=2}if(m++,m>500)break}return f};e.t2length=a})(cw)),cw}var gT;function rb(){if(gT)return Rg;gT=1,Object.defineProperty(Rg,"__esModule",{value:!0}),Rg.Path=void 0;const e=Br(),t=jr(),r=ea(),n=lM();class s extends r.Shape{constructor(i){super(i),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=s.parsePathData(this.data()),this.pathLength=s.getPathLength(this.dataArray)}_sceneFunc(i){const o=this.dataArray;i.beginPath();let c=!1;for(let d=0;d<o.length;d++){const f=o[d].command,p=o[d].points;switch(f){case"L":i.lineTo(p[0],p[1]);break;case"M":i.moveTo(p[0],p[1]);break;case"C":i.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":i.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":const m=p[0],y=p[1],v=p[2],w=p[3],S=p[4],E=p[5],k=p[6],_=p[7],N=v>w?v:w,F=v>w?1:v/w,A=v>w?w/v:1;i.translate(m,y),i.rotate(k),i.scale(F,A),i.arc(0,0,N,S,S+E,1-_),i.scale(1/F,1/A),i.rotate(-k),i.translate(-m,-y);break;case"z":c=!0,i.closePath();break}}!c&&!this.hasFill()?i.strokeShape(this):i.fillStrokeShape(this)}getSelfRect(){let i=[];this.dataArray.forEach(function(y){if(y.command==="A"){const v=y.points[4],w=y.points[5],S=y.points[4]+w;let E=Math.PI/180;if(Math.abs(v-S)<E&&(E=Math.abs(v-S)),w<0)for(let k=v-E;k>S;k-=E){const _=s.getPointOnEllipticalArc(y.points[0],y.points[1],y.points[2],y.points[3],k,0);i.push(_.x,_.y)}else for(let k=v+E;k<S;k+=E){const _=s.getPointOnEllipticalArc(y.points[0],y.points[1],y.points[2],y.points[3],k,0);i.push(_.x,_.y)}}else if(y.command==="C")for(let v=0;v<=1;v+=.01){const w=s.getPointOnCubicBezier(v,y.start.x,y.start.y,y.points[0],y.points[1],y.points[2],y.points[3],y.points[4],y.points[5]);i.push(w.x,w.y)}else i=i.concat(y.points)});let o=i[0],c=i[0],d=i[1],f=i[1],p,m;for(let y=0;y<i.length/2;y++)p=i[y*2],m=i[y*2+1],isNaN(p)||(o=Math.min(o,p),c=Math.max(c,p)),isNaN(m)||(d=Math.min(d,m),f=Math.max(f,m));return{x:o,y:d,width:c-o,height:f-d}}getLength(){return this.pathLength}getPointAtLength(i){return s.getPointAtLengthOfDataArray(i,this.dataArray)}static getLineLength(i,o,c,d){return Math.sqrt((c-i)*(c-i)+(d-o)*(d-o))}static getPathLength(i){let o=0;for(let c=0;c<i.length;++c)o+=i[c].pathLength;return o}static getPointAtLengthOfDataArray(i,o){let c,d=0,f=o.length;if(!f)return null;for(;d<f&&i>o[d].pathLength;)i-=o[d].pathLength,++d;if(d===f)return c=o[d-1].points.slice(-2),{x:c[0],y:c[1]};if(i<.01)return o[d].command==="M"?(c=o[d].points.slice(0,2),{x:c[0],y:c[1]}):{x:o[d].start.x,y:o[d].start.y};const p=o[d],m=p.points;switch(p.command){case"L":return s.getPointOnLine(i,p.start.x,p.start.y,m[0],m[1]);case"C":return s.getPointOnCubicBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getCubicArcLength)([p.start.x,m[0],m[2],m[4]],[p.start.y,m[1],m[3],m[5]],N)),p.start.x,p.start.y,m[0],m[1],m[2],m[3],m[4],m[5]);case"Q":return s.getPointOnQuadraticBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getQuadraticArcLength)([p.start.x,m[0],m[2]],[p.start.y,m[1],m[3]],N)),p.start.x,p.start.y,m[0],m[1],m[2],m[3]);case"A":const y=m[0],v=m[1],w=m[2],S=m[3],E=m[5],k=m[6];let _=m[4];return _+=E*i/p.pathLength,s.getPointOnEllipticalArc(y,v,w,S,_,k)}return null}static getPointOnLine(i,o,c,d,f,p,m){p=p??o,m=m??c;const y=this.getLineLength(o,c,d,f);if(y<1e-10)return{x:o,y:c};if(d===o)return{x:p,y:m+(f>c?i:-i)};const v=(f-c)/(d-o),w=Math.sqrt(i*i/(1+v*v))*(d<o?-1:1),S=v*w;if(Math.abs(m-c-v*(p-o))<1e-10)return{x:p+w,y:m+S};const E=((p-o)*(d-o)+(m-c)*(f-c))/(y*y),k=o+E*(d-o),_=c+E*(f-c),N=this.getLineLength(p,m,k,_),F=Math.sqrt(i*i-N*N),A=Math.sqrt(F*F/(1+v*v))*(d<o?-1:1),R=v*A;return{x:k+A,y:_+R}}static getPointOnCubicBezier(i,o,c,d,f,p,m,y,v){function w(F){return F*F*F}function S(F){return 3*F*F*(1-F)}function E(F){return 3*F*(1-F)*(1-F)}function k(F){return(1-F)*(1-F)*(1-F)}const _=y*w(i)+p*S(i)+d*E(i)+o*k(i),N=v*w(i)+m*S(i)+f*E(i)+c*k(i);return{x:_,y:N}}static getPointOnQuadraticBezier(i,o,c,d,f,p,m){function y(k){return k*k}function v(k){return 2*k*(1-k)}function w(k){return(1-k)*(1-k)}const S=p*y(i)+d*v(i)+o*w(i),E=m*y(i)+f*v(i)+c*w(i);return{x:S,y:E}}static getPointOnEllipticalArc(i,o,c,d,f,p){const m=Math.cos(p),y=Math.sin(p),v={x:c*Math.cos(f),y:d*Math.sin(f)};return{x:i+(v.x*m-v.y*y),y:o+(v.x*y+v.y*m)}}static parsePathData(i){if(!i)return[];let o=i;const c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];o=o.replace(new RegExp(" ","g"),",");for(let S=0;S<c.length;S++)o=o.replace(new RegExp(c[S],"g"),"|"+c[S]);const d=o.split("|"),f=[],p=[];let m=0,y=0;const v=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let w;for(let S=1;S<d.length;S++){let E=d[S],k=E.charAt(0);for(E=E.slice(1),p.length=0;w=v.exec(E);)p.push(w[0]);const _=[];for(let N=0,F=p.length;N<F;N++){if(p[N]==="00"){_.push(0,0);continue}const A=parseFloat(p[N]);isNaN(A)?_.push(0):_.push(A)}for(;_.length>0&&!isNaN(_[0]);){let N="",F=[];const A=m,R=y;let T,D,L,O,G,K,te,Z,J,I;switch(k){case"l":m+=_.shift(),y+=_.shift(),N="L",F.push(m,y);break;case"L":m=_.shift(),y=_.shift(),F.push(m,y);break;case"m":const W=_.shift(),B=_.shift();if(m+=W,y+=B,N="M",f.length>2&&f[f.length-1].command==="z"){for(let Y=f.length-2;Y>=0;Y--)if(f[Y].command==="M"){m=f[Y].points[0]+W,y=f[Y].points[1]+B;break}}F.push(m,y),k="l";break;case"M":m=_.shift(),y=_.shift(),N="M",F.push(m,y),k="L";break;case"h":m+=_.shift(),N="L",F.push(m,y);break;case"H":m=_.shift(),N="L",F.push(m,y);break;case"v":y+=_.shift(),N="L",F.push(m,y);break;case"V":y=_.shift(),N="L",F.push(m,y);break;case"C":F.push(_.shift(),_.shift(),_.shift(),_.shift()),m=_.shift(),y=_.shift(),F.push(m,y);break;case"c":F.push(m+_.shift(),y+_.shift(),m+_.shift(),y+_.shift()),m+=_.shift(),y+=_.shift(),N="C",F.push(m,y);break;case"S":D=m,L=y,T=f[f.length-1],T.command==="C"&&(D=m+(m-T.points[2]),L=y+(y-T.points[3])),F.push(D,L,_.shift(),_.shift()),m=_.shift(),y=_.shift(),N="C",F.push(m,y);break;case"s":D=m,L=y,T=f[f.length-1],T.command==="C"&&(D=m+(m-T.points[2]),L=y+(y-T.points[3])),F.push(D,L,m+_.shift(),y+_.shift()),m+=_.shift(),y+=_.shift(),N="C",F.push(m,y);break;case"Q":F.push(_.shift(),_.shift()),m=_.shift(),y=_.shift(),F.push(m,y);break;case"q":F.push(m+_.shift(),y+_.shift()),m+=_.shift(),y+=_.shift(),N="Q",F.push(m,y);break;case"T":D=m,L=y,T=f[f.length-1],T.command==="Q"&&(D=m+(m-T.points[0]),L=y+(y-T.points[1])),m=_.shift(),y=_.shift(),N="Q",F.push(D,L,m,y);break;case"t":D=m,L=y,T=f[f.length-1],T.command==="Q"&&(D=m+(m-T.points[0]),L=y+(y-T.points[1])),m+=_.shift(),y+=_.shift(),N="Q",F.push(D,L,m,y);break;case"A":O=_.shift(),G=_.shift(),K=_.shift(),te=_.shift(),Z=_.shift(),J=m,I=y,m=_.shift(),y=_.shift(),N="A",F=this.convertEndpointToCenterParameterization(J,I,m,y,te,Z,O,G,K);break;case"a":O=_.shift(),G=_.shift(),K=_.shift(),te=_.shift(),Z=_.shift(),J=m,I=y,m+=_.shift(),y+=_.shift(),N="A",F=this.convertEndpointToCenterParameterization(J,I,m,y,te,Z,O,G,K);break}f.push({command:N||k,points:F,start:{x:A,y:R},pathLength:this.calcLength(A,R,N||k,F)})}(k==="z"||k==="Z")&&f.push({command:"z",points:[],start:void 0,pathLength:0})}return f}static calcLength(i,o,c,d){let f,p,m,y;const v=s;switch(c){case"L":return v.getLineLength(i,o,d[0],d[1]);case"C":return(0,n.getCubicArcLength)([i,d[0],d[2],d[4]],[o,d[1],d[3],d[5]],1);case"Q":return(0,n.getQuadraticArcLength)([i,d[0],d[2]],[o,d[1],d[3]],1);case"A":f=0;const w=d[4],S=d[5],E=d[4]+S;let k=Math.PI/180;if(Math.abs(w-E)<k&&(k=Math.abs(w-E)),p=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],w,0),S<0)for(y=w-k;y>E;y-=k)m=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],y,0),f+=v.getLineLength(p.x,p.y,m.x,m.y),p=m;else for(y=w+k;y<E;y+=k)m=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],y,0),f+=v.getLineLength(p.x,p.y,m.x,m.y),p=m;return m=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],E,0),f+=v.getLineLength(p.x,p.y,m.x,m.y),f}return 0}static convertEndpointToCenterParameterization(i,o,c,d,f,p,m,y,v){const w=v*(Math.PI/180),S=Math.cos(w)*(i-c)/2+Math.sin(w)*(o-d)/2,E=-1*Math.sin(w)*(i-c)/2+Math.cos(w)*(o-d)/2,k=S*S/(m*m)+E*E/(y*y);k>1&&(m*=Math.sqrt(k),y*=Math.sqrt(k));let _=Math.sqrt((m*m*(y*y)-m*m*(E*E)-y*y*(S*S))/(m*m*(E*E)+y*y*(S*S)));f===p&&(_*=-1),isNaN(_)&&(_=0);const N=_*m*E/y,F=_*-y*S/m,A=(i+c)/2+Math.cos(w)*N-Math.sin(w)*F,R=(o+d)/2+Math.sin(w)*N+Math.cos(w)*F,T=function(Z){return Math.sqrt(Z[0]*Z[0]+Z[1]*Z[1])},D=function(Z,J){return(Z[0]*J[0]+Z[1]*J[1])/(T(Z)*T(J))},L=function(Z,J){return(Z[0]*J[1]<Z[1]*J[0]?-1:1)*Math.acos(D(Z,J))},O=L([1,0],[(S-N)/m,(E-F)/y]),G=[(S-N)/m,(E-F)/y],K=[(-1*S-N)/m,(-1*E-F)/y];let te=L(G,K);return D(G,K)<=-1&&(te=Math.PI),D(G,K)>=1&&(te=0),p===0&&te>0&&(te=te-2*Math.PI),p===1&&te<0&&(te=te+2*Math.PI),[A,R,m,y,O,te,w,p]}}return Rg.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,t._registerNode)(s),e.Factory.addGetterSetter(s,"data"),Rg}var mT;function cM(){if(mT)return Pg;mT=1,Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.Arrow=void 0;const e=Br(),t=m6(),r=Wr(),n=jr(),s=rb();class a extends t.Line{_sceneFunc(o){super._sceneFunc(o);const c=Math.PI*2,d=this.points();let f=d;const p=this.tension()!==0&&d.length>4;p&&(f=this.getTensionPoints());const m=this.pointerLength(),y=d.length;let v,w;if(p){const k=[f[f.length-4],f[f.length-3],f[f.length-2],f[f.length-1],d[y-2],d[y-1]],_=s.Path.calcLength(f[f.length-4],f[f.length-3],"C",k),N=s.Path.getPointOnQuadraticBezier(Math.min(1,1-m/_),k[0],k[1],k[2],k[3],k[4],k[5]);v=d[y-2]-N.x,w=d[y-1]-N.y}else v=d[y-2]-d[y-4],w=d[y-1]-d[y-3];const S=(Math.atan2(w,v)+c)%c,E=this.pointerWidth();this.pointerAtEnding()&&(o.save(),o.beginPath(),o.translate(d[y-2],d[y-1]),o.rotate(S),o.moveTo(0,0),o.lineTo(-m,E/2),o.lineTo(-m,-E/2),o.closePath(),o.restore(),this.__fillStroke(o)),this.pointerAtBeginning()&&(o.save(),o.beginPath(),o.translate(d[0],d[1]),p?(v=(f[0]+f[2])/2-d[0],w=(f[1]+f[3])/2-d[1]):(v=d[2]-d[0],w=d[3]-d[1]),o.rotate((Math.atan2(-w,-v)+c)%c),o.moveTo(0,0),o.lineTo(-m,E/2),o.lineTo(-m,-E/2),o.closePath(),o.restore(),this.__fillStroke(o))}__fillStroke(o){const c=this.dashEnabled();c&&(this.attrs.dashEnabled=!1,o.setLineDash([])),o.fillStrokeShape(this),c&&(this.attrs.dashEnabled=!0)}getSelfRect(){const o=super.getSelfRect(),c=this.pointerWidth()/2;return{x:o.x,y:o.y-c,width:o.width,height:o.height+c*2}}}return Pg.Arrow=a,a.prototype.className="Arrow",(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"pointerLength",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerWidth",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerAtBeginning",!1),e.Factory.addGetterSetter(a,"pointerAtEnding",!0),Pg}var Ig={},pT;function uM(){if(pT)return Ig;pT=1,Object.defineProperty(Ig,"__esModule",{value:!0}),Ig.Circle=void 0;const e=Br(),t=ea(),r=Wr(),n=jr();class s extends t.Shape{_sceneFunc(i){i.beginPath(),i.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius()!==i/2&&this.radius(i/2)}setHeight(i){this.radius()!==i/2&&this.radius(i/2)}}return Ig.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),Ig}var Mg={},xT;function dM(){if(xT)return Mg;xT=1,Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.Ellipse=void 0;const e=Br(),t=ea(),r=Wr(),n=jr();class s extends t.Shape{_sceneFunc(i){const o=this.radiusX(),c=this.radiusY();i.beginPath(),i.save(),o!==c&&i.scale(1,c/o),i.arc(0,0,o,0,Math.PI*2,!1),i.restore(),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(i){this.radiusX(i/2)}setHeight(i){this.radiusY(i/2)}}return Mg.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(s),e.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),e.Factory.addGetterSetter(s,"radiusX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"radiusY",0,(0,r.getNumberValidator)()),Mg}var Lg={},yT;function fM(){if(yT)return Lg;yT=1,Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.Image=void 0;const e=rs(),t=Br(),r=ea(),n=jr(),s=Wr();class a extends r.Shape{constructor(o){super(o),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",c=>{this._removeImageLoad(c.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const o=this.image();o&&o.complete||o&&o.readyState===4||o&&o.addEventListener&&o.addEventListener("load",this._loadListener)}_removeImageLoad(o){o&&o.removeEventListener&&o.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const o=!!this.cornerRadius(),c=this.hasShadow();return o&&c?!0:super._useBufferCanvas(!0)}_sceneFunc(o){const c=this.getWidth(),d=this.getHeight(),f=this.cornerRadius(),p=this.attrs.image;let m;if(p){const y=this.attrs.cropWidth,v=this.attrs.cropHeight;y&&v?m=[p,this.cropX(),this.cropY(),y,v,0,0,c,d]:m=[p,0,0,c,d]}(this.hasFill()||this.hasStroke()||f)&&(o.beginPath(),f?e.Util.drawRoundedRectPath(o,c,d,f):o.rect(0,0,c,d),o.closePath(),o.fillStrokeShape(this)),p&&(f&&o.clip(),o.drawImage.apply(o,m))}_hitFunc(o){const c=this.width(),d=this.height(),f=this.cornerRadius();o.beginPath(),f?e.Util.drawRoundedRectPath(o,c,d,f):o.rect(0,0,c,d),o.closePath(),o.fillStrokeShape(this)}getWidth(){var o,c;return(o=this.attrs.width)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.width}getHeight(){var o,c;return(o=this.attrs.height)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.height}static fromURL(o,c,d=null){const f=e.Util.createImageElement();f.onload=function(){const p=new a({image:f});c(p)},f.onerror=d,f.crossOrigin="Anonymous",f.src=o}}return Lg.Image=a,a.prototype.className="Image",(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(a,"image"),t.Factory.addComponentsGetterSetter(a,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(a,"cropX",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropY",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropWidth",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropHeight",0,(0,s.getNumberValidator)()),Lg}var Td={},vT;function hM(){if(vT)return Td;vT=1,Object.defineProperty(Td,"__esModule",{value:!0}),Td.Tag=Td.Label=void 0;const e=Br(),t=ea(),r=eb(),n=Wr(),s=jr(),a=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],i="Change.konva",o="none",c="up",d="right",f="down",p="left",m=a.length;class y extends r.Group{constructor(S){super(S),this.on("add.konva",function(E){this._addListeners(E.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(S){let E=this,k;const _=function(){E._sync()};for(k=0;k<m;k++)S.on(a[k]+i,_)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let S=this.getText(),E=this.getTag(),k,_,N,F,A,R,T;if(S&&E){switch(k=S.width(),_=S.height(),N=E.pointerDirection(),F=E.pointerWidth(),T=E.pointerHeight(),A=0,R=0,N){case c:A=k/2,R=-1*T;break;case d:A=k+F,R=_/2;break;case f:A=k/2,R=_+T;break;case p:A=-1*F,R=_/2;break}E.setAttrs({x:-1*A,y:-1*R,width:k,height:_}),S.setAttrs({x:-1*A,y:-1*R})}}}Td.Label=y,y.prototype.className="Label",(0,s._registerNode)(y);class v extends t.Shape{_sceneFunc(S){const E=this.width(),k=this.height(),_=this.pointerDirection(),N=this.pointerWidth(),F=this.pointerHeight(),A=this.cornerRadius();let R=0,T=0,D=0,L=0;typeof A=="number"?R=T=D=L=Math.min(A,E/2,k/2):(R=Math.min(A[0]||0,E/2,k/2),T=Math.min(A[1]||0,E/2,k/2),L=Math.min(A[2]||0,E/2,k/2),D=Math.min(A[3]||0,E/2,k/2)),S.beginPath(),S.moveTo(R,0),_===c&&(S.lineTo((E-N)/2,0),S.lineTo(E/2,-1*F),S.lineTo((E+N)/2,0)),S.lineTo(E-T,0),S.arc(E-T,T,T,Math.PI*3/2,0,!1),_===d&&(S.lineTo(E,(k-F)/2),S.lineTo(E+N,k/2),S.lineTo(E,(k+F)/2)),S.lineTo(E,k-L),S.arc(E-L,k-L,L,0,Math.PI/2,!1),_===f&&(S.lineTo((E+N)/2,k),S.lineTo(E/2,k+F),S.lineTo((E-N)/2,k)),S.lineTo(D,k),S.arc(D,k-D,D,Math.PI/2,Math.PI,!1),_===p&&(S.lineTo(0,(k+F)/2),S.lineTo(-1*N,k/2),S.lineTo(0,(k-F)/2)),S.lineTo(0,R),S.arc(R,R,R,Math.PI,Math.PI*3/2,!1),S.closePath(),S.fillStrokeShape(this)}getSelfRect(){let S=0,E=0,k=this.pointerWidth(),_=this.pointerHeight(),N=this.pointerDirection(),F=this.width(),A=this.height();return N===c?(E-=_,A+=_):N===f?A+=_:N===p?(S-=k*1.5,F+=k):N===d&&(F+=k*1.5),{x:S,y:E,width:F,height:A}}}return Td.Tag=v,v.prototype.className="Tag",(0,s._registerNode)(v),e.Factory.addGetterSetter(v,"pointerDirection",o),e.Factory.addGetterSetter(v,"pointerWidth",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(v,"pointerHeight",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(v,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),Td}var Og={},wT;function p6(){if(wT)return Og;wT=1,Object.defineProperty(Og,"__esModule",{value:!0}),Og.Rect=void 0;const e=Br(),t=ea(),r=jr(),n=rs(),s=Wr();class a extends t.Shape{_sceneFunc(o){const c=this.cornerRadius(),d=this.width(),f=this.height();o.beginPath(),c?n.Util.drawRoundedRectPath(o,d,f,c):o.rect(0,0,d,f),o.closePath(),o.fillStrokeShape(this)}}return Og.Rect=a,a.prototype.className="Rect",(0,r._registerNode)(a),e.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),Og}var Bg={},_T;function gM(){if(_T)return Bg;_T=1,Object.defineProperty(Bg,"__esModule",{value:!0}),Bg.RegularPolygon=void 0;const e=Br(),t=ea(),r=Wr(),n=jr();class s extends t.Shape{_sceneFunc(i){const o=this._getPoints();i.beginPath(),i.moveTo(o[0].x,o[0].y);for(let c=1;c<o.length;c++)i.lineTo(o[c].x,o[c].y);i.closePath(),i.fillStrokeShape(this)}_getPoints(){const i=this.attrs.sides,o=this.attrs.radius||0,c=[];for(let d=0;d<i;d++)c.push({x:o*Math.sin(d*2*Math.PI/i),y:-1*o*Math.cos(d*2*Math.PI/i)});return c}getSelfRect(){const i=this._getPoints();let o=i[0].x,c=i[0].y,d=i[0].x,f=i[0].y;return i.forEach(p=>{o=Math.min(o,p.x),c=Math.max(c,p.x),d=Math.min(d,p.y),f=Math.max(f,p.y)}),{x:o,y:d,width:c-o,height:f-d}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius(i/2)}setHeight(i){this.radius(i/2)}}return Bg.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"sides",0,(0,r.getNumberValidator)()),Bg}var Ug={},bT;function mM(){if(bT)return Ug;bT=1,Object.defineProperty(Ug,"__esModule",{value:!0}),Ug.Ring=void 0;const e=Br(),t=ea(),r=Wr(),n=jr(),s=Math.PI*2;class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.innerRadius(),0,s,!1),o.moveTo(this.outerRadius(),0),o.arc(0,0,this.outerRadius(),s,0,!0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}}return Ug.Ring=a,a.prototype.className="Ring",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,r.getNumberValidator)()),Ug}var $g={},ST;function pM(){if(ST)return $g;ST=1,Object.defineProperty($g,"__esModule",{value:!0}),$g.Sprite=void 0;const e=Br(),t=ea(),r=tb(),n=Wr(),s=jr();class a extends t.Shape{constructor(o){super(o),this._updated=!0,this.anim=new r.Animation(()=>{const c=this._updated;return this._updated=!1,c}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(o){const c=this.animation(),d=this.frameIndex(),f=d*4,p=this.animations()[c],m=this.frameOffsets(),y=p[f+0],v=p[f+1],w=p[f+2],S=p[f+3],E=this.image();if((this.hasFill()||this.hasStroke())&&(o.beginPath(),o.rect(0,0,w,S),o.closePath(),o.fillStrokeShape(this)),E)if(m){const k=m[c],_=d*2;o.drawImage(E,y,v,w,S,k[_+0],k[_+1],w,S)}else o.drawImage(E,y,v,w,S,0,0,w,S)}_hitFunc(o){const c=this.animation(),d=this.frameIndex(),f=d*4,p=this.animations()[c],m=this.frameOffsets(),y=p[f+2],v=p[f+3];if(o.beginPath(),m){const w=m[c],S=d*2;o.rect(w[S+0],w[S+1],y,v)}else o.rect(0,0,y,v);o.closePath(),o.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const o=this;this.interval=setInterval(function(){o._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const o=this.getLayer();this.anim.setLayers(o),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const o=this.frameIndex(),c=this.animation(),d=this.animations(),f=d[c],p=f.length/4;o<p-1?this.frameIndex(o+1):this.frameIndex(0)}}return $g.Sprite=a,a.prototype.className="Sprite",(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"animation"),e.Factory.addGetterSetter(a,"animations"),e.Factory.addGetterSetter(a,"frameOffsets"),e.Factory.addGetterSetter(a,"image"),e.Factory.addGetterSetter(a,"frameIndex",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"frameRate",17,(0,n.getNumberValidator)()),e.Factory.backCompat(a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),$g}var Wg={},kT;function xM(){if(kT)return Wg;kT=1,Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.Star=void 0;const e=Br(),t=ea(),r=Wr(),n=jr();class s extends t.Shape{_sceneFunc(i){const o=this.innerRadius(),c=this.outerRadius(),d=this.numPoints();i.beginPath(),i.moveTo(0,0-c);for(let f=1;f<d*2;f++){const p=f%2===0?c:o,m=p*Math.sin(f*Math.PI/d),y=-1*p*Math.cos(f*Math.PI/d);i.lineTo(m,y)}i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(i){this.outerRadius(i/2)}setHeight(i){this.outerRadius(i/2)}}return Wg.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"numPoints",5,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"outerRadius",0,(0,r.getNumberValidator)()),Wg}var _h={},CT;function x6(){if(CT)return _h;CT=1,Object.defineProperty(_h,"__esModule",{value:!0}),_h.Text=void 0,_h.stringToArray=i;const e=rs(),t=Br(),r=ea(),n=jr(),s=Wr(),a=jr();function i(H){return[...H].reduce((X,se,ie,ae)=>{if(new RegExp("\\p{Emoji}","u").test(se)){const Q=ae[ie+1];Q&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(Q)?(X.push(se+Q),ae[ie+1]=""):X.push(se)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(se+(ae[ie+1]||""))?X.push(se+ae[ie+1]):ie>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(se)?X[X.length-1]+=se:se&&X.push(se);return X},[])}const o="auto",c="center",d="inherit",f="justify",p="Change.konva",m="2d",y="-",v="left",w="text",S="Text",E="top",k="bottom",_="middle",N="normal",F="px ",A=" ",R="right",T="rtl",D="word",L="char",O="none",G="…",K=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],te=K.length;function Z(H){return H.split(",").map(X=>{X=X.trim();const se=X.indexOf(" ")>=0,ie=X.indexOf('"')>=0||X.indexOf("'")>=0;return se&&!ie&&(X=`"${X}"`),X}).join(", ")}let J;function I(){return J||(J=e.Util.createCanvasElement().getContext(m),J)}function W(H){H.fillText(this._partialText,this._partialTextX,this._partialTextY)}function B(H){H.setAttr("miterLimit",2),H.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Y(H){return H=H||{},!H.fillLinearGradientColorStops&&!H.fillRadialGradientColorStops&&!H.fillPatternImage&&(H.fill=H.fill||"black"),H}class V extends r.Shape{constructor(X){super(Y(X)),this._partialTextX=0,this._partialTextY=0;for(let se=0;se<te;se++)this.on(K[se]+p,this._setTextData);this._setTextData()}_sceneFunc(X){const se=this.textArr,ie=se.length;if(!this.text())return;let ae=this.padding(),Q=this.fontSize(),le=this.lineHeight()*Q,_e=this.verticalAlign(),ke=this.direction(),Oe=0,ge=this.align(),ye=this.getWidth(),Ke=this.letterSpacing(),Xe=this.fill(),lt=this.textDecoration(),Ye=lt.indexOf("underline")!==-1,We=lt.indexOf("line-through")!==-1,Me;ke=ke===d?X.direction:ke;let je=le/2,De=_;if(n.Konva._fixTextRendering){const Ge=this.measureSize("M");De="alphabetic",je=(Ge.fontBoundingBoxAscent-Ge.fontBoundingBoxDescent)/2+le/2}for(ke===T&&X.setAttr("direction",ke),X.setAttr("font",this._getContextFont()),X.setAttr("textBaseline",De),X.setAttr("textAlign",v),_e===_?Oe=(this.getHeight()-ie*le-ae*2)/2:_e===k&&(Oe=this.getHeight()-ie*le-ae*2),X.translate(ae,Oe+ae),Me=0;Me<ie;Me++){let Ge=0,ct=0;const at=se[Me],wt=at.text,Ft=at.width,Kt=at.lastInParagraph;if(X.save(),ge===R?Ge+=ye-Ft-ae*2:ge===c&&(Ge+=(ye-Ft-ae*2)/2),Ye){X.save(),X.beginPath();const bt=n.Konva._fixTextRendering?Math.round(Q/4):Math.round(Q/2),At=Ge,gt=je+ct+bt;X.moveTo(At,gt);const kt=ge===f&&!Kt?ye-ae*2:Ft;X.lineTo(At+Math.round(kt),gt),X.lineWidth=Q/15;const Gt=this._getLinearGradient();X.strokeStyle=Gt||Xe,X.stroke(),X.restore()}if(We){X.save(),X.beginPath();const bt=n.Konva._fixTextRendering?-Math.round(Q/4):0;X.moveTo(Ge,je+ct+bt);const At=ge===f&&!Kt?ye-ae*2:Ft;X.lineTo(Ge+Math.round(At),je+ct+bt),X.lineWidth=Q/15;const gt=this._getLinearGradient();X.strokeStyle=gt||Xe,X.stroke(),X.restore()}if(ke!==T&&(Ke!==0||ge===f)){const bt=wt.split(" ").length-1,At=i(wt);for(let gt=0;gt<At.length;gt++){const kt=At[gt];kt===" "&&!Kt&&ge===f&&(Ge+=(ye-ae*2-Ft)/bt),this._partialTextX=Ge,this._partialTextY=je+ct,this._partialText=kt,X.fillStrokeShape(this),Ge+=this.measureSize(kt).width+Ke}}else Ke!==0&&X.setAttr("letterSpacing",`${Ke}px`),this._partialTextX=Ge,this._partialTextY=je+ct,this._partialText=wt,X.fillStrokeShape(this);X.restore(),ie>1&&(je+=le)}}_hitFunc(X){const se=this.getWidth(),ie=this.getHeight();X.beginPath(),X.rect(0,0,se,ie),X.closePath(),X.fillStrokeShape(this)}setText(X){const se=e.Util._isString(X)?X:X==null?"":X+"";return this._setAttr(w,se),this}getWidth(){return this.attrs.width===o||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===o||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(X){var se,ie,ae,Q,le,_e,ke,Oe,ge,ye,Ke;let Xe=I(),lt=this.fontSize(),Ye;Xe.save(),Xe.font=this._getContextFont(),Ye=Xe.measureText(X),Xe.restore();const We=lt/100;return{actualBoundingBoxAscent:(se=Ye.actualBoundingBoxAscent)!==null&&se!==void 0?se:71.58203125*We,actualBoundingBoxDescent:(ie=Ye.actualBoundingBoxDescent)!==null&&ie!==void 0?ie:0,actualBoundingBoxLeft:(ae=Ye.actualBoundingBoxLeft)!==null&&ae!==void 0?ae:-7.421875*We,actualBoundingBoxRight:(Q=Ye.actualBoundingBoxRight)!==null&&Q!==void 0?Q:75.732421875*We,alphabeticBaseline:(le=Ye.alphabeticBaseline)!==null&&le!==void 0?le:0,emHeightAscent:(_e=Ye.emHeightAscent)!==null&&_e!==void 0?_e:100*We,emHeightDescent:(ke=Ye.emHeightDescent)!==null&&ke!==void 0?ke:-20*We,fontBoundingBoxAscent:(Oe=Ye.fontBoundingBoxAscent)!==null&&Oe!==void 0?Oe:91*We,fontBoundingBoxDescent:(ge=Ye.fontBoundingBoxDescent)!==null&&ge!==void 0?ge:21*We,hangingBaseline:(ye=Ye.hangingBaseline)!==null&&ye!==void 0?ye:72.80000305175781*We,ideographicBaseline:(Ke=Ye.ideographicBaseline)!==null&&Ke!==void 0?Ke:-21*We,width:Ye.width,height:lt}}_getContextFont(){return this.fontStyle()+A+this.fontVariant()+A+(this.fontSize()+F)+Z(this.fontFamily())}_addTextLine(X){this.align()===f&&(X=X.trim());const ie=this._getTextWidth(X);return this.textArr.push({text:X,width:ie,lastInParagraph:!1})}_getTextWidth(X){const se=this.letterSpacing(),ie=X.length;return I().measureText(X).width+se*ie}_setTextData(){let X=this.text().split(`
`),se=+this.fontSize(),ie=0,ae=this.lineHeight()*se,Q=this.attrs.width,le=this.attrs.height,_e=Q!==o&&Q!==void 0,ke=le!==o&&le!==void 0,Oe=this.padding(),ge=Q-Oe*2,ye=le-Oe*2,Ke=0,Xe=this.wrap(),lt=Xe!==O,Ye=Xe!==L&&lt,We=this.ellipsis();this.textArr=[],I().font=this._getContextFont();const Me=We?this._getTextWidth(G):0;for(let je=0,De=X.length;je<De;++je){let Ge=X[je],ct=this._getTextWidth(Ge);if(_e&&ct>ge)for(;Ge.length>0;){let at=0,wt=i(Ge).length,Ft="",Kt=0;for(;at<wt;){const bt=at+wt>>>1,At=i(Ge),gt=At.slice(0,bt+1).join(""),kt=this._getTextWidth(gt);(We&&ke&&Ke+ae>ye?kt+Me:kt)<=ge?(at=bt+1,Ft=gt,Kt=kt):wt=bt}if(Ft){if(Ye){const gt=i(Ge),kt=i(Ft),Gt=gt[kt.length],$t=Gt===A||Gt===y;let Be;if($t&&Kt<=ge)Be=kt.length;else{const it=kt.lastIndexOf(A),ut=kt.lastIndexOf(y);Be=Math.max(it,ut)+1}Be>0&&(at=Be,Ft=gt.slice(0,at).join(""),Kt=this._getTextWidth(Ft))}if(Ft=Ft.trimRight(),this._addTextLine(Ft),ie=Math.max(ie,Kt),Ke+=ae,this._shouldHandleEllipsis(Ke)){this._tryToAddEllipsisToLastLine();break}if(Ge=i(Ge).slice(at).join("").trimLeft(),Ge.length>0&&(ct=this._getTextWidth(Ge),ct<=ge)){this._addTextLine(Ge),Ke+=ae,ie=Math.max(ie,ct);break}}else break}else this._addTextLine(Ge),Ke+=ae,ie=Math.max(ie,ct),this._shouldHandleEllipsis(Ke)&&je<De-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),ke&&Ke+ae>ye)break}this.textHeight=se,this.textWidth=ie}_shouldHandleEllipsis(X){const se=+this.fontSize(),ie=this.lineHeight()*se,ae=this.attrs.height,Q=ae!==o&&ae!==void 0,le=this.padding(),_e=ae-le*2;return!(this.wrap()!==O)||Q&&X+ie>_e}_tryToAddEllipsisToLastLine(){const X=this.attrs.width,se=X!==o&&X!==void 0,ie=this.padding(),ae=X-ie*2,Q=this.ellipsis(),le=this.textArr[this.textArr.length-1];!le||!Q||(se&&(this._getTextWidth(le.text+G)<ae||(le.text=le.text.slice(0,le.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(le.text+G))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const X=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,se=this.hasShadow();return X&&se?!0:super._useBufferCanvas()}}return _h.Text=V,V.prototype._fillFunc=W,V.prototype._strokeFunc=B,V.prototype.className=S,V.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,a._registerNode)(V),t.Factory.overWriteSetter(V,"width",(0,s.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(V,"height",(0,s.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(V,"direction",d),t.Factory.addGetterSetter(V,"fontFamily","Arial"),t.Factory.addGetterSetter(V,"fontSize",12,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(V,"fontStyle",N),t.Factory.addGetterSetter(V,"fontVariant",N),t.Factory.addGetterSetter(V,"padding",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(V,"align",v),t.Factory.addGetterSetter(V,"verticalAlign",E),t.Factory.addGetterSetter(V,"lineHeight",1,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(V,"wrap",D),t.Factory.addGetterSetter(V,"ellipsis",!1,(0,s.getBooleanValidator)()),t.Factory.addGetterSetter(V,"letterSpacing",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(V,"text","",(0,s.getStringValidator)()),t.Factory.addGetterSetter(V,"textDecoration",""),_h}var zg={},TT;function yM(){if(TT)return zg;TT=1,Object.defineProperty(zg,"__esModule",{value:!0}),zg.TextPath=void 0;const e=rs(),t=Br(),r=ea(),n=rb(),s=x6(),a=Wr(),i=jr(),o="",c="normal";function d(m){m.fillText(this.partialText,0,0)}function f(m){m.strokeText(this.partialText,0,0)}class p extends r.Shape{constructor(y){super(y),this.dummyCanvas=e.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(y){if(!this.attrs.data)return null;const v=this.pathLength;return y-1>v?null:n.Path.getPointAtLengthOfDataArray(y,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(y){y.setAttr("font",this._getContextFont()),y.setAttr("textBaseline",this.textBaseline()),y.setAttr("textAlign","left"),y.save();const v=this.textDecoration(),w=this.fill(),S=this.fontSize(),E=this.glyphInfo;v==="underline"&&y.beginPath();for(let k=0;k<E.length;k++){y.save();const _=E[k].p0;y.translate(_.x,_.y),y.rotate(E[k].rotation),this.partialText=E[k].text,y.fillStrokeShape(this),v==="underline"&&(k===0&&y.moveTo(0,S/2+1),y.lineTo(S,S/2+1)),y.restore()}v==="underline"&&(y.strokeStyle=w,y.lineWidth=S/20,y.stroke()),y.restore()}_hitFunc(y){y.beginPath();const v=this.glyphInfo;if(v.length>=1){const w=v[0].p0;y.moveTo(w.x,w.y)}for(let w=0;w<v.length;w++){const S=v[w].p1;y.lineTo(S.x,S.y)}y.setAttr("lineWidth",this.fontSize()),y.setAttr("strokeStyle",this.colorKey),y.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(y){return s.Text.prototype.setText.call(this,y)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(y){const w=this.dummyCanvas.getContext("2d");w.save(),w.font=this._getContextFont();const S=w.measureText(y);return w.restore(),{width:S.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:y,height:v}=this._getTextSize(this.attrs.text);if(this.textWidth=y,this.textHeight=v,this.glyphInfo=[],!this.attrs.data)return null;const w=this.letterSpacing(),S=this.align(),E=this.kerningFunc(),k=Math.max(this.textWidth+((this.attrs.text||"").length-1)*w,0);let _=0;S==="center"&&(_=Math.max(0,this.pathLength/2-k/2)),S==="right"&&(_=Math.max(0,this.pathLength-k));const N=(0,s.stringToArray)(this.text());let F=_;for(let A=0;A<N.length;A++){const R=this._getPointAtLength(F);if(!R)return;let T=this._getTextSize(N[A]).width+w;if(N[A]===" "&&S==="justify"){const te=this.text().split(" ").length-1;T+=(this.pathLength-k)/te}const D=this._getPointAtLength(F+T);if(!D)return;const L=n.Path.getLineLength(R.x,R.y,D.x,D.y);let O=0;if(E)try{O=E(N[A-1],N[A])*this.fontSize()}catch{O=0}R.x+=O,D.x+=O,this.textWidth+=O;const G=n.Path.getPointOnLine(O+L/2,R.x,R.y,D.x,D.y),K=Math.atan2(D.y-R.y,D.x-R.x);this.glyphInfo.push({transposeX:G.x,transposeY:G.y,text:N[A],rotation:K,p0:R,p1:D}),F+=T}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const y=[];this.glyphInfo.forEach(function(F){y.push(F.p0.x),y.push(F.p0.y),y.push(F.p1.x),y.push(F.p1.y)});let v=y[0]||0,w=y[0]||0,S=y[1]||0,E=y[1]||0,k,_;for(let F=0;F<y.length/2;F++)k=y[F*2],_=y[F*2+1],v=Math.min(v,k),w=Math.max(w,k),S=Math.min(S,_),E=Math.max(E,_);const N=this.fontSize();return{x:v-N/2,y:S-N/2,width:w-v+N,height:E-S+N}}destroy(){return e.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}return zg.TextPath=p,p.prototype._fillFunc=d,p.prototype._strokeFunc=f,p.prototype._fillFuncHit=d,p.prototype._strokeFuncHit=f,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,i._registerNode)(p),t.Factory.addGetterSetter(p,"data"),t.Factory.addGetterSetter(p,"fontFamily","Arial"),t.Factory.addGetterSetter(p,"fontSize",12,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(p,"fontStyle",c),t.Factory.addGetterSetter(p,"align","left"),t.Factory.addGetterSetter(p,"letterSpacing",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(p,"textBaseline","middle"),t.Factory.addGetterSetter(p,"fontVariant",c),t.Factory.addGetterSetter(p,"text",o),t.Factory.addGetterSetter(p,"textDecoration",""),t.Factory.addGetterSetter(p,"kerningFunc",void 0),zg}var Hg={},ET;function vM(){if(ET)return Hg;ET=1,Object.defineProperty(Hg,"__esModule",{value:!0}),Hg.Transformer=void 0;const e=rs(),t=Br(),r=gs(),n=ea(),s=p6(),a=eb(),i=jr(),o=Wr(),c=jr(),d="tr-konva",f=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(T=>T+`.${d}`).join(" "),p="nodesRect",m=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],y={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},v="ontouchstart"in i.Konva._global;function w(T,D,L){if(T==="rotater")return L;D+=e.Util.degToRad(y[T]||0);const O=(e.Util.radToDeg(D)%360+360)%360;return e.Util._inRange(O,315+22.5,360)||e.Util._inRange(O,0,22.5)?"ns-resize":e.Util._inRange(O,45-22.5,45+22.5)?"nesw-resize":e.Util._inRange(O,90-22.5,90+22.5)?"ew-resize":e.Util._inRange(O,135-22.5,135+22.5)?"nwse-resize":e.Util._inRange(O,180-22.5,180+22.5)?"ns-resize":e.Util._inRange(O,225-22.5,225+22.5)?"nesw-resize":e.Util._inRange(O,270-22.5,270+22.5)?"ew-resize":e.Util._inRange(O,315-22.5,315+22.5)?"nwse-resize":(e.Util.error("Transformer has unknown angle for cursor detection: "+O),"pointer")}const S=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function E(T){return{x:T.x+T.width/2*Math.cos(T.rotation)+T.height/2*Math.sin(-T.rotation),y:T.y+T.height/2*Math.cos(T.rotation)+T.width/2*Math.sin(T.rotation)}}function k(T,D,L){const O=L.x+(T.x-L.x)*Math.cos(D)-(T.y-L.y)*Math.sin(D),G=L.y+(T.x-L.x)*Math.sin(D)+(T.y-L.y)*Math.cos(D);return{...T,rotation:T.rotation+D,x:O,y:G}}function _(T,D){const L=E(T);return k(T,D,L)}function N(T,D,L){let O=D;for(let G=0;G<T.length;G++){const K=i.Konva.getAngle(T[G]),te=Math.abs(K-D)%(Math.PI*2);Math.min(te,Math.PI*2-te)<L&&(O=K)}return O}let F=0;class A extends a.Group{constructor(D){super(D),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(f,this.update),this.getNode()&&this.update()}attachTo(D){return this.setNode(D),this}setNode(D){return e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([D])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return d+this._id}setNodes(D=[]){this._nodes&&this._nodes.length&&this.detach();const L=D.filter(G=>G.isAncestorOf(this)?(e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=D=L,D.length===1&&this.useSingleNodeRotation()?this.rotation(D[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(G=>{const K=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(G._attrsAffectingSize.length){const te=G._attrsAffectingSize.map(Z=>Z+"Change."+this._getEventNamespace()).join(" ");G.on(te,K)}G.on(m.map(te=>te+`.${this._getEventNamespace()}`).join(" "),K),G.on(`absoluteTransformChange.${this._getEventNamespace()}`,K),this._proxyDrag(G)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(D){let L;D.on(`dragstart.${this._getEventNamespace()}`,O=>{L=D.getAbsolutePosition(),!this.isDragging()&&D!==this.findOne(".back")&&this.startDrag(O,!1)}),D.on(`dragmove.${this._getEventNamespace()}`,O=>{if(!L)return;const G=D.getAbsolutePosition(),K=G.x-L.x,te=G.y-L.y;this.nodes().forEach(Z=>{if(Z===D||Z.isDragging())return;const J=Z.getAbsolutePosition();Z.setAbsolutePosition({x:J.x+K,y:J.y+te}),Z.startDrag(O)}),L=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(D=>{D.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(D,L=this.rotation(),O){const G=D.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),K=D.getAbsoluteScale(O),te=D.getAbsolutePosition(O),Z=G.x*K.x-D.offsetX()*K.x,J=G.y*K.y-D.offsetY()*K.y,I=(i.Konva.getAngle(D.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),W={x:te.x+Z*Math.cos(I)+J*Math.sin(-I),y:te.y+J*Math.cos(I)+Z*Math.sin(I),width:G.width*K.x,height:G.height*K.y,rotation:I};return k(W,-i.Konva.getAngle(L),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const L=[];this.nodes().map(I=>{const W=I.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),B=[{x:W.x,y:W.y},{x:W.x+W.width,y:W.y},{x:W.x+W.width,y:W.y+W.height},{x:W.x,y:W.y+W.height}],Y=I.getAbsoluteTransform();B.forEach(function(V){const H=Y.point(V);L.push(H)})});const O=new e.Transform;O.rotate(-i.Konva.getAngle(this.rotation()));let G=1/0,K=1/0,te=-1/0,Z=-1/0;L.forEach(function(I){const W=O.point(I);G===void 0&&(G=te=W.x,K=Z=W.y),G=Math.min(G,W.x),K=Math.min(K,W.y),te=Math.max(te,W.x),Z=Math.max(Z,W.y)}),O.invert();const J=O.point({x:G,y:K});return{x:J.x,y:J.y,width:te-G,height:Z-K,rotation:i.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S.forEach(D=>{this._createAnchor(D)}),this._createAnchor("rotater")}_createAnchor(D){const L=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:D+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:v?10:"auto"}),O=this;L.on("mousedown touchstart",function(G){O._handleMouseDown(G)}),L.on("dragstart",G=>{L.stopDrag(),G.cancelBubble=!0}),L.on("dragend",G=>{G.cancelBubble=!0}),L.on("mouseenter",()=>{const G=i.Konva.getAngle(this.rotation()),K=this.rotateAnchorCursor(),te=w(D,G,K);L.getStage().content&&(L.getStage().content.style.cursor=te),this._cursorChange=!0}),L.on("mouseout",()=>{L.getStage().content&&(L.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(L)}_createBack(){const D=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(L,O){const G=O.getParent(),K=G.padding();L.beginPath(),L.rect(-K,-K,O.width()+K*2,O.height()+K*2),L.moveTo(O.width()/2,-K),G.rotateEnabled()&&G.rotateLineVisible()&&L.lineTo(O.width()/2,-G.rotateAnchorOffset()*e.Util._sign(O.height())-K),L.fillStrokeShape(O)},hitFunc:(L,O)=>{if(!this.shouldOverdrawWholeArea())return;const G=this.padding();L.beginPath(),L.rect(-G,-G,O.width()+G*2,O.height()+G*2),L.fillStrokeShape(O)}});this.add(D),this._proxyDrag(D),D.on("dragstart",L=>{L.cancelBubble=!0}),D.on("dragmove",L=>{L.cancelBubble=!0}),D.on("dragend",L=>{L.cancelBubble=!0}),this.on("dragmove",L=>{this.update()})}_handleMouseDown(D){if(this._transforming)return;this._movingAnchorName=D.target.name().split(" ")[0];const L=this._getNodeRect(),O=L.width,G=L.height,K=Math.sqrt(Math.pow(O,2)+Math.pow(G,2));this.sin=Math.abs(G/K),this.cos=Math.abs(O/K),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const te=D.target.getAbsolutePosition(),Z=D.target.getStage().getPointerPosition();this._anchorDragOffset={x:Z.x-te.x,y:Z.y-te.y},F++,this._fire("transformstart",{evt:D.evt,target:this.getNode()}),this._nodes.forEach(J=>{J._fire("transformstart",{evt:D.evt,target:J})})}_handleMouseMove(D){let L,O,G;const K=this.findOne("."+this._movingAnchorName),te=K.getStage();te.setPointersPositions(D);const Z=te.getPointerPosition();let J={x:Z.x-this._anchorDragOffset.x,y:Z.y-this._anchorDragOffset.y};const I=K.getAbsolutePosition();this.anchorDragBoundFunc()&&(J=this.anchorDragBoundFunc()(I,J,D)),K.setAbsolutePosition(J);const W=K.getAbsolutePosition();if(I.x===W.x&&I.y===W.y)return;if(this._movingAnchorName==="rotater"){const ae=this._getNodeRect();L=K.x()-ae.width/2,O=-K.y()+ae.height/2;let Q=Math.atan2(-O,L)+Math.PI/2;ae.height<0&&(Q-=Math.PI);const _e=i.Konva.getAngle(this.rotation())+Q,ke=i.Konva.getAngle(this.rotationSnapTolerance()),ge=N(this.rotationSnaps(),_e,ke)-ae.rotation,ye=_(ae,ge);this._fitNodesInto(ye,D);return}const B=this.shiftBehavior();let Y;B==="inverted"?Y=this.keepRatio()&&!D.shiftKey:B==="none"?Y=this.keepRatio():Y=this.keepRatio()||D.shiftKey;let V=this.centeredScaling()||D.altKey;if(this._movingAnchorName==="top-left"){if(Y){const ae=V?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};G=Math.sqrt(Math.pow(ae.x-K.x(),2)+Math.pow(ae.y-K.y(),2));const Q=this.findOne(".top-left").x()>ae.x?-1:1,le=this.findOne(".top-left").y()>ae.y?-1:1;L=G*this.cos*Q,O=G*this.sin*le,this.findOne(".top-left").x(ae.x-L),this.findOne(".top-left").y(ae.y-O)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(K.y());else if(this._movingAnchorName==="top-right"){if(Y){const ae=V?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};G=Math.sqrt(Math.pow(K.x()-ae.x,2)+Math.pow(ae.y-K.y(),2));const Q=this.findOne(".top-right").x()<ae.x?-1:1,le=this.findOne(".top-right").y()>ae.y?-1:1;L=G*this.cos*Q,O=G*this.sin*le,this.findOne(".top-right").x(ae.x+L),this.findOne(".top-right").y(ae.y-O)}var H=K.position();this.findOne(".top-left").y(H.y),this.findOne(".bottom-right").x(H.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(K.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(K.x());else if(this._movingAnchorName==="bottom-left"){if(Y){const ae=V?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};G=Math.sqrt(Math.pow(ae.x-K.x(),2)+Math.pow(K.y()-ae.y,2));const Q=ae.x<K.x()?-1:1,le=K.y()<ae.y?-1:1;L=G*this.cos*Q,O=G*this.sin*le,K.x(ae.x-L),K.y(ae.y+O)}H=K.position(),this.findOne(".top-left").x(H.x),this.findOne(".bottom-right").y(H.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(K.y());else if(this._movingAnchorName==="bottom-right"){if(Y){const ae=V?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};G=Math.sqrt(Math.pow(K.x()-ae.x,2)+Math.pow(K.y()-ae.y,2));const Q=this.findOne(".bottom-right").x()<ae.x?-1:1,le=this.findOne(".bottom-right").y()<ae.y?-1:1;L=G*this.cos*Q,O=G*this.sin*le,this.findOne(".bottom-right").x(ae.x+L),this.findOne(".bottom-right").y(ae.y+O)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(V=this.centeredScaling()||D.altKey,V){const ae=this.findOne(".top-left"),Q=this.findOne(".bottom-right"),le=ae.x(),_e=ae.y(),ke=this.getWidth()-Q.x(),Oe=this.getHeight()-Q.y();Q.move({x:-le,y:-_e}),ae.move({x:ke,y:Oe})}const X=this.findOne(".top-left").getAbsolutePosition();L=X.x,O=X.y;const se=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),ie=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:L,y:O,width:se,height:ie,rotation:i.Konva.getAngle(this.rotation())},D)}_handleMouseUp(D){this._removeEvents(D)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(D){var L;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const O=this.getNode();F--,this._fire("transformend",{evt:D,target:O}),(L=this.getLayer())===null||L===void 0||L.batchDraw(),O&&this._nodes.forEach(G=>{var K;G._fire("transformend",{evt:D,target:G}),(K=G.getLayer())===null||K===void 0||K.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(D,L){const O=this._getNodeRect(),G=1;if(e.Util._inRange(D.width,-this.padding()*2-G,G)){this.update();return}if(e.Util._inRange(D.height,-this.padding()*2-G,G)){this.update();return}const K=new e.Transform;if(K.rotate(i.Konva.getAngle(this.rotation())),this._movingAnchorName&&D.width<0&&this._movingAnchorName.indexOf("left")>=0){const Y=K.point({x:-this.padding()*2,y:0});D.x+=Y.x,D.y+=Y.y,D.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=Y.x,this._anchorDragOffset.y-=Y.y}else if(this._movingAnchorName&&D.width<0&&this._movingAnchorName.indexOf("right")>=0){const Y=K.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=Y.x,this._anchorDragOffset.y-=Y.y,D.width+=this.padding()*2}if(this._movingAnchorName&&D.height<0&&this._movingAnchorName.indexOf("top")>=0){const Y=K.point({x:0,y:-this.padding()*2});D.x+=Y.x,D.y+=Y.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=Y.x,this._anchorDragOffset.y-=Y.y,D.height+=this.padding()*2}else if(this._movingAnchorName&&D.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const Y=K.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=Y.x,this._anchorDragOffset.y-=Y.y,D.height+=this.padding()*2}if(this.boundBoxFunc()){const Y=this.boundBoxFunc()(O,D);Y?D=Y:e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const te=1e7,Z=new e.Transform;Z.translate(O.x,O.y),Z.rotate(O.rotation),Z.scale(O.width/te,O.height/te);const J=new e.Transform,I=D.width/te,W=D.height/te;this.flipEnabled()===!1?(J.translate(D.x,D.y),J.rotate(D.rotation),J.translate(D.width<0?D.width:0,D.height<0?D.height:0),J.scale(Math.abs(I),Math.abs(W))):(J.translate(D.x,D.y),J.rotate(D.rotation),J.scale(I,W));const B=J.multiply(Z.invert());this._nodes.forEach(Y=>{var V;const H=Y.getParent().getAbsoluteTransform(),X=Y.getTransform().copy();X.translate(Y.offsetX(),Y.offsetY());const se=new e.Transform;se.multiply(H.copy().invert()).multiply(B).multiply(H).multiply(X);const ie=se.decompose();Y.setAttrs(ie),(V=Y.getLayer())===null||V===void 0||V.batchDraw()}),this.rotation(e.Util._getRotation(D.rotation)),this._nodes.forEach(Y=>{this._fire("transform",{evt:L,target:Y}),Y._fire("transform",{evt:L,target:Y})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(D,L){this.findOne(D).setAttrs(L)}update(){var D;const L=this._getNodeRect();this.rotation(e.Util._getRotation(L.rotation));const O=L.width,G=L.height,K=this.enabledAnchors(),te=this.resizeEnabled(),Z=this.padding(),J=this.anchorSize(),I=this.find("._anchor");I.forEach(B=>{B.setAttrs({width:J,height:J,offsetX:J/2,offsetY:J/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:J/2+Z,offsetY:J/2+Z,visible:te&&K.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:O/2,y:0,offsetY:J/2+Z,visible:te&&K.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:O,y:0,offsetX:J/2-Z,offsetY:J/2+Z,visible:te&&K.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:G/2,offsetX:J/2+Z,visible:te&&K.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:O,y:G/2,offsetX:J/2-Z,visible:te&&K.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:G,offsetX:J/2+Z,offsetY:J/2-Z,visible:te&&K.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:O/2,y:G,offsetY:J/2-Z,visible:te&&K.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:O,y:G,offsetX:J/2-Z,offsetY:J/2-Z,visible:te&&K.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:O/2,y:-this.rotateAnchorOffset()*e.Util._sign(G)-Z,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:O,height:G,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const W=this.anchorStyleFunc();W&&I.forEach(B=>{W(B)}),(D=this.getLayer())===null||D===void 0||D.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const D=this.findOne("."+this._movingAnchorName);D&&D.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),a.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(D){return r.Node.prototype.clone.call(this,D)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Hg.Transformer=A,A.isTransforming=()=>F>0;function R(T){return T instanceof Array||e.Util.warn("enabledAnchors value should be an array"),T instanceof Array&&T.forEach(function(D){S.indexOf(D)===-1&&e.Util.warn("Unknown anchor name: "+D+". Available names are: "+S.join(", "))}),T||[]}return A.prototype.className="Transformer",(0,c._registerNode)(A),t.Factory.addGetterSetter(A,"enabledAnchors",S,R),t.Factory.addGetterSetter(A,"flipEnabled",!0,(0,o.getBooleanValidator)()),t.Factory.addGetterSetter(A,"resizeEnabled",!0),t.Factory.addGetterSetter(A,"anchorSize",10,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(A,"rotateEnabled",!0),t.Factory.addGetterSetter(A,"rotateLineVisible",!0),t.Factory.addGetterSetter(A,"rotationSnaps",[]),t.Factory.addGetterSetter(A,"rotateAnchorOffset",50,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(A,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(A,"rotationSnapTolerance",5,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(A,"borderEnabled",!0),t.Factory.addGetterSetter(A,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(A,"anchorStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(A,"anchorFill","white"),t.Factory.addGetterSetter(A,"anchorCornerRadius",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(A,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(A,"borderStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(A,"borderDash"),t.Factory.addGetterSetter(A,"keepRatio",!0),t.Factory.addGetterSetter(A,"shiftBehavior","default"),t.Factory.addGetterSetter(A,"centeredScaling",!1),t.Factory.addGetterSetter(A,"ignoreStroke",!1),t.Factory.addGetterSetter(A,"padding",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(A,"nodes"),t.Factory.addGetterSetter(A,"node"),t.Factory.addGetterSetter(A,"boundBoxFunc"),t.Factory.addGetterSetter(A,"anchorDragBoundFunc"),t.Factory.addGetterSetter(A,"anchorStyleFunc"),t.Factory.addGetterSetter(A,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(A,"useSingleNodeRotation",!0),t.Factory.backCompat(A,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Hg}var Gg={},NT;function wM(){if(NT)return Gg;NT=1,Object.defineProperty(Gg,"__esModule",{value:!0}),Gg.Wedge=void 0;const e=Br(),t=ea(),r=jr(),n=Wr(),s=jr();class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),o.lineTo(0,0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}}return Gg.Wedge=a,a.prototype.className="Wedge",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1),e.Factory.backCompat(a,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Gg}var Vg={},AT;function _M(){if(AT)return Vg;AT=1,Object.defineProperty(Vg,"__esModule",{value:!0}),Vg.Blur=void 0;const e=Br(),t=gs(),r=Wr();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function i(c,d){const f=c.data,p=c.width,m=c.height;let y,v,w,S,E,k,_,N,F,A,R,T,D,L,O,G,K,te,Z,J;const I=d+d+1,W=p-1,B=m-1,Y=d+1,V=Y*(Y+1)/2,H=new n,X=s[d],se=a[d];let ie=null,ae=H,Q=null,le=null;for(let _e=1;_e<I;_e++)ae=ae.next=new n,_e===Y&&(ie=ae);ae.next=H,w=v=0;for(let _e=0;_e<m;_e++){T=D=L=O=S=E=k=_=0,N=Y*(G=f[v]),F=Y*(K=f[v+1]),A=Y*(te=f[v+2]),R=Y*(Z=f[v+3]),S+=V*G,E+=V*K,k+=V*te,_+=V*Z,ae=H;for(let ke=0;ke<Y;ke++)ae.r=G,ae.g=K,ae.b=te,ae.a=Z,ae=ae.next;for(let ke=1;ke<Y;ke++)y=v+((W<ke?W:ke)<<2),S+=(ae.r=G=f[y])*(J=Y-ke),E+=(ae.g=K=f[y+1])*J,k+=(ae.b=te=f[y+2])*J,_+=(ae.a=Z=f[y+3])*J,T+=G,D+=K,L+=te,O+=Z,ae=ae.next;Q=H,le=ie;for(let ke=0;ke<p;ke++)f[v+3]=Z=_*X>>se,Z!==0?(Z=255/Z,f[v]=(S*X>>se)*Z,f[v+1]=(E*X>>se)*Z,f[v+2]=(k*X>>se)*Z):f[v]=f[v+1]=f[v+2]=0,S-=N,E-=F,k-=A,_-=R,N-=Q.r,F-=Q.g,A-=Q.b,R-=Q.a,y=w+((y=ke+d+1)<W?y:W)<<2,T+=Q.r=f[y],D+=Q.g=f[y+1],L+=Q.b=f[y+2],O+=Q.a=f[y+3],S+=T,E+=D,k+=L,_+=O,Q=Q.next,N+=G=le.r,F+=K=le.g,A+=te=le.b,R+=Z=le.a,T-=G,D-=K,L-=te,O-=Z,le=le.next,v+=4;w+=p}for(let _e=0;_e<p;_e++){D=L=O=T=E=k=_=S=0,v=_e<<2,N=Y*(G=f[v]),F=Y*(K=f[v+1]),A=Y*(te=f[v+2]),R=Y*(Z=f[v+3]),S+=V*G,E+=V*K,k+=V*te,_+=V*Z,ae=H;for(let Oe=0;Oe<Y;Oe++)ae.r=G,ae.g=K,ae.b=te,ae.a=Z,ae=ae.next;let ke=p;for(let Oe=1;Oe<=d;Oe++)v=ke+_e<<2,S+=(ae.r=G=f[v])*(J=Y-Oe),E+=(ae.g=K=f[v+1])*J,k+=(ae.b=te=f[v+2])*J,_+=(ae.a=Z=f[v+3])*J,T+=G,D+=K,L+=te,O+=Z,ae=ae.next,Oe<B&&(ke+=p);v=_e,Q=H,le=ie;for(let Oe=0;Oe<m;Oe++)y=v<<2,f[y+3]=Z=_*X>>se,Z>0?(Z=255/Z,f[y]=(S*X>>se)*Z,f[y+1]=(E*X>>se)*Z,f[y+2]=(k*X>>se)*Z):f[y]=f[y+1]=f[y+2]=0,S-=N,E-=F,k-=A,_-=R,N-=Q.r,F-=Q.g,A-=Q.b,R-=Q.a,y=_e+((y=Oe+Y)<B?y:B)*p<<2,S+=T+=Q.r=f[y],E+=D+=Q.g=f[y+1],k+=L+=Q.b=f[y+2],_+=O+=Q.a=f[y+3],Q=Q.next,N+=G=le.r,F+=K=le.g,A+=te=le.b,R+=Z=le.a,T-=G,D-=K,L-=te,O-=Z,le=le.next,v+=p}}const o=function(d){const f=Math.round(this.blurRadius());f>0&&i(d,f)};return Vg.Blur=o,e.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Vg}var Kg={},jT;function bM(){if(jT)return Kg;jT=1,Object.defineProperty(Kg,"__esModule",{value:!0}),Kg.Brighten=void 0;const e=Br(),t=gs(),r=Wr(),n=function(s){const a=this.brightness()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=4)i[c]+=a,i[c+1]+=a,i[c+2]+=a};return Kg.Brighten=n,e.Factory.addGetterSetter(t.Node,"brightness",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Kg}var qg={},FT;function SM(){if(FT)return qg;FT=1,Object.defineProperty(qg,"__esModule",{value:!0}),qg.Contrast=void 0;const e=Br(),t=gs(),r=Wr(),n=function(s){const a=Math.pow((this.contrast()+100)/100,2),i=s.data,o=i.length;let c=150,d=150,f=150;for(let p=0;p<o;p+=4)c=i[p],d=i[p+1],f=i[p+2],c/=255,c-=.5,c*=a,c+=.5,c*=255,d/=255,d-=.5,d*=a,d+=.5,d*=255,f/=255,f-=.5,f*=a,f+=.5,f*=255,c=c<0?0:c>255?255:c,d=d<0?0:d>255?255:d,f=f<0?0:f>255?255:f,i[p]=c,i[p+1]=d,i[p+2]=f};return qg.Contrast=n,e.Factory.addGetterSetter(t.Node,"contrast",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),qg}var Xg={},PT;function kM(){if(PT)return Xg;PT=1,Object.defineProperty(Xg,"__esModule",{value:!0}),Xg.Emboss=void 0;const e=Br(),t=gs(),r=rs(),n=Wr(),s=function(a){const i=this.embossStrength()*10,o=this.embossWhiteLevel()*255,c=this.embossDirection(),d=this.embossBlend(),f=a.data,p=a.width,m=a.height,y=p*4;let v=0,w=0,S=m;switch(c){case"top-left":v=-1,w=-1;break;case"top":v=-1,w=0;break;case"top-right":v=-1,w=1;break;case"right":v=0,w=1;break;case"bottom-right":v=1,w=1;break;case"bottom":v=1,w=0;break;case"bottom-left":v=1,w=-1;break;case"left":v=0,w=-1;break;default:r.Util.error("Unknown emboss direction: "+c)}do{const E=(S-1)*y;let k=v;S+k<1&&(k=0),S+k>m&&(k=0);const _=(S-1+k)*p*4;let N=p;do{const F=E+(N-1)*4;let A=w;N+A<1&&(A=0),N+A>p&&(A=0);const R=_+(N-1+A)*4,T=f[F]-f[R],D=f[F+1]-f[R+1],L=f[F+2]-f[R+2];let O=T;const G=O>0?O:-O,K=D>0?D:-D,te=L>0?L:-L;if(K>G&&(O=D),te>G&&(O=L),O*=i,d){const Z=f[F]+O,J=f[F+1]+O,I=f[F+2]+O;f[F]=Z>255?255:Z<0?0:Z,f[F+1]=J>255?255:J<0?0:J,f[F+2]=I>255?255:I<0?0:I}else{let Z=o-O;Z<0?Z=0:Z>255&&(Z=255),f[F]=f[F+1]=f[F+2]=Z}}while(--N)}while(--S)};return Xg.Emboss=s,e.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,e.Factory.afterSetFilter),Xg}var Yg={},DT;function CM(){if(DT)return Yg;DT=1,Object.defineProperty(Yg,"__esModule",{value:!0}),Yg.Enhance=void 0;const e=Br(),t=gs(),r=Wr();function n(a,i,o,c,d){const f=o-i,p=d-c;if(f===0)return c+p/2;if(p===0)return c;let m=(a-i)/f;return m=p*m+c,m}const s=function(a){const i=a.data,o=i.length;let c=i[0],d=c,f,p=i[1],m=p,y,v=i[2],w=v,S;const E=this.enhance();if(E===0)return;for(let T=0;T<o;T+=4)f=i[T+0],f<c?c=f:f>d&&(d=f),y=i[T+1],y<p?p=y:y>m&&(m=y),S=i[T+2],S<v?v=S:S>w&&(w=S);d===c&&(d=255,c=0),m===p&&(m=255,p=0),w===v&&(w=255,v=0);let k,_,N,F,A,R;if(E>0)k=d+E*(255-d),_=c-E*(c-0),N=m+E*(255-m),F=p-E*(p-0),A=w+E*(255-w),R=v-E*(v-0);else{const T=(d+c)*.5;k=d+E*(d-T),_=c+E*(c-T);const D=(m+p)*.5;N=m+E*(m-D),F=p+E*(p-D);const L=(w+v)*.5;A=w+E*(w-L),R=v+E*(v-L)}for(let T=0;T<o;T+=4)i[T+0]=n(i[T+0],c,d,_,k),i[T+1]=n(i[T+1],p,m,F,N),i[T+2]=n(i[T+2],v,w,R,A)};return Yg.Enhance=s,e.Factory.addGetterSetter(t.Node,"enhance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Yg}var Jg={},RT;function TM(){if(RT)return Jg;RT=1,Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.Grayscale=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=.34*r[s]+.5*r[s+1]+.16*r[s+2];r[s]=a,r[s+1]=a,r[s+2]=a}};return Jg.Grayscale=e,Jg}var Qg={},IT;function EM(){if(IT)return Qg;IT=1,Object.defineProperty(Qg,"__esModule",{value:!0}),Qg.HSL=void 0;const e=Br(),t=gs(),r=Wr();e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"luminance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter);const n=function(s){const a=s.data,i=a.length,o=1,c=Math.pow(2,this.saturation()),d=Math.abs(this.hue()+360)%360,f=this.luminance()*127,p=o*c*Math.cos(d*Math.PI/180),m=o*c*Math.sin(d*Math.PI/180),y=.299*o+.701*p+.167*m,v=.587*o-.587*p+.33*m,w=.114*o-.114*p-.497*m,S=.299*o-.299*p-.328*m,E=.587*o+.413*p+.035*m,k=.114*o-.114*p+.293*m,_=.299*o-.3*p+1.25*m,N=.587*o-.586*p-1.05*m,F=.114*o+.886*p-.2*m;let A,R,T,D;for(let L=0;L<i;L+=4)A=a[L+0],R=a[L+1],T=a[L+2],D=a[L+3],a[L+0]=y*A+v*R+w*T+f,a[L+1]=S*A+E*R+k*T+f,a[L+2]=_*A+N*R+F*T+f,a[L+3]=D};return Qg.HSL=n,Qg}var Zg={},MT;function NM(){if(MT)return Zg;MT=1,Object.defineProperty(Zg,"__esModule",{value:!0}),Zg.HSV=void 0;const e=Br(),t=gs(),r=Wr(),n=function(s){const a=s.data,i=a.length,o=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),d=Math.abs(this.hue()+360)%360,f=o*c*Math.cos(d*Math.PI/180),p=o*c*Math.sin(d*Math.PI/180),m=.299*o+.701*f+.167*p,y=.587*o-.587*f+.33*p,v=.114*o-.114*f-.497*p,w=.299*o-.299*f-.328*p,S=.587*o+.413*f+.035*p,E=.114*o-.114*f+.293*p,k=.299*o-.3*f+1.25*p,_=.587*o-.586*f-1.05*p,N=.114*o+.886*f-.2*p;for(let F=0;F<i;F+=4){const A=a[F+0],R=a[F+1],T=a[F+2],D=a[F+3];a[F+0]=m*A+y*R+v*T,a[F+1]=w*A+S*R+E*T,a[F+2]=k*A+_*R+N*T,a[F+3]=D}};return Zg.HSV=n,e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"value",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Zg}var em={},LT;function AM(){if(LT)return em;LT=1,Object.defineProperty(em,"__esModule",{value:!0}),em.Invert=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]=255-r[s],r[s+1]=255-r[s+1],r[s+2]=255-r[s+2]};return em.Invert=e,em}var tm={},OT;function jM(){if(OT)return tm;OT=1,Object.defineProperty(tm,"__esModule",{value:!0}),tm.Kaleidoscope=void 0;const e=Br(),t=gs(),r=rs(),n=Wr(),s=function(o,c,d){const f=o.data,p=c.data,m=o.width,y=o.height,v=d.polarCenterX||m/2,w=d.polarCenterY||y/2;let S=Math.sqrt(v*v+w*w),E=m-v,k=y-w;const _=Math.sqrt(E*E+k*k);S=_>S?_:S;const N=y,F=m,A=360/F*Math.PI/180;for(let R=0;R<F;R+=1){const T=Math.sin(R*A),D=Math.cos(R*A);for(let L=0;L<N;L+=1){E=Math.floor(v+S*L/N*D),k=Math.floor(w+S*L/N*T);let O=(k*m+E)*4;const G=f[O+0],K=f[O+1],te=f[O+2],Z=f[O+3];O=(R+L*m)*4,p[O+0]=G,p[O+1]=K,p[O+2]=te,p[O+3]=Z}}},a=function(o,c,d){const f=o.data,p=c.data,m=o.width,y=o.height,v=d.polarCenterX||m/2,w=d.polarCenterY||y/2;let S=Math.sqrt(v*v+w*w),E=m-v,k=y-w;const _=Math.sqrt(E*E+k*k);S=_>S?_:S;const N=y,F=m,A=0;let R,T;for(E=0;E<m;E+=1)for(k=0;k<y;k+=1){const D=E-v,L=k-w,O=Math.sqrt(D*D+L*L)*N/S;let G=(Math.atan2(L,D)*180/Math.PI+360+A)%360;G=G*F/360,R=Math.floor(G),T=Math.floor(O);let K=(T*m+R)*4;const te=f[K+0],Z=f[K+1],J=f[K+2],I=f[K+3];K=(k*m+E)*4,p[K+0]=te,p[K+1]=Z,p[K+2]=J,p[K+3]=I}},i=function(o){const c=o.width,d=o.height;let f,p,m,y,v,w,S,E,k,_,N=Math.round(this.kaleidoscopePower());const F=Math.round(this.kaleidoscopeAngle()),A=Math.floor(c*(F%360)/360);if(N<1)return;const R=r.Util.createCanvasElement();R.width=c,R.height=d;const T=R.getContext("2d").getImageData(0,0,c,d);r.Util.releaseCanvas(R),s(o,T,{polarCenterX:c/2,polarCenterY:d/2});let D=c/Math.pow(2,N);for(;D<=8;)D=D*2,N-=1;D=Math.ceil(D);let L=D,O=0,G=L,K=1;for(A+D>c&&(O=L,G=0,K=-1),p=0;p<d;p+=1)for(f=O;f!==G;f+=K)m=Math.round(f+A)%c,k=(c*p+m)*4,v=T.data[k+0],w=T.data[k+1],S=T.data[k+2],E=T.data[k+3],_=(c*p+f)*4,T.data[_+0]=v,T.data[_+1]=w,T.data[_+2]=S,T.data[_+3]=E;for(p=0;p<d;p+=1)for(L=Math.floor(D),y=0;y<N;y+=1){for(f=0;f<L+1;f+=1)k=(c*p+f)*4,v=T.data[k+0],w=T.data[k+1],S=T.data[k+2],E=T.data[k+3],_=(c*p+L*2-f-1)*4,T.data[_+0]=v,T.data[_+1]=w,T.data[_+2]=S,T.data[_+3]=E;L*=2}a(T,o,{})};return tm.Kaleidoscope=i,e.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),tm}var rm={},BT;function FM(){if(BT)return rm;BT=1,Object.defineProperty(rm,"__esModule",{value:!0}),rm.Mask=void 0;const e=Br(),t=gs(),r=Wr();function n(m,y,v){let w=(v*m.width+y)*4;const S=[];return S.push(m.data[w++],m.data[w++],m.data[w++],m.data[w++]),S}function s(m,y){return Math.sqrt(Math.pow(m[0]-y[0],2)+Math.pow(m[1]-y[1],2)+Math.pow(m[2]-y[2],2))}function a(m){const y=[0,0,0];for(let v=0;v<m.length;v++)y[0]+=m[v][0],y[1]+=m[v][1],y[2]+=m[v][2];return y[0]/=m.length,y[1]/=m.length,y[2]/=m.length,y}function i(m,y){const v=n(m,0,0),w=n(m,m.width-1,0),S=n(m,0,m.height-1),E=n(m,m.width-1,m.height-1),k=y||10;if(s(v,w)<k&&s(w,E)<k&&s(E,S)<k&&s(S,v)<k){const _=a([w,v,E,S]),N=[];for(let F=0;F<m.width*m.height;F++){const A=s(_,[m.data[F*4],m.data[F*4+1],m.data[F*4+2]]);N[F]=A<k?0:255}return N}}function o(m,y){for(let v=0;v<m.width*m.height;v++)m.data[4*v+3]=y[v]}function c(m,y,v){const w=[1,1,1,1,0,1,1,1,1],S=Math.round(Math.sqrt(w.length)),E=Math.floor(S/2),k=[];for(let _=0;_<v;_++)for(let N=0;N<y;N++){const F=_*y+N;let A=0;for(let R=0;R<S;R++)for(let T=0;T<S;T++){const D=_+R-E,L=N+T-E;if(D>=0&&D<v&&L>=0&&L<y){const O=D*y+L,G=w[R*S+T];A+=m[O]*G}}k[F]=A===2040?255:0}return k}function d(m,y,v){const w=[1,1,1,1,1,1,1,1,1],S=Math.round(Math.sqrt(w.length)),E=Math.floor(S/2),k=[];for(let _=0;_<v;_++)for(let N=0;N<y;N++){const F=_*y+N;let A=0;for(let R=0;R<S;R++)for(let T=0;T<S;T++){const D=_+R-E,L=N+T-E;if(D>=0&&D<v&&L>=0&&L<y){const O=D*y+L,G=w[R*S+T];A+=m[O]*G}}k[F]=A>=1020?255:0}return k}function f(m,y,v){const w=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],S=Math.round(Math.sqrt(w.length)),E=Math.floor(S/2),k=[];for(let _=0;_<v;_++)for(let N=0;N<y;N++){const F=_*y+N;let A=0;for(let R=0;R<S;R++)for(let T=0;T<S;T++){const D=_+R-E,L=N+T-E;if(D>=0&&D<v&&L>=0&&L<y){const O=D*y+L,G=w[R*S+T];A+=m[O]*G}}k[F]=A}return k}const p=function(m){const y=this.threshold();let v=i(m,y);return v&&(v=c(v,m.width,m.height),v=d(v,m.width,m.height),v=f(v,m.width,m.height),o(m,v)),m};return rm.Mask=p,e.Factory.addGetterSetter(t.Node,"threshold",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),rm}var nm={},UT;function PM(){if(UT)return nm;UT=1,Object.defineProperty(nm,"__esModule",{value:!0}),nm.Noise=void 0;const e=Br(),t=gs(),r=Wr(),n=function(s){const a=this.noise()*255,i=s.data,o=i.length,c=a/2;for(let d=0;d<o;d+=4)i[d+0]+=c-2*c*Math.random(),i[d+1]+=c-2*c*Math.random(),i[d+2]+=c-2*c*Math.random()};return nm.Noise=n,e.Factory.addGetterSetter(t.Node,"noise",.2,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),nm}var sm={},$T;function DM(){if($T)return sm;$T=1,Object.defineProperty(sm,"__esModule",{value:!0}),sm.Pixelate=void 0;const e=Br(),t=rs(),r=gs(),n=Wr(),s=function(a){let i=Math.ceil(this.pixelSize()),o=a.width,c=a.height,d=Math.ceil(o/i),f=Math.ceil(c/i),p=a.data;if(i<=0){t.Util.error("pixelSize value can not be <= 0");return}for(let m=0;m<d;m+=1)for(let y=0;y<f;y+=1){let v=0,w=0,S=0,E=0;const k=m*i,_=k+i,N=y*i,F=N+i;let A=0;for(let R=k;R<_;R+=1)if(!(R>=o))for(let T=N;T<F;T+=1){if(T>=c)continue;const D=(o*T+R)*4;v+=p[D+0],w+=p[D+1],S+=p[D+2],E+=p[D+3],A+=1}v=v/A,w=w/A,S=S/A,E=E/A;for(let R=k;R<_;R+=1)if(!(R>=o))for(let T=N;T<F;T+=1){if(T>=c)continue;const D=(o*T+R)*4;p[D+0]=v,p[D+1]=w,p[D+2]=S,p[D+3]=E}}};return sm.Pixelate=s,e.Factory.addGetterSetter(r.Node,"pixelSize",8,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),sm}var am={},WT;function RM(){if(WT)return am;WT=1,Object.defineProperty(am,"__esModule",{value:!0}),am.Posterize=void 0;const e=Br(),t=gs(),r=Wr(),n=function(s){const a=Math.round(this.levels()*254)+1,i=s.data,o=i.length,c=255/a;for(let d=0;d<o;d+=1)i[d]=Math.floor(i[d]/c)*c};return am.Posterize=n,e.Factory.addGetterSetter(t.Node,"levels",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),am}var im={},zT;function IM(){if(zT)return im;zT=1,Object.defineProperty(im,"__esModule",{value:!0}),im.RGB=void 0;const e=Br(),t=gs(),r=Wr(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),d=this.blue();for(let f=0;f<i;f+=4){const p=(.34*a[f]+.5*a[f+1]+.16*a[f+2])/255;a[f]=p*o,a[f+1]=p*c,a[f+2]=p*d,a[f+3]=a[f+3]}};return im.RGB=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),im}var om={},HT;function MM(){if(HT)return om;HT=1,Object.defineProperty(om,"__esModule",{value:!0}),om.RGBA=void 0;const e=Br(),t=gs(),r=Wr(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),d=this.blue(),f=this.alpha();for(let p=0;p<i;p+=4){const m=1-f;a[p]=o*f+a[p]*m,a[p+1]=c*f+a[p+1]*m,a[p+2]=d*f+a[p+2]*m}};return om.RGBA=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),om}var lm={},GT;function LM(){if(GT)return lm;GT=1,Object.defineProperty(lm,"__esModule",{value:!0}),lm.Sepia=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=r[s+0],i=r[s+1],o=r[s+2];r[s+0]=Math.min(255,a*.393+i*.769+o*.189),r[s+1]=Math.min(255,a*.349+i*.686+o*.168),r[s+2]=Math.min(255,a*.272+i*.534+o*.131)}};return lm.Sepia=e,lm}var cm={},VT;function OM(){if(VT)return cm;VT=1,Object.defineProperty(cm,"__esModule",{value:!0}),cm.Solarize=void 0;const e=function(t){const r=t.data,n=t.width,s=t.height,a=n*4;let i=s;do{const o=(i-1)*a;let c=n;do{const d=o+(c-1)*4;let f=r[d],p=r[d+1],m=r[d+2];f>127&&(f=255-f),p>127&&(p=255-p),m>127&&(m=255-m),r[d]=f,r[d+1]=p,r[d+2]=m}while(--c)}while(--i)};return cm.Solarize=e,cm}var um={},KT;function BM(){if(KT)return um;KT=1,Object.defineProperty(um,"__esModule",{value:!0}),um.Threshold=void 0;const e=Br(),t=gs(),r=Wr(),n=function(s){const a=this.threshold()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=1)i[c]=i[c]<a?0:255};return um.Threshold=n,e.Factory.addGetterSetter(t.Node,"threshold",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),um}var qT;function UM(){if(qT)return kg;qT=1,Object.defineProperty(kg,"__esModule",{value:!0}),kg.Konva=void 0;const e=v_(),t=oM(),r=cM(),n=uM(),s=dM(),a=fM(),i=hM(),o=m6(),c=rb(),d=p6(),f=gM(),p=mM(),m=pM(),y=xM(),v=x6(),w=yM(),S=vM(),E=wM(),k=_M(),_=bM(),N=SM(),F=kM(),A=CM(),R=TM(),T=EM(),D=NM(),L=AM(),O=jM(),G=FM(),K=PM(),te=DM(),Z=RM(),J=IM(),I=MM(),W=LM(),B=OM(),Y=BM();return kg.Konva=e.Konva.Util._assign(e.Konva,{Arc:t.Arc,Arrow:r.Arrow,Circle:n.Circle,Ellipse:s.Ellipse,Image:a.Image,Label:i.Label,Tag:i.Tag,Line:o.Line,Path:c.Path,Rect:d.Rect,RegularPolygon:f.RegularPolygon,Ring:p.Ring,Sprite:m.Sprite,Star:y.Star,Text:v.Text,TextPath:w.TextPath,Transformer:S.Transformer,Wedge:E.Wedge,Filters:{Blur:k.Blur,Brighten:_.Brighten,Contrast:N.Contrast,Emboss:F.Emboss,Enhance:A.Enhance,Grayscale:R.Grayscale,HSL:T.HSL,HSV:D.HSV,Invert:L.Invert,Kaleidoscope:O.Kaleidoscope,Mask:G.Mask,Noise:K.Noise,Pixelate:te.Pixelate,Posterize:Z.Posterize,RGB:J.RGB,RGBA:I.RGBA,Sepia:W.Sepia,Solarize:B.Solarize,Threshold:Y.Threshold}}),kg}var $M=N1.exports,XT;function WM(){if(XT)return N1.exports;XT=1,Object.defineProperty($M,"__esModule",{value:!0});const e=UM();return N1.exports=e.Konva,N1.exports}var y6=WM();const zM=wp(y6),HM=mN({__proto__:null,default:zM},[y6]);var t1={exports:{}},YT;function GM(){return YT||(YT=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=v_();Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=v_();e.exports=n.Konva})(t1,t1.exports)),t1.exports}var VM=GM();const Ym=wp(VM);var uw={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dw,JT;function KM(){return JT||(JT=1,dw=function(t){var r={},n=_y(),s=g2(),a=Object.assign;function i(g){for(var x="https://reactjs.org/docs/error-decoder.html?invariant="+g,j=1;j<arguments.length;j++)x+="&args[]="+encodeURIComponent(arguments[j]);return"Minified React error #"+g+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),d=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),v=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),N=Symbol.for("react.offscreen"),F=Symbol.iterator;function A(g){return g===null||typeof g!="object"?null:(g=F&&g[F]||g["@@iterator"],typeof g=="function"?g:null)}function R(g){if(g==null)return null;if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g;switch(g){case f:return"Fragment";case d:return"Portal";case m:return"Profiler";case p:return"StrictMode";case S:return"Suspense";case E:return"SuspenseList"}if(typeof g=="object")switch(g.$$typeof){case v:return(g.displayName||"Context")+".Consumer";case y:return(g._context.displayName||"Context")+".Provider";case w:var x=g.render;return g=g.displayName,g||(g=x.displayName||x.name||"",g=g!==""?"ForwardRef("+g+")":"ForwardRef"),g;case k:return x=g.displayName||null,x!==null?x:R(g.type)||"Memo";case _:x=g._payload,g=g._init;try{return R(g(x))}catch{}}return null}function T(g){var x=g.type;switch(g.tag){case 24:return"Cache";case 9:return(x.displayName||"Context")+".Consumer";case 10:return(x._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=x.render,g=g.displayName||g.name||"",x.displayName||(g!==""?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return x;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R(x);case 8:return x===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x}return null}function D(g){var x=g,j=g;if(g.alternate)for(;x.return;)x=x.return;else{g=x;do x=g,(x.flags&4098)!==0&&(j=x.return),g=x.return;while(g)}return x.tag===3?j:null}function L(g){if(D(g)!==g)throw Error(i(188))}function O(g){var x=g.alternate;if(!x){if(x=D(g),x===null)throw Error(i(188));return x!==g?null:g}for(var j=g,M=x;;){var z=j.return;if(z===null)break;var ee=z.alternate;if(ee===null){if(M=z.return,M!==null){j=M;continue}break}if(z.child===ee.child){for(ee=z.child;ee;){if(ee===j)return L(z),g;if(ee===M)return L(z),x;ee=ee.sibling}throw Error(i(188))}if(j.return!==M.return)j=z,M=ee;else{for(var xe=!1,$e=z.child;$e;){if($e===j){xe=!0,j=z,M=ee;break}if($e===M){xe=!0,M=z,j=ee;break}$e=$e.sibling}if(!xe){for($e=ee.child;$e;){if($e===j){xe=!0,j=ee,M=z;break}if($e===M){xe=!0,M=ee,j=z;break}$e=$e.sibling}if(!xe)throw Error(i(189))}}if(j.alternate!==M)throw Error(i(190))}if(j.tag!==3)throw Error(i(188));return j.stateNode.current===j?g:x}function G(g){return g=O(g),g!==null?K(g):null}function K(g){if(g.tag===5||g.tag===6)return g;for(g=g.child;g!==null;){var x=K(g);if(x!==null)return x;g=g.sibling}return null}function te(g){if(g.tag===5||g.tag===6)return g;for(g=g.child;g!==null;){if(g.tag!==4){var x=te(g);if(x!==null)return x}g=g.sibling}return null}var Z=Array.isArray,J=t.getPublicInstance,I=t.getRootHostContext,W=t.getChildHostContext,B=t.prepareForCommit,Y=t.resetAfterCommit,V=t.createInstance,H=t.appendInitialChild,X=t.finalizeInitialChildren,se=t.prepareUpdate,ie=t.shouldSetTextContent,ae=t.createTextInstance,Q=t.scheduleTimeout,le=t.cancelTimeout,_e=t.noTimeout,ke=t.isPrimaryRenderer,Oe=t.supportsMutation,ge=t.supportsPersistence,ye=t.supportsHydration,Ke=t.getInstanceFromNode,Xe=t.preparePortalMount,lt=t.getCurrentEventPriority,Ye=t.detachDeletedInstance,We=t.supportsMicrotasks,Me=t.scheduleMicrotask,je=t.supportsTestSelectors,De=t.findFiberRoot,Ge=t.getBoundingRect,ct=t.getTextContent,at=t.isHiddenSubtree,wt=t.matchAccessibilityRole,Ft=t.setFocusIfFocusable,Kt=t.setupIntersectionObserver,bt=t.appendChild,At=t.appendChildToContainer,gt=t.commitTextUpdate,kt=t.commitMount,Gt=t.commitUpdate,$t=t.insertBefore,Be=t.insertInContainerBefore,it=t.removeChild,ut=t.removeChildFromContainer,St=t.resetTextContent,Mt=t.hideInstance,Ot=t.hideTextInstance,Te=t.unhideInstance,ve=t.unhideTextInstance,Ne=t.clearContainer,Fe=t.cloneInstance,dt=t.createContainerChildSet,Wt=t.appendChildToContainerChildSet,Et=t.finalizeContainerChildren,nr=t.replaceContainerChildren,Qt=t.cloneHiddenInstance,Zt=t.cloneHiddenTextInstance,Nr=t.canHydrateInstance,Mr=t.canHydrateTextInstance,cr=t.canHydrateSuspenseInstance,Fr=t.isSuspenseInstancePending,Pr=t.isSuspenseInstanceFallback,Cn=t.getSuspenseInstanceFallbackErrorDetails,ce=t.registerSuspenseInstanceRetry,be=t.getNextHydratableSibling,pe=t.getFirstHydratableChild,we=t.getFirstHydratableChildWithinContainer,Ce=t.getFirstHydratableChildWithinSuspenseInstance,oe=t.hydrateInstance,me=t.hydrateTextInstance,re=t.hydrateSuspenseInstance,ne=t.getNextHydratableInstanceAfterSuspenseInstance,fe=t.commitHydratedContainer,de=t.commitHydratedSuspenseInstance,Pe=t.clearSuspenseBoundary,Ve=t.clearSuspenseBoundaryFromContainer,Ae=t.shouldDeleteUnhydratedTailInstances,Ue=t.didNotMatchHydratedContainerTextInstance,ze=t.didNotMatchHydratedTextInstance,pt;function Bt(g){if(pt===void 0)try{throw Error()}catch(j){var x=j.stack.trim().match(/\n( *(at )?)/);pt=x&&x[1]||""}return`
`+pt+g}var sr=!1;function rr(g,x){if(!g||sr)return"";sr=!0;var j=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(x)if(x=function(){throw Error()},Object.defineProperty(x.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(x,[])}catch(Nt){var M=Nt}Reflect.construct(g,[],x)}else{try{x.call()}catch(Nt){M=Nt}g.call(x.prototype)}else{try{throw Error()}catch(Nt){M=Nt}g()}}catch(Nt){if(Nt&&M&&typeof Nt.stack=="string"){for(var z=Nt.stack.split(`
`),ee=M.stack.split(`
`),xe=z.length-1,$e=ee.length-1;1<=xe&&0<=$e&&z[xe]!==ee[$e];)$e--;for(;1<=xe&&0<=$e;xe--,$e--)if(z[xe]!==ee[$e]){if(xe!==1||$e!==1)do if(xe--,$e--,0>$e||z[xe]!==ee[$e]){var nt=`
`+z[xe].replace(" at new "," at ");return g.displayName&&nt.includes("<anonymous>")&&(nt=nt.replace("<anonymous>",g.displayName)),nt}while(1<=xe&&0<=$e);break}}}finally{sr=!1,Error.prepareStackTrace=j}return(g=g?g.displayName||g.name:"")?Bt(g):""}var Gr=Object.prototype.hasOwnProperty,Lr=[],yr=-1;function Tr(g){return{current:g}}function Ur(g){0>yr||(g.current=Lr[yr],Lr[yr]=null,yr--)}function he(g,x){yr++,Lr[yr]=g.current,g.current=x}var Se={},Ze=Tr(Se),st=Tr(!1),zt=Se;function Er(g,x){var j=g.type.contextTypes;if(!j)return Se;var M=g.stateNode;if(M&&M.__reactInternalMemoizedUnmaskedChildContext===x)return M.__reactInternalMemoizedMaskedChildContext;var z={},ee;for(ee in j)z[ee]=x[ee];return M&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=x,g.__reactInternalMemoizedMaskedChildContext=z),z}function vr(g){return g=g.childContextTypes,g!=null}function va(){Ur(st),Ur(Ze)}function Ui(g,x,j){if(Ze.current!==Se)throw Error(i(168));he(Ze,x),he(st,j)}function Fl(g,x,j){var M=g.stateNode;if(x=x.childContextTypes,typeof M.getChildContext!="function")return j;M=M.getChildContext();for(var z in M)if(!(z in x))throw Error(i(108,T(g)||"Unknown",z));return a({},j,M)}function Bs(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||Se,zt=Ze.current,he(Ze,g),he(st,st.current),!0}function Dn(g,x,j){var M=g.stateNode;if(!M)throw Error(i(169));j?(g=Fl(g,x,zt),M.__reactInternalMemoizedMergedChildContext=g,Ur(st),Ur(Ze),he(Ze,g)):Ur(st),he(st,j)}var Us=Math.clz32?Math.clz32:P0,Pl=Math.log,nv=Math.LN2;function P0(g){return g>>>=0,g===0?32:31-(Pl(g)/nv|0)|0}var zr=64,Xu=4194304;function Fc(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return g&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function Pc(g,x){var j=g.pendingLanes;if(j===0)return 0;var M=0,z=g.suspendedLanes,ee=g.pingedLanes,xe=j&268435455;if(xe!==0){var $e=xe&~z;$e!==0?M=Fc($e):(ee&=xe,ee!==0&&(M=Fc(ee)))}else xe=j&~z,xe!==0?M=Fc(xe):ee!==0&&(M=Fc(ee));if(M===0)return 0;if(x!==0&&x!==M&&(x&z)===0&&(z=M&-M,ee=x&-x,z>=ee||z===16&&(ee&4194240)!==0))return x;if((M&4)!==0&&(M|=j&16),x=g.entangledLanes,x!==0)for(g=g.entanglements,x&=M;0<x;)j=31-Us(x),z=1<<j,M|=g[j],x&=~z;return M}function Yp(g,x){switch(g){case 1:case 2:case 4:return x+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jp(g,x){for(var j=g.suspendedLanes,M=g.pingedLanes,z=g.expirationTimes,ee=g.pendingLanes;0<ee;){var xe=31-Us(ee),$e=1<<xe,nt=z[xe];nt===-1?(($e&j)===0||($e&M)!==0)&&(z[xe]=Yp($e,x)):nt<=x&&(g.expiredLanes|=$e),ee&=~$e}}function Cf(g){return g=g.pendingLanes&-1073741825,g!==0?g:g&1073741824?1073741824:0}function Tf(){var g=zr;return zr<<=1,(zr&4194240)===0&&(zr=64),g}function Dc(g){for(var x=[],j=0;31>j;j++)x.push(g);return x}function ii(g,x,j){g.pendingLanes|=x,x!==536870912&&(g.suspendedLanes=0,g.pingedLanes=0),g=g.eventTimes,x=31-Us(x),g[x]=j}function Vo(g,x){var j=g.pendingLanes&~x;g.pendingLanes=x,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=x,g.mutableReadLanes&=x,g.entangledLanes&=x,x=g.entanglements;var M=g.eventTimes;for(g=g.expirationTimes;0<j;){var z=31-Us(j),ee=1<<z;x[z]=0,M[z]=-1,g[z]=-1,j&=~ee}}function $i(g,x){var j=g.entangledLanes|=x;for(g=g.entanglements;j;){var M=31-Us(j),z=1<<M;z&x|g[M]&x&&(g[M]|=x),j&=~z}}var Dr=0;function Rc(g){return g&=-g,1<g?4<g?(g&268435455)!==0?16:536870912:4:1}var Wi=s.unstable_scheduleCallback,Qp=s.unstable_cancelCallback,Zp=s.unstable_shouldYield,Yu=s.unstable_requestPaint,ps=s.unstable_now,Ef=s.unstable_ImmediatePriority,Nf=s.unstable_UserBlockingPriority,Af=s.unstable_NormalPriority,sv=s.unstable_IdlePriority,Ko=null,wa=null;function Ic(g){if(wa&&typeof wa.onCommitFiberRoot=="function")try{wa.onCommitFiberRoot(Ko,g,void 0,(g.current.flags&128)===128)}catch{}}function jf(g,x){return g===x&&(g!==0||1/g===1/x)||g!==g&&x!==x}var ki=typeof Object.is=="function"?Object.is:jf,yo=null,Mc=!1,Lc=!1;function Ff(g){yo===null?yo=[g]:yo.push(g)}function ex(g){Mc=!0,Ff(g)}function Ns(){if(!Lc&&yo!==null){Lc=!0;var g=0,x=Dr;try{var j=yo;for(Dr=1;g<j.length;g++){var M=j[g];do M=M(!0);while(M!==null)}yo=null,Mc=!1}catch(z){throw yo!==null&&(yo=yo.slice(g+1)),Wi(Ef,Ns),z}finally{Dr=x,Lc=!1}}return null}var qo=[],vo=0,Ju=null,Dl=0,ta=[],Ua=0,ns=null,_a=1,Ci="";function Ti(g,x){qo[vo++]=Dl,qo[vo++]=Ju,Ju=g,Dl=x}function tx(g,x,j){ta[Ua++]=_a,ta[Ua++]=Ci,ta[Ua++]=ns,ns=g;var M=_a;g=Ci;var z=32-Us(M)-1;M&=~(1<<z),j+=1;var ee=32-Us(x)+z;if(30<ee){var xe=z-z%5;ee=(M&(1<<xe)-1).toString(32),M>>=xe,z-=xe,_a=1<<32-Us(x)+z|j<<z|M,Ci=ee+g}else _a=1<<ee|j<<z|M,Ci=g}function Qu(g){g.return!==null&&(Ti(g,1),tx(g,1,0))}function Zu(g){for(;g===Ju;)Ju=qo[--vo],qo[vo]=null,Dl=qo[--vo],qo[vo]=null;for(;g===ns;)ns=ta[--Ua],ta[Ua]=null,Ci=ta[--Ua],ta[Ua]=null,_a=ta[--Ua],ta[Ua]=null}var As=null,ra=null,xn=!1,ed=!1,Ei=null;function rx(g,x){var j=Ya(5,null,null,0);j.elementType="DELETED",j.stateNode=x,j.return=g,x=g.deletions,x===null?(g.deletions=[j],g.flags|=16):x.push(j)}function Pf(g,x){switch(g.tag){case 5:return x=Nr(x,g.type,g.pendingProps),x!==null?(g.stateNode=x,As=g,ra=pe(x),!0):!1;case 6:return x=Mr(x,g.pendingProps),x!==null?(g.stateNode=x,As=g,ra=null,!0):!1;case 13:if(x=cr(x),x!==null){var j=ns!==null?{id:_a,overflow:Ci}:null;return g.memoizedState={dehydrated:x,treeContext:j,retryLane:1073741824},j=Ya(18,null,null,0),j.stateNode=x,j.return=g,g.child=j,As=g,ra=null,!0}return!1;default:return!1}}function D0(g){return(g.mode&1)!==0&&(g.flags&128)===0}function R0(g){if(xn){var x=ra;if(x){var j=x;if(!Pf(g,x)){if(D0(g))throw Error(i(418));x=be(j);var M=As;x&&Pf(g,x)?rx(M,j):(g.flags=g.flags&-4097|2,xn=!1,As=g)}}else{if(D0(g))throw Error(i(418));g.flags=g.flags&-4097|2,xn=!1,As=g}}}function nx(g){for(g=g.return;g!==null&&g.tag!==5&&g.tag!==3&&g.tag!==13;)g=g.return;As=g}function Df(g){if(!ye||g!==As)return!1;if(!xn)return nx(g),xn=!0,!1;if(g.tag!==3&&(g.tag!==5||Ae(g.type)&&!ie(g.type,g.memoizedProps))){var x=ra;if(x){if(D0(g))throw sx(),Error(i(418));for(;x;)rx(g,x),x=be(x)}}if(nx(g),g.tag===13){if(!ye)throw Error(i(316));if(g=g.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));ra=ne(g)}else ra=As?be(g.stateNode):null;return!0}function sx(){for(var g=ra;g;)g=be(g)}function Rl(){ye&&(ra=As=null,ed=xn=!1)}function I0(g){Ei===null?Ei=[g]:Ei.push(g)}var av=o.ReactCurrentBatchConfig;function Rf(g,x){if(ki(g,x))return!0;if(typeof g!="object"||g===null||typeof x!="object"||x===null)return!1;var j=Object.keys(g),M=Object.keys(x);if(j.length!==M.length)return!1;for(M=0;M<j.length;M++){var z=j[M];if(!Gr.call(x,z)||!ki(g[z],x[z]))return!1}return!0}function iv(g){switch(g.tag){case 5:return Bt(g.type);case 16:return Bt("Lazy");case 13:return Bt("Suspense");case 19:return Bt("SuspenseList");case 0:case 2:case 15:return g=rr(g.type,!1),g;case 11:return g=rr(g.type.render,!1),g;case 1:return g=rr(g.type,!0),g;default:return""}}function Il(g,x,j){if(g=j.ref,g!==null&&typeof g!="function"&&typeof g!="object"){if(j._owner){if(j=j._owner,j){if(j.tag!==1)throw Error(i(309));var M=j.stateNode}if(!M)throw Error(i(147,g));var z=M,ee=""+g;return x!==null&&x.ref!==null&&typeof x.ref=="function"&&x.ref._stringRef===ee?x.ref:(x=function(xe){var $e=z.refs;xe===null?delete $e[ee]:$e[ee]=xe},x._stringRef=ee,x)}if(typeof g!="string")throw Error(i(284));if(!j._owner)throw Error(i(290,g))}return g}function If(g,x){throw g=Object.prototype.toString.call(x),Error(i(31,g==="[object Object]"?"object with keys {"+Object.keys(x).join(", ")+"}":g))}function ax(g){var x=g._init;return x(g._payload)}function ix(g){function x(et,He){if(g){var ot=et.deletions;ot===null?(et.deletions=[He],et.flags|=16):ot.push(He)}}function j(et,He){if(!g)return null;for(;He!==null;)x(et,He),He=He.sibling;return null}function M(et,He){for(et=new Map;He!==null;)He.key!==null?et.set(He.key,He):et.set(He.index,He),He=He.sibling;return et}function z(et,He){return et=fl(et,He),et.index=0,et.sibling=null,et}function ee(et,He,ot){return et.index=ot,g?(ot=et.alternate,ot!==null?(ot=ot.index,ot<He?(et.flags|=2,He):ot):(et.flags|=2,He)):(et.flags|=1048576,He)}function xe(et){return g&&et.alternate===null&&(et.flags|=2),et}function $e(et,He,ot,Ht){return He===null||He.tag!==6?(He=lu(ot,et.mode,Ht),He.return=et,He):(He=z(He,ot),He.return=et,He)}function nt(et,He,ot,Ht){var ar=ot.type;return ar===f?Xt(et,He,ot.props.children,Ht,ot.key):He!==null&&(He.elementType===ar||typeof ar=="object"&&ar!==null&&ar.$$typeof===_&&ax(ar)===He.type)?(Ht=z(He,ot.props),Ht.ref=Il(et,He,ot),Ht.return=et,Ht):(Ht=hh(ot.type,ot.key,ot.props,null,et.mode,Ht),Ht.ref=Il(et,He,ot),Ht.return=et,Ht)}function Nt(et,He,ot,Ht){return He===null||He.tag!==4||He.stateNode.containerInfo!==ot.containerInfo||He.stateNode.implementation!==ot.implementation?(He=gh(ot,et.mode,Ht),He.return=et,He):(He=z(He,ot.children||[]),He.return=et,He)}function Xt(et,He,ot,Ht,ar){return He===null||He.tag!==7?(He=Ps(ot,et.mode,Ht,ar),He.return=et,He):(He=z(He,ot),He.return=et,He)}function pr(et,He,ot){if(typeof He=="string"&&He!==""||typeof He=="number")return He=lu(""+He,et.mode,ot),He.return=et,He;if(typeof He=="object"&&He!==null){switch(He.$$typeof){case c:return ot=hh(He.type,He.key,He.props,null,et.mode,ot),ot.ref=Il(et,null,He),ot.return=et,ot;case d:return He=gh(He,et.mode,ot),He.return=et,He;case _:var Ht=He._init;return pr(et,Ht(He._payload),ot)}if(Z(He)||A(He))return He=Ps(He,et.mode,ot,null),He.return=et,He;If(et,He)}return null}function Ut(et,He,ot,Ht){var ar=He!==null?He.key:null;if(typeof ot=="string"&&ot!==""||typeof ot=="number")return ar!==null?null:$e(et,He,""+ot,Ht);if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case c:return ot.key===ar?nt(et,He,ot,Ht):null;case d:return ot.key===ar?Nt(et,He,ot,Ht):null;case _:return ar=ot._init,Ut(et,He,ar(ot._payload),Ht)}if(Z(ot)||A(ot))return ar!==null?null:Xt(et,He,ot,Ht,null);If(et,ot)}return null}function gn(et,He,ot,Ht,ar){if(typeof Ht=="string"&&Ht!==""||typeof Ht=="number")return et=et.get(ot)||null,$e(He,et,""+Ht,ar);if(typeof Ht=="object"&&Ht!==null){switch(Ht.$$typeof){case c:return et=et.get(Ht.key===null?ot:Ht.key)||null,nt(He,et,Ht,ar);case d:return et=et.get(Ht.key===null?ot:Ht.key)||null,Nt(He,et,Ht,ar);case _:var br=Ht._init;return gn(et,He,ot,br(Ht._payload),ar)}if(Z(Ht)||A(Ht))return et=et.get(ot)||null,Xt(He,et,Ht,ar,null);If(He,Ht)}return null}function en(et,He,ot,Ht){for(var ar=null,br=null,xr=He,$r=He=0,ls=null;xr!==null&&$r<ot.length;$r++){xr.index>$r?(ls=xr,xr=null):ls=xr.sibling;var Or=Ut(et,xr,ot[$r],Ht);if(Or===null){xr===null&&(xr=ls);break}g&&xr&&Or.alternate===null&&x(et,xr),He=ee(Or,He,$r),br===null?ar=Or:br.sibling=Or,br=Or,xr=ls}if($r===ot.length)return j(et,xr),xn&&Ti(et,$r),ar;if(xr===null){for(;$r<ot.length;$r++)xr=pr(et,ot[$r],Ht),xr!==null&&(He=ee(xr,He,$r),br===null?ar=xr:br.sibling=xr,br=xr);return xn&&Ti(et,$r),ar}for(xr=M(et,xr);$r<ot.length;$r++)ls=gn(xr,et,$r,ot[$r],Ht),ls!==null&&(g&&ls.alternate!==null&&xr.delete(ls.key===null?$r:ls.key),He=ee(ls,He,$r),br===null?ar=ls:br.sibling=ls,br=ls);return g&&xr.forEach(function(Vs){return x(et,Vs)}),xn&&Ti(et,$r),ar}function la(et,He,ot,Ht){var ar=A(ot);if(typeof ar!="function")throw Error(i(150));if(ot=ar.call(ot),ot==null)throw Error(i(151));for(var br=ar=null,xr=He,$r=He=0,ls=null,Or=ot.next();xr!==null&&!Or.done;$r++,Or=ot.next()){xr.index>$r?(ls=xr,xr=null):ls=xr.sibling;var Vs=Ut(et,xr,Or.value,Ht);if(Vs===null){xr===null&&(xr=ls);break}g&&xr&&Vs.alternate===null&&x(et,xr),He=ee(Vs,He,$r),br===null?ar=Vs:br.sibling=Vs,br=Vs,xr=ls}if(Or.done)return j(et,xr),xn&&Ti(et,$r),ar;if(xr===null){for(;!Or.done;$r++,Or=ot.next())Or=pr(et,Or.value,Ht),Or!==null&&(He=ee(Or,He,$r),br===null?ar=Or:br.sibling=Or,br=Or);return xn&&Ti(et,$r),ar}for(xr=M(et,xr);!Or.done;$r++,Or=ot.next())Or=gn(xr,et,$r,Or.value,Ht),Or!==null&&(g&&Or.alternate!==null&&xr.delete(Or.key===null?$r:Or.key),He=ee(Or,He,$r),br===null?ar=Or:br.sibling=Or,br=Or);return g&&xr.forEach(function(dv){return x(et,dv)}),xn&&Ti(et,$r),ar}function Ji(et,He,ot,Ht){if(typeof ot=="object"&&ot!==null&&ot.type===f&&ot.key===null&&(ot=ot.props.children),typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case c:e:{for(var ar=ot.key,br=He;br!==null;){if(br.key===ar){if(ar=ot.type,ar===f){if(br.tag===7){j(et,br.sibling),He=z(br,ot.props.children),He.return=et,et=He;break e}}else if(br.elementType===ar||typeof ar=="object"&&ar!==null&&ar.$$typeof===_&&ax(ar)===br.type){j(et,br.sibling),He=z(br,ot.props),He.ref=Il(et,br,ot),He.return=et,et=He;break e}j(et,br);break}else x(et,br);br=br.sibling}ot.type===f?(He=Ps(ot.props.children,et.mode,Ht,ot.key),He.return=et,et=He):(Ht=hh(ot.type,ot.key,ot.props,null,et.mode,Ht),Ht.ref=Il(et,He,ot),Ht.return=et,et=Ht)}return xe(et);case d:e:{for(br=ot.key;He!==null;){if(He.key===br)if(He.tag===4&&He.stateNode.containerInfo===ot.containerInfo&&He.stateNode.implementation===ot.implementation){j(et,He.sibling),He=z(He,ot.children||[]),He.return=et,et=He;break e}else{j(et,He);break}else x(et,He);He=He.sibling}He=gh(ot,et.mode,Ht),He.return=et,et=He}return xe(et);case _:return br=ot._init,Ji(et,He,br(ot._payload),Ht)}if(Z(ot))return en(et,He,ot,Ht);if(A(ot))return la(et,He,ot,Ht);If(et,ot)}return typeof ot=="string"&&ot!==""||typeof ot=="number"?(ot=""+ot,He!==null&&He.tag===6?(j(et,He.sibling),He=z(He,ot),He.return=et,et=He):(j(et,He),He=lu(ot,et.mode,Ht),He.return=et,et=He),xe(et)):j(et,He)}return Ji}var Ml=ix(!0),ox=ix(!1),Mf=Tr(null),Lf=null,Oc=null,M0=null;function L0(){M0=Oc=Lf=null}function lx(g,x,j){ke?(he(Mf,x._currentValue),x._currentValue=j):(he(Mf,x._currentValue2),x._currentValue2=j)}function td(g){var x=Mf.current;Ur(Mf),ke?g._currentValue=x:g._currentValue2=x}function Ll(g,x,j){for(;g!==null;){var M=g.alternate;if((g.childLanes&x)!==x?(g.childLanes|=x,M!==null&&(M.childLanes|=x)):M!==null&&(M.childLanes&x)!==x&&(M.childLanes|=x),g===j)break;g=g.return}}function Bc(g,x){Lf=g,M0=Oc=null,g=g.dependencies,g!==null&&g.firstContext!==null&&((g.lanes&x)!==0&&(as=!0),g.firstContext=null)}function $a(g){var x=ke?g._currentValue:g._currentValue2;if(M0!==g)if(g={context:g,memoizedValue:x,next:null},Oc===null){if(Lf===null)throw Error(i(308));Oc=g,Lf.dependencies={lanes:0,firstContext:g}}else Oc=Oc.next=g;return x}var Xo=null;function Of(g){Xo===null?Xo=[g]:Xo.push(g)}function O0(g,x,j,M){var z=x.interleaved;return z===null?(j.next=j,Of(x)):(j.next=z.next,z.next=j),x.interleaved=j,Ni(g,M)}function Ni(g,x){g.lanes|=x;var j=g.alternate;for(j!==null&&(j.lanes|=x),j=g,g=g.return;g!==null;)g.childLanes|=x,j=g.alternate,j!==null&&(j.childLanes|=x),j=g,g=g.return;return j.tag===3?j.stateNode:null}var Wa=!1;function B0(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cx(g,x){g=g.updateQueue,x.updateQueue===g&&(x.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function wo(g,x){return{eventTime:g,lane:x,tag:0,payload:null,callback:null,next:null}}function _o(g,x,j){var M=g.updateQueue;if(M===null)return null;if(M=M.shared,(wr&2)!==0){var z=M.pending;return z===null?x.next=x:(x.next=z.next,z.next=x),M.pending=x,Ni(g,j)}return z=M.interleaved,z===null?(x.next=x,Of(M)):(x.next=z.next,z.next=x),M.interleaved=x,Ni(g,j)}function rd(g,x,j){if(x=x.updateQueue,x!==null&&(x=x.shared,(j&4194240)!==0)){var M=x.lanes;M&=g.pendingLanes,j|=M,x.lanes=j,$i(g,j)}}function Uc(g,x){var j=g.updateQueue,M=g.alternate;if(M!==null&&(M=M.updateQueue,j===M)){var z=null,ee=null;if(j=j.firstBaseUpdate,j!==null){do{var xe={eventTime:j.eventTime,lane:j.lane,tag:j.tag,payload:j.payload,callback:j.callback,next:null};ee===null?z=ee=xe:ee=ee.next=xe,j=j.next}while(j!==null);ee===null?z=ee=x:ee=ee.next=x}else z=ee=x;j={baseState:M.baseState,firstBaseUpdate:z,lastBaseUpdate:ee,shared:M.shared,effects:M.effects},g.updateQueue=j;return}g=j.lastBaseUpdate,g===null?j.firstBaseUpdate=x:g.next=x,j.lastBaseUpdate=x}function Yo(g,x,j,M){var z=g.updateQueue;Wa=!1;var ee=z.firstBaseUpdate,xe=z.lastBaseUpdate,$e=z.shared.pending;if($e!==null){z.shared.pending=null;var nt=$e,Nt=nt.next;nt.next=null,xe===null?ee=Nt:xe.next=Nt,xe=nt;var Xt=g.alternate;Xt!==null&&(Xt=Xt.updateQueue,$e=Xt.lastBaseUpdate,$e!==xe&&($e===null?Xt.firstBaseUpdate=Nt:$e.next=Nt,Xt.lastBaseUpdate=nt))}if(ee!==null){var pr=z.baseState;xe=0,Xt=Nt=nt=null,$e=ee;do{var Ut=$e.lane,gn=$e.eventTime;if((M&Ut)===Ut){Xt!==null&&(Xt=Xt.next={eventTime:gn,lane:0,tag:$e.tag,payload:$e.payload,callback:$e.callback,next:null});e:{var en=g,la=$e;switch(Ut=x,gn=j,la.tag){case 1:if(en=la.payload,typeof en=="function"){pr=en.call(gn,pr,Ut);break e}pr=en;break e;case 3:en.flags=en.flags&-65537|128;case 0:if(en=la.payload,Ut=typeof en=="function"?en.call(gn,pr,Ut):en,Ut==null)break e;pr=a({},pr,Ut);break e;case 2:Wa=!0}}$e.callback!==null&&$e.lane!==0&&(g.flags|=64,Ut=z.effects,Ut===null?z.effects=[$e]:Ut.push($e))}else gn={eventTime:gn,lane:Ut,tag:$e.tag,payload:$e.payload,callback:$e.callback,next:null},Xt===null?(Nt=Xt=gn,nt=pr):Xt=Xt.next=gn,xe|=Ut;if($e=$e.next,$e===null){if($e=z.shared.pending,$e===null)break;Ut=$e,$e=Ut.next,Ut.next=null,z.lastBaseUpdate=Ut,z.shared.pending=null}}while(!0);if(Xt===null&&(nt=pr),z.baseState=nt,z.firstBaseUpdate=Nt,z.lastBaseUpdate=Xt,x=z.shared.interleaved,x!==null){z=x;do xe|=z.lane,z=z.next;while(z!==x)}else ee===null&&(z.shared.lanes=0);To|=xe,g.lanes=xe,g.memoizedState=pr}}function ux(g,x,j){if(g=x.effects,x.effects=null,g!==null)for(x=0;x<g.length;x++){var M=g[x],z=M.callback;if(z!==null){if(M.callback=null,M=j,typeof z!="function")throw Error(i(191,z));z.call(M)}}}var Jo={},oi=Tr(Jo),$c=Tr(Jo),Qo=Tr(Jo);function li(g){if(g===Jo)throw Error(i(174));return g}function Bf(g,x){he(Qo,x),he($c,g),he(oi,Jo),g=I(x),Ur(oi),he(oi,g)}function Ol(){Ur(oi),Ur($c),Ur(Qo)}function U0(g){var x=li(Qo.current),j=li(oi.current);x=W(j,g.type,x),j!==x&&(he($c,g),he(oi,x))}function $0(g){$c.current===g&&(Ur(oi),Ur($c))}var Tn=Tr(0);function Uf(g){for(var x=g;x!==null;){if(x.tag===13){var j=x.memoizedState;if(j!==null&&(j=j.dehydrated,j===null||Fr(j)||Pr(j)))return x}else if(x.tag===19&&x.memoizedProps.revealOrder!==void 0){if((x.flags&128)!==0)return x}else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===g)break;for(;x.sibling===null;){if(x.return===null||x.return===g)return null;x=x.return}x.sibling.return=x.return,x=x.sibling}return null}var W0=[];function z0(){for(var g=0;g<W0.length;g++){var x=W0[g];ke?x._workInProgressVersionPrimary=null:x._workInProgressVersionSecondary=null}W0.length=0}var ba=o.ReactCurrentDispatcher,Bl=o.ReactCurrentBatchConfig,Zo=0,wn=null,Vn=null,ss=null,Wc=!1,nd=!1,sd=0,zc=0;function xs(){throw Error(i(321))}function Ul(g,x){if(x===null)return!1;for(var j=0;j<x.length&&j<g.length;j++)if(!ki(g[j],x[j]))return!1;return!0}function ad(g,x,j,M,z,ee){if(Zo=ee,wn=x,x.memoizedState=null,x.updateQueue=null,x.lanes=0,ba.current=g===null||g.memoizedState===null?Z0:eg,g=j(M,z),nd){ee=0;do{if(nd=!1,sd=0,25<=ee)throw Error(i(301));ee+=1,ss=Vn=null,x.updateQueue=null,ba.current=tg,g=j(M,z)}while(nd)}if(ba.current=Gl,x=Vn!==null&&Vn.next!==null,Zo=0,ss=Vn=wn=null,Wc=!1,x)throw Error(i(300));return g}function $f(){var g=sd!==0;return sd=0,g}function za(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ss===null?wn.memoizedState=ss=g:ss=ss.next=g,ss}function js(){if(Vn===null){var g=wn.alternate;g=g!==null?g.memoizedState:null}else g=Vn.next;var x=ss===null?wn.memoizedState:ss.next;if(x!==null)ss=x,Vn=g;else{if(g===null)throw Error(i(310));Vn=g,g={memoizedState:Vn.memoizedState,baseState:Vn.baseState,baseQueue:Vn.baseQueue,queue:Vn.queue,next:null},ss===null?wn.memoizedState=ss=g:ss=ss.next=g}return ss}function $l(g,x){return typeof x=="function"?x(g):x}function Wf(g){var x=js(),j=x.queue;if(j===null)throw Error(i(311));j.lastRenderedReducer=g;var M=Vn,z=M.baseQueue,ee=j.pending;if(ee!==null){if(z!==null){var xe=z.next;z.next=ee.next,ee.next=xe}M.baseQueue=z=ee,j.pending=null}if(z!==null){ee=z.next,M=M.baseState;var $e=xe=null,nt=null,Nt=ee;do{var Xt=Nt.lane;if((Zo&Xt)===Xt)nt!==null&&(nt=nt.next={lane:0,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null}),M=Nt.hasEagerState?Nt.eagerState:g(M,Nt.action);else{var pr={lane:Xt,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null};nt===null?($e=nt=pr,xe=M):nt=nt.next=pr,wn.lanes|=Xt,To|=Xt}Nt=Nt.next}while(Nt!==null&&Nt!==ee);nt===null?xe=M:nt.next=$e,ki(M,x.memoizedState)||(as=!0),x.memoizedState=M,x.baseState=xe,x.baseQueue=nt,j.lastRenderedState=M}if(g=j.interleaved,g!==null){z=g;do ee=z.lane,wn.lanes|=ee,To|=ee,z=z.next;while(z!==g)}else z===null&&(j.lanes=0);return[x.memoizedState,j.dispatch]}function Hc(g){var x=js(),j=x.queue;if(j===null)throw Error(i(311));j.lastRenderedReducer=g;var M=j.dispatch,z=j.pending,ee=x.memoizedState;if(z!==null){j.pending=null;var xe=z=z.next;do ee=g(ee,xe.action),xe=xe.next;while(xe!==z);ki(ee,x.memoizedState)||(as=!0),x.memoizedState=ee,x.baseQueue===null&&(x.baseState=ee),j.lastRenderedState=ee}return[ee,M]}function H0(){}function G0(g,x){var j=wn,M=js(),z=x(),ee=!ki(M.memoizedState,z);if(ee&&(M.memoizedState=z,as=!0),M=M.queue,Gf(q0.bind(null,j,M,g),[g]),M.getSnapshot!==x||ee||ss!==null&&ss.memoizedState.tag&1){if(j.flags|=2048,Wl(9,K0.bind(null,j,M,z,x),void 0,null),sn===null)throw Error(i(349));(Zo&30)!==0||V0(j,x,z)}return z}function V0(g,x,j){g.flags|=16384,g={getSnapshot:x,value:j},x=wn.updateQueue,x===null?(x={lastEffect:null,stores:null},wn.updateQueue=x,x.stores=[g]):(j=x.stores,j===null?x.stores=[g]:j.push(g))}function K0(g,x,j,M){x.value=j,x.getSnapshot=M,X0(x)&&bo(g)}function q0(g,x,j){return j(function(){X0(x)&&bo(g)})}function X0(g){var x=g.getSnapshot;g=g.value;try{var j=x();return!ki(g,j)}catch{return!0}}function bo(g){var x=Ni(g,1);x!==null&&Hs(x,g,1,-1)}function zf(g){var x=za();return typeof g=="function"&&(g=g()),x.memoizedState=x.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$l,lastRenderedState:g},x.queue=g,g=g.dispatch=ov.bind(null,wn,g),[x.memoizedState,g]}function Wl(g,x,j,M){return g={tag:g,create:x,destroy:j,deps:M,next:null},x=wn.updateQueue,x===null?(x={lastEffect:null,stores:null},wn.updateQueue=x,x.lastEffect=g.next=g):(j=x.lastEffect,j===null?x.lastEffect=g.next=g:(M=j.next,j.next=g,g.next=M,x.lastEffect=g)),g}function dx(){return js().memoizedState}function Hf(g,x,j,M){var z=za();wn.flags|=g,z.memoizedState=Wl(1|x,j,void 0,M===void 0?null:M)}function el(g,x,j,M){var z=js();M=M===void 0?null:M;var ee=void 0;if(Vn!==null){var xe=Vn.memoizedState;if(ee=xe.destroy,M!==null&&Ul(M,xe.deps)){z.memoizedState=Wl(x,j,ee,M);return}}wn.flags|=g,z.memoizedState=Wl(1|x,j,ee,M)}function fx(g,x){return Hf(8390656,8,g,x)}function Gf(g,x){return el(2048,8,g,x)}function Y0(g,x){return el(4,2,g,x)}function dn(g,x){return el(4,4,g,x)}function Vf(g,x){if(typeof x=="function")return g=g(),x(g),function(){x(null)};if(x!=null)return g=g(),x.current=g,function(){x.current=null}}function id(g,x,j){return j=j!=null?j.concat([g]):null,el(4,4,Vf.bind(null,x,g),j)}function zl(){}function J0(g,x){var j=js();x=x===void 0?null:x;var M=j.memoizedState;return M!==null&&x!==null&&Ul(x,M[1])?M[0]:(j.memoizedState=[g,x],g)}function Kf(g,x){var j=js();x=x===void 0?null:x;var M=j.memoizedState;return M!==null&&x!==null&&Ul(x,M[1])?M[0]:(g=g(),j.memoizedState=[g,x],g)}function Gc(g,x,j){return(Zo&21)===0?(g.baseState&&(g.baseState=!1,as=!0),g.memoizedState=j):(ki(j,x)||(j=Tf(),wn.lanes|=j,To|=j,g.baseState=!0),x)}function qf(g,x){var j=Dr;Dr=j!==0&&4>j?j:4,g(!0);var M=Bl.transition;Bl.transition={};try{g(!1),x()}finally{Dr=j,Bl.transition=M}}function Hl(){return js().memoizedState}function hx(g,x,j){var M=os(g);if(j={lane:M,action:j,hasEagerState:!1,eagerState:null,next:null},gx(g))Q0(x,j);else if(j=O0(g,x,j,M),j!==null){var z=yn();Hs(j,g,M,z),od(j,x,M)}}function ov(g,x,j){var M=os(g),z={lane:M,action:j,hasEagerState:!1,eagerState:null,next:null};if(gx(g))Q0(x,z);else{var ee=g.alternate;if(g.lanes===0&&(ee===null||ee.lanes===0)&&(ee=x.lastRenderedReducer,ee!==null))try{var xe=x.lastRenderedState,$e=ee(xe,j);if(z.hasEagerState=!0,z.eagerState=$e,ki($e,xe)){var nt=x.interleaved;nt===null?(z.next=z,Of(x)):(z.next=nt.next,nt.next=z),x.interleaved=z;return}}catch{}finally{}j=O0(g,x,z,M),j!==null&&(z=yn(),Hs(j,g,M,z),od(j,x,M))}}function gx(g){var x=g.alternate;return g===wn||x!==null&&x===wn}function Q0(g,x){nd=Wc=!0;var j=g.pending;j===null?x.next=x:(x.next=j.next,j.next=x),g.pending=x}function od(g,x,j){if((j&4194240)!==0){var M=x.lanes;M&=g.pendingLanes,j|=M,x.lanes=j,$i(g,j)}}var Gl={readContext:$a,useCallback:xs,useContext:xs,useEffect:xs,useImperativeHandle:xs,useInsertionEffect:xs,useLayoutEffect:xs,useMemo:xs,useReducer:xs,useRef:xs,useState:xs,useDebugValue:xs,useDeferredValue:xs,useTransition:xs,useMutableSource:xs,useSyncExternalStore:xs,useId:xs,unstable_isNewReconciler:!1},Z0={readContext:$a,useCallback:function(g,x){return za().memoizedState=[g,x===void 0?null:x],g},useContext:$a,useEffect:fx,useImperativeHandle:function(g,x,j){return j=j!=null?j.concat([g]):null,Hf(4194308,4,Vf.bind(null,x,g),j)},useLayoutEffect:function(g,x){return Hf(4194308,4,g,x)},useInsertionEffect:function(g,x){return Hf(4,2,g,x)},useMemo:function(g,x){var j=za();return x=x===void 0?null:x,g=g(),j.memoizedState=[g,x],g},useReducer:function(g,x,j){var M=za();return x=j!==void 0?j(x):x,M.memoizedState=M.baseState=x,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:x},M.queue=g,g=g.dispatch=hx.bind(null,wn,g),[M.memoizedState,g]},useRef:function(g){var x=za();return g={current:g},x.memoizedState=g},useState:zf,useDebugValue:zl,useDeferredValue:function(g){return za().memoizedState=g},useTransition:function(){var g=zf(!1),x=g[0];return g=qf.bind(null,g[1]),za().memoizedState=g,[x,g]},useMutableSource:function(){},useSyncExternalStore:function(g,x,j){var M=wn,z=za();if(xn){if(j===void 0)throw Error(i(407));j=j()}else{if(j=x(),sn===null)throw Error(i(349));(Zo&30)!==0||V0(M,x,j)}z.memoizedState=j;var ee={value:j,getSnapshot:x};return z.queue=ee,fx(q0.bind(null,M,ee,g),[g]),M.flags|=2048,Wl(9,K0.bind(null,M,ee,j,x),void 0,null),j},useId:function(){var g=za(),x=sn.identifierPrefix;if(xn){var j=Ci,M=_a;j=(M&~(1<<32-Us(M)-1)).toString(32)+j,x=":"+x+"R"+j,j=sd++,0<j&&(x+="H"+j.toString(32)),x+=":"}else j=zc++,x=":"+x+"r"+j.toString(32)+":";return g.memoizedState=x},unstable_isNewReconciler:!1},eg={readContext:$a,useCallback:J0,useContext:$a,useEffect:Gf,useImperativeHandle:id,useInsertionEffect:Y0,useLayoutEffect:dn,useMemo:Kf,useReducer:Wf,useRef:dx,useState:function(){return Wf($l)},useDebugValue:zl,useDeferredValue:function(g){var x=js();return Gc(x,Vn.memoizedState,g)},useTransition:function(){var g=Wf($l)[0],x=js().memoizedState;return[g,x]},useMutableSource:H0,useSyncExternalStore:G0,useId:Hl,unstable_isNewReconciler:!1},tg={readContext:$a,useCallback:J0,useContext:$a,useEffect:Gf,useImperativeHandle:id,useInsertionEffect:Y0,useLayoutEffect:dn,useMemo:Kf,useReducer:Hc,useRef:dx,useState:function(){return Hc($l)},useDebugValue:zl,useDeferredValue:function(g){var x=js();return Vn===null?x.memoizedState=g:Gc(x,Vn.memoizedState,g)},useTransition:function(){var g=Hc($l)[0],x=js().memoizedState;return[g,x]},useMutableSource:H0,useSyncExternalStore:G0,useId:Hl,unstable_isNewReconciler:!1};function Ha(g,x){if(g&&g.defaultProps){x=a({},x),g=g.defaultProps;for(var j in g)x[j]===void 0&&(x[j]=g[j]);return x}return x}function rg(g,x,j,M){x=g.memoizedState,j=j(M,x),j=j==null?x:a({},x,j),g.memoizedState=j,g.lanes===0&&(g.updateQueue.baseState=j)}var ld={isMounted:function(g){return(g=g._reactInternals)?D(g)===g:!1},enqueueSetState:function(g,x,j){g=g._reactInternals;var M=yn(),z=os(g),ee=wo(M,z);ee.payload=x,j!=null&&(ee.callback=j),x=_o(g,ee,z),x!==null&&(Hs(x,g,z,M),rd(x,g,z))},enqueueReplaceState:function(g,x,j){g=g._reactInternals;var M=yn(),z=os(g),ee=wo(M,z);ee.tag=1,ee.payload=x,j!=null&&(ee.callback=j),x=_o(g,ee,z),x!==null&&(Hs(x,g,z,M),rd(x,g,z))},enqueueForceUpdate:function(g,x){g=g._reactInternals;var j=yn(),M=os(g),z=wo(j,M);z.tag=2,x!=null&&(z.callback=x),x=_o(g,z,M),x!==null&&(Hs(x,g,M,j),rd(x,g,M))}};function mx(g,x,j,M,z,ee,xe){return g=g.stateNode,typeof g.shouldComponentUpdate=="function"?g.shouldComponentUpdate(M,ee,xe):x.prototype&&x.prototype.isPureReactComponent?!Rf(j,M)||!Rf(z,ee):!0}function px(g,x,j){var M=!1,z=Se,ee=x.contextType;return typeof ee=="object"&&ee!==null?ee=$a(ee):(z=vr(x)?zt:Ze.current,M=x.contextTypes,ee=(M=M!=null)?Er(g,z):Se),x=new x(j,ee),g.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=ld,g.stateNode=x,x._reactInternals=g,M&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=z,g.__reactInternalMemoizedMaskedChildContext=ee),x}function Xf(g,x,j,M){g=x.state,typeof x.componentWillReceiveProps=="function"&&x.componentWillReceiveProps(j,M),typeof x.UNSAFE_componentWillReceiveProps=="function"&&x.UNSAFE_componentWillReceiveProps(j,M),x.state!==g&&ld.enqueueReplaceState(x,x.state,null)}function zi(g,x,j,M){var z=g.stateNode;z.props=j,z.state=g.memoizedState,z.refs={},B0(g);var ee=x.contextType;typeof ee=="object"&&ee!==null?z.context=$a(ee):(ee=vr(x)?zt:Ze.current,z.context=Er(g,ee)),z.state=g.memoizedState,ee=x.getDerivedStateFromProps,typeof ee=="function"&&(rg(g,x,ee,j),z.state=g.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(x=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),x!==z.state&&ld.enqueueReplaceState(z,z.state,null),Yo(g,j,z,M),z.state=g.memoizedState),typeof z.componentDidMount=="function"&&(g.flags|=4194308)}function Vl(g,x){try{var j="",M=x;do j+=iv(M),M=M.return;while(M);var z=j}catch(ee){z=`
Error generating stack: `+ee.message+`
`+ee.stack}return{value:g,source:x,stack:z,digest:null}}function tl(g,x,j){return{value:g,source:null,stack:j??null,digest:x??null}}function ci(g,x){try{console.error(x.value)}catch(j){setTimeout(function(){throw j})}}var cd=typeof WeakMap=="function"?WeakMap:Map;function Hi(g,x,j){j=wo(-1,j),j.tag=3,j.payload={element:null};var M=x.value;return j.callback=function(){In||(In=!0,Kn=M),ci(g,x)},j}function Yf(g,x,j){j=wo(-1,j),j.tag=3;var M=g.type.getDerivedStateFromError;if(typeof M=="function"){var z=x.value;j.payload=function(){return M(z)},j.callback=function(){ci(g,x)}}var ee=g.stateNode;return ee!==null&&typeof ee.componentDidCatch=="function"&&(j.callback=function(){ci(g,x),typeof M!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var xe=x.stack;this.componentDidCatch(x.value,{componentStack:xe!==null?xe:""})}),j}function xx(g,x,j){var M=g.pingCache;if(M===null){M=g.pingCache=new cd;var z=new Set;M.set(x,z)}else z=M.get(x),z===void 0&&(z=new Set,M.set(x,z));z.has(j)||(z.add(j),g=Cx.bind(null,g,x,j),x.then(g,g))}function yx(g){do{var x;if((x=g.tag===13)&&(x=g.memoizedState,x=x!==null?x.dehydrated!==null:!0),x)return g;g=g.return}while(g!==null);return null}function rl(g,x,j,M,z){return(g.mode&1)===0?(g===x?g.flags|=65536:(g.flags|=128,j.flags|=131072,j.flags&=-52805,j.tag===1&&(j.alternate===null?j.tag=17:(x=wo(-1,1),x.tag=2,_o(j,x,1))),j.lanes|=1),g):(g.flags|=65536,g.lanes=z,g)}var ud=o.ReactCurrentOwner,as=!1;function ys(g,x,j,M){x.child=g===null?ox(x,null,j,M):Ml(x,g.child,j,M)}function Jf(g,x,j,M,z){j=j.render;var ee=x.ref;return Bc(x,z),M=ad(g,x,j,M,ee,z),j=$f(),g!==null&&!as?(x.updateQueue=g.updateQueue,x.flags&=-2053,g.lanes&=~z,ko(g,x,z)):(xn&&j&&Qu(x),x.flags|=1,ys(g,x,M,z),x.child)}function Kl(g,x,j,M,z){if(g===null){var ee=j.type;return typeof ee=="function"&&!iu(ee)&&ee.defaultProps===void 0&&j.compare===null&&j.defaultProps===void 0?(x.tag=15,x.type=ee,So(g,x,ee,M,z)):(g=hh(j.type,null,M,x,x.mode,z),g.ref=x.ref,g.return=x,x.child=g)}if(ee=g.child,(g.lanes&z)===0){var xe=ee.memoizedProps;if(j=j.compare,j=j!==null?j:Rf,j(xe,M)&&g.ref===x.ref)return ko(g,x,z)}return x.flags|=1,g=fl(ee,M),g.ref=x.ref,g.return=x,x.child=g}function So(g,x,j,M,z){if(g!==null){var ee=g.memoizedProps;if(Rf(ee,M)&&g.ref===x.ref)if(as=!1,x.pendingProps=M=ee,(g.lanes&z)!==0)(g.flags&131072)!==0&&(as=!0);else return x.lanes=g.lanes,ko(g,x,z)}return Gi(g,x,j,M,z)}function fn(g,x,j){var M=x.pendingProps,z=M.children,ee=g!==null?g.memoizedState:null;if(M.mode==="hidden")if((x.mode&1)===0)x.memoizedState={baseLanes:0,cachePool:null,transitions:null},he(ll,is),is|=j;else{if((j&1073741824)===0)return g=ee!==null?ee.baseLanes|j:j,x.lanes=x.childLanes=1073741824,x.memoizedState={baseLanes:g,cachePool:null,transitions:null},x.updateQueue=null,he(ll,is),is|=g,null;x.memoizedState={baseLanes:0,cachePool:null,transitions:null},M=ee!==null?ee.baseLanes:j,he(ll,is),is|=M}else ee!==null?(M=ee.baseLanes|j,x.memoizedState=null):M=j,he(ll,is),is|=M;return ys(g,x,z,j),x.child}function nn(g,x){var j=x.ref;(g===null&&j!==null||g!==null&&g.ref!==j)&&(x.flags|=512,x.flags|=2097152)}function Gi(g,x,j,M,z){var ee=vr(j)?zt:Ze.current;return ee=Er(x,ee),Bc(x,z),j=ad(g,x,j,M,ee,z),M=$f(),g!==null&&!as?(x.updateQueue=g.updateQueue,x.flags&=-2053,g.lanes&=~z,ko(g,x,z)):(xn&&M&&Qu(x),x.flags|=1,ys(g,x,j,z),x.child)}function Fs(g,x,j,M,z){if(vr(j)){var ee=!0;Bs(x)}else ee=!1;if(Bc(x,z),x.stateNode===null)dd(g,x),px(x,j,M),zi(x,j,M,z),M=!0;else if(g===null){var xe=x.stateNode,$e=x.memoizedProps;xe.props=$e;var nt=xe.context,Nt=j.contextType;typeof Nt=="object"&&Nt!==null?Nt=$a(Nt):(Nt=vr(j)?zt:Ze.current,Nt=Er(x,Nt));var Xt=j.getDerivedStateFromProps,pr=typeof Xt=="function"||typeof xe.getSnapshotBeforeUpdate=="function";pr||typeof xe.UNSAFE_componentWillReceiveProps!="function"&&typeof xe.componentWillReceiveProps!="function"||($e!==M||nt!==Nt)&&Xf(x,xe,M,Nt),Wa=!1;var Ut=x.memoizedState;xe.state=Ut,Yo(x,M,xe,z),nt=x.memoizedState,$e!==M||Ut!==nt||st.current||Wa?(typeof Xt=="function"&&(rg(x,j,Xt,M),nt=x.memoizedState),($e=Wa||mx(x,j,$e,M,Ut,nt,Nt))?(pr||typeof xe.UNSAFE_componentWillMount!="function"&&typeof xe.componentWillMount!="function"||(typeof xe.componentWillMount=="function"&&xe.componentWillMount(),typeof xe.UNSAFE_componentWillMount=="function"&&xe.UNSAFE_componentWillMount()),typeof xe.componentDidMount=="function"&&(x.flags|=4194308)):(typeof xe.componentDidMount=="function"&&(x.flags|=4194308),x.memoizedProps=M,x.memoizedState=nt),xe.props=M,xe.state=nt,xe.context=Nt,M=$e):(typeof xe.componentDidMount=="function"&&(x.flags|=4194308),M=!1)}else{xe=x.stateNode,cx(g,x),$e=x.memoizedProps,Nt=x.type===x.elementType?$e:Ha(x.type,$e),xe.props=Nt,pr=x.pendingProps,Ut=xe.context,nt=j.contextType,typeof nt=="object"&&nt!==null?nt=$a(nt):(nt=vr(j)?zt:Ze.current,nt=Er(x,nt));var gn=j.getDerivedStateFromProps;(Xt=typeof gn=="function"||typeof xe.getSnapshotBeforeUpdate=="function")||typeof xe.UNSAFE_componentWillReceiveProps!="function"&&typeof xe.componentWillReceiveProps!="function"||($e!==pr||Ut!==nt)&&Xf(x,xe,M,nt),Wa=!1,Ut=x.memoizedState,xe.state=Ut,Yo(x,M,xe,z);var en=x.memoizedState;$e!==pr||Ut!==en||st.current||Wa?(typeof gn=="function"&&(rg(x,j,gn,M),en=x.memoizedState),(Nt=Wa||mx(x,j,Nt,M,Ut,en,nt)||!1)?(Xt||typeof xe.UNSAFE_componentWillUpdate!="function"&&typeof xe.componentWillUpdate!="function"||(typeof xe.componentWillUpdate=="function"&&xe.componentWillUpdate(M,en,nt),typeof xe.UNSAFE_componentWillUpdate=="function"&&xe.UNSAFE_componentWillUpdate(M,en,nt)),typeof xe.componentDidUpdate=="function"&&(x.flags|=4),typeof xe.getSnapshotBeforeUpdate=="function"&&(x.flags|=1024)):(typeof xe.componentDidUpdate!="function"||$e===g.memoizedProps&&Ut===g.memoizedState||(x.flags|=4),typeof xe.getSnapshotBeforeUpdate!="function"||$e===g.memoizedProps&&Ut===g.memoizedState||(x.flags|=1024),x.memoizedProps=M,x.memoizedState=en),xe.props=M,xe.state=en,xe.context=nt,M=Nt):(typeof xe.componentDidUpdate!="function"||$e===g.memoizedProps&&Ut===g.memoizedState||(x.flags|=4),typeof xe.getSnapshotBeforeUpdate!="function"||$e===g.memoizedProps&&Ut===g.memoizedState||(x.flags|=1024),M=!1)}return $s(g,x,j,M,ee,z)}function $s(g,x,j,M,z,ee){nn(g,x);var xe=(x.flags&128)!==0;if(!M&&!xe)return z&&Dn(x,j,!1),ko(g,x,ee);M=x.stateNode,ud.current=x;var $e=xe&&typeof j.getDerivedStateFromError!="function"?null:M.render();return x.flags|=1,g!==null&&xe?(x.child=Ml(x,g.child,null,ee),x.child=Ml(x,null,$e,ee)):ys(g,x,$e,ee),x.memoizedState=M.state,z&&Dn(x,j,!0),x.child}function nl(g){var x=g.stateNode;x.pendingContext?Ui(g,x.pendingContext,x.pendingContext!==x.context):x.context&&Ui(g,x.context,!1),Bf(g,x.containerInfo)}function ql(g,x,j,M,z){return Rl(),I0(z),x.flags|=256,ys(g,x,j,M),x.child}var Ws={dehydrated:null,treeContext:null,retryLane:0};function Vc(g){return{baseLanes:g,cachePool:null,transitions:null}}function ng(g,x,j){var M=x.pendingProps,z=Tn.current,ee=!1,xe=(x.flags&128)!==0,$e;if(($e=xe)||($e=g!==null&&g.memoizedState===null?!1:(z&2)!==0),$e?(ee=!0,x.flags&=-129):(g===null||g.memoizedState!==null)&&(z|=1),he(Tn,z&1),g===null)return R0(x),g=x.memoizedState,g!==null&&(g=g.dehydrated,g!==null)?((x.mode&1)===0?x.lanes=1:Pr(g)?x.lanes=8:x.lanes=1073741824,null):(xe=M.children,g=M.fallback,ee?(M=x.mode,ee=x.child,xe={mode:"hidden",children:xe},(M&1)===0&&ee!==null?(ee.childLanes=0,ee.pendingProps=xe):ee=ou(xe,M,0,null),g=Ps(g,M,j,null),ee.return=x,g.return=x,ee.sibling=g,x.child=ee,x.child.memoizedState=Vc(j),x.memoizedState=Ws,g):Qf(x,xe));if(z=g.memoizedState,z!==null&&($e=z.dehydrated,$e!==null))return vx(g,x,xe,M,$e,z,j);if(ee){ee=M.fallback,xe=x.mode,z=g.child,$e=z.sibling;var nt={mode:"hidden",children:M.children};return(xe&1)===0&&x.child!==z?(M=x.child,M.childLanes=0,M.pendingProps=nt,x.deletions=null):(M=fl(z,nt),M.subtreeFlags=z.subtreeFlags&14680064),$e!==null?ee=fl($e,ee):(ee=Ps(ee,xe,j,null),ee.flags|=2),ee.return=x,M.return=x,M.sibling=ee,x.child=M,M=ee,ee=x.child,xe=g.child.memoizedState,xe=xe===null?Vc(j):{baseLanes:xe.baseLanes|j,cachePool:null,transitions:xe.transitions},ee.memoizedState=xe,ee.childLanes=g.childLanes&~j,x.memoizedState=Ws,M}return ee=g.child,g=ee.sibling,M=fl(ee,{mode:"visible",children:M.children}),(x.mode&1)===0&&(M.lanes=j),M.return=x,M.sibling=null,g!==null&&(j=x.deletions,j===null?(x.deletions=[g],x.flags|=16):j.push(g)),x.child=M,x.memoizedState=null,M}function Qf(g,x){return x=ou({mode:"visible",children:x},g.mode,0,null),x.return=g,g.child=x}function Xl(g,x,j,M){return M!==null&&I0(M),Ml(x,g.child,null,j),g=Qf(x,x.pendingProps.children),g.flags|=2,x.memoizedState=null,g}function vx(g,x,j,M,z,ee,xe){if(j)return x.flags&256?(x.flags&=-257,M=tl(Error(i(422))),Xl(g,x,xe,M)):x.memoizedState!==null?(x.child=g.child,x.flags|=128,null):(ee=M.fallback,z=x.mode,M=ou({mode:"visible",children:M.children},z,0,null),ee=Ps(ee,z,xe,null),ee.flags|=2,M.return=x,ee.return=x,M.sibling=ee,x.child=M,(x.mode&1)!==0&&Ml(x,g.child,null,xe),x.child.memoizedState=Vc(xe),x.memoizedState=Ws,ee);if((x.mode&1)===0)return Xl(g,x,xe,null);if(Pr(z))return M=Cn(z).digest,ee=Error(i(419)),M=tl(ee,M,void 0),Xl(g,x,xe,M);if(j=(xe&g.childLanes)!==0,as||j){if(M=sn,M!==null){switch(xe&-xe){case 4:z=2;break;case 16:z=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:z=32;break;case 536870912:z=268435456;break;default:z=0}z=(z&(M.suspendedLanes|xe))!==0?0:z,z!==0&&z!==ee.retryLane&&(ee.retryLane=z,Ni(g,z),Hs(M,g,z,-1))}return au(),M=tl(Error(i(421))),Xl(g,x,xe,M)}return Fr(z)?(x.flags|=128,x.child=g.child,x=Ex.bind(null,g),ce(z,x),null):(g=ee.treeContext,ye&&(ra=Ce(z),As=x,xn=!0,Ei=null,ed=!1,g!==null&&(ta[Ua++]=_a,ta[Ua++]=Ci,ta[Ua++]=ns,_a=g.id,Ci=g.overflow,ns=x)),x=Qf(x,M.children),x.flags|=4096,x)}function Vi(g,x,j){g.lanes|=x;var M=g.alternate;M!==null&&(M.lanes|=x),Ll(g.return,x,j)}function Kc(g,x,j,M,z){var ee=g.memoizedState;ee===null?g.memoizedState={isBackwards:x,rendering:null,renderingStartTime:0,last:M,tail:j,tailMode:z}:(ee.isBackwards=x,ee.rendering=null,ee.renderingStartTime=0,ee.last=M,ee.tail=j,ee.tailMode=z)}function Zf(g,x,j){var M=x.pendingProps,z=M.revealOrder,ee=M.tail;if(ys(g,x,M.children,j),M=Tn.current,(M&2)!==0)M=M&1|2,x.flags|=128;else{if(g!==null&&(g.flags&128)!==0)e:for(g=x.child;g!==null;){if(g.tag===13)g.memoizedState!==null&&Vi(g,j,x);else if(g.tag===19)Vi(g,j,x);else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===x)break e;for(;g.sibling===null;){if(g.return===null||g.return===x)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}M&=1}if(he(Tn,M),(x.mode&1)===0)x.memoizedState=null;else switch(z){case"forwards":for(j=x.child,z=null;j!==null;)g=j.alternate,g!==null&&Uf(g)===null&&(z=j),j=j.sibling;j=z,j===null?(z=x.child,x.child=null):(z=j.sibling,j.sibling=null),Kc(x,!1,z,j,ee);break;case"backwards":for(j=null,z=x.child,x.child=null;z!==null;){if(g=z.alternate,g!==null&&Uf(g)===null){x.child=z;break}g=z.sibling,z.sibling=j,j=z,z=g}Kc(x,!0,j,null,ee);break;case"together":Kc(x,!1,null,null,void 0);break;default:x.memoizedState=null}return x.child}function dd(g,x){(x.mode&1)===0&&g!==null&&(g.alternate=null,x.alternate=null,x.flags|=2)}function ko(g,x,j){if(g!==null&&(x.dependencies=g.dependencies),To|=x.lanes,(j&x.childLanes)===0)return null;if(g!==null&&x.child!==g.child)throw Error(i(153));if(x.child!==null){for(g=x.child,j=fl(g,g.pendingProps),x.child=j,j.return=x;g.sibling!==null;)g=g.sibling,j=j.sibling=fl(g,g.pendingProps),j.return=x;j.sibling=null}return x.child}function sl(g,x,j){switch(x.tag){case 3:nl(x),Rl();break;case 5:U0(x);break;case 1:vr(x.type)&&Bs(x);break;case 4:Bf(x,x.stateNode.containerInfo);break;case 10:lx(x,x.type._context,x.memoizedProps.value);break;case 13:var M=x.memoizedState;if(M!==null)return M.dehydrated!==null?(he(Tn,Tn.current&1),x.flags|=128,null):(j&x.child.childLanes)!==0?ng(g,x,j):(he(Tn,Tn.current&1),g=ko(g,x,j),g!==null?g.sibling:null);he(Tn,Tn.current&1);break;case 19:if(M=(j&x.childLanes)!==0,(g.flags&128)!==0){if(M)return Zf(g,x,j);x.flags|=128}var z=x.memoizedState;if(z!==null&&(z.rendering=null,z.tail=null,z.lastEffect=null),he(Tn,Tn.current),M)break;return null;case 22:case 23:return x.lanes=0,fn(g,x,j)}return ko(g,x,j)}function na(g){g.flags|=4}function Yl(g,x){if(g!==null&&g.child===x.child)return!0;if((x.flags&16)!==0)return!1;for(g=x.child;g!==null;){if((g.flags&12854)!==0||(g.subtreeFlags&12854)!==0)return!1;g=g.sibling}return!0}var al,il,sa,aa;if(Oe)al=function(g,x){for(var j=x.child;j!==null;){if(j.tag===5||j.tag===6)H(g,j.stateNode);else if(j.tag!==4&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===x)break;for(;j.sibling===null;){if(j.return===null||j.return===x)return;j=j.return}j.sibling.return=j.return,j=j.sibling}},il=function(){},sa=function(g,x,j,M,z){if(g=g.memoizedProps,g!==M){var ee=x.stateNode,xe=li(oi.current);j=se(ee,j,g,M,z,xe),(x.updateQueue=j)&&na(x)}},aa=function(g,x,j,M){j!==M&&na(x)};else if(ge){al=function(g,x,j,M){for(var z=x.child;z!==null;){if(z.tag===5){var ee=z.stateNode;j&&M&&(ee=Qt(ee,z.type,z.memoizedProps,z)),H(g,ee)}else if(z.tag===6)ee=z.stateNode,j&&M&&(ee=Zt(ee,z.memoizedProps,z)),H(g,ee);else if(z.tag!==4){if(z.tag===22&&z.memoizedState!==null)ee=z.child,ee!==null&&(ee.return=z),al(g,z,!0,!0);else if(z.child!==null){z.child.return=z,z=z.child;continue}}if(z===x)break;for(;z.sibling===null;){if(z.return===null||z.return===x)return;z=z.return}z.sibling.return=z.return,z=z.sibling}};var ol=function(g,x,j,M){for(var z=x.child;z!==null;){if(z.tag===5){var ee=z.stateNode;j&&M&&(ee=Qt(ee,z.type,z.memoizedProps,z)),Wt(g,ee)}else if(z.tag===6)ee=z.stateNode,j&&M&&(ee=Zt(ee,z.memoizedProps,z)),Wt(g,ee);else if(z.tag!==4){if(z.tag===22&&z.memoizedState!==null)ee=z.child,ee!==null&&(ee.return=z),ol(g,z,!0,!0);else if(z.child!==null){z.child.return=z,z=z.child;continue}}if(z===x)break;for(;z.sibling===null;){if(z.return===null||z.return===x)return;z=z.return}z.sibling.return=z.return,z=z.sibling}};il=function(g,x){var j=x.stateNode;if(!Yl(g,x)){g=j.containerInfo;var M=dt(g);ol(M,x,!1,!1),j.pendingChildren=M,na(x),Et(g,M)}},sa=function(g,x,j,M,z){var ee=g.stateNode,xe=g.memoizedProps;if((g=Yl(g,x))&&xe===M)x.stateNode=ee;else{var $e=x.stateNode,nt=li(oi.current),Nt=null;xe!==M&&(Nt=se($e,j,xe,M,z,nt)),g&&Nt===null?x.stateNode=ee:(ee=Fe(ee,Nt,j,xe,M,x,g,$e),X(ee,j,M,z,nt)&&na(x),x.stateNode=ee,g?na(x):al(ee,x,!1,!1))}},aa=function(g,x,j,M){j!==M?(g=li(Qo.current),j=li(oi.current),x.stateNode=ae(M,g,j,x),na(x)):x.stateNode=g.stateNode}}else il=function(){},sa=function(){},aa=function(){};function Ga(g,x){if(!xn)switch(g.tailMode){case"hidden":x=g.tail;for(var j=null;x!==null;)x.alternate!==null&&(j=x),x=x.sibling;j===null?g.tail=null:j.sibling=null;break;case"collapsed":j=g.tail;for(var M=null;j!==null;)j.alternate!==null&&(M=j),j=j.sibling;M===null?x||g.tail===null?g.tail=null:g.tail.sibling=null:M.sibling=null}}function _n(g){var x=g.alternate!==null&&g.alternate.child===g.child,j=0,M=0;if(x)for(var z=g.child;z!==null;)j|=z.lanes|z.childLanes,M|=z.subtreeFlags&14680064,M|=z.flags&14680064,z.return=g,z=z.sibling;else for(z=g.child;z!==null;)j|=z.lanes|z.childLanes,M|=z.subtreeFlags,M|=z.flags,z.return=g,z=z.sibling;return g.subtreeFlags|=M,g.childLanes=j,x}function Jl(g,x,j){var M=x.pendingProps;switch(Zu(x),x.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(x),null;case 1:return vr(x.type)&&va(),_n(x),null;case 3:return j=x.stateNode,Ol(),Ur(st),Ur(Ze),z0(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(g===null||g.child===null)&&(Df(x)?na(x):g===null||g.memoizedState.isDehydrated&&(x.flags&256)===0||(x.flags|=1024,Ei!==null&&(dh(Ei),Ei=null))),il(g,x),_n(x),null;case 5:$0(x),j=li(Qo.current);var z=x.type;if(g!==null&&x.stateNode!=null)sa(g,x,z,M,j),g.ref!==x.ref&&(x.flags|=512,x.flags|=2097152);else{if(!M){if(x.stateNode===null)throw Error(i(166));return _n(x),null}if(g=li(oi.current),Df(x)){if(!ye)throw Error(i(175));g=oe(x.stateNode,x.type,x.memoizedProps,j,g,x,!ed),x.updateQueue=g,g!==null&&na(x)}else{var ee=V(z,M,j,g,x);al(ee,x,!1,!1),x.stateNode=ee,X(ee,z,M,j,g)&&na(x)}x.ref!==null&&(x.flags|=512,x.flags|=2097152)}return _n(x),null;case 6:if(g&&x.stateNode!=null)aa(g,x,g.memoizedProps,M);else{if(typeof M!="string"&&x.stateNode===null)throw Error(i(166));if(g=li(Qo.current),j=li(oi.current),Df(x)){if(!ye)throw Error(i(176));if(g=x.stateNode,j=x.memoizedProps,(M=me(g,j,x,!ed))&&(z=As,z!==null))switch(z.tag){case 3:Ue(z.stateNode.containerInfo,g,j,(z.mode&1)!==0);break;case 5:ze(z.type,z.memoizedProps,z.stateNode,g,j,(z.mode&1)!==0)}M&&na(x)}else x.stateNode=ae(M,g,j,x)}return _n(x),null;case 13:if(Ur(Tn),M=x.memoizedState,g===null||g.memoizedState!==null&&g.memoizedState.dehydrated!==null){if(xn&&ra!==null&&(x.mode&1)!==0&&(x.flags&128)===0)sx(),Rl(),x.flags|=98560,z=!1;else if(z=Df(x),M!==null&&M.dehydrated!==null){if(g===null){if(!z)throw Error(i(318));if(!ye)throw Error(i(344));if(z=x.memoizedState,z=z!==null?z.dehydrated:null,!z)throw Error(i(317));re(z,x)}else Rl(),(x.flags&128)===0&&(x.memoizedState=null),x.flags|=4;_n(x),z=!1}else Ei!==null&&(dh(Ei),Ei=null),z=!0;if(!z)return x.flags&65536?x:null}return(x.flags&128)!==0?(x.lanes=j,x):(j=M!==null,j!==(g!==null&&g.memoizedState!==null)&&j&&(x.child.flags|=8192,(x.mode&1)!==0&&(g===null||(Tn.current&1)!==0?Sn===0&&(Sn=3):au())),x.updateQueue!==null&&(x.flags|=4),_n(x),null);case 4:return Ol(),il(g,x),g===null&&Xe(x.stateNode.containerInfo),_n(x),null;case 10:return td(x.type._context),_n(x),null;case 17:return vr(x.type)&&va(),_n(x),null;case 19:if(Ur(Tn),z=x.memoizedState,z===null)return _n(x),null;if(M=(x.flags&128)!==0,ee=z.rendering,ee===null)if(M)Ga(z,!1);else{if(Sn!==0||g!==null&&(g.flags&128)!==0)for(g=x.child;g!==null;){if(ee=Uf(g),ee!==null){for(x.flags|=128,Ga(z,!1),g=ee.updateQueue,g!==null&&(x.updateQueue=g,x.flags|=4),x.subtreeFlags=0,g=j,j=x.child;j!==null;)M=j,z=g,M.flags&=14680066,ee=M.alternate,ee===null?(M.childLanes=0,M.lanes=z,M.child=null,M.subtreeFlags=0,M.memoizedProps=null,M.memoizedState=null,M.updateQueue=null,M.dependencies=null,M.stateNode=null):(M.childLanes=ee.childLanes,M.lanes=ee.lanes,M.child=ee.child,M.subtreeFlags=0,M.deletions=null,M.memoizedProps=ee.memoizedProps,M.memoizedState=ee.memoizedState,M.updateQueue=ee.updateQueue,M.type=ee.type,z=ee.dependencies,M.dependencies=z===null?null:{lanes:z.lanes,firstContext:z.firstContext}),j=j.sibling;return he(Tn,Tn.current&1|2),x.child}g=g.sibling}z.tail!==null&&ps()>yd&&(x.flags|=128,M=!0,Ga(z,!1),x.lanes=4194304)}else{if(!M)if(g=Uf(ee),g!==null){if(x.flags|=128,M=!0,g=g.updateQueue,g!==null&&(x.updateQueue=g,x.flags|=4),Ga(z,!0),z.tail===null&&z.tailMode==="hidden"&&!ee.alternate&&!xn)return _n(x),null}else 2*ps()-z.renderingStartTime>yd&&j!==1073741824&&(x.flags|=128,M=!0,Ga(z,!1),x.lanes=4194304);z.isBackwards?(ee.sibling=x.child,x.child=ee):(g=z.last,g!==null?g.sibling=ee:x.child=ee,z.last=ee)}return z.tail!==null?(x=z.tail,z.rendering=x,z.tail=x.sibling,z.renderingStartTime=ps(),x.sibling=null,g=Tn.current,he(Tn,M?g&1|2:g&1),x):(_n(x),null);case 22:case 23:return fh(),j=x.memoizedState!==null,g!==null&&g.memoizedState!==null!==j&&(x.flags|=8192),j&&(x.mode&1)!==0?(is&1073741824)!==0&&(_n(x),Oe&&x.subtreeFlags&6&&(x.flags|=8192)):_n(x),null;case 24:return null;case 25:return null}throw Error(i(156,x.tag))}function wx(g,x){switch(Zu(x),x.tag){case 1:return vr(x.type)&&va(),g=x.flags,g&65536?(x.flags=g&-65537|128,x):null;case 3:return Ol(),Ur(st),Ur(Ze),z0(),g=x.flags,(g&65536)!==0&&(g&128)===0?(x.flags=g&-65537|128,x):null;case 5:return $0(x),null;case 13:if(Ur(Tn),g=x.memoizedState,g!==null&&g.dehydrated!==null){if(x.alternate===null)throw Error(i(340));Rl()}return g=x.flags,g&65536?(x.flags=g&-65537|128,x):null;case 19:return Ur(Tn),null;case 4:return Ol(),null;case 10:return td(x.type._context),null;case 22:case 23:return fh(),null;case 24:return null;default:return null}}var qc=!1,vs=!1,Va=typeof WeakSet=="function"?WeakSet:Set,Lt=null;function Zr(g,x){var j=g.ref;if(j!==null)if(typeof j=="function")try{j(null)}catch(M){vn(g,x,M)}else j.current=null}function Ka(g,x,j){try{j()}catch(M){vn(g,x,M)}}var sg=!1;function _x(g,x){for(B(g.containerInfo),Lt=x;Lt!==null;)if(g=Lt,x=g.child,(g.subtreeFlags&1028)!==0&&x!==null)x.return=g,Lt=x;else for(;Lt!==null;){g=Lt;try{var j=g.alternate;if((g.flags&1024)!==0)switch(g.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var M=j.memoizedProps,z=j.memoizedState,ee=g.stateNode,xe=ee.getSnapshotBeforeUpdate(g.elementType===g.type?M:Ha(g.type,M),z);ee.__reactInternalSnapshotBeforeUpdate=xe}break;case 3:Oe&&Ne(g.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch($e){vn(g,g.return,$e)}if(x=g.sibling,x!==null){x.return=g.return,Lt=x;break}Lt=g.return}return j=sg,sg=!1,j}function Ql(g,x,j){var M=x.updateQueue;if(M=M!==null?M.lastEffect:null,M!==null){var z=M=M.next;do{if((z.tag&g)===g){var ee=z.destroy;z.destroy=void 0,ee!==void 0&&Ka(x,j,ee)}z=z.next}while(z!==M)}}function Xc(g,x){if(x=x.updateQueue,x=x!==null?x.lastEffect:null,x!==null){var j=x=x.next;do{if((j.tag&g)===g){var M=j.create;j.destroy=M()}j=j.next}while(j!==x)}}function eh(g){var x=g.ref;if(x!==null){var j=g.stateNode;switch(g.tag){case 5:g=J(j);break;default:g=j}typeof x=="function"?x(g):x.current=g}}function fd(g){var x=g.alternate;x!==null&&(g.alternate=null,fd(x)),g.child=null,g.deletions=null,g.sibling=null,g.tag===5&&(x=g.stateNode,x!==null&&Ye(x)),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function ag(g){return g.tag===5||g.tag===3||g.tag===4}function Zl(g){e:for(;;){for(;g.sibling===null;){if(g.return===null||ag(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;g.tag!==5&&g.tag!==6&&g.tag!==18;){if(g.flags&2||g.child===null||g.tag===4)continue e;g.child.return=g,g=g.child}if(!(g.flags&2))return g.stateNode}}function hd(g,x,j){var M=g.tag;if(M===5||M===6)g=g.stateNode,x?Be(j,g,x):At(j,g);else if(M!==4&&(g=g.child,g!==null))for(hd(g,x,j),g=g.sibling;g!==null;)hd(g,x,j),g=g.sibling}function ig(g,x,j){var M=g.tag;if(M===5||M===6)g=g.stateNode,x?$t(j,g,x):bt(j,g);else if(M!==4&&(g=g.child,g!==null))for(ig(g,x,j),g=g.sibling;g!==null;)ig(g,x,j),g=g.sibling}var Bn=null,Sa=!1;function Ai(g,x,j){for(j=j.child;j!==null;)th(g,x,j),j=j.sibling}function th(g,x,j){if(wa&&typeof wa.onCommitFiberUnmount=="function")try{wa.onCommitFiberUnmount(Ko,j)}catch{}switch(j.tag){case 5:vs||Zr(j,x);case 6:if(Oe){var M=Bn,z=Sa;Bn=null,Ai(g,x,j),Bn=M,Sa=z,Bn!==null&&(Sa?ut(Bn,j.stateNode):it(Bn,j.stateNode))}else Ai(g,x,j);break;case 18:Oe&&Bn!==null&&(Sa?Ve(Bn,j.stateNode):Pe(Bn,j.stateNode));break;case 4:Oe?(M=Bn,z=Sa,Bn=j.stateNode.containerInfo,Sa=!0,Ai(g,x,j),Bn=M,Sa=z):(ge&&(M=j.stateNode.containerInfo,z=dt(M),nr(M,z)),Ai(g,x,j));break;case 0:case 11:case 14:case 15:if(!vs&&(M=j.updateQueue,M!==null&&(M=M.lastEffect,M!==null))){z=M=M.next;do{var ee=z,xe=ee.destroy;ee=ee.tag,xe!==void 0&&((ee&2)!==0||(ee&4)!==0)&&Ka(j,x,xe),z=z.next}while(z!==M)}Ai(g,x,j);break;case 1:if(!vs&&(Zr(j,x),M=j.stateNode,typeof M.componentWillUnmount=="function"))try{M.props=j.memoizedProps,M.state=j.memoizedState,M.componentWillUnmount()}catch($e){vn(j,x,$e)}Ai(g,x,j);break;case 21:Ai(g,x,j);break;case 22:j.mode&1?(vs=(M=vs)||j.memoizedState!==null,Ai(g,x,j),vs=M):Ai(g,x,j);break;default:Ai(g,x,j)}}function ec(g){var x=g.updateQueue;if(x!==null){g.updateQueue=null;var j=g.stateNode;j===null&&(j=g.stateNode=new Va),x.forEach(function(M){var z=lv.bind(null,g,M);j.has(M)||(j.add(M),M.then(z,z))})}}function ui(g,x){var j=x.deletions;if(j!==null)for(var M=0;M<j.length;M++){var z=j[M];try{var ee=g,xe=x;if(Oe){var $e=xe;e:for(;$e!==null;){switch($e.tag){case 5:Bn=$e.stateNode,Sa=!1;break e;case 3:Bn=$e.stateNode.containerInfo,Sa=!0;break e;case 4:Bn=$e.stateNode.containerInfo,Sa=!0;break e}$e=$e.return}if(Bn===null)throw Error(i(160));th(ee,xe,z),Bn=null,Sa=!1}else th(ee,xe,z);var nt=z.alternate;nt!==null&&(nt.return=null),z.return=null}catch(Nt){vn(z,x,Nt)}}if(x.subtreeFlags&12854)for(x=x.child;x!==null;)gd(x,g),x=x.sibling}function gd(g,x){var j=g.alternate,M=g.flags;switch(g.tag){case 0:case 11:case 14:case 15:if(ui(x,g),qa(g),M&4){try{Ql(3,g,g.return),Xc(3,g)}catch(Ut){vn(g,g.return,Ut)}try{Ql(5,g,g.return)}catch(Ut){vn(g,g.return,Ut)}}break;case 1:ui(x,g),qa(g),M&512&&j!==null&&Zr(j,j.return);break;case 5:if(ui(x,g),qa(g),M&512&&j!==null&&Zr(j,j.return),Oe){if(g.flags&32){var z=g.stateNode;try{St(z)}catch(Ut){vn(g,g.return,Ut)}}if(M&4&&(z=g.stateNode,z!=null)){var ee=g.memoizedProps;if(j=j!==null?j.memoizedProps:ee,M=g.type,x=g.updateQueue,g.updateQueue=null,x!==null)try{Gt(z,x,M,j,ee,g)}catch(Ut){vn(g,g.return,Ut)}}}break;case 6:if(ui(x,g),qa(g),M&4&&Oe){if(g.stateNode===null)throw Error(i(162));z=g.stateNode,ee=g.memoizedProps,j=j!==null?j.memoizedProps:ee;try{gt(z,j,ee)}catch(Ut){vn(g,g.return,Ut)}}break;case 3:if(ui(x,g),qa(g),M&4){if(Oe&&ye&&j!==null&&j.memoizedState.isDehydrated)try{fe(x.containerInfo)}catch(Ut){vn(g,g.return,Ut)}if(ge){z=x.containerInfo,ee=x.pendingChildren;try{nr(z,ee)}catch(Ut){vn(g,g.return,Ut)}}}break;case 4:if(ui(x,g),qa(g),M&4&&ge){ee=g.stateNode,z=ee.containerInfo,ee=ee.pendingChildren;try{nr(z,ee)}catch(Ut){vn(g,g.return,Ut)}}break;case 13:ui(x,g),qa(g),z=g.child,z.flags&8192&&(ee=z.memoizedState!==null,z.stateNode.isHidden=ee,!ee||z.alternate!==null&&z.alternate.memoizedState!==null||(tu=ps())),M&4&&ec(g);break;case 22:var xe=j!==null&&j.memoizedState!==null;if(g.mode&1?(vs=(j=vs)||xe,ui(x,g),vs=j):ui(x,g),qa(g),M&8192){if(j=g.memoizedState!==null,(g.stateNode.isHidden=j)&&!xe&&(g.mode&1)!==0)for(Lt=g,M=g.child;M!==null;){for(x=Lt=M;Lt!==null;){xe=Lt;var $e=xe.child;switch(xe.tag){case 0:case 11:case 14:case 15:Ql(4,xe,xe.return);break;case 1:Zr(xe,xe.return);var nt=xe.stateNode;if(typeof nt.componentWillUnmount=="function"){var Nt=xe,Xt=xe.return;try{var pr=Nt;nt.props=pr.memoizedProps,nt.state=pr.memoizedState,nt.componentWillUnmount()}catch(Ut){vn(Nt,Xt,Ut)}}break;case 5:Zr(xe,xe.return);break;case 22:if(xe.memoizedState!==null){sh(x);continue}}$e!==null?($e.return=xe,Lt=$e):sh(x)}M=M.sibling}if(Oe){e:if(M=null,Oe)for(x=g;;){if(x.tag===5){if(M===null){M=x;try{z=x.stateNode,j?Mt(z):Te(x.stateNode,x.memoizedProps)}catch(Ut){vn(g,g.return,Ut)}}}else if(x.tag===6){if(M===null)try{ee=x.stateNode,j?Ot(ee):ve(ee,x.memoizedProps)}catch(Ut){vn(g,g.return,Ut)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===g)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===g)break e;for(;x.sibling===null;){if(x.return===null||x.return===g)break e;M===x&&(M=null),x=x.return}M===x&&(M=null),x.sibling.return=x.return,x=x.sibling}}}break;case 19:ui(x,g),qa(g),M&4&&ec(g);break;case 21:break;default:ui(x,g),qa(g)}}function qa(g){var x=g.flags;if(x&2){try{if(Oe){e:{for(var j=g.return;j!==null;){if(ag(j)){var M=j;break e}j=j.return}throw Error(i(160))}switch(M.tag){case 5:var z=M.stateNode;M.flags&32&&(St(z),M.flags&=-33);var ee=Zl(g);ig(g,ee,z);break;case 3:case 4:var xe=M.stateNode.containerInfo,$e=Zl(g);hd(g,$e,xe);break;default:throw Error(i(161))}}}catch(nt){vn(g,g.return,nt)}g.flags&=-3}x&4096&&(g.flags&=-4097)}function Yc(g,x,j){Lt=g,rh(g)}function rh(g,x,j){for(var M=(g.mode&1)!==0;Lt!==null;){var z=Lt,ee=z.child;if(z.tag===22&&M){var xe=z.memoizedState!==null||qc;if(!xe){var $e=z.alternate,nt=$e!==null&&$e.memoizedState!==null||vs;$e=qc;var Nt=vs;if(qc=xe,(vs=nt)&&!Nt)for(Lt=z;Lt!==null;)xe=Lt,nt=xe.child,xe.tag===22&&xe.memoizedState!==null?ah(z):nt!==null?(nt.return=xe,Lt=nt):ah(z);for(;ee!==null;)Lt=ee,rh(ee),ee=ee.sibling;Lt=z,qc=$e,vs=Nt}nh(g)}else(z.subtreeFlags&8772)!==0&&ee!==null?(ee.return=z,Lt=ee):nh(g)}}function nh(g){for(;Lt!==null;){var x=Lt;if((x.flags&8772)!==0){var j=x.alternate;try{if((x.flags&8772)!==0)switch(x.tag){case 0:case 11:case 15:vs||Xc(5,x);break;case 1:var M=x.stateNode;if(x.flags&4&&!vs)if(j===null)M.componentDidMount();else{var z=x.elementType===x.type?j.memoizedProps:Ha(x.type,j.memoizedProps);M.componentDidUpdate(z,j.memoizedState,M.__reactInternalSnapshotBeforeUpdate)}var ee=x.updateQueue;ee!==null&&ux(x,ee,M);break;case 3:var xe=x.updateQueue;if(xe!==null){if(j=null,x.child!==null)switch(x.child.tag){case 5:j=J(x.child.stateNode);break;case 1:j=x.child.stateNode}ux(x,xe,j)}break;case 5:var $e=x.stateNode;j===null&&x.flags&4&&kt($e,x.type,x.memoizedProps,x);break;case 6:break;case 4:break;case 12:break;case 13:if(ye&&x.memoizedState===null){var nt=x.alternate;if(nt!==null){var Nt=nt.memoizedState;if(Nt!==null){var Xt=Nt.dehydrated;Xt!==null&&de(Xt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}vs||x.flags&512&&eh(x)}catch(pr){vn(x,x.return,pr)}}if(x===g){Lt=null;break}if(j=x.sibling,j!==null){j.return=x.return,Lt=j;break}Lt=x.return}}function sh(g){for(;Lt!==null;){var x=Lt;if(x===g){Lt=null;break}var j=x.sibling;if(j!==null){j.return=x.return,Lt=j;break}Lt=x.return}}function ah(g){for(;Lt!==null;){var x=Lt;try{switch(x.tag){case 0:case 11:case 15:var j=x.return;try{Xc(4,x)}catch(nt){vn(x,j,nt)}break;case 1:var M=x.stateNode;if(typeof M.componentDidMount=="function"){var z=x.return;try{M.componentDidMount()}catch(nt){vn(x,z,nt)}}var ee=x.return;try{eh(x)}catch(nt){vn(x,ee,nt)}break;case 5:var xe=x.return;try{eh(x)}catch(nt){vn(x,xe,nt)}}}catch(nt){vn(x,x.return,nt)}if(x===g){Lt=null;break}var $e=x.sibling;if($e!==null){$e.return=x.return,Lt=$e;break}Lt=x.return}}var Co=0,ia=1,Ki=2,Jc=3,md=4;if(typeof Symbol=="function"&&Symbol.for){var Xa=Symbol.for;Co=Xa("selector.component"),ia=Xa("selector.has_pseudo_class"),Ki=Xa("selector.role"),Jc=Xa("selector.test_id"),md=Xa("selector.text")}function qi(g){var x=Ke(g);if(x!=null){if(typeof x.memoizedProps["data-testname"]!="string")throw Error(i(364));return x}if(g=De(g),g===null)throw Error(i(362));return g.stateNode.current}function pd(g,x){switch(x.$$typeof){case Co:if(g.type===x.value)return!0;break;case ia:e:{x=x.value,g=[g,0];for(var j=0;j<g.length;){var M=g[j++],z=g[j++],ee=x[z];if(M.tag!==5||!at(M)){for(;ee!=null&&pd(M,ee);)z++,ee=x[z];if(z===x.length){x=!0;break e}else for(M=M.child;M!==null;)g.push(M,z),M=M.sibling}}x=!1}return x;case Ki:if(g.tag===5&&wt(g.stateNode,x.value))return!0;break;case md:if((g.tag===5||g.tag===6)&&(g=ct(g),g!==null&&0<=g.indexOf(x.value)))return!0;break;case Jc:if(g.tag===5&&(g=g.memoizedProps["data-testname"],typeof g=="string"&&g.toLowerCase()===x.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function ih(g){switch(g.$$typeof){case Co:return"<"+(R(g.value)||"Unknown")+">";case ia:return":has("+(ih(g)||"")+")";case Ki:return'[role="'+g.value+'"]';case md:return'"'+g.value+'"';case Jc:return'[data-testname="'+g.value+'"]';default:throw Error(i(365))}}function Xi(g,x){var j=[];g=[g,0];for(var M=0;M<g.length;){var z=g[M++],ee=g[M++],xe=x[ee];if(z.tag!==5||!at(z)){for(;xe!=null&&pd(z,xe);)ee++,xe=x[ee];if(ee===x.length)j.push(z);else for(z=z.child;z!==null;)g.push(z,ee),z=z.sibling}}return j}function Yi(g,x){if(!je)throw Error(i(363));g=qi(g),g=Xi(g,x),x=[],g=Array.from(g);for(var j=0;j<g.length;){var M=g[j++];if(M.tag===5)at(M)||x.push(M.stateNode);else for(M=M.child;M!==null;)g.push(M),M=M.sibling}return x}var oh=Math.ceil,xd=o.ReactCurrentDispatcher,Qc=o.ReactCurrentOwner,Rn=o.ReactCurrentBatchConfig,wr=0,sn=null,bn=null,Un=0,is=0,ll=Tr(0),Sn=0,Zc=null,To=0,hn=0,eu=0,tc=null,zs=null,tu=0,yd=1/0,oa=null;function rn(){yd=ps()+500}var In=!1,Kn=null,ji=null,cl=!1,di=null,lh=0,qn=0,vd=null,ru=-1,nu=0;function yn(){return(wr&6)!==0?ps():ru!==-1?ru:ru=ps()}function os(g){return(g.mode&1)===0?1:(wr&2)!==0&&Un!==0?Un&-Un:av.transition!==null?(nu===0&&(nu=Tf()),nu):(g=Dr,g!==0?g:lt())}function Hs(g,x,j,M){if(50<qn)throw qn=0,vd=null,Error(i(185));ii(g,j,M),((wr&2)===0||g!==sn)&&(g===sn&&((wr&2)===0&&(hn|=j),Sn===4&&Eo(g,Un)),Gs(g,M),j===1&&wr===0&&(x.mode&1)===0&&(rn(),Mc&&Ns()))}function Gs(g,x){var j=g.callbackNode;Jp(g,x);var M=Pc(g,g===sn?Un:0);if(M===0)j!==null&&Qp(j),g.callbackNode=null,g.callbackPriority=0;else if(x=M&-M,g.callbackPriority!==x){if(j!=null&&Qp(j),x===1)g.tag===0?ex(og.bind(null,g)):Ff(og.bind(null,g)),We?Me(function(){(wr&6)===0&&Ns()}):Wi(Ef,Ns),j=null;else{switch(Rc(M)){case 1:j=Ef;break;case 4:j=Nf;break;case 16:j=Af;break;case 536870912:j=sv;break;default:j=Af}j=gg(j,ch.bind(null,g))}g.callbackPriority=x,g.callbackNode=j}}function ch(g,x){if(ru=-1,nu=0,(wr&6)!==0)throw Error(i(327));var j=g.callbackNode;if(No()&&g.callbackNode!==j)return null;var M=Pc(g,g===sn?Un:0);if(M===0)return null;if((M&30)!==0||(M&g.expiredLanes)!==0||x)x=rc(g,M);else{x=M;var z=wr;wr|=2;var ee=cg();(sn!==g||Un!==x)&&(oa=null,rn(),ul(g,x));do try{ug();break}catch($e){su(g,$e)}while(!0);L0(),xd.current=ee,wr=z,bn!==null?x=0:(sn=null,Un=0,x=Sn)}if(x!==0){if(x===2&&(z=Cf(g),z!==0&&(M=z,x=uh(g,z))),x===1)throw j=Zc,ul(g,0),Eo(g,M),Gs(g,ps()),j;if(x===6)Eo(g,M);else{if(z=g.current.alternate,(M&30)===0&&!bx(z)&&(x=rc(g,M),x===2&&(ee=Cf(g),ee!==0&&(M=ee,x=uh(g,ee))),x===1))throw j=Zc,ul(g,0),Eo(g,M),Gs(g,ps()),j;switch(g.finishedWork=z,g.finishedLanes=M,x){case 0:case 1:throw Error(i(345));case 2:dl(g,zs,oa);break;case 3:if(Eo(g,M),(M&130023424)===M&&(x=tu+500-ps(),10<x)){if(Pc(g,0)!==0)break;if(z=g.suspendedLanes,(z&M)!==M){yn(),g.pingedLanes|=g.suspendedLanes&z;break}g.timeoutHandle=Q(dl.bind(null,g,zs,oa),x);break}dl(g,zs,oa);break;case 4:if(Eo(g,M),(M&4194240)===M)break;for(x=g.eventTimes,z=-1;0<M;){var xe=31-Us(M);ee=1<<xe,xe=x[xe],xe>z&&(z=xe),M&=~ee}if(M=z,M=ps()-M,M=(120>M?120:480>M?480:1080>M?1080:1920>M?1920:3e3>M?3e3:4320>M?4320:1960*oh(M/1960))-M,10<M){g.timeoutHandle=Q(dl.bind(null,g,zs,oa),M);break}dl(g,zs,oa);break;case 5:dl(g,zs,oa);break;default:throw Error(i(329))}}}return Gs(g,ps()),g.callbackNode===j?ch.bind(null,g):null}function uh(g,x){var j=tc;return g.current.memoizedState.isDehydrated&&(ul(g,x).flags|=256),g=rc(g,x),g!==2&&(x=zs,zs=j,x!==null&&dh(x)),g}function dh(g){zs===null?zs=g:zs.push.apply(zs,g)}function bx(g){for(var x=g;;){if(x.flags&16384){var j=x.updateQueue;if(j!==null&&(j=j.stores,j!==null))for(var M=0;M<j.length;M++){var z=j[M],ee=z.getSnapshot;z=z.value;try{if(!ki(ee(),z))return!1}catch{return!1}}}if(j=x.child,x.subtreeFlags&16384&&j!==null)j.return=x,x=j;else{if(x===g)break;for(;x.sibling===null;){if(x.return===null||x.return===g)return!0;x=x.return}x.sibling.return=x.return,x=x.sibling}}return!0}function Eo(g,x){for(x&=~eu,x&=~hn,g.suspendedLanes|=x,g.pingedLanes&=~x,g=g.expirationTimes;0<x;){var j=31-Us(x),M=1<<j;g[j]=-1,x&=~M}}function og(g){if((wr&6)!==0)throw Error(i(327));No();var x=Pc(g,0);if((x&1)===0)return Gs(g,ps()),null;var j=rc(g,x);if(g.tag!==0&&j===2){var M=Cf(g);M!==0&&(x=M,j=uh(g,M))}if(j===1)throw j=Zc,ul(g,0),Eo(g,x),Gs(g,ps()),j;if(j===6)throw Error(i(345));return g.finishedWork=g.current.alternate,g.finishedLanes=x,dl(g,zs,oa),Gs(g,ps()),null}function lg(g){di!==null&&di.tag===0&&(wr&6)===0&&No();var x=wr;wr|=1;var j=Rn.transition,M=Dr;try{if(Rn.transition=null,Dr=1,g)return g()}finally{Dr=M,Rn.transition=j,wr=x,(wr&6)===0&&Ns()}}function fh(){is=ll.current,Ur(ll)}function ul(g,x){g.finishedWork=null,g.finishedLanes=0;var j=g.timeoutHandle;if(j!==_e&&(g.timeoutHandle=_e,le(j)),bn!==null)for(j=bn.return;j!==null;){var M=j;switch(Zu(M),M.tag){case 1:M=M.type.childContextTypes,M!=null&&va();break;case 3:Ol(),Ur(st),Ur(Ze),z0();break;case 5:$0(M);break;case 4:Ol();break;case 13:Ur(Tn);break;case 19:Ur(Tn);break;case 10:td(M.type._context);break;case 22:case 23:fh()}j=j.return}if(sn=g,bn=g=fl(g.current,null),Un=is=x,Sn=0,Zc=null,eu=hn=To=0,zs=tc=null,Xo!==null){for(x=0;x<Xo.length;x++)if(j=Xo[x],M=j.interleaved,M!==null){j.interleaved=null;var z=M.next,ee=j.pending;if(ee!==null){var xe=ee.next;ee.next=z,M.next=xe}j.pending=M}Xo=null}return g}function su(g,x){do{var j=bn;try{if(L0(),ba.current=Gl,Wc){for(var M=wn.memoizedState;M!==null;){var z=M.queue;z!==null&&(z.pending=null),M=M.next}Wc=!1}if(Zo=0,ss=Vn=wn=null,nd=!1,sd=0,Qc.current=null,j===null||j.return===null){Sn=1,Zc=x,bn=null;break}e:{var ee=g,xe=j.return,$e=j,nt=x;if(x=Un,$e.flags|=32768,nt!==null&&typeof nt=="object"&&typeof nt.then=="function"){var Nt=nt,Xt=$e,pr=Xt.tag;if((Xt.mode&1)===0&&(pr===0||pr===11||pr===15)){var Ut=Xt.alternate;Ut?(Xt.updateQueue=Ut.updateQueue,Xt.memoizedState=Ut.memoizedState,Xt.lanes=Ut.lanes):(Xt.updateQueue=null,Xt.memoizedState=null)}var gn=yx(xe);if(gn!==null){gn.flags&=-257,rl(gn,xe,$e,ee,x),gn.mode&1&&xx(ee,Nt,x),x=gn,nt=Nt;var en=x.updateQueue;if(en===null){var la=new Set;la.add(nt),x.updateQueue=la}else en.add(nt);break e}else{if((x&1)===0){xx(ee,Nt,x),au();break e}nt=Error(i(426))}}else if(xn&&$e.mode&1){var Ji=yx(xe);if(Ji!==null){(Ji.flags&65536)===0&&(Ji.flags|=256),rl(Ji,xe,$e,ee,x),I0(Vl(nt,$e));break e}}ee=nt=Vl(nt,$e),Sn!==4&&(Sn=2),tc===null?tc=[ee]:tc.push(ee),ee=xe;do{switch(ee.tag){case 3:ee.flags|=65536,x&=-x,ee.lanes|=x;var et=Hi(ee,nt,x);Uc(ee,et);break e;case 1:$e=nt;var He=ee.type,ot=ee.stateNode;if((ee.flags&128)===0&&(typeof He.getDerivedStateFromError=="function"||ot!==null&&typeof ot.componentDidCatch=="function"&&(ji===null||!ji.has(ot)))){ee.flags|=65536,x&=-x,ee.lanes|=x;var Ht=Yf(ee,$e,x);Uc(ee,Ht);break e}}ee=ee.return}while(ee!==null)}fg(j)}catch(ar){x=ar,bn===j&&j!==null&&(bn=j=j.return);continue}break}while(!0)}function cg(){var g=xd.current;return xd.current=Gl,g===null?Gl:g}function au(){(Sn===0||Sn===3||Sn===2)&&(Sn=4),sn===null||(To&268435455)===0&&(hn&268435455)===0||Eo(sn,Un)}function rc(g,x){var j=wr;wr|=2;var M=cg();(sn!==g||Un!==x)&&(oa=null,ul(g,x));do try{Sx();break}catch(z){su(g,z)}while(!0);if(L0(),wr=j,xd.current=M,bn!==null)throw Error(i(261));return sn=null,Un=0,Sn}function Sx(){for(;bn!==null;)dg(bn)}function ug(){for(;bn!==null&&!Zp();)dg(bn)}function dg(g){var x=Nx(g.alternate,g,is);g.memoizedProps=g.pendingProps,x===null?fg(g):bn=x,Qc.current=null}function fg(g){var x=g;do{var j=x.alternate;if(g=x.return,(x.flags&32768)===0){if(j=Jl(j,x,is),j!==null){bn=j;return}}else{if(j=wx(j,x),j!==null){j.flags&=32767,bn=j;return}if(g!==null)g.flags|=32768,g.subtreeFlags=0,g.deletions=null;else{Sn=6,bn=null;return}}if(x=x.sibling,x!==null){bn=x;return}bn=x=g}while(x!==null);Sn===0&&(Sn=5)}function dl(g,x,j){var M=Dr,z=Rn.transition;try{Rn.transition=null,Dr=1,kx(g,x,j,M)}finally{Rn.transition=z,Dr=M}return null}function kx(g,x,j,M){do No();while(di!==null);if((wr&6)!==0)throw Error(i(327));j=g.finishedWork;var z=g.finishedLanes;if(j===null)return null;if(g.finishedWork=null,g.finishedLanes=0,j===g.current)throw Error(i(177));g.callbackNode=null,g.callbackPriority=0;var ee=j.lanes|j.childLanes;if(Vo(g,ee),g===sn&&(bn=sn=null,Un=0),(j.subtreeFlags&2064)===0&&(j.flags&2064)===0||cl||(cl=!0,gg(Af,function(){return No(),null})),ee=(j.flags&15990)!==0,(j.subtreeFlags&15990)!==0||ee){ee=Rn.transition,Rn.transition=null;var xe=Dr;Dr=1;var $e=wr;wr|=4,Qc.current=null,_x(g,j),gd(j,g),Y(g.containerInfo),g.current=j,Yc(j),Yu(),wr=$e,Dr=xe,Rn.transition=ee}else g.current=j;if(cl&&(cl=!1,di=g,lh=z),ee=g.pendingLanes,ee===0&&(ji=null),Ic(j.stateNode),Gs(g,ps()),x!==null)for(M=g.onRecoverableError,j=0;j<x.length;j++)z=x[j],M(z.value,{componentStack:z.stack,digest:z.digest});if(In)throw In=!1,g=Kn,Kn=null,g;return(lh&1)!==0&&g.tag!==0&&No(),ee=g.pendingLanes,(ee&1)!==0?g===vd?qn++:(qn=0,vd=g):qn=0,Ns(),null}function No(){if(di!==null){var g=Rc(lh),x=Rn.transition,j=Dr;try{if(Rn.transition=null,Dr=16>g?16:g,di===null)var M=!1;else{if(g=di,di=null,lh=0,(wr&6)!==0)throw Error(i(331));var z=wr;for(wr|=4,Lt=g.current;Lt!==null;){var ee=Lt,xe=ee.child;if((Lt.flags&16)!==0){var $e=ee.deletions;if($e!==null){for(var nt=0;nt<$e.length;nt++){var Nt=$e[nt];for(Lt=Nt;Lt!==null;){var Xt=Lt;switch(Xt.tag){case 0:case 11:case 15:Ql(8,Xt,ee)}var pr=Xt.child;if(pr!==null)pr.return=Xt,Lt=pr;else for(;Lt!==null;){Xt=Lt;var Ut=Xt.sibling,gn=Xt.return;if(fd(Xt),Xt===Nt){Lt=null;break}if(Ut!==null){Ut.return=gn,Lt=Ut;break}Lt=gn}}}var en=ee.alternate;if(en!==null){var la=en.child;if(la!==null){en.child=null;do{var Ji=la.sibling;la.sibling=null,la=Ji}while(la!==null)}}Lt=ee}}if((ee.subtreeFlags&2064)!==0&&xe!==null)xe.return=ee,Lt=xe;else e:for(;Lt!==null;){if(ee=Lt,(ee.flags&2048)!==0)switch(ee.tag){case 0:case 11:case 15:Ql(9,ee,ee.return)}var et=ee.sibling;if(et!==null){et.return=ee.return,Lt=et;break e}Lt=ee.return}}var He=g.current;for(Lt=He;Lt!==null;){xe=Lt;var ot=xe.child;if((xe.subtreeFlags&2064)!==0&&ot!==null)ot.return=xe,Lt=ot;else e:for(xe=He;Lt!==null;){if($e=Lt,($e.flags&2048)!==0)try{switch($e.tag){case 0:case 11:case 15:Xc(9,$e)}}catch(ar){vn($e,$e.return,ar)}if($e===xe){Lt=null;break e}var Ht=$e.sibling;if(Ht!==null){Ht.return=$e.return,Lt=Ht;break e}Lt=$e.return}}if(wr=z,Ns(),wa&&typeof wa.onPostCommitFiberRoot=="function")try{wa.onPostCommitFiberRoot(Ko,g)}catch{}M=!0}return M}finally{Dr=j,Rn.transition=x}}return!1}function hg(g,x,j){x=Vl(j,x),x=Hi(g,x,1),g=_o(g,x,1),x=yn(),g!==null&&(ii(g,1,x),Gs(g,x))}function vn(g,x,j){if(g.tag===3)hg(g,g,j);else for(;x!==null;){if(x.tag===3){hg(x,g,j);break}else if(x.tag===1){var M=x.stateNode;if(typeof x.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(ji===null||!ji.has(M))){g=Vl(j,g),g=Yf(x,g,1),x=_o(x,g,1),g=yn(),x!==null&&(ii(x,1,g),Gs(x,g));break}}x=x.return}}function Cx(g,x,j){var M=g.pingCache;M!==null&&M.delete(x),x=yn(),g.pingedLanes|=g.suspendedLanes&j,sn===g&&(Un&j)===j&&(Sn===4||Sn===3&&(Un&130023424)===Un&&500>ps()-tu?ul(g,0):eu|=j),Gs(g,x)}function Tx(g,x){x===0&&((g.mode&1)===0?x=1:(x=Xu,Xu<<=1,(Xu&130023424)===0&&(Xu=4194304)));var j=yn();g=Ni(g,x),g!==null&&(ii(g,x,j),Gs(g,j))}function Ex(g){var x=g.memoizedState,j=0;x!==null&&(j=x.retryLane),Tx(g,j)}function lv(g,x){var j=0;switch(g.tag){case 13:var M=g.stateNode,z=g.memoizedState;z!==null&&(j=z.retryLane);break;case 19:M=g.stateNode;break;default:throw Error(i(314))}M!==null&&M.delete(x),Tx(g,j)}var Nx;Nx=function(g,x,j){if(g!==null)if(g.memoizedProps!==x.pendingProps||st.current)as=!0;else{if((g.lanes&j)===0&&(x.flags&128)===0)return as=!1,sl(g,x,j);as=(g.flags&131072)!==0}else as=!1,xn&&(x.flags&1048576)!==0&&tx(x,Dl,x.index);switch(x.lanes=0,x.tag){case 2:var M=x.type;dd(g,x),g=x.pendingProps;var z=Er(x,Ze.current);Bc(x,j),z=ad(null,x,M,g,z,j);var ee=$f();return x.flags|=1,typeof z=="object"&&z!==null&&typeof z.render=="function"&&z.$$typeof===void 0?(x.tag=1,x.memoizedState=null,x.updateQueue=null,vr(M)?(ee=!0,Bs(x)):ee=!1,x.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,B0(x),z.updater=ld,x.stateNode=z,z._reactInternals=x,zi(x,M,g,j),x=$s(null,x,M,!0,ee,j)):(x.tag=0,xn&&ee&&Qu(x),ys(null,x,z,j),x=x.child),x;case 16:M=x.elementType;e:{switch(dd(g,x),g=x.pendingProps,z=M._init,M=z(M._payload),x.type=M,z=x.tag=cv(M),g=Ha(M,g),z){case 0:x=Gi(null,x,M,g,j);break e;case 1:x=Fs(null,x,M,g,j);break e;case 11:x=Jf(null,x,M,g,j);break e;case 14:x=Kl(null,x,M,Ha(M.type,g),j);break e}throw Error(i(306,M,""))}return x;case 0:return M=x.type,z=x.pendingProps,z=x.elementType===M?z:Ha(M,z),Gi(g,x,M,z,j);case 1:return M=x.type,z=x.pendingProps,z=x.elementType===M?z:Ha(M,z),Fs(g,x,M,z,j);case 3:e:{if(nl(x),g===null)throw Error(i(387));M=x.pendingProps,ee=x.memoizedState,z=ee.element,cx(g,x),Yo(x,M,null,j);var xe=x.memoizedState;if(M=xe.element,ye&&ee.isDehydrated)if(ee={element:M,isDehydrated:!1,cache:xe.cache,pendingSuspenseBoundaries:xe.pendingSuspenseBoundaries,transitions:xe.transitions},x.updateQueue.baseState=ee,x.memoizedState=ee,x.flags&256){z=Vl(Error(i(423)),x),x=ql(g,x,M,j,z);break e}else if(M!==z){z=Vl(Error(i(424)),x),x=ql(g,x,M,j,z);break e}else for(ye&&(ra=we(x.stateNode.containerInfo),As=x,xn=!0,Ei=null,ed=!1),j=ox(x,null,M,j),x.child=j;j;)j.flags=j.flags&-3|4096,j=j.sibling;else{if(Rl(),M===z){x=ko(g,x,j);break e}ys(g,x,M,j)}x=x.child}return x;case 5:return U0(x),g===null&&R0(x),M=x.type,z=x.pendingProps,ee=g!==null?g.memoizedProps:null,xe=z.children,ie(M,z)?xe=null:ee!==null&&ie(M,ee)&&(x.flags|=32),nn(g,x),ys(g,x,xe,j),x.child;case 6:return g===null&&R0(x),null;case 13:return ng(g,x,j);case 4:return Bf(x,x.stateNode.containerInfo),M=x.pendingProps,g===null?x.child=Ml(x,null,M,j):ys(g,x,M,j),x.child;case 11:return M=x.type,z=x.pendingProps,z=x.elementType===M?z:Ha(M,z),Jf(g,x,M,z,j);case 7:return ys(g,x,x.pendingProps,j),x.child;case 8:return ys(g,x,x.pendingProps.children,j),x.child;case 12:return ys(g,x,x.pendingProps.children,j),x.child;case 10:e:{if(M=x.type._context,z=x.pendingProps,ee=x.memoizedProps,xe=z.value,lx(x,M,xe),ee!==null)if(ki(ee.value,xe)){if(ee.children===z.children&&!st.current){x=ko(g,x,j);break e}}else for(ee=x.child,ee!==null&&(ee.return=x);ee!==null;){var $e=ee.dependencies;if($e!==null){xe=ee.child;for(var nt=$e.firstContext;nt!==null;){if(nt.context===M){if(ee.tag===1){nt=wo(-1,j&-j),nt.tag=2;var Nt=ee.updateQueue;if(Nt!==null){Nt=Nt.shared;var Xt=Nt.pending;Xt===null?nt.next=nt:(nt.next=Xt.next,Xt.next=nt),Nt.pending=nt}}ee.lanes|=j,nt=ee.alternate,nt!==null&&(nt.lanes|=j),Ll(ee.return,j,x),$e.lanes|=j;break}nt=nt.next}}else if(ee.tag===10)xe=ee.type===x.type?null:ee.child;else if(ee.tag===18){if(xe=ee.return,xe===null)throw Error(i(341));xe.lanes|=j,$e=xe.alternate,$e!==null&&($e.lanes|=j),Ll(xe,j,x),xe=ee.sibling}else xe=ee.child;if(xe!==null)xe.return=ee;else for(xe=ee;xe!==null;){if(xe===x){xe=null;break}if(ee=xe.sibling,ee!==null){ee.return=xe.return,xe=ee;break}xe=xe.return}ee=xe}ys(g,x,z.children,j),x=x.child}return x;case 9:return z=x.type,M=x.pendingProps.children,Bc(x,j),z=$a(z),M=M(z),x.flags|=1,ys(g,x,M,j),x.child;case 14:return M=x.type,z=Ha(M,x.pendingProps),z=Ha(M.type,z),Kl(g,x,M,z,j);case 15:return So(g,x,x.type,x.pendingProps,j);case 17:return M=x.type,z=x.pendingProps,z=x.elementType===M?z:Ha(M,z),dd(g,x),x.tag=1,vr(M)?(g=!0,Bs(x)):g=!1,Bc(x,j),px(x,M,z),zi(x,M,z,j),$s(null,x,M,!0,g,j);case 19:return Zf(g,x,j);case 22:return fn(g,x,j)}throw Error(i(156,x.tag))};function gg(g,x){return Wi(g,x)}function Ax(g,x,j,M){this.tag=g,this.key=j,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=x,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ya(g,x,j,M){return new Ax(g,x,j,M)}function iu(g){return g=g.prototype,!(!g||!g.isReactComponent)}function cv(g){if(typeof g=="function")return iu(g)?1:0;if(g!=null){if(g=g.$$typeof,g===w)return 11;if(g===k)return 14}return 2}function fl(g,x){var j=g.alternate;return j===null?(j=Ya(g.tag,x,g.key,g.mode),j.elementType=g.elementType,j.type=g.type,j.stateNode=g.stateNode,j.alternate=g,g.alternate=j):(j.pendingProps=x,j.type=g.type,j.flags=0,j.subtreeFlags=0,j.deletions=null),j.flags=g.flags&14680064,j.childLanes=g.childLanes,j.lanes=g.lanes,j.child=g.child,j.memoizedProps=g.memoizedProps,j.memoizedState=g.memoizedState,j.updateQueue=g.updateQueue,x=g.dependencies,j.dependencies=x===null?null:{lanes:x.lanes,firstContext:x.firstContext},j.sibling=g.sibling,j.index=g.index,j.ref=g.ref,j}function hh(g,x,j,M,z,ee){var xe=2;if(M=g,typeof g=="function")iu(g)&&(xe=1);else if(typeof g=="string")xe=5;else e:switch(g){case f:return Ps(j.children,z,ee,x);case p:xe=8,z|=8;break;case m:return g=Ya(12,j,x,z|2),g.elementType=m,g.lanes=ee,g;case S:return g=Ya(13,j,x,z),g.elementType=S,g.lanes=ee,g;case E:return g=Ya(19,j,x,z),g.elementType=E,g.lanes=ee,g;case N:return ou(j,z,ee,x);default:if(typeof g=="object"&&g!==null)switch(g.$$typeof){case y:xe=10;break e;case v:xe=9;break e;case w:xe=11;break e;case k:xe=14;break e;case _:xe=16,M=null;break e}throw Error(i(130,g==null?g:typeof g,""))}return x=Ya(xe,j,x,z),x.elementType=g,x.type=M,x.lanes=ee,x}function Ps(g,x,j,M){return g=Ya(7,g,M,x),g.lanes=j,g}function ou(g,x,j,M){return g=Ya(22,g,M,x),g.elementType=N,g.lanes=j,g.stateNode={isHidden:!1},g}function lu(g,x,j){return g=Ya(6,g,null,x),g.lanes=j,g}function gh(g,x,j){return x=Ya(4,g.children!==null?g.children:[],g.key,x),x.lanes=j,x.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},x}function jx(g,x,j,M,z){this.tag=x,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=_e,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Dc(0),this.expirationTimes=Dc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dc(0),this.identifierPrefix=M,this.onRecoverableError=z,ye&&(this.mutableSourceEagerHydrationData=null)}function mg(g,x,j,M,z,ee,xe,$e,nt){return g=new jx(g,x,j,$e,nt),x===1?(x=1,ee===!0&&(x|=8)):x=0,ee=Ya(3,null,null,x),g.current=ee,ee.stateNode=g,ee.memoizedState={element:M,isDehydrated:j,cache:null,transitions:null,pendingSuspenseBoundaries:null},B0(ee),g}function mh(g){if(!g)return Se;g=g._reactInternals;e:{if(D(g)!==g||g.tag!==1)throw Error(i(170));var x=g;do{switch(x.tag){case 3:x=x.stateNode.context;break e;case 1:if(vr(x.type)){x=x.stateNode.__reactInternalMemoizedMergedChildContext;break e}}x=x.return}while(x!==null);throw Error(i(171))}if(g.tag===1){var j=g.type;if(vr(j))return Fl(g,j,x)}return x}function nc(g){var x=g._reactInternals;if(x===void 0)throw typeof g.render=="function"?Error(i(188)):(g=Object.keys(g).join(","),Error(i(268,g)));return g=G(x),g===null?null:g.stateNode}function ph(g,x){if(g=g.memoizedState,g!==null&&g.dehydrated!==null){var j=g.retryLane;g.retryLane=j!==0&&j<x?j:x}}function cu(g,x){ph(g,x),(g=g.alternate)&&ph(g,x)}function uv(g){return g=G(g),g===null?null:g.stateNode}function Fx(){return null}return r.attemptContinuousHydration=function(g){if(g.tag===13){var x=Ni(g,134217728);if(x!==null){var j=yn();Hs(x,g,134217728,j)}cu(g,134217728)}},r.attemptDiscreteHydration=function(g){if(g.tag===13){var x=Ni(g,1);if(x!==null){var j=yn();Hs(x,g,1,j)}cu(g,1)}},r.attemptHydrationAtCurrentPriority=function(g){if(g.tag===13){var x=os(g),j=Ni(g,x);if(j!==null){var M=yn();Hs(j,g,x,M)}cu(g,x)}},r.attemptSynchronousHydration=function(g){switch(g.tag){case 3:var x=g.stateNode;if(x.current.memoizedState.isDehydrated){var j=Fc(x.pendingLanes);j!==0&&($i(x,j|1),Gs(x,ps()),(wr&6)===0&&(rn(),Ns()))}break;case 13:lg(function(){var M=Ni(g,1);if(M!==null){var z=yn();Hs(M,g,1,z)}}),cu(g,1)}},r.batchedUpdates=function(g,x){var j=wr;wr|=1;try{return g(x)}finally{wr=j,wr===0&&(rn(),Mc&&Ns())}},r.createComponentSelector=function(g){return{$$typeof:Co,value:g}},r.createContainer=function(g,x,j,M,z,ee,xe){return mg(g,x,!1,null,j,M,z,ee,xe)},r.createHasPseudoClassSelector=function(g){return{$$typeof:ia,value:g}},r.createHydrationContainer=function(g,x,j,M,z,ee,xe,$e,nt){return g=mg(j,M,!0,g,z,ee,xe,$e,nt),g.context=mh(null),j=g.current,M=yn(),z=os(j),ee=wo(M,z),ee.callback=x??null,_o(j,ee,z),g.current.lanes=z,ii(g,z,M),Gs(g,M),g},r.createPortal=function(g,x,j){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:M==null?null:""+M,children:g,containerInfo:x,implementation:j}},r.createRoleSelector=function(g){return{$$typeof:Ki,value:g}},r.createTestNameSelector=function(g){return{$$typeof:Jc,value:g}},r.createTextSelector=function(g){return{$$typeof:md,value:g}},r.deferredUpdates=function(g){var x=Dr,j=Rn.transition;try{return Rn.transition=null,Dr=16,g()}finally{Dr=x,Rn.transition=j}},r.discreteUpdates=function(g,x,j,M,z){var ee=Dr,xe=Rn.transition;try{return Rn.transition=null,Dr=1,g(x,j,M,z)}finally{Dr=ee,Rn.transition=xe,wr===0&&rn()}},r.findAllNodes=Yi,r.findBoundingRects=function(g,x){if(!je)throw Error(i(363));x=Yi(g,x),g=[];for(var j=0;j<x.length;j++)g.push(Ge(x[j]));for(x=g.length-1;0<x;x--){j=g[x];for(var M=j.x,z=M+j.width,ee=j.y,xe=ee+j.height,$e=x-1;0<=$e;$e--)if(x!==$e){var nt=g[$e],Nt=nt.x,Xt=Nt+nt.width,pr=nt.y,Ut=pr+nt.height;if(M>=Nt&&ee>=pr&&z<=Xt&&xe<=Ut){g.splice(x,1);break}else if(M!==Nt||j.width!==nt.width||Ut<ee||pr>xe){if(!(ee!==pr||j.height!==nt.height||Xt<M||Nt>z)){Nt>M&&(nt.width+=Nt-M,nt.x=M),Xt<z&&(nt.width=z-Nt),g.splice(x,1);break}}else{pr>ee&&(nt.height+=pr-ee,nt.y=ee),Ut<xe&&(nt.height=xe-pr),g.splice(x,1);break}}}return g},r.findHostInstance=nc,r.findHostInstanceWithNoPortals=function(g){return g=O(g),g=g!==null?te(g):null,g===null?null:g.stateNode},r.findHostInstanceWithWarning=function(g){return nc(g)},r.flushControlled=function(g){var x=wr;wr|=1;var j=Rn.transition,M=Dr;try{Rn.transition=null,Dr=1,g()}finally{Dr=M,Rn.transition=j,wr=x,wr===0&&(rn(),Ns())}},r.flushPassiveEffects=No,r.flushSync=lg,r.focusWithin=function(g,x){if(!je)throw Error(i(363));for(g=qi(g),x=Xi(g,x),x=Array.from(x),g=0;g<x.length;){var j=x[g++];if(!at(j)){if(j.tag===5&&Ft(j.stateNode))return!0;for(j=j.child;j!==null;)x.push(j),j=j.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Dr},r.getFindAllNodesFailureDescription=function(g,x){if(!je)throw Error(i(363));var j=0,M=[];g=[qi(g),0];for(var z=0;z<g.length;){var ee=g[z++],xe=g[z++],$e=x[xe];if((ee.tag!==5||!at(ee))&&(pd(ee,$e)&&(M.push(ih($e)),xe++,xe>j&&(j=xe)),xe<x.length))for(ee=ee.child;ee!==null;)g.push(ee,xe),ee=ee.sibling}if(j<x.length){for(g=[];j<x.length;j++)g.push(ih(x[j]));return`findAllNodes was able to match part of the selector:
  `+(M.join(" > ")+`

No matching component was found for:
  `)+g.join(" > ")}return null},r.getPublicRootInstance=function(g){if(g=g.current,!g.child)return null;switch(g.child.tag){case 5:return J(g.child.stateNode);default:return g.child.stateNode}},r.injectIntoDevTools=function(g){if(g={bundleType:g.bundleType,version:g.version,rendererPackageName:g.rendererPackageName,rendererConfig:g.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:uv,findFiberByHostInstance:g.findFiberByHostInstance||Fx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")g=!1;else{var x=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(x.isDisabled||!x.supportsFiber)g=!0;else{try{Ko=x.inject(g),wa=x}catch{}g=!!x.checkDCE}}return g},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(g,x,j,M){if(!je)throw Error(i(363));g=Yi(g,x);var z=Kt(g,j,M).disconnect;return{disconnect:function(){z()}}},r.registerMutableSourceForHydration=function(g,x){var j=x._getVersion;j=j(x._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[x,j]:g.mutableSourceEagerHydrationData.push(x,j)},r.runWithPriority=function(g,x){var j=Dr;try{return Dr=g,x()}finally{Dr=j}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(g,x,j,M){var z=x.current,ee=yn(),xe=os(z);return j=mh(j),x.context===null?x.context=j:x.pendingContext=j,x=wo(ee,xe),x.payload={element:g},M=M===void 0?null:M,M!==null&&(x.callback=M),g=_o(z,x,xe),g!==null&&(Hs(g,z,xe,ee),rd(g,z,xe)),xe},r}),dw}var QT;function qM(){return QT||(QT=1,uw.exports=KM()),uw.exports}var XM=qM();const YM=wp(XM);var fw={exports:{}},yu={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZT;function JM(){return ZT||(ZT=1,yu.ConcurrentRoot=1,yu.ContinuousEventPriority=4,yu.DefaultEventPriority=16,yu.DiscreteEventPriority=1,yu.IdleEventPriority=536870912,yu.LegacyRoot=0),yu}var e4;function QM(){return e4||(e4=1,fw.exports=JM()),fw.exports}var v6=QM(),ZM=jr();const t4={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let r4=!1,n4=!1;const nb=".react-konva-event";let w6=!1;function eL(e){w6=e}const tL=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,rL=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,nL={};function jy(e,t,r=nL){if(!r4&&"zIndex"in t&&(console.warn(rL),r4=!0),!n4&&t.draggable){var n=t.x!==void 0||t.y!==void 0,s=t.onDragEnd||t.onDragMove;n&&!s&&(console.warn(tL),n4=!0)}for(var a in r)if(!t4[a]){var i=a.slice(0,2)==="on",o=r[a]!==t[a];if(i&&o){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e.off(c,r[a])}var d=!t.hasOwnProperty(a);d&&e.setAttr(a,void 0)}var f=w6||t._useStrictMode,p={},m=!1;const y={};for(var a in t)if(!t4[a]){var i=a.slice(0,2)==="on",v=r[a]!==t[a];if(i&&v){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),t[a]&&(y[c]=t[a])}!i&&(t[a]!==r[a]||f&&t[a]!==e.getAttr(a))&&(m=!0,p[a]=t[a])}m&&(e.setAttrs(p),$u(e));for(var c in y)e.on(c+nb,y[c])}function $u(e){if(!ZM.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}var hw=g2();const _6={},sL={};Ym.Node.prototype._applyProps=jy;function aL(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),$u(e)}function iL(e,t,r){let n=Ym[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=Ym.Group);const s={},a={};for(var i in t){var o=i.slice(0,2)==="on";o?a[i]=t[i]:s[i]=t[i]}const c=new n(s);return jy(c,a),c}function oL(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function lL(e,t,r){return!1}function cL(e){return e}function uL(){return null}function dL(){return null}function fL(e,t,r,n){return sL}function hL(){}function gL(e){}function mL(e,t){return!1}function pL(){return _6}function xL(){return _6}const yL=setTimeout,vL=clearTimeout,wL=-1;function _L(e,t){return!1}const bL=!1,SL=!0,kL=!0;function CL(e,t){t.parent===e?t.moveToTop():e.add(t),$u(e)}function TL(e,t){t.parent===e?t.moveToTop():e.add(t),$u(e)}function b6(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),$u(e)}function EL(e,t,r){b6(e,t,r)}function NL(e,t){t.destroy(),t.off(nb),$u(e)}function AL(e,t){t.destroy(),t.off(nb),$u(e)}function jL(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function FL(e,t,r){}function PL(e,t,r,n,s){jy(e,s,n)}function DL(e){e.hide(),$u(e)}function RL(e){}function IL(e,t){(t.visible==null||t.visible)&&e.show()}function ML(e,t){}function LL(e){}function OL(){}const BL=()=>v6.DefaultEventPriority,UL=Object.freeze(Object.defineProperty({__proto__:null,appendChild:CL,appendChildToContainer:TL,appendInitialChild:aL,cancelTimeout:vL,clearContainer:LL,commitMount:FL,commitTextUpdate:jL,commitUpdate:PL,createInstance:iL,createTextInstance:oL,detachDeletedInstance:OL,finalizeInitialChildren:lL,getChildHostContext:xL,getCurrentEventPriority:BL,getPublicInstance:cL,getRootHostContext:pL,hideInstance:DL,hideTextInstance:RL,idlePriority:hw.unstable_IdlePriority,insertBefore:b6,insertInContainerBefore:EL,isPrimaryRenderer:bL,noTimeout:wL,now:hw.unstable_now,prepareForCommit:uL,preparePortalMount:dL,prepareUpdate:fL,removeChild:NL,removeChildFromContainer:AL,resetAfterCommit:hL,resetTextContent:gL,run:hw.unstable_runWithPriority,scheduleTimeout:yL,shouldDeprioritizeSubtree:mL,shouldSetTextContent:_L,supportsMutation:kL,unhideInstance:IL,unhideTextInstance:ML,warnsIfNotActing:SL},Symbol.toStringTag,{value:"Module"}));var $L=Object.defineProperty,WL=Object.defineProperties,zL=Object.getOwnPropertyDescriptors,s4=Object.getOwnPropertySymbols,HL=Object.prototype.hasOwnProperty,GL=Object.prototype.propertyIsEnumerable,a4=(e,t,r)=>t in e?$L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,i4=(e,t)=>{for(var r in t||(t={}))HL.call(t,r)&&a4(e,r,t[r]);if(s4)for(var r of s4(t))GL.call(t,r)&&a4(e,r,t[r]);return e},VL=(e,t)=>WL(e,zL(t)),o4,l4;typeof window<"u"&&((o4=window.document)!=null&&o4.createElement||((l4=window.navigator)==null?void 0:l4.product)==="ReactNative")?C.useLayoutEffect:C.useEffect;function S6(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=e.child;for(;n;){const s=S6(n,t,r);if(s)return s;n=n.sibling}}function k6(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const c4=console.error;console.error=function(){const e=[...arguments].join("");if(e?.startsWith("Warning:")&&e.includes("useContext")){console.error=c4;return}return c4.apply(this,arguments)};const sb=k6(C.createContext(null));class C6 extends C.Component{render(){return C.createElement(sb.Provider,{value:this._reactInternals},this.props.children)}}function KL(){const e=C.useContext(sb);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=C.useId();return C.useMemo(()=>{for(const n of[e,e?.alternate]){if(!n)continue;const s=S6(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===t)return!0;i=i.next}});if(s)return s}},[e,t])}function qL(){const e=KL(),[t]=C.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==sb&&!t.has(s)&&t.set(s,C.useContext(k6(s)))}r=r.return}return t}function T6(){const e=qL();return C.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>C.createElement(t,null,C.createElement(r.Provider,VL(i4({},n),{value:e.get(r)}))),t=>C.createElement(C6,i4({},t))),[e])}function XL(e){const t=Cs.useRef({});return Cs.useLayoutEffect(()=>{t.current=e}),Cs.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const YL=e=>{const t=Cs.useRef(null),r=Cs.useRef(null),n=Cs.useRef(null),s=XL(e),a=T6(),i=o=>{const{forwardedRef:c}=e;c&&(typeof c=="function"?c(o):c.current=o)};return Cs.useLayoutEffect(()=>(r.current=new Ym.Stage({width:e.width,height:e.height,container:t.current}),i(r.current),n.current=Oh.createContainer(r.current,v6.LegacyRoot,!1,null),Oh.updateContainer(Cs.createElement(a,{},e.children),n.current),()=>{Ym.isBrowser&&(i(null),Oh.updateContainer(null,n.current,null),r.current.destroy())}),[]),Cs.useLayoutEffect(()=>{i(r.current),jy(r.current,e,s),Oh.updateContainer(Cs.createElement(a,{},e.children),n.current,null)}),Cs.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},Xd="Layer",JL="FastLayer",gc="Group",QL="Label",ri="Rect",r0="Circle",ZL="Ellipse",eO="Wedge",co="Line",tO="Sprite",E6="Image",jd="Text",rO="TextPath",nO="Star",sO="Ring",aO="Arc",iO="Tag",oO="Path",lO="RegularPolygon",w_="Arrow",cO="Shape",N6="Transformer",uO="18.2.13",Oh=YM(UL);Oh.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Cs.version,rendererPackageName:"react-konva"});const Yd=Cs.forwardRef((e,t)=>Cs.createElement(C6,{},Cs.createElement(YL,{...e,forwardedRef:t}))),dO=eL,fO=Object.freeze(Object.defineProperty({__proto__:null,Arc:aO,Arrow:w_,Circle:r0,Ellipse:ZL,FastLayer:JL,Group:gc,Image:E6,KonvaRenderer:Oh,Label:QL,Layer:Xd,Line:co,Path:oO,Rect:ri,RegularPolygon:lO,Ring:sO,Shape:cO,Sprite:tO,Stage:Yd,Star:nO,Tag:iO,Text:jd,TextPath:rO,Transformer:N6,Wedge:eO,useContextBridge:T6,useStrictMode:dO,version:uO},Symbol.toStringTag,{value:"Module"})),mt=({children:e,hover:t=!0,className:r="",...n})=>{const s=`
    bg-white rounded-xl shadow-md border border-gray-200 p-6
    ${t?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return l.jsx(Qe.div,{className:s,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...n,children:e})},hO=({children:e,className:t=""})=>l.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${t}`,children:e}),gO=({children:e,className:t=""})=>l.jsx("h3",{className:`text-xl font-semibold text-gray-800 ${t}`,children:e}),mO=({children:e,className:t=""})=>l.jsx("div",{className:`py-4 ${t}`,children:e}),pO=({children:e,className:t=""})=>l.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${t}`,children:e});mt.Header=hO;mt.Title=gO;mt.Body=mO;mt.Footer=pO;const xO=e=>{const[t,r]=C.useState({width:800,height:600}),n=C.useRef(null),s=C.useCallback(()=>{if(e.current){e.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),o=4/3;let c=a,d=c/o;d>i&&(d=i,c=d*o),r({width:c,height:d})}},[e]);return C.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:t,stageRef:n,updateCanvasSize:s}},__={convertToOriginal:(e,t,r)=>r?{x:Number(((e-r.x)/r.scale).toFixed(4)),y:Number(((t-r.y)/r.scale).toFixed(4))}:{x:e,y:t},convertToCanvas:(e,t,r)=>r?{x:Number((r.x+e*r.scale).toFixed(4)),y:Number((r.y+t*r.scale).toFixed(4))}:{x:e,y:t},isPointInImage:(e,t)=>t?e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height:!1,calculateImageScale:(e,t)=>{if(!e||!t)return 1;const r=40,n=t.width-r,s=t.height-r;return Math.min(n/e.width,s/e.height)},calculateImageInfo:(e,t)=>{if(!e||!t)return null;const r=40,n=t.width-r,s=t.height-r,a=Math.min(n/e.width,s/e.height),i=e.width*a,o=e.height*a,c=(t.width-i)/2,d=(t.height-o)/2;return{x:c,y:d,width:i,height:o,scale:a,originalWidth:e.width,originalHeight:e.height}}},yO=(e,t)=>{const[r,n]=C.useState(null),s=C.useCallback((a,i)=>__.calculateImageInfo(a,i),[]);return C.useEffect(()=>{if(e&&t){const a=s(e,t);n(a)}},[e,t,s]),r},vO=e=>{const t=C.useCallback((n,s)=>__.convertToOriginal(n,s,e),[e]),r=C.useCallback((n,s)=>__.convertToCanvas(n,s,e),[e]);return{convertToOriginal:t,convertToCanvas:r}},dm={create:(e,t,r,n,s)=>({id:s,x:e-r/2,y:t-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:e=>e.width>0&&e.height>0,findAtPosition:(e,t,r)=>e.find(n=>t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},Nh={create:(e,t,r,n,s,a,i)=>({id:i,startX:e,startY:t,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(e,t,r,n=60)=>{let s=null,a=1/0;for(const i of r){const o=i.x+i.width/2,c=i.y+i.height/2,d=Math.sqrt(Math.pow(e-o,2)+Math.pow(t-c,2));d<=n&&d<a&&(a=d,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(e,t,r,n,s)=>Nh.snapToNearestBlock(e,t,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},gw={create:(e,t,r)=>({id:r,blockId:e,word:t}),update:(e,t,r)=>e.map(n=>n.blockId===t?{...n,word:r}:n),delete:(e,t)=>e.filter(r=>r.blockId!==t),generateId:e=>`word_${e}`,validate:e=>e&&e.trim().length>0},wO={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null}},_O=(e,t)=>{switch(t.type){case"SET_CANVAS_SIZE":return{...e,canvas:{...e.canvas,size:t.payload}};case"SET_IMAGE":return{...e,canvas:{...e.canvas,image:t.payload}};case"SET_IMAGE_INFO":return{...e,canvas:{...e.canvas,imageInfo:t.payload}};case"SET_SELECTED_TOOL":return{...e,canvas:{...e.canvas,selectedTool:t.payload}};case"ADD_BLOCK":return{...e,testData:{...e.testData,blocks:[...e.testData.blocks,t.payload]}};case"ADD_WORD":return{...e,testData:{...e.testData,words:[...e.testData.words,t.payload]}};case"ADD_ARROW":return{...e,testData:{...e.testData,arrows:[...e.testData.arrows,t.payload]}};case"UPDATE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.map(r=>r.id===t.payload.id?{...r,...t.payload.updates}:r)}};case"DELETE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.filter(r=>r.id!==t.payload),words:e.testData.words.filter(r=>r.blockId!==t.payload),arrows:e.testData.arrows.filter(r=>r.startBlock!==t.payload&&r.endBlock!==t.payload)}};case"UPDATE_WORDS":return{...e,testData:{...e.testData,words:t.payload}};case"SET_CREATION_STATE":return{...e,creation:{...e.creation,...t.payload}};case"SET_UI_STATE":return{...e,ui:{...e.ui,...t.payload}};case"SET_LOADING":return{...e,ui:{...e.ui,isLoading:t.payload}};case"SET_ERROR":return{...e,ui:{...e.ui,error:t.payload}};case"RESET_TESTDATA":return{...e,testData:{blocks:[],words:[],arrows:[],imageUrl:e.testData.imageUrl}};default:return e}},bO=({testName:e="",showQuestionCount:t=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[o,c]=C.useReducer(_O,wO),{showNotification:d}=Oa(),{makeAuthenticatedRequest:f}=Ho(),{user:p}=Gn(),m=C.useRef(null),y=C.useRef(null),v=C.useRef(null),w=C.useRef({}),S=C.useRef({}),{canvasSize:E,stageRef:k}=xO(m),_=yO(o.canvas.image,E),{convertToOriginal:N}=vO(_);C.useEffect(()=>{c({type:"SET_CANVAS_SIZE",payload:E})},[E]),C.useEffect(()=>{_&&c({type:"SET_IMAGE_INFO",payload:_})},[_]),C.useEffect(()=>{const Z=v.current;if(!Z)return;const J=o.ui.selectedBlock?.id?w.current[o.ui.selectedBlock.id]:null;J?(Z.nodes([J]),Z.getLayer()?.batchDraw()):(Z.nodes([]),Z.getLayer()?.batchDraw())},[o.ui.selectedBlock]);const F=C.useCallback(()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:null}}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),c({type:"RESET_TESTDATA"}),c({type:"SET_ERROR",payload:null})},[]),A=C.useCallback(Z=>{const J=Z.target.files[0];if(!J||!J.type.startsWith("image/")){d("Please select a valid image file","error");return}const I=new FileReader;I.onload=W=>{const B=W.target.result,Y=new Image;Y.crossOrigin="anonymous",Y.onload=()=>{c({type:"SET_IMAGE",payload:Y}),c({type:"SET_UI_STATE",payload:{imageUrl:B}})},Y.src=B},I.readAsDataURL(J)},[d]),R=C.useCallback(Z=>{const J=k.current;if(!J)return;const I=J.getPointerPosition();if(I){if(o.canvas.selectedTool==="create"){const W=dm.findAtPosition(o.testData.blocks,I.x,I.y);if(W){c({type:"SET_UI_STATE",payload:{selectedBlock:W}});return}c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:I.x,y:I.y}}})}else if(o.canvas.selectedTool==="edit"){const W=dm.findAtPosition(o.testData.blocks,I.x,I.y);c(W?{type:"SET_UI_STATE",payload:{selectedBlock:W}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(o.canvas.selectedTool==="arrow"){const W=Z.target===J,B=dm.findAtPosition(o.testData.blocks,I.x,I.y);(W||!B)&&c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:I.x,y:I.y}}})}}},[o.canvas.selectedTool,_,o.testData.blocks]),T=C.useCallback(Z=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const J=k.current;if(!J)return;const I=J.getPointerPosition();if(!I)return;const W=Math.abs(I.x-o.creation.blockCreationStart.x),B=Math.abs(I.y-o.creation.blockCreationStart.y),Y=10,V=Math.max(W,Y),H=Math.max(B,Y);c({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(I.x,o.creation.blockCreationStart.x),y:Math.min(I.y,o.creation.blockCreationStart.y),width:V,height:H,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const J=k.current;if(!J)return;const I=J.getPointerPosition();if(!I)return;c({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:o.creation.arrowStart.x,startY:o.creation.arrowStart.y,endX:I.x,endY:I.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[o.creation]),D=C.useCallback(Z=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const J=k.current;if(!J)return;const I=J.getPointerPosition();if(!I)return;const W=Math.abs(I.x-o.creation.blockCreationStart.x),B=Math.abs(I.y-o.creation.blockCreationStart.y),Y=10,V=Math.max(W,Y),H=Math.max(B,Y),X=Math.min(I.x,o.creation.blockCreationStart.x)+V/2,se=Math.min(I.y,o.creation.blockCreationStart.y)+H/2,ie=dm.generateId(),ae=dm.create(X,se,V,H,ie),Q=gw.create(ie,`Word ${o.testData.blocks.length+1}`,gw.generateId(ie));c({type:"ADD_BLOCK",payload:ae}),c({type:"ADD_WORD",payload:Q}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),o.testData.blocks.length===0&&c({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const J=k.current;if(!J)return;const I=J.getPointerPosition();if(!I)return;if(Nh.validate(o.creation.arrowStart.x,o.creation.arrowStart.y,I.x,I.y,o.testData.blocks)){const W=Nh.snapToNearestBlock(o.creation.arrowStart.x,o.creation.arrowStart.y,o.testData.blocks),B=Nh.snapToNearestBlock(I.x,I.y,o.testData.blocks),Y=W?W.x:o.creation.arrowStart.x,V=W?W.y:o.creation.arrowStart.y,H=B?B.x:I.x,X=B?B.y:I.y,se=Nh.generateId(),ie=Nh.create(Y,V,H,X,W?W.blockId:null,B?B.blockId:null,se);c({type:"ADD_ARROW",payload:ie}),d("Arrow created successfully!","success")}else d("Arrow must start near a block!","error");c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[o.creation,o.testData.blocks,d]),L=C.useCallback(async()=>{console.log("🟢 [MatchingTestCreator] handleSaveTest clicked");const Z=O();if(Object.keys(Z).length>0){console.warn("⚠️ [MatchingTestCreator] Validation errors:",Z),d("Please fix validation errors before saving","error");return}try{console.log("🟢 [MatchingTestCreator] Preparing data to save...",{blocks:o.testData.blocks.length,words:o.testData.words.length,arrows:o.testData.arrows.length,imageUrl:o.ui.imageUrl?"present":"missing"}),c({type:"SET_LOADING",payload:!0});let J=o.ui.imageUrl;if(o.ui.imageUrl&&o.ui.imageUrl.startsWith("data:")){const W=await f("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:o.ui.imageUrl,folder:"matching_tests"})}),B=await W.json();if(W.ok&&B.success&&B.url)J=B.url;else throw new Error(B.message||"Upload failed")}const I=o.testData.blocks.map((W,B)=>{let Y;if(_){const X=N(W.x,W.y),se=N(W.x+W.width,W.y+W.height);Y={x:X.x,y:X.y,width:Number((se.x-X.x).toFixed(4)),height:Number((se.y-X.y).toFixed(4))}}else Y={x:Number(W.x.toFixed(4)),y:Number(W.y.toFixed(4)),width:Number(W.width.toFixed(4)),height:Number(W.height.toFixed(4))};const V=o.testData.words.find(X=>X.blockId===W.id),H=o.testData.arrows.find(X=>X.startBlock===W.id);return{question_id:B+1,word:V?.word||`Word ${B+1}`,block_coordinates:Y,has_arrow:!!H,arrow:H&&_?(()=>{const X=N(H.startX,H.startY),se=N(H.endX,H.endY),ie=X.x/_.originalWidth*100,ae=X.y/_.originalHeight*100,Q=se.x/_.originalWidth*100,le=se.y/_.originalHeight*100;return{start_x:Number(X.x.toFixed(4)),start_y:Number(X.y.toFixed(4)),end_x:Number(se.x.toFixed(4)),end_y:Number(se.y.toFixed(4)),rel_start_x:Number(ie.toFixed(4)),rel_start_y:Number(ae.toFixed(4)),rel_end_x:Number(Q.toFixed(4)),rel_end_y:Number(le.toFixed(4)),image_width:_.originalWidth,image_height:_.originalHeight,style:H.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log("🟢 [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:o.testData.blocks,words:o.testData.words,arrows:o.testData.arrows,imageUrl:J,processedQuestions:I}))}catch(J){console.error("Save error:",J),d(`Error saving test: ${J.message}`,"error")}finally{c({type:"SET_LOADING",payload:!1})}},[o.testData,o.ui.imageUrl,_,N,f,r,d,e,p]),O=C.useCallback(()=>{const Z={};return e.trim()||(Z.testName="Test name is required"),o.testData.blocks.length===0&&(Z.blocks="At least one block is required"),Z},[e,o.testData.blocks.length]),G=()=>l.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[l.jsx(tt,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"create"}),variant:o.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:"📦 Create Blocks"}),l.jsx(tt,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:o.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:"🛠️ Edit Blocks"}),l.jsx(tt,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:o.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:"🏹 Draw Arrows"}),l.jsx(tt,{onClick:F,variant:"secondary",size:"sm",children:"♻️ Reset"}),l.jsx(tt,{onClick:()=>y.current?.click(),variant:"secondary",size:"sm",children:"🖼️ Upload Image"})]}),K=()=>l.jsx(Yd,{width:E.width,height:E.height,ref:k,onMouseDown:R,onMouseMove:T,onMouseUp:D,className:o.canvas.selectedTool==="arrow"||o.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:l.jsxs(Xd,{children:[o.canvas.image&&_&&l.jsx(E6,{image:o.canvas.image,x:_.x,y:_.y,width:_.width,height:_.height}),o.testData.blocks.map(Z=>l.jsxs(gc,{ref:J=>{J&&(S.current[Z.id]=J)},draggable:o.canvas.selectedTool==="edit",x:Z.x,y:Z.y,onMouseEnter:J=>{const I=J.target.getStage()?.container();I&&(I.style.cursor=o.ui.selectedBlock?.id===Z.id?"nwse-resize":"move")},onMouseLeave:J=>{const I=J.target.getStage()?.container();I&&(I.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:Z}})},onDragEnd:J=>{const{x:I,y:W}=J.target.position();c({type:"UPDATE_BLOCK",payload:{id:Z.id,updates:{x:I,y:W}}})},onClick:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:Z}})},onTap:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:Z}})},children:[l.jsx(ri,{ref:J=>{J&&(w.current[Z.id]=J)},width:Z.width,height:Z.height,fill:Z.fill,stroke:Z.stroke,strokeWidth:Z.strokeWidth,cornerRadius:Z.cornerRadius,shadowColor:Z.shadowColor,shadowBlur:Z.shadowBlur,shadowOffset:Z.shadowOffset,shadowOpacity:Z.shadowOpacity,draggable:o.canvas.selectedTool==="edit",onDragEnd:J=>{const{x:I,y:W}=J.target.getParent().position();c({type:"UPDATE_BLOCK",payload:{id:Z.id,updates:{x:I,y:W}}})},onMouseEnter:J=>{const I=J.target.getStage()?.container();I&&(I.style.cursor=o.ui.selectedBlock?.id===Z.id?"nwse-resize":"move")},onMouseLeave:J=>{const I=J.target.getStage()?.container();I&&(I.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:J=>{const I=w.current[Z.id];if(!I)return;const W=Math.max(10,I.width()*I.scaleX()),B=Math.max(10,I.height()*I.scaleY());I.scaleX(1),I.scaleY(1),c({type:"UPDATE_BLOCK",payload:{id:Z.id,updates:{width:W,height:B}}})}}),l.jsx(jd,{x:2,y:2,text:`${o.testData.blocks.indexOf(Z)+1}`,fontSize:Math.min(12,Math.max(8,Z.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},Z.id)),l.jsx(N6,{ref:v,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(Z,J)=>({...J,width:Math.max(J.width,10),height:Math.max(J.height,10)})}),o.testData.arrows.map(Z=>l.jsx(w_,{points:[Z.startX,Z.startY,Z.endX,Z.endY],stroke:Z.stroke,fill:Z.fill,strokeWidth:Z.strokeWidth,pointerLength:Z.pointerLength,pointerWidth:Z.pointerWidth},Z.id)),o.creation.previewBlock&&l.jsx(ri,{x:o.creation.previewBlock.x,y:o.creation.previewBlock.y,width:o.creation.previewBlock.width,height:o.creation.previewBlock.height,fill:o.creation.previewBlock.fill,stroke:o.creation.previewBlock.stroke,strokeWidth:o.creation.previewBlock.strokeWidth,dash:o.creation.previewBlock.dash,opacity:o.creation.previewBlock.opacity}),o.creation.previewArrow&&l.jsx(w_,{points:[o.creation.previewArrow.startX,o.creation.previewArrow.startY,o.creation.previewArrow.endX,o.creation.previewArrow.endY],stroke:o.creation.previewArrow.stroke,fill:o.creation.previewArrow.fill,strokeWidth:o.creation.previewArrow.strokeWidth,dash:o.creation.previewArrow.dash,opacity:o.creation.previewArrow.opacity})]})}),te=C.useMemo(()=>o.testData.blocks.length===0?null:l.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full",style:{height:"min(400px, 40vh)",overflowY:"auto"},children:[l.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),l.jsx("div",{className:"space-y-2",children:o.testData.words.map(Z=>{const J=o.testData.blocks.find(I=>I.id===Z.blockId);return l.jsxs("div",{className:"p-2 bg-white rounded border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",o.testData.blocks.indexOf(J)+1]}),l.jsx("button",{onClick:()=>c({type:"DELETE_BLOCK",payload:J.id}),className:"text-red-500 hover:text-red-700 text-xs",children:"×"})]}),l.jsx("input",{type:"text",value:Z.word,onChange:I=>{const W=gw.update(o.testData.words,Z.blockId,I.target.value);c({type:"UPDATE_WORDS",payload:W})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},Z.blockId)})})]}),[o.testData.words,o.testData.blocks]);return l.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[l.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{children:l.jsx("div",{className:"mt-2 text-sm text-gray-600",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Questions:"})," ",o.testData.blocks.length," (auto-generated from blocks)"]})]})})}),l.jsx("div",{className:"flex gap-2",children:l.jsx(tt,{onClick:L,disabled:a||o.ui.isLoading,variant:"primary",children:a||o.ui.isLoading?l.jsx(Sr,{size:"sm"}):"Save Test"})})]})}),G(),l.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[l.jsx("div",{ref:m,className:"bg-white border overflow-auto",style:{minHeight:"400px",maxHeight:"calc(100vh - 200px)",height:"auto"},children:K()}),te]}),l.jsx("input",{ref:y,type:"file",accept:"image/*",onChange:A,className:"hidden"})]})},x0=C.createContext(null);function SO(e,t){return{getTheme:function(){return t??null}}}function Nl(){const e=C.useContext(x0);return e==null&&(function(t,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",t);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(8),e}function Ct(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const Go=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,kO=Go&&"documentMode"in document?document.documentMode:null,vl=Go&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Jd=Go&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),$1=!(!Go||!("InputEvent"in window)||kO)&&"getTargetRanges"in new window.InputEvent("input"),Jm=Go&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),n0=Go&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,CO=Go&&/Android/.test(navigator.userAgent),A6=Go&&/^(?=.*Chrome).*/i.test(navigator.userAgent),u4=Go&&CO&&A6,W1=Go&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!A6;function j6(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}const TO=1,EO=3,NO=9,AO=11,Qd=0,F6=1,s0=2,jO=0,FO=1,PO=2,z1=4,H1=8,ab=128,DO=1792|(112|(3|z1|H1)|ab),ib=1,ob=2,lb=3,cb=4,ub=5,db=6,Fy=Jm||n0||W1?" ":"​",Sc=`

`,RO=Jd?" ":Fy,Zd={bold:1,capitalize:1024,code:16,highlight:ab,italic:2,lowercase:256,strikethrough:z1,subscript:32,superscript:64,underline:H1,uppercase:512},IO={directionless:1,unmergeable:2},d4={center:ob,end:db,justify:cb,left:ib,right:lb,start:ub},MO={[ob]:"center",[db]:"end",[cb]:"justify",[ib]:"left",[lb]:"right",[ub]:"start"},LO={normal:0,segmented:2,token:1},OO={[jO]:"normal",[PO]:"segmented",[FO]:"token"},f4="$config";function P6(e,t,r,n,s,a){let i=e.getFirstChild();for(;i!==null;){const o=i.__key;i.__parent===t&&(ft(i)&&P6(i,o,r,n,s,a),r.has(o)||a.delete(o),s.push(o)),i=i.getNextSibling()}}const BO=100;let b_=!1,fb=0;function UO(e){fb=e.timeStamp}function mw(e,t,r){const n=e.nodeName==="BR",s=t.__lexicalLineBreak;return s&&(e===s||n&&e.previousSibling===s)||n&&$y(e,r)!==void 0}function $O(e,t,r){const n=zo(go(r));let s=null,a=null;n!==null&&n.anchorNode===e&&(s=n.anchorOffset,a=n.focusOffset);const i=e.nodeValue;i!==null&&Pb(t,i,s,a,!1)}function WO(e,t,r){if(yt(e)){const n=e.anchor.getNode();if(n.is(r)&&e.format!==n.getFormat())return!1}return Tc(t)&&r.isAttached()}function zO(e,t,r,n){for(let s=e;s&&!zB(s);s=Dp(s)){const a=$y(s,t);if(a!==void 0){const i=Ts(a,r);if(i)return Qr(i)||!jn(s)?void 0:[s,i]}else if(s===n)return[n,NA(r)]}}function D6(e,t,r){b_=!0;const n=performance.now()-fb>BO;try{Pi(e,(()=>{const s=Rt()||(function(m){return m.getEditorState().read((()=>{const y=Rt();return y!==null?y.clone():null}))})(e),a=new Map,i=e.getRootElement(),o=e._editorState,c=e._blockCursorElement;let d=!1,f="";for(let m=0;m<t.length;m++){const y=t[m],v=y.type,w=y.target,S=zO(w,e,o,i);if(!S)continue;const[E,k]=S;if(v==="characterData")n&&It(k)&&Tc(w)&&WO(s,w,k)&&$O(w,k,e);else if(v==="childList"){d=!0;const _=y.addedNodes;for(let A=0;A<_.length;A++){const R=_[A],T=TA(R),D=R.parentNode;if(D!=null&&R!==c&&T===null&&!mw(R,D,e)){if(Jd){const L=(jn(R)?R.innerText:null)||R.nodeValue;L&&(f+=L)}D.removeChild(R)}}const N=y.removedNodes,F=N.length;if(F>0){let A=0;for(let R=0;R<F;R++){const T=N[R];(mw(T,w,e)||c===T)&&(w.appendChild(T),A++)}F!==A&&a.set(E,k)}}}if(a.size>0)for(const[m,y]of a)y.reconcileObservedMutation(m,e);const p=r.takeRecords();if(p.length>0){for(let m=0;m<p.length;m++){const y=p[m],v=y.addedNodes,w=y.target;for(let S=0;S<v.length;S++){const E=v[S],k=E.parentNode;k==null||E.nodeName!=="BR"||mw(E,w,e)||k.removeChild(E)}}r.takeRecords()}s!==null&&(d&&ya(s),Jd&&PA(e)&&s.insertRawText(f))}))}finally{b_=!1}}function R6(e){const t=e._observer;t!==null&&D6(e,t.takeRecords(),t)}function I6(e){(function(t){fb===0&&go(t).addEventListener("textInput",UO,!0)})(e),e._observer=new MutationObserver(((t,r)=>{D6(e,t,r)}))}function HO(e){const t=new Map,r=new Set;for(let n=typeof e=="function"?e:e.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=Lb(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,t.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:t}}let GO=class M6{constructor(t,r,n=void 0,s=new Map,a=void 0){this.node=t,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,o=a!==void 0?a:(function(c,d,f){let p=f.size;if(d)for(const m in d){const y=c.get(m);y&&f.has(y)||p++}return p})(i,n,s);this.size=o}getValue(t){const r=this.knownState.get(t);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(t.key,t);let n=t.defaultValue;if(this.unknownState&&t.key in this.unknownState){const s=this.unknownState[t.key];s!==void 0&&(n=t.parse(s)),this.updateFromKnown(t,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const t={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete t[n.key]:t[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in t&&(r[n]=t[n],delete t[n]);return h4(t)&&(r.$=t),r}getWritable(t){if(this.node===t)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new M6(t,r,(function(a,i,o){let c;if(o)for(const[d,f]of Object.entries(o)){const p=a.get(d);p?i.has(p)||i.set(p,p.parse(f)):(c=c||{},c[d]=f)}return c})(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(t,r){const n=t.key;this.sharedNodeState.sharedConfigMap.set(n,t);const{knownState:s,unknownState:a}=this;s.has(t)||a&&n in a||(a&&(delete a[n],this.unknownState=h4(a)),this.size++),s.set(t,r)}updateFromUnknown(t,r){const n=this.sharedNodeState.sharedConfigMap.get(t);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},t in this.unknownState||this.size++,this.unknownState[t]=r)}updateFromJSON(t){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,t)for(const[n,s]of Object.entries(t))this.updateFromUnknown(n,s)}};function VO(e){const t=e.getWritable(),r=t.__state?t.__state.getWritable(t):new GO(t,L6(t));return t.__state=r,r}function L6(e){return e.__state?e.__state.sharedNodeState:SA(Rp(),e.getType()).sharedNodeState}function h4(e){if(e)for(const t in e)return e}function g4(e,t,r){for(const[n,s]of t.knownState){if(e.has(n.key))continue;e.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function m4(e,t,r){const{unknownState:n}=t,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!e.has(a)&&(e.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function p4(e,t){const r=e.__state;return r&&r.node===e?r.getWritable(t):r}function x4(e,t){const r=e.__mode,n=e.__format,s=e.__style,a=t.__mode,i=t.__format,o=t.__style,c=e.__state,d=t.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===o)&&(e.__state===null||c===d||(function(f,p){if(f===p)return!0;if(f&&p&&f.size!==p.size)return!1;const m=new Set;return!(f&&g4(m,f,p)||p&&g4(m,p,f)||f&&m4(m,f,p)||p&&m4(m,p,f))})(c,d))}function y4(e,t){const r=e.mergeWithSibling(t),n=Hn()._normalizedNodes;return n.add(e.__key),n.add(t.__key),r}function v4(e){let t,r,n=e;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(t=n.getPreviousSibling())!==null&&It(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(t.__text!==""){if(x4(t,n)){n=y4(t,n);break}break}t.remove()}for(;(r=n.getNextSibling())!==null&&It(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(x4(n,r)){n=y4(n,r);break}break}r.remove()}}else n.remove()}function G1(e){return w4(e.anchor),w4(e.focus),e}function w4(e){for(;e.type==="element";){const t=e.getNode(),r=e.offset;let n,s;if(r===t.getChildrenSize()?(n=t.getChildAtIndex(r-1),s=!0):(n=t.getChildAtIndex(r),s=!1),It(n)){e.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!ft(n))break;e.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let ef,Ra,Qm,Py,S_,k_,tf,Bo,C_,Zm,Rs="",xl=null,yl="",dc="",Ah=!1,V1=!1;function K1(e,t){const r=tf.get(e);if(t!==null){const n=A_(e);n.parentNode===t&&t.removeChild(n)}if(Bo.has(e)||Ra._keyToDOMMap.delete(e),ft(r)){const n=X1(r,tf);T_(n,0,n.length-1,null)}r!==void 0&&Db(Zm,Qm,Py,r,"destroyed")}function T_(e,t,r,n){let s=t;for(;s<=r;++s){const a=e[s];a!==void 0&&K1(a,n)}}function Ed(e,t){e.setProperty("text-align",t)}const KO="40px";function O6(e,t){const r=ef.theme.indent;if(typeof r=="string"){const s=e.classList.contains(r);t>0&&!s?e.classList.add(r):t<1&&s&&e.classList.remove(r)}const n=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||KO;e.style.setProperty("padding-inline-start",t===0?"":`calc(${t} * ${n})`)}function B6(e,t){const r=e.style;t===0?Ed(r,""):t===ib?Ed(r,"left"):t===ob?Ed(r,"center"):t===lb?Ed(r,"right"):t===cb?Ed(r,"justify"):t===ub?Ed(r,"start"):t===db&&Ed(r,"end")}function E_(e,t){const r=(function(n){const s=n.__dir;if(s!==null)return s;if(Ls(n))return null;const a=n.getParentOrThrow();return Ls(a)&&a.__dir===null?"auto":null})(t);r!==null?e.dir=r:e.removeAttribute("dir")}function q1(e,t){const r=Bo.get(e);r===void 0&&Ct(60);const n=r.createDOM(ef,Ra);if((function(s,a,i){const o=i._keyToDOMMap;(function(c,d,f){const p=`__lexicalKey_${d._key}`;c[p]=f})(a,i,s),o.set(s,a)})(e,n,Ra),It(r)?n.setAttribute("data-lexical-text","true"):Qr(r)&&n.setAttribute("data-lexical-decorator","true"),ft(r)){const s=r.__indent,a=r.__size;if(E_(n,r),s!==0&&O6(n,s),a!==0){const o=a-1;N_(X1(r,Bo),r,0,o,r.getDOMSlot(n))}const i=r.__format;i!==0&&B6(n,i),r.isInline()||U6(null,r,n),Wy(r)&&(Rs+=Sc,dc+=Sc)}else{const s=r.getTextContent();if(Qr(r)){const a=r.decorate(Ra,ef);a!==null&&$6(e,a),n.contentEditable="false"}Rs+=s,dc+=s}return t!==null&&t.insertChild(n),Db(Zm,Qm,Py,r,"created"),n}function N_(e,t,r,n,s){const a=Rs;Rs="";let i=r;for(;i<=n;++i){q1(e[i],s);const o=Bo.get(e[i]);o!==null&&It(o)&&(xl===null&&(xl=o.getFormat()),yl===""&&(yl=o.getStyle()))}Wy(t)&&(Rs+=Sc),s.element.__lexicalTextContent=Rs,Rs=a+Rs}function _4(e,t){if(e){const r=e.__last;if(r){const n=t.get(r);if(n)return xc(n)?"line-break":Qr(n)&&n.isInline()?"decorator":null}return"empty"}return null}function U6(e,t,r){const n=_4(e,tf),s=_4(t,Bo);n!==s&&t.getDOMSlot(r).setManagedLineBreak(s)}function qO(e,t,r){var n;xl=null,yl="",(function(s,a,i){const o=Rs,c=s.__size,d=a.__size;Rs="";const f=i.element;if(c===1&&d===1){const p=s.__first,m=a.__first;if(p===m)vm(p,f);else{const v=A_(p),w=q1(m,null);try{f.replaceChild(w,v)}catch(S){if(typeof S=="object"&&S!=null){const E=`${S.toString()} Parent: ${f.tagName}, new child: {tag: ${w.tagName} key: ${m}}, old child: {tag: ${v.tagName}, key: ${p}}.`;throw new Error(E)}throw S}K1(p,null)}const y=Bo.get(m);It(y)&&(xl===null&&(xl=y.getFormat()),yl===""&&(yl=y.getStyle()))}else{const p=X1(s,tf),m=X1(a,Bo);if(p.length!==c&&Ct(227),m.length!==d&&Ct(228),c===0)d!==0&&N_(m,a,0,d-1,i);else if(d===0){if(c!==0){const y=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;T_(p,0,c-1,y?null:f),y&&(f.textContent="")}}else(function(y,v,w,S,E,k){const _=S-1,N=E-1;let F,A,R=k.getFirstChild(),T=0,D=0;for(;T<=_&&D<=N;){const G=v[T],K=w[D];if(G===K)R=pw(vm(K,k.element)),T++,D++;else{F===void 0&&(F=new Set(v)),A===void 0&&(A=new Set(w));const Z=A.has(G),J=F.has(K);if(Z)if(J){const I=rf(Ra,K);I===R?R=pw(vm(K,k.element)):(k.withBefore(R).insertChild(I),vm(K,k.element)),T++,D++}else q1(K,k.withBefore(R)),D++;else R=pw(A_(G)),K1(G,k.element),T++}const te=Bo.get(K);te!==null&&It(te)&&(xl===null&&(xl=te.getFormat()),yl===""&&(yl=te.getStyle()))}const L=T>_,O=D>N;if(L&&!O){const G=w[N+1],K=G===void 0?null:Ra.getElementByKey(G);N_(w,y,D,N,k.withBefore(K))}else O&&!L&&T_(v,T,_,k.element)})(a,p,m,c,d,i)}Wy(a)&&(Rs+=Sc),f.__lexicalTextContent=Rs,Rs=o+Rs})(e,t,t.getDOMSlot(r)),n=t,xl==null||xl===n.__textFormat||V1||n.setTextFormat(xl),(function(s){yl===""||yl===s.__textStyle||V1||s.setTextStyle(yl)})(t)}function X1(e,t){const r=[];let n=e.__first;for(;n!==null;){const s=t.get(n);s===void 0&&Ct(101),r.push(n),n=s.__next}return r}function vm(e,t){const r=tf.get(e);let n=Bo.get(e);r!==void 0&&n!==void 0||Ct(61);const s=Ah||k_.has(e)||S_.has(e),a=rf(Ra,e);if(r===n&&!s){if(ft(r)){const i=a.__lexicalTextContent;i!==void 0&&(Rs+=i,dc+=i)}else{const i=r.getTextContent();dc+=i,Rs+=i}return a}if(r!==n&&s&&Db(Zm,Qm,Py,n,"updated"),n.updateDOM(r,a,ef)){const i=q1(e,null);return t===null&&Ct(62),t.replaceChild(i,a),K1(e,null),i}if(ft(r)&&ft(n)){const i=n.__indent;(Ah||i!==r.__indent)&&O6(a,i);const o=n.__format;if((Ah||o!==r.__format)&&B6(a,o),s&&(qO(r,n,a),Ls(n)||n.isInline()||U6(r,n,a)),Wy(n)&&(Rs+=Sc,dc+=Sc),(Ah||n.__dir!==r.__dir)&&(E_(a,n),Ls(n)&&!Ah))for(const c of n.getChildren())ft(c)&&E_(rf(Ra,c.getKey()),c)}else{const i=n.getTextContent();if(Qr(n)){const o=n.decorate(Ra,ef);o!==null&&$6(e,o)}Rs+=i,dc+=i}if(!V1&&Ls(n)&&n.__cachedText!==dc){const i=n.getWritable();i.__cachedText=dc,n=i}return a}function $6(e,t){let r=Ra._pendingDecorators;const n=Ra._decorators;if(r===null){if(n[e]===t)return;r=EA(Ra)}r[e]=t}function pw(e){let t=e.nextSibling;return t!==null&&t===Ra._blockCursorElement&&(t=t.nextSibling),t}function XO(e,t,r,n,s,a){Rs="",dc="",Ah=n===s0,Ra=r,ef=r._config,Qm=r._nodes,Py=Ra._listeners.mutation,S_=s,k_=a,tf=e._nodeMap,Bo=t._nodeMap,V1=t._readOnly,C_=new Map(r._keyToDOMMap);const i=new Map;return Zm=i,vm("root",null),Ra=void 0,Qm=void 0,S_=void 0,k_=void 0,tf=void 0,Bo=void 0,ef=void 0,C_=void 0,Zm=void 0,i}function A_(e){const t=C_.get(e);return t===void 0&&Ct(75,e),t}function dr(e){return{type:e}}const W6=dr("SELECTION_CHANGE_COMMAND"),YO=dr("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),hb=dr("CLICK_COMMAND"),Wd=dr("DELETE_CHARACTER_COMMAND"),zh=dr("INSERT_LINE_BREAK_COMMAND"),ep=dr("INSERT_PARAGRAPH_COMMAND"),Hh=dr("CONTROLLED_TEXT_INSERTION_COMMAND"),gb=dr("PASTE_COMMAND"),j_=dr("REMOVE_TEXT_COMMAND"),tp=dr("DELETE_WORD_COMMAND"),rp=dr("DELETE_LINE_COMMAND"),Da=dr("FORMAT_TEXT_COMMAND"),mb=dr("UNDO_COMMAND"),pb=dr("REDO_COMMAND"),JO=dr("KEYDOWN_COMMAND"),z6=dr("KEY_ARROW_RIGHT_COMMAND"),QO=dr("MOVE_TO_END"),H6=dr("KEY_ARROW_LEFT_COMMAND"),ZO=dr("MOVE_TO_START"),G6=dr("KEY_ARROW_UP_COMMAND"),V6=dr("KEY_ARROW_DOWN_COMMAND"),Y1=dr("KEY_ENTER_COMMAND"),K6=dr("KEY_SPACE_COMMAND"),q6=dr("KEY_BACKSPACE_COMMAND"),X6=dr("KEY_ESCAPE_COMMAND"),Y6=dr("KEY_DELETE_COMMAND"),J6=dr("KEY_TAB_COMMAND"),eB=dr("INSERT_TAB_COMMAND"),tB=dr("INDENT_CONTENT_COMMAND"),b4=dr("OUTDENT_CONTENT_COMMAND"),Q6=dr("DROP_COMMAND"),Z6=dr("FORMAT_ELEMENT_COMMAND"),eA=dr("DRAGSTART_COMMAND"),tA=dr("DRAGOVER_COMMAND"),rB=dr("DRAGEND_COMMAND"),Dy=dr("COPY_COMMAND"),xb=dr("CUT_COMMAND"),F_=dr("SELECT_ALL_COMMAND"),nB=dr("CLEAR_EDITOR_COMMAND"),sB=dr("CLEAR_HISTORY_COMMAND"),r1=dr("CAN_REDO_COMMAND"),n1=dr("CAN_UNDO_COMMAND"),aB=dr("FOCUS_COMMAND"),iB=dr("BLUR_COMMAND"),oB=dr("KEY_MODIFIER_COMMAND"),oc=Object.freeze({}),P_=30,D_=[["keydown",function(e,t){if(Am=e.timeStamp,rA=e.key,!t.isComposing()&&!qt(t,JO,e)&&e.key!=null){if(xw&&Y4(e))return Pi(t,(()=>{s1(t,yw)})),xw=!1,void(yw="");if((function(r){return an(r,"ArrowRight",{shiftKey:"any"})})(e))qt(t,z6,e);else if((function(r){return an(r,"ArrowRight",cc)})(e))qt(t,QO,e);else if((function(r){return an(r,"ArrowLeft",{shiftKey:"any"})})(e))qt(t,H6,e);else if((function(r){return an(r,"ArrowLeft",cc)})(e))qt(t,ZO,e);else if((function(r){return an(r,"ArrowUp",{altKey:"any",shiftKey:"any"})})(e))qt(t,G6,e);else if((function(r){return an(r,"ArrowDown",{altKey:"any",shiftKey:"any"})})(e))qt(t,V6,e);else if((function(r){return an(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})})(e))jm=!0,qt(t,Y1,e);else if((function(r){return r.key===" "})(e))qt(t,K6,e);else if((function(r){return vl&&an(r,"o",{ctrlKey:!0})})(e))e.preventDefault(),jm=!0,qt(t,zh,!0);else if((function(r){return an(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})})(e))jm=!1,qt(t,Y1,e);else if((function(r){return an(r,"Backspace",{shiftKey:"any"})||vl&&an(r,"h",{ctrlKey:!0})})(e))Y4(e)?qt(t,q6,e):(e.preventDefault(),qt(t,Wd,!0));else if((function(r){return r.key==="Escape"})(e))qt(t,X6,e);else if((function(r){return an(r,"Delete",{})||vl&&an(r,"d",{ctrlKey:!0})})(e))(function(r){return r.key==="Delete"})(e)?qt(t,Y6,e):(e.preventDefault(),qt(t,Wd,!1));else if((function(r){return an(r,"Backspace",X4)})(e))e.preventDefault(),qt(t,tp,!0);else if((function(r){return an(r,"Delete",X4)})(e))e.preventDefault(),qt(t,tp,!1);else if((function(r){return vl&&an(r,"Backspace",{metaKey:!0})})(e))e.preventDefault(),qt(t,rp,!0);else if((function(r){return vl&&(an(r,"Delete",{metaKey:!0})||an(r,"k",{ctrlKey:!0}))})(e))e.preventDefault(),qt(t,rp,!1);else if((function(r){return an(r,"b",cc)})(e))e.preventDefault(),qt(t,Da,"bold");else if((function(r){return an(r,"u",cc)})(e))e.preventDefault(),qt(t,Da,"underline");else if((function(r){return an(r,"i",cc)})(e))e.preventDefault(),qt(t,Da,"italic");else if((function(r){return an(r,"Tab",{shiftKey:"any"})})(e))qt(t,J6,e);else if((function(r){return an(r,"z",cc)})(e))e.preventDefault(),qt(t,mb,void 0);else if((function(r){return vl?an(r,"z",{metaKey:!0,shiftKey:!0}):an(r,"y",{ctrlKey:!0})||an(r,"z",{ctrlKey:!0,shiftKey:!0})})(e))e.preventDefault(),qt(t,pb,void 0);else{const r=t._editorState._selection;r===null||yt(r)?J4(e)&&(e.preventDefault(),qt(t,F_,e)):(function(n){return an(n,"c",cc)})(e)?(e.preventDefault(),qt(t,Dy,e)):(function(n){return an(n,"x",cc)})(e)?(e.preventDefault(),qt(t,xb,e)):J4(e)&&(e.preventDefault(),qt(t,F_,e))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(e)&&qt(t,oB,e)}}],["pointerdown",function(e,t){const r=e.target,n=e.pointerType;_0(r)&&n!=="touch"&&n!=="pen"&&e.button===0&&Pi(t,(()=>{V4(r)||(I_=!0)}))}],["compositionstart",function(e,t){Pi(t,(()=>{const r=Rt();if(yt(r)&&!t.isComposing()){const n=r.anchor,s=r.anchor.getNode();ma(n.key),(e.timeStamp<Am+P_||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||It(s)&&s.getStyle()!==r.style)&&qt(t,Hh,RO)}}))}],["compositionend",function(e,t){Jd?fm=!0:n0||!Jm&&!W1?Pi(t,(()=>{s1(t,e.data)})):(xw=!0,yw=e.data)}],["input",function(e,t){e.stopPropagation(),Pi(t,(()=>{if(jn(e.target)&&V4(e.target))return;const r=Rt(),n=e.data,s=oA(e);if(n!=null&&yt(r)&&aA(r,s,n,e.timeStamp,!1)){fm&&(s1(t,n),fm=!1);const a=r.anchor.getNode(),i=zo(go(t));if(i===null)return;const o=r.isBackward(),c=o?r.anchor.offset:r.focus.offset,d=o?r.focus.offset:r.anchor.offset;$1&&!r.isCollapsed()&&It(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,c)+n+a.getTextContent().slice(c+d)===FA(i.anchorNode)||qt(t,Hh,n);const f=n.length;Jd&&f>1&&e.inputType==="insertCompositionText"&&!t.isComposing()&&(r.anchor.offset-=f),Jm||n0||W1||!t.isComposing()||(Am=0,ma(null))}else Fb(!1,t,n!==null?n:void 0),fm&&(s1(t,n||void 0),fm=!1);(function(){ga();const a=Hn();R6(a)})()}),{event:e}),jh=null}],["click",function(e,t){Pi(t,(()=>{const r=Rt(),n=zo(go(t)),s=w0();if(n){if(yt(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!Ls(i)&&On().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(e.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const o=(function(c,d){let f=c;for(;f!==On()&&f!=null;){if(d(f))return f;f=f.getParent()}return null})(i,(c=>ft(c)&&!c.isInline()));ft(o)&&o.select(0)}}else if(e.pointerType==="touch"||e.pointerType==="pen"){const a=n.anchorNode;(jn(a)||Tc(a))&&ya(wb(s,n,t,e))}}qt(t,hb,e)}))}],["cut",oc],["copy",oc],["dragstart",oc],["dragover",oc],["dragend",oc],["paste",oc],["focus",oc],["blur",oc],["drop",oc]];$1&&D_.push(["beforeinput",(e,t)=>(function(r,n){const s=r.inputType,a=oA(r);s==="deleteCompositionText"||Jd&&PA(n)||s!=="insertCompositionText"&&Pi(n,(()=>{const i=Rt();if(s==="deleteContentBackward"){if(i===null){const y=w0();if(!yt(y))return;ya(y.clone())}if(yt(i)){const y=i.anchor.key===i.focus.key;if(o=r.timeStamp,rA==="MediaLast"&&o<Am+P_&&n.isComposing()&&y){if(ma(null),Am=0,setTimeout((()=>{Pi(n,(()=>{ma(null)}))}),P_),yt(i)){const v=i.anchor.getNode();v.markDirty(),It(v)||Ct(142),iA(i,v)}}else{ma(null),r.preventDefault();const v=i.anchor.getNode(),w=v.getTextContent(),S=v.canInsertTextAfter(),E=i.anchor.offset===0&&i.focus.offset===w.length;let k=u4&&y&&!E&&S;if(k&&i.isCollapsed()&&(k=!Qr(U_(i.anchor,!0))),!k){qt(n,Wd,!0);const _=Rt();u4&&yt(_)&&_.isCollapsed()&&(Fd=_,setTimeout((()=>Fd=null)))}}return}}var o;if(!yt(i))return;const c=r.data;jh!==null&&Fb(!1,n,jh),i.dirty&&jh===null||!i.isCollapsed()||Ls(i.anchor.getNode())||a===null||i.applyDOMRange(a),jh=null;const d=i.anchor,f=i.focus,p=d.getNode(),m=f.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":qt(n,Hh,r);break;case"insertFromComposition":ma(null),qt(n,Hh,r);break;case"insertLineBreak":ma(null),qt(n,zh,!1);break;case"insertParagraph":ma(null),jm&&!n0?(jm=!1,qt(n,zh,!1)):qt(n,ep,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":qt(n,gb,r);break;case"deleteByComposition":(function(y,v){return y!==v||ft(y)||ft(v)||!zd(y)||!zd(v)})(p,m)&&qt(n,j_,r);break;case"deleteByDrag":case"deleteByCut":qt(n,j_,r);break;case"deleteContent":qt(n,Wd,!1);break;case"deleteWordBackward":qt(n,tp,!0);break;case"deleteWordForward":qt(n,tp,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":qt(n,rp,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":qt(n,rp,!1);break;case"formatStrikeThrough":qt(n,Da,"strikethrough");break;case"formatBold":qt(n,Da,"bold");break;case"formatItalic":qt(n,Da,"italic");break;case"formatUnderline":qt(n,Da,"underline");break;case"historyUndo":qt(n,mb,void 0);break;case"historyRedo":qt(n,pb,void 0)}else{if(c===`
`)r.preventDefault(),qt(n,zh,!1);else if(c===Sc)r.preventDefault(),qt(n,ep,void 0);else if(c==null&&r.dataTransfer){const y=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(y)}else c!=null&&aA(i,a,c,r.timeStamp,!0)?(r.preventDefault(),qt(n,Hh,c)):jh=c;nA=r.timeStamp}}))})(e,t)]);let Am=0,rA=null,nA=0,jh=null;const J1=new WeakMap;let R_=!1,I_=!1,jm=!1,fm=!1,xw=!1,yw="",Fd=null,sA=[0,"",0,"root",0];function aA(e,t,r,n,s){const a=e.anchor,i=e.focus,o=a.getNode(),c=Hn(),d=zo(go(c)),f=d!==null?d.anchorNode:null,p=a.key,m=c.getElementByKey(p),y=r.length;return p!==i.key||!It(o)||(!s&&(!$1||nA<n+50)||o.isDirty()&&y<2||AA(r))&&a.offset!==i.offset&&!o.isComposing()||uc(o)||o.isDirty()&&y>1||(s||!$1)&&m!==null&&!o.isComposing()&&f!==a0(m)||d!==null&&t!==null&&(!t.collapsed||t.startContainer!==d.anchorNode||t.startOffset!==d.anchorOffset)||o.getFormat()!==e.format||o.getStyle()!==e.style||(function(v,w){if(w.isSegmented())return!0;if(!v.isCollapsed())return!1;const S=v.anchor.offset,E=w.getParentOrThrow(),k=zd(w);return S===0?!w.canInsertTextBefore()||!E.canInsertTextBefore()&&!w.isComposing()||k||(function(_){const N=_.getPreviousSibling();return(It(N)||ft(N)&&N.isInline())&&!N.canInsertTextAfter()})(w):S===w.getTextContentSize()&&(!w.canInsertTextAfter()||!E.canInsertTextAfter()&&!w.isComposing()||k)})(e,o)}function S4(e,t){return Tc(e)&&e.nodeValue!==null&&t!==0&&t!==e.nodeValue.length}function k4(e,t,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=e;R_&&(R_=!1,S4(n,s)&&S4(a,i)&&!Fd)||Pi(t,(()=>{if(!r)return void ya(null);if(!Pp(t,n,a))return;let o=Rt();if(Fd&&yt(o)&&o.isCollapsed()){const c=o.anchor,d=Fd.anchor;(c.key===d.key&&c.offset===d.offset+1||c.offset===1&&d.getNode().is(c.getNode().getPreviousSibling()))&&(o=Fd.clone(),ya(o))}if(Fd=null,yt(o)){const c=o.anchor,d=c.getNode();if(o.isCollapsed()){e.type==="Range"&&e.anchorNode===e.focusNode&&(o.dirty=!0);const f=go(t).event,p=f?f.timeStamp:performance.now(),[m,y,v,w,S]=sA,E=On(),k=t.isComposing()===!1&&E.getTextContent()==="";if(p<S+200&&c.offset===v&&c.key===w)A1(o,m,y);else if(c.type==="text")It(d)||Ct(141),iA(o,d);else if(c.type==="element"&&!k){ft(d)||Ct(259);const _=c.getNode();_.isEmpty()?(function(N,F){const A=F.getTextFormat(),R=F.getTextStyle();A1(N,A,R)})(o,_):A1(o,0,"")}}else{const f=c.key,p=o.focus.key,m=o.getNodes(),y=m.length,v=o.isBackward(),w=v?i:s,S=v?s:i,E=v?p:f,k=v?f:p;let _=DO,N=!1;for(let F=0;F<y;F++){const A=m[F],R=A.getTextContentSize();if(It(A)&&R!==0&&!(F===0&&A.__key===E&&w===R||F===y-1&&A.__key===k&&S===0)&&(N=!0,_&=A.getFormat(),_===0))break}o.format=N?_:0}}qt(t,W6,void 0)}))}function A1(e,t,r){e.format===t&&e.style===r||(e.format=t,e.style=r,e.dirty=!0)}function iA(e,t){A1(e,t.getFormat(),t.getStyle())}function oA(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return t.length===0?null:t[0]}function s1(e,t){const r=e._compositionKey;if(ma(null),r!==null&&t!=null){if(t===""){const n=Ts(r),s=a0(e.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&It(n)&&Pb(n,s.nodeValue,null,null,!0))}if(t[t.length-1]===`
`){const n=Rt();if(yt(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void qt(e,Y1,null)}}}Fb(!0,e,t)}function lA(e){let t=e.__lexicalEventHandles;return t===void 0&&(t=[],e.__lexicalEventHandles=t),t}const Gh=new Map;function cA(e){const t=UB(e.target);if(t===null)return;const r=kA(t.anchorNode);if(r===null)return;I_&&(I_=!1,Pi(r,(()=>{const c=w0(),d=t.anchorNode;(jn(d)||Tc(d))&&ya(wb(c,t,r,e))})));const n=jb(r),s=n[n.length-1],a=s._key,i=Gh.get(a),o=i||s;o!==r&&k4(t,o,!1),k4(t,r,!0),r!==s?Gh.set(a,r):i&&Gh.delete(a)}function C4(e){e._lexicalHandled=!0}function T4(e){return e._lexicalHandled===!0}function lB(e){const t=e.ownerDocument,r=J1.get(t);if(r===void 0)return;const n=r-1;n>=0||Ct(164),J1.set(t,n),n===0&&t.removeEventListener("selectionchange",cA);const s=Uy(e);Ab(s)?((function(i){if(i._parentEditor!==null){const o=jb(i),c=o[o.length-1]._key;Gh.get(c)===i&&Gh.delete(c)}else Gh.delete(i._key)})(s),e.__lexicalEditor=null):s&&Ct(198);const a=lA(e);for(let i=0;i<a.length;i++)a[i]();e.__lexicalEventHandles=[]}function M_(e,t,r){ga();const n=e.__key,s=e.getParent();if(s===null)return;const a=(function(o){const c=Rt();if(!yt(c)||!ft(o))return c;const{anchor:d,focus:f}=c,p=d.getNode(),m=f.getNode();return $_(p,o)&&d.set(o.__key,0,"element"),$_(m,o)&&f.set(o.__key,0,"element"),c})(e);let i=!1;if(yt(a)&&t){const o=a.anchor,c=a.focus;o.key===n&&(Z1(o,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0),c.key===n&&(Z1(c,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0)}else Ea(a)&&t&&e.isSelected()&&e.selectPrevious();if(yt(a)&&t&&!i){const o=e.getIndexWithinParent();Hd(e),Q1(a,s,o,-1)}else Hd(e);r||ni(s)||s.canBeEmpty()||!s.isEmpty()||M_(s,t),t&&a&&Ls(s)&&s.isEmpty()&&s.selectEnd()}class y0{static getType(){const{ownNodeType:t}=Lb(this);return t===void 0&&Ct(64,this.name),t}static clone(t){Ct(65,this.name)}$config(){return{}}config(t,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:t}),{[t]:r}}afterCloneFrom(t){this.__key===t.__key?(this.__parent=t.__parent,this.__next=t.__next,this.__prev=t.__prev,this.__state=t.__state):t.__state&&(this.__state=t.__state.getWritable(this))}constructor(t){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),PB(this,t)}getType(){return this.__type}isInline(){Ct(137,this.constructor.name)}isAttached(){let t=this.__key;for(;t!==null;){if(t==="root")return!0;const r=Ts(t);if(r===null)break;t=r.__parent}return!1}isSelected(t){const r=t||Rt();if(r==null)return!1;const n=r.getNodes().some((s=>s.__key===this.__key));if(It(this))return n;if(yt(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(Qr(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const t=this.getParent();if(t===null)return-1;let r=t.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const t=this.getLatest().__parent;return t===null?null:Ts(t)}getParentOrThrow(){const t=this.getParent();return t===null&&Ct(66,this.__key),t}getTopLevelElement(){let t=this;for(;t!==null;){const r=t.getParent();if(ni(r))return ft(t)||t===this&&Qr(t)||Ct(194),t;t=r}return null}getTopLevelElementOrThrow(){const t=this.getTopLevelElement();return t===null&&Ct(67,this.__key),t}getParents(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r),r=r.getParent();return t}getParentKeys(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r.__key),r=r.getParent();return t}getPreviousSibling(){const t=this.getLatest().__prev;return t===null?null:Ts(t)}getPreviousSiblings(){const t=[],r=this.getParent();if(r===null)return t;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)t.push(n),n=n.getNextSibling();return t}getNextSibling(){const t=this.getLatest().__next;return t===null?null:Ts(t)}getNextSiblings(){const t=[];let r=this.getNextSibling();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getCommonAncestor(t){const r=ft(this)?this:this.getParent(),n=ft(t)?t:t.getParent(),s=r&&n?F1(r,n):null;return s?s.commonAncestor:null}is(t){return t!=null&&this.__key===t.__key}isBefore(t){const r=F1(this,t);return r!==null&&(r.type==="descendant"||(r.type==="branch"?MA(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&Ct(279),!1)))}isParentOf(t){const r=F1(this,t);return r!==null&&r.type==="ancestor"}getNodesBetween(t){const r=this.isBefore(t),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===t)break;const o=ft(a)?r?a.getFirstChild():a.getLastChild():null;if(o!==null){a=o;continue}const c=r?a.getNextSibling():a.getPreviousSibling();if(c!==null){a=c;continue}const d=a.getParentOrThrow();if(s.has(d.__key)||n.push(d),d===t)break;let f=null,p=d;do{if(p===null&&Ct(68),f=r?p.getNextSibling():p.getPreviousSibling(),p=p.getParent(),p===null)break;f!==null||s.has(p.__key)||n.push(p)}while(f===null);a=f}return r||n.reverse(),n}isDirty(){const t=Hn()._dirtyLeaves;return t!==null&&t.has(this.__key)}getLatest(){const t=Ts(this.__key);return t===null&&Ct(113),t}getWritable(){ga();const t=zu(),r=Hn(),n=t._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,o=Rt();if(o!==null&&o.setCachedNodes(null),i.has(s))return ry(a),a;const c=Ib(a);return i.add(s),ry(c),n.set(s,c),c}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(t,r){Ct(70)}updateDOM(t,r,n){Ct(71)}exportDOM(t){return{element:this.createDOM(t._config,t)}}exportJSON(){const t=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...t}}static importJSON(t){Ct(18,this.name)}updateFromJSON(t){return(function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const o of L6(s).flatKeys)o in n&&(i!==void 0&&i!==a||(i={...a}),i[o]=n[o]);return(s.__state||i)&&VO(r).updateFromJSON(i),s})(this,t)}static transform(){return null}remove(t){M_(this,!0,t)}replace(t,r){ga();let n=Rt();n!==null&&(n=n.clone()),kw(this,t);const s=this.getLatest(),a=this.__key,i=t.__key,o=t.getWritable(),c=this.getParentOrThrow().getWritable(),d=c.__size;Hd(o);const f=s.getPreviousSibling(),p=s.getNextSibling(),m=s.__prev,y=s.__next,v=s.__parent;if(M_(s,!1,!0),f===null?c.__first=i:f.getWritable().__next=i,o.__prev=m,p===null?c.__last=i:p.getWritable().__prev=i,o.__next=y,o.__parent=v,c.__size=d,r&&(ft(this)&&ft(o)||Ct(139),this.getChildren().forEach((w=>{o.append(w)}))),yt(n)){ya(n);const w=n.anchor,S=n.focus;w.key===a&&j4(w,o),S.key===a&&j4(S,o)}return bu()===a&&ma(i),o}insertAfter(t,r=!0){ga(),kw(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.getParent(),i=Rt();let o=!1,c=!1;if(a!==null){const y=t.getIndexWithinParent();if(Hd(s),yt(i)){const v=a.__key,w=i.anchor,S=i.focus;o=w.type==="element"&&w.key===v&&w.offset===y+1,c=S.type==="element"&&S.key===v&&S.offset===y+1}}const d=this.getNextSibling(),f=this.getParentOrThrow().getWritable(),p=s.__key,m=n.__next;if(d===null?f.__last=p:d.getWritable().__prev=p,f.__size++,n.__next=p,s.__next=m,s.__prev=n.__key,s.__parent=n.__parent,r&&yt(i)){const y=this.getIndexWithinParent();Q1(i,f,y+1);const v=f.__key;o&&i.anchor.set(v,y+2,"element"),c&&i.focus.set(v,y+2,"element")}return t}insertBefore(t,r=!0){ga(),kw(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.__key;Hd(s);const i=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),c=n.__prev,d=this.getIndexWithinParent();i===null?o.__first=a:i.getWritable().__next=a,o.__size++,n.__prev=a,s.__prev=c,s.__next=n.__key,s.__parent=n.__parent;const f=Rt();return r&&yt(f)&&Q1(f,this.getParentOrThrow(),d),t}isParentRequired(){return!1}createParentElementNode(){return An()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(t,r){ga();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(ft(n))return n.select();if(!It(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(t,r)}selectNext(t,r){ga();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(ft(n))return n.select(0,0);if(!It(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(t,r)}markDirty(){this.getWritable()}reconcileObservedMutation(t,r){this.markDirty()}}class Ep extends y0{static getType(){return"linebreak"}static clone(t){return new Ep(t.__key)}constructor(t){super(t)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:t=>(function(r){const n=r.parentElement;if(n!==null&&ny(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&a1(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&a1(a))return!0}}return!1})(t)||(function(r){const n=r.parentElement;if(n!==null&&ny(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&a1(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&a1(a))return!0}return!1})(t)?null:{conversion:cB,priority:0}}}static importJSON(t){return Tl().updateFromJSON(t)}}function cB(e){return{node:Tl()}}function Tl(){return ai(new Ep)}function xc(e){return e instanceof Ep}function a1(e){return Tc(e)&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function vw(e,t){return 16&t?"code":t&ab?"mark":32&t?"sub":64&t?"sup":null}function ww(e,t){return 1&t?"strong":2&t?"em":"span"}function uA(e,t,r,n,s){const a=n.classList;let i=Vh(s,"base");i!==void 0&&a.add(...i),i=Vh(s,"underlineStrikethrough");let o=!1;const c=t&H1&&t&z1;i!==void 0&&(r&H1&&r&z1?(o=!0,c||a.add(...i)):c&&a.remove(...i));for(const d in Zd){const f=Zd[d];if(i=Vh(s,d),i!==void 0)if(r&f){if(o&&(d==="underline"||d==="strikethrough")){t&f&&a.remove(...i);continue}t&f&&(!c||d!=="underline")&&d!=="strikethrough"||a.add(...i)}else t&f&&a.remove(...i)}}function dA(e,t,r){const n=t.firstChild,s=r.isComposing(),a=e+(s?Fy:"");if(n==null)t.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||Jd){const[o,c,d]=(function(f,p){const m=f.length,y=p.length;let v=0,w=0;for(;v<m&&v<y&&f[v]===p[v];)v++;for(;w+v<m&&w+v<y&&f[m-w-1]===p[y-w-1];)w++;return[v,m-v-w,p.slice(v,y-w)]})(i,a);c!==0&&n.deleteData(o,c),n.insertData(o,d)}else n.nodeValue=a}}function E4(e,t,r,n,s,a){dA(s,e,t);const i=a.theme.text;i!==void 0&&uA(0,0,n,e,i)}function i1(e,t){const r=document.createElement(t);return r.appendChild(e),r}class Wu extends y0{static getType(){return"text"}static clone(t){return new Wu(t.__text,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__text=t.__text,this.__format=t.__format,this.__style=t.__style,this.__mode=t.__mode,this.__detail=t.__detail}constructor(t="",r){super(r),this.__text=t,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const t=this.getLatest();return OO[t.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===bu()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(t){const r=Zd[t];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(t,r){return ty(this.getLatest().__format,t,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(t,r){const n=this.__format,s=vw(0,n),a=ww(0,n),i=s===null?a:s,o=document.createElement(i);let c=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),s!==null&&(c=document.createElement(a),o.appendChild(c)),E4(c,this,0,n,this.__text,t);const d=this.__style;return d!==""&&(o.style.cssText=d),o}updateDOM(t,r,n){const s=this.__text,a=t.__format,i=this.__format,o=vw(0,a),c=vw(0,i),d=ww(0,a),f=ww(0,i);if((o===null?d:o)!==(c===null?f:c))return!0;if(o===c&&d!==f){const w=r.firstChild;w==null&&Ct(48);const S=document.createElement(f);return E4(S,this,0,i,s,n),r.replaceChild(S,w),!1}let p=r;c!==null&&o!==null&&(p=r.firstChild,p==null&&Ct(49)),dA(s,p,this);const m=n.theme.text;m!==void 0&&a!==i&&uA(0,a,i,p,m);const y=t.__style,v=this.__style;return y!==v&&(r.style.cssText=v),!1}static importDOM(){return{"#text":()=>({conversion:hB,priority:0}),b:()=>({conversion:dB,priority:0}),code:()=>({conversion:lc,priority:0}),em:()=>({conversion:lc,priority:0}),i:()=>({conversion:lc,priority:0}),mark:()=>({conversion:lc,priority:0}),s:()=>({conversion:lc,priority:0}),span:()=>({conversion:uB,priority:0}),strong:()=>({conversion:lc,priority:0}),sub:()=>({conversion:lc,priority:0}),sup:()=>({conversion:lc,priority:0}),u:()=>({conversion:lc,priority:0})}}static importJSON(t){return Qn().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTextContent(t.text).setFormat(t.format).setDetail(t.detail).setMode(t.mode).setStyle(t.style)}exportDOM(t){let{element:r}=super.exportDOM(t);return jn(r)||Ct(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=i1(r,"b")),this.hasFormat("italic")&&(r=i1(r,"i")),this.hasFormat("strikethrough")&&(r=i1(r,"s")),this.hasFormat("underline")&&(r=i1(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(t,r){}setFormat(t){const r=this.getWritable();return r.__format=typeof t=="string"?Zd[t]:t,r}setDetail(t){const r=this.getWritable();return r.__detail=typeof t=="string"?IO[t]:t,r}setStyle(t){const r=this.getWritable();return r.__style=t,r}toggleFormat(t){const r=ty(this.getFormat(),t,null);return this.setFormat(r)}toggleDirectionless(){const t=this.getWritable();return t.__detail^=1,t}toggleUnmergeable(){const t=this.getWritable();return t.__detail^=2,t}setMode(t){const r=LO[t];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(t){if(this.__text===t)return this;const r=this.getWritable();return r.__text=t,r}select(t,r){ga();let n=t,s=r;const a=Rt(),i=this.getTextContent(),o=this.__key;if(typeof i=="string"){const c=i.length;n===void 0&&(n=c),s===void 0&&(s=c)}else n=0,s=0;if(!yt(a))return gA(o,n,o,s,"text","text");{const c=bu();c!==a.anchor.key&&c!==a.focus.key||ma(o),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const t=this.getTextContentSize();return this.select(t,t)}spliceText(t,r,n,s){const a=this.getWritable(),i=a.__text,o=n.length;let c=t;c<0&&(c=o+c,c<0&&(c=0));const d=Rt();if(s&&yt(d)){const p=t+o;d.setTextNodeRange(a,p,a,p)}const f=i.slice(0,c)+n+i.slice(c+r);return a.__text=f,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...t){ga();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=bu(),i=n.length;t.sort(((T,D)=>T-D)),t.push(i);const o=[],c=t.length;for(let T=0,D=0;T<i&&D<=c;D++){const L=t[D];L>T&&(o.push(n.slice(T,L)),T=L)}const d=o.length;if(d===1)return[r];const f=o[0],p=r.getParent();let m;const y=r.getFormat(),v=r.getStyle(),w=r.__detail;let S=!1,E=null,k=null;const _=Rt();if(yt(_)){const[T,D]=_.isBackward()?[_.focus,_.anchor]:[_.anchor,_.focus];T.type==="text"&&T.key===s&&(E=T),D.type==="text"&&D.key===s&&(k=D)}r.isSegmented()?(m=Qn(f),m.__format=y,m.__style=v,m.__detail=w,m.__state=p4(r,m),S=!0):m=r.setTextContent(f);const N=[m];for(let T=1;T<d;T++){const D=Qn(o[T]);D.__format=y,D.__style=v,D.__detail=w,D.__state=p4(r,D);const L=D.__key;a===s&&ma(L),N.push(D)}const F=E?E.offset:null,A=k?k.offset:null;let R=0;for(const T of N){if(!E&&!k)break;const D=R+T.getTextContentSize();if(E!==null&&F!==null&&F<=D&&F>=R&&(E.set(T.getKey(),F-R,"text"),F<D&&(E=null)),k!==null&&A!==null&&A<=D&&A>=R){k.set(T.getKey(),A-R,"text");break}R=D}if(p!==null){(function(L){const O=L.getPreviousSibling(),G=L.getNextSibling();O!==null&&ry(O),G!==null&&ry(G)})(this);const T=p.getWritable(),D=this.getIndexWithinParent();S?(T.splice(D,0,N),this.remove()):T.splice(D,1,N),yt(_)&&Q1(_,p,D,d-1)}return N}mergeWithSibling(t){const r=t===this.getPreviousSibling();r||t===this.getNextSibling()||Ct(50);const n=this.__key,s=t.__key,a=this.__text,i=a.length;bu()===s&&ma(n);const o=Rt();if(yt(o)){const p=o.anchor,m=o.focus;p!==null&&p.key===s&&L4(p,r,n,t,i),m!==null&&m.key===s&&L4(m,r,n,t,i)}const c=t.__text,d=r?c+a:a+c;this.setTextContent(d);const f=this.getWritable();return t.remove(),f}isTextEntity(){return!1}}function uB(e){return{forChild:yb(e.style),node:null}}function dB(e){const t=e,r=t.style.fontWeight==="normal";return{forChild:yb(t.style,r?void 0:"bold"),node:null}}const N4=new WeakMap;function fB(e){if(!jn(e))return!1;if(e.nodeName==="PRE")return!0;const t=e.style.whiteSpace;return typeof t=="string"&&t.startsWith("pre")}function hB(e){const t=e;e.parentElement===null&&Ct(129);let r=t.textContent||"";if((function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=N4.get(a))===void 0&&!fB(a);)i.push(a),a=a.parentNode;const o=s===void 0?a:s;for(let c=0;c<i.length;c++)N4.set(i[c],o);return o})(t)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const o=n[i];o===`
`||o===`\r
`?s.push(Tl()):o==="	"?s.push(v0()):o!==""&&s.push(Qn(o))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=t,s=!0;for(;n!==null&&(n=A4(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=t,s=!0;for(;n!==null&&(n=A4(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:Qn(r)}}function A4(e,t){let r=e;for(;;){let n;for(;(n=t?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,jn(r)){const a=r.style.display;if(a===""&&!H_(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=t?r.firstChild:r.lastChild)!==null;)r=s;if(Tc(r))return r;if(r.nodeName==="BR")return null}}const gB={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function lc(e){const t=gB[e.nodeName.toLowerCase()];return t===void 0?{node:null}:{forChild:yb(e.style,t),node:null}}function Qn(e=""){return ai(new Wu(e))}function It(e){return e instanceof Wu}function yb(e,t){const r=e.fontWeight,n=e.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=e.fontStyle==="italic",o=n.includes("underline"),c=e.verticalAlign;return d=>(It(d)&&(s&&!d.hasFormat("bold")&&d.toggleFormat("bold"),a&&!d.hasFormat("strikethrough")&&d.toggleFormat("strikethrough"),i&&!d.hasFormat("italic")&&d.toggleFormat("italic"),o&&!d.hasFormat("underline")&&d.toggleFormat("underline"),c!=="sub"||d.hasFormat("subscript")||d.toggleFormat("subscript"),c!=="super"||d.hasFormat("superscript")||d.toggleFormat("superscript"),t&&!d.hasFormat(t)&&d.toggleFormat(t)),d)}class Np extends Wu{static getType(){return"tab"}static clone(t){return new Np(t.__key)}constructor(t){super("	",t),this.__detail=2}static importDOM(){return null}createDOM(t){const r=super.createDOM(t),n=Vh(t.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(t){return v0().updateFromJSON(t)}setTextContent(t){return t!=="	"&&t!==""&&Ct(126),super.setTextContent("	")}spliceText(t,r,n,s){return n===""&&r===0||n==="	"&&r===1||Ct(286),this}setDetail(t){return t!==2&&Ct(127),this}setMode(t){return t!=="normal"&&Ct(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function v0(){return ai(new Np)}function Ry(e){return e instanceof Np}class mB{constructor(t,r,n){this._selection=null,this.key=t,this.offset=r,this.type=n}is(t){return this.key===t.key&&this.offset===t.offset&&this.type===t.type}isBefore(t){return this.key===t.key?this.offset<t.offset:IA(uo(kc(this,"next")),uo(kc(t,"next")))<0}getNode(){const t=Ts(this.key);return t===null&&Ct(20),t}set(t,r,n,s){const a=this._selection,i=this.key;s&&this.key===t&&this.offset===r&&this.type===n||(this.key=t,this.offset=r,this.type=n,Ap()||(bu()===i&&ma(t),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function El(e,t,r){return new mB(e,t,r)}function _w(e,t){let r=t.__key,n=e.offset,s="element";if(It(t)){s="text";const a=t.getTextContentSize();n>a&&(n=a)}else if(!ft(t)){const a=t.getNextSibling();if(It(a))r=a.__key,n=0,s="text";else{const i=t.getParent();i&&(r=i.__key,n=t.getIndexWithinParent()+1)}}e.set(r,n,s)}function j4(e,t){if(ft(t)){const r=t.getLastDescendant();ft(r)||It(r)?_w(e,r):_w(e,t)}else _w(e,t)}class Iy{constructor(t){this._cachedNodes=null,this._nodes=t,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){if(!Ea(t))return!1;const r=this._nodes,n=t._nodes;return r.size===n.size&&Array.from(r).every((s=>n.has(s)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(t){this.dirty=!0,this._nodes.add(t),this._cachedNodes=null}delete(t){this.dirty=!0,this._nodes.delete(t),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(t){return this._nodes.has(t)}clone(){return new Iy(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(t){}insertText(){}insertNodes(t){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(It(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(t);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=this._nodes,n=[];for(const s of r){const a=Ts(s);a!==null&&n.push(a)}return Ap()||(this._cachedNodes=n),n}getTextContent(){const t=this.getNodes();let r="";for(let n=0;n<t.length;n++)r+=t[n].getTextContent();return r}deleteNodes(){const t=this.getNodes();if((Rt()||w0())===this&&t[0]){const r=xa(t[0],"next");ZB(Ru(r,r))}for(const r of t)r.remove()}}function yt(e){return e instanceof pf}class pf{constructor(t,r,n,s){this.anchor=t,this.focus=r,t._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){return!!yt(t)&&this.anchor.is(t.anchor)&&this.focus.is(t.focus)&&this.format===t.format&&this.style===t.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=(function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const o=new Set,c=new Set;for(const d of n)if(Cl(d)){const{origin:f}=d;s.length===0?o.add(f):(c.add(f),s.push(f))}else{const{origin:f}=d;ft(f)&&c.has(f)||s.push(f)}if(i&&s.push(i.caret.origin),af(n.focus)&&ft(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let d=mo(n.focus.origin,"previous");Cl(d)&&o.has(d.origin)&&!d.origin.isEmpty()&&d.origin.is(s[s.length-1]);d=Ub(d))o.delete(d.origin),s.pop();for(;s.length>1;){const d=s[s.length-1];if(!ft(d)||c.has(d)||d.isEmpty()||o.has(d))break;s.pop()}if(s.length===0&&n.isCollapsed()){const d=uo(n.anchor),f=uo(n.anchor.getFlipped()),p=y=>Eu(y)?y.origin:y.getNodeAtCaret(),m=p(d)||p(f)||(n.anchor.getNodeAtCaret()?d.origin:f.origin);s.push(m)}return s})(OA(nE(this),"next"));return Ap()||(this._cachedNodes=r),r}setTextNodeRange(t,r,n,s){this.anchor.set(t.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const t=this.getNodes();if(t.length===0)return"";const r=t[0],n=t[t.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[o,c]=L_(this);let d="",f=!0;for(let p=0;p<t.length;p++){const m=t[p];if(ft(m)&&!m.isInline())f||(d+=`
`),f=!m.isEmpty();else if(f=!1,It(m)){let y=m.getTextContent();m===r?m===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(y=o<c?y.slice(o,c):y.slice(c,o)):y=i?y.slice(o):y.slice(c):m===n&&(y=i?y.slice(0,c):y.slice(0,o)),d+=y}else!Qr(m)&&!xc(m)||m===n&&this.isCollapsed()||(d+=m.getTextContent())}return d}applyDOMRange(t){const r=Hn(),n=r.getEditorState()._selection,s=hA(t.startContainer,t.startOffset,t.endContainer,t.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),G1(this)}clone(){const t=this.anchor,r=this.focus;return new pf(El(t.key,t.offset,t.type),El(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(t){this.format=ty(this.format,t,null),this.dirty=!0}setFormat(t){this.format=t,this.dirty=!0}setStyle(t){this.style=t,this.dirty=!0}hasFormat(t){const r=Zd[t];return!!(this.format&r)}insertRawText(t){const r=t.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(Tl()):i==="	"?n.push(v0()):n.push(Qn(i))}this.insertNodes(n)}insertText(t){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,o=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,o=r),i.type==="element"&&(function(S,E,k,_){const N=S.getNode(),F=N.getChildAtIndex(S.offset),A=Qn();if(A.setFormat(k),A.setStyle(_),Cb(F))F.splice(0,0,[A]);else{const R=Ls(N)?An().append(A):A;F===null?N.append(R):F.insertBefore(R)}S.is(E)&&E.set(A.__key,0,"text"),S.set(A.__key,0,"text")})(i,o,s,a),o.type==="element"&&lf(o,uo(kc(o,"next")));const c=i.offset;let d=o.offset;const f=this.getNodes(),p=f.length;let m=f[0];It(m)||Ct(26);const y=m.getTextContent().length,v=m.getParentOrThrow();let w=f[p-1];if(p===1&&o.type==="element"&&(d=y,o.set(i.key,d,"text")),this.isCollapsed()&&c===y&&(uc(m)||!m.canInsertTextAfter()||!v.canInsertTextAfter()&&m.getNextSibling()===null)){let S=m.getNextSibling();if(It(S)&&S.canInsertTextBefore()&&!uc(S)||(S=Qn(),S.setFormat(s),S.setStyle(a),v.canInsertTextAfter()?m.insertAfter(S):v.insertAfter(S)),S.select(0,0),m=S,t!=="")return void this.insertText(t)}else if(this.isCollapsed()&&c===0&&(uc(m)||!m.canInsertTextBefore()||!v.canInsertTextBefore()&&m.getPreviousSibling()===null)){let S=m.getPreviousSibling();if(It(S)&&!uc(S)||(S=Qn(),S.setFormat(s),v.canInsertTextBefore()?m.insertBefore(S):v.insertBefore(S)),S.select(),m=S,t!=="")return void this.insertText(t)}else if(m.isSegmented()&&c!==y){const S=Qn(m.getTextContent());S.setFormat(s),m.replace(S),m=S}else if(!this.isCollapsed()&&t!==""){const S=w.getParent();if(!v.canInsertTextBefore()||!v.canInsertTextAfter()||ft(S)&&(!S.canInsertTextBefore()||!S.canInsertTextAfter()))return this.insertText(""),fA(this.anchor,this.focus,null),void this.insertText(t)}if(p===1){if(zd(m)){const _=Qn(t);return _.select(),void m.replace(_)}const S=m.getFormat(),E=m.getStyle();if(c!==d||S===s&&E===a){if(Ry(m)){const _=Qn(t);return _.setFormat(s),_.setStyle(a),_.select(),void m.replace(_)}}else{if(m.getTextContent()!==""){const _=Qn(t);if(_.setFormat(s),_.setStyle(a),_.select(),c===0)m.insertBefore(_,!1);else{const[N]=m.splitText(c);N.insertAfter(_,!1)}return void(_.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length))}m.setFormat(s),m.setStyle(a)}const k=d-c;m=m.spliceText(c,k,t,!0),m.getTextContent()===""?m.remove():this.anchor.type==="text"&&(m.isComposing()?this.anchor.offset-=t.length:(this.format=S,this.style=E))}else{const S=new Set([...m.getParentKeys(),...w.getParentKeys()]),E=ft(m)?m:m.getParentOrThrow();let k=ft(w)?w:w.getParentOrThrow(),_=w;if(!E.is(k)&&k.isInline())do _=k,k=k.getParentOrThrow();while(k.isInline());if(o.type==="text"&&(d!==0||w.getTextContent()==="")||o.type==="element"&&w.getIndexWithinParent()<d)if(It(w)&&!zd(w)&&d!==w.getTextContentSize()){if(w.isSegmented()){const T=Qn(w.getTextContent());w.replace(T),w=T}Ls(o.getNode())||o.type!=="text"||(w=w.spliceText(0,d,"")),S.add(w.__key)}else{const T=w.getParentOrThrow();T.canBeEmpty()||T.getChildrenSize()!==1?w.remove():T.remove()}else S.add(w.__key);const N=k.getChildren(),F=new Set(f),A=E.is(k),R=E.isInline()&&m.getNextSibling()===null?E:m;for(let T=N.length-1;T>=0;T--){const D=N[T];if(D.is(m)||ft(D)&&D.isParentOf(m))break;D.isAttached()&&(!F.has(D)||D.is(_)?A||R.insertAfter(D,!1):D.remove())}if(!A){let T=k,D=null;for(;T!==null;){const L=T.getChildren(),O=L.length;(O===0||L[O-1].is(D))&&(S.delete(T.__key),D=T),T=T.getParent()}}if(zd(m))if(c===y)m.select();else{const T=Qn(t);T.select(),m.replace(T)}else m=m.spliceText(c,y-c,t,!0),m.getTextContent()===""?m.remove():m.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length);for(let T=1;T<p;T++){const D=f[T],L=D.__key;S.has(L)||D.remove()}}}removeText(){const t=Rt()===this;P1(this,eU(nE(this))),t&&Rt()!==this&&ya(this)}formatText(t,r=null){if(this.isCollapsed())return this.toggleFormat(t),void ma(null);const n=this.getNodes(),s=[];for(const N of n)It(N)&&s.push(N);const a=N=>{n.forEach((F=>{if(ft(F)){const A=F.getFormatFlags(t,N);F.setTextFormat(A)}}))},i=s.length;if(i===0)return this.toggleFormat(t),ma(null),void a(r);const o=this.anchor,c=this.focus,d=this.isBackward(),f=d?c:o,p=d?o:c;let m=0,y=s[0],v=f.type==="element"?0:f.offset;if(f.type==="text"&&v===y.getTextContentSize()&&(m=1,y=s[1],v=0),y==null)return;const w=y.getFormatFlags(t,r);a(w);const S=i-1;let E=s[S];const k=p.type==="text"?p.offset:E.getTextContentSize();if(y.is(E)){if(v===k)return;if(uc(y)||v===0&&k===y.getTextContentSize())y.setFormat(w);else{const N=y.splitText(v,k),F=v===0?N[0]:N[1];F.setFormat(w),f.type==="text"&&f.set(F.__key,0,"text"),p.type==="text"&&p.set(F.__key,k-v,"text")}return void(this.format=w)}v===0||uc(y)||([,y]=y.splitText(v),v=0),y.setFormat(w);const _=E.getFormatFlags(t,w);k>0&&(k===E.getTextContentSize()||uc(E)||([E]=E.splitText(k)),E.setFormat(_));for(let N=m+1;N<S;N++){const F=s[N],A=F.getFormatFlags(t,_);F.setFormat(A)}f.type==="text"&&f.set(y.__key,v,"text"),p.type==="text"&&p.set(E.__key,k,"text"),this.format=w|_}insertNodes(t){if(t.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const v=Rt();return yt(v)||Ct(134),v.insertNodes(t)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=Tw(r,lo),s=t[t.length-1];if(ft(n)&&"__language"in n){if("__language"in t[0])this.insertText(t[0].getTextContent());else{const v=bw(this);n.splice(v,0,t),s.selectEnd()}return}if(!t.some((v=>(ft(v)||Qr(v))&&!v.isInline()))){ft(n)||Ct(211,r.constructor.name,r.getType());const v=bw(this);return n.splice(v,0,t),void s.selectEnd()}const a=(function(v){const w=An();let S=null;for(let E=0;E<v.length;E++){const k=v[E],_=xc(k);if(_||Qr(k)&&k.isInline()||ft(k)&&k.isInline()||It(k)||k.isParentRequired()){if(S===null&&(S=k.createParentElementNode(),w.append(S),_))continue;S!==null&&S.append(k)}else w.append(k),S=null}return w})(t),i=a.getLastDescendant(),o=a.getChildren(),c=!ft(n)||!n.isEmpty()?this.insertParagraph():null,d=o[o.length-1];let f=o[0];var p;ft(p=f)&&lo(p)&&!p.isEmpty()&&ft(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(ft(n)||Ct(211,r.constructor.name,r.getType()),n.append(...f.getChildren()),f=o[1]),f&&(n===null&&Ct(212,r.constructor.name,r.getType()),(function(v,w,S){const E=w.getParentOrThrow().getLastChild();let k=w;const _=[w];for(;k!==E;)k.getNextSibling()||Ct(140),k=k.getNextSibling(),_.push(k);let N=v;for(const F of _)N=N.insertAfter(F)})(n,f));const m=Tw(i,lo);c&&ft(m)&&(c.canMergeWhenEmpty()||lo(d))&&(m.append(...c.getChildren()),c.remove()),ft(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const y=ft(n)?n.getLastChild():null;xc(y)&&m!==n&&y.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=An();return On().splice(this.anchor.offset,0,[i]),i.select(),i}const t=bw(this),r=Tw(this.anchor.getNode(),lo);ft(r)||Ct(213);const n=r.getChildAtIndex(t),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(t){const r=Tl();if(this.insertNodes([r]),t){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const t=this.getNodes(),r=t.length,n=r-1,s=this.anchor,a=this.focus;let i=t[0],o=t[n];const[c,d]=L_(this);if(r===0)return[];if(r===1){if(It(i)&&!this.isCollapsed()){const p=c>d?d:c,m=c>d?c:d,y=i.splitText(p,m),v=p===0?y[0]:y[1];return v!=null?[v]:[]}return[i]}const f=s.isBefore(a);if(It(i)){const p=f?c:d;p===i.getTextContentSize()?t.shift():p!==0&&([,i]=i.splitText(p),t[0]=i)}if(It(o)){const p=o.getTextContent().length,m=f?d:c;m===0?t.pop():m!==p&&([o]=o.splitText(m),t[n]=o)}return t}modify(t,r,n){if(O4(this,t,r,n))return;const s=t==="move",a=Hn(),i=zo(go(a));if(!i)return;const o=a._blockCursorElement,c=a._rootElement,d=this.focus.getNode();if(c===null||o===null||!ft(d)||d.isInline()||d.canBeEmpty()||W_(o,a,c),this.dirty){let f=rf(a,this.anchor.key),p=rf(a,this.focus.key);this.anchor.type==="text"&&(f=a0(f)),this.focus.type==="text"&&(p=a0(p)),f&&p&&mA(i,f,this.anchor.offset,p,this.focus.offset)}if((function(f,p,m,y){f.modify(p,m,y)})(i,t,r?"backward":"forward",n),i.rangeCount>0){const f=i.getRangeAt(0),p=this.anchor.getNode(),m=Ls(p)?p:OB(p);if(this.applyDOMRange(f),this.dirty=!0,!s){const y=this.getNodes(),v=[];let w=!1;for(let S=0;S<y.length;S++){const E=y[S];$_(E,m)?v.push(E):w=!0}if(w&&v.length>0)if(r){const S=v[0];ft(S)?S.selectStart():S.getParentOrThrow().selectStart()}else{const S=v[v.length-1];ft(S)?S.selectEnd():S.getParentOrThrow().selectEnd()}i.anchorNode===f.startContainer&&i.anchorOffset===f.startOffset||(function(S){const E=S.focus,k=S.anchor,_=k.key,N=k.offset,F=k.type;k.set(E.key,E.offset,E.type,!0),E.set(_,N,F,!0)})(this)}}n==="lineboundary"&&O4(this,t,r,n,"decorators")}forwardDeletion(t,r,n){if(!n&&(t.type==="element"&&ft(r)&&t.offset===r.getChildrenSize()||t.type==="text"&&t.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(ft(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(t){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,t))return;const a=Wb(kc(n,t?"previous":"next"));if(a.getTextSlices().every((o=>o===null||o.distance===0))){let o={type:"initial"};for(const c of a.iterNodeCarets("shadowRoot"))if(Cl(c)){if(!c.origin.isInline()){if(c.origin.isShadowRoot()){if(o.type==="merge-block")break;if(ft(a.anchor.origin)&&a.anchor.origin.isEmpty()){const d=uo(c);P1(this,Ru(d,d)),a.anchor.origin.remove()}return}o.type!=="merge-next-block"&&o.type!=="merge-block"||(o={block:o.block,caret:c,type:"merge-block"})}}else{if(o.type==="merge-block")break;if(af(c)){if(ft(c.origin)){if(c.origin.isInline()){if(!c.origin.isParentOf(a.anchor.origin))break}else o={block:c.origin,type:"merge-next-block"};continue}if(Qr(c.origin)){if(!c.origin.isIsolated())if(o.type==="merge-next-block"&&(c.origin.isKeyboardSelectable()||!c.origin.isInline())&&ft(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const d=vb();d.add(c.origin.getKey()),ya(d)}else c.origin.remove();return}break}}if(o.type==="merge-block"){const{caret:c,block:d}=o;return P1(this,Ru(!c.origin.isEmpty()&&d.isEmpty()?Hb(xa(d,c.direction)):a.anchor,c)),this.removeText()}}const i=this.focus;if(this.modify("extend",t,"character"),this.isCollapsed()){if(t&&n.offset===0&&P4(this,n.getNode()))return}else{const o=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,o!==null&&o.isSegmented()){const c=i.offset,d=o.getTextContentSize();if(o.is(s)||t&&c!==d||!t&&c!==0)return void D4(o,t,c)}else if(s!==null&&s.isSegmented()){const c=n.offset,d=s.getTextContentSize();if(s.is(o)||t&&c!==0||!t&&c!==d)return void D4(s,t,c)}(function(c,d){const f=c.anchor,p=c.focus,m=f.getNode(),y=p.getNode();if(m===y&&f.type==="text"&&p.type==="text"){const v=f.offset,w=p.offset,S=v<w,E=S?v:w,k=S?w:v,_=k-1;E!==_&&(function(N){return!(AA(N)||pB(N))})(m.getTextContent().slice(E,k))&&(d?p.set(p.key,_,p.type):f.set(f.key,_,f.type))}})(this,t)}}if(this.removeText(),t&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&Ls(n.getParent())&&n.getPreviousSibling()===null&&P4(this,n)}}deleteLine(t){this.isCollapsed()&&this.modify("extend",t,"lineboundary"),this.isCollapsed()?this.deleteCharacter(t):this.removeText()}deleteWord(t){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,t))return;this.modify("extend",t,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function Ea(e){return e instanceof Iy}function F4(e){const t=e.offset;if(e.type==="text")return t;const r=e.getNode();return t===r.getChildrenSize()?r.getTextContent().length:0}function L_(e){const t=e.getStartEndPoints();if(t===null)return[0,0];const[r,n]=t;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[F4(r),F4(n)]}function P4(e,t){for(let r=t;r;r=r.getParent()){if(ft(r)){if(r.collapseAtStart(e))return!0;if(ni(r))break}if(r.getPreviousSibling())break}return!1}const pB=(()=>{try{const e=new RegExp("\\p{Emoji}","u"),t=e.test.bind(e);if(t("❤️")&&t("#️⃣")&&t("👍"))return t}catch{}return()=>!1})();function D4(e,t,r){const n=e,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,o=0;for(let d=0;d<a;d++){const f=d===a-1;if(o=i,i+=s[d].length,t&&i===r||i>r||f){s.splice(d,1),f&&(o=void 0);break}}const c=s.join("").trim();c===""?n.remove():(n.setTextContent(c),n.select(o,o))}function R4(e,t,r,n){let s,a=t;if(jn(e)){let i=!1;const o=e.childNodes,c=o.length,d=n._blockCursorElement;a===c&&(i=!0,a=c-1);let f=o[a],p=!1;if(f===d)f=o[a+1],p=!0;else if(d!==null){const m=d.parentNode;e===m&&t>Array.prototype.indexOf.call(m.children,d)&&a--}if(s=Bh(f),It(s))a=Nu(s,i?"next":"previous");else{let m=Bh(e);if(m===null)return null;if(ft(m)){const y=n.getElementByKey(m.getKey());y===null&&Ct(214),[m,a]=m.getDOMSlot(y).resolveChildIndex(m,y,e,t),ft(m)||Ct(215),i&&a>=m.getChildrenSize()&&(a=Math.max(0,m.getChildrenSize()-1));let w=m.getChildAtIndex(a);if(ft(w)&&(function(S,E,k){const _=S.getParent();return k===null||_===null||!_.canBeEmpty()||_!==k.getNode()})(w,0,r)){const S=i?w.getLastDescendant():w.getFirstDescendant();S===null?m=w:(w=S,m=ft(w)?w:w.getParentOrThrow()),a=0}It(w)?(s=w,m=null,a=Nu(w,i?"next":"previous")):w!==m&&i&&!p&&(ft(m)||Ct(216),a=Math.min(m.getChildrenSize(),a+1))}else{const y=m.getIndexWithinParent();a=t===0&&Qr(m)&&Bh(e)===m?y:y+1,m=m.getParentOrThrow()}if(ft(m))return El(m.__key,a,"element")}}else s=Bh(e);return It(s)?El(s.__key,Nu(s,a,"clamp"),"text"):null}function I4(e,t,r){const n=e.offset,s=e.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(t){if((r||!t)&&a===null&&ft(i)&&i.isInline()){const o=i.getPreviousSibling();It(o)&&e.set(o.__key,o.getTextContent().length,"text")}}else ft(a)&&!r&&a.isInline()?e.set(a.__key,a.getChildrenSize(),"element"):It(a)&&e.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(t&&ft(a)&&a.isInline())e.set(a.__key,0,"element");else if((r||t)&&a===null&&ft(i)&&i.isInline()&&!i.canInsertTextAfter()){const o=i.getNextSibling();It(o)&&e.set(o.__key,0,"text")}}}function fA(e,t,r){if(e.type==="text"&&t.type==="text"){const n=e.isBefore(t),s=e.is(t);I4(e,n,s),I4(t,!n,s),s&&t.set(e.key,e.offset,e.type);const a=Hn();if(a.isComposing()&&a._compositionKey!==e.key&&yt(r)){const i=r.anchor,o=r.focus;e.set(i.key,i.offset,i.type,!0),t.set(o.key,o.offset,o.type,!0)}}}function hA(e,t,r,n,s,a){if(e===null||r===null||!Pp(s,e,r))return null;const i=R4(e,t,yt(a)?a.anchor:null,s);if(i===null)return null;const o=R4(r,n,yt(a)?a.focus:null,s);if(o===null)return null;if(i.type==="element"&&o.type==="element"){const c=Bh(e),d=Bh(r);if(Qr(c)&&Qr(d))return null}return fA(i,o,a),[i,o]}function O_(e){return ft(e)&&!e.isInline()}function gA(e,t,r,n,s,a){const i=zu(),o=new pf(El(e,t,s),El(r,n,a),0,"");return o.dirty=!0,i._selection=o,o}function My(){const e=El("root",0,"element"),t=El("root",0,"element");return new pf(e,t,0,"")}function vb(){return new Iy(new Set)}function wb(e,t,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,o=i==="selectionchange",c=!b_&&(o||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let d,f,p,m;if(yt(e)&&!c)return e.clone();if(t===null)return null;if(d=t.anchorNode,f=t.focusNode,p=t.anchorOffset,m=t.focusOffset,o&&yt(e)&&!Pp(r,d,f))return e.clone();const y=hA(d,p,f,m,r,e);if(y===null)return null;const[v,w]=y;return new pf(v,w,yt(e)?e.format:0,yt(e)?e.style:"")}function Rt(){return zu()._selection}function w0(){return Hn()._editorState._selection}function Q1(e,t,r,n=1){const s=e.anchor,a=e.focus,i=s.getNode(),o=a.getNode();if(!t.is(i)&&!t.is(o))return;const c=t.__key;if(e.isCollapsed()){const d=s.offset;if(r<=d&&n>0||r<d&&n<0){const f=Math.max(0,d+n);s.set(c,f,"element"),a.set(c,f,"element"),M4(e)}}else{const d=e.isBackward(),f=d?a:s,p=f.getNode(),m=d?s:a,y=m.getNode();if(t.is(p)){const v=f.offset;(r<=v&&n>0||r<v&&n<0)&&f.set(c,Math.max(0,v+n),"element")}if(t.is(y)){const v=m.offset;(r<=v&&n>0||r<v&&n<0)&&m.set(c,Math.max(0,v+n),"element")}}M4(e)}function M4(e){const t=e.anchor,r=t.offset,n=e.focus,s=n.offset,a=t.getNode(),i=n.getNode();if(e.isCollapsed()){if(!ft(a))return;const o=a.getChildrenSize(),c=r>=o,d=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(It(d)){let f=0;c&&(f=d.getTextContentSize()),t.set(d.__key,f,"text"),n.set(d.__key,f,"text")}}else{if(ft(a)){const o=a.getChildrenSize(),c=r>=o,d=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(It(d)){let f=0;c&&(f=d.getTextContentSize()),t.set(d.__key,f,"text")}}if(ft(i)){const o=i.getChildrenSize(),c=s>=o,d=c?i.getChildAtIndex(o-1):i.getChildAtIndex(s);if(It(d)){let f=0;c&&(f=d.getTextContentSize()),n.set(d.__key,f,"text")}}}}function Z1(e,t,r,n,s){let a=null,i=0,o=null;n!==null?(a=n.__key,It(n)?(i=n.getTextContentSize(),o="text"):ft(n)&&(i=n.getChildrenSize(),o="element")):s!==null&&(a=s.__key,It(s)?o="text":ft(s)&&(o="element")),a!==null&&o!==null?e.set(a,i,o):(i=t.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),e.set(r.__key,i,"element"))}function L4(e,t,r,n,s){e.type==="text"?e.set(r,e.offset+(t?0:s),"text"):e.offset>n.getIndexWithinParent()&&e.set(e.key,e.offset-1,"element")}function mA(e,t,r,n,s){try{e.setBaseAndExtent(t,r,n,s)}catch{}}function xB(e,t,r,n,s,a,i){const o=n.anchorNode,c=n.focusNode,d=n.anchorOffset,f=n.focusOffset,p=document.activeElement;if(s.has(_A)&&p!==a||p!==null&&Nb(p))return;if(!yt(t))return void(e!==null&&Pp(r,o,c)&&n.removeAllRanges());const m=t.anchor,y=t.focus,v=m.key,w=y.key,S=rf(r,v),E=rf(r,w),k=m.offset,_=y.offset,N=t.format,F=t.style,A=t.isCollapsed();let R=S,T=E,D=!1;if(m.type==="text"){R=a0(S);const Z=m.getNode();D=Z.getFormat()!==N||Z.getStyle()!==F}else yt(e)&&e.anchor.type==="text"&&(D=!0);var L,O,G,K,te;if(y.type==="text"&&(T=a0(E)),R!==null&&T!==null&&(A&&(e===null||D||yt(e)&&(e.format!==N||e.style!==F))&&(L=N,O=F,G=k,K=v,te=performance.now(),sA=[L,O,G,K,te]),d!==k||f!==_||o!==R||c!==T||n.type==="Range"&&A||(p!==null&&a.contains(p)||a.focus({preventScroll:!0}),m.type==="element"))){if(mA(n,R,k,T,_),!s.has(kB)&&t.isCollapsed()&&a!==null&&a===document.activeElement){const Z=yt(t)&&t.anchor.type==="element"?R.childNodes[k]||null:n.rangeCount>0?n.getRangeAt(0):null;if(Z!==null){let J;if(Z instanceof Text){const I=document.createRange();I.selectNode(Z),J=I.getBoundingClientRect()}else J=Z.getBoundingClientRect();(function(I,W,B){const Y=DA(B),V=Rb(Y);if(Y===null||V===null)return;let{top:H,bottom:X}=W,se=0,ie=0,ae=B;for(;ae!==null;){const Q=ae===Y.body;if(Q)se=0,ie=go(I).innerHeight;else{const _e=ae.getBoundingClientRect();se=_e.top,ie=_e.bottom}let le=0;if(H<se?le=-(se-H):X>ie&&(le=X-ie),le!==0)if(Q)V.scrollBy(0,le);else{const _e=ae.scrollTop;ae.scrollTop+=le;const ke=ae.scrollTop-_e;H-=ke,X-=ke}if(Q)break;ae=Dp(ae)}})(r,J,a)}}R_=!0}}function yB(e){let t=Rt()||w0();t===null&&(t=On().selectEnd()),t.insertNodes(e)}function bw(e){let t=e;e.isCollapsed()||t.removeText();const r=Rt();yt(r)&&(t=r),yt(t)||Ct(161);const n=t.anchor;let s=n.getNode(),a=n.offset;for(;!lo(s);){const i=s;if([s,a]=vB(s,a),i.is(s))break}return a}function vB(e,t){const r=e.getParent();if(!r){const s=An();return On().append(s),s.select(),[On(),0]}if(It(e)){const s=e.splitText(t);if(s.length===0)return[r,e.getIndexWithinParent()];const a=t===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!ft(e)||t===0)return[r,e.getIndexWithinParent()];const n=e.getChildAtIndex(t);if(n){const s=new pf(El(e.__key,t,"element"),El(e.__key,t,"element"),0,""),a=e.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,e.getIndexWithinParent()+1]}function O4(e,t,r,n,s="decorators-and-blocks"){if(t==="move"&&n==="character"&&!e.isCollapsed()){const[f,p]=r===e.isBackward()?[e.focus,e.anchor]:[e.anchor,e.focus];return p.set(f.key,f.offset,f.type),!0}const a=kc(e.focus,r?"previous":"next"),i=n==="lineboundary",o=t==="move";let c=a,d=s==="decorators-and-blocks";if(!LA(c)){for(const f of c){d=!1;const{origin:p}=f;if(!Qr(p)||p.isIsolated()||(c=f,!i||!p.isInline()))break}if(d)for(const f of Wb(a).iterNodeCarets(t==="extend"?"shadowRoot":"root")){if(Cl(f))f.origin.isInline()||(c=f);else{if(ft(f.origin))continue;Qr(f.origin)&&!f.origin.isInline()&&(c=f)}break}}if(c===a)return!1;if(o&&!i&&Qr(c.origin)&&c.origin.isKeyboardSelectable()){const f=vb();return f.add(c.origin.getKey()),ya(f),!0}return c=uo(c),o&&lf(e.anchor,c),lf(e.focus,c),d||!i}let Ys=null,Js=null,wi=!1,Sw=!1,j1=0;const B4={characterData:!0,childList:!0,subtree:!0};function Ap(){return wi||Ys!==null&&Ys._readOnly}function ga(){wi&&Ct(13)}function pA(){j1>99&&Ct(14)}function zu(){return Ys===null&&Ct(195,xA()),Ys}function Hn(){return Js===null&&Ct(196,xA()),Js}function xA(){let e=0;const t=new Set,r=By.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=Uy(s);if(Ab(a))e++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),t.add(i)}}let n=` Detected on the page: ${e} compatible editor(s) with version ${r}`;return t.size&&(n+=` and incompatible editors with versions ${Array.from(t).join(", ")}`),n}function wB(){return Js}function U4(e,t,r){const n=t.__type,s=SA(e,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let o=0;o<i&&(a[o](t),t.isAttached());o++);}function $4(e,t){return e!==void 0&&e.__key!==t&&e.isAttached()}function yA(e,t){if(!t)return;const r=e._updateTags;let n=t;Array.isArray(t)||(n=[t]);for(const s of n)r.add(s)}function _B(e){return _b(e,Hn()._nodes)}function _b(e,t){const r=e.type,n=t.get(r);n===void 0&&Ct(17,r);const s=n.klass;e.type!==s.getType()&&Ct(18,s.name);const a=s.importJSON(e),i=e.children;if(ft(a)&&Array.isArray(i))for(let o=0;o<i.length;o++){const c=_b(i[o],t);a.append(c)}return a}function W4(e,t,r){const n=Ys,s=wi,a=Js;Ys=t,wi=!0,Js=e;try{return r()}finally{Ys=n,wi=s,Js=a}}function fc(e,t){const r=e._pendingEditorState,n=e._rootElement,s=e._headless||n===null;if(r===null)return;const a=e._editorState,i=a._selection,o=r._selection,c=e._dirtyType!==Qd,d=Ys,f=wi,p=Js,m=e._updating,y=e._observer;let v=null;if(e._pendingEditorState=null,e._editorState=r,!s&&c&&y!==null){Js=e,Ys=r,wi=!1,e._updating=!0;try{const A=e._dirtyType,R=e._dirtyElements,T=e._dirtyLeaves;y.disconnect(),v=XO(a,r,e,A,R,T)}catch(A){if(A instanceof Error&&e._onError(A),Sw)throw A;return bA(e,null,n,r),I6(e),e._dirtyType=s0,Sw=!0,fc(e,a),void(Sw=!1)}finally{y.observe(n,B4),e._updating=m,Ys=d,wi=f,Js=p}}r._readOnly||(r._readOnly=!0);const w=e._dirtyLeaves,S=e._dirtyElements,E=e._normalizedNodes,k=e._updateTags,_=e._deferred;c&&(e._dirtyType=Qd,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),(function(A,R){const T=A._decorators;let D=A._pendingDecorators||T;const L=R._nodeMap;let O;for(O in D)L.has(O)||(D===T&&(D=EA(A)),delete D[O])})(e,r);const N=s?null:zo(go(e));if(e._editable&&N!==null&&(c||o===null||o.dirty)&&n!==null&&!k.has(CB)){Js=e,Ys=r;try{if(y!==null&&y.disconnect(),c||o===null||o.dirty){const A=e._blockCursorElement;A!==null&&W_(A,e,n),xB(i,o,e,N,k,n)}(function(A,R,T){let D=A._blockCursorElement;if(yt(T)&&T.isCollapsed()&&T.anchor.type==="element"&&R.contains(document.activeElement)){const L=T.anchor,O=L.getNode(),G=L.offset;let K=!1,te=null;if(G===O.getChildrenSize())Cw(O.getChildAtIndex(G-1))&&(K=!0);else{const Z=O.getChildAtIndex(G);if(Z!==null&&Cw(Z)){const J=Z.getPreviousSibling();(J===null||Cw(J))&&(K=!0,te=A.getElementByKey(Z.__key))}}if(K){const Z=A.getElementByKey(O.__key);return D===null&&(A._blockCursorElement=D=(function(J){const I=J.theme,W=document.createElement("div");W.contentEditable="false",W.setAttribute("data-lexical-cursor","true");let B=I.blockCursor;if(B!==void 0){if(typeof B=="string"){const Y=j6(B);B=I.blockCursor=Y}B!==void 0&&W.classList.add(...B)}return W})(A._config)),R.style.caretColor="transparent",void(te===null?Z.appendChild(D):Z.insertBefore(D,te))}}D!==null&&W_(D,A,R)})(e,n,o)}finally{y!==null&&y.observe(n,B4),Js=p,Ys=d}}v!==null&&(function(A,R,T,D,L){const O=Array.from(A._listeners.mutation),G=O.length;for(let K=0;K<G;K++){const[te,Z]=O[K];for(const J of Z){const I=R.get(J);I!==void 0&&te(I,{dirtyLeaves:D,prevEditorState:L,updateTags:T})}}})(e,v,k,w,a),yt(o)||o===null||i!==null&&i.is(o)||e.dispatchCommand(W6,void 0);const F=e._pendingDecorators;F!==null&&(e._decorators=F,e._pendingDecorators=null,Fm("decorator",e,!0,F)),(function(A,R,T){const D=K4(R),L=K4(T);D!==L&&Fm("textcontent",A,!0,L)})(e,t||a,r),Fm("update",e,!0,{dirtyElements:S,dirtyLeaves:w,editorState:r,mutatedNodes:v,normalizedNodes:E,prevEditorState:t||a,tags:k}),(function(A,R){if(A._deferred=[],R.length!==0){const T=A._updating;A._updating=!0;try{for(let D=0;D<R.length;D++)R[D]()}finally{A._updating=T}}})(e,_),(function(A){const R=A._updates;if(R.length!==0){const T=R.shift();if(T){const[D,L]=T;Ly(A,D,L)}}})(e)}function Fm(e,t,r,...n){const s=t._updating;t._updating=r;try{const a=Array.from(t._listeners[e]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{t._updating=s}}function z4(e,t){const r=e._updates;let n=t||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,o=e._pendingEditorState;let c;i!==void 0&&(c=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(o===null&&Ct(191),o._flushSync=!0),c&&e._deferred.push(c),yA(e,i.tag)),o==null?Ly(e,a,i):a()}}return n}function Ly(e,t,r){const n=e._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,yA(e,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&e._deferred.push(s);const o=e._editorState;let c=e._pendingEditorState,d=!1;(c===null||c._readOnly)&&(c=e._pendingEditorState=vA(c||o),d=!0),c._flushSync=i;const f=Ys,p=wi,m=Js,y=e._updating;Ys=c,wi=!1,e._updating=!0,Js=e;const v=e._headless||e.getRootElement()===null;Tb(null);try{d&&(v?o._selection!==null&&(c._selection=o._selection.clone()):c._selection=(function(k,_){const N=k.getEditorState()._selection,F=zo(go(k));return yt(N)||N==null?wb(N,F,k,_):N.clone()})(e,r&&r.event||null));const S=e._compositionKey;t(),a=z4(e,a),(function(k,_){const N=_.getEditorState()._selection,F=k._selection;if(yt(F)){const A=F.anchor,R=F.focus;let T;if(A.type==="text"&&(T=A.getNode(),T.selectionTransform(N,F)),R.type==="text"){const D=R.getNode();T!==D&&D.selectionTransform(N,F)}}})(c,e),e._dirtyType!==Qd&&(a?(function(k,_){const N=_._dirtyLeaves,F=k._nodeMap;for(const A of N){const R=F.get(A);It(R)&&R.isAttached()&&R.isSimpleText()&&!R.isUnmergeable()&&v4(R)}})(c,e):(function(k,_){const N=_._dirtyLeaves,F=_._dirtyElements,A=k._nodeMap,R=bu(),T=new Map;let D=N,L=D.size,O=F,G=O.size;for(;L>0||G>0;){if(L>0){_._dirtyLeaves=new Set;for(const K of D){const te=A.get(K);It(te)&&te.isAttached()&&te.isSimpleText()&&!te.isUnmergeable()&&v4(te),te!==void 0&&$4(te,R)&&U4(_,te,T),N.add(K)}if(D=_._dirtyLeaves,L=D.size,L>0){j1++;continue}}_._dirtyLeaves=new Set,_._dirtyElements=new Map,O.delete("root")&&O.set("root",!0);for(const K of O){const te=K[0],Z=K[1];if(F.set(te,Z),!Z)continue;const J=A.get(te);J!==void 0&&$4(J,R)&&U4(_,J,T)}D=_._dirtyLeaves,L=D.size,O=_._dirtyElements,G=O.size,j1++}_._dirtyLeaves=N,_._dirtyElements=F})(c,e),z4(e),(function(k,_,N,F){const A=k._nodeMap,R=_._nodeMap,T=[];for(const[D]of F){const L=R.get(D);L!==void 0&&(L.isAttached()||(ft(L)&&P6(L,D,A,R,T,F),A.has(D)||F.delete(D),T.push(D)))}for(const D of T)R.delete(D);for(const D of N){const L=R.get(D);L===void 0||L.isAttached()||(A.has(D)||N.delete(D),R.delete(D))}})(o,c,e._dirtyLeaves,e._dirtyElements)),S!==e._compositionKey&&(c._flushSync=!0);const E=c._selection;if(yt(E)){const k=c._nodeMap,_=E.anchor.key,N=E.focus.key;k.get(_)!==void 0&&k.get(N)!==void 0||Ct(19)}else Ea(E)&&E._nodes.size===0&&(c._selection=null)}catch(S){return S instanceof Error&&e._onError(S),e._pendingEditorState=o,e._dirtyType=s0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void fc(e)}finally{Ys=f,wi=p,Js=m,e._updating=y,j1=0}e._dirtyType!==Qd||e._deferred.length>0||(function(S,E){const k=E.getEditorState()._selection,_=S._selection;if(_!==null){if(_.dirty||!_.is(k))return!0}else if(k!==null)return!0;return!1})(c,e)?c._flushSync?(c._flushSync=!1,fc(e)):d&&jB((()=>{fc(e)})):(c._flushSync=!1,d&&(n.clear(),e._deferred=[],e._pendingEditorState=null))}function Pi(e,t,r){Js===e&&r===void 0?t():Ly(e,t,r)}class Pm{constructor(t,r,n){this.element=t,this.before=r||null,this.after=n||null}withBefore(t){return new Pm(this.element,t,this.after)}withAfter(t){return new Pm(this.element,this.before,t)}withElement(t){return this.element===t?this:new Pm(t,this.before,this.after)}insertChild(t){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&Ct(222),this.element.insertBefore(t,r),this}removeChild(t){return t.parentElement!==this.element&&Ct(223),this.element.removeChild(t),this}replaceChild(t,r){return r.parentElement!==this.element&&Ct(224),this.element.replaceChild(t,r),this}getFirstChild(){const t=this.after?this.after.nextSibling:this.element.firstChild;return t===this.before||t===this.getManagedLineBreak()?null:t}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(t){if(t===null)this.removeManagedLineBreak();else{const r=t==="decorator"&&(n0||Jm);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const t=this.getManagedLineBreak();if(t){const r=this.element,n=t.nodeName==="IMG"?t.nextSibling:null;n&&r.removeChild(n),r.removeChild(t),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(t){const r=this.getManagedLineBreak();if(r){if(t===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),t){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let t=0;for(let r=this.after;r!==null;r=r.previousSibling)t++;return t}resolveChildIndex(t,r,n,s){if(n===this.element){const c=this.getFirstChildOffset();return[t,Math.min(c+t.getChildrenSize(),Math.max(c,s))]}const a=H4(r,n);a.push(s);const i=H4(r,this.element);let o=t.getIndexWithinParent();for(let c=0;c<i.length;c++){const d=a[c],f=i[c];if(d===void 0||d<f)break;if(d>f){o+=1;break}}return[t.getParentOrThrow(),o]}}function H4(e,t){const r=[];let n=t;for(;n!==e&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==e&&Ct(225),r.reverse()}class Ma extends y0{constructor(t){super(t),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(t){super.afterCloneFrom(t),this.__key===t.__key&&(this.__first=t.__first,this.__last=t.__last,this.__size=t.__size),this.__indent=t.__indent,this.__format=t.__format,this.__style=t.__style,this.__dir=t.__dir,this.__textFormat=t.__textFormat,this.__textStyle=t.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const t=this.getFormat();return MO[t]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getChildrenKeys(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r.__key),r=r.getNextSibling();return t}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const t=Hn()._dirtyElements;return t!==null&&t.has(this.__key)}isLastChild(){const t=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(t)}getAllTextNodes(){const t=[];let r=this.getFirstChild();for(;r!==null;){if(It(r)&&t.push(r),ft(r)){const n=r.getAllTextNodes();t.push(...n)}r=r.getNextSibling()}return t}getFirstDescendant(){let t=this.getFirstChild();for(;ft(t);){const r=t.getFirstChild();if(r===null)break;t=r}return t}getLastDescendant(){let t=this.getLastChild();for(;ft(t);){const r=t.getLastChild();if(r===null)break;t=r}return t}getDescendantByIndex(t){const r=this.getChildren(),n=r.length;if(t>=n){const a=r[n-1];return ft(a)&&a.getLastDescendant()||a||null}const s=r[t];return ft(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const t=this.getLatest().__first;return t===null?null:Ts(t)}getFirstChildOrThrow(){const t=this.getFirstChild();return t===null&&Ct(45,this.__key),t}getLastChild(){const t=this.getLatest().__last;return t===null?null:Ts(t)}getLastChildOrThrow(){const t=this.getLastChild();return t===null&&Ct(96,this.__key),t}getChildAtIndex(t){const r=this.getChildrenSize();let n,s;if(t<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=t;){if(s===t)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=t;){if(s===t)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let t="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContent(),ft(a)&&s!==n-1&&!a.isInline()&&(t+=Sc)}return t}getTextContentSize(){let t=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContentSize(),ft(a)&&s!==n-1&&!a.isInline()&&(t+=Sc.length)}return t}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(t){if(t!==""){const r=d4[t];return!!(this.getFormat()&r)}return!1}hasTextFormat(t){const r=Zd[t];return!!(this.getTextFormat()&r)}getFormatFlags(t,r){return ty(this.getLatest().__textFormat,t,r)}getTextStyle(){return this.getLatest().__textStyle}select(t,r){ga();const n=Rt();let s=t,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(t===0&&r===0){const c=this.getFirstChild();if(It(c)||ft(c))return c.select(0,0)}else if(!(t!==void 0&&t!==i||r!==void 0&&r!==i)){const c=this.getLastChild();if(It(c)||ft(c))return c.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const o=this.__key;return yt(n)?(n.anchor.set(o,s,"element"),n.focus.set(o,a,"element"),n.dirty=!0,n):gA(o,s,o,a,"element","element")}selectStart(){const t=this.getFirstDescendant();return t?t.selectStart():this.select()}selectEnd(){const t=this.getLastDescendant();return t?t.selectEnd():this.select()}clear(){const t=this.getWritable();return this.getChildren().forEach((r=>r.remove())),t}append(...t){return this.splice(this.getChildrenSize(),0,t)}setDirection(t){const r=this.getWritable();return r.__dir=t,r}setFormat(t){return this.getWritable().__format=t!==""?d4[t]:0,this}setStyle(t){return this.getWritable().__style=t||"",this}setTextFormat(t){const r=this.getWritable();return r.__textFormat=t,r}setTextStyle(t){const r=this.getWritable();return r.__textStyle=t,r}setIndent(t){return this.getWritable().__indent=t,this}splice(t,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();t+r<=a||Ct(226,String(t),String(r),String(a));const o=i.__key,c=[],d=[],f=this.getChildAtIndex(t+r);let p=null,m=a-r+s;if(t!==0)if(t===a)p=this.getLastChild();else{const v=this.getChildAtIndex(t);v!==null&&(p=v.getPreviousSibling())}if(r>0){let v=p===null?this.getFirstChild():p.getNextSibling();for(let w=0;w<r;w++){v===null&&Ct(100);const S=v.getNextSibling(),E=v.__key;Hd(v.getWritable()),d.push(E),v=S}}let y=p;for(let v=0;v<s;v++){const w=n[v];y!==null&&w.is(y)&&(p=y=y.getPreviousSibling());const S=w.getWritable();S.__parent===o&&m--,Hd(S);const E=w.__key;if(y===null)i.__first=E,S.__prev=null;else{const k=y.getWritable();k.__next=E,S.__prev=k.__key}w.__key===o&&Ct(76),S.__parent=o,c.push(E),y=w}if(t+r===a)y!==null&&(y.getWritable().__next=null,i.__last=y.__key);else if(f!==null){const v=f.getWritable();if(y!==null){const w=y.getWritable();v.__prev=y.__key,w.__next=f.__key}else v.__prev=null}if(i.__size=m,d.length){const v=Rt();if(yt(v)){const w=new Set(d),S=new Set(c),{anchor:E,focus:k}=v;G4(E,w,S)&&Z1(E,E.getNode(),this,p,f),G4(k,w,S)&&Z1(k,k.getNode(),this,p,f),m!==0||this.canBeEmpty()||ni(this)||this.remove()}}return i}getDOMSlot(t){return new Pm(t)}exportDOM(t){const{element:r}=super.exportDOM(t);if(jn(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const t={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(t.textFormat=r),n!==""&&(t.textStyle=n),t}updateFromJSON(t){return super.updateFromJSON(t).setFormat(t.format).setIndent(t.indent).setDirection(t.direction).setTextFormat(t.textFormat||0).setTextStyle(t.textStyle||"")}insertNewAfter(t,r){return null}canIndent(){return!0}collapseAtStart(t){return!1}excludeFromCopy(t){return!1}canReplaceWith(t){return!0}canInsertAfter(t){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(t){return!1}extractWithChild(t,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(t,r){const n=this.getDOMSlot(t);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function ft(e){return e instanceof Ma}function G4(e,t,r){let n=e.getNode();for(;n;){const s=n.__key;if(t.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class bb extends y0{decorate(t,r){Ct(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function Qr(e){return e instanceof bb}class jp extends Ma{static getType(){return"root"}static clone(){return new jp}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){Ct(51)}getTextContent(){const t=this.__cachedText;return!Ap()&&Hn()._dirtyType!==Qd||t===null?super.getTextContent():t}remove(){Ct(52)}replace(t){Ct(53)}insertBefore(t){Ct(54)}insertAfter(t){Ct(55)}updateDOM(t,r){return!1}splice(t,r,n){for(const s of n)ft(s)||Qr(s)||Ct(282);return super.splice(t,r,n)}static importJSON(t){return On().updateFromJSON(t)}collapseAtStart(){return!0}}function Ls(e){return e instanceof jp}function vA(e){return new Oy(new Map(e._nodeMap))}function Sb(){return new Oy(new Map([["root",new jp]]))}function wA(e){const t=e.exportJSON(),r=e.constructor;if(t.type!==r.getType()&&Ct(130,r.name),ft(e)){const n=t.children;Array.isArray(n)||Ct(59,r.name);const s=e.getChildren();for(let a=0;a<s.length;a++){const i=wA(s[a]);n.push(i)}}return t}class Oy{constructor(t,r){this._nodeMap=t,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(t,r){return W4(r&&r.editor||null,this,t)}clone(t){const r=new Oy(this._nodeMap,t===void 0?this._selection:t);return r._readOnly=!0,r}toJSON(){return W4(null,this,(()=>({root:wA(On())})))}}const ey="historic",bB="history-push",Dm="history-merge",SB="paste",_A="collaboration",kB="skip-scroll-into-view",CB="skip-dom-selection";class kb extends Ma{static getType(){return"artificial"}createDOM(t){return document.createElement("div")}}class Fp extends Ma{static getType(){return"paragraph"}static clone(t){return new Fp(t.__key)}createDOM(t){const r=document.createElement("p"),n=Vh(t.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(t,r,n){return!1}static importDOM(){return{p:t=>({conversion:TB,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(jn(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(t){return An().updateFromJSON(t)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(t,r){const n=An();n.setTextFormat(t.format),n.setTextStyle(t.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const t=this.getChildren();if(t.length===0||It(t[0])&&t[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function TB(e){const t=An();return e.style&&(t.setFormat(e.style.textAlign),Mb(e,t)),{node:t}}function An(){return ai(new Fp)}function Cb(e){return e instanceof Fp}const Hr=0,Fh=1,EB=4;function bA(e,t,r,n){const s=e._keyToDOMMap;s.clear(),e._editorState=Sb(),e._pendingEditorState=n,e._compositionKey=null,e._dirtyType=Qd,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const a=e._observer;a!==null&&(a.disconnect(),e._observer=null),t!==null&&(t.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function NB(e){const t=e||{},r=wB(),n=t.theme||{},s=e===void 0?r:t.parentEditor||null,a=t.disableEvents||!1,i=Sb(),o=t.namespace||(s!==null?s._config.namespace:jA()),c=t.editorState,d=[jp,Wu,Ep,Np,Fp,kb,...t.nodes||[]],{onError:f,html:p}=t,m=t.editable===void 0||t.editable;let y;if(e===void 0&&r!==null)y=r._nodes;else{y=new Map;for(let w=0;w<d.length;w++){let S=d[w],E=null,k=null;if(typeof S!="function"){const R=S;S=R.replace,E=R.with,k=R.withKlass||null}const{ownNodeConfig:_}=Lb(S),N=S.getType(),F=S.transform(),A=new Set;_&&_.$transform&&A.add(_.$transform),F!==null&&A.add(F),y.set(N,{exportDOM:p&&p.export?p.export.get(S):void 0,klass:S,replace:E,replaceWithKlass:k,sharedNodeState:HO(d[w]),transforms:A})}}const v=new By(i,s,y,{disableEvents:a,namespace:o,theme:n},f||console.error,(function(w,S){const E=new Map,k=new Set,_=N=>{Object.keys(N).forEach((F=>{let A=E.get(F);A===void 0&&(A=[],E.set(F,A)),A.push(N[F])}))};return w.forEach((N=>{const F=N.klass.importDOM;if(F==null||k.has(F))return;k.add(F);const A=F.call(N.klass);A!==null&&_(A)})),S&&_(S),E})(y,p?p.import:void 0),m,e);return c!==void 0&&(v._pendingEditorState=c,v._dirtyType=s0),v}class By{constructor(t,r,n,s,a,i,o,c){this._createEditorArgs=c,this._parentEditor=r,this._rootElement=null,this._editorState=t,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=Qd,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=jA(),this._onError=a,this._htmlConversions=i,this._editable=o,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(t){const r=this._listeners.update;return r.add(t),()=>{r.delete(t)}}registerEditableListener(t){const r=this._listeners.editable;return r.add(t),()=>{r.delete(t)}}registerDecoratorListener(t){const r=this._listeners.decorator;return r.add(t),()=>{r.delete(t)}}registerTextContentListener(t){const r=this._listeners.textcontent;return r.add(t),()=>{r.delete(t)}}registerRootListener(t){const r=this._listeners.root;return t(this._rootElement,null),r.add(t),()=>{t(null,this._rootElement),r.delete(t)}}registerCommand(t,r,n){n===void 0&&Ct(35);const s=this._commands;s.has(t)||s.set(t,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(t);a===void 0&&Ct(36,String(t));const i=a[n];return i.add(r),()=>{i.delete(r),a.every((o=>o.size===0))&&s.delete(t)}}registerMutationListener(t,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(t)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const o=n&&n.skipInitialization;return o!==void 0&&o||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(t){const r=this._nodes.get(t.getType());return r===void 0&&Ct(37,t.name),r}resolveRegisteredNodeAfterReplacements(t){for(;t.replaceWithKlass;)t=this.getRegisteredNode(t.replaceWithKlass);return t}initializeMutationListener(t,r){const n=this._editorState,s=eE(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&t(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(t,r){const n=this.getRegisteredNode(t);return n.transforms.add(r),n}registerNodeTransform(t,r){const n=this.registerNodeTransformToKlass(t,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return(function(i,o){const c=eE(i.getEditorState()),d=[];for(const f of o){const p=c.get(f);p&&d.push(p)}d.length!==0&&i.update((()=>{for(const f of d)for(const p of f.keys()){const m=Ts(p);m&&m.markDirty()}}),i._pendingEditorState===null?{tag:Dm}:void 0)})(this,s.map((i=>i.klass.getType()))),()=>{s.forEach((i=>i.transforms.delete(r)))}}hasNode(t){return this._nodes.has(t.getType())}hasNodes(t){return t.every(this.hasNode.bind(this))}dispatchCommand(t,r){return qt(this,t,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(t){const r=this._rootElement;if(t!==r){const n=Vh(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=t,bA(this,r,t,s),r!==null&&(this._config.disableEvents||lB(r),n!=null&&r.classList.remove(...n)),t!==null){const a=Rb(t),i=t.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",t.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=s0,I6(this),this._updateTags.add(Dm),fc(this),this._config.disableEvents||(function(o,c){const d=o.ownerDocument,f=J1.get(d);(f===void 0||f<1)&&d.addEventListener("selectionchange",cA),J1.set(d,(f||0)+1),o.__lexicalEditor=c;const p=lA(o);for(let m=0;m<D_.length;m++){const[y,v]=D_[m],w=typeof v=="function"?S=>{T4(S)||(C4(S),(c.isEditable()||y==="click")&&v(S,c))}:S=>{if(T4(S))return;C4(S);const E=c.isEditable();switch(y){case"cut":return E&&qt(c,xb,S);case"copy":return qt(c,Dy,S);case"paste":return E&&qt(c,gb,S);case"dragstart":return E&&qt(c,eA,S);case"dragover":return E&&qt(c,tA,S);case"dragend":return E&&qt(c,rB,S);case"focus":return E&&qt(c,aB,S);case"blur":return E&&qt(c,iB,S);case"drop":return E&&qt(c,Q6,S)}};o.addEventListener(y,w),p.push((()=>{o.removeEventListener(y,w)}))}})(t,this),n!=null&&t.classList.add(...n)}else this._window=null,this._updateTags.add(Dm),fc(this);Fm("root",this,!1,t,r)}}getElementByKey(t){return this._keyToDOMMap.get(t)||null}getEditorState(){return this._editorState}setEditorState(t,r){t.isEmpty()&&Ct(38);let n=t;n._readOnly&&(n=vA(t),n._selection=t._selection?t._selection.clone():null),R6(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),fc(this)),this._pendingEditorState=n,this._dirtyType=s0,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||fc(this)}parseEditorState(t,r){return(function(n,s,a){const i=Sb(),o=Ys,c=wi,d=Js,f=s._dirtyElements,p=s._dirtyLeaves,m=s._cloneNotNeeded,y=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,Ys=i,wi=!1,Js=s,Tb(null);try{const v=s._nodes;_b(n.root,v),a&&a(),i._readOnly=!0}catch(v){v instanceof Error&&s._onError(v)}finally{s._dirtyElements=f,s._dirtyLeaves=p,s._cloneNotNeeded=m,s._dirtyType=y,Ys=o,wi=c,Js=d}return i})(typeof t=="string"?JSON.parse(t):t,this,r)}read(t){return fc(this),this.getEditorState().read(t,{editor:this})}update(t,r){(function(n,s,a){n._updating?n._updates.push([s,a]):Ly(n,s,a)})(this,t,r)}focus(t,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),Pi(this,(()=>{const s=Rt(),a=On();s!==null?s.dirty||ya(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),IB("focus"),MB((()=>{n.removeAttribute("autocapitalize"),t&&t()}))})),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const t=this._rootElement;t!==null&&t.blur();const r=zo(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(t){this._editable!==t&&(this._editable=t,Fm("editable",this,!0,t))}toJSON(){return{editorState:this._editorState.toJSON()}}}By.version="0.35.0+prod.esm";let B_=null;function Tb(e){B_=e}let AB=1;function SA(e,t){const r=Eb(e,t);return r===void 0&&Ct(30,t),r}function Eb(e,t){return e._nodes.get(t)}const jB=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)};function V4(e){return Qr(Du(e))}function Nb(e){const t=document.activeElement;if(!jn(t))return!1;const r=t.nodeName;return Qr(Du(e))&&(r==="INPUT"||r==="TEXTAREA"||t.contentEditable==="true"&&Uy(t)==null)}function Pp(e,t,r){const n=e.getRootElement();try{return n!==null&&n.contains(t)&&n.contains(r)&&t!==null&&!Nb(t)&&kA(t)===e}catch{return!1}}function Ab(e){return e instanceof By}function kA(e){let t=e;for(;t!=null;){const r=Uy(t);if(Ab(r))return r;t=Dp(t)}return null}function Uy(e){return e?e.__lexicalEditor:null}function zd(e){return Ry(e)||e.isToken()}function uc(e){return zd(e)||e.isSegmented()}function Tc(e){return _0(e)&&e.nodeType===EO}function FB(e){return _0(e)&&e.nodeType===NO}function a0(e){let t=e;for(;t!=null;){if(Tc(t))return t;t=t.firstChild}return null}function ty(e,t,r){const n=Zd[t];if(r!==null&&(e&n)==(r&n))return e;let s=e^n;return t==="subscript"?s&=-65:t==="superscript"?s&=-33:t==="lowercase"?(s&=-513,s&=-1025):t==="uppercase"?(s&=-257,s&=-1025):t==="capitalize"&&(s&=-257,s&=-513),s}function CA(e){return It(e)||xc(e)||Qr(e)}function PB(e,t){const r=(function(){const i=B_;return B_=null,i})();if((t=t||r&&r.__key)!=null)return void(e.__key=t);ga(),pA();const n=Hn(),s=zu(),a=""+AB++;s._nodeMap.set(a,e),ft(e)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=F6,e.__key=a}function Hd(e){const t=e.getParent();if(t!==null){const r=e.getWritable(),n=t.getWritable(),s=e.getPreviousSibling(),a=e.getNextSibling(),i=a!==null?a.__key:null,o=s!==null?s.__key:null,c=s!==null?s.getWritable():null,d=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=o),c!==null&&(c.__next=i),d!==null&&(d.__prev=o),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function ry(e){pA();const t=e.getLatest(),r=t.__parent,n=zu(),s=Hn(),a=n._nodeMap,i=s._dirtyElements;r!==null&&(function(c,d,f){let p=c;for(;p!==null;){if(f.has(p))return;const m=d.get(p);if(m===void 0)break;f.set(p,!1),p=m.__parent}})(r,a,i);const o=t.__key;s._dirtyType=F6,ft(e)?i.set(o,!0):s._dirtyLeaves.add(o)}function ma(e){ga();const t=Hn(),r=t._compositionKey;if(e!==r){if(t._compositionKey=e,r!==null){const n=Ts(r);n!==null&&n.getWritable()}if(e!==null){const n=Ts(e);n!==null&&n.getWritable()}}}function bu(){return Ap()?null:Hn()._compositionKey}function Ts(e,t){const r=(t||zu())._nodeMap.get(e);return r===void 0?null:r}function TA(e,t){const r=$y(e,Hn());return r!==void 0?Ts(r,t):null}function $y(e,t){return e[`__lexicalKey_${t._key}`]}function Du(e,t){let r=e;for(;r!=null;){const n=TA(r,t);if(n!==null)return n;r=Dp(r)}return null}function EA(e){const t=e._decorators,r=Object.assign({},t);return e._pendingDecorators=r,r}function K4(e){return e.read((()=>On().getTextContent()))}function On(){return NA(zu())}function NA(e){return e._nodeMap.get("root")}function ya(e){ga();const t=zu();e!==null&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function Bh(e){const t=Hn(),r=(function(n,s){let a=n;for(;a!=null;){const i=$y(a,s);if(i!==void 0)return i;a=Dp(a)}return null})(e,t);return r===null?e===t.getRootElement()?Ts("root"):null:Ts(r)}function AA(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function jb(e){const t=[];let r=e;for(;r!==null;)t.push(r),r=r._parentEditor;return t}function jA(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function FA(e){return Tc(e)?e.nodeValue:null}function Fb(e,t,r){const n=zo(go(t));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let o=FA(s);const c=Du(s);if(o!==null&&It(c)){if(o===Fy&&r){const d=r.length;o=r,a=d,i=d}o!==null&&Pb(c,o,a,i,e)}}}function Pb(e,t,r,n,s){let a=e;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let o=t;(i||s)&&t[t.length-1]===Fy&&(o=t.slice(0,-1));const c=a.getTextContent();if(s||o!==c){if(o===""){if(ma(null),Jm||n0||W1)a.remove();else{const w=Hn();setTimeout((()=>{w.update((()=>{a.isAttached()&&a.remove()}))}),20)}return}const d=a.getParent(),f=w0(),p=a.getTextContentSize(),m=bu(),y=a.getKey();if(a.isToken()||m!==null&&y===m&&!i||yt(f)&&(d!==null&&!d.canInsertTextBefore()&&f.anchor.offset===0||f.anchor.key===e.__key&&f.anchor.offset===0&&!a.canInsertTextBefore()&&!i||f.focus.key===e.__key&&f.focus.offset===p&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const v=Rt();if(!yt(v)||r===null||n===null)return void q4(a,o,v);if(v.setTextNodeRange(a,r,a,n),a.isSegmented()){const w=Qn(a.getTextContent());a.replace(w),a=w}q4(a,o,v)}}}function q4(e,t,r){if(e.setTextContent(t),yt(r)){const n=e.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=Nu(e,a.offset,"clamp"))}}}function o1(e,t,r){const n=t[r]||!1;return n==="any"||n===e[r]}function DB(e,t){return o1(e,t,"altKey")&&o1(e,t,"ctrlKey")&&o1(e,t,"shiftKey")&&o1(e,t,"metaKey")}function an(e,t,r){return DB(e,r)&&e.key.toLowerCase()===t.toLowerCase()}const cc={ctrlKey:!vl,metaKey:vl},X4={altKey:vl,ctrlKey:!vl};function Y4(e){return e.key==="Backspace"}function J4(e){return an(e,"a",cc)}function RB(e){const t=On();if(yt(e)){const r=e.anchor,n=e.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),G1(e),e}{const r=t.select(0,t.getChildrenSize());return ya(G1(r)),r}}function Vh(e,t){e.__lexicalClassNameCache===void 0&&(e.__lexicalClassNameCache={});const r=e.__lexicalClassNameCache,n=r[t];if(n!==void 0)return n;const s=e[t];if(typeof s=="string"){const a=j6(s);return r[t]=a,a}return s}function Db(e,t,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,o=t.get(a);o===void 0&&Ct(33,a);const c=o.klass;let d=e.get(c);d===void 0&&(d=new Map,e.set(c,d));const f=d.get(i),p=f==="destroyed"&&s==="created";(f===void 0||p)&&d.set(i,p?"updated":s)}function Q4(e,t,r){const n=e.getParent();let s=r,a=e;return n!==null&&(t&&r===0?(s=a.getIndexWithinParent(),a=n):t||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(t?s-1:s)}function U_(e,t){const r=e.offset;if(e.type==="element")return Q4(e.getNode(),t,r);{const n=e.getNode();if(t&&r===0||!t&&r===n.getTextContentSize()){const s=t?n.getPreviousSibling():n.getNextSibling();return s===null?Q4(n.getParentOrThrow(),t,n.getIndexWithinParent()+(t?0:1)):s}}return null}function PA(e){const t=go(e).event,r=t&&t.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function qt(e,t,r){return(function(n,s,a){const i=jb(n);for(let o=4;o>=0;o--)for(let c=0;c<i.length;c++){const d=i[c],f=d._commands.get(s);if(f!==void 0){const p=f[o];if(p!==void 0){const m=Array.from(p),y=m.length;let v=!1;if(Pi(d,(()=>{for(let w=0;w<y;w++)if(m[w](a,n))return void(v=!0)})),v)return v}}}return!1})(e,t,r)}function Wy(e){return!Ls(e)&&!e.isLastChild()&&!e.isInline()}function rf(e,t){const r=e._keyToDOMMap.get(t);return r===void 0&&Ct(75,t),r}function Dp(e){const t=e.assignedSlot||e.parentElement;return z_(t)?t.host:t}function DA(e){return FB(e)?e:jn(e)?e.ownerDocument:null}function IB(e){ga(),Hn()._updateTags.add(e)}function MB(e){ga(),Hn()._deferred.push(e)}function $_(e,t){let r=e.getParent();for(;r!==null;){if(r.is(t))return!0;r=r.getParent()}return!1}function Rb(e){const t=DA(e);return t?t.defaultView:null}function go(e){const t=e._window;return t===null&&Ct(78),t}function LB(e){return ft(e)&&e.isInline()||Qr(e)&&e.isInline()}function OB(e){let t=e.getParentOrThrow();for(;t!==null;){if(ni(t))return t;t=t.getParentOrThrow()}return t}function ni(e){return Ls(e)||ft(e)&&e.isShadowRoot()}function ai(e){const t=Hn(),r=e.getType(),n=Eb(t,r);n===void 0&&Ct(200,e.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(e),o=i.constructor;return a!==null?i instanceof a||Ct(201,a.name,a.getType(),o.name,o.getType(),e.constructor.name,r):i instanceof e.constructor&&o!==e.constructor||Ct(202,o.name,o.getType(),e.constructor.name,r),i.__key===e.__key&&Ct(203,e.constructor.name,r,o.name,o.getType()),i}return e}function kw(e,t){!Ls(e.getParent())||ft(t)||Qr(t)||Ct(99)}function BB(e){const t=Ts(e);return t===null&&Ct(63,e),t}function Cw(e){return(Qr(e)||ft(e)&&!e.canBeEmpty())&&!e.isInline()}function W_(e,t,r){r.style.removeProperty("caret-color"),t._blockCursorElement=null;const n=e.parentElement;n!==null&&n.removeChild(e)}function zo(e){return Go?(e||window).getSelection():null}function UB(e){const t=Rb(e);return t?t.getSelection():null}function RA(e){return jn(e)&&e.tagName==="A"}function jn(e){return _0(e)&&e.nodeType===TO}function _0(e){return typeof e=="object"&&e!==null&&"nodeType"in e&&typeof e.nodeType=="number"}function z_(e){return _0(e)&&e.nodeType===AO}function H_(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return e.nodeName.match(t)!==null}function ny(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return e.nodeName.match(t)!==null}function lo(e){if(Qr(e)&&!e.isInline())return!0;if(!ft(e)||ni(e))return!1;const t=e.getFirstChild(),r=t===null||xc(t)||It(t)||t.isInline();return!e.isInline()&&e.canBeEmpty()!==!1&&r}function Tw(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function Rp(){return Hn()}const Z4=new WeakMap,$B=new Map;function eE(e){if(!e._readOnly&&e.isEmpty())return $B;e._readOnly||Ct(192);let t=Z4.get(e);return t||(t=(function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let o=n.get(i);o||(o=new Map,n.set(i,o)),o.set(s,a)}return n})(e),Z4.set(e,t)),t}function Ib(e){const t=e.constructor.clone(e);return t.afterCloneFrom(e),t}function Mb(e,t){const r=parseInt(e.style.paddingInlineStart,10)||0,n=Math.round(r/40);t.setIndent(n)}function WB(e){e.__lexicalUnmanaged=!0}function zB(e){return e.__lexicalUnmanaged===!0}function hm(e,t){return(function(r,n){return Object.prototype.hasOwnProperty.call(r,n)})(e,t)&&e[t]!==y0[t]}function Lb(e){const t=f4 in e.prototype?e.prototype[f4]():void 0,r=(function(i){return i===bb||i===Ma||i===y0})(e),n=!r&&hm(e,"getType")?e.getType():void 0;let s,a=n;if(t)if(n)s=t[n];else for(const[i,o]of Object.entries(t))a=i,s=o;if(!r&&a&&(hm(e,"getType")||(e.getType=()=>a),hm(e,"clone")||(e.clone=i=>(Tb(i),new e)),hm(e,"importJSON")||(e.importJSON=s&&s.$importJSON||(i=>new e().updateFromJSON(i))),!hm(e,"importDOM")&&s)){const{importDOM:i}=s;i&&(e.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function HB(e){const t=Rp();return ga(),new(t.resolveRegisteredNodeAfterReplacements(t.getRegisteredNode(e))).klass}const GB={next:"previous",previous:"next"};class Ob{constructor(t){this.origin=t}[Symbol.iterator](){return zb({hasNext:af,initial:this.getAdjacentCaret(),map:t=>t,step:t=>t.getAdjacentCaret()})}getAdjacentCaret(){return xa(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return xa(this.origin,this.direction)}remove(){const t=this.getNodeAtCaret();return t&&t.remove(),this}replaceOrInsert(t,r){const n=this.getNodeAtCaret();return t.is(this.origin)||t.is(n)||(n===null?this.insert(t):n.replace(t,r)),this}splice(t,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),o=new Map;for(let c=a.getAdjacentCaret();c!==null&&o.size<t;c=c.getAdjacentCaret()){const d=c.origin.getWritable();o.set(d.getKey(),d)}for(const c of s){if(o.size>0){const d=a.getNodeAtCaret();if(d){if(o.delete(d.getKey()),o.delete(c.getKey()),!(d.is(c)||a.origin.is(c))){const f=c.getParent();f&&f.is(i)&&c.remove(),d.replace(c)}}else d===null&&Ct(263,Array.from(o).join(" "))}else a.insert(c);a=xa(c,this.direction)}for(const c of o.values())c.remove();return this}}class np extends Ob{type="child";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:mo(t,this.direction)}getParentCaret(t="root"){return xa(Bb(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=b0(this.direction);return xa(this.getNodeAtCaret(),t)||mo(this.origin,t)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(t){return t instanceof np&&this.direction===t.direction&&this.origin.is(t.origin)}isSamePointCaret(t){return this.isSameNodeCaret(t)}}const VB={root:Ls,shadowRoot:ni};function b0(e){return GB[e]}function Bb(e,t="root"){return VB[t](e)?null:e}class nf extends Ob{type="sibling";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:xa(t,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return ft(this.origin)?mo(this.origin,this.direction):null}getParentCaret(t="root"){return xa(Bb(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=b0(this.direction);return xa(this.getNodeAtCaret(),t)||mo(this.origin.getParentOrThrow(),t)}isSamePointCaret(t){return t instanceof nf&&this.direction===t.direction&&this.origin.is(t.origin)}isSameNodeCaret(t){return(t instanceof nf||t instanceof sf)&&this.direction===t.direction&&this.origin.is(t.origin)}}class sf extends Ob{type="text";constructor(t,r){super(t),this.offset=r}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:of(t,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(t="root"){return xa(Bb(this.getParentAtCaret(),t),this.direction)}getFlipped(){return of(this.origin,b0(this.direction),this.offset)}isSamePointCaret(t){return t instanceof sf&&this.direction===t.direction&&this.origin.is(t.origin)&&this.offset===t.offset}isSameNodeCaret(t){return(t instanceof nf||t instanceof sf)&&this.direction===t.direction&&this.origin.is(t.origin)}getSiblingCaret(){return xa(this.origin,this.direction)}}function Eu(e){return e instanceof sf}function af(e){return e instanceof nf}function Cl(e){return e instanceof np}const KB={next:class extends sf{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends sf{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},qB={next:class extends nf{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends nf{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},XB={next:class extends np{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends np{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function xa(e,t){return e?new qB[t](e):null}function of(e,t,r){return e?new KB[t](e,Nu(e,r)):null}function Nu(e,t,r="error"){const n=e.getTextContentSize();let s=t==="next"?n:t==="previous"?0:t;return(s<0||s>n)&&(r!=="clamp"&&(function(a,...i){const o=new URL("https://lexical.dev/docs/error"),c=new URLSearchParams;c.append("code",a);for(const d of i)c.append("v",d);o.search=c.toString(),console.warn(`Minified Lexical warning #${a}; visit ${o.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(284,String(t),String(n),e.getKey()),s=s<0?0:n),s}function tE(e,t){return new JB(e,t)}function mo(e,t){return ft(e)?new XB[t](e):null}function YB(e){return e&&e.getChildCaret()||e}function Ub(e){return e&&YB(e.getAdjacentCaret())}class $b{type="node-caret-range";constructor(t,r,n){this.anchor=t,this.focus=r,this.direction=n}getLatest(){const t=this.anchor.getLatest(),r=this.focus.getLatest();return t===this.anchor&&r===this.focus?this:new $b(t,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const t=s=>{const a=this[s].getLatest();return Eu(a)?(function(i,o){const{direction:c,origin:d}=i,f=Nu(d,o==="focus"?b0(c):c);return tE(i,f-i.offset)})(a,s):null},r=t("anchor"),n=t("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[tE(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(t="root"){const r=Eu(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=Eu(n),a=i=>i.isSameNodeCaret(n)?null:Ub(i)||i.getParentCaret(t);return zb({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class JB{type="slice";constructor(t,r){this.caret=t,this.distance=r}getSliceIndices(){const{distance:t,caret:{offset:r}}=this,n=r+t;return n<r?[n,r]:[r,n]}getTextContent(){const[t,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(t,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:t,direction:r}}=this,[n,s]=this.getSliceIndices(),a=t.getTextContent();return of(t.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function Wb(e){return Ru(e,xa(On(),e.direction))}function QB(e){return Ru(e,e)}function Ru(e,t){return e.direction!==t.direction&&Ct(265),new $b(e,t,e.direction)}function zb(e){const{initial:t,hasNext:r,step:n,map:s}=e;let a=t;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function IA(e,t){const r=F1(e.origin,t.origin);switch(r===null&&Ct(275,e.origin.getKey(),t.origin.getKey()),r.type){case"same":{const n=e.type==="text",s=t.type==="text";return n&&s?(function(a,i){return Math.sign(a-i)})(e.offset,t.offset):e.type===t.type?0:n?-1:s?1:e.type==="child"?-1:1}case"ancestor":return e.type==="child"?-1:1;case"descendant":return t.type==="child"?1:-1;case"branch":return MA(r)}}function MA(e){const{a:t,b:r}=e,n=t.__key,s=r.__key;let a=t,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function l1(e,t){return t.is(e)}function rE(e){return ft(e)?[e.getLatest(),null]:[e.getParent(),e.getLatest()]}function F1(e,t){if(e.is(t))return{commonAncestor:e,type:"same"};const r=new Map;for(let[n,s]=rE(e);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=rE(t);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(l1(e,n)||Ct(276),{commonAncestor:n,type:"ancestor"}):s===null?(l1(t,n)||Ct(277),{commonAncestor:n,type:"descendant"}):((ft(a)||l1(e,a))&&(ft(s)||l1(t,s))&&n.is(a.getParent())&&n.is(s.getParent())||Ct(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function kc(e,t){const{type:r,key:n,offset:s}=e,a=BB(e.key);return r==="text"?(It(a)||Ct(266,a.getType(),n),of(a,t,s)):(ft(a)||Ct(267,a.getType(),n),tU(a,e.offset,t))}function lf(e,t){const{origin:r,direction:n}=t,s=n==="next";Eu(t)?e.set(r.getKey(),t.offset,"text"):af(t)?It(r)?e.set(r.getKey(),Nu(r,n),"text"):e.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(Cl(t)&&ft(r)||Ct(268),e.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function ZB(e){const t=Rt(),r=yt(t)?t:My();return P1(r,e),ya(r),r}function P1(e,t){lf(e.anchor,t.anchor),lf(e.focus,t.focus)}function nE(e){const{anchor:t,focus:r}=e,n=kc(t,"next"),s=kc(r,"next"),a=IA(n,s)<=0?"next":"previous";return Ru(i0(n,a),i0(s,a))}function Hb(e){const{direction:t,origin:r}=e,n=xa(r,b0(t)).getNodeAtCaret();return n?xa(n,t):mo(r.getParentOrThrow(),t)}function sE(e,t="root"){const r=[e];for(let n=Cl(e)?e.getParentCaret(t):e.getSiblingCaret();n!==null;n=n.getParentCaret(t))r.push(Hb(n));return r}function Ew(e){return!!e&&e.origin.isAttached()}function eU(e,t="removeEmptySlices"){if(e.isCollapsed())return e;const r="root",n="next";let s=t;const a=OA(e,n),i=sE(a.anchor,r),o=sE(a.focus.getFlipped(),r),c=new Set,d=[];for(const v of a.iterNodeCarets(r))if(Cl(v))c.add(v.origin.getKey());else if(af(v)){const{origin:w}=v;ft(w)&&!c.has(w.getKey())||d.push(w)}for(const v of d)v.remove();for(const v of a.getTextSlices()){if(!v)continue;const{origin:w}=v.caret,S=w.getTextContentSize(),E=Hb(xa(w,n)),k=w.getMode();if(Math.abs(v.distance)===S&&s==="removeEmptySlices"||k==="token"&&v.distance!==0)E.remove();else if(v.distance!==0){s="removeEmptySlices";let _=v.removeTextSlice();const N=v.caret.origin;if(k==="segmented"){const F=_.origin,A=Qn(F.getTextContent()).setStyle(F.getStyle()).setFormat(F.getFormat());E.replaceOrInsert(A),_=of(A,n,_.offset)}N.is(i[0].origin)&&(i[0]=_),N.is(o[0].origin)&&(o[0]=_.getFlipped())}}let f,p;for(const v of i)if(Ew(v)){f=uo(v);break}for(const v of o)if(Ew(v)){p=uo(v);break}const m=(function(v,w,S){if(!v||!w)return null;const E=v.getParentAtCaret(),k=w.getParentAtCaret();if(!E||!k)return null;const _=E.getParents().reverse();_.push(E);const N=k.getParents().reverse();N.push(k);const F=Math.min(_.length,N.length);let A;for(A=0;A<F&&_[A]===N[A];A++);const R=(L,O)=>{let G;for(let K=A;K<L.length;K++){const te=L[K];if(ni(te))return;!G&&O(te)&&(G=te)}return G},T=R(_,lo),D=T&&R(N,(L=>S.has(L.getKey())&&lo(L)));return T&&D?[T,D]:null})(f,p,c);if(m){const[v,w]=m;mo(v,"previous").splice(0,w.getChildren()),w.remove()}const y=[f,p,...i,...o].find(Ew);if(y)return QB(i0(uo(y),e.direction));Ct(269,JSON.stringify(i.map((v=>v.origin.__key))))}function uo(e){const t=(function(s){let a=s;for(;Cl(a);){const i=Ub(a);if(!Cl(i))break;a=i}return a})(e.getLatest()),{direction:r}=t;if(It(t.origin))return Eu(t)?t:of(t.origin,r,r);const n=t.getAdjacentCaret();return af(n)&&It(n.origin)?of(n.origin,r,b0(r)):t}function LA(e){return Eu(e)&&e.offset!==Nu(e.origin,e.direction)}function i0(e,t){return e.direction===t?e:e.getFlipped()}function OA(e,t){return e.direction===t?e:Ru(i0(e.focus,t),i0(e.anchor,t))}function tU(e,t,r){let n=mo(e,"next");for(let s=0;s<t;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return i0(n,r)}const BA=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,rU=BA?C.useLayoutEffect:C.useEffect,c1={tag:Dm};function UA({initialConfig:e,children:t}){const r=C.useMemo((()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:o,html:c}=e,d=SO(null,n),f=NB({editable:e.editable,html:c,namespace:s,nodes:a,onError:p=>i(p,f),theme:n});return(function(p,m){if(m!==null){if(m===void 0)p.update((()=>{const y=On();if(y.isEmpty()){const v=An();y.append(v);const w=BA?document.activeElement:null;(Rt()!==null||w!==null&&w===p.getRootElement())&&v.select()}}),c1);else if(m!==null)switch(typeof m){case"string":{const y=p.parseEditorState(m);p.setEditorState(y,c1);break}case"object":p.setEditorState(m,c1);break;case"function":p.update((()=>{On().isEmpty()&&m(p)}),c1)}}})(f,o),[f,d]}),[]);return rU((()=>{const n=e.editable,[s]=r;s.setEditable(n===void 0||n)}),[]),l.jsx(x0.Provider,{value:r,children:t})}const nU=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?C.useLayoutEffect:C.useEffect;function sU(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}function aU(){return(function(e){const[t]=Nl(),r=C.useMemo((()=>e(t)),[t,e]),[n,s]=C.useState((()=>r.initialValueFn())),a=C.useRef(n);return nU((()=>{const{initialValueFn:i,subscribe:o}=r,c=i();return a.current!==c&&(a.current=c,s(c)),o((d=>{a.current=d,s(d)}))}),[r,e]),n})(sU)}function iU(){return On().getTextContent()}function oU(e,t=!0){if(e)return!1;let r=iU();return t&&(r=r.trim()),r===""}function lU(e){if(!oU(e,!1))return!1;const t=On().getChildren(),r=t.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=t[n];if(Qr(s))return!1;if(ft(s)){if(!Cb(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let o=0;o<i;o++){const c=a[n];if(!It(c))return!1}}}return!0}function $A(e){return()=>lU(e)}const G_=new Map;function WA(e){const t={};if(!e)return t;const r=e.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(t[s.trim()]=a.trim())}return t}function aE(e){let t=G_.get(e);return t===void 0&&(t=WA(e),G_.set(e,t)),t}function zA(e){const t=Rp().getElementByKey(e.getKey());if(t===null)return null;const r=t.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(t)}function HA(e){return zA(Ls(e)?e:e.getParentOrThrow())}function iE(e){const t=HA(e);return t!==null&&t.direction==="rtl"}function GA(e,t){const r=e.getStartEndPoints();if(t.isSelected(e)&&!uc(t)&&r!==null){const[n,s]=r,a=e.isBackward(),i=n.getNode(),o=s.getNode(),c=t.is(i),d=t.is(o);if(c||d){const[f,p]=L_(e),m=i.is(o),y=t.is(a?o:i),v=t.is(a?i:o);let w,S=0;m?(S=f>p?p:f,w=f>p?f:p):y?(S=a?p:f,w=void 0):v&&(S=0,w=a?f:p),t.__text=t.__text.slice(S,w)}}return t}function cU(e){const t=e.getStyle(),r=WA(t);G_.set(t,r)}function uU(e,t){const r=e.getFormatType(),n=e.getIndent();r!==t.getFormatType()&&t.setFormat(r),n!==t.getIndent()&&t.setIndent(n)}function Kh(e,t,r=uU){if(e===null)return;const n=e.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,o]=n;a=My(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(o.key,o.offset,o.type);const c=Nw(i.getNode(),lo),d=Nw(o.getNode(),lo);ft(c)&&s.set(c.getKey(),c),ft(d)&&s.set(d.getKey(),d)}for(const i of e.getNodes())if(ft(i)&&lo(i))s.set(i.getKey(),i);else if(n===null){const o=Nw(i,lo);ft(o)&&s.set(o.getKey(),o)}for(const[i,o]of s){const c=t();r(o,c),o.replace(c,!0),a&&(i===a.anchor.key&&a.anchor.set(c.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(c.getKey(),a.focus.offset,a.focus.type))}a&&e.is(Rt())&&ya(a)}function VA(e){const t=KA(e);return t!==null&&t.writingMode==="vertical-rl"}function KA(e){const t=e.anchor.getNode();return ft(t)?zA(t):HA(t)}function oE(e,t){let r=VA(e)?!t:t;qA(e)&&(r=!r);const n=kc(e.focus,r?"previous":"next");if(LA(n))return!1;for(const s of Wb(n)){if(Cl(s))return!s.origin.isInline();if(!ft(s.origin)){if(Qr(s.origin))return!0;break}}return!1}function dU(e,t,r,n){e.modify(t?"extend":"move",r,n)}function qA(e){const t=KA(e);return t!==null&&t.direction==="rtl"}function lE(e,t,r){const n=qA(e);let s;s=VA(e)||n?!r:r,dU(e,t,s,"character")}function Nw(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function fU(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const XA=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,hU=XA&&"documentMode"in document?document.documentMode:null;!(!XA||!("InputEvent"in window)||hU)&&"getTargetRanges"in new window.InputEvent("input");function YA(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}function xf(...e){return()=>{for(let t=e.length-1;t>=0;t--)e[t]();e.length=0}}function Is(e,...t){const r=YA(...t);r.length>0&&e.classList.add(...r)}function Au(e,...t){const r=YA(...t);r.length>0&&e.classList.remove(...r)}function gU(e){return e?e.getAdjacentCaret():null}function mU(e,t){let r=e;for(;r!=null;){if(r instanceof t)return r;r=r.getParent()}return null}function pU(e){const t=zy(e,(r=>ft(r)&&!r.isInline()));return ft(t)||fU(4,e.__key),t}const zy=(e,t)=>{let r=e;for(;r!==On()&&r!=null;){if(t(r))return r;r=r.getParent()}return null};function Md(e,t){return e!==null&&Object.getPrototypeOf(e).constructor.name===t.name}function JA(e,t){const r=[],n=Array.from(e).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(t(s))r.push(s);else if(ft(s))for(const a of xU(s))n.push(a);return r}function xU(e){return yU(mo(e,"previous"))}function yU(e){return zb({hasNext:af,initial:e.getAdjacentCaret(),map:t=>t.origin.getLatest(),step:t=>t.getAdjacentCaret()})}function vU(e){const t=window.location.origin,r=n=>{if(n.origin!==t)return;const s=e.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const o=i.payload;if(o&&o.functionId==="makeChanges"){const c=o.args;if(c){const[d,f,p,m,y,v]=c;e.update((()=>{const w=Rt();if(yt(w)){const S=w.anchor;let E=S.getNode(),k=0,_=0;if(It(E)&&d>=0&&f>=0&&(k=d,_=d+f,w.setTextNodeRange(E,k,E,_)),k===_&&p===""||(w.insertRawText(p),E=S.getNode()),It(E)){k=m,_=m+y;const N=E.getTextContentSize();k=k>N?N:k,_=_>N?N:_,w.setTextNodeRange(E,k,E,_)}n.stopImmediatePropagation()}}))}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function wU(e,t){const r=t.body?t.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!ZA.has(i.nodeName)){const o=e8(i,e,s,!1);o!==null&&(n=n.concat(o))}}return(function(a){for(const i of a)i.getNextSibling()instanceof kb&&i.insertAfter(Tl());for(const i of a){const o=i.getChildren();for(const c of o)i.insertBefore(c);i.remove()}})(s),n}function _U(e,t){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=On().getChildren();for(let s=0;s<n.length;s++)QA(e,n[s],r,t);return r.innerHTML}function QA(e,t,r,n=null){let s=n===null||t.isSelected(n);const a=ft(t)&&t.excludeFromCopy("html");let i=t;if(n!==null){let y=Ib(t);y=It(y)&&n!==null?GA(n,y):y,i=y}const o=ft(i)?i.getChildren():[],c=Eb(e,i.getType());let d;d=c&&c.exportDOM!==void 0?c.exportDOM(e,i):i.exportDOM(e);const{element:f,after:p}=d;if(!f)return!1;const m=document.createDocumentFragment();for(let y=0;y<o.length;y++){const v=o[y],w=QA(e,v,m,n);!s&&ft(t)&&w&&t.extractWithChild(v,n,"html")&&(s=!0)}if(s&&!a){if((jn(f)||z_(f))&&f.append(m),r.append(f),p){const y=p.call(i,f);y&&(z_(f)?f.replaceChildren(y):f.replaceWith(y))}}else r.append(m);return s}const ZA=new Set(["STYLE","SCRIPT"]);function e8(e,t,r,n,s=new Map,a){let i=[];if(ZA.has(e.nodeName))return i;let o=null;const c=(function(v,w){const{nodeName:S}=v,E=w._htmlConversions.get(S.toLowerCase());let k=null;if(E!==void 0)for(const _ of E){const N=_(v);N!==null&&(k===null||(k.priority||0)<=(N.priority||0))&&(k=N)}return k!==null?k.conversion:null})(e,t),d=c?c(e):null;let f=null;if(d!==null){f=d.after;const v=d.node;if(o=Array.isArray(v)?v[v.length-1]:v,o!==null){for(const[,w]of s)if(o=w(o,a),!o)break;o&&i.push(...Array.isArray(v)?v:[o])}d.forChild!=null&&s.set(e.nodeName,d.forChild)}const p=e.childNodes;let m=[];const y=(o==null||!ni(o))&&(o!=null&&O_(o)||n);for(let v=0;v<p.length;v++)m.push(...e8(p[v],t,r,y,new Map(s),o));return f!=null&&(m=f(m)),ny(e)&&(m=bU(e,m,y?()=>{const v=new kb;return r.push(v),v}:An)),o==null?m.length>0?i=i.concat(m):ny(e)&&(function(v){return v.nextSibling==null||v.previousSibling==null?!1:H_(v.nextSibling)&&H_(v.previousSibling)})(e)&&(i=i.concat(Tl())):ft(o)&&o.append(...m),i}function bU(e,t,r){const n=e.style.textAlign,s=[];let a=[];for(let i=0;i<t.length;i++){const o=t[i];if(O_(o))n&&!o.getFormat()&&o.setFormat(n),s.push(o);else if(a.push(o),i===t.length-1||i<t.length-1&&O_(t[i+1])){const c=r();c.setFormat(n),c.append(...a),s.push(c),a=[]}}return s}function sy(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function SU(e,t=Rt()){return t==null&&sy(166),yt(t)&&t.isCollapsed()||t.getNodes().length===0?"":_U(e,t)}function kU(e,t=Rt()){return t==null&&sy(166),yt(t)&&t.isCollapsed()||t.getNodes().length===0?null:JSON.stringify(CU(e,t))}function cE(e,t,r){const n=e.getData("application/x-lexical-editor");if(n)try{const o=JSON.parse(n);if(o.namespace===r._config.namespace&&Array.isArray(o.nodes))return uE(r,TU(o.nodes),t)}catch{}const s=e.getData("text/html"),a=e.getData("text/plain");if(s&&a!==s)try{const o=new DOMParser().parseFromString((function(c){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:d=>d}).createHTML(c):c})(s),"text/html");return uE(r,wU(r,o),t)}catch{}const i=a||e.getData("text/uri-list");if(i!=null)if(yt(t)){const o=i.split(/(\r?\n|\t)/);o[o.length-1]===""&&o.pop();for(let c=0;c<o.length;c++){const d=Rt();if(yt(d)){const f=o[c];f===`
`||f===`\r
`?d.insertParagraph():f==="	"?d.insertNodes([v0()]):d.insertText(f)}}}else t.insertRawText(i)}function uE(e,t,r){e.dispatchCommand(YO,{nodes:t,selection:r})||(r.insertNodes(t),(function(n){if(yt(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=kc(s,"previous");if(i)if(Eu(i))a=i.origin;else{const o=Ru(i,mo(On(),"next").getFlipped());for(const c of o){if(It(c.origin)){a=c.origin;break}if(ft(c.origin)&&!c.origin.isInline())break}}if(a&&It(a)){const o=a.getFormat(),c=a.getStyle();n.format===o&&n.style===c||(n.format=o,n.style=c,n.dirty=!0)}}})(r))}function t8(e,t,r,n=[]){let s=t===null||r.isSelected(t);const a=ft(r)&&r.excludeFromCopy("html");let i=r;if(t!==null){let d=Ib(r);d=It(d)&&t!==null?GA(t,d):d,i=d}const o=ft(i)?i.getChildren():[],c=(function(d){const f=d.exportJSON(),p=d.constructor;if(f.type!==p.getType()&&sy(58,p.name),ft(d)){const m=f.children;Array.isArray(m)||sy(59,p.name)}return f})(i);if(It(i)){const d=i.__text;d.length>0?c.text=d:s=!1}for(let d=0;d<o.length;d++){const f=o[d],p=t8(e,t,f,c.children);!s&&ft(r)&&p&&r.extractWithChild(f,t,"clone")&&(s=!0)}if(s&&!a)n.push(c);else if(Array.isArray(c.children))for(let d=0;d<c.children.length;d++){const f=c.children[d];n.push(f)}return s}function CU(e,t){const r=[],n=On().getChildren();for(let s=0;s<n.length;s++)t8(e,t,n[s],r);return{namespace:e._config.namespace,nodes:r}}function TU(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],s=_B(n);It(s)&&cU(s),t.push(s)}return t}let bh=null;async function dE(e,t,r){if(bh!==null)return!1;if(t!==null)return new Promise(((d,f)=>{e.update((()=>{d(fE(e,t,r))}))}));const n=e.getRootElement(),s=e._window||window,a=window.document,i=zo(s);if(n===null||i===null)return!1;const o=a.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(a.createTextNode("#")),n.append(o);const c=new Range;return c.setStart(o,0),c.setEnd(o,1),i.removeAllRanges(),i.addRange(c),new Promise(((d,f)=>{const p=e.registerCommand(Dy,(m=>(Md(m,ClipboardEvent)&&(p(),bh!==null&&(window.clearTimeout(bh),bh=null),d(fE(e,m,r))),!0)),EB);bh=window.setTimeout((()=>{p(),bh=null,d(!1)}),50),a.execCommand("copy"),o.remove()}))}function fE(e,t,r){if(r===void 0){const s=zo(e._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!Pp(e,a,i))return!1;const o=Rt();if(o===null)return!1;r=NU(o)}t.preventDefault();const n=t.clipboardData;return n!==null&&(AU(n,r),!0)}const EU=[["text/html",SU],["application/x-lexical-editor",kU]];function NU(e=Rt()){const t={"text/plain":e?e.getTextContent():""};if(e){const r=Rp();for(const[n,s]of EU){const a=s(r,e);a!==null&&(t[n]=a)}}return t}function AU(e,t){for(const r in t){const n=t[r];n!==void 0&&e.setData(r,n)}}function hE(e,t){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(e,t);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(e,t);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const S0=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,jU=S0&&"documentMode"in document?document.documentMode:null,FU=!(!S0||!("InputEvent"in window)||jU)&&"getTargetRanges"in new window.InputEvent("input"),PU=S0&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),gE=S0&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,DU=S0&&/^(?=.*Chrome).*/i.test(navigator.userAgent),RU=S0&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!DU,mE=dr("DRAG_DROP_PASTE_FILE");let Ip=class r8 extends Ma{static getType(){return"quote"}static clone(t){return new r8(t.__key)}createDOM(t){const r=document.createElement("blockquote");return Is(r,t.theme.quote),r}updateDOM(t,r){return!1}static importDOM(){return{blockquote:t=>({conversion:IU,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(jn(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return Mp().updateFromJSON(t)}insertNewAfter(t,r){const n=An(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const t=An();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}canMergeWhenEmpty(){return!0}};function Mp(){return ai(new Ip)}function pE(e){return e instanceof Ip}let Lp=class n8 extends Ma{static getType(){return"heading"}static clone(t){return new n8(t.__tag,t.__key)}constructor(t,r){super(r),this.__tag=t}getTag(){return this.__tag}setTag(t){const r=this.getWritable();return this.__tag=t,r}createDOM(t){const r=this.__tag,n=document.createElement(r),s=t.theme.heading;if(s!==void 0){const a=s[r];Is(n,a)}return n}updateDOM(t,r,n){return t.__tag!==this.__tag}static importDOM(){return{h1:t=>({conversion:Sh,priority:0}),h2:t=>({conversion:Sh,priority:0}),h3:t=>({conversion:Sh,priority:0}),h4:t=>({conversion:Sh,priority:0}),h5:t=>({conversion:Sh,priority:0}),h6:t=>({conversion:Sh,priority:0}),p:t=>{const r=t.firstChild;return r!==null&&xE(r)?{conversion:()=>({node:null}),priority:3}:null},span:t=>xE(t)?{conversion:r=>({node:Su("h1")}),priority:3}:null}}exportDOM(t){const{element:r}=super.exportDOM(t);if(jn(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return Su(t.tag).updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTag(t.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(t,r=!0){const n=t?t.anchor.offset:0,s=this.getLastDescendant(),a=!s||t&&t.anchor.key===s.getKey()&&n===s.getTextContentSize()||!t?An():Su(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&t){const o=An();o.select(),this.replace(o,!0)}return a}collapseAtStart(){const t=this.isEmpty()?An():Su(this.getTag());return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}extractWithChild(){return!0}};function xE(e){return e.nodeName.toLowerCase()==="span"&&e.style.fontSize==="26pt"}function Sh(e){const t=e.nodeName.toLowerCase();let r=null;return t!=="h1"&&t!=="h2"&&t!=="h3"&&t!=="h4"&&t!=="h5"&&t!=="h6"||(r=Su(t),e.style!==null&&(Mb(e,r),r.setFormat(e.style.textAlign))),{node:r}}function IU(e){const t=Mp();return e.style!==null&&(t.setFormat(e.style.textAlign),Mb(e,t)),{node:t}}function Su(e="h1"){return ai(new Lp(e))}function MU(e){return e instanceof Lp}function u1(e){let t=null;if(Md(e,DragEvent)?t=e.dataTransfer:Md(e,ClipboardEvent)&&(t=e.clipboardData),t===null)return[!1,[],!1];const r=t.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(t.files),s]}function yE(e){const t=Rt();if(!yt(t))return!1;const r=new Set,n=t.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const o=zy(a,(d=>ft(d)&&!d.isInline()));if(o===null)continue;const c=o.getKey();o.canIndent()&&!r.has(c)&&(r.add(c),e(o))}return r.size>0}function vE(e){const t=Du(e);return Qr(t)}function Aw(e){for(const t of["lowercase","uppercase","capitalize"])e.hasFormat(t)&&e.toggleFormat(t)}function LU(e){return xf(e.registerCommand(hb,(t=>{const r=Rt();return!!Ea(r)&&(r.clear(),!0)}),Hr),e.registerCommand(Wd,(t=>{const r=Rt();return yt(r)?(r.deleteCharacter(t),!0):!!Ea(r)&&(r.deleteNodes(),!0)}),Hr),e.registerCommand(tp,(t=>{const r=Rt();return!!yt(r)&&(r.deleteWord(t),!0)}),Hr),e.registerCommand(rp,(t=>{const r=Rt();return!!yt(r)&&(r.deleteLine(t),!0)}),Hr),e.registerCommand(Hh,(t=>{const r=Rt();if(typeof t=="string")r!==null&&r.insertText(t);else{if(r===null)return!1;const n=t.dataTransfer;if(n!=null)cE(n,r,e);else if(yt(r)){const s=t.data;return s&&r.insertText(s),!0}}return!0}),Hr),e.registerCommand(j_,(()=>{const t=Rt();return!!yt(t)&&(t.removeText(),!0)}),Hr),e.registerCommand(Da,(t=>{const r=Rt();return!!yt(r)&&(r.formatText(t),!0)}),Hr),e.registerCommand(Z6,(t=>{const r=Rt();if(!yt(r)&&!Ea(r))return!1;const n=r.getNodes();for(const s of n){const a=zy(s,(i=>ft(i)&&!i.isInline()));a!==null&&a.setFormat(t)}return!0}),Hr),e.registerCommand(zh,(t=>{const r=Rt();return!!yt(r)&&(r.insertLineBreak(t),!0)}),Hr),e.registerCommand(ep,(()=>{const t=Rt();return!!yt(t)&&(t.insertParagraph(),!0)}),Hr),e.registerCommand(eB,(()=>(yB([v0()]),!0)),Hr),e.registerCommand(tB,(()=>yE((t=>{const r=t.getIndent();t.setIndent(r+1)}))),Hr),e.registerCommand(b4,(()=>yE((t=>{const r=t.getIndent();r>0&&t.setIndent(Math.max(0,r-1))}))),Hr),e.registerCommand(G6,(t=>{const r=Rt();if(Ea(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(yt(r)){const n=U_(r.focus,!0);if(!t.shiftKey&&Qr(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),t.preventDefault(),!0}return!1}),Hr),e.registerCommand(V6,(t=>{const r=Rt();if(Ea(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(yt(r)){if((function(s){const a=s.focus;return a.key==="root"&&a.offset===On().getChildrenSize()})(r))return t.preventDefault(),!0;const n=U_(r.focus,!1);if(!t.shiftKey&&Qr(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),t.preventDefault(),!0}return!1}),Hr),e.registerCommand(H6,(t=>{const r=Rt();if(Ea(r)){const n=r.getNodes();if(n.length>0)return t.preventDefault(),iE(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!yt(r))return!1;if(oE(r,!0)){const n=t.shiftKey;return t.preventDefault(),lE(r,n,!0),!0}return!1}),Hr),e.registerCommand(z6,(t=>{const r=Rt();if(Ea(r)){const s=r.getNodes();if(s.length>0)return t.preventDefault(),iE(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!yt(r))return!1;const n=t.shiftKey;return!!oE(r,!1)&&(t.preventDefault(),lE(r,n,!1),!0)}),Hr),e.registerCommand(q6,(t=>{if(vE(t.target))return!1;const r=Rt();if(yt(r)){if((function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(Ls(a))return!1;const i=pU(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))})(r))return t.preventDefault(),e.dispatchCommand(b4,void 0);if(gE&&navigator.language==="ko-KR")return!1}else if(!Ea(r))return!1;return t.preventDefault(),e.dispatchCommand(Wd,!0)}),Hr),e.registerCommand(Y6,(t=>{if(vE(t.target))return!1;const r=Rt();return!(!yt(r)&&!Ea(r))&&(t.preventDefault(),e.dispatchCommand(Wd,!1))}),Hr),e.registerCommand(Y1,(t=>{const r=Rt();if(!yt(r))return!1;if(Aw(r),t!==null){if((gE||PU||RU)&&FU)return!1;if(t.preventDefault(),t.shiftKey)return e.dispatchCommand(zh,!1)}return e.dispatchCommand(ep,void 0)}),Hr),e.registerCommand(X6,(()=>{const t=Rt();return!!yt(t)&&(e.blur(),!0)}),Hr),e.registerCommand(Q6,(t=>{const[,r]=u1(t);if(r.length>0){const s=hE(t.clientX,t.clientY);if(s!==null){const{offset:a,node:i}=s,o=Du(i);if(o!==null){const c=My();if(It(o))c.anchor.set(o.getKey(),a,"text"),c.focus.set(o.getKey(),a,"text");else{const f=o.getParentOrThrow().getKey(),p=o.getIndexWithinParent()+1;c.anchor.set(f,p,"element"),c.focus.set(f,p,"element")}const d=G1(c);ya(d)}e.dispatchCommand(mE,r)}return t.preventDefault(),!0}const n=Rt();return!!yt(n)}),Hr),e.registerCommand(eA,(t=>{const[r]=u1(t),n=Rt();return!(r&&!yt(n))}),Hr),e.registerCommand(tA,(t=>{const[r]=u1(t),n=Rt();if(r&&!yt(n))return!1;const s=hE(t.clientX,t.clientY);if(s!==null){const a=Du(s.node);Qr(a)&&t.preventDefault()}return!0}),Hr),e.registerCommand(F_,(()=>(RB(),!0)),Hr),e.registerCommand(Dy,(t=>(dE(e,Md(t,ClipboardEvent)?t:null),!0)),Hr),e.registerCommand(xb,(t=>((async function(r,n){await dE(n,Md(r,ClipboardEvent)?r:null),n.update((()=>{const s=Rt();yt(s)?s.removeText():Ea(s)&&s.getNodes().forEach((a=>a.remove()))}))})(t,e),!0)),Hr),e.registerCommand(gb,(t=>{const[,r,n]=u1(t);return r.length>0&&!n?(e.dispatchCommand(mE,r),!0):_0(t.target)&&Nb(t.target)?!1:Rt()!==null&&((function(s,a){s.preventDefault(),a.update((()=>{const i=Rt(),o=Md(s,InputEvent)||Md(s,KeyboardEvent)?null:s.clipboardData;o!=null&&i!==null&&cE(o,i,a)}),{tag:SB})})(t,e),!0)}),Hr),e.registerCommand(K6,(t=>{const r=Rt();return yt(r)&&Aw(r),!1}),Hr),e.registerCommand(J6,(t=>{const r=Rt();return yt(r)&&Aw(r),!1}),Hr))}const V_=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?C.useLayoutEffect:C.useEffect;function wE(e){return e.getEditorState().read($A(e.isComposing()))}function s8({contentEditable:e,placeholder:t=null,ErrorBoundary:r}){const[n]=Nl(),s=(function(a,i){const[o,c]=C.useState((()=>a.getDecorators()));return V_((()=>a.registerDecoratorListener((d=>{Ck.flushSync((()=>{c(d)}))}))),[a]),C.useEffect((()=>{c(a.getDecorators())}),[a]),C.useMemo((()=>{const d=[],f=Object.keys(o);for(let p=0;p<f.length;p++){const m=f[p],y=l.jsx(i,{onError:w=>a._onError(w),children:l.jsx(C.Suspense,{fallback:null,children:o[m]})}),v=a.getElementByKey(m);v!==null&&d.push(Ck.createPortal(y,v,m))}return d}),[i,o,a])})(n,r);return(function(a){V_((()=>xf(LU(a),vU(a))),[a])})(n),l.jsxs(l.Fragment,{children:[e,l.jsx(OU,{content:t}),s]})}function OU({content:e}){const[t]=Nl(),r=(function(s){const[a,i]=C.useState((()=>wE(s)));return V_((()=>{function o(){const c=wE(s);i(c)}return o(),xf(s.registerUpdateListener((()=>{o()})),s.registerEditableListener((()=>{o()})))}),[s]),a})(t),n=aU();return r?typeof e=="function"?e(n):e:null}const a8=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?C.useLayoutEffect:C.useEffect;function BU({editor:e,ariaActiveDescendant:t,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:o,ariaLabel:c,ariaLabelledBy:d,ariaMultiline:f,ariaOwns:p,ariaRequired:m,autoCapitalize:y,className:v,id:w,role:S="textbox",spellCheck:E=!0,style:k,tabIndex:_,"data-testid":N,...F},A){const[R,T]=C.useState(e.isEditable()),D=C.useCallback((O=>{O&&O.ownerDocument&&O.ownerDocument.defaultView?e.setRootElement(O):e.setRootElement(null)}),[e]),L=C.useMemo((()=>(function(...O){return G=>{O.forEach((K=>{typeof K=="function"?K(G):K!=null&&(K.current=G)}))}})(A,D)),[D,A]);return a8((()=>(T(e.isEditable()),e.registerEditableListener((O=>{T(O)})))),[e]),l.jsx("div",{"aria-activedescendant":R?t:void 0,"aria-autocomplete":R?r:"none","aria-controls":R?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":R&&S==="combobox"?!!i:void 0,...o!=null?{"aria-invalid":o}:{},"aria-label":c,"aria-labelledby":d,"aria-multiline":f,"aria-owns":R?p:void 0,"aria-readonly":!R||void 0,"aria-required":m,autoCapitalize:y,className:v,contentEditable:R,"data-testid":N,id:w,ref:L,role:S,spellCheck:E,style:k,tabIndex:_,...F})}const UU=C.forwardRef(BU);function _E(e){return e.getEditorState().read($A(e.isComposing()))}const i8=C.forwardRef($U);function $U(e,t){const{placeholder:r,...n}=e,[s]=Nl();return l.jsxs(l.Fragment,{children:[l.jsx(UU,{editor:s,...n,ref:t}),r!=null&&l.jsx(WU,{editor:s,content:r})]})}function WU({content:e,editor:t}){const r=(function(i){const[o,c]=C.useState((()=>_E(i)));return a8((()=>{function d(){const f=_E(i);c(f)}return d(),xf(i.registerUpdateListener((()=>{d()})),i.registerEditableListener((()=>{d()})))}),[i]),o})(t),[n,s]=C.useState(t.isEditable());if(C.useLayoutEffect((()=>(s(t.isEditable()),t.registerEditableListener((i=>{s(i)})))),[t]),!r)return null;let a=null;return typeof e=="function"?a=e(n):e!==null&&(a=e),a===null?null:l.jsx("div",{"aria-hidden":!0,children:a})}const d1=0,K_=1,q_=2,Io=0,zU=1,bE=2,HU=3,GU=4;function VU(e,t,r,n,s){if(e===null||r.size===0&&n.size===0&&!s)return Io;const a=t._selection,i=e._selection;if(s)return zU;if(!(yt(a)&&yt(i)&&i.isCollapsed()&&a.isCollapsed()))return Io;const o=(function(E,k,_){const N=E._nodeMap,F=[];for(const A of k){const R=N.get(A);R!==void 0&&F.push(R)}for(const[A,R]of _){if(!R)continue;const T=N.get(A);T===void 0||Ls(T)||F.push(T)}return F})(t,r,n);if(o.length===0)return Io;if(o.length>1){const E=t._nodeMap,k=E.get(a.anchor.key),_=E.get(i.anchor.key);return k&&_&&!e._nodeMap.has(k.__key)&&It(k)&&k.__text.length===1&&a.anchor.offset===1?bE:Io}const c=o[0],d=e._nodeMap.get(c.__key);if(!It(d)||!It(c)||d.__mode!==c.__mode)return Io;const f=d.__text,p=c.__text;if(f===p)return Io;const m=a.anchor,y=i.anchor;if(m.key!==y.key||m.type!=="text")return Io;const v=m.offset,w=y.offset,S=p.length-f.length;return S===1&&w===v-1?bE:S===-1&&w===v+1?HU:S===-1&&w===v?GU:Io}function KU(e,t){let r=Date.now(),n=Io;return(s,a,i,o,c,d)=>{const f=Date.now();if(d.has(ey))return n=Io,r=f,q_;const p=VU(s,a,o,c,e.isComposing()),m=(()=>{const y=i===null||i.editor===e,v=d.has(bB);if(!v&&y&&d.has(Dm))return d1;if(s===null)return K_;const w=a._selection;return o.size>0||c.size>0?v===!1&&p!==Io&&p===n&&f<r+t&&y||o.size===1&&(function(S,E,k){const _=E._nodeMap.get(S),N=k._nodeMap.get(S),F=E._selection,A=k._selection;return!(yt(F)&&yt(A)&&F.anchor.type==="element"&&F.focus.type==="element"&&A.anchor.type==="text"&&A.focus.type==="text"||!It(_)||!It(N)||_.__parent!==N.__parent)&&JSON.stringify(E.read((()=>_.exportJSON())))===JSON.stringify(k.read((()=>N.exportJSON())))})(Array.from(o)[0],s,a)?d1:K_:w!==null?d1:q_})();return r=f,n=p,m}}function SE(e){e.undoStack=[],e.redoStack=[],e.current=null}function qU(e,t,r){const n=KU(e,r);return xf(e.registerCommand(mb,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(c.length!==0){const d=i.current,f=c.pop();d!==null&&(o.push(d),a.dispatchCommand(r1,!0)),c.length===0&&a.dispatchCommand(n1,!1),i.current=f||null,f&&f.editor.setEditorState(f.editorState,{tag:ey})}})(e,t),!0)),Hr),e.registerCommand(pb,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(o.length!==0){const d=i.current;d!==null&&(c.push(d),a.dispatchCommand(n1,!0));const f=o.pop();o.length===0&&a.dispatchCommand(r1,!1),i.current=f||null,f&&f.editor.setEditorState(f.editorState,{tag:ey})}})(e,t),!0)),Hr),e.registerCommand(nB,(()=>(SE(t),!1)),Hr),e.registerCommand(sB,(()=>(SE(t),e.dispatchCommand(r1,!1),e.dispatchCommand(n1,!1),!0)),Hr),e.registerUpdateListener((({editorState:a,prevEditorState:i,dirtyLeaves:o,dirtyElements:c,tags:d})=>{const f=t.current,p=t.redoStack,m=t.undoStack,y=f===null?null:f.editorState;if(f!==null&&a===y)return;const v=n(i,a,f,o,c,d);if(v===K_)p.length!==0&&(t.redoStack=[],e.dispatchCommand(r1,!1)),f!==null&&(m.push({...f}),e.dispatchCommand(n1,!0));else if(v===q_)return;t.current={editor:e,editorState:a}})))}function XU(){return{current:null,redoStack:[],undoStack:[]}}function o8({delay:e,externalHistoryState:t}){const[r]=Nl();return(function(n,s,a=1e3){const i=C.useMemo((()=>s||XU()),[s]);C.useEffect((()=>qU(n,i,a)),[a,n,i])})(r,t,e),null}function l8({defaultSelection:e}){const[t]=Nl();return C.useEffect((()=>{t.focus((()=>{const r=document.activeElement,n=t.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})}),{defaultSelection:e})}),[e,t]),null}function X_(e,t){return X_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},X_(e,t)}var kE={error:null},YU=(function(e){var t,r;function n(){for(var a,i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return(a=e.call.apply(e,[this].concat(o))||this).state=kE,a.resetErrorBoundary=function(){for(var d,f=arguments.length,p=new Array(f),m=0;m<f;m++)p[m]=arguments[m];a.props.onReset==null||(d=a.props).onReset.apply(d,p),a.reset()},a}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,X_(t,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(kE)},s.componentDidCatch=function(a,i){var o,c;(o=(c=this.props).onError)==null||o.call(c,a,i)},s.componentDidUpdate=function(a,i){var o,c,d,f,p=this.state.error,m=this.props.resetKeys;p!==null&&i.error!==null&&((d=a.resetKeys)===void 0&&(d=[]),(f=m)===void 0&&(f=[]),d.length!==f.length||d.some((function(y,v){return!Object.is(y,f[v])})))&&((o=(c=this.props).onResetKeysChange)==null||o.call(c,a.resetKeys,m),this.reset())},s.render=function(){var a=this.state.error,i=this.props,o=i.fallbackRender,c=i.FallbackComponent,d=i.fallback;if(a!==null){var f={error:a,resetErrorBoundary:this.resetErrorBoundary};if(C.isValidElement(d))return d;if(typeof o=="function")return o(f);if(c)return C.createElement(c,f);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n})(C.Component);function c8({children:e,onError:t}){return l.jsx(YU,{fallback:l.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:t,children:e})}const Gb=/^(\d+(?:\.\d+)?)px$/,qh={BOTH:3,NO_STATUS:0,ROW:1};class k0 extends Ma{static getType(){return"tablecell"}static clone(t){return new k0(t.__headerState,t.__colSpan,t.__width,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__rowSpan=t.__rowSpan,this.__backgroundColor=t.__backgroundColor,this.__verticalAlign=t.__verticalAlign}static importDOM(){return{td:t=>({conversion:CE,priority:0}),th:t=>({conversion:CE,priority:0})}}static importJSON(t){return u8().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeaderStyles(t.headerState).setColSpan(t.colSpan||1).setRowSpan(t.rowSpan||1).setWidth(t.width||void 0).setBackgroundColor(t.backgroundColor||null).setVerticalAlign(t.verticalAlign||void 0)}constructor(t=qh.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=t,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(t){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),Y_(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),Is(r,t.theme.tableCell,this.hasHeader()&&t.theme.tableCellHeader),r}exportDOM(t){const r=super.exportDOM(t);if(jn(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...Y_(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(t){const r=this.getWritable();return r.__colSpan=t,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(t){const r=this.getWritable();return r.__rowSpan=t,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(t,r=qh.BOTH){const n=this.getWritable();return n.__headerState=t&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(t){const r=this.getWritable();return r.__width=t,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(t){const r=this.getWritable();return r.__backgroundColor=t,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(t){const r=this.getWritable();return r.__verticalAlign=t||void 0,r}toggleHeaderStyle(t){const r=this.getWritable();return(r.__headerState&t)===t?r.__headerState-=t:r.__headerState+=t,r}hasHeaderState(t){return(this.getHeaderStyles()&t)===t}hasHeader(){return this.getLatest().__headerState!==qh.NO_STATUS}updateDOM(t){return t.__headerState!==this.__headerState||t.__width!==this.__width||t.__colSpan!==this.__colSpan||t.__rowSpan!==this.__rowSpan||t.__backgroundColor!==this.__backgroundColor||t.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function Y_(e){return e==="middle"||e==="bottom"}function CE(e){const t=e,r=e.nodeName.toLowerCase();let n;Gb.test(t.style.width)&&(n=parseFloat(t.style.width));const s=u8(r==="th"?qh.ROW:qh.NO_STATUS,t.colSpan,n);s.__rowSpan=t.rowSpan;const a=t.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=t.style.verticalAlign;Y_(i)&&(s.__verticalAlign=i);const o=t.style,c=(o&&o.textDecoration||"").split(" "),d=o.fontWeight==="700"||o.fontWeight==="bold",f=c.includes("line-through"),p=o.fontStyle==="italic",m=c.includes("underline");return{after:y=>{const v=[];let w=null;const S=()=>{if(w){const E=w.getFirstChild();xc(E)&&w.getChildrenSize()===1&&E.remove()}};for(const E of y)LB(E)||It(E)||xc(E)?(It(E)&&(d&&E.toggleFormat("bold"),f&&E.toggleFormat("strikethrough"),p&&E.toggleFormat("italic"),m&&E.toggleFormat("underline")),w?w.append(E):(w=An().append(E),v.push(w))):(v.push(E),S(),w=null);return S(),v.length===0&&v.push(An()),v},node:s}}function u8(e=qh.NO_STATUS,t=1,r){return ai(new k0(e,t,r))}function sp(e){return e instanceof k0}function J_(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class C0 extends Ma{static getType(){return"tablerow"}static clone(t){return new C0(t.__height,t.__key)}static importDOM(){return{tr:t=>({conversion:JU,priority:0})}}static importJSON(t){return d8().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeight(t.height)}constructor(t,r){super(r),this.__height=t}exportJSON(){const t=this.getHeight();return{...super.exportJSON(),...t===void 0?void 0:{height:t}}}createDOM(t){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),Is(r,t.theme.tableRow),r}extractWithChild(t,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(t){const r=this.getWritable();return r.__height=t,r}getHeight(){return this.getLatest().__height}updateDOM(t){return t.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function JU(e){const t=e;let r;return Gb.test(t.style.height)&&(r=parseFloat(t.style.height)),{after:n=>JA(n,sp),node:d8(r)}}function d8(e){return ai(new C0(e))}function f8(e){return e instanceof C0}const h8=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,QU=h8&&"documentMode"in document?document.documentMode:null;h8&&"InputEvent"in window&&!QU&&new window.InputEvent("input");function ZU(e,t,r){const n=[];let s=null,a=null;function i(c){let d=n[c];return d===void 0&&(n[c]=d=[]),d}const o=e.getChildren();for(let c=0;c<o.length;c++){const d=o[c];f8(d)||J_(209);const f=i(c);for(let p=d.getFirstChild(),m=0;p!=null;p=p.getNextSibling()){for(sp(p)||J_(147);f[m]!==void 0;)m++;const y={cell:p,startColumn:m,startRow:c},{__rowSpan:v,__colSpan:w}=p;for(let S=0;S<v&&!(c+S>=o.length);S++){const E=i(c+S);for(let k=0;k<w;k++)E[m+k]=y}}}return[n,s,a]}function gm(e){return jn(e)&&e.nodeName==="TABLE"}function e$(e,t){for(let r=t,n=null;r!==null;r=r.getParent()){if(e.is(r))return n;sp(r)&&(n=r)}return null}function t$(e,t,r){return e$(e,Du(t,r))}function TE(e,t,r){if(!t.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=t.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}Au(e,...n),Is(e,...s)}const r$=new WeakSet;function EE(e=Rp()){return r$.has(e)}class Op extends Ma{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(t){const r=this.getWritable();return r.__colWidths=t,r}static clone(t){return new Op(t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__colWidths=t.__colWidths,this.__rowStriping=t.__rowStriping,this.__frozenColumnCount=t.__frozenColumnCount,this.__frozenRowCount=t.__frozenRowCount}static importDOM(){return{table:t=>({conversion:n$,priority:1})}}static importJSON(t){return g8().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setRowStriping(t.rowStriping||!1).setFrozenColumns(t.frozenColumnCount||0).setFrozenRows(t.frozenRowCount||0).setColWidths(t.colWidths)}constructor(t){super(t),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(t,r,n){return n==="html"}getDOMSlot(t){const r=gm(t)?t:t.querySelector("table");return gm(r)||J_(229),super.getDOMSlot(t).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(t,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),WB(s),Is(n,t.theme.table),this.updateTableElement(null,n,t),EE(r)){const a=document.createElement("div"),i=t.theme.tableScrollableWrapper;return i?Is(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,t),a}return n}updateTableWrapper(t,r,n,s){this.__frozenColumnCount!==(t?t.__frozenColumnCount:0)&&(function(a,i,o,c){c>0?(Is(a,o.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(Au(a,o.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))})(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(t?t.__frozenRowCount:0)&&(function(a,i,o,c){c>0?(Is(a,o.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(Au(a,o.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))})(r,n,s,this.__frozenRowCount)}updateTableElement(t,r,n){this.__style!==(t?t.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!t&&t.__rowStriping)&&(function(s,a,i){i?(Is(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(Au(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))})(r,n,this.__rowStriping),(function(s,a,i,o){const c=s.querySelector("colgroup");if(!c)return;const d=[];for(let f=0;f<i;f++){const p=document.createElement("col"),m=o&&o[f];m&&(p.style.width=`${m}px`),d.push(p)}c.replaceChildren(...d)})(r,0,this.getColumnCount(),this.getColWidths()),TE(r,n,this.getFormatType())}updateDOM(t,r,n){const s=this.getDOMSlot(r).element;return r===s===EE()||(jn(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(t,r,s,n),this.updateTableElement(t,s,n),!1);var a}exportDOM(t){const r=super.exportDOM(t),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!gm(s)&&jn(s)&&(s=s.querySelector("table")),!gm(s))return null;TE(s,t._config,this.getFormatType());const[a]=ZU(this),i=new Map;for(const f of a)for(const p of f){const m=p.cell.getKey();i.has(m)||i.set(m,{colSpan:p.cell.getColSpan(),startColumn:p.startColumn})}const o=new Set;for(const f of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const p=f.getAttribute("data-temporary-table-cell-lexical-key");if(p){const m=i.get(p);if(f.removeAttribute("data-temporary-table-cell-lexical-key"),m){i.delete(p);for(let y=0;y<m.colSpan;y++)o.add(y+m.startColumn)}}}const c=s.querySelector(":scope > colgroup");if(c){const f=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter(((p,m)=>o.has(m)));c.replaceChildren(...f)}const d=s.querySelectorAll(":scope > tr");if(d.length>0){const f=document.createElement("tbody");for(const p of d)f.appendChild(p);s.append(f)}return s},element:!gm(n)&&jn(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(t,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let o=0;o<i.length;o++){const c=i[o];if(c==null)continue;const{elem:d}=c,f=t$(this,d);if(f!==null&&t.is(f))return{x:o,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(t,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[t<a.length?t:a.length-1];return i??null}getDOMCellFromCordsOrThrow(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(s==null)return null;const a=Du(s.elem);return sp(a)?a:null}getCellNodeFromCordsOrThrow(t,r,n){const s=this.getCellNodeFromCords(t,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(t){const r=this.getWritable();return r.__rowStriping=t,r}setFrozenColumns(t){const r=this.getWritable();return r.__frozenColumnCount=t,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(t){const r=this.getWritable();return r.__frozenRowCount=t,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const t=this.getFirstChild();if(!t)return 0;let r=0;return t.getChildren().forEach((n=>{sp(n)&&(r+=n.getColSpan())})),r}}function n$(e){const t=g8();e.hasAttribute("data-lexical-row-striping")&&t.setRowStriping(!0),e.hasAttribute("data-lexical-frozen-column")&&t.setFrozenColumns(1),e.hasAttribute("data-lexical-frozen-row")&&t.setFrozenRows(1);const r=e.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!Gb.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&t.setColWidths(n)}return{after:n=>JA(n,f8),node:t}}function g8(){return ai(new Op)}function ku(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function Q_(e){let t=1,r=e.getParent();for(;r!=null;){if(tn(r)){const n=r.getParent();if(_r(n)){t++,r=n.getParent();continue}ku(40)}return t}return t}function Z_(e){let t=e.getParent();_r(t)||ku(40);let r=t;for(;r!==null;)r=r.getParent(),_r(r)&&(t=r);return t}function m8(e){let t=[];const r=e.getChildren().filter(tn);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();_r(a)?t=t.concat(m8(a)):t.push(s)}return t}function wl(e){return tn(e)&&_r(e.getFirstChild())}function NE(e){return Li().append(e)}function p8(e,t){return tn(e)&&(t.length===0||t.length===1&&e.is(t[0])&&e.getChildrenSize()===0)}function AE(e){const t=Rt();if(t!==null){let r=t.getNodes();if(yt(t)){const s=t.getStartEndPoints();s===null&&ku(143);const[a]=s,i=a.getNode(),o=i.getParent();if(ni(i)){const c=i.getFirstChild();if(c)r=c.selectStart().getNodes();else{const d=An();i.append(d),r=d.select().getNodes()}}else if(p8(i,r)){const c=_i(e);if(ni(o)){i.replace(c);const d=Li();ft(i)&&(d.setFormat(i.getFormatType()),d.setIndent(i.getIndent())),c.append(d)}else if(tn(i)){const d=i.getParentOrThrow();cf(c,d.getChildren()),d.replace(c)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(ft(a)&&a.isEmpty()&&!tn(a)&&!n.has(a.getKey())){jE(a,e);continue}let i=CA(a)?a.getParent():tn(a)&&a.isEmpty()?a:null;for(;i!=null;){const o=i.getKey();if(_r(i)){if(!n.has(o)){const c=_i(e);cf(c,i.getChildren()),i.replace(c),n.add(o)}break}{const c=i.getParent();if(ni(c)&&!n.has(o)){n.add(o),jE(i,e);break}i=c}}}}}function cf(e,t){e.splice(e.getChildrenSize(),0,t)}function jE(e,t){if(_r(e))return e;const r=e.getPreviousSibling(),n=e.getNextSibling(),s=Li();let a;if(cf(s,e.getChildren()),_r(r)&&t===r.getListType())r.append(s),_r(n)&&t===n.getListType()&&(cf(r,n.getChildren()),n.remove()),a=r;else if(_r(n)&&t===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=_i(t);i.append(s),e.replace(i),a=i}return s.setFormat(e.getFormatType()),s.setIndent(e.getIndent()),e.remove(),a}function Vb(e,t){const r=e.getLastChild(),n=t.getFirstChild();r&&n&&wl(r)&&wl(n)&&(Vb(r.getFirstChild(),n.getFirstChild()),n.remove());const s=t.getChildren();s.length>0&&e.append(...s),t.remove()}function s$(){const e=Rt();if(yt(e)){const t=new Set,r=e.getNodes(),n=e.anchor.getNode();if(p8(n,r))t.add(Z_(n));else for(let s=0;s<r.length;s++){const a=r[s];if(CA(a)){const i=mU(a,Ec);i!=null&&t.add(Z_(i))}}for(const s of t){let a=s;const i=m8(s);for(const o of i){const c=An().setTextStyle(e.style).setTextFormat(e.format);cf(c,o.getChildren()),a.insertAfter(c),a=c,o.__key===e.anchor.key&&lf(e.anchor,uo(mo(c,"next"))),o.__key===e.focus.key&&lf(e.focus,uo(mo(c,"next"))),o.remove()}s.remove()}}}function x8(e){const t=e.getListType()!=="check";let r=e.getStart();for(const n of e.getChildren())tn(n)&&(n.getValue()!==r&&n.setValue(r),t&&n.getLatest().__checked!=null&&n.setChecked(void 0),_r(n.getFirstChild())||r++)}function a$(e){const t=new Set;if(wl(e)||t.has(e.getKey()))return;const r=e.getParent(),n=e.getNextSibling(),s=e.getPreviousSibling();if(wl(n)&&wl(s)){const a=s.getFirstChild();if(_r(a)){a.append(e);const i=n.getFirstChild();_r(i)&&(cf(a,i.getChildren()),n.remove(),t.add(n.getKey()))}}else if(wl(n)){const a=n.getFirstChild();if(_r(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(e)}}else if(wl(s)){const a=s.getFirstChild();_r(a)&&a.append(e)}else if(_r(r)){const a=Li().setTextFormat(e.getTextFormat()).setTextStyle(e.getTextStyle()),i=_i(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(e),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function i$(e){if(wl(e))return;const t=e.getParent(),r=t?t.getParent():void 0;if(_r(r?r.getParent():void 0)&&tn(r)&&_r(t)){const n=t?t.getFirstChild():void 0,s=t?t.getLastChild():void 0;if(e.is(n))r.insertBefore(e),t.isEmpty()&&r.remove();else if(e.is(s))r.insertAfter(e),t.isEmpty()&&r.remove();else{const a=t.getListType(),i=Li(),o=_i(a);i.append(o),e.getPreviousSiblings().forEach((f=>o.append(f)));const c=Li(),d=_i(a);c.append(d),cf(d,e.getNextSiblings()),r.insertBefore(i),r.insertAfter(c),r.replace(e)}}}function o$(){const e=Rt();if(!yt(e)||!e.isCollapsed())return!1;const t=e.anchor.getNode();if(!tn(t)||t.getChildrenSize()!==0)return!1;const r=Z_(t),n=t.getParent();_r(n)||ku(40);const s=n.getParent();let a;if(ni(s))a=An(),r.insertAfter(a);else{if(!tn(s))return!1;a=Li(),s.insertAfter(a)}a.setTextStyle(e.style).setTextFormat(e.format).select();const i=t.getNextSiblings();if(i.length>0){const o=_i(n.getListType());if(tn(a)){const c=Li();c.append(o),a.insertAfter(c)}else a.insertAfter(o);o.append(...i)}return(function(o){let c=o;for(;c.getNextSibling()==null&&c.getPreviousSibling()==null;){const d=c.getParent();if(d==null||!tn(d)&&!_r(d))break;c=d}c.remove()})(t),!0}function ay(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}let Ec=class extends Ma{$config(){return this.config("listitem",{$transform:t=>{if(t.__checked==null)return;const r=t.getParent();_r(r)&&r.getListType()!=="check"&&t.getChecked()!=null&&t.setChecked(void 0)},extends:Ma,importDOM:{li:()=>({conversion:l$,priority:0})}})}constructor(t=1,r=void 0,n){super(n),this.__value=t===void 0?1:t,this.__checked=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__value=t.__value,this.__checked=t.__checked}createDOM(t){const r=document.createElement("li");return this.updateListItemDOM(null,r,t),r}updateListItemDOM(t,r,n){const s=this.getParent();_r(s)&&s.getListType()==="check"&&(function(o,c,d,f){_r(c.getFirstChild())?(o.removeAttribute("role"),o.removeAttribute("tabIndex"),o.removeAttribute("aria-checked")):(o.setAttribute("role","checkbox"),o.setAttribute("tabIndex","-1"),d&&c.__checked===d.__checked||o.setAttribute("aria-checked",c.getChecked()?"true":"false"))})(r,this,t),r.value=this.__value,(function(o,c,d){const f=[],p=[],m=c.list,y=m?m.listitem:void 0;let v;if(m&&m.nested&&(v=m.nested.listitem),y!==void 0&&f.push(...ay(y)),m){const w=d.getParent(),S=_r(w)&&w.getListType()==="check",E=d.getChecked();S&&!E||p.push(m.listitemUnchecked),S&&E||p.push(m.listitemChecked),S&&f.push(E?m.listitemChecked:m.listitemUnchecked)}if(v!==void 0){const w=ay(v);d.getChildren().some((S=>_r(S)))?f.push(...w):p.push(...w)}p.length>0&&Au(o,...p),f.length>0&&Is(o,...f)})(r,n.theme,this);const a=t?t.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),(function(o,c,d){const f=aE(c.__textStyle);for(const p in f)o.style.setProperty(`--listitem-marker-${p}`,f[p]);if(d)for(const p in aE(d.__textStyle))p in f||o.style.removeProperty(`--listitem-marker-${p}`)})(r,this,t)}updateDOM(t,r,n){const s=r;return this.updateListItemDOM(t,s,n),!1}updateFromJSON(t){return super.updateFromJSON(t).setValue(t.value).setChecked(t.checked)}exportDOM(t){const r=this.createDOM(t._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...t){for(let r=0;r<t.length;r++){const n=t[r];if(ft(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(t,r){if(tn(t))return super.replace(t);this.setIndent(0);const n=this.getParentOrThrow();if(!_r(n))return t;if(n.__first===this.getKey())n.insertBefore(t);else if(n.__last===this.getKey())n.insertAfter(t);else{const s=_i(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(t),t.insertAfter(s)}return r&&(ft(t)||ku(139),this.getChildren().forEach((s=>{t.append(s)}))),this.remove(),n.getChildrenSize()===0&&n.remove(),t}insertAfter(t,r=!0){const n=this.getParentOrThrow();if(_r(n)||ku(39),tn(t))return super.insertAfter(t,r);const s=this.getNextSiblings();if(n.insertAfter(t,r),s.length!==0){const a=_i(n.getListType());s.forEach((i=>a.append(i))),t.insertAfter(a,r)}return t}remove(t){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(t),r&&n&&wl(r)&&wl(n)&&(Vb(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(t,r=!0){const n=Li().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(t){const r=An();this.getChildren().forEach((i=>r.append(i)));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=tn(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=t.anchor,o=t.focus,c=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(c,i.offset,"element"),o.type==="element"&&o.getNode().is(this)&&o.set(c,o.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(t){const r=this.getWritable();return r.__value=t,r}getChecked(){const t=this.getLatest();let r;const n=this.getParent();return _r(n)&&(r=n.getListType()),r==="check"?!!t.__checked:void 0}setChecked(t){const r=this.getWritable();return r.__checked=t,r}toggleChecked(){const t=this.getWritable();return t.setChecked(!t.__checked)}getIndent(){const t=this.getParent();if(t===null||!this.isAttached())return this.getLatest().__indent;let r=t.getParentOrThrow(),n=0;for(;tn(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(t){typeof t!="number"&&ku(117),(t=Math.floor(t))>=0||ku(199);let r=this.getIndent();for(;r!==t;)r<t?(a$(this),r++):(i$(this),r--);return this}canInsertAfter(t){return tn(t)}canReplaceWith(t){return tn(t)}canMergeWith(t){return tn(t)||Cb(t)}extractWithChild(t,r){if(!yt(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return _i("bullet")}canMergeWhenEmpty(){return!0}};function l$(e){if(e.classList.contains("task-list-item")){for(const r of e.children)if(r.tagName==="INPUT")return c$(r)}const t=e.getAttribute("aria-checked");return{node:Li(t==="true"||t!=="false"&&void 0)}}function c$(e){return e.getAttribute("type")!=="checkbox"?{node:null}:{node:Li(e.hasAttribute("checked"))}}function Li(e){return ai(new Ec(void 0,e))}function tn(e){return e instanceof Ec}let Hu=class extends Ma{$config(){return this.config("list",{$transform:t=>{(function(r){const n=r.getNextSibling();_r(n)&&r.getListType()===n.getListType()&&Vb(r,n)})(t),x8(t)},extends:Ma,importDOM:{ol:()=>({conversion:PE,priority:0}),ul:()=>({conversion:PE,priority:0})}})}constructor(t="number",r=1,n){super(n);const s=d$[t]||t;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__listType=t.__listType,this.__tag=t.__tag,this.__start=t.__start}getTag(){return this.getLatest().__tag}setListType(t){const r=this.getWritable();return r.__listType=t,r.__tag=t==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(t){const r=this.getWritable();return r.__start=t,r}createDOM(t,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,FE(s,t.theme,this),s}updateDOM(t,r,n){return t.__tag!==this.__tag||(FE(r,n.theme,this),!1)}updateFromJSON(t){return super.updateFromJSON(t).setListType(t.listType).setStart(t.start)}exportDOM(t){const r=this.createDOM(t._config,t);return jn(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(t,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];tn(i)||(s===n&&(s=[...n]),s[a]=Li().append(!ft(i)||_r(i)||i.isInline()?i:Qn(i.getTextContent())))}return super.splice(t,r,s)}extractWithChild(t){return tn(t)}};function FE(e,t,r){const n=[],s=[],a=t.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],o=Q_(r)-1,c=o%i.length,d=i[c],f=a[r.__tag];let p;const m=a.nested,y=a.checklist;if(m!==void 0&&m.list&&(p=m.list),f!==void 0&&n.push(f),y!==void 0&&r.__listType==="check"&&n.push(y),d!==void 0){n.push(...ay(d));for(let v=0;v<i.length;v++)v!==c&&s.push(r.__tag+v)}if(p!==void 0){const v=ay(p);o>1?n.push(...v):s.push(...v)}}s.length>0&&Au(e,...s),n.length>0&&Is(e,...n)}function u$(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];if(tn(n)){t.push(n);const s=n.getChildren();s.length>1&&s.forEach((a=>{_r(a)&&t.push(NE(a))}))}else t.push(NE(n))}return t}function PE(e){const t=e.nodeName.toLowerCase();let r=null;return t==="ol"?r=_i("number",e.start):t==="ul"&&(r=(function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if(jn(s)&&s.hasAttribute("aria-checked"))return!0;return!1})(e)?_i("check"):_i("bullet")),{after:u$,node:r}}const d$={ol:"number",ul:"bullet"};function _i(e="number",t=1){return ai(new Hu(e,t))}function _r(e){return e instanceof Hu}const f$=dr("UPDATE_LIST_START_COMMAND"),Kb=dr("INSERT_UNORDERED_LIST_COMMAND"),qb=dr("INSERT_ORDERED_LIST_COMMAND"),Xb=dr("REMOVE_LIST_COMMAND");function h$(e){return xf(e.registerCommand(qb,(()=>(AE("number"),!0)),Fh),e.registerCommand(f$,(t=>{const{listNodeKey:r,newStart:n}=t,s=Ts(r);return!!_r(s)&&(s.getListType()==="number"&&(s.setStart(n),x8(s)),!0)}),Fh),e.registerCommand(Kb,(()=>(AE("bullet"),!0)),Fh),e.registerCommand(Xb,(()=>(s$(),!0)),Fh),e.registerCommand(ep,(()=>o$()),Fh),e.registerNodeTransform(Ec,(t=>{const r=t.getFirstChild();if(r){if(It(r)){const n=r.getStyle(),s=r.getFormat();t.getTextStyle()!==n&&t.setTextStyle(n),t.getTextFormat()!==s&&t.setTextFormat(s)}}else{const n=Rt();yt(n)&&(n.style!==t.getTextStyle()||n.format!==t.getTextFormat())&&n.isCollapsed()&&t.is(n.anchor.getNode())&&t.setTextStyle(n.style).setTextFormat(n.format)}})),e.registerNodeTransform(Wu,(t=>{const r=t.getParent();if(tn(r)&&t.is(r.getFirstChild())){const n=t.getStyle(),s=t.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}})))}function g$(e){const t=r=>{const n=r.getParent();if(_r(r.getFirstChild())||!_r(n))return;const s=zy(r,(a=>tn(a)&&_r(a.getParent())&&tn(a.getPreviousSibling())));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(tn(s)){const a=s.getPreviousSibling();if(tn(a)){const i=(function(c){let d=c,f=d.getFirstChild();for(;_r(f);){const p=f.getLastChild();if(!tn(p))break;d=p,f=d.getFirstChild()}return d})(a),o=i.getParent();if(_r(o)){const c=Q_(o);c+1<Q_(n)&&r.setIndent(c)}}}};return e.registerNodeTransform(Hu,(r=>{const n=[r];for(;n.length>0;){const s=n.shift();if(_r(s)){for(const a of s.getChildren())if(tn(a)){t(a);const i=a.getFirstChild();_r(i)&&n.push(i)}}}}))}var jw={exports:{}},DE;function m$(){return DE||(DE=1,(function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=(function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function k(_){return _ instanceof c?new c(_.type,k(_.content),_.alias):Array.isArray(_)?_.map(k):_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(k){return Object.prototype.toString.call(k).slice(8,-1)},objId:function(k){return k.__id||Object.defineProperty(k,"__id",{value:++a}),k.__id},clone:function k(_,N){N=N||{};var F,A;switch(o.util.type(_)){case"Object":if(A=o.util.objId(_),N[A])return N[A];F={},N[A]=F;for(var R in _)_.hasOwnProperty(R)&&(F[R]=k(_[R],N));return F;case"Array":return A=o.util.objId(_),N[A]?N[A]:(F=[],N[A]=F,_.forEach(function(T,D){F[D]=k(T,N)}),F);default:return _}},getLanguage:function(k){for(;k;){var _=s.exec(k.className);if(_)return _[1].toLowerCase();k=k.parentElement}return"none"},setLanguage:function(k,_){k.className=k.className.replace(RegExp(s,"gi"),""),k.classList.add("language-"+_)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(F){var k=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(F.stack)||[])[1];if(k){var _=document.getElementsByTagName("script");for(var N in _)if(_[N].src==k)return _[N]}return null}},isActive:function(k,_,N){for(var F="no-"+_;k;){var A=k.classList;if(A.contains(_))return!0;if(A.contains(F))return!1;k=k.parentElement}return!!N}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(k,_){var N=o.util.clone(o.languages[k]);for(var F in _)N[F]=_[F];return N},insertBefore:function(k,_,N,F){F=F||o.languages;var A=F[k],R={};for(var T in A)if(A.hasOwnProperty(T)){if(T==_)for(var D in N)N.hasOwnProperty(D)&&(R[D]=N[D]);N.hasOwnProperty(T)||(R[T]=A[T])}var L=F[k];return F[k]=R,o.languages.DFS(o.languages,function(O,G){G===L&&O!=k&&(this[O]=R)}),R},DFS:function k(_,N,F,A){A=A||{};var R=o.util.objId;for(var T in _)if(_.hasOwnProperty(T)){N.call(_,T,_[T],F||T);var D=_[T],L=o.util.type(D);L==="Object"&&!A[R(D)]?(A[R(D)]=!0,k(D,N,null,A)):L==="Array"&&!A[R(D)]&&(A[R(D)]=!0,k(D,N,T,A))}}},plugins:{},highlightAll:function(k,_){o.highlightAllUnder(document,k,_)},highlightAllUnder:function(k,_,N){var F={callback:N,container:k,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",F),F.elements=Array.prototype.slice.apply(F.container.querySelectorAll(F.selector)),o.hooks.run("before-all-elements-highlight",F);for(var A=0,R;R=F.elements[A++];)o.highlightElement(R,_===!0,F.callback)},highlightElement:function(k,_,N){var F=o.util.getLanguage(k),A=o.languages[F];o.util.setLanguage(k,F);var R=k.parentElement;R&&R.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(R,F);var T=k.textContent,D={element:k,language:F,grammar:A,code:T};function L(G){D.highlightedCode=G,o.hooks.run("before-insert",D),D.element.innerHTML=D.highlightedCode,o.hooks.run("after-highlight",D),o.hooks.run("complete",D),N&&N.call(D.element)}if(o.hooks.run("before-sanity-check",D),R=D.element.parentElement,R&&R.nodeName.toLowerCase()==="pre"&&!R.hasAttribute("tabindex")&&R.setAttribute("tabindex","0"),!D.code){o.hooks.run("complete",D),N&&N.call(D.element);return}if(o.hooks.run("before-highlight",D),!D.grammar){L(o.util.encode(D.code));return}if(_&&n.Worker){var O=new Worker(o.filename);O.onmessage=function(G){L(G.data)},O.postMessage(JSON.stringify({language:D.language,code:D.code,immediateClose:!0}))}else L(o.highlight(D.code,D.grammar,D.language))},highlight:function(k,_,N){var F={code:k,grammar:_,language:N};if(o.hooks.run("before-tokenize",F),!F.grammar)throw new Error('The language "'+F.language+'" has no grammar.');return F.tokens=o.tokenize(F.code,F.grammar),o.hooks.run("after-tokenize",F),c.stringify(o.util.encode(F.tokens),F.language)},tokenize:function(k,_){var N=_.rest;if(N){for(var F in N)_[F]=N[F];delete _.rest}var A=new p;return m(A,A.head,k),f(k,A,_,A.head,0),v(A)},hooks:{all:{},add:function(k,_){var N=o.hooks.all;N[k]=N[k]||[],N[k].push(_)},run:function(k,_){var N=o.hooks.all[k];if(!(!N||!N.length))for(var F=0,A;A=N[F++];)A(_)}},Token:c};n.Prism=o;function c(k,_,N,F){this.type=k,this.content=_,this.alias=N,this.length=(F||"").length|0}c.stringify=function k(_,N){if(typeof _=="string")return _;if(Array.isArray(_)){var F="";return _.forEach(function(L){F+=k(L,N)}),F}var A={type:_.type,content:k(_.content,N),tag:"span",classes:["token",_.type],attributes:{},language:N},R=_.alias;R&&(Array.isArray(R)?Array.prototype.push.apply(A.classes,R):A.classes.push(R)),o.hooks.run("wrap",A);var T="";for(var D in A.attributes)T+=" "+D+'="'+(A.attributes[D]||"").replace(/"/g,"&quot;")+'"';return"<"+A.tag+' class="'+A.classes.join(" ")+'"'+T+">"+A.content+"</"+A.tag+">"};function d(k,_,N,F){k.lastIndex=_;var A=k.exec(N);if(A&&F&&A[1]){var R=A[1].length;A.index+=R,A[0]=A[0].slice(R)}return A}function f(k,_,N,F,A,R){for(var T in N)if(!(!N.hasOwnProperty(T)||!N[T])){var D=N[T];D=Array.isArray(D)?D:[D];for(var L=0;L<D.length;++L){if(R&&R.cause==T+","+L)return;var O=D[L],G=O.inside,K=!!O.lookbehind,te=!!O.greedy,Z=O.alias;if(te&&!O.pattern.global){var J=O.pattern.toString().match(/[imsuy]*$/)[0];O.pattern=RegExp(O.pattern.source,J+"g")}for(var I=O.pattern||O,W=F.next,B=A;W!==_.tail&&!(R&&B>=R.reach);B+=W.value.length,W=W.next){var Y=W.value;if(_.length>k.length)return;if(!(Y instanceof c)){var V=1,H;if(te){if(H=d(I,B,k,K),!H||H.index>=k.length)break;var ae=H.index,X=H.index+H[0].length,se=B;for(se+=W.value.length;ae>=se;)W=W.next,se+=W.value.length;if(se-=W.value.length,B=se,W.value instanceof c)continue;for(var ie=W;ie!==_.tail&&(se<X||typeof ie.value=="string");ie=ie.next)V++,se+=ie.value.length;V--,Y=k.slice(B,se),H.index-=B}else if(H=d(I,0,Y,K),!H)continue;var ae=H.index,Q=H[0],le=Y.slice(0,ae),_e=Y.slice(ae+Q.length),ke=B+Y.length;R&&ke>R.reach&&(R.reach=ke);var Oe=W.prev;le&&(Oe=m(_,Oe,le),B+=le.length),y(_,Oe,V);var ge=new c(T,G?o.tokenize(Q,G):Q,Z,Q);if(W=m(_,Oe,ge),_e&&m(_,W,_e),V>1){var ye={cause:T+","+L,reach:ke};f(k,_,N,W.prev,B,ye),R&&ye.reach>R.reach&&(R.reach=ye.reach)}}}}}}function p(){var k={value:null,prev:null,next:null},_={value:null,prev:k,next:null};k.next=_,this.head=k,this.tail=_,this.length=0}function m(k,_,N){var F=_.next,A={value:N,prev:_,next:F};return _.next=A,F.prev=A,k.length++,A}function y(k,_,N){for(var F=_.next,A=0;A<N&&F!==k.tail;A++)F=F.next;_.next=F,F.prev=_,k.length-=A}function v(k){for(var _=[],N=k.head.next;N!==k.tail;)_.push(N.value),N=N.next;return _}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(k){var _=JSON.parse(k.data),N=_.language,F=_.code,A=_.immediateClose;n.postMessage(o.highlight(F,o.languages[N],N)),A&&n.close()},!1)),o;var w=o.util.currentScript();w&&(o.filename=w.src,w.hasAttribute("data-manual")&&(o.manual=!0));function S(){o.manual||o.highlightAll()}if(!o.manual){var E=document.readyState;E==="loading"||E==="interactive"&&w&&w.defer?document.addEventListener("DOMContentLoaded",S):window.requestAnimationFrame?window.requestAnimationFrame(S):window.setTimeout(S,16)}return o})(t);e.exports&&(e.exports=r),typeof I1<"u"&&(I1.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};o["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var c={};c[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},r.languages.insertBefore("markup","cdata",c)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,(function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))})(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,(function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading…",s=function(w,S){return"✖ Error "+w+" while fetching file: "+S},a="✖ Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",c="loading",d="loaded",f="failed",p="pre[data-src]:not(["+o+'="'+d+'"]):not(['+o+'="'+c+'"])';function m(w,S,E){var k=new XMLHttpRequest;k.open("GET",w,!0),k.onreadystatechange=function(){k.readyState==4&&(k.status<400&&k.responseText?S(k.responseText):k.status>=400?E(s(k.status,k.statusText)):E(a))},k.send(null)}function y(w){var S=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(w||"");if(S){var E=Number(S[1]),k=S[2],_=S[3];return k?_?[E,Number(_)]:[E,void 0]:[E,E]}}r.hooks.add("before-highlightall",function(w){w.selector+=", "+p}),r.hooks.add("before-sanity-check",function(w){var S=w.element;if(S.matches(p)){w.code="",S.setAttribute(o,c);var E=S.appendChild(document.createElement("CODE"));E.textContent=n;var k=S.getAttribute("data-src"),_=w.language;if(_==="none"){var N=(/\.(\w+)$/.exec(k)||[,"none"])[1];_=i[N]||N}r.util.setLanguage(E,_),r.util.setLanguage(S,_);var F=r.plugins.autoloader;F&&F.loadLanguages(_),m(k,function(A){S.setAttribute(o,d);var R=y(S.getAttribute("data-range"));if(R){var T=A.split(/\r\n?|\n/g),D=R[0],L=R[1]==null?T.length:R[1];D<0&&(D+=T.length),D=Math.max(0,Math.min(D-1,T.length)),L<0&&(L+=T.length),L=Math.max(0,Math.min(L,T.length)),A=T.slice(D,L).join(`
`),S.hasAttribute("data-start")||S.setAttribute("data-start",String(D+1))}E.textContent=A,r.highlightElement(E)},function(A){S.setAttribute(o,f),E.textContent=A})}}),r.plugins.fileHighlight={highlight:function(S){for(var E=(S||document).querySelectorAll(p),k=0,_;_=E[k++];)r.highlightElement(_)}};var v=!1;r.fileHighlight=function(){v||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),v=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(jw)),jw.exports}m$();Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(t,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(e,t){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Prism.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(f){return f=f.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+f+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(f){["url","bold","italic","strike","code-snippet"].forEach(function(p){f!==p&&(e.languages.markdown[f].inside.content.inside[p]=e.languages.markdown[p])})}),e.hooks.add("after-tokenize",function(f){if(f.language!=="markdown"&&f.language!=="md")return;function p(m){if(!(!m||typeof m=="string"))for(var y=0,v=m.length;y<v;y++){var w=m[y];if(w.type!=="code"){p(w.content);continue}var S=w.content[1],E=w.content[3];if(S&&E&&S.type==="code-language"&&E.type==="code-block"&&typeof S.content=="string"){var k=S.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");k=(/[a-z][\w-]*/i.exec(k)||[""])[0].toLowerCase();var _="language-"+k;E.alias?typeof E.alias=="string"?E.alias=[E.alias,_]:E.alias.push(_):E.alias=[_]}}}p(f.tokens)}),e.hooks.add("wrap",function(f){if(f.type==="code-block"){for(var p="",m=0,y=f.classes.length;m<y;m++){var v=f.classes[m],w=/language-(.+)/.exec(v);if(w){p=w[1];break}}var S=e.languages[p];if(S)f.content=e.highlight(d(f.content),S,p);else if(p&&p!=="none"&&e.plugins.autoloader){var E="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);f.attributes.id=E,e.plugins.autoloader.loadLanguages(p,function(){var k=document.getElementById(E);k&&(k.innerHTML=e.highlight(k.textContent,e.languages[p],p))})}}});var i=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},c=String.fromCodePoint||String.fromCharCode;function d(f){var p=f.replace(i,"");return p=p.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(m,y){if(y=y.toLowerCase(),y[0]==="#"){var v;return y[1]==="x"?v=parseInt(y.slice(2),16):v=Number(y.slice(1)),c(v)}else{var w=o[y];return w||m}}),p}e.languages.md=e.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var r=e.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(e){var t=e.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};t.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:t},boolean:t.boolean,variable:t.variable}})(Prism);var RE={},IE;function p$(){return IE||(IE=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),RE}p$();var ME={},LE;function x$(){return LE||(LE=1,(function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string})(Prism)),ME}x$();Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(e){e.inside.interpolation.inside=Prism.languages.swift});var OE={},BE;function y$(){return BE||(BE=1,(function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript})(Prism)),OE}y$();var UE={},$E;function v$(){return $E||($E=1,(function(e){var t=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:t,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:t,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism)),UE}v$();var WE={},zE;function w$(){return zE||(zE=1,(function(e){var t=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return t.source});e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:t,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])})(Prism)),WE}w$();function y8(e,t){for(const r of e.childNodes){if(jn(r)&&r.tagName===t)return!0;y8(r,t)}return!1}const wm="data-language",mm="data-highlight-language",f1="data-theme";class yf extends Ma{static getType(){return"code"}static clone(t){return new yf(t.__language,t.__key)}constructor(t,r){super(r),this.__language=t||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(t){super.afterCloneFrom(t),this.__language=t.__language,this.__theme=t.__theme,this.__isSyntaxHighlightSupported=t.__isSyntaxHighlightSupported}createDOM(t){const r=document.createElement("code");Is(r,t.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(wm,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(mm,n));const s=this.getTheme();s&&r.setAttribute(f1,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(t,r,n){const s=this.__language,a=t.__language;s?s!==a&&r.setAttribute(wm,s):a&&r.removeAttribute(wm);const i=this.__isSyntaxHighlightSupported;t.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(mm,s):r.removeAttribute(mm):i&&s&&r.setAttribute(mm,s);const o=this.__theme,c=t.__theme;o?o!==c&&r.setAttribute(f1,o):c&&r.removeAttribute(f1);const d=this.__style,f=t.__style;return d?d!==f&&r.setAttribute("style",d):f&&r.removeAttribute("style"),!1}exportDOM(t){const r=document.createElement("pre");Is(r,t._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(wm,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(mm,n));const s=this.getTheme();s&&r.setAttribute(f1,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:t=>t.textContent!=null&&(/\r?\n/.test(t.textContent)||y8(t,"BR"))?{conversion:HE,priority:1}:null,div:()=>({conversion:_$,priority:1}),pre:()=>({conversion:HE,priority:0}),table:t=>Fw(t)?{conversion:b$,priority:3}:null,td:t=>{const r=t,n=r.closest("table");return r.classList.contains("js-file-line")||n&&Fw(n)?{conversion:GE,priority:3}:null},tr:t=>{const r=t.closest("table");return r&&Fw(r)?{conversion:GE,priority:3}:null}}}static importJSON(t){return mc().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setLanguage(t.language).setTheme(t.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(t,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&t.isCollapsed()&&t.anchor.key===this.__key&&t.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const c=An();return this.insertAfter(c,r),c}const{anchor:a,focus:i}=t,o=(a.isBefore(i)?a:i).getNode();if(It(o)){let c=k$(o);const d=[];for(;;)if(Ry(c))d.push(v0()),c=c.getNextSibling();else{if(!_8(c))break;{let S=0;const E=c.getTextContent(),k=c.getTextContentSize();for(;S<k&&E[S]===" ";)S++;if(S!==0&&d.push(w8(" ".repeat(S))),S!==k)break;c=c.getNextSibling()}}const f=o.splitText(a.offset)[0],p=a.offset===0?0:1,m=f.getIndexWithinParent()+p,y=o.getParentOrThrow(),v=[Tl(),...d];y.splice(m,0,v);const w=d[d.length-1];w?w.select():a.offset===0?f.selectPrevious():f.getNextSibling().selectNext(0,0)}if(Yb(o)){const{offset:c}=t.anchor;o.splice(c,0,[Tl()]),o.select(c+1,c+1)}return null}canIndent(){return!1}collapseAtStart(){const t=An();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}setLanguage(t){const r=this.getWritable();return r.__language=t||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(t){const r=this.getWritable();return r.__isSyntaxHighlightSupported=t,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(t){const r=this.getWritable();return r.__theme=t||void 0,r}getTheme(){return this.getLatest().__theme}}function mc(e,t){return HB(yf).setLanguage(e).setTheme(t)}function Yb(e){return e instanceof yf}function HE(e){return{node:mc(e.getAttribute(wm))}}function _$(e){const t=e,r=VE(t);return r||(function(n){let s=n.parentElement;for(;s!==null;){if(VE(s))return!0;s=s.parentElement}return!1})(t)?{node:r?mc():null}:{node:null}}function b$(){return{node:mc()}}function GE(){return{node:null}}function VE(e){return e.style.fontFamily.match("monospace")!==null}function Fw(e){return e.classList.contains("js-file-line-container")}let Hy=class v8 extends Wu{constructor(t="",r,n){super(t,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(t){return new v8(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(t){const r=this.getWritable();return r.__highlightType=t||void 0,r}canHaveFormat(){return!1}createDOM(t){const r=super.createDOM(t),n=Pw(t.theme,this.__highlightType);return Is(r,n),r}updateDOM(t,r,n){const s=super.updateDOM(t,r,n),a=Pw(n.theme,t.__highlightType),i=Pw(n.theme,this.__highlightType);return a!==i&&(a&&Au(r,a),i&&Is(r,i)),s}static importJSON(t){return w8().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHighlightType(t.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(t){return this}isParentRequired(){return!0}createParentElementNode(){return mc()}};function Pw(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function w8(e="",t){return ai(new Hy(e,t))}function _8(e){return e instanceof Hy}function S$(e,t){let r=e;for(let n=xa(e,t);n&&(_8(n.origin)||Ry(n.origin));n=gU(n))r=n.origin;return r}function k$(e){return S$(e,"previous")}(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach((function(r){var n=t[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),e.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}})),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);const C$=new Set(["http:","https:","mailto:","sms:","tel:"]);class Gu extends Ma{static getType(){return"link"}static clone(t){return new Gu(t.__url,{rel:t.__rel,target:t.__target,title:t.__title},t.__key)}constructor(t="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=t,this.__target=s,this.__rel=a,this.__title=i}createDOM(t){const r=document.createElement("a");return this.updateLinkDOM(null,r,t),Is(r,t.theme.link),r}updateLinkDOM(t,r,n){if(RA(r)){t&&t.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];t&&t[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(t,r,n){return this.updateLinkDOM(t,r,n),!1}static importDOM(){return{a:t=>({conversion:T$,priority:1})}}static importJSON(t){return iy().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setURL(t.url).setRel(t.rel||null).setTarget(t.target||null).setTitle(t.title||null)}sanitizeUrl(t){t=qE(t);try{const r=new URL(qE(t));if(!C$.has(r.protocol))return"about:blank"}catch{return t}return t}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(t){const r=this.getWritable();return r.__url=t,r}getTarget(){return this.getLatest().__target}setTarget(t){const r=this.getWritable();return r.__target=t,r}getRel(){return this.getLatest().__rel}setRel(t){const r=this.getWritable();return r.__rel=t,r}getTitle(){return this.getLatest().__title}setTitle(t){const r=this.getWritable();return r.__title=t,r}insertNewAfter(t,r=!0){const n=iy(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(t,r,n){if(!yt(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function T$(e){let t=null;if(RA(e)){const r=e.textContent;(r!==null&&r!==""||e.children.length>0)&&(t=iy(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:t}}function iy(e="",t){return ai(new Gu(e,t))}function E$(e){return e instanceof Gu}class T0 extends Gu{constructor(t="",r={},n){super(t,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(t){return new T0(t.__url,{isUnlinked:t.__isUnlinked,rel:t.__rel,target:t.__target,title:t.__title},t.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(t){const r=this.getWritable();return r.__isUnlinked=t,r}createDOM(t){return this.__isUnlinked?document.createElement("span"):super.createDOM(t)}updateDOM(t,r,n){return super.updateDOM(t,r,n)||t.__isUnlinked!==this.__isUnlinked}static importJSON(t){return KE().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setIsUnlinked(t.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(t,r=!0){const n=this.getParentOrThrow().insertNewAfter(t,r);if(ft(n)){const s=KE(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function KE(e="",t){return ai(new T0(e,t))}function N$(e){return e instanceof T0}const A$=/^\+?[0-9\s()-]{5,}$/;function qE(e){return e.match(/^[a-z][a-z0-9+.-]*:/i)||e.match(/^[/#.]/)?e:e.includes("@")?`mailto:${e}`:A$.test(e)?`tel:${e}`:`https://${e}`}function e2(e,t){const r={};for(const n of e){const s=t(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function j$(e){const t=e2(e,(r=>r.type));return{element:t.element||[],multilineElement:t["multiline-element"]||[],textFormat:t["text-format"]||[],textMatch:t["text-match"]||[]}}const XE=/[!-/:-@[-`{-~\s]/;function F$(e){return It(e)&&!e.hasFormat("code")}function P$(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function YE(e,t,r){const n=r.length;for(let s=t;s>=n;s--){const a=s-n;if(b8(e,a,r,0,n)&&e[a+n]!==" ")return a}return-1}function b8(e,t,r,n,s){for(let a=0;a<s;a++)if(e[t+a]!==r[n+a])return!1;return!0}function D$(e,t=Gy){const r=j$(t),n=e2(r.textFormat,(({tag:i})=>i[i.length-1])),s=e2(r.textMatch,(({trigger:i})=>i));for(const i of t){const o=i.type;if(o==="element"||o==="text-match"||o==="multiline-element"){const c=i.dependencies;for(const d of c)e.hasNode(d)||P$(173,d.getType())}}const a=(i,o,c)=>{(function(d,f,p,m){const y=d.getParent();if(!ni(y)||d.getFirstChild()!==f)return!1;const v=f.getTextContent();if(v[p-1]!==" ")return!1;for(const{regExp:w,replace:S}of m){const E=v.match(w);if(E&&E[0].length===(E[0].endsWith(" ")?p:p-1)){const k=f.getNextSiblings(),[_,N]=f.splitText(p);if(S(d,N?[N,...k]:k,E,!1)!==!1)return _.remove(),!0}}return!1})(i,o,c,r.element)||(function(d,f,p,m){const y=d.getParent();if(!ni(y)||d.getFirstChild()!==f)return!1;const v=f.getTextContent();if(v[p-1]!==" ")return!1;for(const{regExpStart:w,replace:S,regExpEnd:E}of m){if(E&&!("optional"in E)||E&&"optional"in E&&!E.optional)continue;const k=v.match(w);if(k&&k[0].length===(k[0].endsWith(" ")?p:p-1)){const _=f.getNextSiblings(),[N,F]=f.splitText(p);if(S(d,F?[F,..._]:_,k,null,null,!1)!==!1)return N.remove(),!0}}return!1})(i,o,c,r.multilineElement)||(function(d,f,p){let m=d.getTextContent();const y=p[m[f-1]];if(y==null)return!1;f<m.length&&(m=m.slice(0,f));for(const v of y){if(!v.replace||!v.regExp)continue;const w=m.match(v.regExp);if(w===null)continue;const S=w.index||0,E=S+w[0].length;let k;return S===0?[k]=d.splitText(E):[,k]=d.splitText(S,E),k.selectNext(0,0),v.replace(k,w),!0}return!1})(o,c,s)||(function(d,f,p){const m=d.getTextContent(),y=f-1,v=m[y],w=p[v];if(!w)return!1;for(const S of w){const{tag:E}=S,k=E.length,_=y-k+1;if(k>1&&!b8(m,_,E,0,k)||m[_-1]===" ")continue;const N=m[y+1];if(S.intraword===!1&&N&&!XE.test(N))continue;const F=d;let A=F,R=YE(m,_,E),T=A;for(;R<0&&(T=T.getPreviousSibling())&&!xc(T);)if(It(T)){if(T.hasFormat("code"))continue;const I=T.getTextContent();A=T,R=YE(I,I.length,E)}if(R<0||A===F&&R+k===_)continue;const D=A.getTextContent();if(R>0&&D[R-1]===v)continue;const L=D[R-1];if(S.intraword===!1&&L&&!XE.test(L))continue;const O=F.getTextContent(),G=O.slice(0,_)+O.slice(y+1);F.setTextContent(G);const K=A===F?G:D;A.setTextContent(K.slice(0,R)+K.slice(R+k));const te=Rt(),Z=My();ya(Z);const J=y-k*(A===F?2:1)+1;Z.anchor.set(A.__key,R,"text"),Z.focus.set(F.__key,J,"text");for(const I of S.format)Z.hasFormat(I)||Z.formatText(I);Z.anchor.set(Z.focus.key,Z.focus.offset,Z.focus.type);for(const I of S.format)Z.hasFormat(I)&&Z.toggleFormat(I);return yt(te)&&(Z.format=te.format),!0}})(o,c,n)};return e.registerUpdateListener((({tags:i,dirtyLeaves:o,editorState:c,prevEditorState:d})=>{if(i.has(_A)||i.has(ey)||e.isComposing())return;const f=c.read(Rt),p=d.read(Rt);if(!yt(p)||!yt(f)||!f.isCollapsed()||f.is(p))return;const m=f.anchor.key,y=f.anchor.offset,v=c._nodeMap.get(m);!It(v)||!o.has(m)||y!==1&&y>p.anchor.offset+1||e.update((()=>{if(!F$(v))return;const w=v.getParent();w===null||Yb(w)||a(w,v,f.anchor.offset)}))}))}const R$=/^(\s*)(\d{1,})\.\s/,I$=/^(\s*)[-*+]\s/,M$=/^(#{1,6})\s/,L$=/^>\s/,O$=/^[ \t]*```([\w-]+)?/,B$=/[ \t]*```$/,S8=e=>(t,r,n,s)=>{const a=e(n);a.append(...r),t.replace(a),s||a.select(0,0)},k8=e=>(t,r,n,s)=>{const a=t.getPreviousSibling(),i=t.getNextSibling(),o=Li(e==="check"?n[3]==="x":void 0);if(_r(i)&&i.getListType()===e){const d=i.getFirstChild();d!==null?d.insertBefore(o):i.append(o),t.remove()}else if(_r(a)&&a.getListType()===e)a.append(o),t.remove();else{const d=_i(e,e==="number"?Number(n[2]):void 0);d.append(o),t.replace(d)}o.append(...r),s||o.select(0,0);const c=(function(d){const f=d.match(/\t/g),p=d.match(/ /g);let m=0;return f&&(m+=f.length),p&&(m+=Math.floor(p.length/4)),m})(n[1]);c&&o.setIndent(c)},Jb=(e,t,r)=>{const n=[],s=e.getChildren();let a=0;for(const i of s)if(tn(i)){if(i.getChildrenSize()===1){const f=i.getFirstChild();if(_r(f)){n.push(Jb(f,t,r+1));continue}}const o=" ".repeat(4*r),c=e.getListType(),d=c==="number"?`${e.getStart()+a}. `:c==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(o+d+t(i)),a++}return n.join(`
`)},U$={dependencies:[Lp],export:(e,t)=>{if(!MU(e))return null;const r=Number(e.getTag().slice(1));return"#".repeat(r)+" "+t(e)},regExp:M$,replace:S8((e=>{const t="h"+e[1].length;return Su(t)})),type:"element"},$$={dependencies:[Ip],export:(e,t)=>{if(!pE(e))return null;const r=t(e).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:L$,replace:(e,t,r,n)=>{if(n){const a=e.getPreviousSibling();if(pE(a))return a.splice(a.getChildrenSize(),0,[Tl(),...t]),void e.remove()}const s=Mp();s.append(...t),e.replace(s),n||s.select(0,0)},type:"element"},W$={dependencies:[yf],export:e=>{if(!Yb(e))return null;const t=e.getTextContent();return"```"+(e.getLanguage()||"")+(t?`
`+t:"")+"\n```"},regExpEnd:{optional:!0,regExp:B$},regExpStart:O$,replace:(e,t,r,n,s,a)=>{let i,o;if(!t&&s){if(s.length===1)n?(i=mc(),o=r[1]+s[0]):(i=mc(r[1]),o=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=mc(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();o=s.join(`
`)}const c=Qn(o);i.append(c),e.append(i)}else t&&S8((c=>mc(c?c[1]:void 0)))(e,t,r,a)},type:"multiline-element"},z$={dependencies:[Hu,Ec],export:(e,t)=>_r(e)?Jb(e,t,0):null,regExp:I$,replace:k8("bullet"),type:"element"},H$={dependencies:[Hu,Ec],export:(e,t)=>_r(e)?Jb(e,t,0):null,regExp:R$,replace:k8("number"),type:"element"},G$={format:["code"],tag:"`",type:"text-format"},V$={format:["highlight"],tag:"==",type:"text-format"},K$={format:["bold","italic"],tag:"***",type:"text-format"},q$={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},X$={format:["bold"],tag:"**",type:"text-format"},Y$={format:["bold"],intraword:!1,tag:"__",type:"text-format"},J$={format:["strikethrough"],tag:"~~",type:"text-format"},Q$={format:["italic"],tag:"*",type:"text-format"},Z$={format:["italic"],intraword:!1,tag:"_",type:"text-format"},eW={dependencies:[Gu],export:(e,t,r)=>{if(!E$(e)||N$(e))return null;const n=e.getTitle(),s=t(e);return n?`[${s}](${e.getURL()} "${n}")`:`[${s}](${e.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(e,t)=>{const[,r,n,s]=t,a=iy(n,{title:s}),i=r.split("[").length-1,o=r.split("]").length-1;let c=r,d="";if(i<o)return;if(i>o){const p=r.split("[");d="["+p[0],c=p.slice(1).join("[")}const f=Qn(c);return f.setFormat(e.getFormat()),a.append(f),e.replace(a),d&&a.insertBefore(Qn(d)),f},trigger:")",type:"text-match"},tW=[U$,$$,z$,H$],rW=[W$],nW=[G$,K$,q$,X$,Y$,V$,Q$,Z$,J$],sW=[eW],Gy=[...tW,...rW,...nW,...sW];function JE(e,t){return e.getEditorState().read((()=>{const r=Ts(t);return r!==null&&r.isSelected()}))}function aW(e){const[t]=Nl(),[r,n]=C.useState((()=>JE(t,e)));return C.useEffect((()=>{let s=!0;const a=t.registerUpdateListener((()=>{s&&n(JE(t,e))}));return()=>{s=!1,a()}}),[t,e]),[r,C.useCallback((s=>{t.update((()=>{let a=Rt();Ea(a)||(a=vb(),ya(a)),Ea(a)&&(s?a.add(e):a.delete(e))}))}),[t,e]),C.useCallback((()=>{t.update((()=>{const s=Rt();Ea(s)&&s.clear()}))}),[t])]}function iW({nodeKey:e}){const[t]=Nl(),[r,n,s]=aW(e);return C.useEffect((()=>xf(t.registerCommand(hb,(a=>{const i=t.getElementByKey(e);return a.target===i&&(a.shiftKey||s(),n(!r),!0)}),Fh))),[s,t,r,e,n]),C.useEffect((()=>{const a=t.getElementByKey(e),i=t._config.theme.hrSelected??"selected";a!==null&&(r?Is(a,i):Au(a,i))}),[t,r,e]),null}class Bp extends bb{static getType(){return"horizontalrule"}static clone(t){return new Bp(t.__key)}static importJSON(t){return Qb().updateFromJSON(t)}static importDOM(){return{hr:()=>({conversion:oW,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(t){const r=document.createElement("hr");return Is(r,t.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return l.jsx(iW,{nodeKey:this.__key})}}function oW(){return{node:Qb()}}function Qb(){return ai(new Bp)}function lW(e){return e instanceof Bp}const cW=[{dependencies:[Bp],export:e=>lW(e)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(e,t,r,n)=>{const s=Qb();n||e.getNextSibling()!=null?e.replace(s):e.insertBefore(s),s.selectNext()},type:"element"},...Gy];function C8({transformers:e=cW}){const[t]=Nl();return C.useEffect((()=>D$(t,e)),[t,e]),null}function T8({hasStrictIndent:e=!1}){const[t]=Nl();return C.useEffect((()=>{if(!t.hasNodes([Hu,Ec]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")}),[t]),C.useEffect((()=>{if(e)return g$(t)}),[t,e]),(function(r){C.useEffect((()=>h$(r)),[r])})(t),null}const uW=({onChange:e})=>{const[t]=C.useContext(x0)||[];return C.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{On().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},dW=()=>{const[e]=C.useContext(x0)||[],t=C.useCallback(()=>{e&&e.dispatchCommand(Da,"bold")},[e]),r=C.useCallback(()=>{e&&e.dispatchCommand(Da,"italic")},[e]),n=C.useCallback(()=>{e&&e.dispatchCommand(Da,"underline")},[e]),s=C.useCallback(()=>{e&&e.dispatchCommand(Da,"strikethrough")},[e]),a=C.useCallback(y=>{e&&e.update(()=>{const v=Rt();yt(v)&&Kh(v,()=>Su(y))})},[e]),i=C.useCallback(()=>{e&&e.update(()=>{const y=Rt();yt(y)&&Kh(y,()=>An())})},[e]);C.useCallback(()=>{e&&e.update(()=>{const y=Rt();yt(y)&&Kh(y,()=>Mp())})},[e]);const o=C.useCallback(()=>{e&&e.dispatchCommand(Kb)},[e]),c=C.useCallback(()=>{e&&e.dispatchCommand(qb)},[e]),d=C.useCallback(()=>{e&&e.dispatchCommand(Xb)},[e]),f=C.useCallback(y=>{e&&e.update(()=>{const v=Rt();yt(v)&&v.getNodes().forEach(w=>{It(w)&&w.setStyle(`color: ${y}`)})})},[e]),p=C.useCallback(y=>{e&&e.update(()=>{const v=Rt();yt(v)&&v.getNodes().forEach(S=>{if(It(S)){const E=S.getStyle(),k=E?E.replace(/font-size:\s*\d+px;?\s*/g,"").trim():"",_=k?`${k}; font-size: ${y}px;`:`font-size: ${y}px;`;S.setStyle(_)}})})},[e]),m=C.useCallback(y=>{e&&e.dispatchCommand(Z6,y)},[e]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:t,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:o,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:"• List"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),l.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),l.jsx("button",{type:"button",onClick:()=>f("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),l.jsx("button",{type:"button",onClick:()=>f("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),l.jsx("button",{type:"button",onClick:()=>f("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),l.jsx("button",{type:"button",onClick:()=>f("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),l.jsx("button",{type:"button",onClick:()=>p(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),l.jsx("button",{type:"button",onClick:()=>p(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),l.jsx("button",{type:"button",onClick:()=>p(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),l.jsx("button",{type:"button",onClick:()=>p(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),l.jsx("button",{type:"button",onClick:()=>m("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:"←"}),l.jsx("button",{type:"button",onClick:()=>m("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:"↔"}),l.jsx("button",{type:"button",onClick:()=>m("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:"→"})]})]})},fW=({value:e,onChange:t,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Lp,Hu,Ec,Ip,yf,Hy,Op,k0,C0,T0,Gu],onError:s=>{console.error("Lexical error:",s)},editorState:e?(()=>{try{const s=JSON.parse(e);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs(UA,{initialConfig:n,children:[l.jsx(dW,{}),l.jsx(uW,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(s8,{contentEditable:l.jsx(i8,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:c8}),l.jsx(o8,{}),l.jsx(l8,{}),l.jsx(T8,{}),l.jsx(C8,{transformers:Gy})]})]})})},hW=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=Gn();Ho();const{showNotification:o}=Oa(),[c,d]=C.useState({test_name:e,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[f,p]=C.useState({isLoading:!1,error:null,showPreview:!0});C.useEffect(()=>{d(k=>({...k,test_name:e||""}))},[e]);const m=()=>{if(c.num_questions>=3){p(N=>({...N,error:"Maximum 3 questions allowed for performance reasons"}));return}const _={id:Math.max(...c.questions.map(N=>N.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};d(N=>({...N,num_questions:N.num_questions+1,questions:[...N.questions,_]}))},y=k=>{c.questions.length<=1||d(_=>({..._,num_questions:_.num_questions-1,questions:_.questions.filter(N=>N.id!==k)}))},v=(k,_)=>{d(N=>({...N,questions:N.questions.map(F=>F.id===k?{...F,question_json:_}:F)}))},w=(k,_,N)=>{d(F=>({...F,questions:F.questions.map(A=>A.id===k?{...A,canvas_width:_,canvas_height:N}:A)}))},S=(k,_,N)=>{d(F=>({...F,questions:F.questions.map(A=>A.id===k?{...A,max_canvas_width:_,max_canvas_height:N}:A)}))},E=async()=>{if(!c.test_name.trim()){p(k=>({...k,error:"Test name is required"}));return}if(c.questions.some(k=>!k.question_json.trim())){p(k=>({...k,error:"All questions must have content"}));return}p(k=>({...k,isLoading:!0,error:null}));try{const k={test_name:c.test_name,num_questions:c.num_questions,passing_score:c.passing_score,questions:c.questions.map((_,N)=>({question_id:N+1,question_json:_.question_json,canvas_width:_.canvas_width,canvas_height:_.canvas_height,max_canvas_width:_.max_canvas_width,max_canvas_height:_.max_canvas_height}))};t&&t(k)}catch(k){console.error("Error preparing drawing test:",k),p(_=>({..._,error:"Failed to prepare drawing test. Please try again."})),o("Failed to prepare drawing test","error")}finally{p(k=>({...k,isLoading:!1}))}};return l.jsx("div",{className:"drawing-test-creator max-w-4xl mx-auto p-6",children:l.jsxs(mt,{className:"p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",c.num_questions,"/3)"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),l.jsxs(tt,{onClick:m,disabled:c.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),l.jsx("div",{className:"space-y-4",children:c.questions.map((k,_)=>l.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",_+1]}),c.questions.length>1&&l.jsx(tt,{onClick:()=>y(k.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),l.jsx(fW,{value:k.question_json,onChange:N=>v(k.id,N),placeholder:""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Canvas Dimensions"}),l.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Canvas is the actual drawing area, viewport is the initial display size"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Viewport Width"}),l.jsx("input",{type:"number",value:k.canvas_width,onChange:N=>w(k.id,parseInt(N.target.value),k.canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Viewport Height"}),l.jsx("input",{type:"number",value:k.canvas_height,onChange:N=>w(k.id,k.canvas_width,parseInt(N.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Canvas Width"}),l.jsx("input",{type:"number",value:k.max_canvas_width,onChange:N=>S(k.id,parseInt(N.target.value),k.max_canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Canvas Height"}),l.jsx("input",{type:"number",value:k.max_canvas_height,onChange:N=>S(k.id,k.max_canvas_width,parseInt(N.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]})]})]})]},k.id))})]}),f.error&&l.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:f.error}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx(tt,{onClick:r,variant:"secondary",disabled:f.isLoading,children:"Cancel"}),l.jsx(tt,{onClick:E,variant:"primary",disabled:f.isLoading||!c.test_name.trim(),className:"flex items-center gap-2",children:f.isLoading?l.jsxs(l.Fragment,{children:[l.jsx(Sr,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})})},gW=({onChange:e})=>{const[t]=C.useContext(x0)||[];return C.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{On().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},mW=({onAddBlank:e,blankCount:t})=>{const[r]=C.useContext(x0)||[],n=C.useCallback(()=>{r&&r.dispatchCommand(Da,"bold")},[r]),s=C.useCallback(()=>{r&&r.dispatchCommand(Da,"italic")},[r]),a=C.useCallback(()=>{r&&r.dispatchCommand(Da,"underline")},[r]),i=C.useCallback(()=>{r&&r.dispatchCommand(Da,"strikethrough")},[r]),o=C.useCallback(v=>{r&&r.update(()=>{const w=Rt();yt(w)&&Kh(w,()=>Su(v))})},[r]),c=C.useCallback(()=>{r&&r.update(()=>{const v=Rt();yt(v)&&Kh(v,()=>An())})},[r]),d=C.useCallback(()=>{r&&r.update(()=>{const v=Rt();yt(v)&&Kh(v,()=>Mp())})},[r]),f=C.useCallback(()=>{r&&r.dispatchCommand(Kb)},[r]),p=C.useCallback(()=>{r&&r.dispatchCommand(qb)},[r]),m=C.useCallback(()=>{r&&r.dispatchCommand(Xb)},[r]),y=C.useCallback(()=>{!r||!e||(r.update(()=>{const v=Rt();if(yt(v)){const S=`${t+1}_________`,E=Qn(S);E.setStyle("background-color: #f0f9ff; border: 1px dashed #3b82f6; padding: 2px 4px; border-radius: 4px; font-family: monospace;"),v.insertNodes([E])}}),e())},[r,e,t]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:a,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>o("h1"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>o("h2"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>o("h3"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"}),l.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Quote",children:'"'})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:f,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:"•"}),l.jsx("button",{type:"button",onClick:p,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1."}),l.jsx("button",{type:"button",onClick:m,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"↶"})]}),e&&l.jsx("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:l.jsxs("button",{type:"button",onClick:y,className:"px-3 py-1 text-sm font-medium bg-blue-500 text-white border border-blue-600 rounded hover:bg-blue-600 transition-colors",title:"Add Blank",children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline mr-1",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Blank"]})})]})},pW=({value:e,onChange:t,placeholder:r,onAddBlank:n,blankCount:s=0})=>{const a={namespace:"FillBlanksLexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Lp,Hu,Ec,Ip,yf,Hy,Op,k0,C0,T0,Gu],onError:i=>{console.error("Lexical error:",i)},editorState:e?(()=>{try{const i=JSON.parse(e);return JSON.stringify(i)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs(UA,{initialConfig:a,children:[l.jsx(mW,{onAddBlank:n,blankCount:s}),l.jsx(gW,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(s8,{contentEditable:l.jsx(i8,{className:"p-4 min-h-32 focus:outline-none"}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:c8}),l.jsx(o8,{}),l.jsx(l8,{}),l.jsx(T8,{}),l.jsx(C8,{transformers:Gy})]})]})})},xW=({testName:e="",allowedTime:t=null,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const{user:o}=Gn();Ho();const{showNotification:c}=Oa(),[d,f]=C.useState({test_name:e,test_text:"",num_questions:1,num_blanks:0,passing_score:100,separate_type:!0,allowed_time:t,blanks:[]}),[p,m]=C.useState({isLoading:!1,error:null,showPreview:!0});C.useEffect(()=>{f(A=>({...A,test_name:e||"",allowed_time:t}))},[e,t]);const y=A=>{f(R=>({...R,test_text:A}))},v=()=>{const R={id:d.blanks.length+1,position:0,question:"",options:["","","",""],correct_answer:""};f(T=>({...T,blanks:[...T.blanks,R],num_blanks:T.num_blanks+1}))},w=A=>{f(R=>({...R,blanks:R.blanks.filter(T=>T.id!==A),num_blanks:R.num_blanks-1}))},S=A=>{f(R=>({...R,blanks:R.blanks.map(T=>T.id===A?{...T,options:[...T.options,""]}:T)}))},E=(A,R)=>{f(T=>({...T,blanks:T.blanks.map(D=>D.id===A?{...D,options:D.options.filter((L,O)=>O!==R),correct_answer:D.correct_answer===String.fromCharCode(65+R)?"":D.correct_answer}:D)}))},k=(A,R,T)=>{f(D=>({...D,blanks:D.blanks.map(L=>L.id===A?{...L,options:L.options.map((O,G)=>G===R?T:O)}:L)}))},_=(A,R)=>{console.log("🔍 [DEBUG] updateBlankQuestion called:",{blankId:A,question:R}),f(T=>({...T,blanks:T.blanks.map(D=>D.id===A?{...D,question:R}:D)})),console.log("🔍 [DEBUG] updateBlankQuestion completed")},N=(A,R)=>{f(T=>({...T,blanks:T.blanks.map(D=>D.id===A?{...D,correct_answer:R}:D)}))},F=async()=>{if(!d.test_name.trim()){m(A=>({...A,error:"Test name is required"}));return}if(!d.test_text.trim()){m(A=>({...A,error:"Test text is required"}));return}if(d.blanks.length===0){m(A=>({...A,error:"At least one blank is required"}));return}if(console.log("🔍 [DEBUG] Validating blanks:",d.blanks),d.blanks.forEach((A,R)=>{console.log(`🔍 [DEBUG] Blank ${R+1}:`,{question:A.question,questionTrimmed:A.question?.trim(),correct_answer:A.correct_answer,options:A.options})}),d.separate_type===!1){if(d.blanks.some(A=>!A.correct_answer)){console.log("❌ [DEBUG] Validation failed - some blanks missing correct answer"),m(A=>({...A,error:"All blanks must have correct answers"}));return}}else if(d.blanks.some(A=>!A.question.trim()||!A.correct_answer)){console.log("❌ [DEBUG] Validation failed - some blanks missing question or correct answer"),m(A=>({...A,error:"All blanks must have question text and correct answer"}));return}console.log("✅ [DEBUG] Validation passed - all blanks have question and correct answer"),m(A=>({...A,isLoading:!0,error:null}));try{const A={test_name:d.test_name,test_text:d.test_text,num_questions:d.blanks.length,num_blanks:d.blanks.length,separate_type:d.separate_type,passing_score:d.passing_score,allowed_time:d.allowed_time,blanks:d.blanks.map((R,T)=>({question_id:T+1,question_json:R.question,question:R.question,options:R.options,correct_answer:R.correct_answer,blank_positions:{},blank_options:R.options||[],correct_answers:[R.correct_answer]}))};console.log("🎯 [DEBUG] Calling onTestSaved with data:",A),r?(console.log("🎯 [DEBUG] onTestSaved function exists, calling it..."),r(A),console.log("🎯 [DEBUG] onTestSaved called successfully")):console.log("❌ [DEBUG] onTestSaved function is null/undefined")}catch(A){console.error("Error preparing fill blanks test:",A),m(R=>({...R,error:"Failed to prepare fill blanks test. Please try again."})),c("Failed to prepare fill blanks test","error")}finally{m(A=>({...A,isLoading:!1}))}};return l.jsx("div",{className:"fill-blanks-test-creator max-w-4xl mx-auto p-6",children:l.jsxs(mt,{className:"p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Fill Blanks Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test with rich text content and multiple choice blanks"}),l.jsx("div",{className:"mt-2 text-sm text-gray-600",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Blanks:"})," ",d.num_blanks," (auto-calculated)"]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Timer:"})," ",d.allowed_time?`${d.allowed_time} minutes`:"No timer"]})]})}),p.error&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600 text-sm",children:p.error})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Text Content with Blanks"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Type your text and add blanks where needed"})]}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mode:"}),l.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[l.jsx("button",{onClick:()=>f(A=>({...A,separate_type:!0})),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${d.separate_type===!0?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Separate"}),l.jsx("button",{onClick:()=>f(A=>({...A,separate_type:!1})),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${d.separate_type===!1?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Inline"})]})]})})]}),l.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:d.separate_type===!0?"Separate Mode:":"Inline Mode:"})," ",d.separate_type===!0?"Students see numbered blanks in text and answer questions below":"Students see clickable blanks in text with dropdown options"]})}),l.jsx(pW,{value:d.test_text,onChange:y,placeholder:"Type your text here. Use the 'Add Blank' button in the toolbar to insert blanks.",onAddBlank:v,blankCount:d.blanks.length})]}),d.separate_type===!0&&l.jsx("div",{className:"space-y-4",children:d.blanks.map((A,R)=>l.jsxs(mt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",A.id," Configuration"]}),l.jsx(tt,{variant:"danger",size:"small",onClick:()=>w(A.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Question Text for Blank ",A.id," *"]}),l.jsx("input",{type:"text",placeholder:"Enter question text for this blank",value:A.question,onChange:T=>_(A.id,T.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),A.options.map((T,D)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+D)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+D)}`,value:T||"",onChange:L=>k(A.id,D,L.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),A.options.length>2&&l.jsx(tt,{variant:"danger",size:"small",onClick:()=>E(A.id,D),className:"px-2 py-1 text-sm",children:"×"})]},D)),A.options.length<6&&l.jsx(tt,{variant:"secondary",size:"small",onClick:()=>S(A.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:A.correct_answer||"",onChange:T=>N(A.id,T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),A.options.filter(T=>T.trim().length>0).map((T,D)=>l.jsxs("option",{value:String.fromCharCode(65+D),children:[String.fromCharCode(65+D),") ",T]},D))]})]})]},A.id))}),d.separate_type===!1&&l.jsx("div",{className:"space-y-4",children:d.blanks.map((A,R)=>l.jsxs(mt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",A.id," Options"]}),l.jsx(tt,{variant:"danger",size:"small",onClick:()=>w(A.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),A.options.map((T,D)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+D)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+D)}`,value:T||"",onChange:L=>k(A.id,D,L.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),A.options.length>2&&l.jsx(tt,{variant:"danger",size:"small",onClick:()=>E(A.id,D),className:"px-2 py-1 text-sm",children:"×"})]},D)),A.options.length<6&&l.jsx(tt,{variant:"secondary",size:"small",onClick:()=>S(A.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:A.correct_answer||"",onChange:T=>N(A.id,T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),A.options.filter(T=>T.trim().length>0).map((T,D)=>l.jsxs("option",{value:String.fromCharCode(65+D),children:[String.fromCharCode(65+D),") ",T]},D))]})]})]},A.id))}),l.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[l.jsx(tt,{onClick:n,variant:"secondary",disabled:a,children:"Cancel"}),l.jsx(tt,{onClick:F,variant:"primary",disabled:a||d.blanks.length===0,children:a?l.jsx(Sr,{size:"sm"}):"Save Test"})]})]})})},E8=(e,t)=>{const[r,n]=C.useState(()=>{try{const i=window.localStorage.getItem(e);return i?JSON.parse(i):t}catch(i){return console.error(`Error reading localStorage key "${e}":`,i),t}}),s=C.useCallback(i=>{try{const o=i instanceof Function?i(r):i;n(o),window.localStorage.setItem(e,JSON.stringify(o))}catch(o){console.error(`Error setting localStorage key "${e}":`,o)}},[e,r]),a=C.useCallback(()=>{try{window.localStorage.removeItem(e),n(t)}catch(i){console.error(`Error removing localStorage key "${e}":`,i)}},[e,t]);return[r,s,a]},Vy=()=>{const e=C.useCallback((c,d=null)=>{try{const f=window.localStorage.getItem(c);return f?JSON.parse(f):d}catch(f){return console.error(`Error reading localStorage key "${c}":`,f),d}},[]),t=C.useCallback((c,d)=>{try{window.localStorage.setItem(c,JSON.stringify(d))}catch(f){console.error(`Error setting localStorage key "${c}":`,f)}},[]),r=C.useCallback(c=>{try{window.localStorage.removeItem(c)}catch(d){console.error(`Error removing localStorage key "${c}":`,d)}},[]),n=C.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(c){console.error("Error clearing localStorage:",c)}},[]),s=C.useCallback(()=>{try{const c={};for(let m=0;m<window.localStorage.length;m++){const y=window.localStorage.key(m);y&&(c[y]=window.localStorage.getItem(y))}const d=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),f=URL.createObjectURL(d),p=document.createElement("a");p.href=f,p.download="localStorage_backup.json",p.click(),URL.revokeObjectURL(f),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(c){console.error("Error exporting localStorage data:",c)}},[]),a=C.useCallback(()=>{try{window.localStorage.clear()}catch(c){console.error("Error clearing localStorage:",c)}},[]),i=C.useCallback(()=>{try{const c={};for(let d=0;d<window.localStorage.length;d++){const f=window.localStorage.key(d);f&&(c[f]=window.localStorage.getItem(f))}return c}catch(c){return console.error("Error exporting localStorage data:",c),{}}},[]),o=C.useCallback(c=>{try{Object.entries(c).forEach(([d,f])=>{window.localStorage.setItem(d,f)})}catch(d){console.error("Error importing localStorage data:",d)}},[]);return{getItem:e,setItem:t,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:o}},yW=({question:e,testId:t,testType:r="true_false",mode:n="student",displayNumber:s,onAnswerChange:a,onQuestionChange:i,onSave:o,isEditing:c=!1,isSaving:d=!1,validationErrors:f={},showCorrectAnswers:p=!1,studentId:m=null})=>{const{getItem:y,setItem:v}=Vy();Oa(),C.useRef(null);const[w,S]=C.useState(""),[E,k]=C.useState(""),[_,N]=C.useState(""),[F,A]=C.useState(!1),[R,T]=C.useState(!0),[D,L]=C.useState(""),[O,G]=C.useState(!1),[K,te]=C.useState(null);C.useEffect(()=>{if(e&&(N(e.question||""),k(e.correct_answer||""),n==="student"&&m)){const ie=y(`test_progress_${m}_${r}_${t}_${e.question_id}`);ie&&S(ie)}},[e,t,r,n,y]),C.useEffect(()=>{if(n==="student"&&w&&t&&e?.question_id&&m){const ie=setTimeout(()=>{G(!0),v(`test_progress_${m}_${r}_${t}_${e.question_id}`,w),te(new Date().toLocaleTimeString()),setTimeout(()=>G(!1),1e3)},1e3);return()=>clearTimeout(ie)}},[w,t,r,e?.question_id,n,m,v]),C.useEffect(()=>{if(n==="teacher"&&(_||E)){const ie=setTimeout(()=>{G(!0);const ae={question:_,correct_answer:E,timestamp:Date.now()};v(`teacher_form_${r}_${t}`,ae),te(new Date().toLocaleTimeString()),setTimeout(()=>G(!1),1e3)},2e3);return()=>clearTimeout(ie)}},[_,E,t,r,n,v]);const Z=C.useCallback(ie=>{n==="student"&&(S(ie),a&&a(e.question_id,ie),W(ie))},[n,e?.question_id,a]),J=C.useCallback(ie=>{N(ie),i&&i(e.question_id,ie),B(ie)},[e?.question_id,i]),I=C.useCallback(ie=>{k(ie),i&&i(e.question_id,{...e,correct_answer:ie}),Y(ie)},[e,i]),W=C.useCallback(ie=>{if(n==="student"){if(!ie){T(!1),L("Please select an answer");return}T(!0),L("")}},[n]),B=C.useCallback(ie=>{if(n==="teacher"){if(!ie||ie.trim().length<10){T(!1),L("Question must be at least 10 characters long");return}T(!0),L("")}},[n]),Y=C.useCallback(ie=>{if(n==="teacher"){if(!ie){T(!1),L("Please select a correct answer");return}T(!0),L("")}},[n]),V=C.useCallback(()=>{if(n!=="teacher"||!o)return;const ie={question_id:e.question_id,question:_,correct_answer:E,type:"true_false"};o(ie)},[n,o,e?.question_id,_,E]),H=C.useCallback(ie=>ie?ie.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),X=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e?.question_id]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[O&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Sr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),K&&!O&&l.jsxs("div",{className:"text-green-600",children:["✓ Saved at ",K]})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:H(_)}}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="true"?"border-blue-500 bg-blue-50":"border-gray-200"} ${p&&E==="true"?"ring-2 ring-green-400":""}`,children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"true",checked:w==="true",onChange:()=>Z("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="false"?"border-blue-500 bg-blue-50":"border-gray-200"} ${p&&E==="false"?"ring-2 ring-green-400":""}`,children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"false",checked:w==="false",onChange:()=>Z("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]}),!R&&D&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:D})]}),se=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[O&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Sr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),K&&!O&&l.jsxs("div",{className:"text-green-600",children:["✓ Saved at ",K]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("textarea",{id:`question_${e?.question_id}`,value:_,onChange:ie=>J(ie.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${E==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"true",checked:E==="true",onChange:()=>I("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${E==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:E==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${E==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"false",checked:E==="false",onChange:()=>I("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${E==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:E==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!R&&D&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:D}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(tt,{variant:"success",onClick:V,disabled:!R||d,className:"w-full sm:w-auto",children:d?l.jsx(Sr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:"true-false-question-container",children:n==="student"?X():se()})},vW=({question:e,testId:t,testType:r="multiple_choice",mode:n="student",onAnswerChange:s,onQuestionChange:a,onOptionAdd:i,onOptionRemove:o,onSave:c,isEditing:d=!1,isSaving:f=!1,validationErrors:p={},showCorrectAnswers:m=!1,studentId:y=null,displayNumber:v})=>{const{getItem:w,setItem:S}=Vy(),{showNotification:E}=Oa();C.useRef(null);const[k,_]=C.useState(""),[N,F]=C.useState(["","","",""]),[A,R]=C.useState(""),[T,D]=C.useState(""),[L,O]=C.useState(!1),[G,K]=C.useState(!0),[te,Z]=C.useState(""),[J,I]=C.useState(!1),[W,B]=C.useState(null);C.useEffect(()=>{if(e&&(D(e.question||""),F(e.options||["","","",""]),R(e.correct_answer||""),n==="student"&&y)){const ye=w(`test_progress_${y}_${r}_${t}_${e.question_id}`);ye&&_(ye)}},[e,t,r,n,w]),C.useEffect(()=>{if(n==="student"&&k&&t&&e?.question_id&&y){const ye=setTimeout(()=>{I(!0),S(`test_progress_${y}_${r}_${t}_${e.question_id}`,k),B(new Date().toLocaleTimeString()),setTimeout(()=>I(!1),1e3)},1e3);return()=>clearTimeout(ye)}},[k,t,r,e?.question_id,n,y,S]),C.useEffect(()=>{if(n==="teacher"&&(T||N.some(ye=>ye.trim()))){const ye=setTimeout(()=>{I(!0);const Ke={question:T,options:N,correct_answer:A,timestamp:Date.now()};S(`teacher_form_${r}_${t}`,Ke),B(new Date().toLocaleTimeString()),setTimeout(()=>I(!1),1e3)},2e3);return()=>clearTimeout(ye)}},[T,N,A,t,r,n,S]),C.useCallback(ye=>{if(n!=="student")return;const Ke=String(ye);_(Ke),s&&s(e.question_id,Ke),ie(Ke)},[n,e?.question_id,s]);const Y=C.useCallback(ye=>{D(ye),a&&a(e.question_id,ye),ae(ye)},[e?.question_id,a]),V=C.useCallback((ye,Ke)=>{const Xe=[...N];Xe[ye]=Ke,F(Xe),a&&a(e.question_id,{...e,options:Xe}),Q(Xe)},[N,e,a]),H=C.useCallback(ye=>{R(ye),a&&a(e.question_id,{...e,correct_answer:ye}),le(ye)},[e,a]),X=C.useCallback(()=>{if(N.length<6){const ye=[...N,""];F(ye),i&&i(e.question_id,ye)}else E("Maximum 6 options allowed","warning")},[N,e?.question_id,i,E]),se=C.useCallback(ye=>{if(N.length>2){const Ke=N.filter((Xe,lt)=>lt!==ye);if(F(Ke),A===String.fromCharCode(65+ye))R("");else if(A&&String.fromCharCode(65+ye)<A){const Xe=String.fromCharCode(65+ye-1);R(Xe)}o&&o(e.question_id,Ke)}else E("Minimum 2 options required","warning")},[N,A,e?.question_id,o,E]),ie=C.useCallback(ye=>{if(n==="student"){if(!ye){K(!1),Z("Please select an answer");return}K(!0),e?.correct_answer&&ye===e.correct_answer?Z("✅ Correct answer!"):e?.correct_answer?Z("❌ Incorrect answer"):Z("Answer selected")}},[n,e?.correct_answer]),ae=C.useCallback(ye=>!ye||ye.trim().length<10?(K(!1),Z("Question must be at least 10 characters long"),!1):(K(!0),Z(""),!0),[]),Q=C.useCallback(ye=>{if(n!=="teacher")return;if(ye.filter(Xe=>Xe.trim().length>0).length<2){K(!1),Z("At least 2 options must be filled");return}if(ye.some(Xe=>Xe.trim().length>0&&Xe.trim().length<3)){K(!1),Z("Each option must be at least 3 characters long");return}K(!0),Z("")},[n]),le=C.useCallback(ye=>{if(n==="teacher"){if(!ye){K(!1),Z("Please select a correct answer");return}K(!0),Z("")}},[n]),_e=C.useCallback(()=>{if(n!=="teacher"||!c)return;const ye={question_id:e.question_id,question:T,options:N.filter(Ke=>Ke.trim().length>0),correct_answer:A,type:"multiple_choice"};c(ye)},[n,c,e?.question_id,T,N,A]),ke=C.useCallback(ye=>ye?ye.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]);return n==="teacher"?l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[J&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Sr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),W&&!J&&l.jsxs("div",{className:"text-green-600",children:["✓ Saved at ",W]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("textarea",{id:`question_${e?.question_id}`,value:T,onChange:ye=>Y(ye.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),l.jsx(tt,{variant:"secondary",size:"small",onClick:X,disabled:N.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),l.jsx("div",{className:"space-y-3",children:N.map((ye,Ke)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+Ke)}),l.jsx("input",{type:"text",value:ye,onChange:Xe=>V(Ke,Xe.target.value),placeholder:`Option ${String.fromCharCode(65+Ke)}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0}),N.length>2&&l.jsx(tt,{variant:"danger",size:"small",onClick:()=>se(Ke),className:"px-2 py-1 text-sm",children:"×"})]},Ke))})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:`correct_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{id:`correct_${e?.question_id}`,value:A,onChange:ye=>H(ye.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[l.jsx("option",{value:"",children:"Select correct answer"}),N.map((ye,Ke)=>{if(!ye.trim())return null;const Xe=String.fromCharCode(65+Ke);return l.jsxs("option",{value:Xe,children:[Xe,") ",ye]},Ke)})]})]})]}),!G&&te&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:te}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(tt,{variant:"success",onClick:_e,disabled:!G||f,className:"w-full sm:w-auto",children:f?l.jsx(Sr,{size:"small"}):"Save Question"})})]}):l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof v=="number"?v:e?.question_id]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[J&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Sr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),W&&!J&&l.jsxs("div",{className:"text-green-600",children:["✓ Saved at ",W]})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:ke(T)}}),l.jsx("div",{className:"space-y-3",children:N.map((ye,Ke)=>l.jsxs("label",{className:`flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${k===String.fromCharCode(65+Ke)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[l.jsx("input",{type:"radio",name:`mcq_${t}_${e?.question_id}`,value:String.fromCharCode(65+Ke),checked:k===String.fromCharCode(65+Ke),onChange:Xe=>{_(Xe.target.value),s&&s(e?.question_id,Xe.target.value)},className:"mr-3"}),l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600 mr-3",children:String.fromCharCode(65+Ke)}),l.jsx("span",{className:"flex-1",children:ye||`Option ${String.fromCharCode(65+Ke)}`})]},Ke))}),!G&&te&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:te})]})},wW=({question:e,testId:t,testType:r="input",mode:n="student",displayNumber:s,onAnswerChange:a,onQuestionChange:i,onAnswerAdd:o,onAnswerRemove:c,onSave:d,isEditing:f=!1,isSaving:p=!1,validationErrors:m={},showCorrectAnswers:y=!1,studentId:v=null})=>{const{getItem:w,setItem:S}=Vy(),{showNotification:E}=Oa(),k=C.useRef(null),[_,N]=C.useState(""),[F,A]=C.useState([""]),[R,T]=C.useState(!1),[D,L]=C.useState(!0),[O,G]=C.useState(""),[K,te]=C.useState(!1);C.useEffect(()=>{if(n==="student"&&e?.question_id&&t&&r&&v){const ae=`test_progress_${v}_${r}_${t}_${e.question_id}`,Q=w(ae);Q&&N(Q)}},[e?.question_id,r,t,n,v,w]),C.useEffect(()=>{n==="teacher"&&e?.answers&&A(e.answers.length>0?e.answers:[""])},[e?.answers,n]),C.useEffect(()=>{if(n==="student"&&_&&e?.question_id&&t&&r&&v){const ae=setTimeout(()=>{te(!0),S(`test_progress_${v}_${r}_${t}_${e.question_id}`,_),setTimeout(()=>te(!1),1e3)},1e3);return()=>clearTimeout(ae)}},[_,e?.question_id,r,t,n,v,S]),C.useEffect(()=>{if(n==="teacher"&&F&&i){const ae=setTimeout(()=>{i({...e,answers:F.filter(Q=>Q.trim())})},500);return()=>clearTimeout(ae)}},[F,e,n,i]);const Z=C.useCallback(ae=>{N(ae);const Q=ae.trim().length>0;L(Q),G(Q?"":"Please enter an answer"),a&&a(e.question_id,ae)},[e?.question_id,a]),J=C.useCallback((ae,Q)=>{const le=[...F];le[ae]=Q,A(le),a&&a(e.question_id,le)},[F,e?.question_id,a]),I=C.useCallback(()=>{if(n==="teacher"){const ae=[...F,""];A(ae),o&&o(e.question_id,ae)}},[F,e?.question_id,n,o]),W=C.useCallback(ae=>{if(n==="teacher"&&F.length>1){const Q=F.filter((le,_e)=>_e!==ae);A(Q),c&&c(e.question_id,Q)}},[F,e?.question_id,n,c]),B=C.useCallback(()=>{if(n==="student"){const ae=_.trim().length>0;return L(ae),G(ae?"":"Please enter an answer"),ae}else if(n==="teacher"){const ae=F.some(Q=>Q.trim().length>0);return L(ae),G(ae?"":"Please enter at least one correct answer"),ae}return!0},[_,F,n]),Y=C.useCallback(ae=>ae?ae.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"",[]),V=C.useCallback(()=>{T(!0)},[]),H=C.useCallback(()=>{T(!1),B()},[B]),X=C.useCallback(ae=>{ae.key==="Enter"&&n==="student"&&_.trim()&&(S(`test_progress_${r}_${t}_${e.question_id}`,_),E("Answer saved","success"))},[_,r,t,e?.question_id,n,S,E]),se=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e.question_id]}),K&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(Sr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:Y(e.question)}}),l.jsx("div",{className:"space-y-3",children:l.jsx("input",{ref:k,type:"text",id:`input_${e.question_id}`,placeholder:"Enter your answer here...",value:_,onChange:ae=>Z(ae.target.value),onFocus:V,onBlur:H,onKeyPress:X,className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${D?R?"border-blue-500":"border-gray-300 hover:border-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500"}`,"data-question-id":e.question_id,"aria-label":`Answer for question ${e.question_id}`,"aria-invalid":!D,"aria-describedby":D?void 0:`error-${e.question_id}`})}),y&&e.correct_answers&&l.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[l.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),l.jsx("ul",{className:"space-y-1",children:e.correct_answers.map((ae,Q)=>l.jsxs("li",{className:"text-green-700 text-sm",children:["• ",ae]},Q))})]})]}),ie=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e.question_id||"New"]}),p&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(Sr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("input",{type:"text",id:`question_${e.question_id||"new"}`,value:e.question||"",onChange:ae=>i&&i({...e,question:ae.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${m.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),m.question&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:m.question})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),l.jsx(tt,{type:"button",variant:"secondary",size:"small",onClick:I,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),l.jsx("div",{className:"space-y-3",children:F.map((ae,Q)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:Q+1}),l.jsx("input",{type:"text",value:ae,onChange:le=>J(Q,le.target.value),placeholder:`Correct answer ${Q+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":e.question_id,"data-answer-index":Q}),F.length>1&&l.jsx(tt,{type:"button",variant:"danger",size:"small",onClick:()=>W(Q),className:"px-2 py-1 text-sm",children:"× Remove"})]},Q))}),m.answers&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:m.answers})]})]}),d&&l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(tt,{type:"button",variant:"success",onClick:d,disabled:p,className:"w-full sm:w-auto",children:p?l.jsx(Sr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:`input-question-container ${n} ${R?"focused":""}`,children:n==="student"?se():ie()})},Mo=({isOpen:e=!1,onClose:t,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:o="",...c})=>{if(!e)return null;const d=p=>{i&&p.target===p.currentTarget&&t()};Cs.useEffect(()=>{const p=m=>{m.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",p),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",p),document.body.style.overflow="unset"}},[e,t]);const f={small:"max-w-sm",medium:"max-w-md",large:"max-w-2xl"};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:d,role:"dialog","aria-modal":"true","aria-label":r,...c,children:l.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-6
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${f[s]} mx-auto
          ${o}
        `,onClick:p=>p.stopPropagation(),children:[(r||a)&&l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&l.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&l.jsx(tt,{variant:"secondary",size:"small",onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200","aria-label":"Close modal",children:"×"})]}),l.jsx("div",{className:"space-y-6",children:n})]})})},Up=(e,t,r)=>{const[n,s]=C.useState(!1),[a,i]=C.useState(0),[o,c]=C.useState(!1),d=C.useRef(!1);C.useEffect(()=>{if(!e||!t||!r)return;const S=`anti_cheating_${r}_${e}_${t}`,E=Mn(S);E&&(i(E.tabSwitches||0),c(E.isCheating||!1))},[e,t,r]);const f=C.useCallback(()=>{if(console.log("🛡️ handleTabSwitch called - isTracking:",d.current),!d.current){console.log("🛡️ Not tracking, returning early");return}console.log("🛡️ Tab switch detected - starting 7 second timer...");const S=Date.now();setTimeout(()=>{const E=Date.now()-S;console.log("🛡️ Timer completed - time hidden:",E,"ms"),E>=6500?(console.log("🛡️ Tab was hidden for sufficient time - counting as tab switch"),i(k=>{const _=k+1,N=_>=2;console.log("🛡️ Tab switch count updated:",{newCount:_,cheating:N}),c(N);const F=`anti_cheating_${r}_${e}_${t}`;return kn(F,{tabSwitches:_,isCheating:N},120*1e3),_})):console.log("🛡️ Tab was not hidden long enough - not counting as switch")},7e3)},[e,t,r]),p=C.useCallback(()=>{d.current&&(console.log("🛡️ Visibility change detected:",{hidden:document.hidden,isTracking:d.current}),document.hidden?f():console.log("🛡️ Tab became visible"))},[f]),m=C.useCallback(()=>{console.log("🛡️ startTracking called - setting up anti-cheating detection"),console.log("🛡️ Current document.hidden state:",document.hidden),console.log("🛡️ Current document.visibilityState:",document.visibilityState),s(!0),d.current=!0,document.addEventListener("visibilitychange",p),console.log("🛡️ Anti-cheating event listeners added (visibilitychange only)")},[p]),y=C.useCallback(()=>{console.log("🛡️ stopTracking called - removing anti-cheating detection"),s(!1),d.current=!1,document.removeEventListener("visibilitychange",p),console.log("🛡️ Anti-cheating event listeners removed")},[p]),v=C.useCallback(()=>{const S={caught_cheating:o,visibility_change_times:a};return console.log("🛡️ getCheatingData called:",S),S},[o,a]),w=C.useCallback(()=>{r&&e&&t&&h0(r,e,t),i(0),c(!1),console.log("🗑️ Anti-cheating data deleted from localStorage")},[r,e,t]);return{startTracking:m,stopTracking:y,clearData:w,getCheatingData:v,tabSwitches:a,isCheating:o,isTracking:n}},_W=({testData:e,onTestComplete:t,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=C.useState(null),[o,c]=C.useState(null);C.useEffect(()=>{(async()=>{try{const[De,Ge]=await Promise.all([$d(()=>Promise.resolve().then(()=>fO),void 0),$d(()=>Promise.resolve().then(()=>HM),void 0)]);i(De),c(Ge.default)}catch(De){console.error("Failed to load Konva:",De)}})()},[]);const d=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[f,p]=C.useState({}),[m,y]=C.useState({}),[v,w]=C.useState(0),[S,E]=C.useState(!1),[k,_]=C.useState(null),[N,F]=C.useState(0),[A,R]=C.useState(0),[T,D]=C.useState(null),[L,O]=C.useState(null),[G,K]=C.useState(!1),[te,Z]=C.useState(!1),{showNotification:J}=Oa(),{makeAuthenticatedRequest:I}=Ho(),{user:W}=Gn(),{startTracking:B,stopTracking:Y,getCheatingData:V,clearData:H}=Up("matching_type",e?.id,W?.student_id||W?.id),X=C.useRef(null),se=C.useRef(null),ie=C.useRef(null),ae=C.useRef(0),[Q,le]=C.useState(400);C.useRef({});const _e=C.useCallback(()=>{K(!0)},[]),ke=C.useCallback(()=>{y({}),p({}),K(!1)},[]),Oe=C.useCallback(()=>{Z(!0)},[]),ge=C.useCallback(()=>{Z(!1),r()},[r]),ye=C.useMemo(()=>{if(!e)return null;const je=e.blocks.map(ct=>{let at=ct.coordinates;if(typeof at=="string")try{at=JSON.parse(at)}catch(wt){console.error("❌ Failed to parse coordinates:",wt),at={x:0,y:0,width:100,height:100}}return at={x:(typeof at.x=="number"?at.x:Number(at.x))||0,y:(typeof at.y=="number"?at.y:Number(at.y))||0,width:(typeof at.width=="number"?at.width:Number(at.width))||30,height:(typeof at.height=="number"?at.height:Number(at.height))||10},{id:ct.id,word:ct.word,coordinates:at,hasArrow:ct.hasArrow,arrow:ct.arrow}}),De=Array.isArray(e.arrows)?e.arrows:[],Ge=e.words.map(ct=>({id:ct.id,word:ct.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:je,arrows:De,words:Ge}},[e]);C.useEffect(()=>{if(!e?.image_url)return;const je=new Image;je.crossOrigin="anonymous",je.onload=()=>{console.log("🖼️ Image loaded successfully"),F(je.width),R(je.height);const De=X.current?.clientWidth||800,Ge=X.current?.clientHeight||600,ct=De/je.width,at=Ge/je.height,wt=Math.min(ct,at,1),Ft=je.width*wt,Kt=je.height*wt,bt=(De-Ft)/2,At=(Ge-Kt)/2;_({x:bt,y:At,width:Ft,height:Kt,scaleX:wt,scaleY:wt,scale:wt,image:je}),ae.current=X.current?.clientWidth||800,console.log("🔍 Image info calculated:",{x:bt,y:At,width:Ft,height:Kt,scaleX:wt,scaleY:wt})},je.onerror=()=>{console.error("❌ Failed to load image"),J("Failed to load test image","error")},je.src=e.image_url},[e?.image_url,J]),C.useEffect(()=>{if(!ye||!k)return;const je=ae.current||X.current?.clientWidth||800,De=12,Ge=38;let ct=k.x,at=k.y+k.height+De;const wt=k.x+k.width,Ft={};ye.words.forEach(At=>{if(!Object.prototype.hasOwnProperty.call(m,At.id)){const gt=typeof At.word=="string"?At.word:"",kt=Math.max(60,gt.length*8+20);ct+kt>Math.min(je-De,wt)&&(ct=k.x,at+=Ge),f[At.id]||(Ft[At.id]={x:ct,y:at}),ct+=kt+De}}),Object.keys(Ft).length&&p(At=>({...At,...Ft}));const Kt=Object.values(Ft).reduce((At,gt)=>Math.max(At,gt.y),at),bt=Math.max(k.y+k.height+De,Kt+Ge+De);le(Math.max(400,Math.ceil(bt)))},[ye,k,m,f]);const Ke=C.useCallback(()=>{if(!k||!ye)return[];const je=d();return je?ye.blocks.map(De=>{const Ge=De.coordinates;let ct,at,wt,Ft;ct=k.x+Ge.x*(k.scale??k.scaleX),at=k.y+Ge.y*(k.scale??k.scaleY),wt=Ge.width*(k.scale??k.scaleX),Ft=Ge.height*(k.scale??k.scaleY);const Kt=m[De.id];return l.jsxs(je.Group,{children:[l.jsx(je.Rect,{x:ct,y:at,width:wt,height:Ft,fill:Kt?"rgba(40, 167, 69, 0.4)":T===De.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:Kt?"#28a745":T===De.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:Kt?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),Kt&&l.jsx(je.KonvaText,{x:ct+5,y:at+Ft/2-10,width:wt-10,height:20,text:ye.words.find(bt=>bt.id===Kt)?.word||"",fontSize:Math.min(12,wt/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},De.id)}):[]},[k,ye,m,a]),Xe=C.useCallback(()=>{if(!k||!ye)return[];const je=d();return je?(console.log("🔍 Processing arrows:",ye.arrows),ye.arrows.map(De=>{if(console.log("🔍 Arrow data:",De),!De.start||!De.end)return console.warn("⚠️ Arrow missing start/end coordinates:",De),null;let Ge,ct,at,wt;if(De.rel_start_x!==null&&De.rel_start_y!==null&&De.rel_end_x!==null&&De.rel_end_y!==null&&De.image_width&&De.image_height&&De.image_width>0&&De.image_height>0){const Ft=De.image_width,Kt=De.image_height,bt=k.width/Ft,At=k.height/Kt;Ge=k.x+Number(De.rel_start_x)/100*Ft*bt,ct=k.y+Number(De.rel_start_y)/100*Kt*At,at=k.x+Number(De.rel_end_x)/100*Ft*bt,wt=k.y+Number(De.rel_end_y)/100*Kt*At}else{const Ft=k.scale??k.scaleX??1,Kt=Number(De.start.x),bt=Number(De.start.y),At=Number(De.end.x),gt=Number(De.end.y);Kt<=k.width+1&&At<=k.width+1&&bt<=k.height+1&&gt<=k.height+1?(Ge=k.x+(isNaN(Kt)?0:Kt),ct=k.y+(isNaN(bt)?0:bt),at=k.x+(isNaN(At)?0:At),wt=k.y+(isNaN(gt)?0:gt)):(Ge=k.x+(isNaN(Kt)?0:Kt)*Ft,ct=k.y+(isNaN(bt)?0:bt)*Ft,at=k.x+(isNaN(At)?0:At)*Ft,wt=k.y+(isNaN(gt)?0:gt)*Ft)}return l.jsx(je.Arrow,{points:[Ge,ct,at,wt],stroke:De.style?.color||"#dc3545",fill:De.style?.color||"#dc3545",strokeWidth:De.style?.thickness||3,pointerLength:10,pointerWidth:10},De.id)}).filter(Boolean)):[]},[k,ye,a]),lt=C.useCallback(()=>{if(!ye)return[];const je=d();return je?ye.words.map(De=>{const Ge=f[De.id]||{x:0,y:0},ct=typeof De.word=="string"?De.word:"",at=Math.max(60,ct.length*8+20);return Object.values(m).includes(De.id)?null:l.jsxs(je.Group,{x:Ge.x,y:Ge.y,draggable:!0,onDragEnd:Ft=>Ye(Ft,De.id),children:[l.jsx(je.Rect,{width:at,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),l.jsx(je.KonvaText,{text:ct,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:at,height:34,listening:!1})]},De.id)}):[]},[ye,f,m,k,a]),Ye=C.useCallback((je,De)=>{const Ge=je.target.x(),ct=je.target.y();if(p(kt=>({...kt,[De]:{x:Ge,y:ct}})),!k||!ye)return;const at=ye.words.find(kt=>kt.id===De);if(!at)return;const wt=typeof at.word=="string"?at.word:"",Ft=Math.max(60,wt.length*8+20),Kt={x:Ge,y:ct,width:Ft,height:34},bt=k.scale??k.scaleX??1,At=(kt,Gt)=>!(Gt.x>kt.x+kt.width||Gt.x+Gt.width<kt.x||Gt.y>kt.y+kt.height||Gt.y+Gt.height<kt.y),gt=ye.blocks.find(kt=>{const Gt=kt.coordinates,$t={x:k.x+Gt.x*bt,y:k.y+Gt.y*bt,width:Gt.width*bt,height:Gt.height*bt};return At(Kt,$t)});if(gt){y(ut=>({...ut,[gt.id]:De}));const kt=gt.coordinates,Gt=k.x+kt.x*bt,$t=k.y+kt.y*bt,Be=kt.width*bt,it=kt.height*bt;p(ut=>({...ut,[De]:{x:Gt+(Be-Ft)/2,y:$t+(it-34)/2}})),J(`Word "${at.word}" placed in block`,"success")}},[k,ye,J]),We=C.useCallback(()=>{if(!ye)return 0;const je=ye.words.length,De=Object.keys(m).length;return je>0?De/je*100:0},[ye,m]);C.useEffect(()=>{const je=We();w(je)},[We]),C.useEffect(()=>{if(e&&!L){const je=new Date;O(je),console.log("⏱️ Test timer started at:",je.toISOString()),B(),console.log("🛡️ Anti-cheating tracking started")}},[e,L,B]);const Me=C.useCallback(async()=>{if(ye){E(!0);try{const je=ye.words.length;let De=0;console.log("🔍 Scoring check - placedWords:",m),console.log("🔍 Scoring check - blocks:",ye.blocks.map(Be=>({id:Be.id,word:Be.word}))),console.log("🔍 Scoring check - words:",ye.words.map(Be=>({id:Be.id,word:Be.word}))),ye.blocks.forEach(Be=>{const it=m[Be.id];if(console.log(`🔍 Block ${Be.id} (expects "${Be.word}") has placed word ID: ${it}`),it){const ut=ye.words.find(St=>St.id===it);console.log("🔍 Placed word:",ut),ut&&ut.word===Be.word?(De++,console.log(`✅ Correct! Block ${Be.id} has correct word "${ut.word}"`)):console.log(`❌ Incorrect! Block ${Be.id} expected "${Be.word}" but got "${ut?.word||"nothing"}"`)}else console.log(`❌ Block ${Be.id} has no word placed`)});const Ge=De,ct=je;console.log(`🎯 Final Score: ${Ge}/${ct} (${Math.round(Ge/ct*100)}%)`);const at=new Date,wt=L?Math.round((at-L)/1e3):0,Ft=L?L.toISOString():at.toISOString();console.log("⏱️ Test timing:",{startedAt:Ft,endTime:at.toISOString(),timeTaken:`${wt} seconds`});const Kt=V();console.log("🛡️ Anti-cheating data for submission:",Kt);const bt=W.student_id,At=`retest_assignment_id_${bt}_matching_type_${e.id}`,gt=localStorage.getItem(At),kt={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:bt,answers:m,score:Ge,maxScore:ct,time_taken:wt,started_at:Ft,submitted_at:at.toISOString(),caught_cheating:Kt.caught_cheating,visibility_change_times:Kt.visibility_change_times,retest_assignment_id:gt?Number(gt):null,parent_test_id:e.id};console.log("🔍 Submitting test data:",kt);const $t=await(await I("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(kt)})).json();if(console.log("🔍 Submission response:",$t),$t.success){if(J("Test submitted successfully!","success"),Y(),H(),W?.student_id&&h0(W.student_id,"matching_type",e.id),W?.student_id){const it=`test_completed_${W.student_id}_matching_type_${e.id}`;localStorage.setItem(it,"true"),console.log("✅ Test marked as completed in localStorage:",it)}if(W?.student_id){const{setCachedData:it,CACHE_TTL:ut}=await $d(async()=>{const{setCachedData:Mt,CACHE_TTL:Ot}=await Promise.resolve().then(()=>FN);return{setCachedData:Mt,CACHE_TTL:Ot}},void 0),St=`student_results_table_${W.student_id}`;it(St,$t,ut.student_results_table),console.log("🎓 Test results cached with key:",St)}const Be=`retest1_${bt}_matching_type_${e.id}`;localStorage.removeItem(Be),localStorage.removeItem(At),t&&t(Ge)}else throw new Error($t.message||"Failed to submit test")}catch(je){console.error("❌ Error submitting test:",je),J(`Error submitting test: ${je.message}`,"error")}finally{E(!1)}}},[ye,m,e,W,L,I,J,t]);return!e||!ye?l.jsx(Sr,{}):l.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:l.jsxs("div",{className:"max-w-6xl mx-auto",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e.test_name})}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),l.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(v),"%"]})]})]}),l.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${v}%`}})})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:l.jsx("div",{className:"lg:col-span-3",children:l.jsxs(mt,{className:"p-4",children:[l.jsxs("div",{className:"mb-4 text-center space-x-4",children:[l.jsx(tt,{onClick:_e,variant:"secondary",children:"Reset"}),l.jsx(tt,{onClick:Oe,variant:"secondary",children:"Back to Cabinet"})]}),l.jsx("div",{ref:X,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${Q}px`},children:k&&a?(()=>{const{Stage:je,Layer:De,KonvaImage:Ge}=d();return l.jsxs(je,{ref:se,width:X.current?.clientWidth||800,height:Q,children:[l.jsxs(De,{children:[l.jsx(Ge,{ref:ie,image:k.image,x:k.x,y:k.y,width:k.width,height:k.height,listening:!1}),Ke(),Xe()]}),l.jsx(De,{listening:!0,children:lt()})]})})():k?l.jsxs("div",{className:"flex items-center justify-center h-full",children:[l.jsx(Sr,{size:"lg"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),l.jsx("div",{className:"mt-4 text-center",children:l.jsx(tt,{onClick:Me,disabled:S||v<100,children:S?"Submitting...":"Submit Test"})})]})})}),l.jsx(Mo,{isOpen:G,onClose:()=>K(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(tt,{onClick:()=>K(!1),variant:"secondary",children:"Cancel"}),l.jsx(tt,{onClick:ke,variant:"primary",children:"Reset"})]})]})}),l.jsx(Mo,{isOpen:te,onClose:()=>Z(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(tt,{onClick:()=>Z(!1),variant:"secondary",children:"Cancel"}),l.jsx(tt,{onClick:ge,variant:"primary",children:"Go Back"})]})]})})]})})},bW=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=Gn(),{makeAuthenticatedRequest:o}=Ho(),{showNotification:c}=Oa(),[d,f]=C.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[p,m]=C.useState("drag"),[y,v]=C.useState(!1),[w,S]=C.useState(null),E=C.useCallback(()=>{f(R=>[...R,{leftWord:"",rightWord:""}])},[]),k=C.useCallback(R=>{d.length>1&&f(T=>T.filter((D,L)=>L!==R))},[d.length]),_=C.useCallback((R,T)=>{f(D=>D.map((L,O)=>O===R?{...L,leftWord:T}:L))},[]),N=C.useCallback((R,T)=>{f(D=>D.map((L,O)=>O===R?{...L,rightWord:T}:L))},[]),F=C.useCallback(()=>d.every(R=>R.leftWord.trim()&&R.rightWord.trim()),[d]),A=C.useCallback(async()=>{if(!F()){c("Please fill in all word pairs","error");return}v(!0),S(null);try{const R=d.map((D,L)=>({question_id:L+1,left_word:D.leftWord.trim(),right_word:D.rightWord.trim()})),T={test_name:e,num_questions:R.length,interaction_type:p,questions:R};console.log("🎯 Saving word matching test:",T),t({testName:e,numQuestions:R.length,interactionType:p,wordPairs:d,questions:R})}catch(R){console.error("Error saving word matching test:",R),S(R.message),c("Failed to save test: "+R.message,"error")}finally{v(!1)}},[e,d,p,F,o,c,t]);return l.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-6",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Word Matching Test"}),l.jsx("p",{className:"text-gray-600",children:"Enter word pairs - position 1 left matches position 1 right"})]}),l.jsx(mt,{className:"mb-6",children:l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${p==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>m("drag"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:p==="drag",onChange:()=>m("drag"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["• Easier for younger students",l.jsx("br",{}),"• Visual feedback on placement",l.jsx("br",{}),"• Mobile-friendly"]})]}),l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${p==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>m("arrow"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:p==="arrow",onChange:()=>m("arrow"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["• More challenging",l.jsx("br",{}),"• Better for visual learners",l.jsx("br",{}),"• Requires precision"]})]})]})]})}),l.jsx(mt,{className:"mb-6",children:l.jsxs("div",{className:"word-pairs-section",children:[l.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),l.jsx(tt,{onClick:E,size:"sm",children:"+ Add Pair"})]}),l.jsx("div",{className:"pairs-list space-y-3",children:d.map((R,T)=>l.jsxs("div",{className:"word-pair-row flex items-center space-x-4 p-4 bg-gray-50 rounded-lg border",children:[l.jsx("div",{className:"pair-number flex-shrink-0",children:l.jsx("span",{className:"number-badge w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:T+1})}),l.jsx("div",{className:"left-word flex-1",children:l.jsx("input",{type:"text",value:R.leftWord,onChange:D=>_(T,D.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-xl",children:"→"}),l.jsx("div",{className:"right-word flex-1",children:l.jsx("input",{type:"text",value:R.rightWord,onChange:D=>N(T,D.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-actions flex-shrink-0",children:l.jsx(tt,{onClick:()=>k(T),variant:"outline",size:"sm",className:"remove-btn w-8 h-8 p-0 text-red-500 hover:bg-red-50",disabled:d.length<=1,children:"×"})})]},T))})]})}),l.jsx(mt,{className:"mb-6",children:l.jsxs("div",{className:"preview-section",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),l.jsx("div",{className:"preview-pairs space-y-2",children:d.map((R,T)=>l.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[l.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[T+1,"."]}),l.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:R.leftWord||"Left word"}),l.jsx("span",{className:"preview-arrow text-gray-500",children:"→"}),l.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:R.rightWord||"Right word"})]},T))})]})}),l.jsxs("div",{className:"flex justify-center space-x-4",children:[l.jsx(tt,{onClick:A,disabled:!F()||y,className:"px-8",children:y?l.jsxs(l.Fragment,{children:[l.jsx(Sr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),l.jsx(tt,{onClick:r,variant:"secondary",children:"Cancel"})]}),w&&l.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600",children:w})})]})},SW=(e,t)=>{const[r,n,s]=E8(`test_progress_${e}_${t}`,{}),[a,i]=C.useState(!1),[o,c]=C.useState(0),[d,f]=C.useState(0),[p,m]=C.useState(!1),[y,v]=C.useState(null),w=C.useRef(null),S=C.useRef(null),E=C.useCallback((B,Y)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(V=>({...V,[B]:Y})),console.log(`Saved progress for question ${B}:`,Y)},[n]),k=C.useCallback(B=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[B]||null,[r]),_=C.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${e}, testId: ${t}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const B=`test_progress_${e}_${t}`;console.log(`[DEBUG] Removing localStorage key: ${B}`);const Y=Object.keys(r).length>0;s(),console.log(Y?`[DEBUG] Progress cleared for test ${e}_${t}`:`[DEBUG] No progress found to clear for test ${e}_${t}`)},[s,e,t,r]),N=C.useCallback(()=>{w.current&&(N(w.current),w.current=null),S.current&&(N(S.current),S.current=null)},[]),F=C.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${e}, testId: ${t}`),S.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),L()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[e,t]),A=C.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${e}, testId: ${t}`);const B=D(),Y=d>0?Math.round(B/d*100):0;return console.log(`[DEBUG] Progress: ${B}/${d} questions answered`),console.log(`[DEBUG] Progress bar updated: ${Y}%`),{answeredQuestions:B,totalQuestions:d,percentage:Y}},[e,t,d]),R=C.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const B=D();console.log(`[DEBUG] Submit button state check: ${B}/${d} questions answered`);const Y=B===d&&d>0;return console.log(Y?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),Y},[d]),T=C.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${e}, testId: ${t}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const B=Object.keys(r).length;c(B),console.log(`[DEBUG] Restored ${B} answered questions`)}catch(B){console.error("[ERROR] Failed to load saved progress:",B),v(B.message)}},[e,t,r]),D=C.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${e}`);const B=Object.keys(r).length;return c(B),console.log(`[DEBUG] Found ${B} answered questions`),B},[e,r]),L=C.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${e}, testId: ${t}`);try{console.log("[DEBUG] Progress saved:",r)}catch(B){console.error("[ERROR] Failed to save progress:",B),v(B.message)}},[e,t,r]),O=C.useCallback(()=>{try{const B=`test_completed_${e}_${t}`,Y=localStorage.getItem(B)==="true";return i(Y),Y}catch(B){return console.error("Error checking test completion:",B),!1}},[e,t]),G=C.useCallback(()=>{try{const B=`test_completed_${e}_${t}`;localStorage.setItem(B,"true"),i(!0),console.log(`Test ${e}_${t} marked as completed`)}catch(B){console.error("Error marking test completed:",B)}},[e,t]),K=C.useCallback(()=>{console.log("Marking test completed in UI:",{testType:e,testId:t}),G()},[e,t,G]),te=C.useCallback(B=>{try{const Y=`test_creation_state_${e}_${t}`;localStorage.setItem(Y,JSON.stringify(B)),console.log("Test creation state saved:",B)}catch(Y){console.error("Error saving test creation state:",Y)}},[e,t]),Z=C.useCallback(()=>{try{const B=`test_creation_state_${e}_${t}`;localStorage.removeItem(B),console.log("Test creation state cleared")}catch(B){console.error("Error clearing test creation state:",B)}},[e,t]),J=C.useCallback((B,Y)=>{try{const V=`test_step_${e}_${t}_${B}`;localStorage.setItem(V,JSON.stringify(Y)),console.log(`Step ${B} data saved:`,Y)}catch(V){console.error(`Error saving step ${B} data:`,V)}},[e,t]),I=C.useCallback(B=>{try{const Y=`test_step_${e}_${t}_${B}`,V=localStorage.getItem(Y);return V?JSON.parse(V):null}catch(Y){return console.error(`Error restoring step ${B} data:`,Y),null}},[e,t]),W=C.useCallback(()=>{try{const B=`test_creation_state_${e}_${t}`,Y=localStorage.getItem(B);return Y?JSON.parse(Y):null}catch(B){return console.error("Error restoring test creation state:",B),null}},[e,t]);return C.useEffect(()=>()=>{N()},[e,t,F,T,N]),C.useEffect(()=>{D()},[r,D]),{progress:r,isCompleted:a,answeredCount:o,totalQuestions:d,isLoading:p,error:y,saveProgress:E,getProgress:k,clearProgress:_,clearInterval:N,setupProgressTracking:F,updateProgress:A,updateSubmitButton:R,loadProgress:T,getAnsweredCount:D,saveProgressForPage:L,checkCompleted:O,markCompleted:G,markCompletedUI:K,saveState:te,clearState:Z,saveStepData:J,restoreStepData:I,restoreState:W,setTotalQuestions:f,setError:v}},kW=({testData:e,onTestComplete:t,onBackToCabinet:r})=>{const{user:n}=Gn(),{makeAuthenticatedRequest:s}=Ho(),[a,i]=C.useState({width:window.innerWidth,height:window.innerHeight});C.useEffect(()=>{const je=()=>{i({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",je),()=>window.removeEventListener("resize",je)},[]);const{getCheatingData:o,stopTracking:c,clearData:d}=Up(),[f,p]=C.useState(null),[m,y]=C.useState({}),[v,w]=C.useState(null),S=C.useRef(null),[E,k]=C.useState(800),_={VERY_SMALL:400,MOBILE:600,TABLET:900},N={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},F={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:100,MARGIN:50,PADDING:20},A=a.width<_.VERY_SMALL,R=a.width>=_.VERY_SMALL&&a.width<_.MOBILE,T=a.width>=_.MOBILE&&a.width<_.TABLET;a.width>=_.TABLET;const D=A?N.VERY_SMALL:R?N.MOBILE:T?N.TABLET:N.DESKTOP;C.useEffect(()=>{const je=()=>{if(S.current){const Ge=S.current.clientWidth;console.log("🎯 Container width detected:",Ge),Ge>0&&k(Ge)}};je();const De=[setTimeout(je,50),setTimeout(je,100),setTimeout(je,200),setTimeout(je,500)];return window.addEventListener("resize",je),()=>{De.forEach(Ge=>clearTimeout(Ge)),window.removeEventListener("resize",je)}},[f]);const L=Math.max(F.CANVAS_HEIGHT*D,(f?.leftWords?.length||3)*F.BLOCK_SPACING*D+F.PADDING*2),O=F.BLOCK_WIDTH*D,G=F.BLOCK_HEIGHT*D,K=F.BLOCK_SPACING*D,te=F.MARGIN*D,Z=te;console.log("🎯 Mobile Debug:",{screenWidth:a.width,containerWidth:S.current?.clientWidth,canvasWidth:E,scale:D,blockWidth:O,margin:te,leftBlockX:Z,displayDataLoaded:!!f});const J=Z+O+20+O+te,I=J<=E;let W,B=O,Y=G;if(I)W=Math.min(Math.max(Z+O+20,E-O-te),E-O-te);else{const je=E-te*2,De=Math.floor((je-20)/2);B=Math.max(60,De),Y=Math.max(30,Y*(B/O)),W=Z+B+20,console.log("🎯 Very small screen - adjusted block size:",{availableWidth:je,maxBlockWidth:De,actualBlockWidth:B,actualBlockHeight:Y})}console.log("🎯 Right Block Position:",{rightBlockX:W,rightBlockRightEdge:W+B,canvasWidth:E,fits:W+B<=E,canFitSideBySide:I,minRequiredWidth:J});const V=te,H={DRAGGED_WORD:Math.max(8,14*D),ORIGINAL_WORD:Math.max(10,16*D),LEFT_WORD:Math.max(10,14*D)},X=Math.max(1,3*D),[se,ie]=C.useState([]),[ae,Q]=C.useState(!1),[le,_e]=C.useState(null),[ke,Oe]=C.useState(!1),[ge,ye]=C.useState(!1);C.useEffect(()=>{if(e&&(p(e),_e(new Date),n?.student_id)){const je=`test_progress_${n.student_id}_word_matching_${e.id}`,De=Mn(je);De&&(y(De.answers||{}),ie(De.arrows||[]),_e(new Date(De.startTime)),console.log("🎯 Test progress restored:",De))}},[e,n?.student_id]),C.useEffect(()=>{if(f&&le&&n?.student_id){const je=setInterval(()=>{const De={answers:m,arrows:se,startTime:le.toISOString()},Ge=`test_progress_${n.student_id}_word_matching_${e.id}`;kn(Ge,De,Nn.test_progress),console.log("🎯 Progress auto-saved")},3e4);return()=>clearInterval(je)}},[f,m,se,le,n?.student_id,e?.id]);const Ke=C.useCallback((je,De)=>{if(e.interaction_type==="arrow")if(v){if(v.side===je&&v.index===De)w(null);else if(v.side!==je){const Ge={id:Date.now().toString(),startWord:v,endWord:{side:je,index:De},color:"#3B82F6"};ie(ct=>[...ct,Ge]),y(ct=>({...ct,[v.index]:De})),w(null)}}else w({side:je,index:De})},[v,e?.interaction_type]);C.useCallback((je,De)=>{e.interaction_type==="drag"&&y(Ge=>({...Ge,[je]:De}))},[e?.interaction_type]);const Xe=C.useCallback(()=>{Oe(!0)},[]),lt=C.useCallback(()=>{y({}),ie([]),w(null),Oe(!1)},[]),Ye=C.useCallback(()=>{ye(!0)},[]),We=C.useCallback(()=>{ye(!1),r&&r()},[r]),Me=C.useCallback(async()=>{if(f){Q(!0);try{const je=f.leftWords.length;let De=0,Ge={};e.interaction_type==="drag"?Object.entries(m).forEach(([it,ut])=>{const St=f.correctPairs[it];ut===St&&De++,Ge[it]=ut}):se.forEach(it=>{const ut=it.startWord.side==="left"?it.startWord.index:it.endWord.index,St=it.startWord.side==="right"?it.startWord.index:it.endWord.index;f.correctPairs[ut]===St&&De++,Ge[ut]=St});const ct=De,at=je;console.log(`🎯 Final Score: ${ct}/${at} (${Math.round(ct/at*100)}%)`);const wt=new Date,Ft=le?Math.round((wt-le)/1e3):0,Kt=le?le.toISOString():wt.toISOString(),bt=o(),At=n.student_id,gt=`retest_assignment_id_${At}_word_matching_${e.id}`,kt=localStorage.getItem(gt),Gt={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:At,parent_test_id:e.id,retest_assignment_id:kt?Number(kt):null,interaction_type:e.interaction_type,answers:Ge,score:ct,maxScore:at,time_taken:Ft,started_at:Kt,submitted_at:wt.toISOString(),caught_cheating:bt.caught_cheating,visibility_change_times:bt.visibility_change_times};console.log("🎯 Submission data being sent:",Gt),console.log("🎯 TestData structure:",e),console.log("🎯 Submitting test results...");const $t=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Gt)});console.log("🎯 Submission response received:",$t.status);const Be=await $t.json();if(Be.success){if(c(),d(),n?.student_id){const it=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(it,"true"),console.log("✅ Test marked as completed in localStorage:",it);const ut=`retest1_${At}_word_matching_${e.id}`;localStorage.removeItem(ut),localStorage.removeItem(gt),h0(n.student_id,"word_matching",e.id),console.log("🎓 Test data cleared from cache");const St=`student_results_table_${n.student_id}`;kn(St,Be,Nn.student_results_table),console.log("🎓 Test results cached with key:",St)}setTimeout(()=>{t&&t(ct)},2e3)}else throw new Error(Be.message||"Failed to submit test")}catch(je){console.error("Error submitting test:",je)}finally{Q(!1)}}},[f,m,se,e,n,le,o,c,d,s,t]);return f?l.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-4xl mx-auto p-6",children:[l.jsx(Mo,{isOpen:ae,onClose:()=>{},title:"Submitting",size:"small",children:l.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[l.jsx(Sr,{size:"lg",className:"mb-3"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),l.jsx(mt,{className:"mb-6",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:e.test_name}),l.jsx("p",{className:"text-gray-600",children:e.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]})}),e.interaction_type==="drag"?l.jsx(mt,{className:"mb-6",children:l.jsx("div",{ref:S,className:"relative w-full",children:l.jsx(Yd,{width:E,height:L,className:`border-2 border-gray-200 rounded-lg ${ae?"pointer-events-none opacity-50":""}`,children:l.jsxs(Xd,{children:[f.leftWords.map((je,De)=>{const Ge=m[De]!==void 0,ct=V+De*K;return l.jsxs(gc,{x:Z,y:ct,draggable:!Ge,onDragStart:at=>{at.target.moveToTop()},onDragEnd:at=>{at.target.getStage();const wt=f.rightWords,Ft=B+60,Kt=Y+30,bt=W-30,At=V-15;console.log("🎯 Drop detection - Word dropped at:",at.target.x(),at.target.y());for(let gt=0;gt<wt.length;gt++){const kt=At+gt*K,Gt=bt,$t=bt+Ft,Be=kt,it=kt+Kt;if(console.log(`🎯 Checking drop zone ${gt}:`,{left:Gt,right:$t,top:Be,bottom:it,word:wt[gt]}),at.target.x()>=Gt&&at.target.x()<=$t&&at.target.y()>=Be&&at.target.y()<=it){console.log(`✅ Match found! Word "${f.leftWords[De]}" matched with "${wt[gt]}"`),y(ut=>({...ut,[De]:gt}));break}}console.log("❌ No match found, resetting position"),at.target.position({x:Z,y:ct})},children:[l.jsx(ri,{width:B,height:Y,fill:Ge?"#e5e7eb":"#3b82f6",stroke:Ge?"#9ca3af":"#1d4ed8",strokeWidth:2,cornerRadius:8,opacity:Ge?.5:1}),l.jsx(jd,{text:je,x:B/2,y:Y/2,fontSize:H.LEFT_WORD,fontFamily:"Arial",fill:Ge?"#dc2626":"white",align:"center",verticalAlign:"middle",width:B,offsetX:B/2,offsetY:Y/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${De}`)}),f.rightWords.map((je,De)=>{const Ge=V+De*K,ct=Object.keys(m).find(at=>m[at]===De);return l.jsxs(gc,{x:W,y:Ge,children:[l.jsx(ri,{width:B,height:Y,fill:ct?"#10b981":"#f3f4f6",stroke:ct?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8}),l.jsx(jd,{text:je,x:B/2,y:Y/2,fontSize:H.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:B,offsetX:B/2,offsetY:Y/2,wrap:"word",ellipsis:!0,listening:!1}),ct&&l.jsx(jd,{text:f.leftWords[ct],x:O/2,y:G/4,fontSize:H.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:B,offsetX:B/2,offsetY:Y/8,wrap:"word",ellipsis:!0})]},`right-${De}`)})]})})})}):l.jsx(mt,{className:"mb-6",children:l.jsx("div",{ref:S,className:"relative w-full",children:l.jsx(Yd,{width:E,height:L,className:`border-2 border-gray-200 rounded-lg ${ae?"pointer-events-none opacity-50":""}`,children:l.jsxs(Xd,{children:[f.leftWords.map((je,De)=>{const Ge=V+De*K,ct=v?.side==="left"&&v?.index===De;return l.jsxs(gc,{x:Z,y:Ge,onClick:()=>Ke("left",De),children:[l.jsx(ri,{width:B,height:Y,fill:ct?"#3b82f6":"#f3f4f6",stroke:ct?"#1d4ed8":"#d1d5db",strokeWidth:ct?3:2,cornerRadius:8}),l.jsx(jd,{text:je,x:O/2,y:G/2,fontSize:H.LEFT_WORD,fontFamily:"Arial",fill:ct?"white":"#374151",align:"center",verticalAlign:"middle",width:B,offsetX:B/2,offsetY:Y/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${De}`)}),f.rightWords.map((je,De)=>{const Ge=V+De*K,ct=v?.side==="right"&&v?.index===De;return l.jsxs(gc,{x:W,y:Ge,onClick:()=>Ke("right",De),children:[l.jsx(ri,{width:B,height:Y,fill:ct?"#3b82f6":"#f3f4f6",stroke:ct?"#1d4ed8":"#d1d5db",strokeWidth:ct?3:2,cornerRadius:8}),l.jsx(jd,{text:je,x:O/2,y:G/2,fontSize:H.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:B,offsetX:B/2,offsetY:Y/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${De}`)}),se.map((je,De)=>{const Ge=V+je.startWord.index*K+G/2,ct=V+je.endWord.index*K+G/2;return l.jsx(co,{points:[Z+O+20,Ge,W-20,ct],stroke:je.color||"#3b82f6",strokeWidth:X,lineCap:"round",lineJoin:"round"},De)})]})})})}),l.jsx(mt,{children:l.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${ae?"pointer-events-none opacity-50":""}`,children:[l.jsx(tt,{onClick:Xe,variant:"outline",disabled:ae,children:"Reset"}),l.jsx(tt,{onClick:Ye,variant:"outline",disabled:ae,children:"Back to Cabinet"}),l.jsx(tt,{onClick:Me,disabled:ae,className:"px-8",children:ae?l.jsxs(l.Fragment,{children:[l.jsx(Sr,{size:"sm",color:"white",className:"mr-2"}),"Submitting..."]}):"Submit Test"})]})}),l.jsx(Mo,{isOpen:ke&&!ae,onClose:()=>Oe(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(tt,{onClick:()=>Oe(!1),variant:"secondary",children:"Cancel"}),l.jsx(tt,{onClick:lt,variant:"primary",children:"Reset"})]})]})}),l.jsx(Mo,{isOpen:ge&&!ae,onClose:()=>ye(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(tt,{onClick:()=>ye(!1),variant:"secondary",children:"Cancel"}),l.jsx(tt,{onClick:We,variant:"primary",children:"Leave"})]})]})})]}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(Sr,{size:"lg"})})},CW=({width:e,height:t,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:o,onZoomChange:c,isPanning:d,isFullscreen:f,constrainPanPosition:p,handleWheel:m,stageRef:y,setIsPanning:v,responsiveDimensions:w,canvasSize:S,question:E})=>{const[k,_]=C.useState(!1),[N,F]=C.useState([]),[A,R]=C.useState(null),[T,D]=C.useState(null),L=C.useRef(null),[O,G]=C.useState(.25);C.useEffect(()=>{const We=()=>{const Me=L.current;if(!Me)return;const je=Me.clientWidth||1,De=Me.clientHeight||1,Ge=Math.min(je/(S.width||1),De/(S.height||1));G(Math.min(Ge,1))};return We(),window.addEventListener("resize",We),()=>window.removeEventListener("resize",We)},[S.width,S.height,f]);const K=We=>{const Me=y.current,je=Me.getPointerPosition();if(s==="pan")return;_(!0);const De={x:(je.x-Me.x())/Me.scaleX(),y:(je.y-Me.y())/Me.scaleY()};D(De),s==="pencil"?F([{x:De.x,y:De.y,color:a,thickness:i}]):["line","rectangle","circle"].includes(s)&&R({type:s,startX:De.x,startY:De.y,endX:De.x,endY:De.y,color:a,thickness:i})},te=We=>{const Me=y.current,je=Me.getPointerPosition();if(s==="pan"||!k)return;const De={x:(je.x-Me.x())/Me.scaleX(),y:(je.y-Me.y())/Me.scaleY()};if(s==="pencil"){const Ge=[...N,{x:De.x,y:De.y,color:a,thickness:i}];F(Ge)}else["line","rectangle","circle"].includes(s)&&A&&R({...A,endX:De.x,endY:De.y})},Z=()=>{if(s!=="pan"&&k){if(s==="pencil"){const We=[...r,N];n(We),F([])}else if(["line","rectangle","circle"].includes(s)&&A){const We=[...r,A];n(We),R(null)}_(!1),D(null)}},[J,I]=C.useState(null),[W,B]=C.useState(null),[Y,V]=C.useState(!1),[H,X]=C.useState(null),[se,ie]=C.useState(!1),[ae,Q]=C.useState(!1);let le=null;const ke=(window.devicePixelRatio||1)>1.5,Oe={scaleDelta:ke?.06:.08,centerDelta:ke?8:12,minTouchDistance:10},ge=()=>{ie(!1),X(null),I(null),B(null),_(!1),D(null),le&&(cancelAnimationFrame(le),le=null),y.current&&y.current.stop()},ye=We=>{if(We.length<2)return 0;const Me=We[0],je=We[1];return Math.sqrt(Math.pow(je.clientX-Me.clientX,2)+Math.pow(je.clientY-Me.clientY,2))},Ke=We=>{if(We.length<2)return null;const Me=We[0],je=We[1];return{x:(Me.clientX+je.clientX)/2,y:(Me.clientY+je.clientY)/2}},Xe=We=>{We.evt.preventDefault();const Me=We.evt.touches;Me.length===2?(ie(!0),X(null),I(ye(Me)),B(Ke(Me)),_(!1)):Me.length===1&&(ie(!1),X(null),K())},lt=We=>{We.evt.preventDefault();const Me=We.evt.touches;if(Me.length===2&&se){const je=y.current,De=ye(Me),Ge=Ke(Me);if(J&&W&&je&&De>Oe.minTouchDistance){const ct=Math.abs(De/J-1),at=Math.sqrt(Math.pow(Ge.x-W.x,2)+Math.pow(Ge.y-W.y,2)),wt=je.scaleX(),Ft=De/J,Kt=wt*Ft,bt=E?.max_canvas_width||1536,At=E?.max_canvas_height||2048,gt=bt/S.width,kt=At/S.height,Gt=Math.min(gt,kt,1),$t=Math.max(.25,Math.min(Gt,Kt)),Be=Ge.x-W.x,it=Ge.y-W.y,ut=je.position();let St={x:ut.x,y:ut.y};const Mt=.25,Ot=je.scaleX();if(Ot<=Mt){const Fe=w.width,dt=w.height,Wt=S.width*Ot,Et=S.height*Ot;St={x:(Fe-Wt)/2,y:(dt-Et)/2}}else St={x:ut.x+Be,y:ut.y+it};const Te=ct>Oe.scaleDelta,ve=at>Oe.centerDelta;le||(le=requestAnimationFrame(()=>{if(Te){const Fe=Ge,dt={x:(Fe.x-je.x())/wt,y:(Fe.y-je.y())/wt};St={x:Fe.x-dt.x*$t,y:Fe.y-dt.y*$t},je.scale({x:$t,y:$t}),c($t)}ve&&je.position(St),je.batchDraw(),le=null})),Te&&ve?(X("zoom+pan"),Q(!0),v(!0)):Te?(X("zoom"),Q(!0)):ve&&(X("pan"),v(!0)),console.log("🎨 Gesture",{scaleDelta:ct.toFixed(3),centerDelta:at.toFixed(1),doZoom:Te,doPan:ve,clampedScale:$t.toFixed(2),newPos:St})}I(De),B(Ge)}else Me.length===1&&!se&&te()},Ye=We=>{We.evt.preventDefault();const Me=We.evt.touches;Me.length===0?(Z(),ge(),Q(!1),v(!1)):Me.length===1&&(ie(!1),X(null),I(null),B(null),Q(!1),v(!1))};return l.jsx("div",{className:"relative w-full flex justify-center",children:l.jsx("div",{className:"w-full max-w-full flex justify-center",children:l.jsxs("div",{className:"relative",style:{border:f&&(w.width<window.innerWidth-40||w.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[l.jsx("div",{ref:L,className:"w-full h-full",children:l.jsx(Yd,{ref:y,width:w.width,height:w.height,scaleX:f?w.zoom:o,scaleY:f?w.zoom:o,onMouseDown:K,onMousemove:te,onMouseup:Z,onTouchStart:Xe,onTouchMove:lt,onTouchEnd:Ye,onWheel:m||(()=>{}),onDragStart:()=>{console.log("🎯 Drag started"),s==="pan"&&v(!0)},onDragEnd:()=>{if(console.log("🎯 Drag ended"),s==="pan"&&(v(!1),p)){const We=y.current,Me=L.current,je=Me?.clientWidth||w.width,De=Me?.clientHeight||w.height,Ge=S.width*We.scaleX(),ct=S.height*We.scaleY(),at=We.x(),wt=We.y();(at>je||at<-Ge||wt>De||wt<-ct)&&p(We)}},draggable:s==="pan"&&o>.25,className:`border border-gray-300 rounded-lg shadow-sm ${s==="pan"?"cursor-grab":d?"cursor-grabbing":"cursor-crosshair"}`,style:{maxWidth:"100%",height:"auto"},onLoad:()=>{console.log("�� DrawingTestStudent - Stage loaded with dimensions:",w.width,"x",w.height),console.log("�� DrawingTestStudent - Canvas size:",S.width,"x",S.height),console.log("�� DrawingTestStudent - Current zoom level:",o),console.log("�� DrawingTestStudent - Effective display size:",Math.round(S.width*o),"x",Math.round(S.height*o)),console.log("�� DrawingTestStudent - Total pixels displayed:",Math.round(S.width*o*S.height*o))},children:l.jsxs(Xd,{children:[l.jsx(ri,{x:0,y:0,width:S.width,height:S.height,fill:"white"}),r.map((We,Me)=>{if(Array.isArray(We))return l.jsx(co,{points:We.flatMap(je=>[je.x,je.y]),stroke:We[0]?.color||"#000000",strokeWidth:We[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},Me);if(We.type==="line")return l.jsx(co,{points:[We.startX,We.startY,We.endX,We.endY],stroke:We.color,strokeWidth:We.thickness,lineCap:"round"},Me);if(We.type==="rectangle"){const je=Math.abs(We.endX-We.startX),De=Math.abs(We.endY-We.startY),Ge=Math.min(We.startX,We.endX),ct=Math.min(We.startY,We.endY);return l.jsx(ri,{x:Ge,y:ct,width:je,height:De,stroke:We.color,strokeWidth:We.thickness,fill:"transparent"},Me)}else if(We.type==="circle"){const je=Math.sqrt(Math.pow(We.endX-We.startX,2)+Math.pow(We.endY-We.startY,2))/2,De=(We.startX+We.endX)/2,Ge=(We.startY+We.endY)/2;return l.jsx(r0,{x:De,y:Ge,radius:je,stroke:We.color,strokeWidth:We.thickness,fill:"transparent"},Me)}return null}),s==="pencil"&&l.jsx(co,{points:N.flatMap(We=>[We.x,We.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),A&&A.type==="line"&&l.jsx(co,{points:[A.startX,A.startY,A.endX,A.endY],stroke:A.color,strokeWidth:A.thickness,lineCap:"round"}),A&&A.type==="rectangle"&&l.jsx(ri,{x:Math.min(A.startX,A.endX),y:Math.min(A.startY,A.endY),width:Math.abs(A.endX-A.startX),height:Math.abs(A.endY-A.startY),stroke:A.color,strokeWidth:A.thickness,fill:"transparent"}),A&&A.type==="circle"&&l.jsx(r0,{x:(A.startX+A.endX)/2,y:(A.startY+A.endY)/2,radius:Math.sqrt(Math.pow(A.endX-A.startX,2)+Math.pow(A.endY-A.startY,2))/2,stroke:A.color,strokeWidth:A.thickness,fill:"transparent"})]})})}),l.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[l.jsx("button",{onClick:()=>{const We=y.current,Me=We.scaleX(),je=E?.max_canvas_width||1536,De=E?.max_canvas_height||2048,Ge=je/S.width,ct=De/S.height,at=Math.min(Ge,ct,5),wt=Math.min(at,We.scaleX()*1.2);We.scale({x:wt,y:wt}),We.batchDraw(),console.log("�� DrawingTestStudent - Zoom In button:",Me.toFixed(2),"->",wt.toFixed(2)),console.log("�� DrawingTestStudent - New effective size:",Math.round(S.width*wt),"x",Math.round(S.height*wt)),console.log("�� DrawingTestStudent - New resolution:",Math.round(S.width*wt*S.height*wt),"pixels"),c(wt)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),l.jsx("button",{onClick:()=>{const We=y.current,Me=We.scaleX(),je=Math.max(.25,We.scaleX()*.8);We.scale({x:je,y:je}),We.batchDraw(),console.log("�� DrawingTestStudent - Zoom Out button:",Me.toFixed(2),"->",je.toFixed(2)),console.log("�� DrawingTestStudent - New effective size:",Math.round(S.width*je),"x",Math.round(S.height*je)),console.log("�� DrawingTestStudent - New resolution:",Math.round(S.width*je*S.height*je),"pixels"),c(je)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:"−"}),l.jsx("button",{onClick:()=>{const We=y.current,Me=We.scaleX();We.scale({x:1,y:1}),We.position({x:0,y:0}),We.batchDraw(),console.log("�� DrawingTestStudent - Reset zoom:",Me.toFixed(2),"-> 1.00"),console.log("�� DrawingTestStudent - Reset effective size:",S.width,"x",S.height),console.log("�� DrawingTestStudent - Reset resolution:",S.width*S.height,"pixels"),c(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),l.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(o*100),"%"]})]})})})},TW=({content:e})=>{if(!e)return l.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const t=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(t).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(t).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const o=i.children?i.children.map(t).join(""):"";let c="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?c+=" text-align: center;":i.format==="right"?c+=" text-align: right;":i.format==="left"&&(c+=" text-align: left;")),`<li style="${c}">${o}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(t).join(""):""};let r=e;if(typeof e=="string"&&e.startsWith("{"))try{const n=JSON.parse(e);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(t).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return l.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},EW=({question:e,questionIndex:t,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{Oa();const[o,c]=C.useState([]),[d,f]=C.useState(!0),[p,m]=C.useState("pencil"),[y,v]=C.useState("#000000"),[w,S]=C.useState(2),[E,k]=C.useState({width:600,height:800}),[_,N]=C.useState(1),[F,A]=C.useState(!1),[R,T]=C.useState(!1),[D,L]=C.useState(!1),[O,G]=C.useState(!1),K=C.useRef(null),te=C.useRef(null),[Z,J]=C.useState({width:600,height:800}),I=C.useRef(!1),[W,B]=C.useState(.25),Y=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];C.useEffect(()=>{const Q=()=>{L(window.innerWidth>=1024)};return Q(),window.addEventListener("resize",Q),()=>window.removeEventListener("resize",Q)},[]),C.useEffect(()=>{if(e){const Q=e.max_canvas_width||1536,le=e.max_canvas_height||2048,_e=e.canvas_width||600,ke=e.canvas_height||800;if(k({width:Q,height:le}),I.current)console.log("🎨 DrawingTestStudent - Preserving user zoom:",_.toFixed(2));else{N(1),I.current=!0;const ge=(_e-Q*1)/2,ye=(ke-le*1)/2;if(!isNaN(ge)&&!isNaN(ye)&&K.current){const Ke={x:ge,y:ye};K.current.position(Ke),K.current.batchDraw()}console.log("🎨 DrawingTestStudent - Canvas size set:",Q,"x",le),console.log("🎨 DrawingTestStudent - Viewport size:",_e,"x",ke),console.log("🎨 DrawingTestStudent - Initial zoom:",1 .toFixed(2)),console.log("🎨 DrawingTestStudent - Image resolution:",Q*le,"pixels"),console.log("🎨 DrawingTestStudent - Aspect ratio:",(Q/le).toFixed(2))}if(r&&typeof r=="string")try{const Oe=JSON.parse(r);c(Oe)}catch{console.log("No valid drawing data found")}f(!1)}},[e,r]),C.useEffect(()=>{const Q=()=>{const le=te.current;if(!le)return;const _e=le.clientWidth||1,ke=le.clientHeight||1,Oe=Math.min(_e/(E.width||1),ke/(E.height||1));B(Math.min(Oe,1))};return Q(),window.addEventListener("resize",Q),()=>window.removeEventListener("resize",Q)},[E.width,E.height,O]);const V=Q=>{c(Q),n(e.question_id,JSON.stringify(Q))},H=()=>{c([]),n(e.question_id,"")},X=()=>{if(O){const _e=e?.canvas_width||600,ke=e?.canvas_height||800,Oe=window.innerWidth-40,ge=window.innerHeight-40,ye=Oe/_e,Ke=ge/ke,Xe=Math.min(ye,Ke,1);return{width:_e,height:ke,zoom:Xe}}const Q=e?.canvas_width||600,le=e?.canvas_height||800;return{width:Q,height:le,zoom:1}};C.useEffect(()=>{const Q=()=>{J(X())};return Q(),window.addEventListener("resize",Q),()=>window.removeEventListener("resize",Q)},[O,E]);const se=Q=>{Q.evt.preventDefault();const le=K.current,_e=le.scaleX(),ke=le.getPointerPosition(),Oe={x:(ke.x-le.x())/_e,y:(ke.y-le.y())/_e},ge=Q.evt.deltaY>0?_e*.9:_e*1.1,ye=e?.max_canvas_width||1536,Ke=e?.max_canvas_height||2048,Xe=ye/E.width,lt=Ke/E.height,Ye=Math.min(Xe,lt,1),We=Math.max(W,Math.min(Ye,ge)),Me={x:ke.x-Oe.x*We,y:ke.y-Oe.y*We};if(We<=W&&te.current){const je=te.current.clientWidth||1,De=te.current.clientHeight||1;Me.x=(je-E.width*We)/2,Me.y=(De-E.height*We)/2}le.scale({x:We,y:We}),le.position(Me),le.batchDraw(),console.log("🎨 DrawingTestStudent - Wheel zoom:",_e.toFixed(2),"->",We.toFixed(2)),console.log("🎨 DrawingTestStudent - New effective size:",Math.round(E.width*We),"x",Math.round(E.height*We)),console.log("🎨 DrawingTestStudent - New resolution:",Math.round(E.width*We*E.height*We),"pixels"),N(We),I.current=!0},ie=Q=>{const le=Q.scaleX(),_e=te.current,ke=_e?.clientWidth||Z.width,Oe=_e?.clientHeight||Z.height,ge=E.width*le,ye=E.height*le;if(le<=W){const Ge=(ke-ge)/2,ct=(Oe-ye)/2;Q.position({x:Ge,y:ct}),Q.batchDraw();return}if(ge<=ke&&ye<=Oe){const Ge=(ke-ge)/2,ct=(Oe-ye)/2;Q.position({x:Ge,y:ct}),Q.batchDraw();return}const Ke=Math.max(0,ge-ke),Xe=Math.max(0,ye-Oe),lt=-Ke,Ye=-Xe,We=Q.x(),Me=Q.y(),je=Math.max(lt,Math.min(Ke,We)),De=Math.max(Ye,Math.min(Xe,Me));(je!==We||De!==Me)&&(Q.position({x:je,y:De}),Q.batchDraw())},ae=()=>{if(O)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const Q=document.querySelector(".drawing-canvas-container");Q&&(Q.requestFullscreen?Q.requestFullscreen():Q.webkitRequestFullscreen?Q.webkitRequestFullscreen():Q.msRequestFullscreen&&Q.msRequestFullscreen())}};return C.useEffect(()=>{const Q=()=>{G(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",Q),document.addEventListener("webkitfullscreenchange",Q),document.addEventListener("msfullscreenchange",Q),()=>{document.removeEventListener("fullscreenchange",Q),document.removeEventListener("webkitfullscreenchange",Q),document.removeEventListener("msfullscreenchange",Q)}},[]),C.useEffect(()=>()=>{K.current&&K.current.stop()},[]),d?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx(Sr,{})}):e?l.jsxs("div",{className:`drawing-question max-w-6xl mx-auto p-1 sm:p-2 ${O?"fixed inset-0 z-50 bg-white overflow-y-auto":""}`,children:[!O&&l.jsx("div",{className:"mb-4",children:l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",t+1]})}),!O&&e.question_json&&e.question_json.trim()&&l.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[l.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),l.jsx("div",{className:"text-gray-700",children:l.jsx(TW,{content:e.question_json})})]}),!O&&l.jsx(mt,{className:"p-1 sm:p-2 mb-2",children:l.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"Tool:"}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:()=>m("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:"✏️"}),l.jsx("button",{onClick:()=>m("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:"📏"}),l.jsx("button",{onClick:()=>m("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:"⬜"}),l.jsx("button",{onClick:()=>m("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:"⭕"}),D&&l.jsx("button",{onClick:()=>m("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:"✋"})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>A(!F),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[l.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:y}}),l.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),F&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:l.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:Y.map(Q=>l.jsx("button",{onClick:()=>{v(Q),A(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${y===Q?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:Q},title:Q},Q))})})]}),l.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[l.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),l.jsx("input",{type:"range",min:"1",max:"10",value:w,onChange:Q=>S(parseInt(Q.target.value)),className:"w-16 sm:w-20"}),l.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[w,"px"]})]}),l.jsx(tt,{onClick:H,variant:"secondary",size:"sm",children:"Clear"})]})}),l.jsx(mt,{className:"p-1 sm:p-2",children:l.jsxs("div",{className:"w-full drawing-canvas-container relative",children:[l.jsx(CW,{width:E.width,height:E.height,lines:o,onDrawingChange:V,currentTool:p,currentColor:y,currentThickness:w,zoom:_,onZoomChange:N,isPanning:R,isFullscreen:O,constrainPanPosition:ie,handleWheel:se,stageRef:K,setIsPanning:T,responsiveDimensions:Z,canvasSize:E,question:e}),l.jsx("button",{onClick:ae,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:O?"Exit Fullscreen":"Enter Fullscreen",children:O?l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},Dw={enhanceUserData(e,t){const r={id:e.id||e.student_id||e.teacher_id,username:e.username||e.student_id,name:e.name||e.first_name,surname:e.surname||e.last_name,nickname:e.nickname,role:t,is_active:e.is_active!==void 0?e.is_active:!0,created_at:e.created_at,updated_at:e.updated_at};switch(t){case"student":return{...r,student_id:e.student_id,grade:e.grade,class:e.class,number:e.number,subjects:e.subjects||[]};case"teacher":return{...r,teacher_id:e.teacher_id,first_name:e.first_name,last_name:e.last_name,email:e.email,phone:e.phone,subjects:e.subjects||[]};case"admin":return{...r,admin_id:e.admin_id,permissions:e.permissions||["all"]};default:return r}},async studentLogin(e){console.log("Trying student login...");try{const t=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:e.username,password:e.password})}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:t};throw new Error(r.message||"Student login failed")}catch(t){throw console.error("Student login error:",t),new Error(t.message||"Student login failed")}},async teacherLogin(e){console.log("Trying teacher login...");try{const t=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:t};throw new Error(r.message||"Teacher login failed")}catch(t){throw console.error("Teacher login error:",t),new Error(t.message||"Teacher login failed")}},async adminLogin(e){console.log("Trying admin login...");try{const t=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:t};throw new Error(r.message||"Admin login failed")}catch(t){throw console.error("Admin login error:",t),new Error(t.message||"Admin login failed")}},async login(e){const{username:t,password:r}=e;console.log("Attempting login with:",t,r);try{if(t==="admin"){const o=await this.adminLogin(e),c=await o.json();return await this.handleLoginResponse(o,"admin",c)}const n=await this.teacherLogin(e),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(e),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(e,t,r){if(e.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,t),{success:!0,data:r,role:t}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(e,t){console.log(`Handling post-login actions for role: ${t}`);try{switch(t){case"student":e.student&&(this.populateStudentInfo(e.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":e.teacher&&(this.populateTeacherInfo(e.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":e.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${t}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const e=document.getElementById("unifiedLoginForm");if(e){e.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=e.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),e.classList.remove("test-submitting","disabled"),e.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log("🚪 Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log("✅ Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(e){return console.error("Logout error:",e),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log("✅ Interface reset to login state")}catch(e){console.error("Error resetting interface:",e),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(e){try{return{success:!0,message:(await Yn.post("/auth/change-password",{currentPassword:e.currentPassword,newPassword:e.newPassword,confirmPassword:e.confirmPassword})).data.message}}catch(t){throw new Error(t.response?.data?.message||"Password change failed")}},async verifyToken(e){try{const t=await Yn.get("/auth/verify",{headers:{Authorization:`Bearer ${e}`}});return{success:!0,valid:t.data.valid,user:t.data.user}}catch(t){return{success:!1,valid:!1,error:t.message}}},async refreshToken(e){try{const t=await Yn.post("/auth/refresh",{refreshToken:e});return{success:!0,token:t.data.token,refreshToken:t.data.refreshToken}}catch(t){throw new Error(t.response?.data?.message||"Token refresh failed")}},async getUserProfile(){try{return{success:!0,user:(await Yn.get("/auth/profile")).data.user}}catch(e){throw new Error(e.response?.data?.message||"Failed to get user profile")}},async updateUserProfile(e){try{return{success:!0,user:(await Yn.put("/auth/profile",e)).data.user}}catch(t){throw new Error(t.response?.data?.message||"Failed to update user profile")}},populateStudentInfo(e){console.log("=== populateStudentInfo called ==="),console.log("Student object:",e);const t=document.getElementById("studentName");if(t){const s=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=e?.grade||"",console.log("Set student grade to:",e?.grade));const n=document.getElementById("studentClass");n&&(n.textContent=e?.class||"",console.log("Set student class to:",e?.class)),console.log("Student info populated successfully")},populateTeacherInfo(e){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",e);const t=document.getElementById("teacherName");if(t){const n=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=e?.username||"",console.log("Set teacher username to:",e?.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.sub?e.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${e.sub}`),e.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${e.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher ID from JWT:",e),null}},getCurrentAdmin(){const e=window.tokenManager?.getToken();if(!e)return null;const t=window.tokenManager.decodeToken(e);if(!t||t.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:t.sub,username:t.username,role:t.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.username?(console.log(`[DEBUG] Found teacher username from JWT: ${e.username}`),e.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher username from JWT:",e),null}},isAdmin(){try{const e=window.tokenManager?.getToken();if(!e)return!1;const t=window.tokenManager.decodeToken(e);return t&&t.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const e=this.getCurrentAdmin();return e?e.id:null}catch(e){return console.error("[ERROR] Error getting admin ID:",e),null}}},NW=()=>{const e=Bi(),{login:t,setUserData:r,isAuthenticated:n,user:s}=Gn(),[a,i]=C.useState({username:"",password:""}),[o,c]=C.useState(!1),[d,f]=C.useState(""),[p,m]=C.useState([]),[y,v]=C.useState(!1);C.useEffect(()=>{w()},[]);const w=C.useCallback(()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager&&window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const O=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());O&&O.role?console.log("User role from JWT:",O.role):console.log("No valid role found in JWT, showing login")}catch(O){console.error("Error decoding JWT token:",O)}}else console.log("No valid JWT session found, showing login")},[]),S=C.useCallback(async O=>{if(O.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log("⚠️ Login blocked - force logout in progress"),T("Please wait for the logout process to complete.","warning");return}const{username:G,password:K}=a;if(!G||!K){f("Please enter both username and password");return}c(!0),f("");try{let te,Z;G==="admin"?(te=await Dw.adminLogin({username:G,password:K}),Z=ei.ADMIN):/^\d+$/.test(G)?(te=await Dw.studentLogin({username:G,password:K}),Z=ei.STUDENT):(te=await Dw.teacherLogin({username:G,password:K}),Z=ei.TEACHER);let J,I;if(te.response?(J=te,I=te.response):(J=await te.json(),I=te),await E(I,Z,J)){T("Login successful!","success");try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(te){console.error("Login error:",te),A(te)}finally{c(!1)}},[a]),E=C.useCallback(async(O,G,K)=>{if(O.ok&&K.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),A(),!1;try{K.token&&(window.tokenManager.setTokens(K.token,G),K.refreshToken&&window.tokenManager.setRefreshToken(K.refreshToken),console.log("JWT token stored successfully"));const te={...K.data,...K,role:G};return r(te),await k(te),!0}catch(te){return console.error("Error handling login response:",te),A(te),!1}}else return console.error("Login failed:",K.error||"Unknown error"),f(K.error||"Login failed. Please check your credentials."),!1},[t]),k=C.useCallback(async O=>{if(console.log("Handling post-login actions for role:",O.role),y){console.log("⚠️ Post-login already handled, skipping");return}v(!0);try{switch(O.role){case ei.STUDENT:await _(O),e("/student");break;case ei.TEACHER:await N(O),e("/teacher");break;case ei.ADMIN:await F(O),e("/admin");break;default:console.error("Unknown user role:",O.role),A()}}catch(G){console.error("Error in post-login actions:",G),A(G)}},[e,y]);C.useEffect(()=>{n||v(!1)},[n]);const _=C.useCallback(async O=>{console.log("Populating student info:",O)},[]),N=C.useCallback(async O=>{console.log("Populating teacher info:",O)},[]),F=C.useCallback(async O=>{console.log("Populating admin info:",O)},[]),A=C.useCallback((O=null)=>{console.error("Login failure:",O),f("Login failed. Please check your credentials and try again."),R()},[]),R=C.useCallback(()=>{i({username:"",password:""}),f(""),c(!1)},[]),T=C.useCallback((O,G)=>{const K={id:Date.now(),message:O,type:G,timestamp:new Date};m(te=>[...te,K]),setTimeout(()=>{m(te=>te.filter(Z=>Z.id!==K.id))},xi.NOTIFICATION_DURATION)},[]),D=C.useCallback(O=>{const{name:G,value:K}=O.target;i(te=>({...te,[G]:K})),d&&f("")},[d]),L=C.useCallback(O=>{O.key==="Enter"&&!o&&S(O)},[S,o]);return l.jsxs(Qe.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsxs(Qe.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsxs(Qe.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx(Qe.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:l.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-16 w-16 object-contain"})}),l.jsx(Qe.h1,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"Mathayom Watsing School"}),l.jsx(Qe.p,{className:"text-lg text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:"Test Management System"})]}),l.jsxs(Qe.div,{className:"bg-white rounded-xl shadow-2xl p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[l.jsx(Qe.h2,{className:"text-2xl font-semibold text-gray-900 text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"Login"}),l.jsxs("form",{onSubmit:S,className:"space-y-6",children:[l.jsxs(Qe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[l.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Student ID"}),l.jsx(Qe.input,{type:"text",id:"username",name:"username",value:a.username,onChange:D,onKeyDown:L,placeholder:"Enter student ID",required:!0,autoComplete:"username",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":d?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),l.jsxs(Qe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsx(Qe.input,{type:"password",id:"password",name:"password",value:a.password,onChange:D,onKeyDown:L,placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":d?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),l.jsx(yi,{children:d&&l.jsx(Qe.div,{id:"error-message",className:"bg-red-50 border border-red-200 rounded-lg p-3",role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:l.jsx("p",{className:"text-sm text-red-600",children:d})})}),l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:l.jsx(tt,{type:"submit",variant:"primary",size:"lg",disabled:o,className:"w-full",children:o?l.jsxs(l.Fragment,{children:[l.jsx(Sr,{size:"sm",className:"mr-2"}),"Logging in..."]}):"Login"})})]})]}),xi.DEBUG_MODE]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:l.jsx(yi,{children:p.map(O=>l.jsx(Qe.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:l.jsx(Wo,{type:O.type,message:O.message,onClose:()=>m(G=>G.filter(K=>K.id!==O.id))})},O.id))})})]})},mn={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(t.success)return console.log("Student data loaded successfully:",t.subjects),t.subjects;throw new Error(t.error||"Failed to load student data")}catch(e){throw console.error("Error loading student data:",e),e}},getStudentSubjects(e){return console.log("getStudentSubjects called with subjects:",e),e.map(t=>({id:t.id||t.subject_id,name:t.subject,grade:t.grade,class:t.class,testResults:t.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const e=await this.getCurrentTeacherId();if(!e)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:e,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(e){throw console.error("Error loading teacher data:",e),e}},getTeacherSubjects(e){return console.log("getTeacherSubjects called with subjects:",e),e.map(t=>{let r=[];return t.classes&&Array.isArray(t.classes)&&(r=t.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:t.subject_id,name:t.subject,classes:r,assignments:t.assignments||[],description:t.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(t=>({id:t,name:t,classes:this.generateClassButtons(t)}))},generateClassButtons(e){const t=[];for(let r=1;r<=10;r++)t.push({id:`${e}_${r}`,name:`${e}/${r}`,grade:e,class:r});return t},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[t,r,n,s]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAcademicYear(),this.getAllUsers()]);return{teachers:t.status==="fulfilled"?t.value:[],subjects:r.status==="fulfilled"?r.value:[],academicYear:n.status==="fulfilled"?n.value:[],users:s.status==="fulfilled"?s.value:[],loadedAt:new Date().toISOString()}}catch(e){throw console.error("Error loading admin data:",e),e}},async saveTeacherSubjects(e){console.log("saveTeacherSubjects called with subjects:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:e})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(t){throw console.error("Error saving teacher subjects:",t),t}},async deleteTeacherSubject(e){console.log("deleteTeacherSubject called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/delete-teacher-subject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher subject assignment deleted successfully"),r;throw new Error(r.error||"Failed to delete teacher subject assignment")}catch(t){throw console.error("Error deleting teacher subject assignment:",t),t}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("Subjects dropdown data loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(t.error||"Failed to load subjects dropdown")}catch(e){throw console.error("Error loading subjects dropdown:",e),e}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(t.success)return console.log("Grades and classes loaded successfully"),t.data;throw new Error(t.message||"Failed to load grades and classes")}catch(e){throw console.error("Error loading grades and classes:",e),e}},async saveSubjectClasses(e,t){console.log("saveSubjectClasses called with subjectId:",e,"classes:",t);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:e,classes:t})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("All subjects loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all subjects")}catch(e){throw console.error("Error loading all subjects:",e),e}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(t.success)return console.log("Subjects for selection loaded successfully"),t.subjects;throw new Error(t.message||"Failed to load subjects for selection")}catch(e){throw console.error("Error loading subjects for selection:",e),e}},async getAcademicYear(){console.log("getAcademicYear called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-academic-year")).json();if(t.success)return console.log("Academic year loaded successfully"),t.academic_years.map(r=>({id:r.id,year:r.academic_year,semester:r.semester,term:r.term,start_date:r.start_date,end_date:r.end_date,is_current:r.is_current}));throw new Error(t.error||"Failed to load academic year")}catch(e){throw console.error("Error loading academic year:",e),e}},async addAcademicYear(e){console.log("addAcademicYear called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(t){throw console.error("Error adding academic year:",t),t}},async getAllUsers(){console.log("getAllUsers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(t.success)return console.log("All users loaded successfully"),t.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all users")}catch(e){throw console.error("Error loading all users:",e),e}},async getAllTeachers(){console.log("getAllTeachers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(t.success)return console.log("All teachers loaded successfully"),t.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all teachers")}catch(e){throw console.error("Error loading all teachers:",e),e}},async createUser(e){console.log("createUser called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(t){throw console.error("Error creating user:",t),t}},async updateUser(e,t){console.log("updateUser called with userId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(e){console.log("createTeacher called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(t){throw console.error("Error creating teacher:",t),t}},async updateTeacher(e,t){console.log("updateTeacher called with teacherId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(e){console.log("updateStudentInfo called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(t){throw console.error("Error updating student info:",t),t}},async changePassword(e){console.log("changePassword called");let t;if(e.studentId)t="/.netlify/functions/change-student-password";else if(e.username)t="/.netlify/functions/change-teacher-password";else throw new Error("Invalid password data: missing studentId or username");try{const n=await(await window.tokenManager.makeAuthenticatedRequest(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Password changed successfully"),n;throw new Error(n.error||"Failed to change password")}catch(r){throw console.error("Error changing password:",r),r}},async getCurrentTeacherId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.teacher_id||t.sub||null}catch(e){return console.error("Error getting current teacher ID:",e),null}},async getCurrentAdminId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.admin_id||t.sub||null}catch(e){return console.error("Error getting current admin ID:",e),null}}},N8=C.createContext(),A8=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState([]),[a,i]=C.useState([]),[o,c]=C.useState([]),[d,f]=C.useState([]),[p,m]=C.useState([]),[y,v]=C.useState([]),[w,S]=C.useState([]),[E,k]=C.useState(!1),[_,N]=C.useState(null),[F,A]=C.useState(!1),[R,T]=C.useState(!1),[D,L]=C.useState(!1),[O,G]=C.useState(null),[K,te]=C.useState(null),[Z,J]=C.useState(null),I=C.useCallback(async()=>{try{k(!0),N(null);const Ne=`student_subjects_${t?.student_id||t?.id||""}`;console.log("🎓 UserContext: Checking cache for key:",Ne);const Fe=Mn(Ne);if(Fe){console.log("🎓 UserContext: Cache HIT! Using cached student data"),s(Fe),W(Fe);return}console.log("🎓 UserContext: Cache MISS! Fetching from API");const dt=await mn.getStudentData();if(dt)s(dt),W(dt),console.log("🎓 UserContext: Caching student data with key:",Ne),kn(Ne,dt,Nn.student_subjects);else throw new Error("No subjects data received")}catch(ve){N(ve.message||"Failed to load student data"),console.error("Error loading student data:",ve)}finally{k(!1)}},[t?.student_id,t?.id]),W=ve=>{console.log("Displaying student subjects:",ve),s(ve)},B=C.useCallback(async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),N("No valid teacher session found");return}const Ne=`teacher_subjects_${t?.teacher_id||t?.id||""}`,Fe=Mn(Ne);if(Fe){s(Fe),Fe.length===0?it():Y(Fe);return}const dt=await mn.getTeacherSubjects();if(dt.success)s(dt.subjects),kn(Ne,dt.subjects,Nn.teacher_subjects),dt.subjects.length===0?it():Y(dt.subjects);else throw new Error(dt.message||"Failed to load teacher data")}catch(ve){N(ve.message||"Failed to load teacher data"),console.error("Error loading teacher data:",ve)}finally{k(!1)}},[t?.teacher_id,t?.id]),Y=ve=>{console.log("Showing main cabinet with subjects:",ve),s(ve)},V=ve=>{console.log("Displaying grade buttons:",ve),c(ve)},H=async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),N("No valid admin session found");return}await Promise.all([ye(),De(),bt(),ae()])}catch(ve){N(ve.message||"Failed to load admin data"),console.error("Error loading admin data:",ve)}finally{k(!1)}},X=ve=>{console.log("🎓 populateStudentInfoDirectly called with:",ve);try{r(ve),console.log("🎓 Set student profile:",ve)}catch(Ne){console.error("Error populating student info:",Ne)}},se=ve=>{console.log("=== populateStudentInfo called ==="),r(ve)},ie=ve=>{console.log("=== populateTeacherInfo called ==="),r(ve)},ae=C.useCallback(async()=>{try{k(!0);const ve="admin_users_",Ne=Mn(ve);if(Ne){f(Ne),Q(Ne);return}const Fe=await mn.getAllUsers();if(Fe.success)f(Fe.users),Q(Fe.users),kn(ve,Fe.users,Nn.admin_users);else throw new Error(Fe.message||"Failed to load users")}catch(ve){N(ve.message||"Failed to load users"),console.error("Error loading users:",ve)}finally{k(!1)}},[]),Q=ve=>{console.log("Displaying all users:",ve),f(ve)},le=(ve,Ne)=>{console.log("Displaying users table:",ve,Ne),f(ve)},_e=()=>{console.log("Toggling users content")},ke=()=>{console.log("Showing add user form"),A(!0)},Oe=()=>{console.log("Hiding add user form"),A(!1)},ge=ve=>{console.log("Editing user row:",ve);const Ne=d.find(Fe=>Fe.id===ve);G(Ne)},ye=C.useCallback(async()=>{try{const ve="admin_teachers_",Ne=Mn(ve);if(Ne){m(Ne),Ke(Ne);return}const Fe=await mn.getAllTeachers();if(Fe.success)m(Fe.teachers),Ke(Fe.teachers),kn(ve,Fe.teachers,Nn.admin_teachers);else throw new Error(Fe.message||"Failed to load teachers")}catch(ve){N(ve.message||"Failed to load teachers"),console.error("Error loading teachers:",ve)}},[]),Ke=ve=>{console.log("Displaying all teachers:",ve),m(ve)},Xe=(ve,Ne)=>{console.log("Displaying teachers table:",ve,Ne),m(ve)},lt=()=>{console.log("Toggling teachers content")},Ye=()=>{console.log("Showing add teacher form"),T(!0)},We=()=>{console.log("Hiding add teacher form"),T(!1)},Me=ve=>{console.log("Editing teacher:",ve);const Ne=p.find(Fe=>Fe.id===ve);te(Ne)},je=ve=>{console.log("Editing teacher row:",ve);const Ne=p.find(Fe=>Fe.id===ve);te(Ne)},De=C.useCallback(async()=>{try{const ve="admin_subjects_",Ne=Mn(ve);if(Ne){v(Ne),Ge(Ne);return}const Fe=await mn.getAllSubjects();if(Fe.success)v(Fe.subjects),Ge(Fe.subjects),kn(ve,Fe.subjects,Nn.admin_subjects);else throw new Error(Fe.message||"Failed to load subjects")}catch(ve){N(ve.message||"Failed to load subjects"),console.error("Error loading subjects:",ve)}},[]),Ge=ve=>{console.log("Displaying all subjects:",ve),v(ve)},ct=(ve,Ne)=>{console.log("Displaying subjects table:",ve,Ne),v(ve)},at=()=>{console.log("Toggling subjects content")},wt=()=>{console.log("Showing add subject form"),L(!0)},Ft=()=>{console.log("Hiding add subject form"),L(!1)},Kt=ve=>{console.log("Editing subject row:",ve);const Ne=y.find(Fe=>Fe.id===ve);J(Ne)},bt=C.useCallback(async()=>{try{const ve="admin_academic_years_",Ne=Mn(ve);if(Ne){S(Ne),At(Ne);return}const Fe=await mn.getAcademicYear();if(Fe.success)S(Fe.academicYears),At(Fe.academicYears),kn(ve,Fe.academicYears,Nn.admin_academic_years);else throw new Error(Fe.message||"Failed to load academic year")}catch(ve){N(ve.message||"Failed to load academic year"),console.error("Error loading academic year:",ve)}},[]),At=ve=>{console.log("Displaying academic year:",ve),S(ve)},gt=()=>{console.log("Showing add academic year form")},kt=()=>{console.log("Hiding add academic year form")},Gt=ve=>{console.log("Handling add academic year:",ve)},$t=()=>{console.log("Toggling academic year content")},Be=()=>{console.log("Showing academic year editor")},it=()=>{console.log("Showing subject selection")},ut=()=>{console.log("Showing main cabinet")},St=ve=>{r(Ne=>({...Ne,...ve}))},Mt=()=>{r(null),s([]),i([]),c([]),f([]),m([]),v([]),S([]),N(null)},Ot=C.useCallback(ve=>{Mt(),ve&&y2(ve)},[]),Te={userProfile:t,userSubjects:n,userClasses:a,userGrades:o,allUsers:d,allTeachers:p,allSubjects:y,academicYears:w,isLoading:E,error:_,showUserForm:F,showTeacherForm:R,showSubjectForm:D,editingUser:O,editingTeacher:K,editingSubject:Z,loadStudentData:I,displayStudentSubjects:W,populateStudentInfoDirectly:X,populateStudentInfo:se,loadTeacherData:B,showMainCabinetWithSubjects:Y,displayGradeButtons:V,populateTeacherInfo:ie,showSubjectSelection:it,showMainCabinet:ut,loadAdminData:H,getAllUsers:ae,displayAllUsers:Q,displayUsersTable:le,toggleUsersContent:_e,showAddUserForm:ke,hideAddUserForm:Oe,editUserRow:ge,loadAllTeachers:ye,displayAllTeachers:Ke,displayTeachersTable:Xe,toggleTeachersContent:lt,showAddTeacherForm:Ye,hideAddTeacherForm:We,editTeacher:Me,editTeacherRow:je,loadAllSubjects:De,displayAllSubjects:Ge,displaySubjectsTable:ct,toggleSubjectsContent:at,showAddSubjectForm:wt,hideAddSubjectForm:Ft,editSubjectRow:Kt,loadAcademicYear:bt,displayAcademicYear:At,showAddAcademicYearForm:gt,hideAddAcademicYearForm:kt,handleAddAcademicYear:Gt,toggleAcademicYearContent:$t,showAcademicYearEditor:Be,updateUserProfile:St,clearUserData:Mt,clearUserDataWithCache:Ot,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:c,setAllUsers:f,setAllTeachers:m,setAllSubjects:v,setAcademicYears:S,setError:N};return l.jsx(N8.Provider,{value:Te,children:e})},Ky=()=>{const e=C.useContext(N8);if(!e)throw new Error("useUser must be used within a UserProvider");return e},QE={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},ln={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing",FILL_BLANKS:"fill_blanks"},ei={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(e,t)=>t+1);const xi={API_BASE_URL:"",APP_NAME:"Mathayom Watsing Test System",VERSION:"2.0.0",DEBUG_MODE:!1,AUTO_SAVE_INTERVAL:3e4,NOTIFICATION_DURATION:3e3,MAX_TEST_QUESTIONS:50,MIN_TEST_QUESTIONS:1,ITEMS_PER_PAGE:20,CACHE_DURATION:3e5,CURRENT_ACADEMIC_YEAR:"2025-2026",CURRENT_SEMESTER:1},ju=(e,t,r)=>{if(!e||!Array.isArray(e)||e.length===0)return{score:0,total:0,percentage:0};let n=0;return e.forEach((s,a)=>{const i=Array.isArray(t)?t[a]:t[String(s.question_id||s.id||a)];i!=null&&o0(s,i,r)&&n++}),{score:n,total:e.length,percentage:Math.round(n/e.length*100)}},ap=(e,t)=>{console.log("🎓 Getting correct answer for question:",e,"testType:",t);let r="";switch(t){case ln.TRUE_FALSE:r=e.correct_answer?"true":"false",console.log("🎓 TRUE_FALSE correct_answer from question:",r,typeof r);break;case ln.MULTIPLE_CHOICE:const n=e.correct_answer.charCodeAt(0)-65,s=`option_${String.fromCharCode(97+n)}`,a=e[s];a?r=a:r=`Option ${e.correct_answer}`;break;case ln.INPUT:e.correct_answers&&Array.isArray(e.correct_answers)?r=e.correct_answers.join(", "):r=e.correct_answer||"Unknown";break;case ln.MATCHING:r=e.correct_answer||e.answer;break;case ln.WORD_MATCHING:r=e.correct_answer||e.answer;break;case ln.DRAWING:r="Drawing required";break;case ln.FILL_BLANKS:e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?r=e.correct_answers[0]:r=e.correct_answer||"Unknown";break;default:r="Unknown"}return console.log("🎓 Correct answer:",r),r},o0=(e,t,r)=>{if(console.log("[DEBUG] checkAnswerCorrectness called for question:",e,"studentAnswer:",t,"testType:",r),!t||t==="")return console.log("[DEBUG] No student answer provided"),!1;let n=!1;switch(r){case ln.TRUE_FALSE:n=t.toLowerCase()==="true"===e.correct_answer;break;case ln.MULTIPLE_CHOICE:let a="";if(typeof t=="string"){const o=t.trim();if(/^[a-z]$/i.test(o))a=o.toUpperCase();else if(/^\d+$/.test(o)){const c=parseInt(o,10),d=c>=0?c:NaN;Number.isNaN(d)||(a=String.fromCharCode(65+d))}}else if(typeof t=="number"){const o=t;Number.isNaN(o)||(a=String.fromCharCode(65+o))}n=a!==""&&a===String(e.correct_answer||"").toUpperCase();break;case ln.INPUT:if(e.correct_answers&&Array.isArray(e.correct_answers)){const o=t.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();n=e.correct_answers.some(c=>{const d=c.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();return o===d})}else n=t.toLowerCase().trim()===e.correct_answer.toLowerCase().trim();break;case ln.MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case ln.WORD_MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case ln.DRAWING:console.warn("Drawing tests should not be auto-scored!"),n=!1;break;case ln.FILL_BLANKS:const i=e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?e.correct_answers[0]:e.correct_answer;if(i&&t){let o="";if(typeof t=="string"){const c=t.trim();if(/^[a-z]$/i.test(c))o=c.toUpperCase();else if(/^\d+$/.test(c)){const d=parseInt(c,10),f=d>=0?d:NaN;Number.isNaN(f)||(o=String.fromCharCode(65+f))}}else if(typeof t=="number"){const c=t;Number.isNaN(c)||(o=String.fromCharCode(65+c))}n=o!==""&&o===String(i||"").toUpperCase()}break;default:console.warn(`[WARN] Unknown test type for answer checking: ${r}`),n=!1}return console.log(`[DEBUG] Answer correctness: ${n}`),n},Jr={async getTestInfo(e,t){console.log(`[DEBUG] getTestInfo called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(e,t){console.log(`[DEBUG] getTestQuestions called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const e="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(e){throw console.error("[ERROR] Failed to get active tests:",e),e}},async getTeacherTests(){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const e="/.netlify/functions/get-teacher-active-tests";console.log("[DEBUG] Fetching teacher tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Teacher tests data received:",r),r.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get teacher tests")}catch(e){throw console.error("[ERROR] Failed to get teacher tests:",e),e}},async submitTest(e,t,r,n={},s=null){console.log("Submitting test:",{testType:e,testId:t});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let a;try{const k=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`)).json();if(k.success)a=k.test_info;else throw new Error("Failed to get test information")}catch(E){console.error("Error getting test info:",E);const k=await this.getTestQuestions(e,t);a={test_name:`Test ${t}`,num_questions:k.length}}const i=await this.getTestQuestions(e,t);let o,c;if(e==="drawing")o=null,c=null;else{const E=n?.answers_by_id?n.answers_by_id:r;o=ju(i,E,e).score,c=a.num_questions}const d=this.transformAnswersForSubmission(r,e),f=a.teacher_id||null,p=a.subject_id||null,m=s?.student_id||s?.id||(window.tokenManager?.getCurrentUser?window.tokenManager.getCurrentUser()?.student_id||window.tokenManager.getCurrentUser()?.id:null),y={test_id:t,test_name:a.test_name,test_type:e,teacher_id:f,subject_id:p,student_id:m,answers:d,score:o,maxScore:c,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0,answers_by_id:n.answers_by_id||null,question_order:n.question_order||null,retest_assignment_id:n.retest_assignment_id||null,parent_test_id:n.parent_test_id||t};let v;switch(e){case"multiple_choice":v="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":v="/.netlify/functions/submit-true-false-test";break;case"input":v="/.netlify/functions/submit-input-test";break;case"matching_type":v="/.netlify/functions/submit-matching-type-test";break;case"word_matching":v="/.netlify/functions/submit-word-matching-test";break;case"drawing":v="/.netlify/functions/submit-drawing-test";break;case"fill_blanks":v="/.netlify/functions/submit-fill-blanks-test";break;default:throw new Error(`Unsupported test type: ${e}`)}console.log("Submitting to:",v),console.log("Submission data:",y),console.log("Submission data JSON:",JSON.stringify(y,null,2));const w=await window.tokenManager.makeAuthenticatedRequest(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)});if(!w.ok)throw new Error(`HTTP error! status: ${w.status}`);const S=await w.json();if(console.log("Test submission result:",S),S.success)return this.clearTestProgress(e,t),{success:!0,score:o,maxScore:c,result:S};throw new Error(S.error||"Failed to submit test")}catch(a){throw console.error("Error submitting test:",a),a}},async createTest(e){try{return(await Yn.post("/tests/create",e)).data}catch(t){throw new Error(t.message||"Failed to create test")}},async updateTest(e,t,r){try{return(await Yn.put(`/tests/${e}/${t}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(e,t){try{return(await Yn.delete(`/tests/${e}/${t}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(e,t){try{return(await Yn.post(`/tests/${e}/${t}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(e,t){try{return(await Yn.post(`/tests/${e}/${t}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(e,t){try{return(await Yn.post(`/tests/${e}/${t}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(e,t,r){try{return(await Yn.delete(`/tests/${e}/${t}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(e,t){try{return(await Yn.get(`/tests/${e}/${t}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(e,t,r="json"){try{return(await Yn.get(`/tests/${e}/${t}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(e,t){try{return(await Yn.uploadFile(`/tests/import?type=${t}`,e)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(e,t){try{return(await Yn.get(`/tests/${e}/${t}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const e=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();if(console.log("[DEBUG] Student test results data received:",t),t.success)return console.log("[DEBUG] Student test results retrieved successfully"),t;throw new Error(t.error||"Failed to get student test results")}catch(e){throw console.error("[ERROR] Failed to get student test results:",e),new Error(e.message||"Failed to get student test results")}},async getClassResults(e,t,r){try{return(await Yn.get(`/tests/class-results/${e}/${t}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(e,t,r){try{return(await Yn.post(`/tests/${e}/${t}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(e,t){try{return(await Yn.get(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(e,t){try{return(await Yn.delete(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(e){try{return(await Yn.post("/tests/validate",e)).data}catch(t){throw new Error(t.message||"Failed to validate test data")}},async getTestPreview(e,t){try{return(await Yn.get(`/tests/${e}/${t}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},isAnswerCorrect(e,t,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(t))===r.correct_answer;case"true_false":return t.toLowerCase()==="true"===r.correct_answer;case"input":return(r.correct_answers||[]).some(o=>t.toLowerCase().trim()===o.toLowerCase().trim());case"matching_type":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"drawing":return t&&t!=="No answer";default:return!1}},transformAnswersForSubmission(e,t){switch(t){case"multiple_choice":return e;case"true_false":return e;case"input":return e;case"matching_type":return e;case"word_matching":return e;case"drawing":if(Array.isArray(e)&&e.length>0)try{const r=e[0];return typeof r=="string"&&r.startsWith("[")?JSON.parse(r):e}catch(r){return console.warn("Failed to parse drawing answers:",r),e}return e;default:return e}},async markTestCompleted(e,t){try{console.log(`[DEBUG] markTestCompleted called with testType: ${e}, testId: ${t}`);const r=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:e,test_id:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[DEBUG] Mark test completed response:",n),n.success)return console.log(`Test ${e}_${t} marked as completed successfully`),{success:!0,message:n.message};throw new Error(n.error||"Failed to mark test as completed")}catch(r){throw console.error("Error marking test completed:",r),r}},clearTestProgress(e,t){try{const r=`test_progress_${e}_${t}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${e}_${t}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(e){console.log("[DEBUG] saveMultipleChoiceTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving multiple choice test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveTrueFalseTest(e){console.log("[DEBUG] saveTrueFalseTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving true/false test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveInputTest(e){console.log("[DEBUG] saveInputTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving input test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveMatchingTest(e){console.log("[DEBUG] saveMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"matching_type",num_questions:e.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveWordMatchingTest(e){console.log("[DEBUG] saveWordMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving word matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveDrawingTest(e){console.log("[DEBUG] saveDrawingTest called with:",e);try{const t={...e,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(t){return console.error("Error saving drawing test:",t),{success:!1,message:"Error saving test: "+t.message}}},async getDrawingTest(e){console.log("[DEBUG] getDrawingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting drawing test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitDrawingTest(e,t,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(e,t,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:e,score:t,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:e,score:t,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(e){console.log("[DEBUG] getWordMatchingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting word matching test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitWordMatchingTest(e,t,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(e){console.log("[DEBUG] assignTestToClasses called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(t){return console.error("Error assigning test to classes:",t),{success:!1,message:"Error assigning test: "+t.message}}},async removeClassAssignment(e){console.log("[DEBUG] removeClassAssignment called with assignmentId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${e}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(t){return console.error("Error removing class assignment:",t),{success:!1,message:"Error removing assignment: "+t.message}}}},j8=C.createContext(),F8=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState([]),[a,i]=C.useState({}),[o,c]=C.useState({}),[d,f]=C.useState(!1),[p,m]=C.useState(null),[y,v]=C.useState([]),[w,S]=C.useState(!1),[E,k]=C.useState(null),[_,N]=C.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[F,A]=C.useState(null),[R,T]=C.useState(0),{getItem:D,setItem:L,removeItem:O}=E8();C.useEffect(()=>{let Te;return d&&F&&(Te=setInterval(()=>{const ve=Math.floor((Date.now()-F)/1e3);T(ve)},1e3)),()=>{Te&&clearInterval(Te)}},[d,F]);const G=async(Te,ve)=>{try{S(!0),k(null),console.log(`[DEBUG] loadTestForPage called with testType: ${Te}, testId: ${ve}`);const Ne=await Jr.getTestInfo(Te,ve);console.log("[DEBUG] Test info retrieved:",Ne);const Fe=await Jr.getTestQuestions(Te,ve);console.log("[DEBUG] Test questions retrieved:",Fe),r({...Ne,testType:Te,testId:ve}),s(Fe),f(!0),A(Date.now()),T(0),K(Te,ve),console.log("[DEBUG] Test loaded successfully")}catch(Ne){k(Ne.message||"Failed to load test"),console.error("Error loading test:",Ne)}finally{S(!1)}},K=(Te,ve)=>{try{const Ne=`test_progress_${Te}_${ve}`,Fe=D(Ne);Fe&&(i(Fe.answers||{}),c(Fe.progress||{}))}catch(Ne){console.error("Error loading saved progress:",Ne)}},te=(Te,ve,Ne,Fe)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const Wt=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${Te}_${ve}`,Et={...a,[Ne]:Fe},nr={...o,[Ne]:{answered:!0,timestamp:Date.now()}};i(Et),c(nr),L(Wt,{answers:Et,progress:nr,lastSaved:Date.now()}),console.log(`Saved progress for question ${Ne}:`,Fe)}catch(dt){console.error("Error saving test progress:",dt)}},Z=(Te,ve,Ne)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const dt=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${Te}_${ve}`;return D(dt)?.answers?.[Ne]||null}catch(Fe){return console.error("Error getting test progress:",Fe),null}},J=(Te,ve)=>{try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${Te}, testId: ${ve}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const Ne=window.tokenManager?.getDecodedToken()?.sub||"unknown",Fe=`test_progress_${Ne}_${Te}_${ve}`;console.log(`[DEBUG] Removing localStorage key: ${Fe}`);const dt=D(Fe)!==null;O(Fe),i({}),c({});for(let Wt=0;Wt<localStorage.length;Wt++){const Et=localStorage.key(Wt);Et&&Et.startsWith(`test_progress_${Ne}_${Te}_${ve}_`)&&(localStorage.removeItem(Et),console.log(`[DEBUG] Cleared individual question key: ${Et}`))}console.log(dt?`[DEBUG] Progress cleared for test ${Te}_${ve}`:`[DEBUG] No progress found to clear for test ${Te}_${ve}`)}catch(Ne){console.error("Error clearing test progress:",Ne)}},I=async(Te,ve,Ne="")=>{try{S(!0),k(null),console.log("Submitting test:",{testType:Te,testId:ve});const Fe=ae(Te,ve);if(Object.keys(Fe).length===0){k("Please answer at least one question before submitting.");return}let dt;try{dt=await Jr.getTestInfo(Te,ve)}catch(Mr){console.error("Error getting test info:",Mr);const cr=await Jr.getTestQuestions(Te,ve);dt={test_name:`Test ${ve}`,num_questions:cr.length}}const Wt=await Jr.getTestQuestions(Te,ve),Et=ju(Wt,Fe,Te),nr=dt.num_questions,Qt=le(Fe,Te),Zt={test_id:ve,test_name:dt.test_name,score:Et,maxScore:nr,answers:Qt},Nr=await Jr.submitTest(Te,ve,Zt);if(Nr.success){if(m(Nr.result),V(Te,ve,Ne),J(Te,ve),Ne){const Mr=`student_results_table_${Ne}`;console.log("🎓 TestContext: Caching test results after submission with key:",Mr),kn(Mr,Nr.result,Nn.student_results_table)}return Ne&&h0(Ne,Te,ve),f(!1),Nr.results}else throw new Error(Nr.message||"Test submission failed")}catch(Fe){throw k(Fe.message||"Failed to submit test"),Fe}finally{S(!1)}},W=(Te,ve,Ne)=>{m({testType:Te,testId:ve,answers:Ne}),f(!1)},B=()=>{r(null),s([]),i({}),c({}),f(!1),m(null),k(null),A(null),T(0)},Y=(Te,ve,Ne="")=>{try{const Fe=`test_completed_${Ne}_${Te}_${ve}`;return D(Fe)===!0}catch(Fe){return console.error("Error checking test completion:",Fe),!1}},V=(Te,ve,Ne="")=>{try{const Fe=`test_completed_${Ne}_${Te}_${ve}`;L(Fe,!0)}catch(Fe){console.error("Error marking test completed:",Fe)}},H=Te=>Object.keys(a).length,X=()=>{const Te=H(t?.testType),ve=n.length;return{canSubmit:Te===ve,answeredCount:Te,totalQuestions:ve}},se=()=>{t&&J(t.testType,t.testId),B()},ie=(Te="")=>{try{const ve=`student_results_table_${Te}`;console.log("🎓 TestContext: Clearing test results cache:",ve),localStorage.removeItem(ve),console.log("🎓 TestContext: Test results cache cleared")}catch(ve){console.error("Error clearing test results cache:",ve)}},ae=(Te,ve)=>({...a}),Q=(Te,ve,Ne=null)=>{try{if(!Te)return"No answer";switch(ve){case"true_false":return Te?"True":"False";case"multiple_choice":if(Ne&&typeof Te=="string"&&!isNaN(parseInt(Te))){const Fe=parseInt(Te),dt=`option_${String.fromCharCode(97+Fe)}`,Wt=Ne[dt];if(Wt)return Wt}return String(Te).toUpperCase();case"input":return String(Te);case"matching_type":return typeof Te=="object"?Object.entries(Te).map(([Fe,dt])=>`${Fe} → ${dt}`).join(", "):String(Te);case"word_matching":return typeof Te=="object"?Object.entries(Te).map(([Fe,dt])=>`${Fe} → ${dt}`).join(", "):String(Te);case"drawing":return"Drawing submitted";default:return String(Te)}}catch(Fe){return console.error("Error formatting student answer:",Fe),"Error displaying answer"}},le=(Te,ve)=>{try{if(!Te||typeof Te!="object")return{};const Ne={};return Object.entries(Te).forEach(([Fe,dt])=>{if(dt!=null)switch(ve){case"true_false":Ne[Fe]=!!dt;break;case"multiple_choice":Ne[Fe]=String(dt).toUpperCase();break;case"input":Ne[Fe]=String(dt).trim();break;case"matching_type":typeof dt=="object"?Ne[Fe]=dt:Ne[Fe]=String(dt);break;case"word_matching":typeof dt=="object"?Ne[Fe]=dt:Ne[Fe]=String(dt);break;case"drawing":Ne[Fe]=dt;break;default:Ne[Fe]=dt}}),Ne}catch(Ne){return console.error("Error transforming answers for submission:",Ne),Te||{}}},_e=C.useCallback(async(Te="")=>{try{S(!0);const ve=`student_active_tests_${Te}`,Ne=Mn(ve);if(Ne)return v(Ne),Ne;const Fe=await Jr.getActiveTests();return v(Fe),kn(ve,Fe,Nn.student_active_tests),Fe}catch(ve){return k(ve.message||"Failed to load active tests"),v([]),[]}finally{S(!1)}},[]),ke=async()=>{try{return S(!0),await Jr.getTeacherTests()}catch(Te){return k(Te.message||"Failed to load teacher tests"),[]}finally{S(!1)}},Oe=async Te=>{try{return S(!0),await Jr.createTest(Te)}catch(ve){throw k(ve.message||"Failed to create test"),ve}finally{S(!1)}},ge=async(Te,ve)=>{try{return S(!0),await Jr.deleteTest(Te,ve)}catch(Ne){throw k(Ne.message||"Failed to delete test"),Ne}finally{S(!1)}},ye=async(Te,ve)=>{try{return await Jr.getTestInfo(Te,ve)}catch(Ne){throw console.error("Error getting test info:",Ne),Ne}},Ke=async(Te,ve)=>{try{return await Jr.getTestQuestions(Te,ve)}catch(Ne){throw console.error("Error getting test questions:",Ne),Ne}},Xe=async(Te,ve,Ne)=>{try{console.log("Showing test results:",{testType:Te,testId:ve,studentAnswers:Ne});const Fe=await ye(Te,ve),dt=await Ke(Te,ve);We(Fe,dt,Te,Ne),f(!1),console.log("Test results displayed successfully")}catch(Fe){console.error("Error showing test results:",Fe),k("Failed to display test results"),m({testType:Te,testId:ve,answers:Ne,showResults:!0,error:"Could not load detailed results"}),f(!1)}},lt=async(Te,ve,Ne)=>{try{S(!0);const Fe=await ye(Te,ve),dt=await Ke(Te,ve);We(Fe,dt,Te,Ne)}catch(Fe){k(Fe.message||"Failed to load test results")}finally{S(!1)}},Ye=C.useCallback(async(Te="")=>{try{S(!0);const ve=`student_results_table_${Te}`;console.log("🎓 TestContext: Checking cache for key:",ve);const Ne=Mn(ve);if(Ne)return console.log("🎓 TestContext: Cache HIT! Using cached test results"),m(Ne),Ne;console.log("🎓 TestContext: Cache MISS! Fetching from API");const Fe=await Jr.getStudentTestResults();return console.log("🎓 TestContext: Test results loaded:",Fe),console.log("🎓 TestContext: Results data:",Fe?.results||Fe),console.log("🎓 TestContext: Results length:",Fe?.results?.length||0),m(Fe),console.log("🎓 TestContext: Caching test results with key:",ve),console.log("🎓 TestContext: Results being cached:",Fe),console.log("🎓 TestContext: Results.results being cached:",Fe.results),kn(ve,Fe,Nn.student_results_table),Fe}catch(ve){throw console.error("Error loading test results:",ve),k(ve.message||"Failed to load test results"),ve}finally{S(!1)}},[]),We=(Te,ve,Ne,Fe)=>{try{console.log("Displaying test results:",{testInfo:Te,questions:ve,testType:Ne,studentAnswers:Fe});const dt=ju(ve,Fe,Ne),Wt=Te?.num_questions||ve?.length||0,Et=Wt>0?Math.round(dt/Wt*100):0,nr=Et>=60,Qt=ve.map((Zt,Nr)=>{const Mr=Zt.question_id||Zt.id,cr=Fe[Mr],Fr=o0(Zt,cr,Ne);return{questionNumber:Nr+1,question:Zt.question||Zt.question_text,userAnswer:Q(cr,Ne),correctAnswer:ap(Zt,Ne),isCorrect:Fr,questionType:Ne}});m({testInfo:Te,questions:ve,testType:Ne,studentAnswers:Fe,showResults:!0,score:dt,totalQuestions:Wt,percentage:Et,passed:nr,questionAnalysis:Qt,timestamp:new Date().toISOString()}),c(Zt=>({...Zt,score:dt,totalQuestions:Wt,percentage:Et,passed:nr,lastUpdated:Date.now()})),Me(),console.log(`Test results displayed: ${dt}/${Wt} (${Et}%) - ${nr?"PASSED":"FAILED"}`)}catch(dt){console.error("Error displaying test results:",dt),k("Failed to display test results")}},Me=C.useCallback(()=>{try{console.log("Setting up test results page event listeners");const Te=Wt=>{if(Wt.key==="Escape"&&se(),Wt.ctrlKey&&Wt.key==="p"&&(Wt.preventDefault(),window.print()),Wt.key==="Enter"&&p&&!p.passed){const Et=document.getElementById("retake-test-button");Et&&Et.click()}},ve=()=>{window.print()},Ne=()=>{if(p){const Wt=`Test: ${p.testInfo?.test_name||"Test"}
Score: ${p.score}/${p.totalQuestions} (${p.percentage}%)
Status: ${p.passed?"PASSED":"FAILED"}
Completed: ${new Date(p.timestamp).toLocaleString()}`;navigator.clipboard.writeText(Wt).then(()=>{console.log("Results copied to clipboard")}).catch(Et=>{console.error("Failed to copy results:",Et)})}};document.addEventListener("keydown",Te);const Fe=document.getElementById("print-results");Fe&&Fe.addEventListener("click",ve);const dt=document.getElementById("copy-results");return dt&&dt.addEventListener("click",Ne),()=>{document.removeEventListener("keydown",Te),Fe&&Fe.removeEventListener("click",ve),dt&&dt.removeEventListener("click",Ne)}}catch(Te){console.error("Error setting up test results page event listeners:",Te)}},[se,p]),je=async(Te,ve,Ne)=>{try{S(!0),k(null),console.log("Viewing test details:",{testType:Te,testId:ve,testName:Ne}),N({isOpen:!0,testType:Te,testId:ve,testName:Ne,questions:[],isLoading:!0});const Fe=await Jr.getTestQuestions(Te,ve);Fe&&Fe.length>0?(N({isOpen:!0,testType:Te,testId:ve,testName:Ne,questions:Fe,isLoading:!1}),console.log(`Test details loaded: ${Fe.length} questions`)):(k("Could not load test questions. Please try again."),N({isOpen:!0,testType:Te,testId:ve,testName:Ne,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(Fe){console.error("Error loading test details:",Fe),k("Error loading test details. Please try again."),N({isOpen:!0,testType:Te,testId:ve,testName:Ne,questions:[],isLoading:!1,error:Fe.message||"Failed to load test details"})}finally{S(!1)}},De=(Te,ve,Ne,Fe)=>{try{console.log("Showing test details modal:",{testType:Te,testId:ve,testName:Ne,questions:Fe}),N({isOpen:!0,testType:Te,testId:ve,testName:Ne,questions:Fe||[],isLoading:!1,error:null})}catch(dt){console.error("Error showing test details modal:",dt),k("Failed to show test details modal")}},Ge=()=>{try{console.log("Closing test details modal"),N({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(Te){console.error("Error closing test details modal:",Te)}},ct=(Te,ve)=>{try{switch(ve){case"multiple_choice":return l.jsxs("div",{className:"answer-options",children:[l.jsx("p",{children:l.jsx("strong",{children:"Options:"})}),l.jsxs("p",{children:["A) ",Te.option_a||"No text"]}),l.jsxs("p",{children:["B) ",Te.option_b||"No text"]}),Te.option_c&&l.jsxs("p",{children:["C) ",Te.option_c]}),Te.option_d&&l.jsxs("p",{children:["D) ",Te.option_d]}),Te.option_e&&l.jsxs("p",{children:["E) ",Te.option_e]}),Te.option_f&&l.jsxs("p",{children:["F) ",Te.option_f]}),l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",Te.correct_answer||"Not specified"]})})]});case"true_false":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",Te.correct_answer?"True":"False"]})})});case"input":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",Te.correct_answer||"Not specified"]})})});case"matching_type":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",Te.correct_answer?JSON.stringify(Te.correct_answer):"Not specified"]})})});case"word_matching":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",Te.correct_answer?JSON.stringify(Te.correct_answer):"Not specified"]})})});default:return l.jsx("p",{children:"Unknown question type"})}}catch(Ne){return console.error("Error formatting question answer display:",Ne),l.jsx("p",{children:"Error displaying question"})}},at=(Te,ve)=>{try{console.log("Navigating to test:",{testType:Te,testId:ve}),r({testType:Te,testId:ve}),f(!0),G(Te,ve)}catch(Ne){console.error("Error navigating to test:",Ne),k("Failed to navigate to test")}},wt=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),c({}),f(!1),m(null),k(null)}catch(Te){console.error("Error hiding test sections:",Te)}},Ft=(Te,ve,Ne,Fe)=>{try{console.log("Displaying test on page:",{testInfo:Te,questions:ve,testType:Ne,testId:Fe}),r({...Te,testType:Ne,testId:Fe}),s(ve),f(!0),K(Ne,Fe),$t(Ne,Fe),kt(Ne,Fe)}catch(dt){console.error("Error displaying test on page:",dt),k("Failed to display test on page")}},Kt=(Te,ve,Ne)=>{try{return console.log("Rendering questions for page:",{questions:Te,testType:ve,testId:Ne}),!Te||!Array.isArray(Te)?(console.warn("Invalid questions array for rendering"),[]):Te.map((Fe,dt)=>{const Wt=Et=>{const nr={...a,[Fe.question_id]:Et};i(nr),te(ve,Ne,Fe.question_id,Et)};return{question:Fe,index:dt,testType:ve,testId:Ne,studentAnswer:a[Fe.question_id]||"",onAnswerChange:Wt}})}catch(Fe){return console.error("Error rendering questions for page:",Fe),[]}},bt=C.useCallback((Te,ve)=>{try{if(!Te||!ve){console.warn("Cannot save progress: missing testType or testId");return}const Ne=`test_progress_${Te}_${ve}`,Fe={answers:a,progress:o,lastSaved:Date.now(),testType:Te,testId:ve};L(Ne,Fe),console.log(`Progress saved for test ${Te}_${ve}:`,Fe)}catch(Ne){console.error("Error saving progress for page:",Ne)}},[a,o,L]),At=C.useCallback(Te=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(Ne=>Ne==null?!1:typeof Ne=="string"?Ne.trim()!=="":typeof Ne=="object"?Object.keys(Ne).length>0:!0).length}catch(ve){return console.error("Error getting answered questions count for page:",ve),0}},[a]),gt=C.useCallback((Te,ve)=>{try{console.log("Updating progress display for page:",{testType:Te,testId:ve});const Ne=At(Te),Fe=n.length,dt=Fe>0?Math.round(Ne/Fe*100):0,Wt=Ne===Fe&&Fe>0;c(Zt=>({...Zt,answeredCount:Ne,totalQuestions:Fe,percentage:dt,canSubmit:Wt,remainingQuestions:Fe-Ne,lastUpdated:Date.now()}));const Et=document.getElementById("progress-bar"),nr=document.getElementById("progress-text"),Qt=document.getElementById("submit-test-button");return Et&&(Et.style.width=`${dt}%`,Et.className=Et.className.replace(/bg-\w+-\d+/,""),dt>=100?Et.classList.add("bg-green-500"):dt>=80?Et.classList.add("bg-blue-500"):dt>=60?Et.classList.add("bg-yellow-500"):dt>=40?Et.classList.add("bg-orange-500"):Et.classList.add("bg-red-500")),nr&&(nr.textContent=`${Ne}/${Fe} questions answered (${dt}%)`),Qt&&(Qt.disabled=!Wt,Wt?(Qt.textContent="✅ Submit Test",Qt.classList.remove("bg-gray-400"),Qt.classList.add("bg-green-600","hover:bg-green-700")):(Qt.textContent=`⏳ Complete ${Fe-Ne} more question${Fe-Ne!==1?"s":""}`,Qt.classList.remove("bg-green-600","hover:bg-green-700"),Qt.classList.add("bg-gray-400"))),{answeredCount:Ne,totalQuestions:Fe,percentage:dt,canSubmit:Wt}}catch(Ne){return console.error("Error updating progress display for page:",Ne),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,At]),kt=C.useCallback((Te,ve)=>{try{console.log("Setting up test page event listeners:",{testType:Te,testId:ve});const Ne=setInterval(()=>{Object.keys(a).length>0&&(bt(Te,ve),console.log("Auto-saved progress for test:",Te,ve))},3e4),Fe=setInterval(()=>{gt(Te,ve)},2e3),dt=Zt=>{Zt.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&se(),Zt.ctrlKey&&Zt.key==="s"&&(Zt.preventDefault(),bt(Te,ve),console.log("Manual save triggered")),Zt.key},Wt=Zt=>{Object.keys(a).length>0&&(Zt.preventDefault(),Zt.returnValue="Your test progress will be saved. Are you sure you want to leave?")},Et=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),bt(Te,ve))},nr=()=>{console.log("Window focused - updating progress"),gt(Te,ve)},Qt=()=>{console.log("Window blurred - saving progress"),bt(Te,ve)};return document.addEventListener("keydown",dt),window.addEventListener("beforeunload",Wt),document.addEventListener("visibilitychange",Et),window.addEventListener("focus",nr),window.addEventListener("blur",Qt),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${Te}_${ve}`]=Ne,window.testIntervals[`progress_${Te}_${ve}`]=Fe,()=>{clearInterval(Ne),clearInterval(Fe),document.removeEventListener("keydown",dt),window.removeEventListener("beforeunload",Wt),document.removeEventListener("visibilitychange",Et),window.removeEventListener("focus",nr),window.removeEventListener("blur",Qt),window.testIntervals&&(delete window.testIntervals[`autosave_${Te}_${ve}`],delete window.testIntervals[`progress_${Te}_${ve}`])}}catch(Ne){console.error("Error setting up test page event listeners:",Ne)}},[a,bt,gt,se]),Gt=C.useCallback(()=>{try{const Te=At(t?.testType),ve=n.length,Ne=Te===ve&&ve>0,Fe=document.getElementById("submit-test-button");return Fe&&(Fe.disabled=!Ne,Fe.textContent=Ne?"Submit Test":`Complete ${ve-Te} more questions`),{canSubmit:Ne,answeredCount:Te,totalQuestions:ve}}catch(Te){return console.error("Error updating submit button state for page:",Te),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[t,n.length,At]),$t=C.useCallback((Te,ve)=>{try{console.log("Setting up progress tracking for page:",{testType:Te,testId:ve});const Ne=setInterval(()=>{gt(Te,ve),Gt()},1e3),Fe=setInterval(()=>{Object.keys(a).length>0&&bt(Te,ve)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${Te}_${ve}`]=Ne,window.testIntervals[`autosave_${Te}_${ve}`]=Fe,()=>{clearInterval(Ne),clearInterval(Fe),window.testIntervals&&(delete window.testIntervals[`progress_${Te}_${ve}`],delete window.testIntervals[`autosave_${Te}_${ve}`])}}catch(Ne){console.error("Error setting up progress tracking for page:",Ne)}},[a,gt,Gt,bt]),Be=C.useCallback(async(Te,ve)=>{const Ne=document.getElementById("submit-test-button");try{const Fe=At(Te),dt=n.length;if(Fe<dt){k(`Please answer all ${dt} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;Ne&&(Ne.disabled=!0,Ne.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await I(Te,ve)&&(J(Te,ve),W(Te,ve,a),console.log("Test submitted successfully!"))}catch(Fe){console.error("Error submitting test from page:",Fe),k("Failed to submit test. Please try again."),Ne&&(Ne.disabled=!1,Ne.textContent="Submit Test")}},[At,n.length,I,J,W,a]),it=C.useCallback(()=>{try{if(!t)return null;const Te=["true_false","multiple_choice","input","matching_type","word_matching"];return Te.includes(t.testType)?t.testType:Te.includes(t.test_type)?t.test_type:null}catch(Te){return console.error("Error getting current test type:",Te),null}},[t]),ut=C.useCallback((Te,ve)=>{try{console.log("Clearing progress tracking interval:",{testType:Te,testId:ve});const Ne=`progress_interval_${Te}_${ve}`,Fe=`autosave_interval_${Te}_${ve}`;window.testIntervals&&(window.testIntervals[Ne]&&(clearInterval(window.testIntervals[Ne]),delete window.testIntervals[Ne]),window.testIntervals[Fe]&&(clearInterval(window.testIntervals[Fe]),delete window.testIntervals[Fe])),console.log(`Cleared progress tracking intervals for test ${Te}_${ve}`)}catch(Ne){console.error("Error clearing progress tracking interval:",Ne)}},[]),Ot={currentTest:t,testQuestions:n,studentAnswers:a,testProgress:o,isTestActive:d,testResults:p,activeTests:y,isLoading:w,error:E,testDetailsModal:_,testStartTime:F,timeElapsed:R,loadTestForPage:G,submitTest:I,navigateToTestResults:W,navigateBackToCabinet:B,clearTestDataAndReturnToCabinet:se,saveTestProgress:te,getTestProgress:Z,clearTestProgress:J,loadSavedProgressForPage:K,isTestCompleted:Y,markTestCompleted:V,markTestCompletedInUI:(Te,ve)=>{console.log("Marking test completed in UI:",{testType:Te,testId:ve}),V(Te,ve)},getAnsweredQuestionsCount:H,updateSubmitButtonState:X,updateSubmitButtonStateForPage:Gt,loadStudentActiveTests:_e,loadActiveTests:_e,loadTeacherActiveTests:ke,getTestInfo:ye,getTestQuestions:Ke,createTest:Oe,deleteTest:ge,showTestResults:Xe,loadTestResults:Ye,loadTestResultsForPage:lt,displayTestResultsOnPage:We,setupTestResultsPageEventListeners:Me,clearTestResultsCache:ie,viewTestDetails:je,showTestDetailsModal:De,closeTestDetailsModal:Ge,getQuestionAnswerDisplay:ct,navigateToTest:at,hideTestSections:wt,displayTestOnPage:Ft,renderQuestionsForPage:Kt,setupTestPageEventListeners:kt,setupProgressTrackingForPage:$t,updateProgressDisplayForPage:gt,submitTestFromPage:Be,getAnsweredQuestionsCountForPage:At,getCurrentTestType:it,saveProgressForPage:bt,clearProgressTrackingInterval:ut,collectTestAnswers:ae,calculateTestScore:ju,checkAnswerCorrectness:o0,formatStudentAnswerForDisplay:Q,getCorrectAnswer:ap,transformAnswersForSubmission:le,clearAllTestData:()=>{try{console.log("Clearing old test data from localStorage (older than 15 days)...");const ve=Date.now()-360*60*60*1e3,Ne=[];for(let Fe=0;Fe<localStorage.length;Fe++){const dt=localStorage.key(Fe);if(!(!dt||!((dt.startsWith("test_")||dt.startsWith("student_")||dt.startsWith("teacher_")||dt.startsWith("admin_")||dt.includes("progress")||dt.includes("answers"))&&!dt.includes("test_completed_"))))try{const Et=localStorage.getItem(dt);if(!Et){Ne.push(dt);continue}let nr=null;if(Et.startsWith("{")||Et.startsWith("[")){const Qt=JSON.parse(Et),Zt=Qt.timestamp||Qt.lastSaved||Qt.lastTickAt||Qt.createdAt||Qt.updatedAt||Qt.startedAt||Qt.started_at||Qt.created_at;Zt&&(nr=new Date(Zt).getTime())}if(!nr){const Qt=`${dt}__ts`,Zt=localStorage.getItem(Qt);Zt&&(nr=parseInt(Zt)||null)}if(!nr)continue;nr<ve&&Ne.push(dt)}catch{continue}}return Ne.forEach(Fe=>{console.log(`Removing old localStorage key: ${Fe}`),O(Fe)}),console.log(`Cleared ${Ne.length} old test-related items from localStorage`),{success:!0,clearedCount:Ne.length}}catch(Te){return console.error("Error clearing old test data:",Te),{success:!1,error:Te.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:c,setIsTestActive:f,setTestResults:m,setError:k};return l.jsx(j8.Provider,{value:Ot,children:e})},$p=()=>{const e=C.useContext(j8);if(!e)throw new Error("useTest must be used within a TestProvider");return e},Zb=({testResults:e,onBackToCabinet:t,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0})=>{if(!e||!e.showResults)return l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:i,testType:o,score:c,totalQuestions:d,percentage:f,passed:p,questionAnalysis:m,timestamp:y}=e,v=E=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[E]||E,w=E=>E>=80?"text-green-600 bg-green-50":E>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",S=E=>E?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):l.jsx("div",{className:"bg-gray-50 py-8 overflow-y-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs(Qe.div,{className:"bg-white rounded-lg shadow-lg p-6 mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(e?.caught_cheating||s)&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-6",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",e?.visibility_change_times||a||0," times during the test."]})})]})}),l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Test Results"}),l.jsx("h2",{className:"text-xl text-gray-700 mb-1",children:i?.test_name||"Test"}),l.jsxs("p",{className:"text-sm text-gray-500",children:[v(o)," • Completed on ",new Date(y).toLocaleDateString()]})]}),l.jsx("div",{className:"text-right",children:l.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${S(p)}`,children:p?"✓ PASSED":"✗ FAILED"})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:c}),l.jsx("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:d}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:`text-3xl font-bold ${w(f).split(" ")[0]}`,children:[f,"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Score"})]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-6",children:l.jsx(Qe.div,{className:`h-3 rounded-full ${w(f).split(" ")[1]}`,initial:{width:0},animate:{width:`${f}%`},transition:{duration:1,ease:"easeOut"}})}),l.jsx("div",{className:"flex flex-wrap gap-3",children:l.jsx(tt,{onClick:t,variant:"primary",className:"flex items-center gap-2",children:"← Back to Cabinet"})})]}),o!=="matching_type"&&o!=="word_matching"&&l.jsxs(Qe.div,{className:"bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Question Review"}),l.jsx("div",{className:"space-y-4",children:m.map((E,k)=>l.jsxs(Qe.div,{className:`p-4 rounded-lg border-2 ${E.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:k*.1},children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Question ",E.questionNumber]}),l.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${E.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.isCorrect?"✓ Correct":"✗ Incorrect"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Question:"}),l.jsx("p",{className:"text-gray-700 bg-gray-100 p-3 rounded",children:E.question})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Your Answer:"}),l.jsx("p",{className:`p-3 rounded ${E.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.userAnswer||"No answer provided"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Correct Answer:"}),l.jsx("p",{className:"bg-blue-100 text-blue-800 p-3 rounded",children:E.correctAnswer})]})]})]},k))})]}),l.jsxs(Qe.div,{className:"bg-white rounded-lg shadow-lg p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Summary Statistics"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.filter(E=>E.isCorrect).length}),l.jsx("div",{className:"text-sm text-blue-600",children:"Correct"})]}),l.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:m.filter(E=>!E.isCorrect).length}),l.jsx("div",{className:"text-sm text-red-600",children:"Incorrect"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[Math.round(m.filter(E=>E.isCorrect).length/d*100),"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy"})]}),l.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:d}),l.jsx("div",{className:"text-sm text-purple-600",children:"Total"})]})]})]})]})})},P8=({isOpen:e,onClose:t,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1})=>{if(!e)return null;const o=p=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[p]||p,c=p=>({multiple_choice:"🔘",true_false:"✅",input:"✏️",matching_type:"🔗"})[p]||"❓",d=(p,m)=>{switch(m){case"multiple_choice":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[p.option_a&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),l.jsx("span",{className:"text-gray-700",children:p.option_a})]}),p.option_b&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),l.jsx("span",{className:"text-gray-700",children:p.option_b})]}),p.option_c&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),l.jsx("span",{className:"text-gray-700",children:p.option_c})]}),p.option_d&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),l.jsx("span",{className:"text-gray-700",children:p.option_d})]}),p.option_e&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),l.jsx("span",{className:"text-gray-700",children:p.option_e})]}),p.option_f&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:p.option_f})]})]})]});case"true_false":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),l.jsx("span",{className:"text-gray-700",children:"True"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},f=(p,m)=>{if(!p.correct_answer)return null;let y="";switch(m){case"multiple_choice":y=p.correct_answer.toUpperCase();break;case"true_false":y=p.correct_answer?"True":"False";break;case"input":y=p.correct_answer;break;case"matching_type":y=typeof p.correct_answer=="object"?JSON.stringify(p.correct_answer):p.correct_answer;break;default:y=String(p.correct_answer)}return l.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[l.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),l.jsx("p",{className:"text-green-700 font-mono",children:y})]})};return l.jsx(yi,{children:l.jsxs(Qe.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[l.jsx(Qe.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t}),l.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:l.jsxs(Qe.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("span",{className:"text-2xl",children:c(r)}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[o(r)," • ",a.length," Questions"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(tt,{onClick:()=>window.print(),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:"🖨️ Print"}),l.jsx(tt,{onClick:t,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:"✕ Close"})]})]}),l.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):a.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"text-6xl mb-4",children:"📝"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),l.jsx("p",{className:"text-gray-500",children:"This test doesn't have any questions yet."})]}):l.jsx("div",{className:"space-y-6",children:a.map((p,m)=>l.jsxs(Qe.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.1,duration:.3},children:[l.jsx("div",{className:"flex items-start justify-between mb-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",m+1]}),l.jsx("span",{className:"text-gray-500 text-sm",children:o(r)})]})}),l.jsx("div",{className:"mb-4",children:l.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:p.question||p.question_text})}),d(p,r),f(p,r)]},p.id||p.question_id||m))})}),l.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[l.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&l.jsxs("span",{children:["Showing ",a.length," question",a.length!==1?"s":""]})}),l.jsx("div",{className:"flex items-center space-x-3",children:l.jsx(tt,{onClick:t,variant:"primary",className:"flex items-center space-x-2",children:"Close"})})]})]})})]})})},AW=({answeredCount:e=0,totalQuestions:t=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i=""})=>{const o=t>0?Math.round(e/t*100):0,c=t-e,d=m=>{const y=Math.floor(m/3600),v=Math.floor(m%3600/60),w=m%60;return y>0?`${y}:${v.toString().padStart(2,"0")}:${w.toString().padStart(2,"0")}`:`${v}:${w.toString().padStart(2,"0")}`},f=m=>m>=100?"bg-green-500":m>=80?"bg-blue-500":m>=60?"bg-yellow-500":m>=40?"bg-orange-500":"bg-red-500",p=m=>m>=100?"text-green-600":m>=80?"text-blue-600":m>=60?"text-yellow-600":m>=40?"text-orange-600":"text-red-600";return l.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 ${i}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Progress"}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-2xl",children:"⏱️"}),l.jsx("span",{className:"text-sm font-mono text-gray-600",children:d(r)})]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),l.jsxs("span",{className:`text-sm font-semibold ${p(o)}`,children:[o,"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:l.jsx(Qe.div,{className:`h-full ${f(o)} transition-colors duration-300`,initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5,ease:"easeOut"}})})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-4",children:[l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:e}),l.jsx("div",{className:"text-xs text-blue-600",children:"Answered"})]}),l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-600",children:c}),l.jsx("div",{className:"text-xs text-gray-600",children:"Remaining"})]}),l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:t}),l.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]})]}),l.jsx("div",{className:"mb-4",children:e===t?l.jsx(Qe.div,{className:"flex items-center justify-center p-3 bg-green-50 border border-green-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:"text-green-600 font-medium",children:"🎉 All questions answered! Ready to submit."})}):c===1?l.jsx(Qe.div,{className:"flex items-center justify-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:"text-yellow-600 font-medium",children:"Almost there! 1 question remaining."})}):l.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:l.jsxs("span",{className:"text-gray-600 font-medium",children:[c," questions remaining"]})})}),a&&l.jsx("div",{className:"flex justify-center",children:l.jsx(Qe.button,{onClick:n,disabled:s,className:`px-8 py-3 rounded-lg font-semibold text-white transition-all duration-300 ${s?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"}`,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},children:s?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Submitting..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{children:"✅"}),l.jsx("span",{children:"Submit Test"})]})})})]})},jW=({testText:e,blanks:t,separateType:r=!0,testId:n,testName:s="Unknown Test",teacherId:a="Unknown Teacher",subjectId:i,onTestComplete:o,onAnswerChange:c})=>{if(console.log("🔍 FillBlanksTestStudent Props Debug:"),console.log("- testText:",e),console.log("- blanks:",t),console.log("- separateType:",r),console.log("- testId:",n),console.log("- testName:",s),console.log("- teacherId:",a),console.log("- subjectId:",i),!e||!t||!Array.isArray(t))return console.log("❌ FillBlanksTestStudent: Missing test data"),l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(mt,{className:"max-w-md w-full",children:l.jsxs(mt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:"📝"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load fill blanks test data"}),l.jsx(tt,{onClick:()=>window.history.back(),variant:"primary",children:"Back to Dashboard"})]})})});const[d,f]=C.useState({}),[p,m]=C.useState(!1),[y,v]=C.useState(null),[w,S]=C.useState(null),[E,k]=C.useState(!1),[_,N]=C.useState(null),{showNotification:F}=Oa(),{makeAuthenticatedRequest:A}=Ho(),{user:R}=Gn(),{startTracking:T,stopTracking:D,getCheatingData:L,clearData:O}=Up("fill_blanks",n,R?.student_id||R?.id);Vy();const G=C.useCallback((J,I)=>{try{let W=J;if(typeof J=="string"&&J.startsWith("{"))try{const H=JSON.parse(J);H.root&&H.root.children&&(W=H.root.children.map(X=>X.children?X.children.map(se=>se.style&&se.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":se.text||"").join(""):"").join(" "))}catch(H){console.error("Error parsing Lexical JSON:",H)}let B=W;I.forEach((H,X)=>{const se=`[${X+1}_________]`;B=B.replace("[BLANK_PLACEHOLDER]",se)});const V=B.split(/(\[\d+_________\])/).map((H,X)=>H.match(/\[\d+_________\]/)?l.jsx("span",{className:"inline-block px-3 py-1 mx-1 bg-purple-100 text-purple-800 border-2 border-purple-400 rounded-lg font-mono font-bold shadow-sm",children:H},X):l.jsx("span",{children:H},X));return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:V})})}catch(W){return console.error("Error rendering text with blanks:",W),l.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[]),K=C.useCallback((J,I)=>{try{let W=J;if(typeof J=="string"&&J.startsWith("{"))try{const H=JSON.parse(J);H.root&&H.root.children&&(W=H.root.children.map(X=>X.children?X.children.map(se=>se.style&&se.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":se.text||"").join(""):"").join(" "))}catch(H){console.error("Error parsing Lexical JSON:",H)}const B=[];I.forEach((H,X)=>{const se=d[H.id],ie=se?H.options[se.charCodeAt(0)-65]:null,ae=ie?l.jsx("span",{className:"inline-block px-3 py-2 bg-green-100 text-green-800 rounded-lg border-2 border-green-400 cursor-pointer hover:bg-green-200 hover:border-green-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>S(H.id),children:ie},X):l.jsxs("span",{className:"inline-block px-3 py-2 bg-purple-100 text-purple-800 rounded-lg border-2 border-purple-400 cursor-pointer hover:bg-purple-200 hover:border-purple-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>S(H.id),children:[X+1,"_________"]},X);B.push(ae),W=W.replace("[BLANK_PLACEHOLDER]",`__BLANK_${H.id}__`)});const Y=W.split(/__BLANK_\d+__/),V=[];for(let H=0;H<Y.length;H++)Y[H]&&V.push(l.jsx("span",{children:Y[H]},`text-${H}`)),H<B.length&&V.push(B[H]);return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:V})})}catch(W){return console.error("Error rendering text with inline blanks:",W),l.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[d]),te=C.useCallback((J,I)=>{const W={...d,[J]:I};f(W),c&&c(J,I)},[d,c]),Z=C.useCallback(J=>l.jsx("div",{className:"space-y-6",children:J.map((I,W)=>{const B=I.blank_options||I.options||[];I.correct_answers;const Y=I.question_json||I.question||`Blank ${W+1}`;return console.log(`🔍 Blank ${W+1} question text:`,Y),l.jsxs(mt,{className:"p-4",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",W+1]}),l.jsx("p",{className:"text-gray-600 mb-4",children:Y})]}),l.jsx("div",{className:"space-y-3",children:B.filter(V=>V&&V.trim().length>0).map((V,H)=>l.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[l.jsx("input",{type:"radio",name:`blank_${I.question_id||I.id||W}`,value:String.fromCharCode(65+H),checked:d[I.question_id||I.id||W]===String.fromCharCode(65+H),onChange:X=>te(I.question_id||I.id||W,X.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),l.jsxs("span",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+H)}),l.jsx("span",{className:"text-gray-700",children:V})]})]},H))})]},I.question_id||I.id||W)})}),[d,te]);return C.useEffect(()=>{if(n&&R?.student_id){v(new Date),T(),console.log("🛡️ Anti-cheating tracking started for fill blanks test");const I=`test_progress_${R.student_id}_fill_blanks_${n}`,W=Mn(I);W&&(f(W.answers||{}),v(new Date(W.startTime)),console.log("🎯 Fill blanks test progress restored:",W))}},[n,R?.student_id,t,T]),C.useEffect(()=>{if(y&&R?.student_id&&n){const J=setInterval(()=>{const I={answers:d,startTime:y.toISOString()},W=`test_progress_${R.student_id}_fill_blanks_${n}`;kn(W,I,Nn.test_progress),console.log("🎯 Fill blanks progress auto-saved")},3e4);return()=>clearInterval(J)}},[y,d,R?.student_id,n]),C.useEffect(()=>()=>{D(),O(),console.log("🛡️ Fill blanks test component unmounted - anti-cheating cleanup")},[D,O]),C.useCallback(async()=>{m(!0);try{const J=t.length;let I=0;t.forEach((ke,Oe)=>{const ge=d[ke.id];ge&&ge===ke.correct_answer&&I++});const W=I,B=J;console.log(`🎯 Fill Blanks Score: ${W}/${B} (${Math.round(W/B*100)}%)`);const Y=new Date,V=y?Math.round((Y-y)/1e3):0,H=y?y.toISOString():Y.toISOString(),X=L();console.log("🛡️ Anti-cheating data for fill blanks submission:",X);const se=R.student_id,ie=`retest_assignment_id_${se}_fill_blanks_${n}`,ae=localStorage.getItem(ie),Q={test_id:n,test_name:s,teacher_id:a||null,subject_id:i||null,student_id:se,parent_test_id:n,retest_assignment_id:ae?Number(ae):null,answers:d,score:W,maxScore:B,time_taken:V,started_at:H,submitted_at:Y.toISOString(),caught_cheating:X.caught_cheating,visibility_change_times:X.visibility_change_times};console.log("🎯 Submitting fill blanks test:",Q);const _e=await(await A("/.netlify/functions/submit-fill-blanks-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)})).json();if(_e.success){if(F("Test submitted successfully!","success"),D(),O(),console.log("🛡️ Anti-cheating tracking stopped and data cleared for fill blanks test"),R?.student_id&&(h0(R.student_id,"fill_blanks",n),console.log("🎓 Fill blanks test data cleared from cache")),R?.student_id){const ke=`test_completed_${R.student_id}_fill_blanks_${n}`;localStorage.setItem(ke,"true"),console.log("✅ Fill blanks test marked as completed in localStorage:",ke);const Oe=`retest1_${se}_fill_blanks_${n}`;localStorage.removeItem(Oe),localStorage.removeItem(ie)}if(R?.student_id){const ke=`student_results_table_${R.student_id}`;kn(ke,_e,Nn.student_results_table),console.log("🎓 Fill blanks test results cached with key:",ke)}setShowSubmitModal(!1),setTimeout(()=>{o&&o(W)},2e3)}else throw new Error(_e.message||"Failed to submit test")}catch(J){console.error("Error submitting test:",J),F("Error submitting test. Please try again.","error")}finally{m(!1)}},[d,t,n,s,a,i,y,L,D,O,A,F,o,R]),l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:l.jsxs(mt,{children:[p&&l.jsx(mt.Header,{children:l.jsx("div",{className:"flex items-center justify-center",children:l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[l.jsx(Sr,{size:"small"}),l.jsx("span",{children:"Submitting..."})]})})}),l.jsx(mt.Body,{children:r===!0?l.jsxs(l.Fragment,{children:[G(e,t),Z(t)]}):l.jsx(l.Fragment,{children:K(e,t)})}),r===!1&&w&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Answer"}),l.jsx("div",{className:"space-y-2",children:t.find(J=>J.id===w)?.options.filter(J=>J.trim().length>0).map((J,I)=>l.jsxs("button",{onClick:()=>{te(w,String.fromCharCode(65+I)),S(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 rounded-lg border border-gray-200",children:[l.jsxs("span",{className:"font-semibold text-blue-600 mr-2",children:[String.fromCharCode(65+I),")"]}),J]},I))}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx(tt,{onClick:()=>S(null),variant:"secondary",size:"sm",children:"Cancel"})})]})}),l.jsx(mt.Footer,{children:l.jsx("div",{className:"flex gap-3"})})]})})};let FW=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}};const l0=new FW;window.tokenManager=l0;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{l0.init()}):l0.init());const D8=async(e,t,r,n,s)=>{try{console.log("📊 Fetching teacher student results:",{teacherId:e,grade:t,className:r,semester:n,academicPeriodId:s});const i=await(await l0.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${e}&grade=${t}&class=${r}&semester=${n}&academic_period_id=${s}`)).json();if(i.success)return console.log("📊 Teacher student results loaded:",i.results.length,"results"),console.log("📊 Students loaded:",i.students?.length||0,"students"),{success:!0,results:i.results,students:i.students||[],count:i.results.length,student_count:i.student_count||0};throw new Error(i.error||"Failed to load teacher student results")}catch(a){return console.error("Error fetching teacher student results:",a),{success:!1,error:a.message,results:[]}}},R8=async(e,t)=>{try{console.log("📊 Fetching student results view:",{studentId:e,academicPeriodId:t});const r=t?`&academic_period_id=${t}`:"",s=await(await l0.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${e}${r}`)).json();if(s.success)return console.log("📊 Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},PW=async(e,t,r,n)=>{try{console.log("📊 Fetching class summary:",{teacherId:e,grade:t,className:r,academicPeriodId:n});const a=await(await l0.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log("📊 Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},DW=async(e,t,r,n,s,a={})=>{try{const i=await D8(e,t,r,n,s);if(!i.success)return i;let o=i.results;return a.subject&&(o=o.filter(c=>c.subject&&c.subject.toLowerCase().includes(a.subject.toLowerCase()))),a.testType&&(o=o.filter(c=>c.test_type===a.testType)),a.minScore!==void 0&&(o=o.filter(c=>c.score/c.max_score*100>=a.minScore)),a.maxScore!==void 0&&(o=o.filter(c=>c.score/c.max_score*100<=a.maxScore)),a.passed!==void 0&&(o=o.filter(c=>c.score>=c.passing_score===a.passed)),{success:!0,results:o,count:o.length,originalCount:i.results.length}}catch(i){return console.error("Error filtering teacher student results:",i),{success:!1,error:i.message,results:[]}}},RW=async(e,t,r={})=>{try{const n=await R8(e,t);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},IW={getTeacherStudentResults:D8,getStudentResultsView:R8,getClassSummary:PW,getTeacherStudentResultsFiltered:DW,getStudentResultsViewFiltered:RW};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MW=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),LW=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),ZE=e=>{const t=LW(e);return t.charAt(0).toUpperCase()+t.slice(1)},I8=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),OW=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var BW={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UW=C.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>C.createElement("svg",{ref:c,...BW,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:I8("lucide",s),...!a&&!OW(o)&&{"aria-hidden":"true"},...o},[...i.map(([d,f])=>C.createElement(d,f)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E0=(e,t)=>{const r=C.forwardRef(({className:n,...s},a)=>C.createElement(UW,{ref:a,iconNode:t,className:I8(`lucide-${MW(ZE(e))}`,`lucide-${e}`,n),...s}));return r.displayName=ZE(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $W=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],WW=E0("download",$W);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zW=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],HW=E0("maximize-2",zW);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GW=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],VW=E0("rotate-cw",GW);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KW=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],M8=E0("x",KW);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qW=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],XW=E0("zoom-in",qW);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YW=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],JW=E0("zoom-out",YW),QW=()=>{const[e,t]=C.useState({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,isDrawing:!1,currentLine:[],currentShape:null,isFullscreen:!1,preFullscreenState:null}),[r,n]=C.useState([]),s=C.useCallback(d=>{t(f=>({...f,...d}))},[]),a=C.useCallback(()=>{t({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,isDrawing:!1,currentLine:[],currentShape:null,isFullscreen:!1,preFullscreenState:null})},[]),i=C.useCallback(d=>{const f={x:d.x,y:d.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(p=>({...p,isDrawing:!0,currentLine:[f]})):["line","rectangle","circle"].includes(e.currentTool)&&t(p=>({...p,isDrawing:!0,currentShape:{type:e.currentTool,startX:d.x,startY:d.y,endX:d.x,endY:d.y,color:e.currentColor,thickness:e.currentThickness}}))},[e.currentTool,e.currentColor,e.currentThickness]),o=C.useCallback(d=>{if(!e.isDrawing)return;const f={x:d.x,y:d.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(p=>({...p,currentLine:[...p.currentLine,f]})):e.currentShape&&t(p=>({...p,currentShape:{...p.currentShape,endX:d.x,endY:d.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape]),c=C.useCallback(()=>{e.isDrawing&&(e.currentTool==="pencil"&&e.currentLine.length>0?n(d=>[...d,e.currentLine]):e.currentShape&&n(d=>[...d,e.currentShape]),t(d=>({...d,isDrawing:!1,currentLine:[],currentShape:null})))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape]);return{drawingState:e,setDrawingState:t,drawingData:r,setDrawingData:n,updateDrawingState:s,resetDrawingState:a,startDrawing:i,continueDrawing:o,finishDrawing:c}},e3={SCALE_DELTA:.05,CENTER_DELTA:20},Uh=e=>{if(e.length<2)return 0;const t=e[0],r=e[1];return Math.sqrt(Math.pow(r.clientX-t.clientX,2)+Math.pow(r.clientY-t.clientY,2))},Pd=e=>{if(e.length<2)return null;const t=e[0],r=e[1];return{x:(t.clientX+r.clientX)/2,y:(t.clientY+r.clientY)/2}},ZW=(e,t)=>{if(e.length!==2||!t)return null;const r=Uh(e),n=Uh(t),s=Pd(e),a=Pd(t);if(n===0)return null;const i=Math.abs(r/n-1),o=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));return i>e3.SCALE_DELTA?"zoom":o>e3.CENTER_DELTA?"pan":null},ez=e=>{let t;return function(){const r=arguments,n=this;t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e.apply(n,r),t=null})}},t3=(e,t)=>{const r=t.getPointerPosition();return{x:(r.x-t.x())/t.scaleX(),y:(r.y-t.y())/t.scaleY()}},Nd={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},oy={color:"#000000",thickness:2},r3=(e,t,r)=>({x:e.x,y:e.y,color:t||oy.color,thickness:r||oy.thickness}),tz=(e,t,r,n,s)=>({type:e,startX:t.x,startY:t.y,endX:r.x,endY:r.y,color:n||oy.color,thickness:s||oy.thickness}),rz=(e,t,r,n)=>{const[s,a]=C.useState({isActive:!1,type:null,lastDistance:null,lastCenter:null}),i=C.useCallback(y=>{if(e.currentTool===Nd.PAN)return;const v=y.target.getStage(),w=t3(y,v),S=r3(w,e.currentColor,e.currentThickness);e.currentTool===Nd.PENCIL?t(E=>({...E,isDrawing:!0,currentLine:[S]})):[Nd.LINE,Nd.RECTANGLE,Nd.CIRCLE].includes(e.currentTool)&&t(E=>({...E,isDrawing:!0,currentShape:tz(e.currentTool,w,w,e.currentColor,e.currentThickness)}))},[e.currentTool,e.currentColor,e.currentThickness,t]),o=C.useCallback(y=>{if(!e.isDrawing)return;const v=y.target.getStage(),w=t3(y,v),S=r3(w,e.currentColor,e.currentThickness);e.currentTool===Nd.PENCIL?t(E=>({...E,currentLine:[...E.currentLine,S]})):e.currentShape&&t(E=>({...E,currentShape:{...E.currentShape,endX:w.x,endY:w.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape,t]),c=C.useCallback(()=>{e.isDrawing&&(e.currentTool===Nd.PENCIL&&e.currentLine.length>0?n(y=>[...y,e.currentLine]):e.currentShape&&n(y=>[...y,e.currentShape]),t(y=>({...y,isDrawing:!1,currentLine:[],currentShape:null})))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,n,t]),d=C.useCallback(y=>{y.evt.preventDefault();const v=y.evt.touches;v.length===2?a({isActive:!0,type:null,lastDistance:Uh(v),lastCenter:Pd(v)}):v.length===1&&i(y)},[Uh,Pd,i]),f=C.useCallback(ez(y=>{y.evt.preventDefault();const v=y.evt.touches;if(v.length===2&&s.isActive){const w=ZW(v,s);if(w==="zoom"){const S=Uh(v),E=Pd(v),k=S/s.lastDistance,_=Math.max(.25,Math.min(1,e.zoom*k));t(N=>({...N,zoom:_,position:{x:E.x-(E.x-N.position.x)*(_/N.zoom),y:E.y-(E.y-N.position.y)*(_/N.zoom)}}))}else if(w==="pan"){const S=Pd(v),E=S.x-s.lastCenter.x,k=S.y-s.lastCenter.y;t(_=>({..._,position:{x:_.position.x+E,y:_.position.y+k}}))}a(S=>({...S,lastDistance:Uh(v),lastCenter:Pd(v)}))}else v.length===1&&o(y)}),[s,e.zoom,t,o]),p=C.useCallback(y=>{f(y)},[f]),m=C.useCallback(y=>{y.evt.preventDefault();const v=y.evt.touches;v.length===0?(c(),a({isActive:!1,type:null,lastDistance:null,lastCenter:null})):v.length===1&&a(w=>({...w,isActive:!1}))},[c]);return{handleTouchStart:d,handleTouchMove:p,handleTouchEnd:m}},nz=(e,t)=>{const[r,n]=C.useState(e.MIN),[s,a]=C.useState({x:0,y:0}),i=C.useCallback((m,y,v)=>{const w=Math.max(e.MIN,Math.min(e.MAX,m));if(y){const S=w/r,E={x:y.x-(y.x-s.x)*S,y:y.y-(y.y-s.y)*S};return{zoom:w,position:E}}else{const S=t.width*w,E=t.height*w,k={x:(v.width-S)/2,y:(v.height-E)/2};return{zoom:w,position:k}}},[r,s,e,t]),o=C.useCallback(()=>{const m=Math.min(r*(1+e.STEP),e.MAX);n(m)},[r,e]),c=C.useCallback(()=>{const m=Math.max(r/(1+e.STEP),e.MIN);n(m)},[r,e]),d=C.useCallback((m,y,v)=>{const w=i(m,y,v);n(w.zoom),a(w.position)},[i]),f=C.useCallback((m,y)=>{a(v=>({x:v.x+m,y:v.y+y}))},[]),p=C.useCallback(()=>{n(e.INITIAL),a({x:0,y:0})},[e.INITIAL]);return{zoom:r,setZoom:n,position:s,setPosition:a,handleZoomIn:o,handleZoomOut:c,handleZoomToPoint:d,handlePan:f,resetZoom:p}},sz=e=>{const[t,r]=C.useState([]),[n,s]=C.useState(0),a=C.useCallback(o=>{if(console.log("parseDrawingData - input drawing:",o),console.log("parseDrawingData - drawing.answers:",o?.answers),!o?.answers)return console.log("parseDrawingData - no answers found, returning empty array"),[];try{if(typeof o.answers=="string"){console.log("parseDrawingData - parsing string answers");const c=JSON.parse(o.answers);return console.log("parseDrawingData - parsed string result:",c),c}return Array.isArray(o.answers)?(console.log("parseDrawingData - answers is already array"),o.answers):(console.log("parseDrawingData - answers is neither string nor array, returning empty array"),[])}catch(c){return console.error("Error parsing drawing data:",c),[]}},[]),i=C.useCallback(o=>(console.log("processQuestions - input answers:",o),console.log("processQuestions - answers type:",typeof o),console.log("processQuestions - answers isArray:",Array.isArray(o)),Array.isArray(o)?(console.log("processQuestions - processing",o.length,"answers"),o.map((c,d)=>{console.log(`processQuestions - processing answer ${d}:`,c),console.log(`processQuestions - answer ${d} type:`,typeof c),console.log(`processQuestions - answer ${d} isArray:`,Array.isArray(c));let f=[];if(typeof c=="string")try{console.log(`processQuestions - parsing string answer ${d}`);const p=JSON.parse(c);console.log(`processQuestions - parsed answer ${d}:`,p),f=Array.isArray(p)?p:[p]}catch(p){console.error("Error parsing answer JSON:",p),f=[]}else Array.isArray(c)?(console.log(`processQuestions - answer ${d} is already array`),f=[c]):(console.log(`processQuestions - answer ${d} is object, wrapping in array`),f=[c]);return console.log(`processQuestions - final drawingData for answer ${d}:`,f),console.log("processQuestions - drawingData length:",f?.length),{questionNumber:d+1,drawingData:f}})):(console.log("processQuestions - answers is not array, returning empty array"),[])),[]);return C.useEffect(()=>{if(e){console.log("useDataParsing - drawing object:",e),console.log("useDataParsing - drawing.answers:",e.answers),console.log("useDataParsing - drawing.answers type:",typeof e.answers),console.log("useDataParsing - drawing.answers length:",e.answers?.length);const o=a(e);console.log("useDataParsing - parsed answers:",o),console.log("useDataParsing - parsed answers type:",typeof o),console.log("useDataParsing - parsed answers length:",o?.length);const c=i(o);console.log("useDataParsing - processed questions:",c),console.log("useDataParsing - processed questions length:",c?.length),c.length>0&&(console.log("useDataParsing - first question drawingData:",c[0]?.drawingData),console.log("useDataParsing - first question drawingData length:",c[0]?.drawingData?.length)),r(c),s(0)}},[e,a,i]),{questionsData:t,setQuestionsData:r,currentQuestionIndex:n,setCurrentQuestionIndex:s,parseDrawingData:a,processQuestions:i}},n3={MIN:.25,INITIAL:1},az=(e,t)=>{const[r,n]=C.useState(!1),[s,a]=C.useState(null),i=C.useCallback(()=>{document.fullscreenElement||(a({zoom:e.zoom,position:{...e.position}}),document.documentElement.requestFullscreen().then(()=>{n(!0),t(c=>({...c,zoom:n3.MIN,position:{x:0,y:0},isFullscreen:!0}))}).catch(c=>{console.error("Error entering fullscreen:",c)}))},[e.zoom,e.position,t]),o=C.useCallback(()=>{document.fullscreenElement&&document.exitFullscreen().then(()=>{n(!1),s?(t(c=>({...c,zoom:s.zoom,position:s.position,isFullscreen:!1})),a(null)):t(c=>({...c,zoom:n3.INITIAL,position:{x:0,y:0},isFullscreen:!1}))}).catch(c=>{console.error("Error exiting fullscreen:",c)})},[s,t]);return{isFullscreen:r,enterFullscreen:i,exitFullscreen:o}},Po={WIDTH:1536,HEIGHT:2048,ASPECT_RATIO:1536/2048},L8={MIN:.25,MAX:1,INITIAL:.25,STEP:.1},hc={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},iz=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500"],O8=C.forwardRef(({drawingData:e,drawingState:t,canvasSize:r,zoom:n,position:s,onTouchStart:a,onTouchMove:i,onTouchEnd:o},c)=>{const d=C.useRef(null),[f,p]=C.useState(.25),[m,y]=C.useState(null);C.useEffect(()=>{const F=r.width??r.WIDTH,A=r.height??r.HEIGHT,R=()=>{const T=d.current;if(!T)return;const D=T.clientWidth||1,L=T.clientHeight||1,O=Math.abs(t.rotation%180)===90,G=O?A:F,K=O?F:A,te=Math.min(D/(G||1),L/(K||1));p(Math.min(te,1))};return R(),window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[r.width,r.height,r.WIDTH,r.HEIGHT,t.rotation]);const v=C.useMemo(()=>{const F=d.current;if(!F||!m)return 0;const A=F.clientWidth||1,R=F.clientHeight||1,T=Math.min(A/Math.max(m.width,1),R/Math.max(m.height,1));return Math.min(T,L8.MAX)},[m]),w=C.useMemo(()=>Math.max(n,f||1),[n,f]),S=C.useMemo(()=>{const F=r.width??r.WIDTH,A=r.height??r.HEIGHT;if(!d.current)return{x:0,y:0};const R=d.current.clientWidth||1,T=d.current.clientHeight||1,D=(R-F*w)/2,L=(T-A*w)/2;return n<=f?{x:D,y:L}:{x:s.x!==void 0?s.x:D,y:s.y!==void 0?s.y:L}},[s,n,f,w,r.width,r.height,m,v]);C.useEffect(()=>{if(!Array.isArray(e)||e.length===0){y(null);return}let F=1/0,A=1/0,R=-1/0,T=-1/0;const D=(K,te)=>{Number.isFinite(K)&&Number.isFinite(te)&&(K<F&&(F=K),te<A&&(A=te),K>R&&(R=K),te>T&&(T=te))};if(e.forEach(K=>{if(Array.isArray(K))K.forEach(te=>D(te.x,te.y));else if(K&&typeof K=="object"){if(K.type==="line")D(K.startX,K.startY),D(K.endX,K.endY);else if(K.type==="rectangle")D(K.startX,K.startY),D(K.endX,K.endY);else if(K.type==="circle"){const te=Math.sqrt(Math.pow(K.endX-K.startX,2)+Math.pow(K.endY-K.startY,2))/2,Z=(K.startX+K.endX)/2,J=(K.startY+K.endY)/2;D(Z-te,J-te),D(Z+te,J+te)}}}),!Number.isFinite(F)||!Number.isFinite(A)||!Number.isFinite(R)||!Number.isFinite(T)){y(null);return}const L=16,O=Math.max(1,R-F+L*2),G=Math.max(1,T-A+L*2);y({minX:F-L,minY:A-L,width:O,height:G})},[e]),C.useEffect(()=>{console.log("CanvasViewer - drawingData:",e),console.log("CanvasViewer - drawingData length:",e?.length),e&&e.length>0&&console.log("CanvasViewer - first item:",e[0])},[e]),C.useEffect(()=>{const F=r.width??r.WIDTH,A=r.height??r.HEIGHT;console.log("CanvasViewer - canvas dimensions:",{width:F,height:A}),console.log("CanvasViewer - zoom:",n,"fitZoom:",f,"displayScale:",w),console.log("CanvasViewer - stagePosition:",S)},[r,n,f,w,S]);const E=(F,A)=>{if(console.log(`CanvasViewer - rendering element ${A}:`,F),Array.isArray(F))return console.log(`CanvasViewer - rendering line with ${F.length} points`),l.jsx(co,{points:F.flatMap(R=>[R.x,R.y]),stroke:F[0]?.color||"#000000",strokeWidth:F[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},A);if(F.type==="line")return l.jsx(co,{points:[F.startX,F.startY,F.endX,F.endY],stroke:F.color,strokeWidth:F.thickness,lineCap:"round"},A);if(F.type==="rectangle"){const R=Math.abs(F.endX-F.startX),T=Math.abs(F.endY-F.startY),D=Math.min(F.startX,F.endX),L=Math.min(F.startY,F.endY);return l.jsx(ri,{x:D,y:L,width:R,height:T,stroke:F.color,strokeWidth:F.thickness,fill:"transparent"},A)}else if(F.type==="circle"){const R=Math.sqrt(Math.pow(F.endX-F.startX,2)+Math.pow(F.endY-F.startY,2))/2,T=(F.startX+F.endX)/2,D=(F.startY+F.endY)/2;return l.jsx(r0,{x:T,y:D,radius:R,stroke:F.color,strokeWidth:F.thickness,fill:"transparent"},A)}return null},k=()=>{if(!t.isDrawing)return null;if(t.currentTool===hc.PENCIL&&t.currentLine.length>0)return l.jsx(co,{points:t.currentLine.flatMap(F=>[F.x,F.y]),stroke:t.currentColor,strokeWidth:t.currentThickness,tension:.5,lineCap:"round",lineJoin:"round"});if(t.currentShape){const{type:F,startX:A,startY:R,endX:T,endY:D,color:L,thickness:O}=t.currentShape;if(F===hc.LINE)return l.jsx(co,{points:[A,R,T,D],stroke:L,strokeWidth:O,lineCap:"round"});if(F===hc.RECTANGLE){const G=Math.abs(T-A),K=Math.abs(D-R),te=Math.min(A,T),Z=Math.min(R,D);return l.jsx(ri,{x:te,y:Z,width:G,height:K,stroke:L,strokeWidth:O,fill:"transparent"})}else if(F===hc.CIRCLE){const G=Math.sqrt(Math.pow(T-A,2)+Math.pow(D-R,2))/2,K=(A+T)/2,te=(R+D)/2;return l.jsx(r0,{x:K,y:te,radius:G,stroke:L,strokeWidth:O,fill:"transparent"})}}return null},_=t.isFullscreen?{position:"fixed",inset:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",zIndex:60}:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"},N={transform:`rotate(${t.rotation}deg)`,transformOrigin:"center center"};return l.jsx("div",{style:_,ref:d,children:l.jsx("div",{style:N,children:l.jsx(Yd,{ref:c,width:Math.max((r.width??r.WIDTH)||0,1536),height:Math.max((r.height??r.HEIGHT)||0,2048),scaleX:w,scaleY:w,x:S.x,y:S.y,onTouchStart:a,onTouchMove:i,onTouchEnd:o,children:l.jsxs(Xd,{children:[l.jsx(ri,{x:0,y:0,width:Math.max((r.width??r.WIDTH)||0,1536),height:Math.max((r.height??r.HEIGHT)||0,2048),fill:"white"}),e.map((F,A)=>(console.log(`CanvasViewer - mapping item ${A}:`,F),E(F,A))),k()]})})})})});O8.displayName="CanvasViewer";function oz({containerRef:e,canvasSize:t,rotation:r=0}){const[n,s]=C.useState(1),[a,i]=C.useState({x:0,y:0}),o=C.useRef({width:1,height:1}),c=C.useRef(.01),d=C.useRef(0),f=C.useRef(!1),p=C.useCallback(()=>{const N=t?.width??t?.WIDTH??0,F=t?.height??t?.HEIGHT??0,A=Math.abs(r%180)===90;return{width:A?F:N,height:A?N:F}},[t,r]),m=C.useCallback(()=>{const N=e?.current;if(!N)return{width:1,height:1};const F=N.clientWidth||1,A=N.clientHeight||1;return o.current={width:F,height:A},{width:F,height:A}},[e]),y=C.useCallback(()=>{const{width:N,height:F}=o.current,{width:A,height:R}=p(),T=N/Math.max(A,1),D=F/Math.max(R,1);return Math.min(T,D,1)*.98},[p]),v=C.useCallback(N=>{const{width:F,height:A}=o.current,{width:R,height:T}=p(),D=Math.max(c.current,Math.min(N,1.5));let L=(F-R*D)/2,O=(A-T*D)/2;const G=F-R*D,K=A-T*D;L=Math.min(Math.max(0,L),Math.max(0,G)),O=Math.min(Math.max(0,O),Math.max(0,K));try{console.log("[Camera] centerAtScale",{targetScale:N,clampedScale:D,container:{containerW:F,containerH:A},canvas:{canvasW:R,canvasH:T},translate:{x:L,y:O},rotation:r})}catch{}i({x:L,y:O}),s(D)},[p]),w=C.useCallback(()=>{const{width:N,height:F}=m(),{width:A,height:R}=p(),T=y();let D=(N-A*T)/2,L=(F-R*T)/2;const O=N-A*T,G=F-R*T;D=Math.min(Math.max(0,D),Math.max(0,O)),L=Math.min(Math.max(0,L),Math.max(0,G));try{console.log("[Camera] fitCanvas",{scale:T,container:{containerW:N,containerH:F},canvas:{canvasW:A,canvasH:R},translate:{x:D,y:L},rotation:r})}catch{}s(T),i({x:D,y:L}),c.current=T,f.current=!1},[p,m,y]),S=C.useCallback(()=>{const{width:N,height:F}=m(),{width:A,height:R}=p(),T=(N-A)/2,D=(F-R)/2;s(1),i({x:T,y:D})},[p,m]),E=C.useCallback((N,F)=>{const{width:A,height:R}=o.current,{width:T,height:D}=p(),L=Math.max(c.current,Math.min(N,1.5));if(F&&Number.isFinite(F.x)&&Number.isFinite(F.y)){const O={x:(F.x-a.x)/n,y:(F.y-a.y)/n},G=F.x-O.x*L,K=F.y-O.y*L;try{console.log("[Camera] zoomTo(pointer) ->",{from:n,to:L})}catch{}s(L),i({x:G,y:K}),d.current=Date.now()+400,f.current=!0}else{let O=(A-T*L)/2,G=(R-D*L)/2;const K=A-T*L,te=R-D*L;O=Math.min(Math.max(0,O),Math.max(0,K)),G=Math.min(Math.max(0,G),Math.max(0,te));try{console.log("[Camera] zoomTo(center) ->",{from:n,to:L})}catch{}s(L),i({x:O,y:G}),d.current=Date.now()+400,f.current=!0}},[p,n,a]),k=C.useCallback((N,F)=>{const A=n*N,{width:R,height:T}=o.current,D={x:R/2,y:T/2};E(A,F||D)},[n,E]),_=C.useCallback((N,F)=>{i(A=>({x:A.x+N,y:A.y+F})),d.current=Date.now()+200,f.current=!0},[]);return C.useEffect(()=>{const N=e?.current;if(!N)return;const F=new ResizeObserver(()=>{m();const A=y();if(c.current=A,!(Date.now()<d.current)&&!f.current){try{console.log("[Camera] resize centerAtScale",{scale:n})}catch{}v(n)}});return F.observe(N),m(),()=>F.disconnect()},[e,m,y,v,n]),C.useEffect(()=>{f.current=!1,c.current=y(),v(n)},[r,t?.width,t?.height,t?.WIDTH,t?.HEIGHT,y,v,n]),C.useMemo(()=>({scale:n,translate:a,setScale:s,setTranslate:i,centerAtScale:v,fitCanvas:w,oneToOne:S,zoomTo:E,zoomByFactor:k,panBy:_}),[n,a,v,w,S,E,k,_])}const pm=new Map,B8=C.forwardRef(({drawingData:e,canvasSize:t,rotation:r=0,onScaleChange:n,persistKey:s="viewer"},a)=>{const i=C.useRef(null),o=C.useRef(null),c=oz({containerRef:i,canvasSize:t,rotation:r}),[d,f]=C.useState({width:1,height:1}),p=C.useRef(null),m=C.useRef(null),[y,v]=C.useState(null);C.useEffect(()=>{console.log("[ViewerCanvas] drawingData received:",e),console.log("[ViewerCanvas] drawingData length:",e?.length),e&&e.length>0&&console.log("[ViewerCanvas] First drawing element:",e[0])},[e]),C.useEffect(()=>{typeof n=="function"&&n(c.scale);try{console.log("[ViewerCanvas] scale changed",{scale:c.scale})}catch{}if(s){const O=pm.get(s)||{};pm.set(s,{...O,scale:c.scale})}},[c.scale,n]),C.useEffect(()=>{if(s){const O=pm.get(s)||{};pm.set(s,{...O,translate:{x:c.translate.x,y:c.translate.y}})}},[s,c.translate.x,c.translate.y]),C.useImperativeHandle(a,()=>({zoomIn:O=>c.zoomByFactor(1.1,O),zoomOut:O=>c.zoomByFactor(1/1.1,O),fitCanvas:()=>c.fitCanvas(),oneToOne:()=>c.oneToOne(),getScale:()=>c.scale,getStage:()=>o.current,getPointerPosition:()=>o.current?.getPointerPosition?.(),exportPNGFullCanvas:()=>{const O=o.current;if(!O)return null;const G=t?.width??t?.WIDTH??1536,K=t?.height??t?.HEIGHT??2048,te={scaleX:O.scaleX(),scaleY:O.scaleY(),x:O.x(),y:O.y(),width:O.width(),height:O.height()},Z=p.current,J=m.current,I=Z?{x:Z.x(),y:Z.y(),scaleX:Z.scaleX(),scaleY:Z.scaleY()}:null,W=J?{x:J.x(),y:J.y(),rotation:J.rotation()}:null;try{return O.scale({x:1,y:1}),O.position({x:0,y:0}),O.size({width:G,height:K}),Z&&(Z.position({x:0,y:0}),Z.scale({x:1,y:1})),J&&(J.position({x:0,y:0}),J.rotation(0)),O.batchDraw(),O.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:G,height:K})}finally{J&&W&&(J.position({x:W.x,y:W.y}),J.rotation(W.rotation)),Z&&I&&(Z.position({x:I.x,y:I.y}),Z.scale({x:I.scaleX,y:I.scaleY})),O.scale({x:te.scaleX,y:te.scaleY}),O.position({x:te.x,y:te.y}),O.size({width:te.width,height:te.height}),O.batchDraw()}}}),[c]),C.useEffect(()=>{const O=i.current;if(!O)return;const G=()=>{f({width:O.clientWidth||1,height:O.clientHeight||1})};G();const K=new ResizeObserver(G);return K.observe(O),()=>K.disconnect()},[]),C.useEffect(()=>{if(!Array.isArray(e)||e.length===0){v(null);return}let O=1/0,G=1/0,K=-1/0,te=-1/0;const Z=(B,Y)=>{Number.isFinite(B)&&Number.isFinite(Y)&&(B<O&&(O=B),Y<G&&(G=Y),B>K&&(K=B),Y>te&&(te=Y))};if(e.forEach(B=>{if(Array.isArray(B))B.forEach(Y=>Z(Y.x,Y.y));else if(B&&typeof B=="object"){if(B.type==="line")Z(B.startX,B.startY),Z(B.endX,B.endY);else if(B.type==="rectangle")Z(B.startX,B.startY),Z(B.endX,B.endY);else if(B.type==="circle"){const Y=Math.hypot(B.endX-B.startX,B.endY-B.startY)/2,V=(B.startX+B.endX)/2,H=(B.startY+B.endY)/2;Z(V-Y,H-Y),Z(V+Y,H+Y)}}}),!Number.isFinite(O)||!Number.isFinite(G)||!Number.isFinite(K)||!Number.isFinite(te)){v(null);return}const J=16,I=Math.max(1,K-O+J*2),W=Math.max(1,te-G+J*2);v({minX:O-J,minY:G-J,width:I,height:W,centerX:O-J+I/2,centerY:G-J+W/2})},[e]);const w=C.useMemo(()=>{if(!y)return{scale:1,x:0,y:0};const O=t?.width??t?.WIDTH??1536,G=t?.height??t?.HEIGHT??2048,K=Math.min(O/Math.max(1,y.width),G/Math.max(1,y.height),1),te=y.width*K,Z=y.height*K,J=(O-te)/2,I=(G-Z)/2,W=J-y.minX*K,B=I-y.minY*K;return{scale:K,x:W,y:B}},[y,t?.width,t?.height,t?.WIDTH,t?.HEIGHT]),S=C.useRef(!1);C.useEffect(()=>{if(S.current)return;const O=s?pm.get(s):null;O&&Number.isFinite(O.scale)&&O.translate&&Number.isFinite(O.translate.x)&&Number.isFinite(O.translate.y)?(c.setScale(O.scale),c.setTranslate(O.translate)):c.fitCanvas(),S.current=!0},[s,c]),C.useEffect(()=>{try{console.log("[ViewerCanvas] rotation changed",{rotation:r,scale:c.scale,translate:c.translate})}catch{}c.fitCanvas()},[r]),C.useEffect(()=>{c.centerAtScale(c.scale)},[r]);const E=O=>{O.evt.preventDefault();const G=o.current;if(!G)return;const K=G.getPointerPosition(),te=Math.pow(1.0015,-O.evt.deltaY);c.zoomByFactor(te,K)},k=C.useRef(!1),_=C.useRef({x:0,y:0}),N=()=>{const O=i.current;if(!O)return 1;const G=O.clientWidth||1,K=O.clientHeight||1,te=t?.width??t?.WIDTH??1,Z=t?.height??t?.HEIGHT??1,J=Math.abs(r%180)===90,I=J?Z:te,W=J?te:Z,B=Math.min(G/I,K/W);return Math.min(B,1)},F=O=>{const G=N();c.scale<=G||(k.current=!0,_.current={x:O.evt.clientX,y:O.evt.clientY})},A=O=>{if(!k.current)return;const G=O.evt.clientX-_.current.x,K=O.evt.clientY-_.current.y;_.current={x:O.evt.clientX,y:O.evt.clientY},c.panBy(G,K)},R=()=>{k.current=!1},T=1536,D=2048,L=(O,G)=>{if(console.log(`[ViewerCanvas] Rendering drawing element ${G}:`,O),Array.isArray(O))return console.log(`[ViewerCanvas] Array item with ${O.length} points:`,O.slice(0,3)),l.jsx(co,{points:O.flatMap(K=>[K.x,K.y]),stroke:O[0]?.color||"#000000",strokeWidth:O[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},G);if(O?.type==="line")return l.jsx(co,{points:[O.startX,O.startY,O.endX,O.endY],stroke:O.color,strokeWidth:O.thickness,lineCap:"round"},G);if(O?.type==="rectangle"){const K=Math.abs(O.endX-O.startX),te=Math.abs(O.endY-O.startY),Z=Math.min(O.startX,O.endX),J=Math.min(O.startY,O.endY);return l.jsx(ri,{x:Z,y:J,width:K,height:te,stroke:O.color,strokeWidth:O.thickness,fill:"transparent"},G)}else if(O?.type==="circle"){const K=Math.sqrt(Math.pow(O.endX-O.startX,2)+Math.pow(O.endY-O.startY,2))/2,te=(O.startX+O.endX)/2,Z=(O.startY+O.endY)/2;return l.jsx(r0,{x:te,y:Z,radius:K,stroke:O.color,strokeWidth:O.thickness,fill:"transparent"},G)}return null};return l.jsx("div",{ref:i,style:{width:"100%",height:"100%",display:"block",backgroundColor:"transparent"},children:l.jsx(Yd,{ref:o,width:d.width,height:d.height,onWheel:E,onMouseDown:F,onMouseMove:A,onMouseUp:R,onMouseLeave:R,children:l.jsx(Xd,{children:l.jsx(gc,{ref:p,x:c.translate.x,y:c.translate.y,scaleX:c.scale,scaleY:c.scale,children:(()=>{const O=(r%360+360)%360;let G=0,K=0;O===90?G=D:O===180?(G=T,K=D):O===270&&(K=T);try{console.log("[ViewerCanvas] rotatedGroup offset",{rotation:r,norm:O,tx:G,ty:K,canvasW:T,canvasH:D})}catch{}return l.jsxs(gc,{ref:m,x:G,y:K,rotation:r,children:[l.jsx(ri,{x:0,y:0,width:T,height:D,fill:"white"}),l.jsx(gc,{x:w.x,y:w.y,scaleX:w.scale,scaleY:w.scale,children:Array.isArray(e)?(console.log("[ViewerCanvas] Rendering",e.length,"drawing elements"),e.map((te,Z)=>L(te,Z))):null})]})})()})})})})});B8.displayName="ViewerCanvas";const lz=({currentTool:e,currentColor:t,onToolChange:r,onColorChange:n})=>{const s=[{id:hc.PENCIL,icon:"✏️",label:"Pencil"},{id:hc.LINE,icon:"📏",label:"Line"},{id:hc.RECTANGLE,icon:"⬜",label:"Rectangle"},{id:hc.CIRCLE,icon:"⭕",label:"Circle"},{id:hc.PAN,icon:"✋",label:"Pan"}],a=iz;return l.jsxs("div",{className:"absolute top-4 left-4 flex flex-col space-y-2",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-2 flex flex-col space-y-1",children:[l.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Tools"}),s.map(i=>l.jsx("button",{className:`w-10 h-10 flex items-center justify-center rounded-lg transition-all duration-200 ${e===i.id?"bg-blue-500 text-white shadow-md":"bg-gray-100 hover:bg-gray-200 text-gray-700"}`,onClick:()=>r(i.id),title:i.label,children:l.jsx("span",{className:"text-lg",children:i.icon})},i.id))]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-2 flex flex-col space-y-1",children:[l.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Colors"}),l.jsx("div",{className:"grid grid-cols-2 gap-1",children:a.map(i=>l.jsx("button",{className:`w-8 h-8 rounded-lg border-2 transition-all duration-200 ${t===i?"border-gray-800 shadow-md scale-110":"border-gray-300 hover:border-gray-500 hover:scale-105"}`,style:{backgroundColor:i},onClick:()=>n(i),title:i},i))})]})]})},cz=({zoom:e,onZoomIn:t,onZoomOut:r,onRotate:n,onDownload:s,onFullscreen:a,isFullscreen:i})=>l.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 items-center justify-center",children:[l.jsx(tt,{onClick:t,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:l.jsx(XW,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(tt,{onClick:r,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:l.jsx(JW,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(tt,{onClick:n,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:l.jsx(VW,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(tt,{onClick:s,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:l.jsx(WW,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(tt,{onClick:a,variant:"secondary",size:"icon",className:"w-10 h-10",title:i?"Exit Fullscreen":"Enter Fullscreen",children:i?l.jsx(M8,{className:"w-4 h-4 mx-auto my-auto"}):l.jsx(HW,{className:"w-4 h-4 mx-auto my-auto"})})]}),uz=({currentQuestion:e,totalQuestions:t,onPrevious:r,onNext:n,drawingDataLength:s})=>t<=1?null:l.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(tt,{onClick:r,disabled:e===0,variant:"outline",size:"sm",children:"Previous"}),l.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",e+1," of ",t]}),l.jsx(tt,{onClick:n,disabled:e===t-1,variant:"outline",size:"sm",children:"Next"})]}),l.jsxs("div",{className:"text-sm text-gray-500",children:[s," lines"]})]})}),U8=({drawing:e,isOpen:t,onClose:r,onScoreChange:n,onMaxScoreChange:s,isTeacherView:a=!1})=>{const{drawingState:i,setDrawingState:o,drawingData:c,setDrawingData:d}=QW(),{questionsData:f,currentQuestionIndex:p,setCurrentQuestionIndex:m}=sz(e),{zoom:y,position:v,handleZoomIn:w,handleZoomOut:S}=nz(L8,Po),{isFullscreen:E,enterFullscreen:k,exitFullscreen:_}=az(i,o),{handleTouchStart:N,handleTouchMove:F,handleTouchEnd:A}=rz(i,o,c,d),R=C.useRef(null),T=C.useRef(null),[D,L]=C.useState(1),[O,G]=C.useState(""),[K,te]=C.useState("");C.useEffect(()=>{if(console.log("DrawingModal - questionsData:",f),console.log("DrawingModal - currentQuestionIndex:",p),f.length>0){const V=f[p]?.drawingData||[];console.log("DrawingModal - setting drawingData:",V),d(V)}},[f,p,d]),C.useEffect(()=>{t&&e&&(G(e.score?.toString()||""),te(e.max_score?.toString()||"100"))},[t,e]);const Z=()=>{p>0&&m(p-1)},J=()=>{p<f.length-1&&m(p+1)},I=V=>{o(H=>({...H,currentTool:V}))},W=V=>{o(H=>({...H,currentColor:V}))},B=()=>{o(V=>({...V,rotation:(V.rotation+90)%360}))},Y=()=>{if(a&&T.current){const se=T.current.exportPNGFullCanvas();if(!se)return;const ie=document.createElement("a");ie.href=se,ie.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie);return}const V=R.current;if(!V)return;const H=V.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:Po.WIDTH,height:Po.HEIGHT}),X=document.createElement("a");X.href=H,X.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(X),X.click(),document.body.removeChild(X)};return!t||!e?null:l.jsx(yi,{children:l.jsx(Qe.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:l.jsxs(Qe.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl h-[90vh] w-full mx-4 flex flex-col",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:V=>V.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[e.name," ",e.surname," - ",e.test_name]})]}),l.jsx(tt,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:l.jsx(M8,{className:"w-5 h-5"})})]}),f.length>1&&l.jsx(uz,{currentQuestion:p,totalQuestions:f.length,onPrevious:Z,onNext:J,drawingDataLength:f[p]?.drawingData?.length||0}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[l.jsxs("div",{className:"flex-1 min-h-0 relative overflow-hidden bg-gray-100 p-4",children:[a?l.jsx(B8,{ref:T,drawingData:c,canvasSize:{width:Po.WIDTH,height:Po.HEIGHT,WIDTH:Po.WIDTH,HEIGHT:Po.HEIGHT},rotation:i.rotation,onScaleChange:L}):l.jsx(O8,{ref:R,drawingData:c,drawingState:i,canvasSize:{width:Po.WIDTH,height:Po.HEIGHT,WIDTH:Po.WIDTH,HEIGHT:Po.HEIGHT},zoom:y,position:v,onTouchStart:N,onTouchMove:F,onTouchEnd:A}),!a&&l.jsx(lz,{currentTool:i.currentTool,currentColor:i.currentColor,onToolChange:I,onColorChange:W}),l.jsx(cz,{zoom:a?D:y,onZoomIn:()=>{if(a&&T.current){try{console.log("[ZoomButton] ZoomIn click (teacher)",{before:T.current.getScale?.()})}catch{}T.current.zoomIn(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomIn after",{after:T.current.getScale?.()})}catch{}},0)}else w()},onZoomOut:()=>{if(a&&T.current){try{console.log("[ZoomButton] ZoomOut click (teacher)",{before:T.current.getScale?.()})}catch{}T.current.zoomOut(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomOut after",{after:T.current.getScale?.()})}catch{}},0)}else S()},onRotate:B,onDownload:Y,onFullscreen:E?_:k,isFullscreen:E}),l.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white px-3 py-1 rounded-full text-sm",children:[Math.round((a?D:y)*100),"%"]})]}),!1]})]})})})},$8=({testType:e,testId:t,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:o=3})=>{const c=Bi(),{user:d,isAuthenticated:f}=Gn(),{testResults:p,loadTestResults:m}=$p(),[y,v]=C.useState(!0),[w,S]=C.useState(""),[E,k]=C.useState([]),[_,N]=C.useState([]),[F,A]=C.useState(null),[R,T]=C.useState([]),[D,L]=C.useState(0),[O,G]=C.useState(0),[K,te]=C.useState(!1),[Z,J]=C.useState(null);C.useEffect(()=>{I()},[e,t]),C.useEffect(()=>{!e&&!t&&(p&&p.results?(console.log("🎓 Using cached test results from TestContext"),N(p.results),v(!1)):B())},[e,t,p]);const I=C.useCallback(async()=>{console.log("🎓 Initializing Student Results...");try{if(v(!0),S(""),!f||!d){console.log("🎓 User not authenticated"),S("User not authenticated");return}if(d.role!==ei.STUDENT){console.error("🎓 Invalid user role for student results:",d.role),S("Access denied. Student role required.");return}console.log("🎓 Loading test results..."),await m(d?.student_id||d?.id||""),e&&t&&r&&(console.log("🎓 Loading specific test results..."),await W(e,t,r)),console.log("🎓 Student Results initialization complete!")}catch(ae){console.error("🎓 Error initializing student results:",ae),S("Failed to initialize student results")}finally{v(!1)}},[f,d,e,t,r,m]),W=C.useCallback(async(ae,Q,le)=>{console.log("🎓 Loading specific test results:",ae,Q);try{const _e=await Jr.getTestInfo(ae,Q);console.log("🎓 Test info loaded:",_e),A(_e);const ke=await Jr.getTestQuestions(ae,Q);console.log("🎓 Test questions loaded:",ke),T(ke);const Oe=ju(ke,le,ae).score,ge=ke.length>0?Math.round(Oe/ke.length*100):0;L(Oe),G(ge),console.log("🎓 Test results calculated:",{score:Oe,percentage:ge})}catch(_e){throw console.error("🎓 Error loading specific test results:",_e),_e}},[]),B=C.useCallback(async(ae=0)=>{console.log("🎓 Loading all student results using existing test results API...",ae>0?`(retry ${ae})`:"");try{if(!(d?.student_id||d?.sub))throw new Error("Student ID not found");const le=await Jr.getStudentTestResults();if(le.success){console.log("🎓 All student results loaded:",le.results.length,"results");const _e=le.results.map(ke=>({...ke,caught_cheating:ke.caught_cheating||!1,visibility_change_times:ke.visibility_change_times||0}));N(_e),J(new Date),le.results.length===0&&ae===0&&(console.log("🎓 No results found, retrying in 2 seconds..."),setTimeout(()=>{B(1)},2e3))}else throw new Error(le.error||"Failed to load student results")}catch(Q){console.error("🎓 Error loading all student results:",Q),S(Q.message)}},[d]),Y=C.useCallback(ae=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[ae]||ae,[]),V=C.useCallback(ae=>{if(!ae||ae.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No results available"})});const Q=a?ae:ae.slice(0,o);return l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),l.jsx("th",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Q.map((le,_e)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium text-gray-900",children:l.jsx("span",{className:"bg-blue-100 text-blue-800 px-0.5 sm:px-2 py-0.5 rounded text-xs",children:Y(le.subject)})}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-12 sm:max-w-none",children:le.teacher_name}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-16 sm:max-w-none",children:le.test_name}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500",children:l.jsx("div",{className:"flex flex-col items-center space-y-1",children:le.test_type==="drawing"?le.score!==null?l.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(le.score/le.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(le.score/le.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[le.score,"/",le.max_score," (",Math.round(le.score/le.max_score*100),"%)"]}):l.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):l.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(le.score/le.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(le.score/le.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[le.score,"/",le.max_score," (",Math.round(le.score/le.max_score*100),"%)"]})})}),l.jsx("td",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(le.submitted_at).toLocaleDateString()})]},_e))})]}),ae.length>o&&i&&l.jsx("div",{className:"text-center pt-4",children:l.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${ae.length-o} More`})})]})},[Y,a,o,i]),H=C.useCallback((ae,Q)=>{if(console.log("🔍 formatAnswer called with:",{answer:ae,testType:Q,answerType:typeof ae}),!ae)return"No answer";switch(Q){case"true_false":const le=typeof ae=="boolean"?ae:ae==="true";return console.log("🔍 Boolean answer processed:",le),le?"True":"False";case"multiple_choice":return ae.toUpperCase();case"input":return ae;case"word_matching":return typeof ae=="object"?Object.entries(ae).map(([_e,ke])=>`${_e} → ${ke}`).join(", "):ae;case"drawing":return"Drawing submitted";default:return ae}},[]),X=C.useCallback(()=>!F||!R||!r?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Test Results: ",F.test_name||F.title||"Test"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-blue-600",children:D}),l.jsx("p",{className:"text-sm text-gray-500",children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:R.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Total Questions"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-3xl font-bold ${O>=80?"text-green-600":O>=60?"text-yellow-600":"text-red-600"}`,children:[O,"%"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Score"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions Review"}),l.jsx("div",{className:"space-y-4",children:R.map((ae,Q)=>{const le=r[Q],_e=ap(ae,e),ke=o0(ae,le,e);return l.jsxs("div",{className:`border rounded-lg p-4 ${ke?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",Q+1]}),l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${ke?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ke?"Correct":"Incorrect"})]}),l.jsx("p",{className:"text-gray-700 mb-3",children:ae.question}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Your Answer:"}),l.jsx("p",{className:"text-sm text-gray-900",children:H(le,e)})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Correct Answer:"}),l.jsx("p",{className:"text-sm text-gray-900",children:H(_e,e)})]})]})]},Q)})})]})]}),[F,R,r,e,D,O,ap,o0,H]),se=C.useCallback(()=>{if(!_||_.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No test results available yet."})});const ae={};return _.forEach(Q=>{const le=Q.subject||"Unknown Subject";ae[le]||(ae[le]=[]),ae[le].push(Q)}),l.jsx("div",{className:"space-y-6",children:Object.entries(ae).map(([Q,le])=>l.jsxs("div",{className:"bg-white rounded-lg shadow",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Q})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:le.map((_e,ke)=>{const Oe=Math.round(_e.score/_e.max_score*100),ge=Oe>=80?"text-green-600":Oe>=60?"text-yellow-600":"text-red-600";return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:_e.test_name}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_e.teacher_name||"Unknown"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:l.jsxs("span",{className:ge,children:[_e.score,"/",_e.max_score," (",Oe,"%)"]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(_e.submitted_at).toLocaleDateString()})]},ke)})})]})})]},Q))})},[_]);C.useCallback(()=>{console.log("🎓 Clearing test data and returning to cabinet..."),A(null),T([]),setStudentAnswers(null),L(0),G(0),te(!1),n?n():c("/student")},[n,c]);const ie=C.useCallback(()=>{console.log("🎓 Navigating back to cabinet..."),n?n():c("/student")},[n,c]);return C.useCallback((ae,Q)=>{const le={id:Date.now(),message:ae,type:Q,timestamp:new Date};k(_e=>[..._e,le]),setTimeout(()=>{k(_e=>_e.filter(ke=>ke.id!==le.id))},xi.NOTIFICATION_DURATION)},[]),y?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Sr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Student Results..."})]})}):w?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:w}),l.jsx(tt,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{children:[y?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Sr,{size:"md"}),l.jsx("p",{className:"mt-2 text-gray-600",children:"Loading results..."})]}):w?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-red-500 text-4xl mb-2",children:"⚠️"}),l.jsx("p",{className:"text-red-600",children:w})]}):V(_),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:E.map(ae=>l.jsx(Wo,{type:ae.type,message:ae.message,onClose:()=>k(Q=>Q.filter(le=>le.id!==ae.id))},ae.id))})]}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",Z?Z.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[F&&l.jsx(tt,{variant:"outline",onClick:()=>te(!K),children:K?"Hide Details":"Show Details"}),l.jsx(tt,{variant:"outline",onClick:ie,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:K&&F?X():se()}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:E.map(ae=>l.jsx(Wo,{type:ae.type,message:ae.message,onClose:()=>k(Q=>Q.filter(le=>le.id!==ae.id))},ae.id))}),selectedDrawing&&l.jsx(U8,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},dz=({isMenuOpen:e,onToggleMenu:t,onShowPasswordChange:r})=>{const n=Bi(),{user:s,isAuthenticated:a,logout:i}=Gn(),{studentData:o,loadStudentData:c}=Ky(),{activeTests:d,testResults:f,loadActiveTests:p,loadTestResults:m,viewTestDetails:y,testDetailsModal:v,closeTestDetailsModal:w}=$p(),[S,E]=C.useState(!0),[k,_]=C.useState(""),[N,F]=C.useState([]),[A,R]=C.useState(null),[T,D]=C.useState(!1),[L,O]=C.useState(null),[G,K]=C.useState(null),[te,Z]=C.useState(new Set),[J,I]=C.useState(!1),[W,B]=C.useState(!1),[Y,V]=C.useState(!1),[H,X]=C.useState(!1);C.useEffect(()=>{se()},[]),C.useEffect(()=>()=>{V(!1)},[]),C.useEffect(()=>{if(Y){const ye=setTimeout(()=>{V(!1)},1e3);return()=>clearTimeout(ye)}},[Y]);const se=C.useCallback(async()=>{console.log("🎓 Initializing Student Cabinet...");try{if(E(!0),_(""),!a||!s){console.log("🎓 User not authenticated, redirecting to login"),n("/login");return}if(s.role!==ei.STUDENT){console.error("🎓 Invalid user role for student cabinet:",s.role),_("Access denied. Student role required.");return}console.log("🎓 Loading student data..."),await c(),console.log("🎓 Loading active tests...");try{localStorage.removeItem("student_active_tests_")}catch{}await p(),console.log("🎓 Loading test results..."),await m(s?.student_id||s?.id||""),console.log("🎓 Calculating average score..."),await ie(),console.log("🎓 Student Cabinet initialization complete!")}catch(ye){console.error("🎓 Error initializing student cabinet:",ye),_("Failed to initialize student cabinet")}finally{E(!1)}},[a,s,n]),ie=C.useCallback(async()=>{console.log("🎓 Calculating average score...");try{if(f&&f.length>0){const ye=f.reduce((Xe,lt)=>typeof lt.score=="number"&&typeof lt.max_score=="number"&&lt.max_score>0?Xe+Math.round(lt.score/lt.max_score*100):Xe,0),Ke=Math.round(ye/f.length);K(Ke),console.log("🎓 Average score calculated:",Ke)}}catch(ye){console.error("🎓 Error calculating average score:",ye)}},[f]);C.useEffect(()=>{if(Y){console.log("🎓 Skipping completed tests initialization during navigation");return}const ye=s?.student_id||s?.id;if(!ye){console.log("🎓 Student ID not available yet, skipping localStorage initialization");return}const Ke=new Set;for(let Xe=0;Xe<localStorage.length;Xe++){const lt=localStorage.key(Xe);if(lt&&lt.startsWith(`test_completed_${ye}_`)&&localStorage.getItem(lt)==="true"){const We=lt.replace(`test_completed_${ye}_`,"").split("_");if(We.length>=2){const Me=We[0],je=We.slice(1).join("_"),De=`${Me}_${je}`;Ke.add(De),console.log("🎓 Found completed test in localStorage:",De)}}}Z(Ke),X(!0),console.log("🎓 Initialized completed tests from localStorage:",Array.from(Ke))},[s?.student_id,s?.id,Y]),C.useEffect(()=>{console.log("🎓 testResults structure:",f);const ye=f?.results||f;if(console.log("🎓 resultsArray:",ye),ye&&ye.length>0){const Ke=s?.student_id||s?.id||"",Xe=new Set;ye.forEach(lt=>{const Ye=`${lt.test_type}_${lt.test_id}`;Xe.add(Ye),localStorage.setItem(`test_completed_${Ke}_${lt.test_type}_${lt.test_id}`,"true")}),Z(lt=>{const Ye=new Set([...lt,...Xe]);return console.log("🎓 Updated completed tests (merged):",Array.from(Ye)),Ye})}},[f,s?.student_id,s?.id]);const ae=C.useCallback(async(ye,Ke,Xe=!1,lt=null)=>{console.log("🎓 Checking test completion:",ye,Ke,"retestAvailable:",Xe);try{const Ye=s?.student_id||s?.id||"";if(Xe){console.log("🎓 Retest available from backend, checking attempt limits.");const De=[];for(let at=1;at<=10;at++){const wt=`retest_attempt${at}_${Ye}_${ye}_${Ke}`;localStorage.getItem(wt)==="true"&&De.push(wt)}const Ge=De.length,ct=lt?.retest_attempts_left||lt?.max_attempts||3;return console.log("🎓 Current attempts:",Ge,"Max attempts:",ct,"Attempt keys:",De),Ge>=ct?(console.log("🎓 Maximum retest attempts reached in localStorage"),!0):(console.log("🎓 Retest attempts available, allowing start."),!1)}const We=`test_completed_${Ye}_${ye}_${Ke}`,Me=localStorage.getItem(We);if(console.log("🎓 localStorage key:",We),console.log("🎓 localStorage value:",Me),ye==="word_matching"){console.log("🎓 Debug: All localStorage keys for student",Ye);for(let De=0;De<localStorage.length;De++){const Ge=localStorage.key(De);Ge&&Ge.includes(Ye)&&Ge.includes("word_matching")&&console.log("🎓 Found word_matching key:",Ge,"=",localStorage.getItem(Ge))}}if(Me==="true")return console.log("✅ Found completion status in local storage:",Me),!0;const je=f?.results||f;return je&&je.length>0&&(console.log("🎓 Checking database results:",je.length,"results"),je.some(Ge=>(console.log("🎓 Checking result:",Ge.test_type,Ge.test_id,"vs",ye,Ke),Ge.test_type===ye&&Ge.test_id===Ke)))?(console.log("✅ Found completion status in database results"),localStorage.setItem(We,"true"),!0):(console.log("❌ Test not completed according to local storage or database"),!1)}catch(Ye){return console.error("🎓 Error checking test completion:",Ye),!1}},[f,s?.student_id,s?.id]),Q=C.useCallback((ye,Ke)=>{const Xe={id:Date.now(),message:ye,type:Ke,timestamp:new Date};F(lt=>[...lt,Xe]),setTimeout(()=>{F(lt=>lt.filter(Ye=>Ye.id!==Xe.id))},xi.NOTIFICATION_DURATION)},[]),le=C.useCallback(async ye=>{console.log("🎓 Showing test details:",ye);try{await y(ye.test_type,ye.test_id,ye.test_name)}catch(Ke){console.error("Error loading test details:",Ke),Q("Failed to load test details","error")}},[y,Q]),_e=C.useCallback(ye=>{console.log("🎓 Starting test:",ye);const Ke=`${ye.test_type}_${ye.test_id}`;if(te.has(Ke)&&!ye?.retest_available){Q("This test has already been completed","warning");return}if(ye?.retest_available&&!te.has(Ke)){const Xe=s?.student_id||s?.id||"",lt=`retest1_${Xe}_${ye.test_type}_${ye.test_id}`;if(localStorage.setItem(lt,"true"),console.log("🎓 Set retest key:",lt),ye?.retest_assignment_id){const Ye=`retest_assignment_id_${Xe}_${ye.test_type}_${ye.test_id}`;localStorage.setItem(Ye,String(ye.retest_assignment_id))}}if(V(!0),console.log("🎓 Set isStartingTest to true for test:",ye.test_type),ye.test_type==="matching_type"){console.log("🎯 Redirecting to matching test page for testId:",ye.test_id),n(`/student/matching-test/${ye.test_id}`);return}if(ye.test_type==="word_matching"){console.log("🎯 Redirecting to word matching test page for testId:",ye.test_id),n(`/student/word-matching-test/${ye.test_id}`);return}n(`/student/test/${ye.test_type}/${ye.test_id}`)},[n,te,Q,s?.student_id,s?.id]),ke=C.useCallback(()=>{I(ye=>!ye)},[]),Oe=C.useCallback(()=>{B(ye=>!ye)},[]),ge=C.useCallback(async ye=>{if(console.log("🎓 Starting test:",ye),Y){console.log("🎓 Test already starting, ignoring click");return}try{if(await ae(ye.test_type,ye.test_id,ye?.retest_available,ye)&&!ye?.retest_available){Q("This test has already been completed","warning");return}_e(ye)}catch(Ke){console.error("🎓 Error starting test:",Ke),Q("Failed to start test. Please try again.","error")}},[ae,_e,Q,Y]);return C.useCallback(ye=>{console.log("🎓 Viewing test details:",ye),le(ye)},[le]),S?l.jsx(Qe.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsxs(Qe.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx(Sr,{size:"lg"}),l.jsx(Qe.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):k?l.jsx(Qe.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsx(Qe.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:l.jsxs(Qe.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[l.jsx(Qe.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:"⚠️"}),l.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-6",children:k}),l.jsx(tt,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs(Qe.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(Qe.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(Qe.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(Qe.div,{className:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:s?.name?.charAt(0)||"S"})})}),l.jsxs("div",{children:[l.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white",children:[s?.name," ",s?.surname]}),l.jsxs("p",{className:"text-blue-100 text-sm sm:text-base md:text-lg",children:["Grade ",s?.grade," - Class ",s?.class]})]})]}),l.jsxs(Qe.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:t,className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(Qe.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:e?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(yi,{children:e&&l.jsx(Qe.div,{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(Qe.button,{onClick:r,className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(Qe.button,{onClick:()=>{t(),i()},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),l.jsxs(Qe.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:l.jsx("div",{className:"lg:col-span-1 space-y-6",children:G!==null&&l.jsx(Qe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:l.jsxs(mt,{children:[l.jsx(mt.Header,{children:l.jsx(mt.Title,{children:"Average Score"})}),l.jsx(mt.Body,{children:l.jsxs(Qe.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[l.jsxs(Qe.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[G,"%"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Overall Performance"})]})})]})})})}),l.jsxs("div",{className:"space-y-6",children:[l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(mt,{children:[l.jsx(mt.Header,{children:l.jsx(mt.Title,{className:"text-center",children:"Active Tests"})}),l.jsx(mt.Body,{children:d&&d.length>0?l.jsxs("div",{className:"relative",children:[console.log("🎓 Rendering overlay, isStartingTest:",Y),Y&&l.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 border-blue-200",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Starting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait..."})]})}),l.jsxs("div",{className:"space-y-4",children:[(J?d:d.slice(0,3)).map((ye,Ke)=>l.jsx(Qe.div,{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:J?0:.7+Ke*.1,duration:.3},whileHover:{scale:1.02},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[l.jsx("h3",{className:"text-sm sm:text-lg font-medium text-gray-900 w-16 sm:w-auto break-words leading-tight line-clamp-2 sm:line-clamp-none",children:ye.test_name}),l.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:ye.subject}),l.jsx("span",{className:"text-gray-500",children:ye.teacher_name}),l.jsxs("span",{className:"text-gray-500",children:[l.jsx("span",{className:"sm:hidden",children:new Date(ye.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}),l.jsx("span",{className:"hidden sm:inline",children:new Date(ye.assigned_at).toLocaleDateString()})]})]})}),l.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const Xe=`${ye.test_type}_${ye.test_id}`,lt=te.has(Xe);return H?lt&&ye?.retest_available?l.jsx(tt,{variant:"primary",size:"sm",onClick:()=>ge(ye),disabled:Y,children:"Start Retest"}):lt?l.jsx(tt,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:"✓ Completed"}):(console.log("🎓 Button render, isStartingTest:",Y,"test:",ye.test_type),l.jsx(tt,{variant:"primary",size:"sm",onClick:()=>ge(ye),disabled:Y,children:"Start Test"})):l.jsx(tt,{variant:"secondary",size:"sm",disabled:!0,className:"bg-gray-100 text-gray-500 border-gray-200",children:"Loading..."})})()})]})},`${ye.test_type}_${ye.test_id}`)),d.length>3&&l.jsx("div",{className:"text-center pt-2",children:l.jsx("button",{onClick:ke,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:J?"Show Less":`Show ${d.length-3} More`})})]})]}):l.jsxs(Qe.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[l.jsx(Qe.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"},children:"📝"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Active Tests"}),l.jsx("p",{className:"text-gray-500",children:"No active tests available for your class at the moment."})]})})]})}),l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(mt,{children:[l.jsx(mt.Header,{children:l.jsx(mt.Title,{children:"Test Results"})}),l.jsx(mt.Body,{children:f&&f.showResults?l.jsx(Zb,{testResults:f,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(ye,Ke)=>{p(),setTestResults(null)},isLoading:S}):l.jsx($8,{compact:!0,showAll:W,onToggleShowAll:Oe,maxInitial:3})})]})})]})]}),l.jsx(P8,{isOpen:v.isOpen,onClose:w,testType:v.testType,testId:v.testId,testName:v.testName,questions:v.questions||[],isLoading:v.isLoading||!1}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:N.map(ye=>l.jsx(Wo,{type:ye.type,message:ye.message,onClose:()=>F(Ke=>Ke.filter(Xe=>Xe.id!==ye.id))},ye.id))})]})},fz=({testInfo:e,questions:t,testType:r,studentAnswers:n,onBackToCabinet:s,checkAnswerCorrectness:a,formatStudentAnswerForDisplay:i,getCorrectAnswer:o})=>{const[c,d]=C.useState(0),[f,p]=C.useState(0),[m,y]=C.useState(!0);if(C.useEffect(()=>{const S=()=>{try{const E=ju(t,n,r).score,k=e?.num_questions||t?.length||0,_=k>0?Math.round(E/k*100):0;d(E),p(_),y(!1)}catch(E){console.error("Error calculating test results:",E),d(0),p(0),y(!1)}};t&&t.length>0?S():y(!1)},[t,n,r,e,ju]),m)return l.jsx("div",{className:"flex justify-center items-center min-h-64",children:l.jsx("div",{className:"text-lg",children:"Calculating results..."})});const v=e?.num_questions||t?.length||0,w=e?.test_name||e?.title||"Test";return l.jsxs("div",{className:"test-results-page max-w-4xl mx-auto p-6 overflow-y-auto min-h-screen",children:[l.jsx(mt,{className:"mb-6",children:l.jsxs("div",{className:"results-header text-center",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Test Results: ",w]}),l.jsx("p",{className:"text-gray-600",children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),l.jsx(mt,{className:"mb-6",children:l.jsxs("div",{className:"results-summary",children:[l.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 text-center",children:["Your Score: ",c," / ",v," (",f,"%)"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:l.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${f>=80?"bg-green-500":f>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${f}%`}})}),l.jsx("div",{className:"text-center",children:l.jsx("p",{className:`text-lg font-medium ${f>=80?"text-green-600":f>=60?"text-yellow-600":"text-red-600"}`,children:f>=80?"Excellent!":f>=60?"Good job!":"Keep practicing!"})})]})}),t&&t.length>0&&l.jsx(mt,{className:"mb-6",children:l.jsxs("div",{className:"questions-review",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Question Review"}),l.jsx("div",{className:"space-y-4",children:t.map((S,E)=>{const k=n[String(S.question_id)]||"No answer";console.log("🔍 TestResultsDisplay - Question",E+1,":",{question:S,studentAnswer:k,testType:r});const _=a(S,k,r);return console.log("🔍 TestResultsDisplay - isCorrect result:",_),l.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${_?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[l.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[l.jsxs("h4",{className:"text-lg font-medium text-gray-800",children:["Question ",E+1]}),l.jsx("span",{className:`text-2xl font-bold ${_?"text-green-600":"text-red-600"}`,children:_?"✓":"✗"})]}),l.jsx("div",{className:"question-text mb-3",children:l.jsx("p",{className:"text-gray-700 font-medium",children:S.question})}),l.jsxs("div",{className:"answer-section space-y-2",children:[l.jsxs("p",{className:"student-answer",children:[l.jsx("strong",{className:"text-gray-600",children:"Your Answer:"})," ",l.jsx("span",{className:`font-medium ${_?"text-green-700":"text-red-700"}`,children:i(k,r,S)})]}),!_&&l.jsxs("p",{className:"correct-answer",children:[l.jsx("strong",{className:"text-gray-600",children:"Correct Answer:"})," ",l.jsx("span",{className:"text-green-700 font-medium",children:r==="multiple_choice"?String(S.correct_answer||"").toUpperCase():i(o(S,r),r,S)})]})]})]},S.question_id||E)})})]})}),l.jsx(mt,{children:l.jsx("div",{className:"results-actions text-center",children:l.jsx(tt,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-medium",children:"Back to Cabinet"})})})]})},hz=({onBackToCabinet:e,currentTest:t})=>{const r=Bi(),{user:n,isAuthenticated:s}=Gn(),{activeTests:a,loadActiveTests:i}=$p(),o=C.useCallback((Be,it,ut)=>{try{const Mt=`test_progress_${n?.student_id||n?.id||"unknown"}_${Be}_${it}`;localStorage.setItem(Mt,JSON.stringify(ut)),console.log(`Saved test progress for ${Be}_${it}:`,ut)}catch(St){console.error("Error saving test progress:",St)}},[n?.student_id,n?.id]),c=C.useCallback((Be,it)=>{try{const St=`test_progress_${n?.student_id||n?.id||"unknown"}_${Be}_${it}`,Mt=localStorage.getItem(St);return Mt?JSON.parse(Mt):null}catch(ut){return console.error("Error getting test progress:",ut),null}},[n?.student_id,n?.id]),d=C.useCallback((Be,it)=>{try{const ut=n?.student_id||n?.id||"unknown",St=`test_progress_${ut}_${Be}_${it}`;localStorage.removeItem(St);for(let Mt=0;Mt<localStorage.length;Mt++){const Ot=localStorage.key(Mt);Ot&&Ot.startsWith(`test_progress_${ut}_${Be}_${it}_`)&&(localStorage.removeItem(Ot),console.log(`🧹 Cleared individual question key: ${Ot}`))}console.log(`Cleared test progress for ${Be}_${it}`)}catch(ut){console.error("Error clearing test progress:",ut)}},[n?.student_id,n?.id]),[f,p]=C.useState(!0),[m,y]=C.useState(!1),[v,w]=C.useState(""),[S,E]=C.useState(!1),[k,_]=C.useState(""),[N,F]=C.useState([]),[A,R]=C.useState(t?"test":"list"),[T,D]=C.useState(null),[L,O]=C.useState(null),[G,K]=C.useState(null),[te,Z]=C.useState([]),[J,I]=C.useState([]),[W,B]=C.useState(0),[Y,V]=C.useState(0),[H,X]=C.useState(null),se=Cs.useRef(null),ie=Cs.useRef(null),[ae,Q]=C.useState(!1),[le,_e]=C.useState(!1),[ke,Oe]=C.useState(null),[ge,ye]=C.useState(null),{startTracking:Ke,stopTracking:Xe,getCheatingData:lt,clearData:Ye,isCheating:We,tabSwitches:Me}=Up(T?.test_type,T?.test_id,n?.student_id||n?.id);C.useEffect(()=>{(()=>{const it=[];for(let ut=0;ut<localStorage.length;ut++){const St=localStorage.key(ut);if(St&&St.startsWith("test_progress_")&&!St.includes("_51712_")&&!St.includes("_51736_")){const Mt=St.split("_");Mt.length===4&&Mt[0]==="test"&&Mt[1]==="progress"&&it.push(St)}}it.forEach(ut=>{localStorage.removeItem(ut),console.log("🧹 Cleared old cache key:",ut)})})()},[]),C.useEffect(()=>{je()},[]),C.useEffect(()=>{t&&(console.log("🎯 Auto-starting test from prop:",t),E(!0),ct(t))},[t]);const je=C.useCallback(async()=>{console.log("🎓 Initializing Student Tests...");try{if(p(!0),_(""),!s||!n){console.log("🎓 User not authenticated"),_("User not authenticated");return}if(n.role!==ei.STUDENT){console.error("🎓 Invalid user role for student tests:",n.role),_("Access denied. Student role required.");return}console.log("🎓 Loading active tests..."),await i(),console.log("🎓 Student Tests initialization complete!")}catch(Be){console.error("🎓 Error initializing student tests:",Be),_("Failed to initialize student tests")}finally{p(!1)}},[s,n,i]);C.useCallback(async()=>{console.log("🎓 Loading student active tests...");try{const Be=await Jr.getActiveTests();console.log("🎓 Active tests loaded:",Be);const it=Be.map(ut=>({...ut,subject_id:ut.subject_id||ut.subjectId,teacher_id:ut.teacher_id||ut.teacherId,is_active:ut.is_active!==void 0?ut.is_active:!0,created_at:ut.created_at||ut.createdAt,updated_at:ut.updated_at||ut.updatedAt}));return ye(new Date),it}catch(Be){throw console.error("🎓 Error loading active tests:",Be),Be}},[]),C.useCallback(async(Be,it)=>{console.log("🎓 Checking test completion:",Be,it);try{const ut=c(Be,it);return ut&&ut.completed}catch(ut){return console.error("🎓 Error checking test completion:",ut),!1}},[c]),C.useEffect(()=>{if(te.length>0&&T?.test_id){const Be=setTimeout(()=>{let it=!1;const ut=new Array(te.length).fill("");if(te.forEach((St,Mt)=>{const Te=`test_progress_${n?.student_id||n?.id||"unknown"}_${L}_${T?.test_id}_${St.question_id}`,ve=localStorage.getItem(Te);if(ve){const Ne=ve.replace(/^"(.*)"$/,"$1");ut[Mt]=Ne,it=!0}}),it){I(ut);const St=ut.filter(Ot=>Ot&&typeof Ot=="string"&&Ot.trim()!=="").length,Mt=te.length>0?St/te.length*100:0;B(Mt)}},100);return()=>clearTimeout(Be)}},[te,L,T?.test_id]);const De=C.useCallback(async(Be,it)=>{console.log("🎓 Marking test as completed:",Be,it);try{const ut=c(Be,it)||{};ut.completed=!0,ut.completedAt=new Date().toISOString(),o(Be,it,ut);const Mt=`test_completed_${n?.student_id||n?.id||""}_${Be}_${it}`;localStorage.setItem(Mt,"true"),console.log("🎓 Test completion marked in localStorage:",Mt),console.log("🎓 localStorage value after setting:",localStorage.getItem(Mt)),At("Test marked as completed","success")}catch(ut){console.error("🎓 Error marking test as completed:",ut),At("Failed to mark test as completed","error")}},[c,o]),Ge=C.useCallback(Be=>{console.log("🎓 Showing test details:",Be),Oe(Be),_e(!0)},[]),ct=C.useCallback(async Be=>{console.log("🎓 Starting test:",Be);let it=Date.now(),ut;try{w(""),y(!0),it=Date.now();const St=()=>{const cr=Date.now()-it,Pr=Math.max(0,250-cr);setTimeout(()=>{p(!1),y(!1)},Pr)};let Mt=!1;ut=setTimeout(()=>{Mt=!0,w("Loading is taking longer than expected...")},15e3);const Te=`test_completed_${n?.student_id||n?.id||""}_${Be.test_type}_${Be.test_id}`,ve=localStorage.getItem(Te)==="true";if(ve&&!Be?.retest_available){console.log("🎓 Test already completed, redirecting to main cabinet"),At("This test has already been completed","info"),r("/student");return}if(ve&&Be?.retest_available&&console.log("🎓 Test completed but retest available, allowing retest"),Be.test_type===ln.MATCHING){console.log("🎯 Redirecting to matching test page for testId:",Be.test_id),r(`/student/matching-test/${Be.test_id}`);return}if(Be.test_type===ln.WORD_MATCHING){console.log("🎯 Redirecting to word matching test page for testId:",Be.test_id),r(`/student/word-matching-test/${Be.test_id}`);return}D(Be),O(Be.test_type);const[Ne,Fe]=await Promise.all([Jr.getTestInfo(Be.test_type,Be.test_id),Jr.getTestQuestions(Be.test_type,Be.test_id)]);K(Ne);let dt=Fe;try{if(!!Ne?.is_shuffled){const Fr=n?.student_id||n?.id||"unknown",Pr=`${Fr}:${Be.test_type}:${Be.test_id}`,Cn=Array.from(Pr).reduce((pe,we)=>(pe<<5)-pe+we.charCodeAt(0),0)>>>0,ce=`test_shuffle_order_${Fr}_${Be.test_type}_${Be.test_id}`,be=localStorage.getItem(ce);if(be){const pe=JSON.parse(be),we=new Map(Fe.map(Ce=>[Ce.question_id,Ce]));dt=pe.map(Ce=>we.get(Ce)).filter(Boolean)}else{const we=function(oe){return function(){var me=oe+=1831565813;return me=Math.imul(me^me>>>15,me|1),me^=me+Math.imul(me^me>>>7,me|61),((me^me>>>14)>>>0)/4294967296}}(Cn);dt=[...Fe];for(let oe=dt.length-1;oe>0;oe--){const me=Math.floor(we()*(oe+1));[dt[oe],dt[me]]=[dt[me],dt[oe]]}const Ce=dt.map(oe=>oe.question_id);localStorage.setItem(ce,JSON.stringify(Ce))}}}catch(cr){console.error("Shuffle error (ignored):",cr)}Z(dt),St();let Et=c(Be.test_type,Be.test_id)?.answers||new Array(Fe.length).fill("");Fe.forEach((cr,Fr)=>{const Cn=`test_progress_${n?.student_id||n?.id||"unknown"}_${Be.test_type}_${Be.test_id}_${cr.question_id}`,ce=localStorage.getItem(Cn);console.log(`🔍 Checking individual answer for question ${cr.question_id}:`,ce),ce&&(Et[Fr]=ce,console.log(`✅ Loaded individual answer for question ${cr.question_id}:`,ce))}),console.log("🔍 Initial answers after loading individual saves:",Et),I(Et);const nr=Et.filter(cr=>cr&&typeof cr=="string"&&cr.trim()!=="").length,Qt=Fe.length>0?nr/Fe.length*100:0;console.log("🔍 Calculated progress:",nr,"answered out of",Fe.length,"=",Qt+"%"),B(Qt);const Zt=Number(Ne?.allowed_time||0),Nr=n?.student_id||n?.id||"unknown";if(se.current=`test_timer_${Nr}_${Be.test_type}_${Be.test_id}`,Zt>0)try{const cr=localStorage.getItem(se.current),Fr=Date.now();if(cr){const Pr=JSON.parse(cr),Cn=Math.floor((Fr-new Date(Pr.lastTickAt).getTime())/1e3),ce=Math.max(0,Number(Pr.remainingSeconds||Zt)-Math.max(0,Cn));V(ce),ie.current=Fr}else V(Zt),ie.current=Fr,localStorage.setItem(se.current,JSON.stringify({remainingSeconds:Zt,lastTickAt:new Date(Fr).toISOString(),startedAt:new Date(Fr).toISOString()}))}catch(cr){console.error("Timer cache init error:",cr),V(Zt)}else V(0);const Mr=new Date;X(Mr),console.log("⏱️ Test timer started at:",Mr.toISOString()),Ke(),console.log("🛡️ Anti-cheating tracking started"),R("test"),console.log("🎓 Test started successfully")}catch(St){console.error("🎓 Error starting test:",St),At("Failed to start test","error"),w("Failed to load test data. Please try again.")}finally{const St=Date.now()-it,Ot=Math.max(0,250-St);setTimeout(()=>{p(!1),y(!1)},Ot),E(!1);try{ut&&clearTimeout(ut)}catch{}}},[c]),at=C.useCallback(async()=>{if(!T||!G||!te||!J){At("No test data to submit","error");return}console.log("🎓 Submitting test:",T);try{Q(!0);const Be=ju(te,J,T.test_type),it=new Date,ut=H?Math.round((it-H)/1e3):0,St=H?H.toISOString():it.toISOString();console.log("⏱️ Test timing:",{startedAt:St,endTime:it.toISOString(),timeTaken:`${ut} seconds`});const Mt=lt();console.log("🛡️ Anti-cheating data for submission:",Mt);const Ot={};te.forEach((ve,Ne)=>{Ot[ve.question_id]=J[Ne]??""}),T.test_type==="drawing"&&(console.log("🎨 Drawing test answers being submitted:",J),console.log("🎨 Drawing test answers type:",typeof J[0]),console.log("🎨 Drawing test answers content:",J[0]));const Te=await Jr.submitTest(T.test_type,T.test_id,J,{time_taken:(()=>{const ve=Number(G?.allowed_time||0);return ve>0?Math.min(ut,ve):ut})(),started_at:St,submitted_at:it.toISOString(),answers_by_id:Ot,question_order:te.map(ve=>ve.question_id),caught_cheating:Mt.caught_cheating,visibility_change_times:Mt.visibility_change_times,retest_assignment_id:(()=>{const Ne=`retest_assignment_id_${n?.student_id||n?.id||""}_${T.test_type}_${T.test_id}`,Fe=localStorage.getItem(Ne);return Fe?Number(Fe):null})(),parent_test_id:T.test_id},n);if(console.log("🎓 Test submission result:",Te),Te.success){const ve=n?.student_id||n?.id||"",Ne=`retest1_${ve}_${T.test_type}_${T.test_id}`;if(localStorage.getItem(Ne)==="true"){const Et=T?.retest_attempts_left||T?.max_attempts||3;if((Te?.percentage_score??0)>=50){const Qt=`retest_attempt${Et}_${ve}_${T.test_type}_${T.test_id}`;localStorage.setItem(Qt,"true"),console.log("🎓 Passed retest, marking last-slot key:",Qt),localStorage.removeItem(Ne)}else{let Qt=1;for(let Nr=1;Nr<=10;Nr++){const Mr=`retest_attempt${Nr}_${ve}_${T.test_type}_${T.test_id}`;if(localStorage.getItem(Mr)!=="true"){Qt=Nr;break}}const Zt=`retest_attempt${Qt}_${ve}_${T.test_type}_${T.test_id}`;localStorage.setItem(Zt,"true"),console.log("🎓 Marked retest attempt as completed:",Zt),Qt>=Et&&localStorage.removeItem(Ne)}}if(console.log("🎓 Marking test as completed..."),await De(T.test_type,T.test_id),T.test_type!=="drawing"){console.log("🎓 Caching test results after submission...");const nr=`student_results_table_${n?.student_id||n?.id||"unknown"}`,{setCachedData:Qt,CACHE_TTL:Zt}=await $d(async()=>{const{setCachedData:Nr,CACHE_TTL:Mr}=await Promise.resolve().then(()=>FN);return{setCachedData:Nr,CACHE_TTL:Mr}},void 0);Qt(nr,Te,Zt.student_results_table),console.log("🎓 Test results cached with key:",nr)}else console.log("🎓 Drawing test submitted - not caching results (will appear after teacher grades)");console.log("🎓 Clearing test progress..."),d(T.test_type,T.test_id);try{const Et=n?.student_id||n?.id||"unknown",nr=`test_timer_${Et}_${T.test_type}_${T.test_id}`;localStorage.removeItem(nr);const Qt=`test_shuffle_order_${Et}_${T.test_type}_${T.test_id}`;localStorage.removeItem(Qt)}catch{}if(n?.student_id){const Et=`test_completed_${n.student_id}_${T.test_type}_${T.test_id}`;localStorage.setItem(Et,"true"),console.log("✅ Test marked as completed in localStorage:",Et)}try{const Et=n?.student_id||n?.id||"",nr=`retest1_${Et}_${T.test_type}_${T.test_id}`,Qt=`retest_assignment_id_${Et}_${T.test_type}_${T.test_id}`;localStorage.removeItem(nr),localStorage.removeItem(Qt),console.log("🧹 Cleared retest keys:",nr,Qt)}catch(Et){console.warn("Failed to clear retest keys:",Et)}console.log("🧹 Clearing test progress and anti-cheating data...");const dt=n?.student_id||n?.id||"unknown",Wt=[];for(let Et=0;Et<localStorage.length;Et++){const nr=localStorage.key(Et);nr&&(nr.startsWith(`test_progress_${dt}_`)||nr.startsWith(`anti_cheating_${dt}_`))&&Wt.push(nr)}Wt.forEach(Et=>{localStorage.removeItem(Et),console.log(`🧹 Cleared: ${Et}`)}),console.log("🛡️ Clearing anti-cheating data..."),Xe(),Ye(),T.test_type!=="drawing"?R("results"):r("/student"),At("Test submitted successfully!","success"),console.log("🎓 Test submitted successfully")}else throw console.error("🎓 Test submission failed:",Te.error),new Error(Te.error||"Failed to submit test")}catch(Be){console.error("🎓 Error submitting test:",Be),At("Failed to submit test","error")}finally{Q(!1)}},[T,G,te,J,De,d]);C.useCallback(()=>(console.log("🎓 Collecting test answers..."),J),[J]);const wt=C.useCallback(()=>{if(!te||!J)return;const Be=J.filter(ut=>ut&&typeof ut=="string"&&ut.trim()!=="").length,it=te.length>0?Be/te.length*100:0;if(B(it),console.log(`🎓 Progress updated: ${Be}/${te.length} questions answered (${Math.round(it)}%)`),T){const ut={answers:J,progress:it,lastSaved:new Date().toISOString()};o(T.test_type,T.test_id,ut)}},[te,J,T,o]);C.useEffect(()=>{wt()},[wt]);const Ft=C.useCallback(()=>{if(!J)return 0;const Be=J.filter(it=>it&&typeof it=="string"&&it.trim()!=="").length;return console.log("🎓 getAnsweredCount:",{studentAnswers:J,answeredCount:Be,totalQuestions:te?.length}),Be},[J,te]),Kt=C.useCallback(()=>{console.log("🎓 Navigating back to cabinet..."),e?e():r("/student")},[e,r]);C.useCallback(()=>{console.log("🎓 Showing test results..."),R("results")},[]);const bt=C.useCallback((Be,it,ut=null)=>{switch(console.log("🎓 Formatting student answer for display:",Be,"testType:",it,"question:",ut),it){case ln.MULTIPLE_CHOICE:if(Be.toString().startsWith("Option "))return Be;if(ut&&typeof Be=="string"&&!isNaN(parseInt(Be))){const St=parseInt(Be),Mt=`option_${String.fromCharCode(97+St)}`,Ot=ut[Mt];if(Ot)return console.log("🎓 Converted",Be,"to option text:",Ot),Ot;{const Te=String.fromCharCode(65+St);return console.log("🎓 Converted",Be,"to",Te),Te}}else{if(typeof Be=="string"&&isNaN(parseInt(Be)))return console.log("🎓 Already formatted text:",Be),Be;{const St=String.fromCharCode(65+parseInt(Be));return console.log("🎓 Converted",Be,"to",St),St}}case ln.TRUE_FALSE:return Be==="true"?"True":"False";case ln.INPUT:return Be;case ln.MATCHING:return typeof Be=="object"?JSON.stringify(Be):Be;case ln.WORD_MATCHING:return typeof Be=="object"?JSON.stringify(Be):Be;case ln.DRAWING:return Be&&Be.trim()!==""?"Drawing submitted":"No drawing";case ln.FILL_BLANKS:return Be;default:return console.warn("🎓 Unknown test type for answer formatting:",it),Be}},[]),At=C.useCallback((Be,it)=>{const ut={id:Date.now(),message:Be,type:it,timestamp:new Date};F(St=>[...St,ut]),setTimeout(()=>{F(St=>St.filter(Mt=>Mt.id!==ut.id))},xi.NOTIFICATION_DURATION)},[]);C.useEffect(()=>{wt()},[wt]),C.useEffect(()=>{if(A!=="test")return;const Be=Number(G?.allowed_time||0);if(!Be)return;const it=setInterval(()=>{V(ut=>{const St=Math.max(0,ut-1);try{const Mt=Date.now();ie.current||(ie.current=Mt),se.current&&localStorage.setItem(se.current,JSON.stringify({remainingSeconds:St,lastTickAt:new Date(Mt).toISOString(),startedAt:H?H.toISOString():new Date(Mt-(Be-St)*1e3).toISOString()}))}catch{}return St===0&&at(),St})},1e3);return()=>clearInterval(it)},[A,G?.allowed_time,at,H]);const gt=C.useCallback((Be,it)=>{if(!Be)return null;const ut=(St,Mt)=>{const Ot=[...J];Ot[it]=Mt,I(Ot),console.log(`🎓 Answer changed: question ${St} = ${Mt}`),console.log("🎓 Updated studentAnswers:",Ot)};switch(T.test_type){case ln.TRUE_FALSE:return l.jsx(yW,{question:Be,questionIndex:it,studentAnswer:J[it]||"",onAnswerChange:ut,mode:"student",testId:T?.test_id,testType:L,displayNumber:it+1});case ln.MULTIPLE_CHOICE:return l.jsx(vW,{question:Be,questionIndex:it,studentAnswer:J[it]||"",onAnswerChange:ut,mode:"student",testId:T?.test_id,testType:L,displayNumber:it+1});case ln.INPUT:return l.jsx(wW,{question:Be,questionIndex:it,studentAnswer:J[it]||"",onAnswerChange:ut,mode:"student",testId:T?.test_id,testType:L,displayNumber:it+1});case ln.MATCHING:return console.error("Matching test reached renderQuestion - this should not happen"),l.jsxs("div",{className:"text-center p-8",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),l.jsx(tt,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case ln.DRAWING:return l.jsx(EW,{question:Be,questionIndex:it,studentAnswer:J[it]||"",onAnswerChange:ut,mode:"student",testId:T?.test_id,testType:L});case ln.FILL_BLANKS:return it===0?l.jsx(jW,{testText:G?.test_text,blanks:(te||[]).map((St,Mt)=>({id:St.question_id||Mt+1,options:St.blank_options||[],correct_answer:St.correct_answers?.[0]||St.correct_answer,question:St.question_json||""})),separateType:G?.separate_type,testId:T?.test_id,testName:G?.test_name||T?.test_name,teacherId:G?.teacher_id||T?.teacher_id,subjectId:G?.subject_id||T?.subject_id,onTestComplete:at,onAnswerChange:(St,Mt)=>{const Ot=te.findIndex(Te=>Te.question_id===St);if(Ot!==-1){const Te=[...J];Te[Ot]=Mt,I(Te),console.log(`🎓 Fill Blanks answer changed: question ${St} = ${Mt}`)}}},`fill-blanks-${T?.test_id}-${G?.test_name}`):null;default:return l.jsx("div",{children:"Unsupported question type"})}},[T,J,L]);function kt(){return!T||!G||!te?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:G.test_name||G.title||"Test"})}),l.jsx("div",{className:"mb-4",children:l.jsx(AW,{answeredCount:Ft(),totalQuestions:te.length,percentage:Math.round(W),timeElapsed:Number(G?.allowed_time||0)>0?Y:0,showDetails:!0})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Answer all questions below:"}),l.jsx("div",{className:"space-y-8",children:te.map((Be,it)=>l.jsx("div",{className:"question-container",children:gt(Be,it)},Be.question_id||it))})]}),l.jsx("div",{className:"flex justify-center",children:l.jsx(tt,{variant:"primary",size:"lg",onClick:at,disabled:ae||Ft()<te.length,loading:ae,children:ae?"Submitting...":`Submit Test (${Ft()}/${te.length})`})})]})}if(f)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Sr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:t?"Starting Test...":"Loading Student Tests..."})]})});if(k)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:k}),l.jsx(tt,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Test"})}),l.jsx(tt,{variant:"outline",onClick:Kt,children:"Back to Cabinet"})]})})}),We&&A==="results"&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",Me," times during the test."]})})]})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 overflow-y-auto",children:[!t&&A==="list"&&Gt(),A==="test"&&kt(),A==="results"&&$t()]}),A==="test"&&m&&l.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-[1px] flex flex-col items-center justify-center z-50",children:[l.jsx(Sr,{size:"lg"}),l.jsx("p",{className:"mt-3 text-gray-700",children:"Preparing your test…"}),v&&l.jsx("div",{className:"mt-3 text-sm text-gray-500",children:v})]}),l.jsx(P8,{isOpen:le,onClose:()=>_e(!1),testType:ke?.test_type,testId:ke?.test_id,testName:ke?.test_name,questions:ke?.questions,isLoading:f}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:N.map(Be=>l.jsx(Wo,{type:Be.type,message:Be.message,onClose:()=>F(it=>it.filter(ut=>ut.id!==Be.id))},Be.id))})]});function Gt(){return!a||a.length===0?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No active tests available for your class."})}):l.jsx("div",{className:"space-y-6",children:a.map((Be,it)=>l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Be.test_name}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Subject:"})," ",Be.subject]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Teacher:"})," ",Be.teacher_name]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Type:"})," ",Be.test_type]})]}),l.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Assigned: ",new Date(Be.assigned_at).toLocaleDateString()]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(tt,{variant:"outline",onClick:()=>Ge(Be),disabled:S||f,children:"View Details"}),l.jsx(tt,{variant:"primary",onClick:()=>ct(Be),disabled:S||f,children:S?"Starting...":"Start Test"})]})]})},it))})}function $t(){if(!T||!G||!te||!J)return null;const Be={};return J.forEach((it,ut)=>{if(te[ut]){const St=te[ut].question_id||te[ut].id||ut;Be[String(St)]=it,console.log("🔍 Converting answer:",{index:ut,questionId:St,answer:it,question:te[ut]})}}),console.log("🔍 Final answersObject:",Be),console.log("🔍 Questions structure:",te.map(it=>({id:it.question_id,correct_answer:it.correct_answer}))),l.jsx(fz,{testInfo:G,questions:te,testType:T.test_type,studentAnswers:Be,onBackToCabinet:Kt,checkAnswerCorrectness:o0,formatStudentAnswerForDisplay:bt,getCorrectAnswer:ap})}},gz=()=>{const{testId:e}=p2(),t=Bi(),{user:r}=Gn(),{makeAuthenticatedRequest:n}=Ho(),{showNotification:s}=Oa(),[a,i]=C.useState(null),[o,c]=C.useState(!0),[d,f]=C.useState(null),[p,m]=C.useState(null),[y,v]=C.useState(!1);Up("matching_type",a?.id);const w=C.useCallback(()=>{if(!r?.student_id||!e)return!1;const N=`test_completed_${r.student_id}_matching_type_${e}`,F=localStorage.getItem(N)==="true",A=`retest1_${r.student_id}_matching_type_${e}`,R=localStorage.getItem(A)==="true";return F&&!R?(console.log("🎓 Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),t("/student"),!0):!1},[r?.student_id,e,t,s]),S=C.useCallback(async()=>{if(!e){f("Test ID is required"),c(!1);return}if(!w())try{c(!0),f(null);const N=await n(`/.netlify/functions/get-matching-type-test?test_id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!N.ok)throw new Error("Failed to load test data");const F=await N.json();if(!F.success)throw new Error(F.message||"Failed to load test");const A=F.data;console.log("🔍 Test data from get-matching-type-test:",A);const R=await n(`/.netlify/functions/get-test-questions?test_id=${e}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!R.ok)throw new Error("Failed to load test questions");const T=await R.json();if(!T.success)throw new Error(T.message||"Failed to load test questions");console.log("🔍 Questions data from get-test-questions:",T);const D={id:A.test_id,test_name:A.test_name,teacher_id:A.teacher_id,subject_id:A.subject_id,image_url:A.image_url,image:null,blocks:(()=>{if(Array.isArray(T.questions)&&T.questions.length>0){const L=T.questions[0];return Array.isArray(L.blocks)?L.blocks.map((O,G)=>{let K=O.block_coordinates||O.coordinates||(typeof O.x=="number"?{x:O.x,y:O.y,width:O.width,height:O.height}:null);if(typeof K=="string")try{K=JSON.parse(K)}catch{K=null}return(!K||typeof K!="object")&&(K={x:0,y:0,width:30,height:10}),K={x:(typeof K.x=="number"?K.x:Number(K.x))||0,y:(typeof K.y=="number"?K.y:Number(K.y))||0,width:(typeof K.width=="number"?K.width:Number(K.width))||30,height:(typeof K.height=="number"?K.height:Number(K.height))||10},{id:O.block_id||O.question_id||O.id||G+1,word:O.word||`Word ${G+1}`,coordinates:K,hasArrow:!!O.has_arrow,arrow:O.arrow||null}}):T.questions.map(O=>{console.log("🔍 Processing question:",O);let G;try{G=typeof O.block_coordinates=="string"?JSON.parse(O.block_coordinates):O.block_coordinates}catch{G={x:0,y:0,width:100,height:100}}return(!G||typeof G!="object")&&(G={x:0,y:0,width:100,height:100}),G={x:(typeof G.x=="number"?G.x:Number(G.x))||0,y:(typeof G.y=="number"?G.y:Number(G.y))||0,width:(typeof G.width=="number"?G.width:Number(G.width))||100,height:(typeof G.height=="number"?G.height:Number(G.height))||100},{id:O.question_id,word:O.word,coordinates:G,hasArrow:O.has_arrow,arrow:O.arrow}})}return[]})(),words:(()=>{if(Array.isArray(T.questions)&&T.questions.length>0){const L=T.questions[0];if(Array.isArray(L.words)){const O=L.words,G=Array.isArray(L.blocks)?L.blocks:[];return typeof O[0]=="string"?O.map((te,Z)=>({id:`w_${G[Z]?.question_id||G[Z]?.block_id||T.questions[Z]?.question_id||Z+1}_${Z}`,word:String(te),blockId:null,isPlaced:!1,isCorrect:!1})):O.map((te,Z)=>({id:`w_${te.question_id||te.id||Z+1}_${Z}`,word:te.word||String(te.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return T.questions.map(O=>({id:`w_${O.question_id}`,word:O.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:A.arrows?A.arrows.map(L=>(console.log("🔍 Processing arrow:",L),{id:L.id,questionId:L.question_id,blockId:L.block_id||L.question_id,start:{x:Number(L.start_x)||0,y:Number(L.start_y)||0},end:{x:Number(L.end_x)||0,y:Number(L.end_y)||0},rel_start_x:L.rel_start_x!==null?Number(L.rel_start_x):null,rel_start_y:L.rel_start_y!==null?Number(L.rel_start_y):null,rel_end_x:L.rel_end_x!==null?Number(L.rel_end_x):null,rel_end_y:L.rel_end_y!==null?Number(L.rel_end_y):null,image_width:L.image_width?Number(L.image_width):null,image_height:L.image_height?Number(L.image_height):null,style:(typeof L.style=="string"?JSON.parse(L.style):L.style)||{color:"#dc3545",thickness:3}})):[]};if(A.image_url){const L=new Image;L.crossOrigin="anonymous",L.onload=()=>{D.image=L,i(D),c(!1)},L.onerror=()=>{console.warn("Failed to load test image"),i(D),c(!1)},L.src=A.image_url}else i(D),c(!1)}catch(N){console.error("Error loading test data:",N),f(N.message||"Failed to load test"),c(!1)}},[e,n]);C.useEffect(()=>{r?.student_id&&S()},[S,r?.student_id]);const E=C.useCallback(async N=>{console.log("Test completed:",N),s("Test completed successfully!","success");const F=parseInt(N)||0,A=a?.blocks?.length||a?.words?.length||0,R=A>0?Math.round(F/A*100):0,T={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"matching_type",score:F,totalQuestions:A,percentage:R,passed:R>=60,questionAnalysis:a?.questions?.map((D,L)=>({questionNumber:L+1,isCorrect:L<F,userAnswer:L<F?`Matched: ${D.word}`:"Not answered",correctAnswer:`Match: ${D.word}`}))||Array.from({length:A},(D,L)=>({questionNumber:L+1,isCorrect:L<F,userAnswer:L<F?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log("🎯 Using test results data:",T),m(T),v(!0)},[a,s]),k=C.useCallback(()=>{t("/student")},[t]),_=C.useCallback(()=>{v(!1),m(null),S()},[S]);return o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(mt,{className:"max-w-md w-full",children:l.jsxs(mt.Body,{className:"text-center",children:[l.jsx(Sr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):d?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(mt,{className:"max-w-md w-full",children:l.jsxs(mt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:d}),l.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):a?y&&p?l.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:l.jsx(Zb,{testResults:p,onBackToCabinet:k,onRetakeTest:_,isLoading:!1})}):l.jsx(_W,{testData:a,onTestComplete:E,onBackToCabinet:k}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(mt,{className:"max-w-md w-full",children:l.jsxs(mt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:"📝"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),l.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},mz=()=>{const{testId:e}=p2(),t=Bi(),{user:r}=Gn(),{makeAuthenticatedRequest:n}=Ho(),{showNotification:s}=Oa(),[a,i]=C.useState(null),[o,c]=C.useState(!0),[d,f]=C.useState(null),[p,m]=C.useState(null),[y,v]=C.useState(!1),w=C.useCallback(()=>{if(!r?.student_id||!e)return!1;const _=`test_completed_${r.student_id}_word_matching_${e}`,N=`retest1_${r.student_id}_word_matching_${e}`;return localStorage.getItem(N)==="true"?!1:localStorage.getItem(_)==="true"},[r?.student_id,e]),S=C.useCallback(async()=>{if(!e){f("Test ID is required"),c(!1);return}if(w()){s("This test has already been completed","warning"),t("/student");return}c(!0),f(null);try{const _=`word_matching_test_${e}`,N=Mn(_);if(N){if(console.log("🎯 Word matching test loaded from cache:",N),N.id){let R=N;if(Array.isArray(R.rightWords)&&Array.isArray(R.correctPairs)){const T=R.rightWords.map((G,K)=>K);for(let G=T.length-1;G>0;G--){const K=Math.floor(Math.random()*(G+1));[T[G],T[K]]=[T[K],T[G]]}const D=T.map(G=>R.rightWords[G]),L=new Map(T.map((G,K)=>[G,K])),O=R.correctPairs.map(G=>L.get(G));R={...R,rightWords:D,correctPairs:O}}i(R)}else{let T={id:N.test_id,test_id:N.test_id,test_name:N.test_name,teacher_id:N.teacher_id,subject_id:N.subject_id,num_questions:N.num_questions,interaction_type:N.interaction_type,passing_score:N.passing_score,created_at:N.created_at,updated_at:N.updated_at,leftWords:N.leftWords,rightWords:N.rightWords,correctPairs:N.correctPairs,originalPairs:N.originalPairs};if(Array.isArray(T.rightWords)&&Array.isArray(T.correctPairs)){const D=T.rightWords.map((K,te)=>te);for(let K=D.length-1;K>0;K--){const te=Math.floor(Math.random()*(K+1));[D[K],D[te]]=[D[te],D[K]]}const L=D.map(K=>T.rightWords[K]),O=new Map(D.map((K,te)=>[K,te])),G=T.correctPairs.map(K=>O.get(K));T={...T,rightWords:L,correctPairs:G}}i(T)}c(!1);return}const A=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${e}`)).json();if(A.success){const R={id:A.data.test_id,test_id:A.data.test_id,test_name:A.data.test_name,teacher_id:A.data.teacher_id,subject_id:A.data.subject_id,num_questions:A.data.num_questions,interaction_type:A.data.interaction_type,passing_score:A.data.passing_score,created_at:A.data.created_at,updated_at:A.data.updated_at,leftWords:A.data.leftWords,rightWords:A.data.rightWords,correctPairs:A.data.correctPairs,originalPairs:A.data.originalPairs};let T=R;if(Array.isArray(T.rightWords)&&Array.isArray(T.correctPairs)){const D=T.rightWords.map((K,te)=>te);for(let K=D.length-1;K>0;K--){const te=Math.floor(Math.random()*(K+1));[D[K],D[te]]=[D[te],D[K]]}const L=D.map(K=>T.rightWords[K]),O=new Map(D.map((K,te)=>[K,te])),G=T.correctPairs.map(K=>O.get(K));T={...T,rightWords:L,correctPairs:G}}i(T),kn(_,T,Nn.word_matching_test),console.log("🎯 Word matching test loaded from API and cached:",R)}else throw new Error(A.message||"Failed to load test")}catch(_){console.error("Error loading word matching test:",_),f(_.message),s("Failed to load test: "+_.message,"error")}finally{c(!1)}},[e,w,n,s,t]),E=C.useCallback(async _=>{console.log("Test completed:",_),s("Test completed successfully!","success");const N=parseInt(_)||0,F=a?.num_questions||0,A=F>0?Math.round(N/F*100):0,R={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"word_matching",score:N,totalQuestions:F,percentage:A,passed:A>=60,questionAnalysis:Array.isArray(a?.correctPairs)?a.correctPairs.map((T,D)=>({questionNumber:D+1,isCorrect:D<N,userAnswer:D<N?`${T.left} → ${T.right}`:"Not answered",correctAnswer:`${T.left} → ${T.right}`})):Array.from({length:F},(T,D)=>({questionNumber:D+1,isCorrect:D<N,userAnswer:D<N?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log("🎯 Using test results data:",R),m(R),v(!0)},[a,s]),k=C.useCallback(()=>{t("/student")},[t]);return C.useEffect(()=>{S()},[S]),o?l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsxs(mt,{className:"p-8 text-center",children:[l.jsx(Sr,{size:"lg",className:"mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):d?l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(mt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-red-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:d}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):a?y&&p?l.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:l.jsx(Zb,{testResults:p,onBackToCabinet:()=>{m(null),v(!1),t("/student")},onRetakeTest:(_,N)=>{m(null),v(!1),S()},isLoading:!1})}):l.jsx(Qe.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gray-50 py-8",children:l.jsx(kW,{testData:a,onTestComplete:E,onBackToCabinet:k})}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(mt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-gray-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},pz=()=>{const{testType:e,testId:t}=p2(),r=Bi(),{activeTests:n}=$p(),s=()=>{r("/student")},a=n.find(i=>i.test_type===e&&i.test_id===parseInt(t));return l.jsx(hz,{onBackToCabinet:s,currentTest:a||{test_type:e,test_id:parseInt(t)}})},xz=()=>{const e=Bi(),{user:t,isAuthenticated:r,isLoading:n}=Gn(),[s,a]=C.useState(!1),[i,o]=C.useState(!0),[c,d]=C.useState(""),[f,p]=C.useState([]),[m,y]=C.useState(!1),[v,w]=C.useState(!1),[S,E]=C.useState({currentPassword:"",newPassword:"",confirmPassword:""}),k=C.useCallback(async()=>{console.log("🎓 Initializing Student Application...");try{if(o(!0),d(""),!r||!t){console.log("🎓 User not authenticated, redirecting to login"),e("/login");return}if(t.role!==ei.STUDENT){console.error("🎓 Invalid user role for student app:",t.role),d("Access denied. Student role required.");return}console.log("🎓 Initializing event listeners..."),_(),console.log("🎓 Setting up back to cabinet button listeners..."),N(),console.log("🎓 Setting up password change form listener..."),F(),console.log("🎓 Loading student data..."),await A(),console.log("🎓 Exposing student functions globally..."),R(),console.log("🎓 Populating student info from user data..."),K(t),a(!0),console.log("🎓 Student Application initialization complete!")}catch(J){console.error("🎓 Error initializing student app:",J),d("Failed to initialize student application")}finally{o(!1)}},[r,t,e]);C.useEffect(()=>{n||k()},[n,r,t,k]);const _=C.useCallback(()=>{console.log("🎓 Setting up student event listeners...");const J=W=>{m&&!W.target.closest(".student-menu")&&y(!1)},I=W=>{W.key==="Escape"&&m&&y(!1)};return document.addEventListener("click",J),document.addEventListener("keydown",I),()=>{document.removeEventListener("click",J),document.removeEventListener("keydown",I)}},[m]),N=C.useCallback(()=>{console.log("🎓 Setting up back to cabinet listeners...")},[]),F=C.useCallback(()=>{console.log("🎓 Setting up password change form...")},[]),A=C.useCallback(async()=>{console.log("🎓 Loading student data...");try{console.log("🎓 Student data loaded successfully")}catch(J){throw console.error("🎓 Error loading student data:",J),J}},[]),R=C.useCallback(()=>{console.log("🎓 Exposing student functions globally..."),window.toggleStudentMenu=T,window.showChangePasswordTab=D,window.hideChangePasswordTab=L,window.navigateBackToCabinet=G,window.handlePasswordChange=O,window.populateStudentInfoDirectly=K,console.log("🎓 All student functions exposed globally")},[]),T=C.useCallback(()=>{console.log("🔧 toggleStudentMenu called"),y(J=>{const I=!J;return console.log("🔧 Menu state changed from",J,"to",I),I}),console.log("🔧 Toggled dropdown menu")},[]),D=C.useCallback(()=>{console.log("🔧 showChangePasswordTab called"),w(!0),y(!1)},[]),L=C.useCallback(()=>{console.log("🔧 hideChangePasswordTab called"),w(!1),E({currentPassword:"",newPassword:"",confirmPassword:""})},[]),O=C.useCallback(async J=>{J.preventDefault(),console.log("🔧 handlePasswordChange called");const{currentPassword:I,newPassword:W,confirmPassword:B}=S;if(!I||!W||!B){te("Please fill in all fields","error");return}if(W!==B){te("New passwords do not match","error");return}if(W.length<6){te("New password must be at least 6 characters long","error");return}const Y=/[a-zA-Z]/.test(W),V=/[0-9]/.test(W);if(!Y||!V){te("New password must contain both letters and numbers","error");return}if(!t||!t.student_id){te("Session expired. Please login again.","error");return}const H=t.student_id;if(window.confirm("Are you sure you want to change your password?"))try{o(!0);const X=await mn.changePassword({studentId:H,currentPassword:I,newPassword:W});X.success?(te("Password changed successfully!","success"),L()):te(X.message||"Failed to change password","error")}catch(X){console.error("Password change error:",X),te("Failed to change password. Please try again.","error")}finally{o(!1)}},[S,t]),G=C.useCallback(()=>{if(console.log("[DEBUG] navigateBackToCabinet called"),!r||!t){console.warn("[WARN] No valid user found, redirecting to login"),e("/login");return}t.role===ei.STUDENT?(console.log("[DEBUG] Navigating to student cabinet"),e("/student")):(console.warn("[WARN] Unknown user role, redirecting to login"),e("/login"))},[r,t,e]),K=C.useCallback(J=>{console.log("🎓 populateStudentInfoDirectly called with:",J);try{console.log("🎓 Student info populated successfully")}catch(I){console.error("🎓 Error populating student info:",I)}},[]),te=C.useCallback((J,I)=>{const W={id:Date.now(),message:J,type:I,timestamp:new Date};p(B=>[...B,W]),setTimeout(()=>{p(B=>B.filter(Y=>Y.id!==W.id))},xi.NOTIFICATION_DURATION)},[]),Z=C.useCallback(J=>{const{name:I,value:W}=J.target;E(B=>({...B,[I]:W}))},[]);return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Sr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):c?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:c}),l.jsx(tt,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{className:"bg-gray-50",children:[l.jsxs(x2,{children:[l.jsx(fs,{path:"/",element:l.jsxs("div",{className:"student-app",children:[l.jsx(dz,{isMenuOpen:m,onToggleMenu:T,onShowPasswordChange:D}),v&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),l.jsxs("form",{onSubmit:O,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:S.currentPassword,onChange:Z,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:S.newPassword,onChange:Z,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:S.confirmPassword,onChange:Z,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(tt,{type:"button",variant:"secondary",onClick:L,className:"flex-1",children:"Cancel"}),l.jsx(tt,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?l.jsxs(l.Fragment,{children:[l.jsx(Sr,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),l.jsx(fs,{path:"/test/:testType/:testId",element:l.jsx(pz,{})}),l.jsx(fs,{path:"matching-test/:testId",element:l.jsx(gz,{})}),l.jsx(fs,{path:"word-matching-test/:testId",element:l.jsx(mz,{})}),l.jsx(fs,{path:"/results",element:l.jsx($8,{})})]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:f.map(J=>l.jsx(Wo,{type:J.type,message:J.message,onClose:()=>p(I=>I.filter(W=>W.id!==J.id))},J.id))})]}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Sr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},yz=()=>l.jsx(DN,{children:l.jsx(F8,{children:l.jsx(A8,{children:l.jsx(xz,{})})})});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ly={};ly.version="0.18.5";var W8=1252,vz=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],eS={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},tS=function(e){vz.indexOf(e)!=-1&&(W8=eS[0]=e)};function wz(){tS(1252)}var Lo=function(e){tS(e)};function rS(){Lo(1200),wz()}function s3(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function _z(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function z8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var _m=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?_z(e.slice(2)):t==254&&r==255?z8(e.slice(2)):t==65279?e.slice(1):e},h1=function(t){return String.fromCharCode(t)},a3=function(t){return String.fromCharCode(t)},ip,Cu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function op(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),a=r>>2,n=e.charCodeAt(d++),i=(r&3)<<4|n>>4,s=e.charCodeAt(d++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=Cu.charAt(a)+Cu.charAt(i)+Cu.charAt(o)+Cu.charAt(c);return t}function Oi(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)a=Cu.indexOf(e.charAt(d++)),i=Cu.indexOf(e.charAt(d++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Cu.indexOf(e.charAt(d++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Cu.indexOf(e.charAt(d++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Ar=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Nc=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Iu(e){return Ar?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function i3(e){return Ar?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ii=function(t){return Ar?Nc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function qy(e){if(typeof ArrayBuffer>"u")return Ii(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Vu(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function bz(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function nS(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return nS(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Qs=Ar?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Nc(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Sz(e){for(var t=[],r=0,n=e.length+250,s=Iu(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Iu(65535),n=65530)}return t.push(s.slice(0,r)),Qs(t)}var si=/\u0000/g,bm=/[\u0001-\u0006]/g;function Xh(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Oo(e,t){var r=""+e;return r.length>=t?r:Zn("0",t-r.length)+r}function sS(e,t){var r=""+e;return r.length>=t?r:Zn(" ",t-r.length)+r}function cy(e,t){var r=""+e;return r.length>=t?r:r+Zn(" ",t-r.length)}function kz(e,t){var r=""+Math.round(e);return r.length>=t?r:Zn("0",t-r.length)+r}function Cz(e,t){var r=""+e;return r.length>=t?r:Zn("0",t-r.length)+r}var o3=Math.pow(2,32);function kh(e,t){if(e>o3||e<-o3)return kz(e,t);var r=Math.round(e);return Cz(r,t)}function uy(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var l3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rw=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Tz(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var ur={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},c3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ez={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function dy(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,d=0,f=0,p=Math.floor(s);d<t&&(p=Math.floor(s),o=p*i+a,f=p*d+c,!(s-p<5e-8));)s=1/(s-p),a=i,i=o,c=d,d=f;if(f>t&&(d>t?(f=c,o=a):(f=d,o=i)),!r)return[0,n*o,f];var m=Math.floor(n*o/f);return[m,n*o-m*f,f]}function Ld(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=Dz(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var H8=new Date(1899,11,31,0,0,0),Nz=H8.getTime(),Az=new Date(1900,2,1,0,0,0);function G8(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Az&&(r+=1440*60*1e3),(r-(Nz+(e.getTimezoneOffset()-H8.getTimezoneOffset())*6e4))/(1440*60*1e3)}function aS(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jz(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Fz(e){var t=e<0?12:11,r=aS(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Pz(e){var t=aS(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function lp(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Fz(e):t===10?r=e.toFixed(10).substr(0,12):r=Pz(e),aS(jz(r.toUpperCase()))}function uf(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):lp(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return po(14,G8(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Dz(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Rz(e,t,r,n){var s="",a=0,i=0,o=r.y,c,d=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,d=2;break;default:c=o%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return Rw[r.m-1][1];case 5:return Rw[r.m-1][0];default:return Rw[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return l3[r.q][0];default:return l3[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Oo(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=Oo(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=o,d=1;break}var f=d>0?Oo(c,d):"";return f}function Tu(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var V8=/%/g;function Iz(e,t,r){var n=t.replace(V8,""),s=t.length-n.length;return yc(e,n,r*Math.pow(10,2*s))+Zn("%",s)}function Mz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return yc(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function K8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+K8(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,f){return c+d+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var q8=/# (\?+)( ?)\/( ?)(\d+)/;function Lz(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Zn(" ",e[1].length+1+e[4].length):sS(i,e[1].length)+e[2]+"/"+e[3]+Oo(o,e[4].length))}function Oz(e,t,r){return r+(t===0?"":""+t)+Zn(" ",e[1].length+2+e[4].length)}var X8=/^#*0*\.([0#]+)/,Y8=/\).*[0#]/,J8=/\(###\) ###\\?-####/;function Qa(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function u3(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function d3(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Bz(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Uz(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ro(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Y8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ro("n",n,r):"("+ro("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Mz(e,t,r);if(t.indexOf("%")!==-1)return Iz(e,t,r);if(t.indexOf("E")!==-1)return K8(t,r);if(t.charCodeAt(0)===36)return"$"+ro(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+kh(c,t.length);if(t.match(/^[#?]+$/))return s=kh(r,0),s==="0"&&(s=""),s.length>t.length?s:Qa(t.substr(0,t.length-s.length))+s;if(a=t.match(q8))return Lz(a,c,d);if(t.match(/^#+0+$/))return d+kh(c,t.length-t.indexOf("0"));if(a=t.match(X8))return s=u3(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Qa(a[1])).replace(/\.$/,"."+Qa(a[1])).replace(/\.(\d*)$/,function(v,w){return"."+w+Zn("0",Qa(a[1]).length-w.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+u3(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+Tu(kh(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ro(e,t,-r):Tu(""+(Math.floor(r)+Bz(r,a[1].length)))+"."+Oo(d3(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ro(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Xh(ro(e,t.replace(/[\\-]/g,""),r)),i=0,Xh(Xh(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(J8))return s=ro(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=dy(c,Math.pow(10,i)-1,!1),s=""+d,f=yc("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=cy(o[2],i),f.length<a[4].length&&(f=Qa(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=dy(c,Math.pow(10,i)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?sS(o[1],i)+a[2]+"/"+a[3]+cy(o[2],i):Zn(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=kh(r,0),t.length<=s.length?s:Qa(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,m=t.length-s.length-p;return Qa(t.substr(0,p)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=d3(r,a[1].length),r<0?"-"+ro(e,t,-r):Tu(Uz(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Oo(0,3-v.length):"")+v})+"."+Oo(i,a[1].length);switch(t){case"###,##0.00":return ro(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=Tu(kh(c,0));return y!=="0"?d+y:"";case"###,###.00":return ro(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ro(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function $z(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return yc(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Wz(e,t,r){var n=t.replace(V8,""),s=t.length-n.length;return yc(e,n,r*Math.pow(10,2*s))+Zn("%",s)}function Q8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Q8(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,f){return c+d+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ml(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Y8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ml("n",n,r):"("+ml("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return $z(e,t,r);if(t.indexOf("%")!==-1)return Wz(e,t,r);if(t.indexOf("E")!==-1)return Q8(t,r);if(t.charCodeAt(0)===36)return"$"+ml(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Oo(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Qa(t.substr(0,t.length-s.length))+s;if(a=t.match(q8))return Oz(a,c,d);if(t.match(/^#+0+$/))return d+Oo(c,t.length-t.indexOf("0"));if(a=t.match(X8))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Qa(a[1])).replace(/\.$/,"."+Qa(a[1])),s=s.replace(/\.(\d*)$/,function(v,w){return"."+w+Zn("0",Qa(a[1]).length-w.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+Tu(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ml(e,t,-r):Tu(""+r)+"."+Zn("0",a[1].length);if(a=t.match(/^#,#*,#0/))return ml(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Xh(ml(e,t.replace(/[\\-]/g,""),r)),i=0,Xh(Xh(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(J8))return s=ml(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=dy(c,Math.pow(10,i)-1,!1),s=""+d,f=yc("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=cy(o[2],i),f.length<a[4].length&&(f=Qa(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=dy(c,Math.pow(10,i)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?sS(o[1],i)+a[2]+"/"+a[3]+cy(o[2],i):Zn(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Qa(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,m=t.length-s.length-p;return Qa(t.substr(0,p)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ml(e,t,-r):Tu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Oo(0,3-v.length):"")+v})+"."+Oo(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=Tu(""+c);return y!=="0"?d+y:"";default:if(t.match(/\.[0#?]*$/))return ml(e,t.slice(0,t.lastIndexOf(".")),r)+Qa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function yc(e,t,r){return(r|0)===r?ml(e,t,r):ro(e,t,r)}function zz(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Z8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function N0(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":uy(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Z8))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Hz(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",d,f,p,m="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!uy(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(p=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(p);s[s.length]={t:"t",v:a},++i;break;case"\\":var y=e.charAt(++i),v=y==="("||y===")"?y:"t";s[s.length]={t:v,v:y},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(d==null&&(d=Ld(t,r,e.charAt(i+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Ld(t,r),d==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"上":var w={t:o,v:o};if(d==null&&(d=Ld(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(d!=null&&(w.v=d.H>=12?"P":"A"),w.t="T",m="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(d!=null&&(w.v=d.H>=12?"PM":"AM"),w.t="T",i+=5,m="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(d!=null&&(w.v=d.H>=12?"下午":"上午"),w.t="T",i+=5,m="h"):(w.t="t",++i),d==null&&w.t==="T")return"";s[s.length]=w,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Z8)){if(d==null&&(d=Ld(t,r),d==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",N0(e)||(s[s.length]={t:"t",v:a}));break;case".":if(d!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var S=0,E=0,k;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=m,c="h",S<1&&(S=1);break;case"s":(k=s[i].v.match(/\.0+$/))&&(E=Math.max(E,k[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&s[i].v.match(/[Hh]/)&&(S=1),S<2&&s[i].v.match(/[Mm]/)&&(S=2),S<3&&s[i].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var _="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=Rz(s[i].t.charCodeAt(0),s[i].v,d,E),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;_+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=uf(t,r);break}var F="",A,R;if(_.length>0){_.charCodeAt(0)==40?(A=t<0&&_.charCodeAt(0)===45?-t:t,R=yc("n",_,A)):(A=t<0&&n>1?-t:t,R=yc("n",_,A),A<0&&s[0]&&s[0].t=="t"&&(R=R.substr(1),s[0].v="-"+s[0].v)),N=R.length-1;var T=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){T=i;break}var D=s.length;if(T===s.length&&R.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=R.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=R.substr(0,N+1),N=-1),s[i].t="t",D=i);N>=0&&D<s.length&&(s[D].v=R.substr(0,N+1)+s[D].v)}else if(T!==s.length&&R.indexOf("E")===-1){for(N=R.indexOf(".")-1,i=T;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")-1:s[i].v.length-1,F=s[i].v.substr(f+1);f>=0;--f)N>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(F=R.charAt(N--)+F);s[i].v=F,s[i].t="t",D=i}for(N>=0&&D<s.length&&(s[D].v=R.substr(0,N+1)+s[D].v),N=R.indexOf(".")+1,i=T;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==T)){for(f=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")+1:0,F=s[i].v.substr(0,f);f<s[i].v.length;++f)N<R.length&&(F+=R.charAt(N++));s[i].v=F,s[i].t="t",D=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(A=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=yc(s[i].t,s[i].v,A),s[i].t="t");var L="";for(i=0;i!==s.length;++i)s[i]!=null&&(L+=s[i].v);return L}var f3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function h3(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Gz(e,t){var r=zz(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(f3),o=r[1].match(f3);return h3(t,i)?[n,r[0]]:h3(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function po(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ur)[e],n==null&&(n=r.table&&r.table[c3[e]]||ur[c3[e]]),n==null&&(n=Ez[e]||"General");break}if(uy(n,0))return uf(t,r);t instanceof Date&&(t=G8(t,r.date1904));var s=Gz(n,t);if(uy(s[1]))return uf(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Hz(s[1],t,r,s[0])}function vc(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ur[r]==null){t<0&&(t=r);continue}if(ur[r]==e){t=r;break}}t<0&&(t=391)}return ur[t]=e,t}function Xy(e){for(var t=0;t!=392;++t)e[t]!==void 0&&vc(e[t],t)}function A0(){ur=Tz()}var Vz={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ej=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Kz(e){var t=typeof e=="number"?ur[e]:e;return t=t.replace(ej,"(\\d+)"),new RegExp("^"+t+"$")}function qz(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(ej)||[]).forEach(function(p,m){var y=parseInt(r[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=y;break;case"d":a=y;break;case"h":i=y;break;case"s":c=y;break;case"m":i>=0?o=y:s=y;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?d:n==-1&&s==-1&&a==-1?f:d+"T"+f}var Xz=(function(){var e={};e.version="1.2.0";function t(){for(var R=0,T=new Array(256),D=0;D!=256;++D)R=D,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,T[D]=R;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(R){var T=0,D=0,L=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)O[L]=R[L];for(L=0;L!=256;++L)for(D=R[L],T=256+L;T<4096;T+=256)D=O[T]=D>>>8^R[D&255];var G=[];for(L=1;L!=16;++L)G[L-1]=typeof Int32Array<"u"?O.subarray(L*256,L*256+256):O.slice(L*256,L*256+256);return G}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],d=s[4],f=s[5],p=s[6],m=s[7],y=s[8],v=s[9],w=s[10],S=s[11],E=s[12],k=s[13],_=s[14];function N(R,T){for(var D=T^-1,L=0,O=R.length;L<O;)D=D>>>8^r[(D^R.charCodeAt(L++))&255];return~D}function F(R,T){for(var D=T^-1,L=R.length-15,O=0;O<L;)D=_[R[O++]^D&255]^k[R[O++]^D>>8&255]^E[R[O++]^D>>16&255]^S[R[O++]^D>>>24]^w[R[O++]]^v[R[O++]]^y[R[O++]]^m[R[O++]]^p[R[O++]]^f[R[O++]]^d[R[O++]]^c[R[O++]]^o[R[O++]]^i[R[O++]]^a[R[O++]]^r[R[O++]];for(L+=15;O<L;)D=D>>>8^r[(D^R[O++])&255];return~D}function A(R,T){for(var D=T^-1,L=0,O=R.length,G=0,K=0;L<O;)G=R.charCodeAt(L++),G<128?D=D>>>8^r[(D^G)&255]:G<2048?(D=D>>>8^r[(D^(192|G>>6&31))&255],D=D>>>8^r[(D^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,K=R.charCodeAt(L++)&1023,D=D>>>8^r[(D^(240|G>>8&7))&255],D=D>>>8^r[(D^(128|G>>2&63))&255],D=D>>>8^r[(D^(128|K>>6&15|(G&3)<<4))&255],D=D>>>8^r[(D^(128|K&63))&255]):(D=D>>>8^r[(D^(224|G>>12&15))&255],D=D>>>8^r[(D^(128|G>>6&63))&255],D=D>>>8^r[(D^(128|G&63))&255]);return~D}return e.table=r,e.bstr=N,e.buf=F,e.str=A,e})(),ir=(function(){var t={};t.version="1.2.1";function r(ce,be){for(var pe=ce.split("/"),we=be.split("/"),Ce=0,oe=0,me=Math.min(pe.length,we.length);Ce<me;++Ce){if(oe=pe[Ce].length-we[Ce].length)return oe;if(pe[Ce]!=we[Ce])return pe[Ce]<we[Ce]?-1:1}return pe.length-we.length}function n(ce){if(ce.charAt(ce.length-1)=="/")return ce.slice(0,-1).indexOf("/")===-1?ce:n(ce.slice(0,-1));var be=ce.lastIndexOf("/");return be===-1?ce:ce.slice(0,be+1)}function s(ce){if(ce.charAt(ce.length-1)=="/")return s(ce.slice(0,-1));var be=ce.lastIndexOf("/");return be===-1?ce:ce.slice(be+1)}function a(ce,be){typeof be=="string"&&(be=new Date(be));var pe=be.getHours();pe=pe<<6|be.getMinutes(),pe=pe<<5|be.getSeconds()>>>1,ce.write_shift(2,pe);var we=be.getFullYear()-1980;we=we<<4|be.getMonth()+1,we=we<<5|be.getDate(),ce.write_shift(2,we)}function i(ce){var be=ce.read_shift(2)&65535,pe=ce.read_shift(2)&65535,we=new Date,Ce=pe&31;pe>>>=5;var oe=pe&15;pe>>>=4,we.setMilliseconds(0),we.setFullYear(pe+1980),we.setMonth(oe-1),we.setDate(Ce);var me=be&31;be>>>=5;var re=be&63;return be>>>=6,we.setHours(be),we.setMinutes(re),we.setSeconds(me<<1),we}function o(ce){ha(ce,0);for(var be={},pe=0;ce.l<=ce.length-4;){var we=ce.read_shift(2),Ce=ce.read_shift(2),oe=ce.l+Ce,me={};switch(we){case 21589:pe=ce.read_shift(1),pe&1&&(me.mtime=ce.read_shift(4)),Ce>5&&(pe&2&&(me.atime=ce.read_shift(4)),pe&4&&(me.ctime=ce.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}ce.l=oe,be[we]=me}return be}var c;function d(){return c||(c={})}function f(ce,be){if(ce[0]==80&&ce[1]==75)return Te(ce,be);if((ce[0]|32)==109&&(ce[1]|32)==105)return Zt(ce,be);if(ce.length<512)throw new Error("CFB file size "+ce.length+" < 512");var pe=3,we=512,Ce=0,oe=0,me=0,re=0,ne=0,fe=[],de=ce.slice(0,512);ha(de,0);var Pe=p(de);switch(pe=Pe[0],pe){case 3:we=512;break;case 4:we=4096;break;case 0:if(Pe[1]==0)return Te(ce,be);default:throw new Error("Major Version: Expected 3 or 4 saw "+pe)}we!==512&&(de=ce.slice(0,we),ha(de,28));var Ve=ce.slice(0,we);m(de,pe);var Ae=de.read_shift(4,"i");if(pe===3&&Ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ae);de.l+=4,me=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),re=de.read_shift(4,"i"),Ce=de.read_shift(4,"i"),ne=de.read_shift(4,"i"),oe=de.read_shift(4,"i");for(var Ue=-1,ze=0;ze<109&&(Ue=de.read_shift(4,"i"),!(Ue<0));++ze)fe[ze]=Ue;var pt=y(ce,we);S(ne,oe,pt,we,fe);var Bt=k(pt,me,fe,we);Bt[me].name="!Directory",Ce>0&&re!==K&&(Bt[re].name="!MiniFAT"),Bt[fe[0]].name="!FAT",Bt.fat_addrs=fe,Bt.ssz=we;var sr={},rr=[],Gr=[],Lr=[];_(me,Bt,pt,rr,Ce,sr,Gr,re),v(Gr,Lr,rr),rr.shift();var yr={FileIndex:Gr,FullPaths:Lr};return be&&be.raw&&(yr.raw={header:Ve,sectors:pt}),yr}function p(ce){if(ce[ce.l]==80&&ce[ce.l+1]==75)return[0,0];ce.chk(te,"Header Signature: "),ce.l+=16;var be=ce.read_shift(2,"u");return[ce.read_shift(2,"u"),be]}function m(ce,be){var pe=9;switch(ce.l+=2,pe=ce.read_shift(2)){case 9:if(be!=3)throw new Error("Sector Shift: Expected 9 saw "+pe);break;case 12:if(be!=4)throw new Error("Sector Shift: Expected 12 saw "+pe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+pe)}ce.chk("0600","Mini Sector Shift: "),ce.chk("000000000000","Reserved: ")}function y(ce,be){for(var pe=Math.ceil(ce.length/be)-1,we=[],Ce=1;Ce<pe;++Ce)we[Ce-1]=ce.slice(Ce*be,(Ce+1)*be);return we[pe-1]=ce.slice(pe*be),we}function v(ce,be,pe){for(var we=0,Ce=0,oe=0,me=0,re=0,ne=pe.length,fe=[],de=[];we<ne;++we)fe[we]=de[we]=we,be[we]=pe[we];for(;re<de.length;++re)we=de[re],Ce=ce[we].L,oe=ce[we].R,me=ce[we].C,fe[we]===we&&(Ce!==-1&&fe[Ce]!==Ce&&(fe[we]=fe[Ce]),oe!==-1&&fe[oe]!==oe&&(fe[we]=fe[oe])),me!==-1&&(fe[me]=we),Ce!==-1&&we!=fe[we]&&(fe[Ce]=fe[we],de.lastIndexOf(Ce)<re&&de.push(Ce)),oe!==-1&&we!=fe[we]&&(fe[oe]=fe[we],de.lastIndexOf(oe)<re&&de.push(oe));for(we=1;we<ne;++we)fe[we]===we&&(oe!==-1&&fe[oe]!==oe?fe[we]=fe[oe]:Ce!==-1&&fe[Ce]!==Ce&&(fe[we]=fe[Ce]));for(we=1;we<ne;++we)if(ce[we].type!==0){if(re=we,re!=fe[re])do re=fe[re],be[we]=be[re]+"/"+be[we];while(re!==0&&fe[re]!==-1&&re!=fe[re]);fe[we]=-1}for(be[0]+="/",we=1;we<ne;++we)ce[we].type!==2&&(be[we]+="/")}function w(ce,be,pe){for(var we=ce.start,Ce=ce.size,oe=[],me=we;pe&&Ce>0&&me>=0;)oe.push(be.slice(me*G,me*G+G)),Ce-=G,me=Dd(pe,me*4);return oe.length===0?ht(0):Qs(oe).slice(0,ce.size)}function S(ce,be,pe,we,Ce){var oe=K;if(ce===K){if(be!==0)throw new Error("DIFAT chain shorter than expected")}else if(ce!==-1){var me=pe[ce],re=(we>>>2)-1;if(!me)return;for(var ne=0;ne<re&&(oe=Dd(me,ne*4))!==K;++ne)Ce.push(oe);S(Dd(me,we-4),be-1,pe,we,Ce)}}function E(ce,be,pe,we,Ce){var oe=[],me=[];Ce||(Ce=[]);var re=we-1,ne=0,fe=0;for(ne=be;ne>=0;){Ce[ne]=!0,oe[oe.length]=ne,me.push(ce[ne]);var de=pe[Math.floor(ne*4/we)];if(fe=ne*4&re,we<4+fe)throw new Error("FAT boundary crossed: "+ne+" 4 "+we);if(!ce[de])break;ne=Dd(ce[de],fe)}return{nodes:oe,data:C3([me])}}function k(ce,be,pe,we){var Ce=ce.length,oe=[],me=[],re=[],ne=[],fe=we-1,de=0,Pe=0,Ve=0,Ae=0;for(de=0;de<Ce;++de)if(re=[],Ve=de+be,Ve>=Ce&&(Ve-=Ce),!me[Ve]){ne=[];var Ue=[];for(Pe=Ve;Pe>=0;){Ue[Pe]=!0,me[Pe]=!0,re[re.length]=Pe,ne.push(ce[Pe]);var ze=pe[Math.floor(Pe*4/we)];if(Ae=Pe*4&fe,we<4+Ae)throw new Error("FAT boundary crossed: "+Pe+" 4 "+we);if(!ce[ze]||(Pe=Dd(ce[ze],Ae),Ue[Pe]))break}oe[Ve]={nodes:re,data:C3([ne])}}return oe}function _(ce,be,pe,we,Ce,oe,me,re){for(var ne=0,fe=we.length?2:0,de=be[ce].data,Pe=0,Ve=0,Ae;Pe<de.length;Pe+=128){var Ue=de.slice(Pe,Pe+128);ha(Ue,64),Ve=Ue.read_shift(2),Ae=fS(Ue,0,Ve-fe),we.push(Ae);var ze={name:Ae,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},pt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);pt!==0&&(ze.ct=N(Ue,Ue.l-8));var Bt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);Bt!==0&&(ze.mt=N(Ue,Ue.l-8)),ze.start=Ue.read_shift(4,"i"),ze.size=Ue.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=K,ze.name=""),ze.type===5?(ne=ze.start,Ce>0&&ne!==K&&(be[ne].name="!StreamData")):ze.size>=4096?(ze.storage="fat",be[ze.start]===void 0&&(be[ze.start]=E(pe,ze.start,be.fat_addrs,be.ssz)),be[ze.start].name=ze.name,ze.content=be[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:ne!==K&&ze.start!==K&&be[ne]&&(ze.content=w(ze,be[ne].data,(be[re]||{}).data))),ze.content&&ha(ze.content,0),oe[Ae]=ze,me.push(ze)}}function N(ce,be){return new Date((Ri(ce,be+4)/1e7*Math.pow(2,32)+Ri(ce,be)/1e7-11644473600)*1e3)}function F(ce,be){return d(),f(c.readFileSync(ce),be)}function A(ce,be){var pe=be&&be.type;switch(pe||Ar&&Buffer.isBuffer(ce)&&(pe="buffer"),pe||"base64"){case"file":return F(ce,be);case"base64":return f(Ii(Oi(ce)),be);case"binary":return f(Ii(ce),be)}return f(ce,be)}function R(ce,be){var pe=be||{},we=pe.root||"Root Entry";if(ce.FullPaths||(ce.FullPaths=[]),ce.FileIndex||(ce.FileIndex=[]),ce.FullPaths.length!==ce.FileIndex.length)throw new Error("inconsistent CFB structure");ce.FullPaths.length===0&&(ce.FullPaths[0]=we+"/",ce.FileIndex[0]={name:we,type:5}),pe.CLSID&&(ce.FileIndex[0].clsid=pe.CLSID),T(ce)}function T(ce){var be="Sh33tJ5";if(!ir.find(ce,"/"+be)){var pe=ht(4);pe[0]=55,pe[1]=pe[3]=50,pe[2]=54,ce.FileIndex.push({name:be,type:2,content:pe,size:4,L:69,R:69,C:69}),ce.FullPaths.push(ce.FullPaths[0]+be),D(ce)}}function D(ce,be){R(ce);for(var pe=!1,we=!1,Ce=ce.FullPaths.length-1;Ce>=0;--Ce){var oe=ce.FileIndex[Ce];switch(oe.type){case 0:we?pe=!0:(ce.FileIndex.pop(),ce.FullPaths.pop());break;case 1:case 2:case 5:we=!0,isNaN(oe.R*oe.L*oe.C)&&(pe=!0),oe.R>-1&&oe.L>-1&&oe.R==oe.L&&(pe=!0);break;default:pe=!0;break}}if(!(!pe&&!be)){var me=new Date(1987,1,19),re=0,ne=Object.create?Object.create(null):{},fe=[];for(Ce=0;Ce<ce.FullPaths.length;++Ce)ne[ce.FullPaths[Ce]]=!0,ce.FileIndex[Ce].type!==0&&fe.push([ce.FullPaths[Ce],ce.FileIndex[Ce]]);for(Ce=0;Ce<fe.length;++Ce){var de=n(fe[Ce][0]);we=ne[de],we||(fe.push([de,{name:s(de).replace("/",""),type:1,clsid:J,ct:me,mt:me,content:null}]),ne[de]=!0)}for(fe.sort(function(Ae,Ue){return r(Ae[0],Ue[0])}),ce.FullPaths=[],ce.FileIndex=[],Ce=0;Ce<fe.length;++Ce)ce.FullPaths[Ce]=fe[Ce][0],ce.FileIndex[Ce]=fe[Ce][1];for(Ce=0;Ce<fe.length;++Ce){var Pe=ce.FileIndex[Ce],Ve=ce.FullPaths[Ce];if(Pe.name=s(Ve).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||J,Ce===0)Pe.C=fe.length>1?1:-1,Pe.size=0,Pe.type=5;else if(Ve.slice(-1)=="/"){for(re=Ce+1;re<fe.length&&n(ce.FullPaths[re])!=Ve;++re);for(Pe.C=re>=fe.length?-1:re,re=Ce+1;re<fe.length&&n(ce.FullPaths[re])!=n(Ve);++re);Pe.R=re>=fe.length?-1:re,Pe.type=1}else n(ce.FullPaths[Ce+1]||"")==n(Ve)&&(Pe.R=Ce+1),Pe.type=2}}}function L(ce,be){var pe=be||{};if(pe.fileType=="mad")return Nr(ce,pe);switch(D(ce),pe.fileType){case"zip":return Ne(ce,pe)}var we=(function(Ae){for(var Ue=0,ze=0,pt=0;pt<Ae.FileIndex.length;++pt){var Bt=Ae.FileIndex[pt];if(Bt.content){var sr=Bt.content.length;sr>0&&(sr<4096?Ue+=sr+63>>6:ze+=sr+511>>9)}}for(var rr=Ae.FullPaths.length+3>>2,Gr=Ue+7>>3,Lr=Ue+127>>7,yr=Gr+ze+rr+Lr,Tr=yr+127>>7,Ur=Tr<=109?0:Math.ceil((Tr-109)/127);yr+Tr+Ur+127>>7>Tr;)Ur=++Tr<=109?0:Math.ceil((Tr-109)/127);var he=[1,Ur,Tr,Lr,rr,ze,Ue,0];return Ae.FileIndex[0].size=Ue<<6,he[7]=(Ae.FileIndex[0].start=he[0]+he[1]+he[2]+he[3]+he[4]+he[5])+(he[6]+7>>3),he})(ce),Ce=ht(we[7]<<9),oe=0,me=0;{for(oe=0;oe<8;++oe)Ce.write_shift(1,Z[oe]);for(oe=0;oe<8;++oe)Ce.write_shift(2,0);for(Ce.write_shift(2,62),Ce.write_shift(2,3),Ce.write_shift(2,65534),Ce.write_shift(2,9),Ce.write_shift(2,6),oe=0;oe<3;++oe)Ce.write_shift(2,0);for(Ce.write_shift(4,0),Ce.write_shift(4,we[2]),Ce.write_shift(4,we[0]+we[1]+we[2]+we[3]-1),Ce.write_shift(4,0),Ce.write_shift(4,4096),Ce.write_shift(4,we[3]?we[0]+we[1]+we[2]-1:K),Ce.write_shift(4,we[3]),Ce.write_shift(-4,we[1]?we[0]-1:K),Ce.write_shift(4,we[1]),oe=0;oe<109;++oe)Ce.write_shift(-4,oe<we[2]?we[1]+oe:-1)}if(we[1])for(me=0;me<we[1];++me){for(;oe<236+me*127;++oe)Ce.write_shift(-4,oe<we[2]?we[1]+oe:-1);Ce.write_shift(-4,me===we[1]-1?K:me+1)}var re=function(Ae){for(me+=Ae;oe<me-1;++oe)Ce.write_shift(-4,oe+1);Ae&&(++oe,Ce.write_shift(-4,K))};for(me=oe=0,me+=we[1];oe<me;++oe)Ce.write_shift(-4,I.DIFSECT);for(me+=we[2];oe<me;++oe)Ce.write_shift(-4,I.FATSECT);re(we[3]),re(we[4]);for(var ne=0,fe=0,de=ce.FileIndex[0];ne<ce.FileIndex.length;++ne)de=ce.FileIndex[ne],de.content&&(fe=de.content.length,!(fe<4096)&&(de.start=me,re(fe+511>>9)));for(re(we[6]+7>>3);Ce.l&511;)Ce.write_shift(-4,I.ENDOFCHAIN);for(me=oe=0,ne=0;ne<ce.FileIndex.length;++ne)de=ce.FileIndex[ne],de.content&&(fe=de.content.length,!(!fe||fe>=4096)&&(de.start=me,re(fe+63>>6)));for(;Ce.l&511;)Ce.write_shift(-4,I.ENDOFCHAIN);for(oe=0;oe<we[4]<<2;++oe){var Pe=ce.FullPaths[oe];if(!Pe||Pe.length===0){for(ne=0;ne<17;++ne)Ce.write_shift(4,0);for(ne=0;ne<3;++ne)Ce.write_shift(4,-1);for(ne=0;ne<12;++ne)Ce.write_shift(4,0);continue}de=ce.FileIndex[oe],oe===0&&(de.start=de.size?de.start-1:K);var Ve=oe===0&&pe.root||de.name;if(fe=2*(Ve.length+1),Ce.write_shift(64,Ve,"utf16le"),Ce.write_shift(2,fe),Ce.write_shift(1,de.type),Ce.write_shift(1,de.color),Ce.write_shift(-4,de.L),Ce.write_shift(-4,de.R),Ce.write_shift(-4,de.C),de.clsid)Ce.write_shift(16,de.clsid,"hex");else for(ne=0;ne<4;++ne)Ce.write_shift(4,0);Ce.write_shift(4,de.state||0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,de.start),Ce.write_shift(4,de.size),Ce.write_shift(4,0)}for(oe=1;oe<ce.FileIndex.length;++oe)if(de=ce.FileIndex[oe],de.size>=4096)if(Ce.l=de.start+1<<9,Ar&&Buffer.isBuffer(de.content))de.content.copy(Ce,Ce.l,0,de.size),Ce.l+=de.size+511&-512;else{for(ne=0;ne<de.size;++ne)Ce.write_shift(1,de.content[ne]);for(;ne&511;++ne)Ce.write_shift(1,0)}for(oe=1;oe<ce.FileIndex.length;++oe)if(de=ce.FileIndex[oe],de.size>0&&de.size<4096)if(Ar&&Buffer.isBuffer(de.content))de.content.copy(Ce,Ce.l,0,de.size),Ce.l+=de.size+63&-64;else{for(ne=0;ne<de.size;++ne)Ce.write_shift(1,de.content[ne]);for(;ne&63;++ne)Ce.write_shift(1,0)}if(Ar)Ce.l=Ce.length;else for(;Ce.l<Ce.length;)Ce.write_shift(1,0);return Ce}function O(ce,be){var pe=ce.FullPaths.map(function(ne){return ne.toUpperCase()}),we=pe.map(function(ne){var fe=ne.split("/");return fe[fe.length-(ne.slice(-1)=="/"?2:1)]}),Ce=!1;be.charCodeAt(0)===47?(Ce=!0,be=pe[0].slice(0,-1)+be):Ce=be.indexOf("/")!==-1;var oe=be.toUpperCase(),me=Ce===!0?pe.indexOf(oe):we.indexOf(oe);if(me!==-1)return ce.FileIndex[me];var re=!oe.match(bm);for(oe=oe.replace(si,""),re&&(oe=oe.replace(bm,"!")),me=0;me<pe.length;++me)if((re?pe[me].replace(bm,"!"):pe[me]).replace(si,"")==oe||(re?we[me].replace(bm,"!"):we[me]).replace(si,"")==oe)return ce.FileIndex[me];return null}var G=64,K=-2,te="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",I={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(ce,be,pe){d();var we=L(ce,pe);c.writeFileSync(be,we)}function B(ce){for(var be=new Array(ce.length),pe=0;pe<ce.length;++pe)be[pe]=String.fromCharCode(ce[pe]);return be.join("")}function Y(ce,be){var pe=L(ce,be);switch(be&&be.type||"buffer"){case"file":return d(),c.writeFileSync(be.filename,pe),pe;case"binary":return typeof pe=="string"?pe:B(pe);case"base64":return op(typeof pe=="string"?pe:B(pe));case"buffer":if(Ar)return Buffer.isBuffer(pe)?pe:Nc(pe);case"array":return typeof pe=="string"?Ii(pe):pe}return pe}var V;function H(ce){try{var be=ce.InflateRaw,pe=new be;if(pe._processChunk(new Uint8Array([3,0]),pe._finishFlushFlag),pe.bytesRead)V=ce;else throw new Error("zlib does not expose bytesRead")}catch(we){console.error("cannot use native zlib: "+(we.message||we))}}function X(ce,be){if(!V)return Mt(ce,be);var pe=V.InflateRaw,we=new pe,Ce=we._processChunk(ce.slice(ce.l),we._finishFlushFlag);return ce.l+=we.bytesRead,Ce}function se(ce){return V?V.deflateRawSync(ce):gt(ce)}var ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(ce){var be=(ce<<1|ce<<11)&139536|(ce<<5|ce<<15)&558144;return(be>>16|be>>8|be)&255}for(var _e=typeof Uint8Array<"u",ke=_e?new Uint8Array(256):[],Oe=0;Oe<256;++Oe)ke[Oe]=le(Oe);function ge(ce,be){var pe=ke[ce&255];return be<=8?pe>>>8-be:(pe=pe<<8|ke[ce>>8&255],be<=16?pe>>>16-be:(pe=pe<<8|ke[ce>>16&255],pe>>>24-be))}function ye(ce,be){var pe=be&7,we=be>>>3;return(ce[we]|(pe<=6?0:ce[we+1]<<8))>>>pe&3}function Ke(ce,be){var pe=be&7,we=be>>>3;return(ce[we]|(pe<=5?0:ce[we+1]<<8))>>>pe&7}function Xe(ce,be){var pe=be&7,we=be>>>3;return(ce[we]|(pe<=4?0:ce[we+1]<<8))>>>pe&15}function lt(ce,be){var pe=be&7,we=be>>>3;return(ce[we]|(pe<=3?0:ce[we+1]<<8))>>>pe&31}function Ye(ce,be){var pe=be&7,we=be>>>3;return(ce[we]|(pe<=1?0:ce[we+1]<<8))>>>pe&127}function We(ce,be,pe){var we=be&7,Ce=be>>>3,oe=(1<<pe)-1,me=ce[Ce]>>>we;return pe<8-we||(me|=ce[Ce+1]<<8-we,pe<16-we)||(me|=ce[Ce+2]<<16-we,pe<24-we)||(me|=ce[Ce+3]<<24-we),me&oe}function Me(ce,be,pe){var we=be&7,Ce=be>>>3;return we<=5?ce[Ce]|=(pe&7)<<we:(ce[Ce]|=pe<<we&255,ce[Ce+1]=(pe&7)>>8-we),be+3}function je(ce,be,pe){var we=be&7,Ce=be>>>3;return pe=(pe&1)<<we,ce[Ce]|=pe,be+1}function De(ce,be,pe){var we=be&7,Ce=be>>>3;return pe<<=we,ce[Ce]|=pe&255,pe>>>=8,ce[Ce+1]=pe,be+8}function Ge(ce,be,pe){var we=be&7,Ce=be>>>3;return pe<<=we,ce[Ce]|=pe&255,pe>>>=8,ce[Ce+1]=pe&255,ce[Ce+2]=pe>>>8,be+16}function ct(ce,be){var pe=ce.length,we=2*pe>be?2*pe:be+5,Ce=0;if(pe>=be)return ce;if(Ar){var oe=i3(we);if(ce.copy)ce.copy(oe);else for(;Ce<ce.length;++Ce)oe[Ce]=ce[Ce];return oe}else if(_e){var me=new Uint8Array(we);if(me.set)me.set(ce);else for(;Ce<pe;++Ce)me[Ce]=ce[Ce];return me}return ce.length=we,ce}function at(ce){for(var be=new Array(ce),pe=0;pe<ce;++pe)be[pe]=0;return be}function wt(ce,be,pe){var we=1,Ce=0,oe=0,me=0,re=0,ne=ce.length,fe=_e?new Uint16Array(32):at(32);for(oe=0;oe<32;++oe)fe[oe]=0;for(oe=ne;oe<pe;++oe)ce[oe]=0;ne=ce.length;var de=_e?new Uint16Array(ne):at(ne);for(oe=0;oe<ne;++oe)fe[Ce=ce[oe]]++,we<Ce&&(we=Ce),de[oe]=0;for(fe[0]=0,oe=1;oe<=we;++oe)fe[oe+16]=re=re+fe[oe-1]<<1;for(oe=0;oe<ne;++oe)re=ce[oe],re!=0&&(de[oe]=fe[re+16]++);var Pe=0;for(oe=0;oe<ne;++oe)if(Pe=ce[oe],Pe!=0)for(re=ge(de[oe],we)>>we-Pe,me=(1<<we+4-Pe)-1;me>=0;--me)be[re|me<<Pe]=Pe&15|oe<<4;return we}var Ft=_e?new Uint16Array(512):at(512),Kt=_e?new Uint16Array(32):at(32);if(!_e){for(var bt=0;bt<512;++bt)Ft[bt]=0;for(bt=0;bt<32;++bt)Kt[bt]=0}(function(){for(var ce=[],be=0;be<32;be++)ce.push(5);wt(ce,Kt,32);var pe=[];for(be=0;be<=143;be++)pe.push(8);for(;be<=255;be++)pe.push(9);for(;be<=279;be++)pe.push(7);for(;be<=287;be++)pe.push(8);wt(pe,Ft,288)})();var At=(function(){for(var be=_e?new Uint8Array(32768):[],pe=0,we=0;pe<Q.length-1;++pe)for(;we<Q[pe+1];++we)be[we]=pe;for(;we<32768;++we)be[we]=29;var Ce=_e?new Uint8Array(259):[];for(pe=0,we=0;pe<ae.length-1;++pe)for(;we<ae[pe+1];++we)Ce[we]=pe;function oe(re,ne){for(var fe=0;fe<re.length;){var de=Math.min(65535,re.length-fe),Pe=fe+de==re.length;for(ne.write_shift(1,+Pe),ne.write_shift(2,de),ne.write_shift(2,~de&65535);de-- >0;)ne[ne.l++]=re[fe++]}return ne.l}function me(re,ne){for(var fe=0,de=0,Pe=_e?new Uint16Array(32768):[];de<re.length;){var Ve=Math.min(65535,re.length-de);if(Ve<10){for(fe=Me(ne,fe,+(de+Ve==re.length)),fe&7&&(fe+=8-(fe&7)),ne.l=fe/8|0,ne.write_shift(2,Ve),ne.write_shift(2,~Ve&65535);Ve-- >0;)ne[ne.l++]=re[de++];fe=ne.l*8;continue}fe=Me(ne,fe,+(de+Ve==re.length)+2);for(var Ae=0;Ve-- >0;){var Ue=re[de];Ae=(Ae<<5^Ue)&32767;var ze=-1,pt=0;if((ze=Pe[Ae])&&(ze|=de&-32768,ze>de&&(ze-=32768),ze<de))for(;re[ze+pt]==re[de+pt]&&pt<250;)++pt;if(pt>2){Ue=Ce[pt],Ue<=22?fe=De(ne,fe,ke[Ue+1]>>1)-1:(De(ne,fe,3),fe+=5,De(ne,fe,ke[Ue-23]>>5),fe+=3);var Bt=Ue<8?0:Ue-4>>2;Bt>0&&(Ge(ne,fe,pt-ae[Ue]),fe+=Bt),Ue=be[de-ze],fe=De(ne,fe,ke[Ue]>>3),fe-=3;var sr=Ue<4?0:Ue-2>>1;sr>0&&(Ge(ne,fe,de-ze-Q[Ue]),fe+=sr);for(var rr=0;rr<pt;++rr)Pe[Ae]=de&32767,Ae=(Ae<<5^re[de])&32767,++de;Ve-=pt-1}else Ue<=143?Ue=Ue+48:fe=je(ne,fe,1),fe=De(ne,fe,ke[Ue]),Pe[Ae]=de&32767,++de}fe=De(ne,fe,0)-1}return ne.l=(fe+7)/8|0,ne.l}return function(ne,fe){return ne.length<8?oe(ne,fe):me(ne,fe)}})();function gt(ce){var be=ht(50+Math.floor(ce.length*1.1)),pe=At(ce,be);return be.slice(0,pe)}var kt=_e?new Uint16Array(32768):at(32768),Gt=_e?new Uint16Array(32768):at(32768),$t=_e?new Uint16Array(128):at(128),Be=1,it=1;function ut(ce,be){var pe=lt(ce,be)+257;be+=5;var we=lt(ce,be)+1;be+=5;var Ce=Xe(ce,be)+4;be+=4;for(var oe=0,me=_e?new Uint8Array(19):at(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,fe=_e?new Uint8Array(8):at(8),de=_e?new Uint8Array(8):at(8),Pe=me.length,Ve=0;Ve<Ce;++Ve)me[ie[Ve]]=oe=Ke(ce,be),ne<oe&&(ne=oe),fe[oe]++,be+=3;var Ae=0;for(fe[0]=0,Ve=1;Ve<=ne;++Ve)de[Ve]=Ae=Ae+fe[Ve-1]<<1;for(Ve=0;Ve<Pe;++Ve)(Ae=me[Ve])!=0&&(re[Ve]=de[Ae]++);var Ue=0;for(Ve=0;Ve<Pe;++Ve)if(Ue=me[Ve],Ue!=0){Ae=ke[re[Ve]]>>8-Ue;for(var ze=(1<<7-Ue)-1;ze>=0;--ze)$t[Ae|ze<<Ue]=Ue&7|Ve<<3}var pt=[];for(ne=1;pt.length<pe+we;)switch(Ae=$t[Ye(ce,be)],be+=Ae&7,Ae>>>=3){case 16:for(oe=3+ye(ce,be),be+=2,Ae=pt[pt.length-1];oe-- >0;)pt.push(Ae);break;case 17:for(oe=3+Ke(ce,be),be+=3;oe-- >0;)pt.push(0);break;case 18:for(oe=11+Ye(ce,be),be+=7;oe-- >0;)pt.push(0);break;default:pt.push(Ae),ne<Ae&&(ne=Ae);break}var Bt=pt.slice(0,pe),sr=pt.slice(pe);for(Ve=pe;Ve<286;++Ve)Bt[Ve]=0;for(Ve=we;Ve<30;++Ve)sr[Ve]=0;return Be=wt(Bt,kt,286),it=wt(sr,Gt,30),be}function St(ce,be){if(ce[0]==3&&!(ce[1]&3))return[Iu(be),2];for(var pe=0,we=0,Ce=i3(be||1<<18),oe=0,me=Ce.length>>>0,re=0,ne=0;(we&1)==0;){if(we=Ke(ce,pe),pe+=3,we>>>1)we>>1==1?(re=9,ne=5):(pe=ut(ce,pe),re=Be,ne=it);else{pe&7&&(pe+=8-(pe&7));var fe=ce[pe>>>3]|ce[(pe>>>3)+1]<<8;if(pe+=32,fe>0)for(!be&&me<oe+fe&&(Ce=ct(Ce,oe+fe),me=Ce.length);fe-- >0;)Ce[oe++]=ce[pe>>>3],pe+=8;continue}for(;;){!be&&me<oe+32767&&(Ce=ct(Ce,oe+32767),me=Ce.length);var de=We(ce,pe,re),Pe=we>>>1==1?Ft[de]:kt[de];if(pe+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)Ce[oe++]=Pe;else{if(Pe==256)break;Pe-=257;var Ve=Pe<8?0:Pe-4>>2;Ve>5&&(Ve=0);var Ae=oe+ae[Pe];Ve>0&&(Ae+=We(ce,pe,Ve),pe+=Ve),de=We(ce,pe,ne),Pe=we>>>1==1?Kt[de]:Gt[de],pe+=Pe&15,Pe>>>=4;var Ue=Pe<4?0:Pe-2>>1,ze=Q[Pe];for(Ue>0&&(ze+=We(ce,pe,Ue),pe+=Ue),!be&&me<Ae&&(Ce=ct(Ce,Ae+100),me=Ce.length);oe<Ae;)Ce[oe]=Ce[oe-ze],++oe}}}return be?[Ce,pe+7>>>3]:[Ce.slice(0,oe),pe+7>>>3]}function Mt(ce,be){var pe=ce.slice(ce.l||0),we=St(pe,be);return ce.l+=we[1],we[0]}function Ot(ce,be){if(ce)typeof console<"u"&&console.error(be);else throw new Error(be)}function Te(ce,be){var pe=ce;ha(pe,0);var we=[],Ce=[],oe={FileIndex:we,FullPaths:Ce};R(oe,{root:be.root});for(var me=pe.length-4;(pe[me]!=80||pe[me+1]!=75||pe[me+2]!=5||pe[me+3]!=6)&&me>=0;)--me;pe.l=me+4,pe.l+=4;var re=pe.read_shift(2);pe.l+=6;var ne=pe.read_shift(4);for(pe.l=ne,me=0;me<re;++me){pe.l+=20;var fe=pe.read_shift(4),de=pe.read_shift(4),Pe=pe.read_shift(2),Ve=pe.read_shift(2),Ae=pe.read_shift(2);pe.l+=8;var Ue=pe.read_shift(4),ze=o(pe.slice(pe.l+Pe,pe.l+Pe+Ve));pe.l+=Pe+Ve+Ae;var pt=pe.l;pe.l=Ue+4,ve(pe,fe,de,oe,ze),pe.l=pt}return oe}function ve(ce,be,pe,we,Ce){ce.l+=2;var oe=ce.read_shift(2),me=ce.read_shift(2),re=i(ce);if(oe&8257)throw new Error("Unsupported ZIP encryption");for(var ne=ce.read_shift(4),fe=ce.read_shift(4),de=ce.read_shift(4),Pe=ce.read_shift(2),Ve=ce.read_shift(2),Ae="",Ue=0;Ue<Pe;++Ue)Ae+=String.fromCharCode(ce[ce.l++]);if(Ve){var ze=o(ce.slice(ce.l,ce.l+Ve));(ze[21589]||{}).mt&&(re=ze[21589].mt),((Ce||{})[21589]||{}).mt&&(re=Ce[21589].mt)}ce.l+=Ve;var pt=ce.slice(ce.l,ce.l+fe);switch(me){case 8:pt=X(ce,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var Bt=!1;oe&8&&(ne=ce.read_shift(4),ne==134695760&&(ne=ce.read_shift(4),Bt=!0),fe=ce.read_shift(4),de=ce.read_shift(4)),fe!=be&&Ot(Bt,"Bad compressed size: "+be+" != "+fe),de!=pe&&Ot(Bt,"Bad uncompressed size: "+pe+" != "+de),cr(we,Ae,pt,{unsafe:!0,mt:re})}function Ne(ce,be){var pe=be||{},we=[],Ce=[],oe=ht(1),me=pe.compression?8:0,re=0,ne=0,fe=0,de=0,Pe=0,Ve=ce.FullPaths[0],Ae=Ve,Ue=ce.FileIndex[0],ze=[],pt=0;for(ne=1;ne<ce.FullPaths.length;++ne)if(Ae=ce.FullPaths[ne].slice(Ve.length),Ue=ce.FileIndex[ne],!(!Ue.size||!Ue.content||Ae=="Sh33tJ5")){var Bt=de,sr=ht(Ae.length);for(fe=0;fe<Ae.length;++fe)sr.write_shift(1,Ae.charCodeAt(fe)&127);sr=sr.slice(0,sr.l),ze[Pe]=Xz.buf(Ue.content,0);var rr=Ue.content;me==8&&(rr=se(rr)),oe=ht(30),oe.write_shift(4,67324752),oe.write_shift(2,20),oe.write_shift(2,re),oe.write_shift(2,me),Ue.mt?a(oe,Ue.mt):oe.write_shift(4,0),oe.write_shift(-4,ze[Pe]),oe.write_shift(4,rr.length),oe.write_shift(4,Ue.content.length),oe.write_shift(2,sr.length),oe.write_shift(2,0),de+=oe.length,we.push(oe),de+=sr.length,we.push(sr),de+=rr.length,we.push(rr),oe=ht(46),oe.write_shift(4,33639248),oe.write_shift(2,0),oe.write_shift(2,20),oe.write_shift(2,re),oe.write_shift(2,me),oe.write_shift(4,0),oe.write_shift(-4,ze[Pe]),oe.write_shift(4,rr.length),oe.write_shift(4,Ue.content.length),oe.write_shift(2,sr.length),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(4,0),oe.write_shift(4,Bt),pt+=oe.l,Ce.push(oe),pt+=sr.length,Ce.push(sr),++Pe}return oe=ht(22),oe.write_shift(4,101010256),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,Pe),oe.write_shift(2,Pe),oe.write_shift(4,pt),oe.write_shift(4,de),oe.write_shift(2,0),Qs([Qs(we),Qs(Ce),oe])}var Fe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function dt(ce,be){if(ce.ctype)return ce.ctype;var pe=ce.name||"",we=pe.match(/\.([^\.]+)$/);return we&&Fe[we[1]]||be&&(we=(pe=be).match(/[\.\\]([^\.\\])+$/),we&&Fe[we[1]])?Fe[we[1]]:"application/octet-stream"}function Wt(ce){for(var be=op(ce),pe=[],we=0;we<be.length;we+=76)pe.push(be.slice(we,we+76));return pe.join(`\r
`)+`\r
`}function Et(ce){var be=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var de=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});be=be.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),be.charAt(0)==`
`&&(be="=0D"+be.slice(1)),be=be.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var pe=[],we=be.split(`\r
`),Ce=0;Ce<we.length;++Ce){var oe=we[Ce];if(oe.length==0){pe.push("");continue}for(var me=0;me<oe.length;){var re=76,ne=oe.slice(me,me+re);ne.charAt(re-1)=="="?re--:ne.charAt(re-2)=="="?re-=2:ne.charAt(re-3)=="="&&(re-=3),ne=oe.slice(me,me+re),me+=re,me<oe.length&&(ne+="="),pe.push(ne)}}return pe.join(`\r
`)}function nr(ce){for(var be=[],pe=0;pe<ce.length;++pe){for(var we=ce[pe];pe<=ce.length&&we.charAt(we.length-1)=="=";)we=we.slice(0,we.length-1)+ce[++pe];be.push(we)}for(var Ce=0;Ce<be.length;++Ce)be[Ce]=be[Ce].replace(/[=][0-9A-Fa-f]{2}/g,function(oe){return String.fromCharCode(parseInt(oe.slice(1),16))});return Ii(be.join(`\r
`))}function Qt(ce,be,pe){for(var we="",Ce="",oe="",me,re=0;re<10;++re){var ne=be[re];if(!ne||ne.match(/^\s*$/))break;var fe=ne.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":we=fe[2].trim();break;case"content-type":oe=fe[2].trim();break;case"content-transfer-encoding":Ce=fe[2].trim();break}}switch(++re,Ce.toLowerCase()){case"base64":me=Ii(Oi(be.slice(re).join("")));break;case"quoted-printable":me=nr(be.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ce)}var de=cr(ce,we.slice(pe.length),me,{unsafe:!0});oe&&(de.ctype=oe)}function Zt(ce,be){if(B(ce.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var pe=be&&be.root||"",we=(Ar&&Buffer.isBuffer(ce)?ce.toString("binary"):B(ce)).split(`\r
`),Ce=0,oe="";for(Ce=0;Ce<we.length;++Ce)if(oe=we[Ce],!!/^Content-Location:/i.test(oe)&&(oe=oe.slice(oe.indexOf("file")),pe||(pe=oe.slice(0,oe.lastIndexOf("/")+1)),oe.slice(0,pe.length)!=pe))for(;pe.length>0&&(pe=pe.slice(0,pe.length-1),pe=pe.slice(0,pe.lastIndexOf("/")+1),oe.slice(0,pe.length)!=pe););var me=(we[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var re="--"+(me[1]||""),ne=[],fe=[],de={FileIndex:ne,FullPaths:fe};R(de);var Pe,Ve=0;for(Ce=0;Ce<we.length;++Ce){var Ae=we[Ce];Ae!==re&&Ae!==re+"--"||(Ve++&&Qt(de,we.slice(Pe,Ce),pe),Pe=Ce)}return de}function Nr(ce,be){var pe=be||{},we=pe.boundary||"SheetJS";we="------="+we;for(var Ce=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+we.slice(2)+'"',"","",""],oe=ce.FullPaths[0],me=oe,re=ce.FileIndex[0],ne=1;ne<ce.FullPaths.length;++ne)if(me=ce.FullPaths[ne].slice(oe.length),re=ce.FileIndex[ne],!(!re.size||!re.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(pt){return"_x"+pt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(pt){return"_u"+pt.charCodeAt(0).toString(16)+"_"});for(var fe=re.content,de=Ar&&Buffer.isBuffer(fe)?fe.toString("binary"):B(fe),Pe=0,Ve=Math.min(1024,de.length),Ae=0,Ue=0;Ue<=Ve;++Ue)(Ae=de.charCodeAt(Ue))>=32&&Ae<128&&++Pe;var ze=Pe>=Ve*4/5;Ce.push(we),Ce.push("Content-Location: "+(pe.root||"file:///C:/SheetJS/")+me),Ce.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),Ce.push("Content-Type: "+dt(re,me)),Ce.push(""),Ce.push(ze?Et(de):Wt(de))}return Ce.push(we+`--\r
`),Ce.join(`\r
`)}function Mr(ce){var be={};return R(be,ce),be}function cr(ce,be,pe,we){var Ce=we&&we.unsafe;Ce||R(ce);var oe=!Ce&&ir.find(ce,be);if(!oe){var me=ce.FullPaths[0];be.slice(0,me.length)==me?me=be:(me.slice(-1)!="/"&&(me+="/"),me=(me+be).replace("//","/")),oe={name:s(be),type:2},ce.FileIndex.push(oe),ce.FullPaths.push(me),Ce||ir.utils.cfb_gc(ce)}return oe.content=pe,oe.size=pe?pe.length:0,we&&(we.CLSID&&(oe.clsid=we.CLSID),we.mt&&(oe.mt=we.mt),we.ct&&(oe.ct=we.ct)),oe}function Fr(ce,be){R(ce);var pe=ir.find(ce,be);if(pe){for(var we=0;we<ce.FileIndex.length;++we)if(ce.FileIndex[we]==pe)return ce.FileIndex.splice(we,1),ce.FullPaths.splice(we,1),!0}return!1}function Pr(ce,be,pe){R(ce);var we=ir.find(ce,be);if(we){for(var Ce=0;Ce<ce.FileIndex.length;++Ce)if(ce.FileIndex[Ce]==we)return ce.FileIndex[Ce].name=s(pe),ce.FullPaths[Ce]=pe,!0}return!1}function Cn(ce){D(ce,!0)}return t.find=O,t.read=A,t.parse=f,t.write=Y,t.writeFile=W,t.utils={cfb_new:Mr,cfb_add:cr,cfb_del:Fr,cfb_mov:Pr,cfb_gc:Cn,ReadShift:Rm,CheckField:bj,prep_blob:ha,bconcat:Qs,use_zlib:H,_deflateRaw:gt,_inflateRaw:Mt,consts:I},t})();function Yz(e){return typeof e=="string"?qy(e):Array.isArray(e)?bz(e):e}function Wp(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=qy(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?_l(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Yz(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Vu(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Jz(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ts(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function g3(e,t){for(var r=[],n=ts(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function Yy(e){for(var t=[],r=ts(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Jy(e){for(var t=[],r=ts(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Qz(e){for(var t=[],r=ts(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var fy=new Date(1899,11,30,0,0,0);function Os(e,t){var r=e.getTime(),n=fy.getTime()+(e.getTimezoneOffset()-fy.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var tj=new Date,Zz=fy.getTime()+(tj.getTimezoneOffset()-fy.getTimezoneOffset())*6e4,m3=tj.getTimezoneOffset();function Qy(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Zz),t.getTimezoneOffset()!==m3&&t.setTime(t.getTime()+(t.getTimezoneOffset()-m3)*6e4),t}function eH(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var p3=new Date("2017-02-19T19:06:09.000Z"),rj=isNaN(p3.getFullYear())?new Date("2/19/17"):p3,tH=rj.getFullYear()==2017;function Fn(e,t){var r=new Date(e);if(tH)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(rj.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function df(e,t){if(Ar&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return _l(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return _l(z8(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return _l(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return _l(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Pn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Pn(e[r]));return t}function Zn(e,t){for(var r="";r.length<t;)r+=e;return r}function Uo(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var rH=["january","february","march","april","may","june","july","august","september","october","november","december"];function c0(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&rH.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var nH=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}})();function nj(e){return e?e.content&&e.type?df(e.content,!0):e.data?_m(e.data):e.asNodeBuffer&&Ar?_m(e.asNodeBuffer().toString("binary")):e.asBinary?_m(e.asBinary()):e._data&&e._data.getContent?_m(df(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function sj(e){if(!e)return null;if(e.data)return s3(e.data);if(e.asNodeBuffer&&Ar)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?s3(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function sH(e){return e&&e.name.slice(-4)===".bin"?sj(e):nj(e)}function io(e,t){for(var r=e.FullPaths||ts(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function iS(e,t){var r=io(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function bs(e,t,r){if(!r)return sH(iS(e,t));if(!t)return null;try{return bs(e,t)}catch{return null}}function Mi(e,t,r){if(!r)return nj(iS(e,t));if(!t)return null;try{return Mi(e,t)}catch{return null}}function aH(e,t,r){return sj(iS(e,t))}function x3(e){for(var t=e.FullPaths||ts(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Cr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ar?n=Nc(r):n=Sz(r),ir.utils.cfb_add(e,t,n)}ir.utils.cfb_add(e,t,r)}else e.file(t,r)}function oS(){return ir.utils.cfb_new()}function aj(e,t){switch(t.type){case"base64":return ir.read(e,{type:"base64"});case"binary":return ir.read(e,{type:"binary"});case"buffer":case"array":return ir.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Sm(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var ms=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,iH=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,y3=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,oH=/<[^>]*>/g,Ba=ms.match(y3)?y3:oH,lH=/<\w*:/,cH=/<(\/?)\w+:/;function gr(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(iH),o=0,c="",d=0,f="",p="",m=1;if(i)for(d=0;d!=i.length;++d){for(p=i[d],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(f=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(m=(s=p.charCodeAt(a+1))==34||s==39?1:0,c=p.slice(a+1+m,p.length-m),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var y=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[y]&&f.slice(o-3,o)=="ext")continue;n[y]=c,n[y.toLowerCase()]=c}}return n}function Al(e){return e.replace(cH,"<$1")}var ij={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},lS=Yy(ij),Kr=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return ij[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),cS=/[&<>'"]/g,uH=/[\u0000-\u0008\u000b-\u001f]/g;function un(e){var t=e+"";return t.replace(cS,function(r){return lS[r]}).replace(uH,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function v3(e){return un(e).replace(/ /g,"_x0020_")}var oj=/[\u0000-\u001f]/g;function uS(e){var t=e+"";return t.replace(cS,function(r){return lS[r]}).replace(/\n/g,"<br/>").replace(oj,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function dH(e){var t=e+"";return t.replace(cS,function(r){return lS[r]}).replace(oj,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var w3=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function fH(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function En(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Iw(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function _3(e){var t=Iu(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function b3(e){return Nc(e,"binary").toString("utf8")}var g1="foo bar bazâð£",pn=Ar&&(b3(g1)==Iw(g1)&&b3||_3(g1)==Iw(g1)&&_3)||Iw,_l=Ar?function(e){return Nc(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},cp=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),lj=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),hH=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),gH=/<\/?(?:vt:)?variant>/g,mH=/<(?:vt:)([^>]*)>([\s\S]*)</;function S3(e,t){var r=gr(e),n=e.match(hH(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(gH,"").match(mH);i&&s.push({v:pn(i[2]),t:i[1]})}),s}var cj=/(^\s|\s$|\n)/;function pa(e,t){return"<"+e+(t.match(cj)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function up(e){return ts(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Pt(e,t,r){return"<"+e+(r!=null?up(r):"")+(t!=null?(t.match(cj)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function t2(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function pH(e,t){switch(typeof e){case"string":var r=Pt("vt:lpwstr",un(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Pt((e|0)==e?"vt:i4":"vt:r8",un(String(e)));case"boolean":return Pt("vt:bool",e?"true":"false")}if(e instanceof Date)return Pt("vt:filetime",t2(e));throw new Error("Unable to serialize "+e)}function dS(e){if(Ar&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return pn(Vu(nS(e)));throw new Error("Bad input format: expected Buffer or string")}var dp=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ms={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},vf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Di={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function xH(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function yH(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var k3=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},C3=Ar?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Nc(t)})):k3(e)}:k3,T3=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(pc(e,s)));return n.join("").replace(si,"")},fS=Ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(si,""):T3(e,t,r)}:T3,E3=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},uj=Ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):E3(e,t,r)}:E3,N3=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Ph(e,s)));return n.join("")},zp=Ar?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):N3(t,r,n)}:N3,dj=function(e,t){var r=Ri(e,t);return r>0?zp(e,t+4,t+4+r-1):""},fj=dj,hj=function(e,t){var r=Ri(e,t);return r>0?zp(e,t+4,t+4+r-1):""},gj=hj,mj=function(e,t){var r=2*Ri(e,t);return r>0?zp(e,t+4,t+4+r-1):""},pj=mj,xj=function(t,r){var n=Ri(t,r);return n>0?fS(t,r+4,r+4+n):""},yj=xj,vj=function(e,t){var r=Ri(e,t);return r>0?zp(e,t+4,t+4+r):""},wj=vj,_j=function(e,t){return xH(e,t)},hy=_j,hS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ar&&(fj=function(t,r){if(!Buffer.isBuffer(t))return dj(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},gj=function(t,r){if(!Buffer.isBuffer(t))return hj(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},pj=function(t,r){if(!Buffer.isBuffer(t))return mj(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},yj=function(t,r){if(!Buffer.isBuffer(t))return xj(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},wj=function(t,r){if(!Buffer.isBuffer(t))return vj(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},hy=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):_j(t,r)},hS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ph=function(e,t){return e[t]},pc=function(e,t){return e[t+1]*256+e[t]},vH=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ri=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Dd=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},wH=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Rm(e,t){var r="",n,s,a=[],i,o,c,d;switch(t){case"dbcs":if(d=this.l,Ar&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(pc(this,d)),d+=2;e*=2;break;case"utf8":r=zp(this,this.l,this.l+e);break;case"utf16le":e*=2,r=fS(this,this.l,this.l+e);break;case"wstr":return Rm.call(this,e,"dbcs");case"lpstr-ansi":r=fj(this,this.l),e=4+Ri(this,this.l);break;case"lpstr-cp":r=gj(this,this.l),e=4+Ri(this,this.l);break;case"lpwstr":r=pj(this,this.l),e=4+2*Ri(this,this.l);break;case"lpp4":e=4+Ri(this,this.l),r=yj(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ri(this,this.l),r=wj(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Ph(this,this.l+e++))!==0;)a.push(h1(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=pc(this,this.l+e))!==0;)a.push(h1(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return i=Ph(this,d),this.l=d+1,o=Rm.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(h1(pc(this,d))),d+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return i=Ph(this,d),this.l=d+1,o=Rm.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(h1(Ph(this,d))),d+=1}r=a.join("");break;default:switch(e){case 1:return n=Ph(this,this.l),this.l++,n;case 2:return n=(t==="i"?vH:pc)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Dd:wH)(this,this.l),this.l+=4,n):(s=Ri(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=hy(this,this.l):s=hy([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=uj(this,this.l,e);break}}return this.l+=e,r}var _H=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},bH=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},SH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function kH(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)SH(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,_H(this,t,this.l);break;case 8:if(n=8,r==="f"){yH(this,t,this.l);break}case 16:break;case-4:n=4,bH(this,t,this.l);break}return this.l+=n,this}function bj(e,t){var r=uj(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ha(e,t){e.l=t,e.read_shift=Rm,e.chk=bj,e.write_shift=kH}function La(e,t){e.l+=t}function ht(e){var t=Iu(e);return ha(t,0),t}function Ac(e,t,r){if(e){var n,s,a;ha(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var d=xp[o]||xp[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var f=d.f&&d.f(e,a,r);if(e.l=c,t(f,d,o))return}}}function bi(){var e=[],t=Ar?256:2048,r=function(d){var f=ht(d);return ha(f,0),f},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(d){return n&&d<n.length-n.l?n:(s(),n=r(Math.max(d+1,t)))},i=function(){return s(),Qs(e)},o=function(d){s(),n=d,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function xt(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=xp[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&hS(r)&&e.push(r)}}function Im(e,t,r){var n=Pn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function A3(e,t,r){var n=Pn(e);return n.s=Im(n.s,t.s,r),n.e=Im(n.e,t.s,r),n}function Mm(e,t){if(e.cRel&&e.c<0)for(e=Pn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Pn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=fr(e);return!e.cRel&&e.cRel!=null&&(r=EH(r)),!e.rRel&&e.rRel!=null&&(r=CH(r)),r}function Mw(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Wn(e.s.c)+":"+(e.e.cRel?"":"$")+Wn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+hs(e.s.r)+":"+(e.e.rRel?"":"$")+hs(e.e.r):Mm(e.s,t.biff)+":"+Mm(e.e,t.biff)}function gS(e){return parseInt(TH(e),10)-1}function hs(e){return""+(e+1)}function CH(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function TH(e){return e.replace(/\$(\d+)$/,"$1")}function mS(e){for(var t=NH(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Wn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function EH(e){return e.replace(/^([A-Z])/,"$$$1")}function NH(e){return e.replace(/^\$([A-Z])/,"$1")}function AH(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function zn(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function fr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Si(e){var t=e.indexOf(":");return t==-1?{s:zn(e),e:zn(e)}:{s:zn(e.slice(0,t)),e:zn(e.slice(t+1))}}function kr(e,t){return typeof t>"u"||typeof t=="number"?kr(e.s,e.e):(typeof e!="string"&&(e=fr(e)),typeof t!="string"&&(t=fr(t)),e==t?e:e+":"+t)}function qr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function j3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=po(e.z,r?Os(t):t)}catch{}try{return e.w=po((e.XF||{}).numFmtId||(r?14:0),r?Os(t):t)}catch{return""+t}}function Cc(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?jc[e.v]||e.v:t==null?j3(e,e.v):j3(e,t))}function Ku(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Sj(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?zn(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=qr(a["!ref"]);d.s.c=f.s.c,d.s.r=f.s.r,d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(d.e.r=i=f.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[p].length;++m)if(!(typeof t[p][m]>"u")){var y={v:t[p][m]},v=i+p,w=o+m;if(d.s.r>v&&(d.s.r=v),d.s.c>w&&(d.s.c=w),d.e.r<v&&(d.e.r=v),d.e.c<w&&(d.e.c=w),t[p][m]&&typeof t[p][m]=="object"&&!Array.isArray(t[p][m])&&!(t[p][m]instanceof Date))y=t[p][m];else if(Array.isArray(y.v)&&(y.f=t[p][m][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||ur[14],n.cellDates?(y.t="d",y.w=po(y.z,Os(y.v))):(y.t="n",y.v=Os(y.v),y.w=po(y.z,y.v))):y.t="s";if(s)a[v]||(a[v]=[]),a[v][w]&&a[v][w].z&&(y.z=a[v][w].z),a[v][w]=y;else{var S=fr({c:w,r:v});a[S]&&a[S].z&&(y.z=a[S].z),a[S]=y}}}return d.s.c<1e7&&(a["!ref"]=kr(d)),a}function j0(e,t){return Sj(null,e,t)}function jH(e){return e.read_shift(4,"i")}function $o(e,t){return t||(t=ht(4)),t.write_shift(4,e),t}function Ia(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Zs(e,t){var r=!1;return t==null&&(r=!0,t=ht(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function FH(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function PH(e,t){return t||(t=ht(4)),t.write_shift(2,0),t.write_shift(2,0),t}function pS(e,t){var r=e.l,n=e.read_shift(1),s=Ia(e),a=[],i={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(FH(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function DH(e,t){var r=!1;return t==null&&(r=!0,t=ht(15+4*e.t.length)),t.write_shift(1,0),Zs(e.t,t),r?t.slice(0,t.l):t}var RH=pS;function IH(e,t){var r=!1;return t==null&&(r=!0,t=ht(23+4*e.t.length)),t.write_shift(1,1),Zs(e.t,t),t.write_shift(4,1),PH({},t),r?t.slice(0,t.l):t}function xo(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function wf(e,t){return t==null&&(t=ht(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function _f(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function bf(e,t){return t==null&&(t=ht(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var MH=Ia,kj=Zs;function xS(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function gy(e,t){var r=!1;return t==null&&(r=!0,t=ht(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var LH=Ia,r2=xS,yS=gy;function vS(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?hy([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Dd(t,0)>>2;return r?s/100:s}function Cj(e,t){t==null&&(t=ht(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Tj(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function OH(e,t){return t||(t=ht(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Sf=Tj,F0=OH;function Fa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ff(e,t){return(t||ht(8)).write_shift(8,e,"f")}function BH(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var d=Gd[s];d&&(t.rgb=hp(d));break;case 2:t.rgb=hp([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function my(e,t){if(t||(t=ht(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function UH(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function $H(e,t){t||(t=ht(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Ej(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function WH(e){return Ej(e,1)}function zH(e){return Ej(e,2)}var wS=2,pi=3,m1=11,F3=12,py=19,p1=64,HH=65,GH=71,VH=4108,KH=4126,Xs=80,Nj=81,qH=[Xs,Nj],n2={1:{n:"CodePage",t:wS},2:{n:"Category",t:Xs},3:{n:"PresentationFormat",t:Xs},4:{n:"ByteCount",t:pi},5:{n:"LineCount",t:pi},6:{n:"ParagraphCount",t:pi},7:{n:"SlideCount",t:pi},8:{n:"NoteCount",t:pi},9:{n:"HiddenCount",t:pi},10:{n:"MultimediaClipCount",t:pi},11:{n:"ScaleCrop",t:m1},12:{n:"HeadingPairs",t:VH},13:{n:"TitlesOfParts",t:KH},14:{n:"Manager",t:Xs},15:{n:"Company",t:Xs},16:{n:"LinksUpToDate",t:m1},17:{n:"CharacterCount",t:pi},19:{n:"SharedDoc",t:m1},22:{n:"HyperlinksChanged",t:m1},23:{n:"AppVersion",t:pi,p:"version"},24:{n:"DigSig",t:HH},26:{n:"ContentType",t:Xs},27:{n:"ContentStatus",t:Xs},28:{n:"Language",t:Xs},29:{n:"Version",t:Xs},255:{},2147483648:{n:"Locale",t:py},2147483651:{n:"Behavior",t:py},1919054434:{}},s2={1:{n:"CodePage",t:wS},2:{n:"Title",t:Xs},3:{n:"Subject",t:Xs},4:{n:"Author",t:Xs},5:{n:"Keywords",t:Xs},6:{n:"Comments",t:Xs},7:{n:"Template",t:Xs},8:{n:"LastAuthor",t:Xs},9:{n:"RevNumber",t:Xs},10:{n:"EditTime",t:p1},11:{n:"LastPrinted",t:p1},12:{n:"CreatedDate",t:p1},13:{n:"ModifiedDate",t:p1},14:{n:"PageCount",t:pi},15:{n:"WordCount",t:pi},16:{n:"CharCount",t:pi},17:{n:"Thumbnail",t:GH},18:{n:"Application",t:Xs},19:{n:"DocSecurity",t:pi},255:{},2147483648:{n:"Locale",t:py},2147483651:{n:"Behavior",t:py},1919054434:{}},P3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XH=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function YH(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var JH=YH([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Gd=Pn(JH),jc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Aj={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},a2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},x1={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function _S(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function QH(e){var t=_S();if(!e||!e.match)return t;var r={};if((e.match(Ba)||[]).forEach(function(n){var s=gr(n);switch(s[0].replace(lH,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[a2[s.ContentType]]!==void 0&&t[a2[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Ms.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function jj(e,t){var r=Qz(a2),n=[],s;n[n.length]=ms,n[n.length]=Pt("Types",null,{xmlns:Ms.CT,"xmlns:xsd":Ms.xsd,"xmlns:xsi":Ms.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Pt("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Pt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:x1[c][t.bookType]||x1[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(d){n[n.length]=Pt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:x1[c][t.bookType]||x1[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(d){n[n.length]=Pt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ir={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function fp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Lm(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Ba)||[]).forEach(function(s){var a=gr(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:Sm(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function Yh(e){var t=[ms,Pt("Relationships",null,{xmlns:Ms.RELS})];return ts(e["!id"]).forEach(function(r){t[t.length]=Pt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function cn(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Ir.HLINK,Ir.XPATH,Ir.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var ZH="application/vnd.oasis.opendocument.spreadsheet";function eG(e,t){for(var r=dS(e),n,s;n=dp.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=gr(n[0],!1),s.path=="/"&&s.type!==ZH)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function tG(e){var t=[ms];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function D3(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function rG(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function nG(e){var t=[ms];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(D3(e[r][0],e[r][1])),t.push(rG("",e[r][0]));return t.push(D3("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Fj(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ly.version+"</meta:generator></office:meta></office:document-meta>"}var ho=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],sG=(function(){for(var e=new Array(ho.length),t=0;t<ho.length;++t){var r=ho[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function Pj(e){var t={};e=pn(e);for(var r=0;r<ho.length;++r){var n=ho[r],s=e.match(sG[r]);s!=null&&s.length>0&&(t[n[1]]=Kr(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Fn(t[n[1]]))}return t}function Lw(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=un(t),n[n.length]=r?Pt(e,t,r):pa(e,t))}function Dj(e,t){var r=t||{},n=[ms,Pt("cp:coreProperties",null,{"xmlns:cp":Ms.CORE_PROPS,"xmlns:dc":Ms.dc,"xmlns:dcterms":Ms.dcterms,"xmlns:dcmitype":Ms.dcmitype,"xmlns:xsi":Ms.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Lw("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:t2(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Lw("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:t2(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=ho.length;++a){var i=ho[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Lw(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Rj=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ij(e,t,r,n){var s=[];if(typeof e=="string")s=S3(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(f){return{v:f}}));var i=typeof t=="string"?S3(t,n).map(function(f){return f.v}):t,o=0,c=0;if(i.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function aG(e,t,r){var n={};return t||(t={}),e=pn(e),Vd.forEach(function(s){var a=(e.match(cp(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=Kr(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Ij(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Mj(e){var t=[],r=Pt;return e||(e={}),e.Application="SheetJS",t[t.length]=ms,t[t.length]=Pt("Properties",null,{xmlns:Ms.EXT_PROPS,"xmlns:vt":Ms.vt}),Vd.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=un(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+un(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var iG=/<[^>]+>[^<]*/g;function oG(e,t){var r={},n="",s=e.match(iG);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=gr(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Kr(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),d=c[0].slice(4),f=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Kr(f);break;case"bool":r[n]=En(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Fn(f);break;case"cy":case"error":r[n]=Kr(f);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,d,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function Lj(e){var t=[ms,Pt("Properties",null,{xmlns:Ms.CUST_PROPS,"xmlns:vt":Ms.vt})];if(!e)return t.join("");var r=1;return ts(e).forEach(function(s){++r,t[t.length]=Pt("property",pH(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:un(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var i2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ow;function lG(e,t,r){Ow||(Ow=Yy(i2)),t=Ow[t]||t,e[t]=r}function cG(e,t){var r=[];return ts(i2).map(function(n){for(var s=0;s<ho.length;++s)if(ho[s][1]==n)return ho[s];for(s=0;s<Vd.length;++s)if(Vd[s][1]==n)return Vd[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(pa(i2[n[1]]||n[1],s))}}),Pt("DocumentProperties",r.join(""),{xmlns:Di.o})}function uG(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&ts(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<ho.length;++i)if(a==ho[i][1])return;for(i=0;i<Vd.length;++i)if(a==Vd[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(Pt(v3(a),o,{"dt:dt":c}))}}),t&&ts(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Pt(v3(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Di.o+'">'+s.join("")+"</"+n+">"}function bS(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function dG(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=ht(8);return i.write_shift(4,n),i.write_shift(4,s),i}function Oj(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function Bj(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Uj(e,t,r){return t===31?Bj(e):Oj(e,t,r)}function o2(e,t,r){return Uj(e,t,r===!1?0:4)}function fG(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Uj(e,t,0)}function hG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(si,""),e.l-s&2&&(e.l+=2)}return r}function gG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(si,"");return r}function mG(e){var t=e.l,r=xy(e,Nj);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=xy(e,pi);return[r,n]}function pG(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(mG(e));return r}function R3(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(si,"").replace(bm,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function $j(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function xG(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function xy(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==F3&&n!==t&&qH.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===F3?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Oj(e,n,4).replace(si,"");case 31:return Bj(e);case 64:return bS(e);case 65:return $j(e);case 71:return xG(e);case 80:return o2(e,n,!a.raw).replace(si,"");case 81:return fG(e,n).replace(si,"");case 4108:return pG(e);case 4126:case 4127:return n==4127?hG(e):gG(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function I3(e,t){var r=ht(4),n=ht(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ht(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=dG(t);break;case 31:case 80:for(n=ht(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Qs([r,n])}function M3(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,d={};for(i=0;i!=s;++i){var f=e.read_shift(4),p=e.read_shift(4);a[i]=[f,p+r]}a.sort(function(k,_){return k[1]-_[1]});var m={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var y=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,y=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],y=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],y=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(y=!1,e.l=a[i][1]),y)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var v=t[a[i][0]];if(m[v.n]=xy(e,v.t,{raw:!0}),v.p==="version"&&(m[v.n]=String(m[v.n]>>16)+"."+("0000"+String(m[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(m[v.n]){case 0:m[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Lo(o=m[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[v.n])}}else if(a[i][0]===1){if(o=m.CodePage=xy(e,wS),Lo(o),c!==-1){var w=e.l;e.l=a[c][1],d=R3(e,o),e.l=w}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}d=R3(e,o)}else{var S=d[a[i][0]],E;switch(e[e.l]){case 65:e.l+=4,E=$j(e);break;case 30:e.l+=4,E=o2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=o2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=us(e,4);break;case 64:e.l+=4,E=Fn(bS(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[S]=E}}return e.l=r+n,m}var Wj=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function yG(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function L3(e,t,r){var n=ht(8),s=[],a=[],i=8,o=0,c=ht(8),d=ht(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),a.push(c),s.push(d),i+=8+c.length,!t){d=ht(8),d.write_shift(4,0),s.unshift(d);var f=[ht(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var p=e[o][0];for(c=ht(8+2*(p.length+1)+(p.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,p.length+1),c.write_shift(0,p,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=Qs(f),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Wj.indexOf(e[o][0])>-1||Rj.indexOf(e[o][0])>-1)&&e[o][1]!=null){var m=e[o][1],y=0;if(t){y=+t[e[o][0]];var v=r[y];if(v.p=="version"&&typeof m=="string"){var w=m.split(".");m=(+w[0]<<16)+(+w[1]||0)}c=I3(v.t,m)}else{var S=yG(m);S==-1&&(S=31,m=String(m)),c=I3(S,m)}a.push(c),d=ht(8),d.write_shift(4,t?y:2+o),s.push(d),i+=8+c.length}var E=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,E),E+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),Qs([n].concat(s).concat(a))}function O3(e,t,r){var n=e.content;if(!n)return{};ha(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),f=n.read_shift(16);if(f!==ir.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var p=M3(n,t),m={SystemIdentifier:d};for(var y in p)m[y]=p[y];if(m.FMTID=a,s===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=M3(n,null)}catch{}for(y in v)m[y]=v[y];return m.FMTID=[a,i],m}function B3(e,t,r,n,s,a){var i=ht(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,ir.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=L3(e,r,n);if(o.push(c),s){var d=L3(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(d)}return Qs(o)}function vu(e,t){return e.read_shift(t),null}function vG(e,t){t||(t=ht(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function wG(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function us(e,t){return e.read_shift(t)===1}function Za(e,t){return t||(t=ht(2)),t.write_shift(2,+!!e),t}function Ss(e){return e.read_shift(2,"u")}function oo(e,t){return t||(t=ht(2)),t.write_shift(2,e),t}function zj(e,t){return wG(e,t,Ss)}function _G(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Hj(e,t,r){return r||(r=ht(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Hp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function bG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var d=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=f,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function SG(e){var t=e.t||"",r=ht(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ht(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Qs(s)}function hf(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Gp(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):hf(e,n,r)}function kf(e,t,r){if(r.biff>5)return Gp(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Gj(e,t,r){return r||(r=ht(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function kG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function CG(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(si,"");return n&&(e.l+=24),s}function TG(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(si,"");return r+i}function EG(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return CG(e);case"0303000000000000c000000000000046":return TG(e);default:throw new Error("Unsupported Moniker "+r)}}function y1(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(si,""):"";return r}function U3(e,t){t||(t=ht(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function NG(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,d="",f,p;s&16&&(a=y1(e,r-e.l)),s&128&&(i=y1(e,r-e.l)),(s&257)===257&&(o=y1(e,r-e.l)),(s&257)===1&&(c=EG(e,r-e.l)),s&8&&(d=y1(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(p=bS(e)),e.l=r;var m=i||o||c||"";m&&d&&(m+="#"+d),m||(m="#"+d),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var y={Target:m};return f&&(y.guid=f),p&&(y.time=p),a&&(y.Tooltip=a),y}function AG(e){var t=ht(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),U3(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&U3(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Vj(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function Kj(e,t){var r=Vj(e);return r[3]=0,r}function jl(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function gf(e,t,r,n){return n||(n=ht(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function jG(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function FG(e,t,r){return t===0?"":kf(e,t,r)}function PG(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function qj(e){var t=e.read_shift(2),r=vS(e);return[t,r]}function DG(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Hp(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function Zy(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Xj(e,t){return t||(t=ht(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Yj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var RG=Yj;function Jj(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function IG(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function MG(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ta(e){e.l+=2,e.l+=e.read_shift(2)}var LG={0:Ta,4:Ta,5:Ta,6:Ta,7:MG,8:Ta,9:Ta,10:Ta,11:Ta,12:Ta,13:IG,14:Ta,15:Ta,16:Ta,17:Ta,18:Ta,19:Ta,20:Ta,21:Jj};function OG(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(LG[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function v1(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function SS(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ht(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function BG(e,t){return t===0||e.read_shift(2),1200}function UG(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=kf(e,0,r);return e.read_shift(t+n-e.l),s}function $G(e,t){var r=!t||t.biff==8,n=ht(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function WG(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function zG(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Hp(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function HG(e,t){var r=!t||t.biff>=8?2:1,n=ht(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function GG(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(bG(e));return a.Count=n,a.Unique=s,a}function VG(e,t){var r=ht(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=SG(e[s]);var a=Qs([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function KG(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function qG(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function XG(e){var t=jG(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function YG(e){return e.read_shift(2),e.read_shift(4)}function $3(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function JG(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:d}}function QG(){var e=ht(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function ZG(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function eV(e){var t=ht(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function tV(){}function rV(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Hp(e,0,r),n}function nV(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=ht(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function sV(e){var t=jl(e);return t.isst=e.read_shift(4),t}function aV(e,t,r,n){var s=ht(10);return gf(e,t,n,s),s.write_shift(4,r),s}function iV(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=jl(e);r.biff==2&&e.l++;var a=Gp(e,n-e.l,r);return s.val=a,s}function oV(e,t,r,n,s){var a=!s||s.biff==8,i=ht(8+ +a+(1+a)*r.length);return gf(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function lV(e,t,r){var n=e.read_shift(2),s=kf(e,0,r);return[n,s]}function cV(e,t,r,n){var s=r&&r.biff==5;n||(n=ht(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var uV=kf;function W3(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function dV(e,t){var r=t.biff==8||!t.biff?4:2,n=ht(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function fV(e){var t=e.read_shift(2),r=e.read_shift(2),n=qj(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function hV(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(qj(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function gV(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function mV(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=XH[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function pV(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=mV(e,t,n.fStyle,r),n}function z3(e,t,r,n){var s=r&&r.biff==5;n||(n=ht(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function xV(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function yV(e){var t=ht(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function H3(e,t,r){var n=jl(e);(r.biff==2||t==9)&&++e.l;var s=_G(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function vV(e,t,r,n,s,a){var i=ht(8);return gf(e,t,n,i),Hj(r,a,i),i}function wV(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=jl(e),s=Fa(e);return n.val=s,n}function _V(e,t,r,n){var s=ht(14);return gf(e,t,n,s),ff(r,s),s}var G3=FG;function bV(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=hf(e,a),o=[];n>e.l;)o.push(Gp(e));return[a,s,i,o]}function V3(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=DG(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var SV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function K3(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=hf(e,i,r);s&32&&(d=SV[d.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var p=n==e.l||o===0||!(f>0)?[]:OY(e,f,r,o);return{chKey:a,Name:d,itab:c,rgce:p}}function Qj(e,t,r){if(r.biff<8)return kV(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(PG(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function kV(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Hp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function CV(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=hf(e,n,r),i=hf(e,s,r);return[a,i]}function TV(e,t,r){var n=Yj(e);e.l++;var s=e.read_shift(1);return t-=8,[BY(e,t,r),s,n]}function q3(e,t,r){var n=RG(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,MY(e,t,r)]}function EV(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function NV(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=kf(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function AV(e,t,r){return NV(e,t,r)}function jV(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Zy(e));return r}function FV(e){var t=ht(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Xj(e[r],t);return t}function PV(e,t,r){if(r&&r.biff<8)return RV(e,t,r);var n=Jj(e),s=OG(e,t-22,n[1]);return{cmo:n,ft:s}}var DV={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function RV(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((DV[n]||La)(e,t,r)),{cmo:[s,n,a],ft:i}}function IV(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=kG(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ss(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var f=e[e.l],p=hf(e,e.lens[d+1]-e.lens[d]-1);if(s+=p,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function MV(e,t){var r=Zy(e);e.l+=16;var n=NG(e,t-24);return[r,n]}function LV(e){var t=ht(24),r=zn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Qs([t,AG(e[1])])}function OV(e,t){e.read_shift(2);var r=Zy(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(si,""),[r,n]}function BV(e){var t=e[1].Tooltip,r=ht(10+2*(t.length+1));r.write_shift(2,2048);var n=zn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function UV(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=P3[r]||r,r=e.read_shift(2),t[1]=P3[r]||r,t}function $V(e){return e||(e=ht(4)),e.write_shift(2,1),e.write_shift(2,1),e}function WV(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Kj(e));return r}function zV(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Kj(e));return r}function HV(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Zj(e,t,r){if(!r.cellStyles)return La(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function GV(e,t){var r=ht(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function VV(e,t){var r={};return t<32||(e.l+=16,r.header=Fa(e),r.footer=Fa(e),e.l+=2),r}function KV(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function qV(e){for(var t=ht(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var XV=jl,YV=zj,JV=Gp;function QV(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function ZV(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=jl(e);++e.l;var s=kf(e,t-7,r);return n.t="str",n.val=s,n}function eK(e){var t=jl(e);++e.l;var r=Fa(e);return t.t="n",t.val=r,t}function tK(e,t,r){var n=ht(15);return Xp(n,e,t),n.write_shift(8,r,"f"),n}function rK(e){var t=jl(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function nK(e,t,r){var n=ht(9);return Xp(n,e,t),n.write_shift(2,r),n}function sK(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function aK(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function iK(e,t,r){var n=e.l+t,s=jl(e),a=e.read_shift(2),i=hf(e,a,r);return e.l=n,s.t="str",s.val=i,s}var oK=[2,3,48,49,131,139,140,245],l2=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Yy({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var d=[],f=Iu(1);switch(c.type){case"base64":f=Ii(Oi(o));break;case"binary":f=Ii(o);break;case"buffer":case"array":f=o;break}ha(f,0);var p=f.read_shift(1),m=!!(p&136),y=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:y=!0,m=!0;break;case 49:y=!0,m=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var w=0,S=521;p==2&&(w=f.read_shift(2)),f.l+=3,p!=2&&(w=f.read_shift(4)),w>1048576&&(w=1e6),p!=2&&(S=f.read_shift(2));var E=f.read_shift(2),k=c.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(k=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var _=[],N={},F=Math.min(f.length,p==2?521:S-10-(y?264:0)),A=v?32:11;f.l<F&&f[f.l]!=13;)switch(N={},N.name=ip.utils.decode(k,f.slice(f.l,f.l+A)).replace(/[\u0000\r\n].*$/g,""),f.l+=A,N.type=String.fromCharCode(f.read_shift(1)),p!=2&&!v&&(N.offset=f.read_shift(4)),N.len=f.read_shift(1),p==2&&(N.offset=f.read_shift(2)),N.dec=f.read_shift(1),N.name.length&&_.push(N),p!=2&&(f.l+=v?13:14),N.type){case"B":(!y||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(f[f.l]!==13&&(f.l=S-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=S;var R=0,T=0;for(d[0]=[],T=0;T!=_.length;++T)d[0][T]=_[T].name;for(;w-- >0;){if(f[f.l]===42){f.l+=E;continue}for(++f.l,d[++R]=[],T=0,T=0;T!=_.length;++T){var D=f.slice(f.l,f.l+_[T].len);f.l+=_[T].len,ha(D,0);var L=ip.utils.decode(k,D);switch(_[T].type){case"C":L.trim().length&&(d[R][T]=L.replace(/\s+$/,""));break;case"D":L.length===8?d[R][T]=new Date(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8)):d[R][T]=L;break;case"F":d[R][T]=parseFloat(L.trim());break;case"+":case"I":d[R][T]=v?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":d[R][T]=!0;break;case"N":case"F":d[R][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));d[R][T]="##MEMO##"+(v?parseInt(L.trim(),10):D.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(d[R][T]=+L||0);break;case"@":d[R][T]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":d[R][T]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":d[R][T]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[R][T]=-D.read_shift(-8,"f");break;case"B":if(y&&_[T].len==8){d[R][T]=D.read_shift(8,"f");break}case"G":case"P":D.l+=_[T].len;break;case"0":if(_[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[T].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=_,d}function n(o,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var f=j0(r(o,d),d);return f["!cols"]=d.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete d.DBF,f}function s(o,c){try{return Ku(n(o,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var d=c||{};if(+d.codepage>=0&&Lo(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var f=bi(),p=wy(o,{header:1,raw:!0,cellDates:!0}),m=p[0],y=p.slice(1),v=o["!cols"]||[],w=0,S=0,E=0,k=1;for(w=0;w<m.length;++w){if(((v[w]||{}).DBF||{}).name){m[w]=v[w].DBF.name,++E;continue}if(m[w]!=null){if(++E,typeof m[w]=="number"&&(m[w]=m[w].toString(10)),typeof m[w]!="string")throw new Error("DBF Invalid column name "+m[w]+" |"+typeof m[w]+"|");if(m.indexOf(m[w])!==w){for(S=0;S<1024;++S)if(m.indexOf(m[w]+"_"+S)==-1){m[w]+="_"+S;break}}}}var _=qr(o["!ref"]),N=[],F=[],A=[];for(w=0;w<=_.e.c-_.s.c;++w){var R="",T="",D=0,L=[];for(S=0;S<y.length;++S)y[S][w]!=null&&L.push(y[S][w]);if(L.length==0||m[w]==null){N[w]="?";continue}for(S=0;S<L.length;++S){switch(typeof L[S]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=L[S]instanceof Date?"D":"C";break;default:T="C"}D=Math.max(D,String(L[S]).length),R=R&&R!=T?"C":T}D>250&&(D=250),T=((v[w]||{}).DBF||{}).type,T=="C"&&v[w].DBF.len>D&&(D=v[w].DBF.len),R=="B"&&T=="N"&&(R="N",A[w]=v[w].DBF.dec,D=v[w].DBF.len),F[w]=R=="C"||T=="N"?D:a[R]||0,k+=F[w],N[w]=R}var O=f.next(32);for(O.write_shift(4,318902576),O.write_shift(4,y.length),O.write_shift(2,296+32*E),O.write_shift(2,k),w=0;w<4;++w)O.write_shift(4,0);for(O.write_shift(4,0|(+t[W8]||3)<<8),w=0,S=0;w<m.length;++w)if(m[w]!=null){var G=f.next(32),K=(m[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,K,"sbcs"),G.write_shift(1,N[w]=="?"?"C":N[w],"sbcs"),G.write_shift(4,S),G.write_shift(1,F[w]||a[N[w]]||0),G.write_shift(1,A[w]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),S+=F[w]||a[N[w]]||0}var te=f.next(264);for(te.write_shift(4,13),w=0;w<65;++w)te.write_shift(4,0);for(w=0;w<y.length;++w){var Z=f.next(k);for(Z.write_shift(1,0),S=0;S<m.length;++S)if(m[S]!=null)switch(N[S]){case"L":Z.write_shift(1,y[w][S]==null?63:y[w][S]?84:70);break;case"B":Z.write_shift(8,y[w][S]||0,"f");break;case"N":var J="0";for(typeof y[w][S]=="number"&&(J=y[w][S].toFixed(A[S]||0)),E=0;E<F[S]-J.length;++E)Z.write_shift(1,32);Z.write_shift(1,J,"sbcs");break;case"D":y[w][S]?(Z.write_shift(4,("0000"+y[w][S].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(y[w][S].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+y[w][S].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var I=String(y[w][S]!=null?y[w][S]:"").slice(0,F[S]);for(Z.write_shift(1,I,"sbcs"),E=0;E<F[S]-I.length;++E)Z.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),eF=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ts(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,y){var v=e[y];return typeof v=="number"?a3(v):v},n=function(m,y,v){var w=y.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return w==59?m:a3(w)};e["|"]=254;function s(m,y){switch(y.type){case"base64":return a(Oi(m),y);case"binary":return a(m,y);case"buffer":return a(Ar&&Buffer.isBuffer(m)?m.toString("binary"):Vu(m),y);case"array":return a(df(m),y)}throw new Error("Unrecognized type "+y.type)}function a(m,y){var v=m.split(/[\n\r]+/),w=-1,S=-1,E=0,k=0,_=[],N=[],F=null,A={},R=[],T=[],D=[],L=0,O;for(+y.codepage>=0&&Lo(+y.codepage);E!==v.length;++E){L=0;var G=v[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),K=G.replace(/;;/g,"\0").split(";").map(function(ie){return ie.replace(/\u0000/g,";")}),te=K[0],Z;if(G.length>0)switch(te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&N.push(G.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,I=!1,W=!1,B=!1,Y=-1,V=-1;for(k=1;k<K.length;++k)switch(K[k].charAt(0)){case"A":break;case"X":S=parseInt(K[k].slice(1))-1,I=!0;break;case"Y":for(w=parseInt(K[k].slice(1))-1,I||(S=0),O=_.length;O<=w;++O)_[O]=[];break;case"K":Z=K[k].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(Uo(Z))?isNaN(c0(Z).getDate())||(Z=Fn(Z)):(Z=Uo(Z),F!==null&&N0(F)&&(Z=Qy(Z))),J=!0;break;case"E":B=!0;var H=Jh(K[k].slice(1),{r:w,c:S});_[w][S]=[_[w][S],H];break;case"S":W=!0,_[w][S]=[_[w][S],"S5S"];break;case"G":break;case"R":Y=parseInt(K[k].slice(1))-1;break;case"C":V=parseInt(K[k].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+G)}if(J&&(_[w][S]&&_[w][S].length==2?_[w][S][0]=Z:_[w][S]=Z,F=null),W){if(B)throw new Error("SYLK shared formula cannot have own formula");var X=Y>-1&&_[Y][V];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");_[w][S][1]=yF(X[1],{r:w-Y,c:S-V})}break;case"F":var se=0;for(k=1;k<K.length;++k)switch(K[k].charAt(0)){case"X":S=parseInt(K[k].slice(1))-1,++se;break;case"Y":for(w=parseInt(K[k].slice(1))-1,O=_.length;O<=w;++O)_[O]=[];break;case"M":L=parseInt(K[k].slice(1))/20;break;case"F":break;case"G":break;case"P":F=N[parseInt(K[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=K[k].slice(1).split(" "),O=parseInt(D[0],10);O<=parseInt(D[1],10);++O)L=parseInt(D[2],10),T[O-1]=L===0?{hidden:!0}:{wch:L},Mu(T[O-1]);break;case"C":S=parseInt(K[k].slice(1))-1,T[S]||(T[S]={});break;case"R":w=parseInt(K[k].slice(1))-1,R[w]||(R[w]={}),L>0?(R[w].hpt=L,R[w].hpx=d0(L)):L===0&&(R[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+G)}se<1&&(F=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+G)}}return R.length>0&&(A["!rows"]=R),T.length>0&&(A["!cols"]=T),y&&y.sheetRows&&(_=_.slice(0,y.sheetRows)),[_,A]}function i(m,y){var v=s(m,y),w=v[0],S=v[1],E=j0(w,y);return ts(S).forEach(function(k){E[k]=S[k]}),E}function o(m,y){return Ku(i(m,y),y)}function c(m,y,v,w){var S="C;Y"+(v+1)+";X"+(w+1)+";K";switch(m.t){case"n":S+=m.v||0,m.f&&!m.F&&(S+=";E"+AS(m.f,{r:v,c:w}));break;case"b":S+=m.v?"TRUE":"FALSE";break;case"e":S+=m.w||m.v;break;case"d":S+='"'+(m.w||m.v)+'"';break;case"s":S+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(m,y){y.forEach(function(v,w){var S="F;W"+(w+1)+" "+(w+1)+" ";v.hidden?S+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=gp(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=mp(v.wpx)),typeof v.wch=="number"&&(S+=Math.round(v.wch))),S.charAt(S.length-1)!=" "&&m.push(S)})}function f(m,y){y.forEach(function(v,w){var S="F;";v.hidden?S+="M0;":v.hpt?S+="M"+20*v.hpt+";":v.hpx&&(S+="M"+20*pp(v.hpx)+";"),S.length>2&&m.push(S+"R"+(w+1))})}function p(m,y){var v=["ID;PWXL;N;E"],w=[],S=qr(m["!ref"]),E,k=Array.isArray(m),_=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),m["!cols"]&&d(v,m["!cols"]),m["!rows"]&&f(v,m["!rows"]),v.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var N=S.s.r;N<=S.e.r;++N)for(var F=S.s.c;F<=S.e.c;++F){var A=fr({r:N,c:F});E=k?(m[N]||[])[F]:m[A],!(!E||E.v==null&&(!E.f||E.F))&&w.push(c(E,m,N,F))}return v.join(_)+_+w.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:i,from_sheet:p}})(),tF=(function(){function e(a,i){switch(i.type){case"base64":return t(Oi(a),i);case"binary":return t(a,i);case"buffer":return t(Ar&&Buffer.isBuffer(a)?a.toString("binary"):Vu(a),i);case"array":return t(df(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,d=-1,f=0,p=[];f!==o.length;++f){if(o[f].trim()==="BOT"){p[++c]=[],d=0;continue}if(!(c<0)){var m=o[f].trim().split(","),y=m[0],v=m[1];++f;for(var w=o[f]||"";(w.match(/["]/g)||[]).length&1&&f<o.length-1;)w+=`
`+o[++f];switch(w=w.trim(),+y){case-1:if(w==="BOT"){p[++c]=[],d=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?p[c][d]=!0:w==="FALSE"?p[c][d]=!1:isNaN(Uo(v))?isNaN(c0(v).getDate())?p[c][d]=v:p[c][d]=Fn(v):p[c][d]=Uo(v),++d;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),p[c][d++]=w!==""?w:null;break}if(w==="EOD")break}}return i&&i.sheetRows&&(p=p.slice(0,i.sheetRows)),p}function r(a,i){return j0(e(a,i),i)}function n(a,i){return Ku(r(a,i),i)}var s=(function(){var a=function(c,d,f,p,m){c.push(d),c.push(f+","+p),c.push('"'+m.replace(/"/g,'""')+'"')},i=function(c,d,f,p){c.push(d+","+f),c.push(d==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var d=[],f=qr(c["!ref"]),p,m=Array.isArray(c);a(d,"TABLE",0,1,"sheetjs"),a(d,"VECTORS",0,f.e.r-f.s.r+1,""),a(d,"TUPLES",0,f.e.c-f.s.c+1,""),a(d,"DATA",0,0,"");for(var y=f.s.r;y<=f.e.r;++y){i(d,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var w=fr({r:y,c:v});if(p=m?(c[y]||[])[v]:c[w],!p){i(d,1,0,"");continue}switch(p.t){case"n":var S=p.w;!S&&p.v!=null&&(S=p.v),S==null?p.f&&!p.F?i(d,1,0,"="+p.f):i(d,1,0,""):i(d,0,S,"V");break;case"b":i(d,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":i(d,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=po(p.z||ur[14],Os(Fn(p.v)))),i(d,0,p.w,"V");break;default:i(d,1,0,"")}}}i(d,-1,0,"EOD");var E=`\r
`,k=d.join(E);return k}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),rF=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,m){for(var y=p.split(`
`),v=-1,w=-1,S=0,E=[];S!==y.length;++S){var k=y[S].trim().split(":");if(k[0]==="cell"){var _=zn(k[1]);if(E.length<=_.r)for(v=E.length;v<=_.r;++v)E[v]||(E[v]=[]);switch(v=_.r,w=_.c,k[2]){case"t":E[v][w]=e(k[3]);break;case"v":E[v][w]=+k[3];break;case"vtf":var N=k[k.length-1];case"vtc":switch(k[3]){case"nl":E[v][w]=!!+k[4];break;default:E[v][w]=+k[4];break}k[2]=="vtf"&&(E[v][w]=[E[v][w],N])}}}return m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),E}function n(p,m){return j0(r(p,m),m)}function s(p,m){return Ku(n(p,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(p){if(!p||!p["!ref"])return"";for(var m=[],y=[],v,w="",S=Si(p["!ref"]),E=Array.isArray(p),k=S.s.r;k<=S.e.r;++k)for(var _=S.s.c;_<=S.e.c;++_)if(w=fr({r:k,c:_}),v=E?(p[k]||[])[_]:p[w],!(!v||v.v==null||v.t==="z")){switch(y=["cell",w,"t"],v.t){case"s":case"str":y.push(t(v.v));break;case"n":v.f?(y[2]="vtf",y[3]="n",y[4]=v.v,y[5]=t(v.f)):(y[2]="v",y[3]=v.v);break;case"b":y[2]="vt"+(v.f?"f":"c"),y[3]="nl",y[4]=v.v?"1":"0",y[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=Os(Fn(v.v));y[2]="vtc",y[3]="nd",y[4]=""+N,y[5]=v.w||po(v.z||ur[14],N);break;case"e":continue}m.push(y.join(":"))}return m.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function f(p){return[a,i,o,i,d(p),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}})(),u0=(function(){function e(f,p,m,y,v){v.raw?p[m][y]=f:f===""||(f==="TRUE"?p[m][y]=!0:f==="FALSE"?p[m][y]=!1:isNaN(Uo(f))?isNaN(c0(f).getDate())?p[m][y]=f:p[m][y]=Fn(f):p[m][y]=Uo(f))}function t(f,p){var m=p||{},y=[];if(!f||f.length===0)return y;for(var v=f.split(/[\r\n]/),w=v.length-1;w>=0&&v[w].length===0;)--w;for(var S=10,E=0,k=0;k<=w;++k)E=v[k].indexOf(" "),E==-1?E=v[k].length:E++,S=Math.max(S,E);for(k=0;k<=w;++k){y[k]=[];var _=0;for(e(v[k].slice(0,S).trim(),y,k,_,m),_=1;_<=(v[k].length-S)/10+1;++_)e(v[k].slice(S+(_-1)*10,S+_*10).trim(),y,k,_,m)}return m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var p={},m=!1,y=0,v=0;y<f.length;++y)(v=f.charCodeAt(y))==34?m=!m:!m&&v in r&&(p[v]=(p[v]||0)+1);v=[];for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&v.push([p[y],y]);if(!v.length){p=n;for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&v.push([p[y],y])}return v.sort(function(w,S){return w[0]-S[0]||n[w[1]]-n[S[1]]}),r[v.pop()[1]]||44}function a(f,p){var m=p||{},y="",v=m.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(y=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(y=f.charAt(4),f=f.slice(6)):y=s(f.slice(0,1024)):m&&m.FS?y=m.FS:y=s(f.slice(0,1024));var S=0,E=0,k=0,_=0,N=0,F=y.charCodeAt(0),A=!1,R=0,T=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var D=m.dateNF!=null?Kz(m.dateNF):null;function L(){var O=f.slice(_,N),G={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)G.t="z";else if(m.raw)G.t="s",G.v=O;else if(O.trim().length===0)G.t="s",G.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(G.t="s",G.v=O.slice(2,-1).replace(/""/g,'"')):bX(O)?(G.t="n",G.f=O.slice(1)):(G.t="s",G.v=O);else if(O=="TRUE")G.t="b",G.v=!0;else if(O=="FALSE")G.t="b",G.v=!1;else if(!isNaN(k=Uo(O)))G.t="n",m.cellText!==!1&&(G.w=O),G.v=k;else if(!isNaN(c0(O).getDate())||D&&O.match(D)){G.z=m.dateNF||ur[14];var K=0;D&&O.match(D)&&(O=qz(O,m.dateNF,O.match(D)||[]),K=1),m.cellDates?(G.t="d",G.v=Fn(O,K)):(G.t="n",G.v=Os(Fn(O,K))),m.cellText!==!1&&(G.w=po(G.z,G.v instanceof Date?Os(G.v):G.v)),m.cellNF||delete G.z}else G.t="s",G.v=O;if(G.t=="z"||(m.dense?(v[S]||(v[S]=[]),v[S][E]=G):v[fr({c:E,r:S})]=G),_=N+1,T=f.charCodeAt(_),w.e.c<E&&(w.e.c=E),w.e.r<S&&(w.e.r=S),R==F)++E;else if(E=0,++S,m.sheetRows&&m.sheetRows<=S)return!0}e:for(;N<f.length;++N)switch(R=f.charCodeAt(N)){case 34:T===34&&(A=!A);break;case F:case 10:case 13:if(!A&&L())break e;break}return N-_>0&&L(),v["!ref"]=kr(w),v}function i(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,p):j0(t(f,p),p)}function o(f,p){var m="",y=p.type=="string"?[0,0,0,0]:LS(f,p);switch(p.type){case"base64":m=Oi(f);break;case"binary":m=f;break;case"buffer":p.codepage==65001?m=f.toString("utf8"):p.codepage&&typeof ip<"u"||(m=Ar&&Buffer.isBuffer(f)?f.toString("binary"):Vu(f));break;case"array":m=df(f);break;case"string":m=f;break;default:throw new Error("Unrecognized type "+p.type)}return y[0]==239&&y[1]==187&&y[2]==191?m=pn(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=pn(m):p.type=="binary"&&typeof ip<"u",m.slice(0,19)=="socialcalc:version:"?rF.to_sheet(p.type=="string"?m:pn(m),p):i(m,p)}function c(f,p){return Ku(o(f,p),p)}function d(f){for(var p=[],m=qr(f["!ref"]),y,v=Array.isArray(f),w=m.s.r;w<=m.e.r;++w){for(var S=[],E=m.s.c;E<=m.e.c;++E){var k=fr({r:w,c:E});if(y=v?(f[w]||[])[E]:f[k],!y||y.v==null){S.push("          ");continue}for(var _=(y.w||(Cc(y),y.w)||"").slice(0,10);_.length<10;)_+=" ";S.push(_+(E===0?" ":""))}p.push(S.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:d}})();function lK(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=eF.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return u0.to_workbook(e,t)}}var Kd=(function(){function e(H,X,se){if(H){ha(H,H.l||0);for(var ie=se.Enum||Y;H.l<H.length;){var ae=H.read_shift(2),Q=ie[ae]||ie[65535],le=H.read_shift(2),_e=H.l+le,ke=Q.f&&Q.f(H,le,se);if(H.l=_e,X(ke,Q,ae))return}}}function t(H,X){switch(X.type){case"base64":return r(Ii(Oi(H)),X);case"binary":return r(Ii(H),X);case"buffer":case"array":return r(H,X)}throw"Unsupported type "+X.type}function r(H,X){if(!H)return H;var se=X||{},ie=se.dense?[]:{},ae="Sheet1",Q="",le=0,_e={},ke=[],Oe=[],ge={s:{r:0,c:0},e:{r:0,c:0}},ye=se.sheetRows||0;if(H[2]==0&&(H[3]==8||H[3]==9)&&H.length>=16&&H[14]==5&&H[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(H[2]==2)se.Enum=Y,e(H,function(Ye,We,Me){switch(Me){case 0:se.vers=Ye,Ye>=4096&&(se.qpro=!0);break;case 6:ge=Ye;break;case 204:Ye&&(Q=Ye);break;case 222:Q=Ye;break;case 15:case 51:se.qpro||(Ye[1].v=Ye[1].v.slice(1));case 13:case 14:case 16:Me==14&&(Ye[2]&112)==112&&(Ye[2]&15)>1&&(Ye[2]&15)<15&&(Ye[1].z=se.dateNF||ur[14],se.cellDates&&(Ye[1].t="d",Ye[1].v=Qy(Ye[1].v))),se.qpro&&Ye[3]>le&&(ie["!ref"]=kr(ge),_e[ae]=ie,ke.push(ae),ie=se.dense?[]:{},ge={s:{r:0,c:0},e:{r:0,c:0}},le=Ye[3],ae=Q||"Sheet"+(le+1),Q="");var je=se.dense?(ie[Ye[0].r]||[])[Ye[0].c]:ie[fr(Ye[0])];if(je){je.t=Ye[1].t,je.v=Ye[1].v,Ye[1].z!=null&&(je.z=Ye[1].z),Ye[1].f!=null&&(je.f=Ye[1].f);break}se.dense?(ie[Ye[0].r]||(ie[Ye[0].r]=[]),ie[Ye[0].r][Ye[0].c]=Ye[1]):ie[fr(Ye[0])]=Ye[1];break}},se);else if(H[2]==26||H[2]==14)se.Enum=V,H[2]==14&&(se.qpro=!0,H.l=0),e(H,function(Ye,We,Me){switch(Me){case 204:ae=Ye;break;case 22:Ye[1].v=Ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ye[3]>le&&(ie["!ref"]=kr(ge),_e[ae]=ie,ke.push(ae),ie=se.dense?[]:{},ge={s:{r:0,c:0},e:{r:0,c:0}},le=Ye[3],ae="Sheet"+(le+1)),ye>0&&Ye[0].r>=ye)break;se.dense?(ie[Ye[0].r]||(ie[Ye[0].r]=[]),ie[Ye[0].r][Ye[0].c]=Ye[1]):ie[fr(Ye[0])]=Ye[1],ge.e.c<Ye[0].c&&(ge.e.c=Ye[0].c),ge.e.r<Ye[0].r&&(ge.e.r=Ye[0].r);break;case 27:Ye[14e3]&&(Oe[Ye[14e3][0]]=Ye[14e3][1]);break;case 1537:Oe[Ye[0]]=Ye[1],Ye[0]==le&&(ae=Ye[1]);break}},se);else throw new Error("Unrecognized LOTUS BOF "+H[2]);if(ie["!ref"]=kr(ge),_e[Q||ae]=ie,ke.push(Q||ae),!Oe.length)return{SheetNames:ke,Sheets:_e};for(var Ke={},Xe=[],lt=0;lt<Oe.length;++lt)_e[ke[lt]]?(Xe.push(Oe[lt]||ke[lt]),Ke[Oe[lt]]=_e[Oe[lt]]||_e[ke[lt]]):(Xe.push(Oe[lt]),Ke[Oe[lt]]={"!ref":"A1"});return{SheetNames:Xe,Sheets:Ke}}function n(H,X){var se=X||{};if(+se.codepage>=0&&Lo(+se.codepage),se.type=="string")throw new Error("Cannot write WK1 to JS string");var ie=bi(),ae=qr(H["!ref"]),Q=Array.isArray(H),le=[];Dt(ie,0,a(1030)),Dt(ie,6,c(ae));for(var _e=Math.min(ae.e.r,8191),ke=ae.s.r;ke<=_e;++ke)for(var Oe=hs(ke),ge=ae.s.c;ge<=ae.e.c;++ge){ke===ae.s.r&&(le[ge]=Wn(ge));var ye=le[ge]+Oe,Ke=Q?(H[ke]||[])[ge]:H[ye];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?Dt(ie,13,y(ke,ge,Ke.v)):Dt(ie,14,w(ke,ge,Ke.v));else{var Xe=Cc(Ke);Dt(ie,15,p(ke,ge,Xe.slice(0,239)))}}return Dt(ie,1),ie.end()}function s(H,X){var se=X||{};if(+se.codepage>=0&&Lo(+se.codepage),se.type=="string")throw new Error("Cannot write WK3 to JS string");var ie=bi();Dt(ie,0,i(H));for(var ae=0,Q=0;ae<H.SheetNames.length;++ae)(H.Sheets[H.SheetNames[ae]]||{})["!ref"]&&Dt(ie,27,B(H.SheetNames[ae],Q++));var le=0;for(ae=0;ae<H.SheetNames.length;++ae){var _e=H.Sheets[H.SheetNames[ae]];if(!(!_e||!_e["!ref"])){for(var ke=qr(_e["!ref"]),Oe=Array.isArray(_e),ge=[],ye=Math.min(ke.e.r,8191),Ke=ke.s.r;Ke<=ye;++Ke)for(var Xe=hs(Ke),lt=ke.s.c;lt<=ke.e.c;++lt){Ke===ke.s.r&&(ge[lt]=Wn(lt));var Ye=ge[lt]+Xe,We=Oe?(_e[Ke]||[])[lt]:_e[Ye];if(!(!We||We.t=="z"))if(We.t=="n")Dt(ie,23,L(Ke,lt,le,We.v));else{var Me=Cc(We);Dt(ie,22,R(Ke,lt,le,Me.slice(0,239)))}}++le}}return Dt(ie,1),ie.end()}function a(H){var X=ht(2);return X.write_shift(2,H),X}function i(H){var X=ht(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var se=0,ie=0,ae=0,Q=0;Q<H.SheetNames.length;++Q){var le=H.SheetNames[Q],_e=H.Sheets[le];if(!(!_e||!_e["!ref"])){++ae;var ke=Si(_e["!ref"]);se<ke.e.r&&(se=ke.e.r),ie<ke.e.c&&(ie=ke.e.c)}}return se>8191&&(se=8191),X.write_shift(2,se),X.write_shift(1,ae),X.write_shift(1,ie),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function o(H,X,se){var ie={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&se.qpro?(ie.s.c=H.read_shift(1),H.l++,ie.s.r=H.read_shift(2),ie.e.c=H.read_shift(1),H.l++,ie.e.r=H.read_shift(2),ie):(ie.s.c=H.read_shift(2),ie.s.r=H.read_shift(2),X==12&&se.qpro&&(H.l+=2),ie.e.c=H.read_shift(2),ie.e.r=H.read_shift(2),X==12&&se.qpro&&(H.l+=2),ie.s.c==65535&&(ie.s.c=ie.e.c=ie.s.r=ie.e.r=0),ie)}function c(H){var X=ht(8);return X.write_shift(2,H.s.c),X.write_shift(2,H.s.r),X.write_shift(2,H.e.c),X.write_shift(2,H.e.r),X}function d(H,X,se){var ie=[{c:0,r:0},{t:"n",v:0},0,0];return se.qpro&&se.vers!=20768?(ie[0].c=H.read_shift(1),ie[3]=H.read_shift(1),ie[0].r=H.read_shift(2),H.l+=2):(ie[2]=H.read_shift(1),ie[0].c=H.read_shift(2),ie[0].r=H.read_shift(2)),ie}function f(H,X,se){var ie=H.l+X,ae=d(H,X,se);if(ae[1].t="s",se.vers==20768){H.l++;var Q=H.read_shift(1);return ae[1].v=H.read_shift(Q,"utf8"),ae}return se.qpro&&H.l++,ae[1].v=H.read_shift(ie-H.l,"cstr"),ae}function p(H,X,se){var ie=ht(7+se.length);ie.write_shift(1,255),ie.write_shift(2,X),ie.write_shift(2,H),ie.write_shift(1,39);for(var ae=0;ae<ie.length;++ae){var Q=se.charCodeAt(ae);ie.write_shift(1,Q>=128?95:Q)}return ie.write_shift(1,0),ie}function m(H,X,se){var ie=d(H,X,se);return ie[1].v=H.read_shift(2,"i"),ie}function y(H,X,se){var ie=ht(7);return ie.write_shift(1,255),ie.write_shift(2,X),ie.write_shift(2,H),ie.write_shift(2,se,"i"),ie}function v(H,X,se){var ie=d(H,X,se);return ie[1].v=H.read_shift(8,"f"),ie}function w(H,X,se){var ie=ht(13);return ie.write_shift(1,255),ie.write_shift(2,X),ie.write_shift(2,H),ie.write_shift(8,se,"f"),ie}function S(H,X,se){var ie=H.l+X,ae=d(H,X,se);if(ae[1].v=H.read_shift(8,"f"),se.qpro)H.l=ie;else{var Q=H.read_shift(2);N(H.slice(H.l,H.l+Q),ae),H.l+=Q}return ae}function E(H,X,se){var ie=X&32768;return X&=-32769,X=(ie?H:0)+(X>=8192?X-16384:X),(ie?"":"$")+(se?Wn(X):hs(X))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(H,X){ha(H,0);for(var se=[],ie=0,ae="",Q="",le="",_e="";H.l<H.length;){var ke=H[H.l++];switch(ke){case 0:se.push(H.read_shift(8,"f"));break;case 1:Q=E(X[0].c,H.read_shift(2),!0),ae=E(X[0].r,H.read_shift(2),!1),se.push(Q+ae);break;case 2:{var Oe=E(X[0].c,H.read_shift(2),!0),ge=E(X[0].r,H.read_shift(2),!1);Q=E(X[0].c,H.read_shift(2),!0),ae=E(X[0].r,H.read_shift(2),!1),se.push(Oe+ge+":"+Q+ae)}break;case 3:if(H.l<H.length){console.error("WK1 premature formula end");return}break;case 4:se.push("("+se.pop()+")");break;case 5:se.push(H.read_shift(2));break;case 6:{for(var ye="";ke=H[H.l++];)ye+=String.fromCharCode(ke);se.push('"'+ye.replace(/"/g,'""')+'"')}break;case 8:se.push("-"+se.pop());break;case 23:se.push("+"+se.pop());break;case 22:se.push("NOT("+se.pop()+")");break;case 20:case 21:_e=se.pop(),le=se.pop(),se.push(["AND","OR"][ke-20]+"("+le+","+_e+")");break;default:if(ke<32&&_[ke])_e=se.pop(),le=se.pop(),se.push(le+_[ke]+_e);else if(k[ke]){if(ie=k[ke][1],ie==69&&(ie=H[H.l++]),ie>se.length){console.error("WK1 bad formula parse 0x"+ke.toString(16)+":|"+se.join("|")+"|");return}var Ke=se.slice(-ie);se.length-=ie,se.push(k[ke][0]+"("+Ke.join(",")+")")}else return ke<=7?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=24?console.error("WK1 unsupported op "+ke.toString(16)):ke<=30?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=115?console.error("WK1 unsupported function opcode "+ke.toString(16)):console.error("WK1 unrecognized opcode "+ke.toString(16))}}se.length==1?X[1].f=""+se[0]:console.error("WK1 bad formula parse |"+se.join("|")+"|")}function F(H){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=H.read_shift(2),X[3]=H[H.l++],X[0].c=H[H.l++],X}function A(H,X){var se=F(H);return se[1].t="s",se[1].v=H.read_shift(X-4,"cstr"),se}function R(H,X,se,ie){var ae=ht(6+ie.length);ae.write_shift(2,H),ae.write_shift(1,se),ae.write_shift(1,X),ae.write_shift(1,39);for(var Q=0;Q<ie.length;++Q){var le=ie.charCodeAt(Q);ae.write_shift(1,le>=128?95:le)}return ae.write_shift(1,0),ae}function T(H,X){var se=F(H);se[1].v=H.read_shift(2);var ie=se[1].v>>1;if(se[1].v&1)switch(ie&7){case 0:ie=(ie>>3)*5e3;break;case 1:ie=(ie>>3)*500;break;case 2:ie=(ie>>3)/20;break;case 3:ie=(ie>>3)/200;break;case 4:ie=(ie>>3)/2e3;break;case 5:ie=(ie>>3)/2e4;break;case 6:ie=(ie>>3)/16;break;case 7:ie=(ie>>3)/64;break}return se[1].v=ie,se}function D(H,X){var se=F(H),ie=H.read_shift(4),ae=H.read_shift(4),Q=H.read_shift(2);if(Q==65535)return ie===0&&ae===3221225472?(se[1].t="e",se[1].v=15):ie===0&&ae===3489660928?(se[1].t="e",se[1].v=42):se[1].v=0,se;var le=Q&32768;return Q=(Q&32767)-16446,se[1].v=(1-le*2)*(ae*Math.pow(2,Q+32)+ie*Math.pow(2,Q)),se}function L(H,X,se,ie){var ae=ht(14);if(ae.write_shift(2,H),ae.write_shift(1,se),ae.write_shift(1,X),ie==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var Q=0,le=0,_e=0,ke=0;return ie<0&&(Q=1,ie=-ie),le=Math.log2(ie)|0,ie/=Math.pow(2,le-31),ke=ie>>>0,(ke&2147483648)==0&&(ie/=2,++le,ke=ie>>>0),ie-=ke,ke|=2147483648,ke>>>=0,ie*=Math.pow(2,32),_e=ie>>>0,ae.write_shift(4,_e),ae.write_shift(4,ke),le+=16383+(Q?32768:0),ae.write_shift(2,le),ae}function O(H,X){var se=D(H);return H.l+=X-14,se}function G(H,X){var se=F(H),ie=H.read_shift(4);return se[1].v=ie>>6,se}function K(H,X){var se=F(H),ie=H.read_shift(8,"f");return se[1].v=ie,se}function te(H,X){var se=K(H);return H.l+=X-10,se}function Z(H,X){return H[H.l+X-1]==0?H.read_shift(X,"cstr"):""}function J(H,X){var se=H[H.l++];se>X-1&&(se=X-1);for(var ie="";ie.length<se;)ie+=String.fromCharCode(H[H.l++]);return ie}function I(H,X,se){if(!(!se.qpro||X<21)){var ie=H.read_shift(1);H.l+=17,H.l+=1,H.l+=2;var ae=H.read_shift(X-21,"cstr");return[ie,ae]}}function W(H,X){for(var se={},ie=H.l+X;H.l<ie;){var ae=H.read_shift(2);if(ae==14e3){for(se[ae]=[0,""],se[ae][0]=H.read_shift(2);H[H.l];)se[ae][1]+=String.fromCharCode(H[H.l]),H.l++;H.l++}}return se}function B(H,X){var se=ht(5+H.length);se.write_shift(2,14e3),se.write_shift(2,X);for(var ie=0;ie<H.length;++ie){var ae=H.charCodeAt(ie);se[se.l++]=ae>127?95:ae}return se[se.l++]=0,se}var Y={0:{n:"BOF",f:Ss},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},V={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:W},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:I},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function cK(e){var t={},r=e.match(Ba),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=gr(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=eS[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var uK=(function(){var e=cp("t"),t=cp("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Kr(i[1])},c=a.match(t);return c&&(o.s=cK(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}})(),dK=(function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),fK=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,hK=/<(?:\w+:)?r>/,gK=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function kS(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Kr(pn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=pn(e),r&&(n.h=uS(n.t))):e.match(hK)&&(n.r=pn(e),n.t=Kr(pn((e.replace(gK,"").match(fK)||[]).join("").replace(Ba,""))),r&&(n.h=dK(uK(n.r)))),n):{t:""}}var mK=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,pK=/<(?:\w+:)?(?:si|sstItem)>/g,xK=/<\/(?:\w+:)?(?:si|sstItem)>/;function yK(e,t){var r=[],n="";if(!e)return r;var s=e.match(mK);if(s){n=s[2].replace(pK,"").split(xK);for(var a=0;a!=n.length;++a){var i=kS(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=gr(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var vK=/^\s|\s$|[\t\n\r]/;function nF(e,t){if(!t.bookSST)return"";var r=[ms];r[r.length]=Pt("sst",null,{xmlns:vf[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(vK)&&(a+=' xml:space="preserve"'),a+=">"+un(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function wK(e){return[e.read_shift(4),e.read_shift(4)]}function _K(e,t){var r=[],n=!1;return Ac(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function bK(e,t){return t||(t=ht(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var SK=DH;function kK(e){var t=bi();xt(t,159,bK(e));for(var r=0;r<e.length;++r)xt(t,19,SK(e[r]));return xt(t,160),t.end()}function sF(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function wc(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function CK(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=wc(e,4),t.U=wc(e,4),t.W=wc(e,4),t}function TK(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function EK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(TK(e));return t}function NK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function AK(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=wc(e,4),t.U=wc(e,4),t.W=wc(e,4),t}function jK(e){var t=AK(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function aF(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function iF(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function FK(e){var t=wc(e);switch(t.Minor){case 2:return[t.Minor,PK(e)];case 3:return[t.Minor,DK()];case 4:return[t.Minor,RK(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function PK(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=aF(e,r),s=iF(e,e.length-e.l);return{t:"Std",h:n,v:s}}function DK(){throw new Error("File is password-protected: ECMA-376 Extensible")}function RK(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Ba,function(a){var i=gr(a);switch(Al(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function IK(e,t){var r={},n=r.EncryptionVersionInfo=wc(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=aF(e,s),t-=s,r.EncryptionVerifier=iF(e,t),r}function MK(e){var t={},r=t.EncryptionVersionInfo=wc(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function CS(e){var t=0,r,n=sF(e),s=n.length+1,a,i,o,c,d;for(r=Iu(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=(t&16384)===0?0:1,c=t<<1&32767,d=o|c,t=d^i;return t^52811}var oF=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,d=i.length-1;d>=0;--d)for(var f=i[d],p=0;p!=7;++p)f&64&&(o^=r[c]),f*=2,--c;return o};return function(i){for(var o=sF(i),c=a(o),d=o.length,f=Iu(16),p=0;p!=16;++p)f[p]=0;var m,y,v;for((d&1)===1&&(m=c>>8,f[d]=s(e[0],m),--d,m=c&255,y=o[o.length-1],f[d]=s(y,m));d>0;)--d,m=c>>8,f[d]=s(o[d],m),--d,m=c&255,f[d]=s(o[d],m);for(d=15,v=15-o.length;v>0;)m=c>>8,f[d]=s(e[v],m),--d,--v,m=c&255,f[d]=s(o[d],m),--d,--v;return f}})(),LK=function(e,t,r,n,s){s||(s=t),n||(n=oF(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},OK=function(e){var t=0,r=oF(e);return function(n){var s=LK("",n,t,r);return t=s[1],s[0]}};function BK(e,t,r,n){var s={key:Ss(e),verificationBytes:Ss(e)};return r.password&&(s.verifier=CS(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=OK(r.password)),s}function UK(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=MK(e):n.Data=IK(e,t),n}function $K(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?UK(e,t-2,n):BK(e,r.biff>=8?t:t-2,r,n),n}var lF=(function(){function e(s,a){switch(a.type){case"base64":return t(Oi(s),a);case"binary":return t(s,a);case"buffer":return t(Ar&&Buffer.isBuffer(s)?s.toString("binary"):Vu(s),a);case"array":return t(df(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,p){Array.isArray(o)&&(o[p]=[]);for(var m=/\\\w+\b/g,y=0,v,w=-1;v=m.exec(f);){switch(v[0]){case"\\cell":var S=f.slice(y,m.lastIndex-v[0].length);if(S[0]==" "&&(S=S.slice(1)),++w,S.length){var E={v:S,t:"s"};Array.isArray(o)?o[p][w]=E:o[fr({r:p,c:w})]=E}break}y=m.lastIndex}w>d.e.c&&(d.e.c=w)}),o["!ref"]=kr(d),o}function r(s,a){return Ku(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=qr(s["!ref"]),o,c=Array.isArray(s),d=i.s.r;d<=i.e.r;++d){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var p=fr({r:d,c:f});o=c?(s[d]||[])[f]:s[p],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Cc(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function WK(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function hp(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function zK(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,d=s+a;switch(c=i/(d>1?2-d:d),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,d/2]}function HK(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var d=0;d!=3;++d)i[d]=Math.round(i[d]*255);return i}function yy(e,t){if(t===0)return e;var r=zK(WK(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),hp(HK(r))}var cF=6,GK=15,VK=1,ja=cF;function gp(e){return Math.floor((e+Math.round(128/ja)/256)*ja)}function mp(e){return Math.floor((e-5)/ja*100+.5)/100}function vy(e){return Math.round((e*ja+5)/ja*256)/256}function Bw(e){return vy(mp(gp(e)))}function TS(e){var t=Math.abs(e-Bw(e)),r=ja;if(t>.005)for(ja=VK;ja<GK;++ja)Math.abs(e-Bw(e))<=t&&(t=Math.abs(e-Bw(e)),r=ja);ja=r}function Mu(e){e.width?(e.wpx=gp(e.width),e.wch=mp(e.wpx),e.MDW=ja):e.wpx?(e.wch=mp(e.wpx),e.width=vy(e.wch),e.MDW=ja):typeof e.wch=="number"&&(e.width=vy(e.wch),e.wpx=gp(e.width),e.MDW=ja),e.customWidth&&delete e.customWidth}var KK=96,uF=KK;function pp(e){return e*96/uF}function d0(e){return e*uF/96}var qK={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function XK(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Ba)||[]).forEach(function(i){var o=gr(i);switch(Al(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=En(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=En(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function YK(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Ba)||[]).forEach(function(i){var o=gr(i);switch(Al(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function JK(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Ba)||[]).forEach(function(i){var o=gr(i);switch(Al(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=pn(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?En(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?En(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?En(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?En(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?En(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?En(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?En(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=eS[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=En(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=Gd[s.color.index];s.color.index==81&&(c=Gd[1]),c||(c=Gd[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=yy(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function QK(e,t,r){t.NumberFmt=[];for(var n=ts(ur),s=0;s<n.length;++s)t.NumberFmt[n[s]]=ur[n[s]];var a=e[0].match(Ba);if(a)for(s=0;s<a.length;++s){var i=gr(a[s]);switch(Al(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Kr(pn(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}vc(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function ZK(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Pt("numFmt",null,{numFmtId:n,formatCode:un(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Pt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var w1=["numFmtId","fillId","fontId","borderId","xfId"],_1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function eq(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Ba)||[]).forEach(function(a){var i=gr(a),o=0;switch(Al(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<w1.length;++o)n[w1[o]]&&(n[w1[o]]=parseInt(n[w1[o]],10));for(o=0;o<_1.length;++o)n[_1[o]]&&(n[_1[o]]=En(n[_1[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=En(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function tq(e){var t=[];return t[t.length]=Pt("cellXfs",null),e.forEach(function(r){t[t.length]=Pt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Pt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var rq=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,d){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&QK(p,f,d),(p=o.match(s))&&JK(p,f,c,d),(p=o.match(n))&&YK(p,f,c,d),(p=o.match(a))&&XK(p,f,c,d),(p=o.match(r))&&eq(p,f,d),f}})();function dF(e,t){var r=[ms,Pt("styleSheet",null,{xmlns:vf[0],"xmlns:vt":Ms.vt})],n;return e.SSF&&(n=ZK(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=tq(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function nq(e,t){var r=e.read_shift(2),n=Ia(e);return[r,n]}function sq(e,t,r){r||(r=ht(6+4*t.length)),r.write_shift(2,e),Zs(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function aq(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=UH(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=BH(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ia(e),n}function iq(e,t){t||(t=ht(153)),t.write_shift(2,e.sz*20),$H(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),my(e.color,t);var n=0;return n=2,t.write_shift(1,n),Zs(e.name,t),t.length>t.l?t.slice(0,t.l):t}var oq=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Uw,lq=La;function X3(e,t){t||(t=ht(84)),Uw||(Uw=Yy(oq));var r=Uw[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(my({auto:1},t),my({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function cq(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function fF(e,t,r){r||(r=ht(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function xm(e,t){return t||(t=ht(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var uq=La;function dq(e,t){return t||(t=ht(51)),t.write_shift(1,0),xm(null,t),xm(null,t),xm(null,t),xm(null,t),xm(null,t),t.length>t.l?t.slice(0,t.l):t}function fq(e,t){return t||(t=ht(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),gy(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function hq(e,t,r){var n=ht(2052);return n.write_shift(4,e),gy(t,n),gy(r,n),n.length>n.l?n.slice(0,n.l):n}function gq(e,t,r){var n={};n.NumberFmt=[];for(var s in ur)n.NumberFmt[s]=ur[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Ac(e,function(c,d,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],vc(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=yy(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(d.T>0)a.push(f);else if(d.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function mq(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(xt(e,615,$o(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&xt(e,44,sq(s,t[s]))}),xt(e,616))}}function pq(e){var t=1;xt(e,611,$o(t)),xt(e,43,iq({sz:12,color:{theme:1},name:"Calibri",family:2})),xt(e,612)}function xq(e){var t=2;xt(e,603,$o(t)),xt(e,45,X3({patternType:"none"})),xt(e,45,X3({patternType:"gray125"})),xt(e,604)}function yq(e){var t=1;xt(e,613,$o(t)),xt(e,46,dq()),xt(e,614)}function vq(e){var t=1;xt(e,626,$o(t)),xt(e,47,fF({numFmtId:0},65535)),xt(e,627)}function wq(e,t){xt(e,617,$o(t.length)),t.forEach(function(r){xt(e,47,fF(r,0))}),xt(e,618)}function _q(e){var t=1;xt(e,619,$o(t)),xt(e,48,fq({xfId:0,name:"Normal"})),xt(e,620)}function bq(e){var t=0;xt(e,505,$o(t)),xt(e,506)}function Sq(e){var t=0;xt(e,508,hq(t,"TableStyleMedium9","PivotStyleMedium4")),xt(e,509)}function kq(e,t){var r=bi();return xt(r,278),mq(r,e.SSF),pq(r),xq(r),yq(r),vq(r),wq(r,t.cellXfs),_q(r),bq(r),Sq(r),xt(r,279),r.end()}var Cq=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Tq(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Ba)||[]).forEach(function(s){var a=gr(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[Cq.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Eq(){}function Nq(){}var Aq=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,jq=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Fq=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Pq(e,t,r){t.themeElements={};var n;[["clrScheme",Aq,Tq],["fontScheme",jq,Eq],["fmtScheme",Fq,Nq]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var Dq=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function hF(e,t){(!e||e.length===0)&&(e=ES());var r,n={};if(!(r=e.match(Dq)))throw new Error("themeElements not found in theme");return Pq(r[0],n,t),n.raw=e,n}function ES(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ms];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Rq(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=aj(a,{type:"array"})}catch{return}var o=Mi(i,"theme/theme/theme1.xml",!0);if(o)return hF(o,r)}}function Iq(e){return e.read_shift(4)}function Mq(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Lq(e,4);break;case 2:t.xclrValue=Vj(e);break;case 3:t.xclrValue=Iq(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Lq(e,t){return La(e,t)}function Oq(e,t){return La(e,t)}function Bq(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Mq(e);break;case 6:n[1]=Oq(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Uq(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(Bq(e,r-e.l));return{ixfe:n,ext:a}}function $q(e,t){t.forEach(function(r){r[0]})}function Wq(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ia(e)}}function zq(e){var t=ht(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Zs(e.name,t),t.slice(0,t.l)}function Hq(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Gq(e){var t=ht(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Vq(e,t){var r=ht(8+2*t.length);return r.write_shift(4,e),Zs(t,r),r.slice(0,r.l)}function Kq(e){return e.l+=4,e.read_shift(4)!=0}function qq(e,t){var r=ht(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Xq(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return Ac(e,function(c,d,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!d.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function Yq(){var e=bi();return xt(e,332),xt(e,334,$o(1)),xt(e,335,zq({name:"XLDAPR",version:12e4,flags:3496657072})),xt(e,336),xt(e,339,Vq(1,"XLDAPR")),xt(e,52),xt(e,35,$o(514)),xt(e,4096,$o(0)),xt(e,4097,oo(1)),xt(e,36),xt(e,53),xt(e,340),xt(e,337,qq(1)),xt(e,51,Gq([[1,0]])),xt(e,338),xt(e,333),e.end()}function Jq(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Ba,function(o){var c=gr(o);switch(Al(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==c.name&&(i=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function gF(){var e=[ms];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Qq(e){var t=[];if(!e)return t;var r=1;return(e.match(Ba)||[]).forEach(function(n){var s=gr(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Zq(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=fr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function eX(e,t,r){var n=[];return Ac(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function tX(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Ac(e,function(o,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function rX(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var $h=1024;function mF(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Pt("xml",null,{"xmlns:v":Di.v,"xmlns:o":Di.o,"xmlns:x":Di.x,"xmlns:mv":Di.mv}).replace(/\/>/,">"),Pt("o:shapelayout",Pt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Pt("v:shapetype",[Pt("v:stroke",null,{joinstyle:"miter"}),Pt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];$h<e*1e3;)$h+=1e3;return t.forEach(function(a){var i=zn(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Pt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Pt("v:fill",c,o),f={on:"t",obscured:"t"};++$h,s=s.concat(["<v:shape"+up({id:"_x0000_s"+$h,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Pt("v:shadow",null,f),Pt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pa("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),pa("x:AutoFill","False"),pa("x:Row",String(i.r)),pa("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Y3(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=zn(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=qr(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var d=kr(c);d!==e["!ref"]&&(e["!ref"]=d)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(f.a==n[p].id){f.a=n[p].name||f.a;break}}a.c.push(f)})}function nX(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=gr(o[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=zn(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var p=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!p&&!!p[1]&&kS(p[1])||{r:"",t:"",h:""};d.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),d.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=m.h),n.push(d)}}}}),n}function pF(e){var t=[ms,Pt("comments",null,{xmlns:vf[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=un(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(un(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(pa("t",un(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(pa("t",un(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function sX(e,t){var r=[],n=!1,s={},a=0;return e.replace(Ba,function(o,c){var d=gr(o);switch(Al(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return o}),r}function aX(e,t,r){var n=[ms,Pt("ThreadedComments",null,{xmlns:Ms.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Pt("threadedComment",pa("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function iX(e,t){var r=[],n=!1;return e.replace(Ba,function(a){var i=gr(a);switch(Al(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function oX(e){var t=[ms,Pt("personList",null,{xmlns:Ms.TCMNT,"xmlns:x":vf[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Pt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function lX(e){var t={};t.iauthor=e.read_shift(4);var r=Sf(e);return t.rfx=r.s,t.ref=fr(r.s),e.l+=16,t}function cX(e,t){return t==null&&(t=ht(36)),t.write_shift(4,e[1].iauthor),F0(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var uX=Ia;function dX(e){return Zs(e.slice(0,54))}function fX(e,t){var r=[],n=[],s={},a=!1;return Ac(e,function(o,c,d){switch(d){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function hX(e){var t=bi(),r=[];return xt(t,628),xt(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),xt(t,632,dX(s.a)))})}),xt(t,631),xt(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:zn(n[0]),e:zn(n[0])};xt(t,635,cX([a,s])),s.t&&s.t.length>0&&xt(t,637,IH(s)),xt(t,636),delete s.iauthor})}),xt(t,634),xt(t,629),t.end()}var gX="application/vnd.ms-office.vbaProject";function mX(e){var t=ir.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ir.utils.cfb_add(t,s,e.FileIndex[n].content)}}),ir.write(t)}function pX(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&ir.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var xF=["xlsb","xlsm","xlam","biff8","xla"];function xX(){return{"!type":"dialog"}}function yX(){return{"!type":"dialog"}}function vX(){return{"!type":"macro"}}function wX(){return{"!type":"macro"}}var Jh=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var d=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,c?d+=t.r:--d,s+(o?"":"$")+Wn(f)+(c?"":"$")+hs(d)}return function(s,a){return t=a,s.replace(e,r)}})(),NS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,AS=(function(){return function(t,r){return t.replace(NS,function(n,s,a,i,o,c){var d=mS(i)-(a?0:r.c),f=gS(c)-(o?0:r.r),p=f==0?"":o?f+1:"["+f+"]",m=d==0?"":a?d+1:"["+d+"]";return s+"R"+p+"C"+m})}})();function yF(e,t){return e.replace(NS,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Wn(mS(a)+t.c))+(i=="$"?i+o:hs(gS(o)+t.r))})}function _X(e,t,r){var n=Si(t),s=n.s,a=zn(r),i={r:a.r-s.r,c:a.c-s.c};return yF(e,i)}function bX(e){return e.length!=1}function J3(e){return e.replace(/_xlfn\./g,"")}function _s(e){e.l+=1}function Lu(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function vF(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return wF(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Lu(e),o=Lu(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function wF(e){var t=Lu(e),r=Lu(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function SX(e,t,r){if(r.biff<8)return wF(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Lu(e),i=Lu(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function _F(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return kX(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Lu(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function kX(e){var t=Lu(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function CX(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function TX(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return EX(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function EX(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function NX(e,t,r){var n=(e[e.l++]&96)>>5,s=vF(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function AX(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=vF(e,a,r);return[n,s,i]}function jX(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function FX(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function PX(e,t,r){var n=(e[e.l++]&96)>>5,s=SX(e,t-1,r);return[n,s]}function DX(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Q3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function RX(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function IX(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function MX(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function LX(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function OX(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function bF(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function BX(e){return e.read_shift(2),bF(e)}function UX(e){return e.read_shift(2),bF(e)}function $X(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=_F(e,0,r);return[n,s]}function WX(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=TX(e,0,r);return[n,s]}function zX(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=_F(e,0,r);return[n,s,a]}function HX(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[KY[s],CF[s],n]}function GX(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:VX(e);return[s,(a[0]===0?CF:VY)[a[1]]]}function VX(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function KX(e,t,r){e.l+=r&&r.biff==2?3:4}function qX(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function XX(e){return e.l++,jc[e.read_shift(1)]}function YX(e){return e.l++,e.read_shift(2)}function JX(e){return e.l++,e.read_shift(1)!==0}function QX(e){return e.l++,Fa(e)}function ZX(e,t,r){return e.l++,Hp(e,t-1,r)}function eY(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=us(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=jc[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Fa(e);break;case 2:r[1]=kf(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function tY(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?Sf:Zy)(e));return s}function rY(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=eY(e,r.biff);return i}function nY(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function sY(e,t,r){if(r.biff==5)return aY(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function aY(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function iY(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function oY(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function lY(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function cY(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var uY=La,dY=La,fY=La;function Vp(e,t,r){return e.l+=2,[CX(e)]}function jS(e){return e.l+=6,[]}var hY=Vp,gY=jS,mY=jS,pY=Vp;function SF(e){return e.l+=2,[Ss(e),e.read_shift(2)&1]}var xY=Vp,yY=SF,vY=jS,wY=Vp,_Y=Vp,bY=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function SY(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=bY[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function kY(e){return e.l+=2,[e.read_shift(4)]}function CY(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function TY(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function EY(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function NY(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AY(e){return e.l+=4,[0,0]}var Z3={1:{n:"PtgExp",f:qX},2:{n:"PtgTbl",f:fY},3:{n:"PtgAdd",f:_s},4:{n:"PtgSub",f:_s},5:{n:"PtgMul",f:_s},6:{n:"PtgDiv",f:_s},7:{n:"PtgPower",f:_s},8:{n:"PtgConcat",f:_s},9:{n:"PtgLt",f:_s},10:{n:"PtgLe",f:_s},11:{n:"PtgEq",f:_s},12:{n:"PtgGe",f:_s},13:{n:"PtgGt",f:_s},14:{n:"PtgNe",f:_s},15:{n:"PtgIsect",f:_s},16:{n:"PtgUnion",f:_s},17:{n:"PtgRange",f:_s},18:{n:"PtgUplus",f:_s},19:{n:"PtgUminus",f:_s},20:{n:"PtgPercent",f:_s},21:{n:"PtgParen",f:_s},22:{n:"PtgMissArg",f:_s},23:{n:"PtgStr",f:ZX},26:{n:"PtgSheet",f:CY},27:{n:"PtgEndSheet",f:TY},28:{n:"PtgErr",f:XX},29:{n:"PtgBool",f:JX},30:{n:"PtgInt",f:YX},31:{n:"PtgNum",f:QX},32:{n:"PtgArray",f:DX},33:{n:"PtgFunc",f:HX},34:{n:"PtgFuncVar",f:GX},35:{n:"PtgName",f:nY},36:{n:"PtgRef",f:$X},37:{n:"PtgArea",f:NX},38:{n:"PtgMemArea",f:iY},39:{n:"PtgMemErr",f:uY},40:{n:"PtgMemNoMem",f:dY},41:{n:"PtgMemFunc",f:oY},42:{n:"PtgRefErr",f:lY},43:{n:"PtgAreaErr",f:jX},44:{n:"PtgRefN",f:WX},45:{n:"PtgAreaN",f:PX},46:{n:"PtgMemAreaN",f:EY},47:{n:"PtgMemNoMemN",f:NY},57:{n:"PtgNameX",f:sY},58:{n:"PtgRef3d",f:zX},59:{n:"PtgArea3d",f:AX},60:{n:"PtgRefErr3d",f:cY},61:{n:"PtgAreaErr3d",f:FX},255:{}},jY={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},FY={1:{n:"PtgElfLel",f:SF},2:{n:"PtgElfRw",f:wY},3:{n:"PtgElfCol",f:hY},6:{n:"PtgElfRwV",f:_Y},7:{n:"PtgElfColV",f:pY},10:{n:"PtgElfRadical",f:xY},11:{n:"PtgElfRadicalS",f:vY},13:{n:"PtgElfColS",f:gY},15:{n:"PtgElfColSV",f:mY},16:{n:"PtgElfRadicalLel",f:yY},25:{n:"PtgList",f:SY},29:{n:"PtgSxName",f:kY},255:{}},PY={0:{n:"PtgAttrNoop",f:AY},1:{n:"PtgAttrSemi",f:OX},2:{n:"PtgAttrIf",f:MX},4:{n:"PtgAttrChoose",f:RX},8:{n:"PtgAttrGoto",f:IX},16:{n:"PtgAttrSum",f:KX},32:{n:"PtgAttrBaxcel",f:Q3},33:{n:"PtgAttrBaxcel",f:Q3},64:{n:"PtgAttrSpace",f:BX},65:{n:"PtgAttrSpaceSemi",f:UX},128:{n:"PtgAttrIfError",f:LX},255:{}};function Kp(e,t,r,n){if(n.biff<8)return La(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=rY(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=tY(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(La(e,t)),a}function qp(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=Z3[a]||Z3[jY[a]],(a===24||a===25)&&(s=(a===24?FY:PY)[e[e.l+1]]),!s||!s.f?La(e,t):i.push([s.n,s.f(e,t,r)]);return i}function DY(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var RY={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function IY(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function kF(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function eN(e,t,r){var n=kF(e,t,r);return n=="#REF"?n:IY(n,r)}function Aa(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,d,f,p=0,m=0,y,v="";if(!e[0]||!e[0][0])return"";for(var w=-1,S="",E=0,k=e[0].length;E<k;++E){var _=e[0][E];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),d=o.pop(),w>=0){switch(e[0][w][1][0]){case 0:S=Zn(" ",e[0][w][1][1]);break;case 1:S=Zn("\r",e[0][w][1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}d=d+S,w=-1}o.push(d+RY[_[0]]+c);break;case"PtgIsect":c=o.pop(),d=o.pop(),o.push(d+" "+c);break;case"PtgUnion":c=o.pop(),d=o.pop(),o.push(d+","+c);break;case"PtgRange":c=o.pop(),d=o.pop(),o.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Im(_[1][1],i,s),o.push(Mm(f,a));break;case"PtgRefN":f=r?Im(_[1][1],r,s):_[1][1],o.push(Mm(f,a));break;case"PtgRef3d":p=_[1][1],f=Im(_[1][2],i,s),v=eN(n,p,s),o.push(v+"!"+Mm(f,a));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],F=_[1][1];N||(N=0),N&=127;var A=N==0?[]:o.slice(-N);o.length-=N,F==="User"&&(F=A.shift()),o.push(F+"("+A.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":y=A3(_[1][1],r?{s:r}:i,s),o.push(Mw(y,s));break;case"PtgArea":y=A3(_[1][1],i,s),o.push(Mw(y,s));break;case"PtgArea3d":p=_[1][1],y=_[1][2],v=eN(n,p,s),o.push(v+"!"+Mw(y,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=_[1][2];var R=(n.names||[])[m-1]||(n[0]||[])[m],T=R?R.Name:"SH33TJSNAME"+String(m);T&&T.slice(0,6)=="_xlfn."&&!s.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var D=_[1][1];m=_[1][2];var L;if(s.biff<=5)D<0&&(D=-D),n[D]&&(L=n[D][m]);else{var O="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][m]&&n[D][m].itab>0&&(O=n.SheetNames[n[D][m].itab-1]+"!"):O=n.SheetNames[m-1]+"!"),n[D]&&n[D][m])O+=n[D][m].Name;else if(n[0]&&n[0][m])O+=n[0][m].Name;else{var G=(kF(n,D,s)||"").split(";;");G[m-1]?O=G[m-1]:O+="SH33TJSERRX"}o.push(O);break}L||(L={Name:"SH33TJSERRY"}),o.push(L.Name);break;case"PtgParen":var K="(",te=")";if(w>=0){switch(S="",e[0][w][1][0]){case 2:K=Zn(" ",e[0][w][1][1])+K;break;case 3:K=Zn("\r",e[0][w][1][1])+K;break;case 4:te=Zn(" ",e[0][w][1][1])+te;break;case 5:te=Zn("\r",e[0][w][1][1])+te;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}o.push(K+o.pop()+te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:_[1][1],r:_[1][0]};var Z={c:r.c,r:r.r};if(n.sharedf[fr(f)]){var J=n.sharedf[fr(f)];o.push(Aa(J,i,Z,n,s))}else{var I=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(f.c<d[0].s.c||f.c>d[0].e.c)&&!(f.r<d[0].s.r||f.r>d[0].e.r)){o.push(Aa(d[1],i,Z,n,s)),I=!0;break}I||o.push(_[1])}break;case"PtgArray":o.push("{"+DY(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var W=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&w>=0&&W.indexOf(e[0][E][0])==-1){_=e[0][w];var B=!0;switch(_[1][0]){case 4:B=!1;case 0:S=Zn(" ",_[1][1]);break;case 5:B=!1;case 1:S=Zn("\r",_[1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((B?S:"")+o.pop()+(B?"":S)),w=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function MY(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],La(e,t-2)];var o=qp(e,i,r);return t!==i+s&&(a=Kp(e,t-i-s,o,r)),e.l=n,[o,a]}function LY(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],La(e,t-2)];var o=qp(e,i,r);return t!==i+s&&(a=Kp(e,t-i-s,o,r)),e.l=n,[o,a]}function OY(e,t,r,n){var s=e.l+t,a=qp(e,n,r),i;return s!==e.l&&(i=Kp(e,s-e.l,a,r)),[a,i]}function BY(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=qp(e,a,r);return a==65535?[[],La(e,t-2)]:(t!==a+2&&(s=Kp(e,n-a-2,i,r)),[i,s])}function UY(e){var t;if(pc(e,e.l+6)!==65535)return[Fa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function $Y(e){if(e==null){var t=ht(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ff(e);return ff(0)}function $w(e,t,r){var n=e.l+t,s=jl(e);r.biff==2&&++e.l;var a=UY(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=LY(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function WY(e,t,r,n,s){var a=gf(t,r,s),i=$Y(e.v),o=ht(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var d=ht(e.bf.length),f=0;f<e.bf.length;++f)d[f]=e.bf[f];var p=Qs([a,i,o,d]);return p}function ev(e,t,r){var n=e.read_shift(4),s=qp(e,n,r),a=e.read_shift(4),i=a>0?Kp(e,a,s,r):null;return[s,i]}var zY=ev,tv=ev,HY=ev,GY=ev,VY={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},CF={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},KY={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function tN(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function qY(e){var t="of:="+e.replace(NS,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Ww(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function XY(e){return e.replace(/\./,"!")}var Om={},Qh={},Bm=typeof Map<"u";function FS(e,t,r){var n=0,s=e.length;if(r){if(Bm?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Bm?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Bm?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function rv(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ja=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=mp(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=vy(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function qd(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function qu(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){vc(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function TF(e,t,r,n,s,a){try{n.cellNF&&(e.z=ur[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Fn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ur[t]==null&&vc(Vz[t]||"General",t),e.t==="e")e.w=e.w||jc[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lp(e.v);else if(e.t==="d"){var i=Os(e.v);(i|0)===i?e.w=i.toString(10):e.w=lp(i)}else{if(e.v===void 0)return"";e.w=uf(e.v,Qh)}else e.t==="d"?e.w=po(t,Os(e.v),Qh):e.w=po(t,e.v,Qh)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=yy(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=yy(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function YY(e,t,r){if(e&&e["!ref"]){var n=qr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function JY(e,t){var r=qr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=kr(r))}var QY=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,ZY=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,eJ=/<(?:\w:)?hyperlink [^>]*>/mg,tJ=/"(\w*:\w*)"/,rJ=/<(?:\w:)?col\b[^>]*[\/]?>/g,nJ=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,sJ=/<(?:\w:)?pageMargins[^>]*\/>/g,EF=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,aJ=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,iJ=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function oJ(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",f="",p=e.match(ZY);p?(d=e.slice(0,p.index),f=e.slice(p.index+p[0].length)):d=f=e;var m=d.match(EF);m?PS(m[0],o,s,r):(m=d.match(aJ))&&cJ(m[0],m[1]||"",o,s,r);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var v=d.slice(y,y+50).match(tJ);v&&JY(o,v[1])}var w=d.match(iJ);w&&w[1]&&bJ(w[1],s);var S=[];if(t.cellStyles){var E=d.match(rJ);E&&xJ(S,E)}p&&CJ(p[1],o,t,c,a,i);var k=f.match(nJ);k&&(o["!autofilter"]=vJ(k[0]));var _=[],N=f.match(QY);if(N)for(y=0;y!=N.length;++y)_[y]=qr(N[y].slice(N[y].indexOf('"')+1));var F=f.match(eJ);F&&gJ(o,F,n);var A=f.match(sJ);if(A&&(o["!margins"]=mJ(gr(A[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=kr(c)),t.sheetRows>0&&o["!ref"]){var R=qr(o["!ref"]);t.sheetRows<=+R.e.r&&(R.e.r=t.sheetRows-1,R.e.r>c.e.r&&(R.e.r=c.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>c.e.c&&(R.e.c=c.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),o["!fullref"]=o["!ref"],o["!ref"]=kr(R))}return S.length>0&&(o["!cols"]=S),_.length>0&&(o["!merges"]=_),o}function lJ(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+kr(e[r])+'"/>';return t+"</mergeCells>"}function PS(e,t,r,n){var s=gr(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Kr(pn(s.codeName)))}function cJ(e,t,r,n,s){PS(e.slice(0,e.indexOf(">")),r,n,s)}function uJ(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=_l(un(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),o=(o||"")+Pt("outlinePr",null,d)}!a&&!o||(s[s.length]=Pt("sheetPr",o,i))}var dJ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],fJ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function hJ(e){var t={sheet:1};return dJ.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),fJ.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=CS(e.password).toString(16).toUpperCase()),Pt("sheetProtection",null,t)}function gJ(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=gr(pn(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Kr(a.location))):(a.Target="#"+Kr(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=qr(a.ref),c=o.s.r;c<=o.e.r;++c)for(var d=o.s.c;d<=o.e.c;++d){var f=fr({c:d,r:c});n?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function mJ(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function pJ(e){return qd(e),Pt("pageMargins",null,e)}function xJ(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=gr(t[n],!0);s.hidden&&(s.hidden=En(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,TS(s.width)),Mu(s);a<=i;)e[a++]=Pn(s)}}function yJ(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Pt("col",null,rv(s,n)));return r[r.length]="</cols>",r.join("")}function vJ(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function wJ(e,t,r,n){var s=typeof e.ref=="string"?e.ref:kr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Si(s);i.s.r==i.e.r&&(i.e.r=Si(t["!ref"]).e.r,s=kr(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Pt("autoFilter",null,{ref:s})}var _J=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function bJ(e,t){t.Views||(t.Views=[{}]),(e.match(_J)||[]).forEach(function(r,n){var s=gr(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),En(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function SJ(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Pt("sheetViews",Pt("sheetView",null,s),{})}function kJ(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=jc[e.v];break;case"d":n&&n.cellDates?s=Fn(e.v,-1).toISOString():(e=Pn(e),e.t="n",s=""+(e.v=Os(Fn(e.v)))),typeof e.z>"u"&&(e.z=ur[14]);break;default:s=e.v;break}var o=pa("v",un(s)),c={r:t},d=qu(n.cellXfs,e,n);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=pa("v",""+FS(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Pt("f",un(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Pt("c",o,c)}var CJ=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=cp("v"),i=cp("f");return function(c,d,f,p,m,y){for(var v=0,w="",S=[],E=[],k=0,_=0,N=0,F="",A,R,T=0,D=0,L,O,G=0,K=0,te=Array.isArray(y.CellXf),Z,J=[],I=[],W=Array.isArray(d),B=[],Y={},V=!1,H=!!f.sheetStubs,X=c.split(t),se=0,ie=X.length;se!=ie;++se){w=X[se].trim();var ae=w.length;if(ae!==0){var Q=0;e:for(v=0;v<ae;++v)switch(w[v]){case">":if(w[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(R=gr(w.slice(Q,v),!0),T=R.r!=null?parseInt(R.r,10):T+1,D=-1,f.sheetRows&&f.sheetRows<T)continue;Y={},V=!1,R.ht&&(V=!0,Y.hpt=parseFloat(R.ht),Y.hpx=d0(Y.hpt)),R.hidden=="1"&&(V=!0,Y.hidden=!0),R.outlineLevel!=null&&(V=!0,Y.level=+R.outlineLevel),V&&(B[T-1]=Y)}break;case"<":Q=v;break}if(Q>=v)break;if(R=gr(w.slice(Q,v),!0),T=R.r!=null?parseInt(R.r,10):T+1,D=-1,!(f.sheetRows&&f.sheetRows<T)){p.s.r>T-1&&(p.s.r=T-1),p.e.r<T-1&&(p.e.r=T-1),f&&f.cellStyles&&(Y={},V=!1,R.ht&&(V=!0,Y.hpt=parseFloat(R.ht),Y.hpx=d0(Y.hpt)),R.hidden=="1"&&(V=!0,Y.hidden=!0),R.outlineLevel!=null&&(V=!0,Y.level=+R.outlineLevel),V&&(B[T-1]=Y)),S=w.slice(v).split(e);for(var le=0;le!=S.length&&S[le].trim().charAt(0)=="<";++le);for(S=S.slice(le),v=0;v!=S.length;++v)if(w=S[v].trim(),w.length!==0){if(E=w.match(r),k=v,_=0,N=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,E!=null&&E.length===2){for(k=0,F=E[1],_=0;_!=F.length&&!((N=F.charCodeAt(_)-64)<1||N>26);++_)k=26*k+N;--k,D=k}else++D;for(_=0;_!=w.length&&w.charCodeAt(_)!==62;++_);if(++_,R=gr(w.slice(0,_),!0),R.r||(R.r=fr({r:T-1,c:D})),F=w.slice(_),A={t:""},(E=F.match(a))!=null&&E[1]!==""&&(A.v=Kr(E[1])),f.cellFormula){if((E=F.match(i))!=null&&E[1]!==""){if(A.f=Kr(pn(E[1])).replace(/\r\n/g,`
`),f.xlfn||(A.f=J3(A.f)),E[0].indexOf('t="array"')>-1)A.F=(F.match(s)||[])[1],A.F.indexOf(":")>-1&&J.push([qr(A.F),A.F]);else if(E[0].indexOf('t="shared"')>-1){O=gr(E[0]);var _e=Kr(pn(E[1]));f.xlfn||(_e=J3(_e)),I[parseInt(O.si,10)]=[O,_e,R.r]}}else(E=F.match(/<f[^>]*\/>/))&&(O=gr(E[0]),I[O.si]&&(A.f=_X(I[O.si][1],I[O.si][2],R.r)));var ke=zn(R.r);for(_=0;_<J.length;++_)ke.r>=J[_][0].s.r&&ke.r<=J[_][0].e.r&&ke.c>=J[_][0].s.c&&ke.c<=J[_][0].e.c&&(A.F=J[_][1])}if(R.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(H)A.t="z";else continue;else A.t=R.t||"n";switch(p.s.c>D&&(p.s.c=D),p.e.c<D&&(p.e.c=D),A.t){case"n":if(A.v==""||A.v==null){if(!H)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v>"u"){if(!H)continue;A.t="z"}else L=Om[parseInt(A.v,10)],A.v=L.t,A.r=L.r,f.cellHTML&&(A.h=L.h);break;case"str":A.t="s",A.v=A.v!=null?pn(A.v):"",f.cellHTML&&(A.h=uS(A.v));break;case"inlineStr":E=F.match(n),A.t="s",E!=null&&(L=kS(E[1]))?(A.v=L.t,f.cellHTML&&(A.h=L.h)):A.v="";break;case"b":A.v=En(A.v);break;case"d":f.cellDates?A.v=Fn(A.v,1):(A.v=Os(Fn(A.v,1)),A.t="n");break;case"e":(!f||f.cellText!==!1)&&(A.w=A.v),A.v=Aj[A.v];break}if(G=K=0,Z=null,te&&R.s!==void 0&&(Z=y.CellXf[R.s],Z!=null&&(Z.numFmtId!=null&&(G=Z.numFmtId),f.cellStyles&&Z.fillId!=null&&(K=Z.fillId))),TF(A,G,K,f,m,y),f.cellDates&&te&&A.t=="n"&&N0(ur[G])&&(A.t="d",A.v=Qy(A.v)),R.cm&&f.xlmeta){var Oe=(f.xlmeta.Cell||[])[+R.cm-1];Oe&&Oe.type=="XLDAPR"&&(A.D=!0)}if(W){var ge=zn(R.r);d[ge.r]||(d[ge.r]=[]),d[ge.r][ge.c]=A}else d[R.r]=A}}}}B.length>0&&(d["!rows"]=B)}})();function TJ(e,t,r,n){var s=[],a=[],i=qr(e["!ref"]),o="",c,d="",f=[],p=0,m=0,y=e["!rows"],v=Array.isArray(e),w={r:d},S,E=-1;for(m=i.s.c;m<=i.e.c;++m)f[m]=Wn(m);for(p=i.s.r;p<=i.e.r;++p){for(a=[],d=hs(p),m=i.s.c;m<=i.e.c;++m){c=f[m]+d;var k=v?(e[p]||[])[m]:e[c];k!==void 0&&(o=kJ(k,c,e,t))!=null&&a.push(o)}(a.length>0||y&&y[p])&&(w={r:d},y&&y[p]&&(S=y[p],S.hidden&&(w.hidden=1),E=-1,S.hpx?E=pp(S.hpx):S.hpt&&(E=S.hpt),E>-1&&(w.ht=E,w.customHeight=1),S.level&&(w.outlineLevel=S.level)),s[s.length]=Pt("row",a.join(""),w))}if(y)for(;p<y.length;++p)y&&y[p]&&(w={r:p+1},S=y[p],S.hidden&&(w.hidden=1),E=-1,S.hpx?E=pp(S.hpx):S.hpt&&(E=S.hpt),E>-1&&(w.ht=E,w.customHeight=1),S.level&&(w.outlineLevel=S.level),s[s.length]=Pt("row","",w));return s.join("")}function NF(e,t,r,n){var s=[ms,Pt("worksheet",null,{xmlns:vf[0],"xmlns:r":Ms.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var d=c["!ref"]||"A1",f=qr(d);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),d=kr(f)}n||(n={}),c["!comments"]=[];var p=[];uJ(c,r,e,t,s),s[s.length]=Pt("dimension",null,{ref:d}),s[s.length]=SJ(c,t,e,r),t.sheetFormat&&(s[s.length]=Pt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=yJ(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=TJ(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=hJ(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=wJ(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=lJ(c["!merges"]));var m=-1,y,v=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(w){w[1].Target&&(y={ref:w[0]},w[1].Target.charAt(0)!="#"&&(v=cn(n,-1,un(w[1].Target).replace(/#.*$/,""),Ir.HLINK),y["r:id"]="rId"+v),(m=w[1].Target.indexOf("#"))>-1&&(y.location=un(w[1].Target.slice(m+1))),w[1].Tooltip&&(y.tooltip=un(w[1].Tooltip)),s[s.length]=Pt("hyperlink",null,y))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=pJ(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=pa("ignoredErrors",Pt("ignoredError",null,{numberStoredAsText:1,sqref:d}))),p.length>0&&(v=cn(n,-1,"../drawings/drawing"+(e+1)+".xml",Ir.DRAW),s[s.length]=Pt("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=p),c["!comments"].length>0&&(v=cn(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ir.VML),s[s.length]=Pt("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function EJ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function NJ(e,t,r){var n=ht(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=pp(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var d={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var p=-1,m=-1,y=f<<10;y<f+1<<10;++y){d.c=y;var v=Array.isArray(r)?(r[d.r]||[])[d.c]:r[fr(d)];v&&(p<0&&(p=y),m=y)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,m))}var w=n.l;return n.l=c,n.write_shift(4,o),n.l=w,n.length>n.l?n.slice(0,n.l):n}function AJ(e,t,r,n){var s=NJ(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&xt(e,0,s)}var jJ=Sf,FJ=F0;function PJ(){}function DJ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=MH(e),r}function RJ(e,t,r){r==null&&(r=ht(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return my({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),kj(e,r),r.slice(0,r.l)}function IJ(e){var t=xo(e);return[t]}function MJ(e,t,r){return r==null&&(r=ht(8)),wf(t,r)}function LJ(e){var t=_f(e);return[t]}function OJ(e,t,r){return r==null&&(r=ht(4)),bf(t,r)}function BJ(e){var t=xo(e),r=e.read_shift(1);return[t,r,"b"]}function UJ(e,t,r){return r==null&&(r=ht(9)),wf(t,r),r.write_shift(1,e.v?1:0),r}function $J(e){var t=_f(e),r=e.read_shift(1);return[t,r,"b"]}function WJ(e,t,r){return r==null&&(r=ht(5)),bf(t,r),r.write_shift(1,e.v?1:0),r}function zJ(e){var t=xo(e),r=e.read_shift(1);return[t,r,"e"]}function HJ(e,t,r){return r==null&&(r=ht(9)),wf(t,r),r.write_shift(1,e.v),r}function GJ(e){var t=_f(e),r=e.read_shift(1);return[t,r,"e"]}function VJ(e,t,r){return r==null&&(r=ht(8)),bf(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function KJ(e){var t=xo(e),r=e.read_shift(4);return[t,r,"s"]}function qJ(e,t,r){return r==null&&(r=ht(12)),wf(t,r),r.write_shift(4,t.v),r}function XJ(e){var t=_f(e),r=e.read_shift(4);return[t,r,"s"]}function YJ(e,t,r){return r==null&&(r=ht(8)),bf(t,r),r.write_shift(4,t.v),r}function JJ(e){var t=xo(e),r=Fa(e);return[t,r,"n"]}function QJ(e,t,r){return r==null&&(r=ht(16)),wf(t,r),ff(e.v,r),r}function AF(e){var t=_f(e),r=Fa(e);return[t,r,"n"]}function ZJ(e,t,r){return r==null&&(r=ht(12)),bf(t,r),ff(e.v,r),r}function eQ(e){var t=xo(e),r=vS(e);return[t,r,"n"]}function tQ(e,t,r){return r==null&&(r=ht(12)),wf(t,r),Cj(e.v,r),r}function rQ(e){var t=_f(e),r=vS(e);return[t,r,"n"]}function nQ(e,t,r){return r==null&&(r=ht(8)),bf(t,r),Cj(e.v,r),r}function sQ(e){var t=xo(e),r=pS(e);return[t,r,"is"]}function aQ(e){var t=xo(e),r=Ia(e);return[t,r,"str"]}function iQ(e,t,r){return r==null&&(r=ht(12+4*e.v.length)),wf(t,r),Zs(e.v,r),r.length>r.l?r.slice(0,r.l):r}function oQ(e){var t=_f(e),r=Ia(e);return[t,r,"str"]}function lQ(e,t,r){return r==null&&(r=ht(8+4*e.v.length)),bf(t,r),Zs(e.v,r),r.length>r.l?r.slice(0,r.l):r}function cQ(e,t,r){var n=e.l+t,s=xo(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=tv(e,n-e.l,r);i[3]=Aa(o,null,s,r.supbooks,r)}else e.l=n;return i}function uQ(e,t,r){var n=e.l+t,s=xo(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=tv(e,n-e.l,r);i[3]=Aa(o,null,s,r.supbooks,r)}else e.l=n;return i}function dQ(e,t,r){var n=e.l+t,s=xo(e);s.r=r["!row"];var a=Fa(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=tv(e,n-e.l,r);i[3]=Aa(o,null,s,r.supbooks,r)}else e.l=n;return i}function fQ(e,t,r){var n=e.l+t,s=xo(e);s.r=r["!row"];var a=Ia(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=tv(e,n-e.l,r);i[3]=Aa(o,null,s,r.supbooks,r)}else e.l=n;return i}var hQ=Sf,gQ=F0;function mQ(e,t){return t==null&&(t=ht(4)),t.write_shift(4,e),t}function pQ(e,t){var r=e.l+t,n=Sf(e),s=xS(e),a=Ia(e),i=Ia(e),o=Ia(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function xQ(e,t){var r=ht(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));F0({s:zn(e[0]),e:zn(e[0])},r),yS("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Zs(s||"",r),Zs(e[1].Tooltip||"",r),Zs("",r),r.slice(0,r.l)}function yQ(){}function vQ(e,t,r){var n=e.l+t,s=Tj(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=zY(e,n-e.l,r);i[1]=o}else e.l=n;return i}function wQ(e,t,r){var n=e.l+t,s=Sf(e),a=[s];if(r.cellFormula){var i=GY(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function _Q(e,t,r){r==null&&(r=ht(18));var n=rv(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var jF=["left","right","top","bottom","header","footer"];function bQ(e){var t={};return jF.forEach(function(r){t[r]=Fa(e)}),t}function SQ(e,t){return t==null&&(t=ht(48)),qd(e),jF.forEach(function(r){ff(e[r],t)}),t}function kQ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function CQ(e,t,r){r==null&&(r=ht(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function TQ(e){var t=ht(24);return t.write_shift(4,4),t.write_shift(4,1),F0(e,t),t}function EQ(e,t){return t==null&&(t=ht(66)),t.write_shift(2,e.password?CS(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function NQ(){}function AQ(){}function jQ(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},d,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,m=!1,y,v,w,S,E,k,_,N,F,A=[];o.biff=12,o["!row"]=0;var R=0,T=!1,D=[],L={},O=o.supbooks||s.supbooks||[[]];if(O.sharedf=L,O.arrayf=D,O.SheetNames=s.SheetNames||s.Sheets.map(function(W){return W.name}),!o.supbooks&&(o.supbooks=O,s.Names))for(var G=0;G<s.Names.length;++G)O[0][G+1]=s.Names[G];var K=[],te=[],Z=!1;xp[16]={n:"BrtShortReal",f:AF};var J;if(Ac(e,function(B,Y,V){if(!m)switch(V){case 148:d=B;break;case 0:y=B,o.sheetRows&&o.sheetRows<=y.r&&(m=!0),N=hs(S=y.r),o["!row"]=y.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=d0(B.hpt)),te[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:B[2]},B[2]){case"n":v.v=B[1];break;case"s":_=Om[B[1]],v.v=_.t,v.r=_.r;break;case"b":v.v=!!B[1];break;case"e":v.v=B[1],o.cellText!==!1&&(v.w=jc[v.v]);break;case"str":v.t="s",v.v=B[1];break;case"is":v.t="s",v.v=B[1].t;break}if((w=i.CellXf[B[0].iStyleRef])&&TF(v,w.numFmtId,null,o,a,i),E=B[0].c==-1?E+1:B[0].c,o.dense?(c[S]||(c[S]=[]),c[S][E]=v):c[Wn(E)+N]=v,o.cellFormula){for(T=!1,R=0;R<D.length;++R){var H=D[R];y.r>=H[0].s.r&&y.r<=H[0].e.r&&E>=H[0].s.c&&E<=H[0].e.c&&(v.F=kr(H[0]),T=!0)}!T&&B.length>3&&(v.f=B[3])}if(f.s.r>y.r&&(f.s.r=y.r),f.s.c>E&&(f.s.c=E),f.e.r<y.r&&(f.e.r=y.r),f.e.c<E&&(f.e.c=E),o.cellDates&&w&&v.t=="n"&&N0(ur[w.numFmtId])){var X=Ld(v.v);X&&(v.t="d",v.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}J&&(J.type=="XLDAPR"&&(v.D=!0),J=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;v={t:"z",v:void 0},E=B[0].c==-1?E+1:B[0].c,o.dense?(c[S]||(c[S]=[]),c[S][E]=v):c[Wn(E)+N]=v,f.s.r>y.r&&(f.s.r=y.r),f.s.c>E&&(f.s.c=E),f.e.r<y.r&&(f.e.r=y.r),f.e.c<E&&(f.e.c=E),J&&(J.type=="XLDAPR"&&(v.D=!0),J=void 0);break;case 176:A.push(B);break;case 49:J=((o.xlmeta||{}).Cell||[])[B-1];break;case 494:var se=n["!id"][B.relId];for(se?(B.Target=se.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=se):B.relId==""&&(B.Target="#"+B.loc),S=B.rfx.s.r;S<=B.rfx.e.r;++S)for(E=B.rfx.s.c;E<=B.rfx.e.c;++E)o.dense?(c[S]||(c[S]=[]),c[S][E]||(c[S][E]={t:"z",v:void 0}),c[S][E].l=B):(k=fr({c:E,r:S}),c[k]||(c[k]={t:"z",v:void 0}),c[k].l=B);break;case 426:if(!o.cellFormula)break;D.push(B),F=o.dense?c[S][E]:c[Wn(E)+N],F.f=Aa(B[1],f,{r:y.r,c:E},O,o),F.F=kr(B[0]);break;case 427:if(!o.cellFormula)break;L[fr(B[0].s)]=B[1],F=o.dense?c[S][E]:c[Wn(E)+N],F.f=Aa(B[1],f,{r:y.r,c:E},O,o);break;case 60:if(!o.cellStyles)break;for(;B.e>=B.s;)K[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},Z||(Z=!0,TS(B.w/256)),Mu(K[B.e+1]);break;case 161:c["!autofilter"]={ref:kr(B)};break;case 476:c["!margins"]=B;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),B.name&&(s.Sheets[r].CodeName=B.name),(B.above||B.left)&&(c["!outline"]={above:B.above,left:B.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),B.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!Y.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+V.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=kr(d||f)),o.sheetRows&&c["!ref"]){var I=qr(c["!ref"]);o.sheetRows<=+I.e.r&&(I.e.r=o.sheetRows-1,I.e.r>f.e.r&&(I.e.r=f.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>f.e.c&&(I.e.c=f.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),c["!fullref"]=c["!ref"],c["!ref"]=kr(I))}return A.length>0&&(c["!merges"]=A),K.length>0&&(c["!cols"]=K),te.length>0&&(c["!rows"]=te),c}function FQ(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Pn(t),t.z=t.z||ur[14],t.v=Os(Fn(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=qu(s.cellXfs,t,s),t.l&&a["!links"].push([fr(c),t.l]),t.c&&a["!comments"].push([fr(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=FS(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?xt(e,18,YJ(t,c)):xt(e,7,qJ(t,c))):(c.t="str",i?xt(e,17,lQ(t,c)):xt(e,6,iQ(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?xt(e,13,nQ(t,c)):xt(e,2,tQ(t,c)):i?xt(e,16,ZJ(t,c)):xt(e,5,QJ(t,c)),!0;case"b":return c.t="b",i?xt(e,15,WJ(t,c)):xt(e,4,UJ(t,c)),!0;case"e":return c.t="e",i?xt(e,14,VJ(t,c)):xt(e,3,HJ(t,c)),!0}return i?xt(e,12,OJ(t,c)):xt(e,1,MJ(t,c)),!0}function PQ(e,t,r,n){var s=qr(t["!ref"]||"A1"),a,i="",o=[];xt(e,145);var c=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var f=s.s.r;f<=d;++f){i=hs(f),AJ(e,t,s,f);var p=!1;if(f<=s.e.r)for(var m=s.s.c;m<=s.e.c;++m){f===s.s.r&&(o[m]=Wn(m)),a=o[m]+i;var y=c?(t[f]||[])[m]:t[a];if(!y){p=!1;continue}p=FQ(e,y,f,m,n,t,p)}}xt(e,146)}function DQ(e,t){!t||!t["!merges"]||(xt(e,177,mQ(t["!merges"].length)),t["!merges"].forEach(function(r){xt(e,176,gQ(r))}),xt(e,178))}function RQ(e,t){!t||!t["!cols"]||(xt(e,390),t["!cols"].forEach(function(r,n){r&&xt(e,60,_Q(n,r))}),xt(e,391))}function IQ(e,t){!t||!t["!ref"]||(xt(e,648),xt(e,649,TQ(qr(t["!ref"]))),xt(e,650))}function MQ(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=cn(r,-1,n[1].Target.replace(/#.*$/,""),Ir.HLINK);xt(e,494,xQ(n,s))}}),delete t["!links"]}function LQ(e,t,r,n){if(t["!comments"].length>0){var s=cn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ir.VML);xt(e,551,yS("rId"+s)),t["!legacy"]=s}}function OQ(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:kr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Si(a);o.s.r==o.e.r&&(o.e.r=Si(t["!ref"]).e.r,a=kr(o));for(var c=0;c<i.length;++c){var d=i[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),xt(e,161,F0(qr(a))),xt(e,162)}}function BQ(e,t,r){xt(e,133),xt(e,137,CQ(t,r)),xt(e,138),xt(e,134)}function UQ(e,t){t["!protect"]&&xt(e,535,EQ(t["!protect"]))}function $Q(e,t,r,n){var s=bi(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=qr(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],xt(s,129),(r.vbaraw||i["!outline"])&&xt(s,147,RJ(o,i["!outline"])),xt(s,148,FJ(c)),BQ(s,i,r.Workbook),RQ(s,i),PQ(s,i,e,t),UQ(s,i),OQ(s,i,r,e),DQ(s,i),MQ(s,i,n),i["!margins"]&&xt(s,476,SQ(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&IQ(s,i),LQ(s,i,e,n),xt(s,130),s.end()}function WQ(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=Kr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function zQ(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,d="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var m=WQ(p);f.s.r=f.s.c=0,f.e.c=o,d=Wn(o),m[0].forEach(function(y,v){i[d+hs(v)]={t:"n",v:y,z:m[1]},c=v}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(i["!ref"]=kr(f)),i}function HQ(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(EF);return o&&PS(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function GQ(e,t){e.l+=10;var r=Ia(e);return{name:r}}function VQ(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ac(e,function(c,d,f){switch(f){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var DS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],KQ=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],qQ=[],XQ=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function rN(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=En(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function nN(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=En(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function FF(e){nN(e.WBProps,DS),nN(e.CalcPr,XQ),rN(e.WBView,KQ),rN(e.Sheets,qQ),Qh.date1904=En(e.WBProps.date1904)}function YQ(e){return!e.Workbook||!e.Workbook.WBProps?"false":En(e.Workbook.WBProps.date1904)?"true":"false"}var JQ="][*?/\\".split("");function PF(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return JQ.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function QQ(e,t,r){e.forEach(function(n,s){PF(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function ZQ(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];QQ(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)YY(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var eZ=/<\w+:workbook/;function tZ(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Ba,function(c,d){var f=gr(c);switch(Al(f[0])){case"<?xml":break;case"<workbook":c.match(eZ)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":DS.forEach(function(p){if(f[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=En(f[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(f[p[0]],10);break;default:r.WBProps[p[0]]=f[p[0]]}}),f.codeName&&(r.WBProps.CodeName=pn(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Kr(pn(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=pn(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),En(f.hidden||"0")&&(a.Hidden=!0),i=d+c.length;break;case"</definedName>":a.Ref=Kr(pn(e.slice(i,d))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),vf.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return FF(r),r}function DF(e){var t=[ms];t[t.length]=Pt("workbook",null,{xmlns:vf[0],"xmlns:r":Ms.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(DS.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Pt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:un(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Pt("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Pt("definedName",un(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function rZ(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=r2(e),r.name=Ia(e),r}function nZ(e,t){return t||(t=ht(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),yS(e.strRelID,t),Zs(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function sZ(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Ia(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function aZ(e,t){t||(t=ht(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),kj(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function iZ(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function oZ(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=LH(e),i=HY(e,0,r),o=xS(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function lZ(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],xp[16]={n:"BrtFRTArchID$",f:iZ},Ac(e,function(c,d,f){switch(f){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Aa(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,c]):i[0]=[f,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),FF(r),r.Names=a,r.supbooks=i,r}function cZ(e,t){xt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};xt(e,156,nZ(s))}xt(e,144)}function uZ(e,t){t||(t=ht(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Zs("SheetJS",t),Zs(ly.version,t),Zs(ly.version,t),Zs("7262",t),t.length>t.l?t.slice(0,t.l):t}function dZ(e,t){t||(t=ht(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function fZ(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(xt(e,135),xt(e,158,dZ(s)),xt(e,136))}}function hZ(e,t){var r=bi();return xt(r,131),xt(r,128,uZ()),xt(r,153,aZ(e.Workbook&&e.Workbook.WBProps||null)),fZ(r,e),cZ(r,e),xt(r,132),r.end()}function gZ(e,t,r){return t.slice(-4)===".bin"?lZ(e,r):tZ(e,r)}function mZ(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?jQ(e,n,r,s,a,i,o):oJ(e,n,r,s,a,i,o)}function pZ(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?VQ(e,n,r,s,a):HQ(e,n,r,s,a)}function xZ(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?vX():wX()}function yZ(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?xX():yX()}function vZ(e,t,r,n){return t.slice(-4)===".bin"?gq(e,r,n):rq(e,r,n)}function wZ(e,t,r){return hF(e,r)}function _Z(e,t,r){return t.slice(-4)===".bin"?_K(e,r):yK(e,r)}function bZ(e,t,r){return t.slice(-4)===".bin"?fX(e,r):nX(e,r)}function SZ(e,t,r){return t.slice(-4)===".bin"?eX(e):Qq(e)}function kZ(e,t,r,n){return r.slice(-4)===".bin"?tX(e,t,r,n):void 0}function CZ(e,t,r){return t.slice(-4)===".bin"?Xq(e,t,r):Jq(e,t,r)}function TZ(e,t,r){return(t.slice(-4)===".bin"?hZ:DF)(e)}function EZ(e,t,r,n,s){return(t.slice(-4)===".bin"?$Q:NF)(e,r,n,s)}function NZ(e,t,r){return(t.slice(-4)===".bin"?kq:dF)(e,r)}function AZ(e,t,r){return(t.slice(-4)===".bin"?kK:nF)(e,r)}function jZ(e,t,r){return(t.slice(-4)===".bin"?hX:pF)(e)}function FZ(e){return(e.slice(-4)===".bin"?Yq:gF)()}var RF=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,IF=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Do(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(RF),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(IF),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function PZ(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(RF),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(IF),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Um;function DZ(e,t){var r=Um[e]||Kr(e);return r==="General"?uf(t):po(r,t)}function RZ(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=En(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Fn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Kr(t)]=s}function IZ(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||jc[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lp(e.v):e.w=uf(e.v):e.w=DZ(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Um[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&N0(n)){var s=Ld(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function MZ(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=qK[n.Pattern]||n.Pattern)}e[t.ID]=t}function LZ(e,t,r,n,s,a,i,o,c,d){var f="General",p=n.StyleID,m={};d=d||{};var y=[],v=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&i&&(p=i.StyleID);a[p]!==void 0&&(a[p].nf&&(f=a[p].nf),a[p].Interior&&y.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=En(e);break;case"String":n.t="s",n.r=w3(Kr(e)),n.v=e.indexOf("<")>-1?Kr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Fn(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Kr(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Aj[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=w3(t||e));break}if(IZ(n,f,d),d.cellFormula!==!1)if(n.Formula){var w=Kr(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=Jh(w,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Jh("RC:RC",s):n.ArrayRange&&(n.F=Jh(n.ArrayRange,s),c.push([qr(n.F),n.F]))}else for(v=0;v<c.length;++v)s.r>=c[v][0].s.r&&s.r<=c[v][0].e.r&&s.c>=c[v][0].s.c&&s.c<=c[v][0].e.c&&(n.F=c[v][1]);d.cellStyles&&(y.forEach(function(S){!m.patternType&&S.patternType&&(m.patternType=S.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function OZ(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function zw(e,t){var r=t||{};A0();var n=_m(dS(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=pn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Pn(r);return i.type="string",u0.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(We){s.indexOf("<"+We)>=0&&(a=!0)}),a)return See(n,r);Um={"General Number":"General","General Date":ur[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ur[15],"Short Date":ur[14],"Long Time":ur[19],"Medium Time":ur[18],"Short Time":ur[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ur[2],Standard:ur[4],Percent:ur[10],Scientific:ur[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],d,f={},p=[],m=r.dense?[]:{},y="",v={},w={},S=Do('<Data ss:Type="String">'),E=0,k=0,_=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},A={},R="",T=0,D=[],L={},O={},G=0,K=[],te=[],Z={},J=[],I,W=!1,B=[],Y=[],V={},H=0,X=0,se={Sheets:[],WBProps:{date1904:!1}},ie={};dp.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";o=dp.exec(n);)switch(o[3]=(ae=o[3]).toLowerCase()){case"data":if(ae=="data"){if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?LZ(n.slice(E,o.index),R,S,c[c.length-1][0]=="comment"?Z:v,{c:k,r:_},F,J[k],w,B,r):(R="",S=Do(o[0]),E=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(te.length>0&&(v.c=te),(!r.sheetRows||r.sheetRows>_)&&v.v!==void 0&&(r.dense?(m[_]||(m[_]=[]),m[_][k]=v):m[Wn(k)+hs(_)]=v),v.HRef&&(v.l={Target:Kr(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(H=k+(parseInt(v.MergeAcross,10)|0),X=_+(parseInt(v.MergeDown,10)|0),D.push({s:{c:k,r:_},e:{c:H,r:X}})),!r.sheetStubs)v.MergeAcross?k=H+1:++k;else if(v.MergeAcross||v.MergeDown){for(var Q=k;Q<=H;++Q)for(var le=_;le<=X;++le)(Q>k||le>_)&&(r.dense?(m[le]||(m[le]=[]),m[le][Q]={t:"z"}):m[Wn(Q)+hs(le)]={t:"z"});k=H+1}else++k;else v=PZ(o[0]),v.Index&&(k=+v.Index-1),k<N.s.c&&(N.s.c=k),k>N.e.c&&(N.e.c=k),o[0].slice(-2)==="/>"&&++k,te=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<N.s.r&&(N.s.r=_),_>N.e.r&&(N.e.r=_),o[0].slice(-2)==="/>"&&(w=Do(o[0]),w.Index&&(_=+w.Index-1)),k=0,++_):(w=Do(o[0]),w.Index&&(_=+w.Index-1),V={},(w.AutoFitHeight=="0"||w.Height)&&(V.hpx=parseInt(w.Height,10),V.hpt=pp(V.hpx),Y[_]=V),w.Hidden=="1"&&(V.hidden=!0,Y[_]=V));break;case"worksheet":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));p.push(y),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(m["!ref"]=kr(N),r.sheetRows&&r.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=r.sheetRows-1,m["!ref"]=kr(N))),D.length&&(m["!merges"]=D),J.length>0&&(m["!cols"]=J),Y.length>0&&(m["!rows"]=Y),f[y]=m}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=k=0,c.push([o[3],!1]),d=Do(o[0]),y=Kr(d.Name),m=r.dense?[]:{},D=[],B=[],Y=[],ie={name:y,Hidden:0},se.Sheets.push(ie);break;case"table":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),J=[],W=!1}break;case"style":o[1]==="/"?MZ(F,A,r):A=Do(o[0]);break;case"numberformat":A.nf=Kr(Do(o[0]).Format||"General"),Um[A.nf]&&(A.nf=Um[A.nf]);for(var _e=0;_e!=392&&ur[_e]!=A.nf;++_e);if(_e==392){for(_e=57;_e!=392;++_e)if(ur[_e]==null){vc(A.nf,_e);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(I=Do(o[0]),I.Hidden&&(I.hidden=!0,delete I.Hidden),I.Width&&(I.wpx=parseInt(I.Width,10)),!W&&I.wpx>10){W=!0,ja=cF;for(var ke=0;ke<J.length;++ke)J[ke]&&Mu(J[ke])}W&&Mu(I),J[I.Index-1||J.length]=I;for(var Oe=0;Oe<+I.Span;++Oe)J[J.length]=Pn(I);break;case"namedrange":if(o[1]==="/")break;se.Names||(se.Names=[]);var ge=gr(o[0]),ye={Name:ge.Name,Ref:Jh(ge.RefersTo.slice(1),{r:0,c:0})};se.Sheets.length>0&&(ye.Sheet=se.Sheets.length-1),se.Names.push(ye);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?R+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;A.Interior=Do(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?lG(L,ae,n.slice(G,o.index)):G=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));OZ(Z),te.push(Z)}else c.push([o[3],!1]),d=Do(o[0]),Z={a:d.Author};break;case"autofilter":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ke=Do(o[0]);m["!autofilter"]={ref:Jh(Ke.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return lN(n,r);var Xe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Xe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Xe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":se.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Xe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Xe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(G,o.index)){case"SheetHidden":ie.Hidden=1;break;case"SheetVeryHidden":ie.Hidden=2;break}else G=o.index+o[0].length;break;case"header":m["!margins"]||qd(m["!margins"]={},"xlml"),isNaN(+gr(o[0]).Margin)||(m["!margins"].header=+gr(o[0]).Margin);break;case"footer":m["!margins"]||qd(m["!margins"]={},"xlml"),isNaN(+gr(o[0]).Margin)||(m["!margins"].footer=+gr(o[0]).Margin);break;case"pagemargins":var lt=gr(o[0]);m["!margins"]||qd(m["!margins"]={},"xlml"),isNaN(+lt.Top)||(m["!margins"].top=+lt.Top),isNaN(+lt.Left)||(m["!margins"].left=+lt.Left),isNaN(+lt.Right)||(m["!margins"].right=+lt.Right),isNaN(+lt.Bottom)||(m["!margins"].bottom=+lt.Bottom);break;case"displayrighttoleft":se.Views||(se.Views=[]),se.Views[0]||(se.Views[0]={}),se.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Xe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Xe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Xe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Xe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Xe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Xe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Xe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Xe=!1}break;case"smarttags":break;default:Xe=!1;break}if(Xe||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?RZ(O,ae,K,n.slice(G,o.index)):(K=o,G=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Ye={};return!r.bookSheets&&!r.bookProps&&(Ye.Sheets=f),Ye.SheetNames=p,Ye.Workbook=se,Ye.SSF=Pn(ur),Ye.Props=L,Ye.Custprops=O,Ye}function c2(e,t){switch(IS(t=t||{}),t.type||"base64"){case"base64":return zw(Oi(e),t);case"binary":case"buffer":case"file":return zw(e,t);case"array":return zw(Vu(e),t)}}function BZ(e,t){var r=[];return e.Props&&r.push(cG(e.Props,t)),e.Custprops&&r.push(uG(e.Props,e.Custprops)),r.join("")}function UZ(){return""}function $Z(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Pt("NumberFormat",null,{"ss:Format":un(ur[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Pt("Style",a.join(""),i))}),Pt("Styles",r.join(""))}function MF(e){return Pt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+AS(e.Ref,{r:0,c:0})})}function WZ(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(MF(s)))}return Pt("Names",r.join(""))}function zZ(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(MF(o)))}return a.join("")}function HZ(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Pt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Pt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Pt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Pt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(pa("ProtectContents","True")),e["!protect"].objects&&s.push(pa("ProtectObjects","True")),e["!protect"].scenarios&&s.push(pa("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(pa("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(pa("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Pt("WorksheetOptions",s.join(""),{xmlns:Di.x})}function GZ(e){return e.map(function(t){var r=fH(t.t||""),n=Pt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Pt("Comment",n,{"ss:Author":t.a})}).join("")}function VZ(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+un(AS(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=zn(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=un(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=un(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],f=0;f!=d.length;++f)d[f].s.c!=i.c||d[f].s.r!=i.r||(d[f].e.c>d[f].s.c&&(o["ss:MergeAcross"]=d[f].e.c-d[f].s.c),d[f].e.r>d[f].s.r&&(o["ss:MergeDown"]=d[f].e.r-d[f].s.r));var p="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",m=String(e.v);break;case"b":p="Boolean",m=e.v?"1":"0";break;case"e":p="Error",m=jc[e.v];break;case"d":p="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ur[14]);break;case"s":p="String",m=dH(e.v||"");break}var y=qu(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=i.c+1;var v=e.v!=null?m:"",w=e.t=="z"?"":'<Data ss:Type="'+p+'">'+v+"</Data>";return(e.c||[]).length>0&&(w+=GZ(e.c)),Pt("Cell",w,o)}function KZ(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=d0(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function qZ(e,t,r,n){if(!e["!ref"])return"";var s=qr(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(S,E){Mu(S);var k=!!S.width,_=rv(E,S),N={"ss:Index":E+1};k&&(N["ss:Width"]=gp(_.width)),S.hidden&&(N["ss:Hidden"]="1"),o.push(Pt("Column",null,N))});for(var c=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var f=[KZ(d,(e["!rows"]||[])[d])],p=s.s.c;p<=s.e.c;++p){var m=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>p)&&!(a[i].s.r>d)&&!(a[i].e.c<p)&&!(a[i].e.r<d)){(a[i].s.c!=p||a[i].s.r!=d)&&(m=!0);break}if(!m){var y={r:d,c:p},v=fr(y),w=c?(e[d]||[])[p]:e[v];f.push(VZ(w,v,e,t,r,n,y))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function XZ(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?zZ(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?qZ(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(HZ(a,t,e,r)),n.join("")}function YZ(e,t){t||(t={}),e.SSF||(e.SSF=Pn(ur)),e.SSF&&(A0(),Xy(e.SSF),t.revssf=Jy(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],qu(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(BZ(e,t)),r.push(UZ()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Pt("Worksheet",XZ(n,t,e),{"ss:Name":un(e.SheetNames[n])}));return r[2]=$Z(e,t),r[3]=WZ(e),ms+Pt("Workbook",r.join(""),{xmlns:Di.ss,"xmlns:o":Di.o,"xmlns:x":Di.x,"xmlns:ss":Di.ss,"xmlns:dt":Di.dt,"xmlns:html":Di.html})}function JZ(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=WH(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=zH(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var QZ=[60,1084,2066,2165,2175];function ZZ(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=pc(r,r.l),d=u2[c],f=0;d!=null&&QZ.indexOf(c)>-1;)a=pc(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+a),i.push(o),r.l+=4+a,d=u2[c=pc(r,r.l)];var p=Qs(i);ha(p,0);var m=0;p.lens=[];for(var y=0;y<i.length;++y)p.lens.push(m),m+=i[y].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,s)}function gl(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ur[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||jc[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lp(e.v):e.w=uf(e.v):e.w=po(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&N0(ur[n]||String(n))){var s=Ld(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function b1(e,t,r){return{v:e,ixfe:t,t:r}}function eee(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],d="",f={},p,m="",y,v,w,S,E={},k=[],_,N,F=[],A=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},D=function(gt){return gt<8?Gd[gt]:gt<64&&A[gt-8]||Gd[gt]},L=function(gt,kt,Gt){var $t=kt.XF.data;if(!(!$t||!$t.patternType||!Gt||!Gt.cellStyles)){kt.s={},kt.s.patternType=$t.patternType;var Be;(Be=hp(D($t.icvFore)))&&(kt.s.fgColor={rgb:Be}),(Be=hp(D($t.icvBack)))&&(kt.s.bgColor={rgb:Be})}},O=function(gt,kt,Gt){if(!(V>1)&&!(Gt.sheetRows&&gt.r>=Gt.sheetRows)){if(Gt.cellStyles&&kt.XF&&kt.XF.data&&L(gt,kt,Gt),delete kt.ixfe,delete kt.XF,p=gt,m=fr(gt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),gt.r<i.s.r&&(i.s.r=gt.r),gt.c<i.s.c&&(i.s.c=gt.c),gt.r+1>i.e.r&&(i.e.r=gt.r+1),gt.c+1>i.e.c&&(i.e.c=gt.c+1),Gt.cellFormula&&kt.f){for(var $t=0;$t<k.length;++$t)if(!(k[$t][0].s.c>gt.c||k[$t][0].s.r>gt.r)&&!(k[$t][0].e.c<gt.c||k[$t][0].e.r<gt.r)){kt.F=kr(k[$t][0]),(k[$t][0].s.c!=gt.c||k[$t][0].s.r!=gt.r)&&delete kt.f,kt.f&&(kt.f=""+Aa(k[$t][1],i,gt,B,G));break}}Gt.dense?(s[gt.r]||(s[gt.r]=[]),s[gt.r][gt.c]=kt):s[m]=kt}},G={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(G.password=t.password);var K,te=[],Z=[],J=[],I=[],W=!1,B=[];B.SheetNames=G.snames,B.sharedf=G.sharedf,B.arrayf=G.arrayf,B.names=[],B.XTI=[];var Y=0,V=0,H=0,X=[],se=[],ie;G.codepage=1200,Lo(1200);for(var ae=!1;e.l<e.length-1;){var Q=e.l,le=e.read_shift(2);if(le===0&&Y===10)break;var _e=e.l===e.length?0:e.read_shift(2),ke=u2[le];if(ke&&ke.f){if(t.bookSheets&&Y===133&&le!==133)break;if(Y=le,ke.r===2||ke.r==12){var Oe=e.read_shift(2);if(_e-=2,!G.enc&&Oe!==le&&((Oe&255)<<8|Oe>>8)!==le)throw new Error("rt mismatch: "+Oe+"!="+le);ke.r==12&&(e.l+=10,_e-=10)}var ge={};if(le===10?ge=ke.f(e,_e,G):ge=ZZ(le,ke,e,_e,G),V==0&&[9,521,1033,2057].indexOf(Y)===-1)continue;switch(le){case 34:r.opts.Date1904=R.WBProps.date1904=ge;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(G.enc||(e.l=0),G.enc=ge,!t.password)throw new Error("File is password-protected");if(ge.valid==null)throw new Error("Encryption scheme unsupported");if(!ge.valid)throw new Error("Password is incorrect");break;case 92:G.lastuser=ge;break;case 66:var ye=Number(ge);switch(ye){case 21010:ye=1200;break;case 32768:ye=1e4;break;case 32769:ye=1252;break}Lo(G.codepage=ye),ae=!0;break;case 317:G.rrtabid=ge;break;case 25:G.winlocked=ge;break;case 439:r.opts.RefreshAll=ge;break;case 12:r.opts.CalcCount=ge;break;case 16:r.opts.CalcDelta=ge;break;case 17:r.opts.CalcIter=ge;break;case 13:r.opts.CalcMode=ge;break;case 14:r.opts.CalcPrecision=ge;break;case 95:r.opts.CalcSaveRecalc=ge;break;case 15:G.CalcRefMode=ge;break;case 2211:r.opts.FullCalc=ge;break;case 129:ge.fDialog&&(s["!type"]="dialog"),ge.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),ge.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:F.push(ge);break;case 430:B.push([ge]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(ge);break;case 24:case 536:ie={Name:ge.Name,Ref:Aa(ge.rgce,i,null,B,G)},ge.itab>0&&(ie.Sheet=ge.itab-1),B.names.push(ie),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(ge),ge.Name=="_xlnm._FilterDatabase"&&ge.itab>0&&ge.rgce&&ge.rgce[0]&&ge.rgce[0][0]&&ge.rgce[0][0][0]=="PtgArea3d"&&(se[ge.itab-1]={ref:kr(ge.rgce[0][0][1][2])});break;case 22:G.ExternCount=ge;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(ge),B.XTI=B.XTI.concat(ge);break;case 2196:if(G.biff<8)break;ie!=null&&(ie.Comment=ge[1]);break;case 18:s["!protect"]=ge;break;case 19:ge!==0&&G.WTF&&console.error("Password verifier: "+ge);break;case 133:a[ge.pos]=ge,G.snames.push(ge.name);break;case 10:{if(--V)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=kr(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ke=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=kr(i),i.e.r=Ke}i.e.r++,i.e.c++}te.length>0&&(s["!merges"]=te),Z.length>0&&(s["!objects"]=Z),J.length>0&&(s["!cols"]=J),I.length>0&&(s["!rows"]=I),R.Sheets.push(T)}d===""?f=s:n[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(G.biff===8&&(G.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ge.BIFFVer]||8),G.biffguess=ge.BIFFVer==0,ge.BIFFVer==0&&ge.dt==4096&&(G.biff=5,ae=!0,Lo(G.codepage=28591)),G.biff==8&&ge.BIFFVer==0&&ge.dt==16&&(G.biff=2),V++)break;if(s=t.dense?[]:{},G.biff<8&&!ae&&(ae=!0,Lo(G.codepage=t.codepage||1252)),G.biff<5||ge.BIFFVer==0&&ge.dt==4096){d===""&&(d="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Xe={pos:e.l-_e,name:d};a[Xe.pos]=Xe,G.snames.push(d)}else d=(a[Q]||{name:""}).name;ge.dt==32&&(s["!type"]="chart"),ge.dt==64&&(s["!type"]="macro"),te=[],Z=[],G.arrayf=k=[],J=[],I=[],W=!1,T={Hidden:(a[Q]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[ge.r]||[])[ge.c]:s[fr({c:ge.c,r:ge.r})])&&++ge.c,_={ixfe:ge.ixfe,XF:F[ge.ixfe]||{},v:ge.val,t:"n"},H>0&&(_.z=X[_.ixfe>>8&63]),gl(_,t,r.opts.Date1904),O({c:ge.c,r:ge.r},_,t);break;case 5:case 517:_={ixfe:ge.ixfe,XF:F[ge.ixfe],v:ge.val,t:ge.t},H>0&&(_.z=X[_.ixfe>>8&63]),gl(_,t,r.opts.Date1904),O({c:ge.c,r:ge.r},_,t);break;case 638:_={ixfe:ge.ixfe,XF:F[ge.ixfe],v:ge.rknum,t:"n"},H>0&&(_.z=X[_.ixfe>>8&63]),gl(_,t,r.opts.Date1904),O({c:ge.c,r:ge.r},_,t);break;case 189:for(var lt=ge.c;lt<=ge.C;++lt){var Ye=ge.rkrec[lt-ge.c][0];_={ixfe:Ye,XF:F[Ye],v:ge.rkrec[lt-ge.c][1],t:"n"},H>0&&(_.z=X[_.ixfe>>8&63]),gl(_,t,r.opts.Date1904),O({c:lt,r:ge.r},_,t)}break;case 6:case 518:case 1030:{if(ge.val=="String"){o=ge;break}if(_=b1(ge.val,ge.cell.ixfe,ge.tt),_.XF=F[_.ixfe],t.cellFormula){var We=ge.formula;if(We&&We[0]&&We[0][0]&&We[0][0][0]=="PtgExp"){var Me=We[0][0][1][0],je=We[0][0][1][1],De=fr({r:Me,c:je});E[De]?_.f=""+Aa(ge.formula,i,ge.cell,B,G):_.F=((t.dense?(s[Me]||[])[je]:s[De])||{}).F}else _.f=""+Aa(ge.formula,i,ge.cell,B,G)}H>0&&(_.z=X[_.ixfe>>8&63]),gl(_,t,r.opts.Date1904),O(ge.cell,_,t),o=ge}break;case 7:case 519:if(o)o.val=ge,_=b1(ge,o.cell.ixfe,"s"),_.XF=F[_.ixfe],t.cellFormula&&(_.f=""+Aa(o.formula,i,o.cell,B,G)),H>0&&(_.z=X[_.ixfe>>8&63]),gl(_,t,r.opts.Date1904),O(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(ge);var Ge=fr(ge[0].s);if(y=t.dense?(s[ge[0].s.r]||[])[ge[0].s.c]:s[Ge],t.cellFormula&&y){if(!o||!Ge||!y)break;y.f=""+Aa(ge[1],i,ge[0],B,G),y.F=kr(ge[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;E[fr(o.cell)]=ge[0],y=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[fr(o.cell)],(y||{}).f=""+Aa(ge[0],i,p,B,G)}}break;case 253:_=b1(c[ge.isst].t,ge.ixfe,"s"),c[ge.isst].h&&(_.h=c[ge.isst].h),_.XF=F[_.ixfe],H>0&&(_.z=X[_.ixfe>>8&63]),gl(_,t,r.opts.Date1904),O({c:ge.c,r:ge.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:ge.ixfe,XF:F[ge.ixfe],t:"z"},H>0&&(_.z=X[_.ixfe>>8&63]),gl(_,t,r.opts.Date1904),O({c:ge.c,r:ge.r},_,t));break;case 190:if(t.sheetStubs)for(var ct=ge.c;ct<=ge.C;++ct){var at=ge.ixfe[ct-ge.c];_={ixfe:at,XF:F[at],t:"z"},H>0&&(_.z=X[_.ixfe>>8&63]),gl(_,t,r.opts.Date1904),O({c:ct,r:ge.r},_,t)}break;case 214:case 516:case 4:_=b1(ge.val,ge.ixfe,"s"),_.XF=F[_.ixfe],H>0&&(_.z=X[_.ixfe>>8&63]),gl(_,t,r.opts.Date1904),O({c:ge.c,r:ge.r},_,t);break;case 0:case 512:V===1&&(i=ge);break;case 252:c=ge;break;case 1054:if(G.biff==4){X[H++]=ge[1];for(var wt=0;wt<H+163&&ur[wt]!=ge[1];++wt);wt>=163&&vc(ge[1],H+163)}else vc(ge[1],ge[0]);break;case 30:{X[H++]=ge;for(var Ft=0;Ft<H+163&&ur[Ft]!=ge;++Ft);Ft>=163&&vc(ge,H+163)}break;case 229:te=te.concat(ge);break;case 93:Z[ge.cmo[0]]=G.lastobj=ge;break;case 438:G.lastobj.TxO=ge;break;case 127:G.lastobj.ImData=ge;break;case 440:for(S=ge[0].s.r;S<=ge[0].e.r;++S)for(w=ge[0].s.c;w<=ge[0].e.c;++w)y=t.dense?(s[S]||[])[w]:s[fr({c:w,r:S})],y&&(y.l=ge[1]);break;case 2048:for(S=ge[0].s.r;S<=ge[0].e.r;++S)for(w=ge[0].s.c;w<=ge[0].e.c;++w)y=t.dense?(s[S]||[])[w]:s[fr({c:w,r:S})],y&&y.l&&(y.l.Tooltip=ge[1]);break;case 28:{if(G.biff<=5&&G.biff>=2)break;y=t.dense?(s[ge[0].r]||[])[ge[0].c]:s[fr(ge[0])];var Kt=Z[ge[2]];y||(t.dense?(s[ge[0].r]||(s[ge[0].r]=[]),y=s[ge[0].r][ge[0].c]={t:"z"}):y=s[fr(ge[0])]={t:"z"},i.e.r=Math.max(i.e.r,ge[0].r),i.s.r=Math.min(i.s.r,ge[0].r),i.e.c=Math.max(i.e.c,ge[0].c),i.s.c=Math.min(i.s.c,ge[0].c)),y.c||(y.c=[]),v={a:ge[1],t:Kt.TxO.t},y.c.push(v)}break;case 2173:$q(F[ge.ixfe],ge.ext);break;case 125:{if(!G.cellStyles)break;for(;ge.e>=ge.s;)J[ge.e--]={width:ge.w/256,level:ge.level||0,hidden:!!(ge.flags&1)},W||(W=!0,TS(ge.w/256)),Mu(J[ge.e+1])}break;case 520:{var bt={};ge.level!=null&&(I[ge.r]=bt,bt.level=ge.level),ge.hidden&&(I[ge.r]=bt,bt.hidden=!0),ge.hpt&&(I[ge.r]=bt,bt.hpt=ge.hpt,bt.hpx=d0(ge.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||qd(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=ge;break;case 161:s["!margins"]||qd(s["!margins"]={}),s["!margins"].header=ge.header,s["!margins"].footer=ge.footer;break;case 574:ge.RTL&&(R.Views[0].RTL=!0);break;case 146:A=ge;break;case 2198:K=ge;break;case 140:N=ge;break;case 442:d?T.CodeName=ge||T.name:R.WBProps.CodeName=ge||"ThisWorkbook";break}}else ke||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=_e}return r.SheetNames=ts(a).sort(function(At,gt){return Number(At)-Number(gt)}).map(function(At){return a[At].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&se.forEach(function(At,gt){r.Sheets[r.SheetNames[gt]]["!autofilter"]=At}),r.Strings=c,r.SSF=Pn(ur),G.enc&&(r.Encryption=G.enc),K&&(r.Themes=K),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),B.names.length>0&&(R.Names=B.names),r.Workbook=R,r}var $m={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function tee(e,t,r){var n=ir.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=O3(n,n2,$m.DSI);for(var a in s)t[a]=s[a]}catch(d){if(r.WTF)throw d}var i=ir.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=O3(i,s2,$m.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(Ij(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function ree(e,t){var r=[],n=[],s=[],a=0,i,o=g3(n2,"n"),c=g3(s2,"n");if(e.Props)for(i=ts(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=ts(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var d=[];for(a=0;a<s.length;++a)Wj.indexOf(s[a][0])>-1||Rj.indexOf(s[a][0])>-1||s[a][1]!=null&&d.push(s[a]);n.length&&ir.utils.cfb_add(t,"/SummaryInformation",B3(n,$m.SI,c,s2)),(r.length||d.length)&&ir.utils.cfb_add(t,"/DocumentSummaryInformation",B3(r,$m.DSI,o,n2,d.length?d:null,$m.UDI))}function LF(e,t){t||(t={}),IS(t),rS(),t.codepage&&tS(t.codepage);var r,n;if(e.FullPaths){if(ir.find(e,"/encryption"))throw new Error("File is password-protected");r=ir.find(e,"!CompObj"),n=ir.find(e,"/Workbook")||ir.find(e,"/Book")}else{switch(t.type){case"base64":e=Ii(Oi(e));break;case"binary":e=Ii(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ha(e,0),n={content:e}}var s,a;if(r&&JZ(r),t.bookProps&&!t.bookSheets)s={};else{var i=Ar?"buffer":"array";if(n&&n.content)s=eee(n.content,t);else if((a=ir.find(e,"PerfectOffice_MAIN"))&&a.content)s=Kd.to_workbook(a.content,(t.type=i,t));else if((a=ir.find(e,"NativeContent_MAIN"))&&a.content)s=Kd.to_workbook(a.content,(t.type=i,t));else throw(a=ir.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&ir.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=mX(e))}var o={};return e.FullPaths&&tee(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function nee(e,t){var r=t||{},n=ir.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ir.utils.cfb_add(n,s,OF(e,r)),r.biff==8&&(e.Props||e.Custprops)&&ree(e,n),r.biff==8&&e.vbaraw&&pX(n,ir.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var xp={0:{f:EJ},1:{f:IJ},2:{f:eQ},3:{f:zJ},4:{f:BJ},5:{f:JJ},6:{f:aQ},7:{f:KJ},8:{f:fQ},9:{f:dQ},10:{f:cQ},11:{f:uQ},12:{f:LJ},13:{f:rQ},14:{f:GJ},15:{f:$J},16:{f:AF},17:{f:oQ},18:{f:XJ},19:{f:pS},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:oZ},40:{},42:{},43:{f:aq},44:{f:nq},45:{f:lq},46:{f:uq},47:{f:cq},48:{},49:{f:jH},50:{},51:{f:Hq},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Zj},62:{f:sQ},63:{f:Zq},64:{f:NQ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:La,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kQ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:DJ},148:{f:jJ,p:16},151:{f:yQ},152:{},153:{f:sZ},154:{},155:{},156:{f:rZ},157:{},158:{},159:{T:1,f:wK},160:{T:-1},161:{T:1,f:Sf},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:hQ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Wq},336:{T:-1},337:{f:Kq,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:r2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Qj},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:vQ},427:{f:wQ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:bQ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:PJ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:pQ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:r2},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:uX},633:{T:1},634:{T:-1},635:{T:1,f:lX},636:{T:-1},637:{f:RH},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:GQ},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AQ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},u2={6:{f:$w},10:{f:vu},12:{f:Ss},13:{f:Ss},14:{f:us},15:{f:us},16:{f:Fa},17:{f:us},18:{f:us},19:{f:Ss},20:{f:G3},21:{f:G3},23:{f:Qj},24:{f:K3},25:{f:us},26:{},27:{},28:{f:AV},29:{},34:{f:us},35:{f:V3},38:{f:Fa},39:{f:Fa},40:{f:Fa},41:{f:Fa},42:{f:us},43:{f:us},47:{f:$K},49:{f:rV},51:{f:Ss},60:{},61:{f:JG},64:{f:us},65:{f:tV},66:{f:Ss},77:{},80:{},81:{},82:{},85:{f:Ss},89:{},90:{},91:{},92:{f:UG},93:{f:PV},94:{},95:{f:us},96:{},97:{},99:{f:us},125:{f:Zj},128:{f:xV},129:{f:WG},130:{f:Ss},131:{f:us},132:{f:us},133:{f:zG},134:{},140:{f:UV},141:{f:Ss},144:{},146:{f:zV},151:{},152:{},153:{},154:{},155:{},156:{f:Ss},157:{},158:{},160:{f:YV},161:{f:VV},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:hV},190:{f:gV},193:{f:vu},197:{},198:{},199:{},200:{},201:{},202:{f:us},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ss},220:{},221:{f:us},222:{},224:{f:pV},225:{f:BG},226:{f:vu},227:{},229:{f:jV},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:GG},253:{f:sV},255:{f:KG},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:zj},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:us},353:{f:vu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:bV},431:{f:us},432:{},433:{},434:{},437:{},438:{f:IV},439:{f:us},440:{f:MV},441:{},442:{f:Gp},443:{},444:{f:Ss},445:{},446:{},448:{f:vu},449:{f:YG,r:2},450:{f:vu},512:{f:W3},513:{f:XV},515:{f:wV},516:{f:iV},517:{f:H3},519:{f:JV},520:{f:qG},523:{},545:{f:q3},549:{f:$3},566:{},574:{f:ZG},638:{f:fV},659:{},1048:{},1054:{f:lV},1084:{},1212:{f:TV},2048:{f:OV},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:v1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:vu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:HV,r:12},2173:{f:Uq,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:us,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:CV,r:12},2197:{},2198:{f:Rq,r:12},2199:{},2200:{},2201:{},2202:{f:EV,r:12},2203:{f:vu},2204:{},2205:{},2206:{},2207:{},2211:{f:XG},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ss},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:KV},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:WV},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:W3},1:{},2:{f:rK},3:{f:eK},4:{f:ZV},5:{f:H3},7:{f:sK},8:{},9:{f:v1},11:{},22:{f:Ss},30:{f:uV},31:{},32:{},33:{f:q3},36:{},37:{f:$3},50:{f:aK},62:{},52:{},67:{},68:{f:Ss},69:{},86:{},126:{},127:{f:QV},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:iK},223:{},234:{},354:{},421:{},518:{f:$w},521:{f:v1},536:{f:K3},547:{f:V3},561:{},579:{},1030:{f:$w},1033:{f:v1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Dt(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&hS(r)&&e.push(r)}}function see(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Dt(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,d=0;d+(i[o]||8224)<=8224;)d+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,a),f.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<s;){for(f=e.next(4),f.write_shift(2,60),d=0;d+(i[o]||8224)<=8224;)d+=i[o]||8224,o++;f.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Xp(e,t,r){return e||(e=ht(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function aee(e,t,r,n){var s=ht(9);return Xp(s,e,t),Hj(r,n||"b",s),s}function iee(e,t,r){var n=ht(8+2*r.length);return Xp(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function oee(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Os(Fn(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Dt(e,2,nK(r,n,s)):Dt(e,3,tK(r,n,s));return;case"b":case"e":Dt(e,5,aee(r,n,t.v,t.t));return;case"s":case"str":Dt(e,4,iee(r,n,(t.v||"").slice(0,255)));return}Dt(e,1,Xp(null,r,n))}function lee(e,t,r,n){var s=Array.isArray(t),a=qr(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=kr(a)}for(var d=a.s.r;d<=a.e.r;++d){o=hs(d);for(var f=a.s.c;f<=a.e.c;++f){d===a.s.r&&(c[f]=Wn(f)),i=c[f]+o;var p=s?(t[d]||[])[f]:t[i];p&&oee(e,p,d,f)}}}function cee(e,t){for(var r=t||{},n=bi(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Dt(n,r.biff==4?1033:r.biff==3?521:9,SS(e,16,r)),lee(n,e.Sheets[e.SheetNames[s]],s,r),Dt(n,10),n.end()}function uee(e,t,r){Dt(e,49,nV({sz:12,name:"Arial"},r))}function dee(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Dt(e,1054,cV(s,t[s],r))})}function fee(e,t){var r=ht(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Dt(e,2151,r),r=ht(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Xj(qr(t["!ref"]||"A1"),r),r.write_shift(4,4),Dt(e,2152,r)}function hee(e,t){for(var r=0;r<16;++r)Dt(e,224,z3({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Dt(e,224,z3(n,0,t))})}function gee(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Dt(e,440,LV(n)),n[1].Tooltip&&Dt(e,2048,BV(n))}delete t["!links"]}function mee(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Dt(e,125,GV(rv(s,n),s))})}}function pee(e,t,r,n,s){var a=16+qu(s.cellXfs,t,s);if(t.v==null&&!t.bf){Dt(e,513,gf(r,n,a));return}if(t.bf)Dt(e,6,WY(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Os(Fn(t.v)):t.v;Dt(e,515,_V(r,n,i,a));break;case"b":case"e":Dt(e,517,vV(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=FS(s.Strings,t.v,s.revStrings);Dt(e,253,aV(r,n,o,a))}else Dt(e,516,oV(r,n,(t.v||"").slice(0,255),a,s));break;default:Dt(e,513,gf(r,n,a))}}function xee(e,t,r){var n=bi(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),d=t.biff==8,f,p="",m=[],y=qr(a["!ref"]||"A1"),v=d?65536:16384;if(y.e.c>255||y.e.r>=v){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,v-1)}Dt(n,2057,SS(r,16,t)),Dt(n,13,oo(1)),Dt(n,12,oo(100)),Dt(n,15,Za(!0)),Dt(n,17,Za(!1)),Dt(n,16,ff(.001)),Dt(n,95,Za(!0)),Dt(n,42,Za(!1)),Dt(n,43,Za(!1)),Dt(n,130,oo(1)),Dt(n,128,yV()),Dt(n,131,Za(!1)),Dt(n,132,Za(!1)),d&&mee(n,a["!cols"]),Dt(n,512,dV(y,t)),d&&(a["!links"]=[]);for(var w=y.s.r;w<=y.e.r;++w){p=hs(w);for(var S=y.s.c;S<=y.e.c;++S){w===y.s.r&&(m[S]=Wn(S)),f=m[S]+p;var E=c?(a[w]||[])[S]:a[f];E&&(pee(n,E,w,S,t),d&&E.l&&a["!links"].push([f,E.l]))}}var k=o.CodeName||o.name||s;return d&&Dt(n,574,eV((i.Views||[])[0])),d&&(a["!merges"]||[]).length&&Dt(n,229,FV(a["!merges"])),d&&gee(n,a),Dt(n,442,Gj(k)),d&&fee(n,a),Dt(n,10),n.end()}function yee(e,t,r){var n=bi(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(Dt(n,2057,SS(e,5,r)),r.bookType=="xla"&&Dt(n,135),Dt(n,225,o?oo(1200):null),Dt(n,193,vG(2)),c&&Dt(n,191),c&&Dt(n,192),Dt(n,226),Dt(n,92,$G("SheetJS",r)),Dt(n,66,oo(o?1200:1252)),o&&Dt(n,353,oo(0)),o&&Dt(n,448),Dt(n,317,qV(e.SheetNames.length)),o&&e.vbaraw&&Dt(n,211),o&&e.vbaraw){var d=i.CodeName||"ThisWorkbook";Dt(n,442,Gj(d))}Dt(n,156,oo(17)),Dt(n,25,Za(!1)),Dt(n,18,Za(!1)),Dt(n,19,oo(0)),o&&Dt(n,431,Za(!1)),o&&Dt(n,444,oo(0)),Dt(n,61,QG()),Dt(n,64,Za(!1)),Dt(n,141,oo(0)),Dt(n,34,Za(YQ(e)=="true")),Dt(n,14,Za(!0)),o&&Dt(n,439,Za(!1)),Dt(n,218,oo(0)),uee(n,e,r),dee(n,e.SSF,r),hee(n,r),o&&Dt(n,352,Za(!1));var f=n.end(),p=bi();o&&Dt(p,140,$V()),o&&r.Strings&&see(p,252,VG(r.Strings)),Dt(p,10);var m=p.end(),y=bi(),v=0,w=0;for(w=0;w<e.SheetNames.length;++w)v+=(o?12:11)+(o?2:1)*e.SheetNames[w].length;var S=f.length+v+m.length;for(w=0;w<e.SheetNames.length;++w){var E=a[w]||{};Dt(y,133,HG({pos:S,hs:E.Hidden||0,dt:0,name:e.SheetNames[w]},r)),S+=t[w].length}var k=y.end();if(v!=k.length)throw new Error("BS8 "+v+" != "+k.length);var _=[];return f.length&&_.push(f),k.length&&_.push(k),m.length&&_.push(m),Qs(_)}function vee(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Pn(ur)),e&&e.SSF&&(A0(),Xy(e.SSF),r.revssf=Jy(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,MS(r),r.cellXfs=[],qu(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=xee(s,r,e);return n.unshift(yee(e,n,r)),Qs(n)}function OF(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Si(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return vee(e,t);case 4:case 3:case 2:return cee(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function sN(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=nH(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,f=0,p=0,m=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<c.length;++i){var w=c[i].trim(),S=w.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}f=0;continue}if(!(S!="<td"&&S!="<th")){var E=w.split(/<\/t[dh]>/i);for(o=0;o<E.length;++o){var k=E[o].trim();if(k.match(/<t[dh]/i)){for(var _=k,N=0;_.charAt(0)=="<"&&(N=_.indexOf(">"))>-1;)_=_.slice(N+1);for(var F=0;F<v.length;++F){var A=v[F];A.s.c==f&&A.s.r<d&&d<=A.e.r&&(f=A.e.c+1,F=-1)}var R=gr(k.slice(0,k.indexOf(">")));m=R.colspan?+R.colspan:1,((p=+R.rowspan)>1||m>1)&&v.push({s:{r:d,c:f},e:{r:d+(p||1)-1,c:f+m-1}});var T=R.t||R["data-t"]||"";if(!_.length){f+=m;continue}if(_=lj(_),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>f&&(y.s.c=f),y.e.c<f&&(y.e.c=f),!_.length){f+=m;continue}var D={t:"s",v:_};r.raw||!_.trim().length||T=="s"||(_==="TRUE"?D={t:"b",v:!0}:_==="FALSE"?D={t:"b",v:!1}:isNaN(Uo(_))?isNaN(c0(_).getDate())||(D={t:"d",v:Fn(_)},r.cellDates||(D={t:"n",v:Os(D.v)}),D.z=r.dateNF||ur[14]):D={t:"n",v:Uo(_)}),r.dense?(n[d]||(n[d]=[]),n[d][f]=D):n[fr({r:d,c:f})]=D,f+=m}}}}return n["!ref"]=kr(y),v.length&&(n["!merges"]=v),n}function wee(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>i)&&!(s[d].e.r<r||s[d].e.c<i)){if(s[d].s.r<r||s[d].s.c<i){o=-1;break}o=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(o<0)){var f=fr({r,c:i}),p=n.dense?(e[r]||[])[i]:e[f],m=p&&p.v!=null&&(p.h||uS(p.w||(Cc(p),p.w)||""))||"",y={};o>1&&(y.rowspan=o),c>1&&(y.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":p&&(y["data-t"]=p&&p.t||"z",p.v!=null&&(y["data-v"]=p.v),p.z!=null&&(y["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+p.l.Target+'">'+m+"</a>")),y.id=(n.id||"sjs")+"-"+f,a.push(Pt("td",m,y))}}var v="<tr>";return v+a.join("")+"</tr>"}var _ee='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bee="</body></html>";function See(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ku(sN(r[0],t),t);var n=BS();return r.forEach(function(s,a){US(n,sN(s,t),"Sheet"+(a+1))}),n}function kee(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function BF(e,t){var r=t||{},n=r.header!=null?r.header:_ee,s=r.footer!=null?r.footer:bee,a=[n],i=Si(e["!ref"]);r.dense=Array.isArray(e),a.push(kee(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(wee(e,i,o,r));return a.push("</table>"+s),a.join("")}function UF(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?zn(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var f=Si(e["!ref"]);d.s.r=Math.min(d.s.r,f.s.r),d.s.c=Math.min(d.s.c,f.s.c),d.e.r=Math.max(d.e.r,f.e.r),d.e.c=Math.max(d.e.c,f.e.c),s==-1&&(d.e.r=s=f.e.r+1)}var p=[],m=0,y=e["!rows"]||(e["!rows"]=[]),v=0,w=0,S=0,E=0,k=0,_=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&w<c;++v){var N=o[v];if(aN(N)){if(n.display)continue;y[w]={hidden:!0}}var F=N.children;for(S=E=0;S<F.length;++S){var A=F[S];if(!(n.display&&aN(A))){var R=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):lj(A.innerHTML),T=A.getAttribute("data-z")||A.getAttribute("z");for(m=0;m<p.length;++m){var D=p[m];D.s.c==E+a&&D.s.r<w+s&&w+s<=D.e.r&&(E=D.e.c+1-a,m=-1)}_=+A.getAttribute("colspan")||1,((k=+A.getAttribute("rowspan")||1)>1||_>1)&&p.push({s:{r:w+s,c:E+a},e:{r:w+s+(k||1)-1,c:E+a+(_||1)-1}});var L={t:"s",v:R},O=A.getAttribute("data-t")||A.getAttribute("t")||"";R!=null&&(R.length==0?L.t=O||"z":n.raw||R.trim().length==0||O=="s"||(R==="TRUE"?L={t:"b",v:!0}:R==="FALSE"?L={t:"b",v:!1}:isNaN(Uo(R))?isNaN(c0(R).getDate())||(L={t:"d",v:Fn(R)},n.cellDates||(L={t:"n",v:Os(L.v)}),L.z=n.dateNF||ur[14]):L={t:"n",v:Uo(R)})),L.z===void 0&&T!=null&&(L.z=T);var G="",K=A.getElementsByTagName("A");if(K&&K.length)for(var te=0;te<K.length&&!(K[te].hasAttribute("href")&&(G=K[te].getAttribute("href"),G.charAt(0)!="#"));++te);G&&G.charAt(0)!="#"&&(L.l={Target:G}),n.dense?(e[w+s]||(e[w+s]=[]),e[w+s][E+a]=L):e[fr({c:E+a,r:w+s})]=L,d.e.c<E+a&&(d.e.c=E+a),E+=_}}++w}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,w-1+s),e["!ref"]=kr(d),w>=c&&(e["!fullref"]=kr((d.e.r=o.length-v+w-1+s,d))),e}function $F(e,t){var r=t||{},n=r.dense?[]:{};return UF(n,e,t)}function Cee(e,t){return Ku($F(e,t),t)}function aN(e){var t="",r=Tee(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Tee(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Eee(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Kr(t.replace(/<[^>]*>/g,""));return[r]}var iN={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function WF(e,t){var r=t||{},n=dS(e),s=[],a,i,o={name:""},c="",d=0,f,p,m={},y=[],v=r.dense?[]:{},w,S,E={value:""},k="",_=0,N=[],F=-1,A=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,D={},L=[],O={},G=0,K=0,te=[],Z=1,J=1,I=[],W={Names:[]},B={},Y=["",""],V=[],H={},X="",se=0,ie=!1,ae=!1,Q=0;for(dp.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=dp.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"工作表":w[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?v["!ref"]=kr(R):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=R.e.r&&(v["!fullref"]=v["!ref"],R.e.r=r.sheetRows-1,v["!ref"]=kr(R)),L.length&&(v["!merges"]=L),te.length&&(v["!rows"]=te),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),y.push(f.name),m[f.name]=v,ae=!1):w[0].charAt(w[0].length-2)!=="/"&&(f=gr(w[0],!1),F=A=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,v=r.dense?[]:{},L=[],te=[],ae=!0);break;case"table-row-group":w[1]==="/"?--T:++T;break;case"table-row":case"行":if(w[1]==="/"){F+=Z,Z=1;break}if(p=gr(w[0],!1),p.行号?F=p.行号-1:F==-1&&(F=0),Z=+p["number-rows-repeated"]||1,Z<10)for(Q=0;Q<Z;++Q)T>0&&(te[F+Q]={level:T});A=-1;break;case"covered-table-cell":w[1]!=="/"&&++A,r.sheetStubs&&(r.dense?(v[F]||(v[F]=[]),v[F][A]={t:"z"}):v[fr({r:F,c:A})]={t:"z"}),k="",N=[];break;case"table-cell":case"数据":if(w[0].charAt(w[0].length-2)==="/")++A,E=gr(w[0],!1),J=parseInt(E["number-columns-repeated"]||"1",10),S={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(S.f=tN(Kr(E.formula))),(E.数据类型||E["value-type"])=="string"&&(S.t="s",S.v=Kr(E["string-value"]||""),r.dense?(v[F]||(v[F]=[]),v[F][A]=S):v[fr({r:F,c:A})]=S),A+=J-1;else if(w[1]!=="/"){++A,k="",_=0,N=[],J=1;var le=Z?F+Z-1:F;if(A>R.e.c&&(R.e.c=A),A<R.s.c&&(R.s.c=A),F<R.s.r&&(R.s.r=F),le>R.e.r&&(R.e.r=le),E=gr(w[0],!1),V=[],H={},S={t:E.数据类型||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=Kr(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(G=parseInt(E["number-matrix-rows-spanned"],10)||0,K=parseInt(E["number-matrix-columns-spanned"],10)||0,O={s:{r:F,c:A},e:{r:F+G-1,c:A+K-1}},S.F=kr(O),I.push([O,S.F])),E.formula)S.f=tN(E.formula);else for(Q=0;Q<I.length;++Q)F>=I[Q][0].s.r&&F<=I[Q][0].e.r&&A>=I[Q][0].s.c&&A<=I[Q][0].e.c&&(S.F=I[Q][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(G=parseInt(E["number-rows-spanned"],10)||0,K=parseInt(E["number-columns-spanned"],10)||0,O={s:{r:F,c:A},e:{r:F+G-1,c:A+K-1}},L.push(O)),E["number-columns-repeated"]&&(J=parseInt(E["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=En(E["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(E.value);break;case"percentage":S.t="n",S.v=parseFloat(E.value);break;case"currency":S.t="n",S.v=parseFloat(E.value);break;case"date":S.t="d",S.v=Fn(E["date-value"]),r.cellDates||(S.t="n",S.v=Os(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=eH(E["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Qy(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(E.数据数值);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",E["string-value"]!=null&&(k=Kr(E["string-value"]),N=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(ie=!1,S.t==="s"&&(S.v=k||"",N.length&&(S.R=N),ie=_==0),B.Target&&(S.l=B),V.length>0&&(S.c=V,V=[]),k&&r.cellText!==!1&&(S.w=k),ie&&(S.t="z",delete S.v),(!ie||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=F))for(var _e=0;_e<Z;++_e){if(J=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(v[F+_e]||(v[F+_e]=[]),v[F+_e][A]=_e==0?S:Pn(S);--J>0;)v[F+_e][A+J]=Pn(S);else for(v[fr({r:F+_e,c:A})]=S;--J>0;)v[fr({r:F+_e,c:A+J})]=Pn(S);R.e.c<=A&&(R.e.c=A)}J=parseInt(E["number-columns-repeated"]||"1",10),A+=J-1,J=0,S={},k="",N=[]}B={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((a=s.pop())[0]!==w[3])throw"Bad state: "+a}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((a=s.pop())[0]!==w[3])throw"Bad state: "+a;H.t=k,N.length&&(H.R=N),H.a=X,V.push(H)}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);X="",se=0,k="",_=0,N=[];break;case"creator":w[1]==="/"?X=n.slice(se,w.index):se=w.index+w[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((a=s.pop())[0]!==w[3])throw"Bad state: "+a}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);k="",_=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(D[o.name]=c,(a=s.pop())[0]!==w[3])throw"Bad state: "+a}else w[0].charAt(w[0].length-2)!=="/"&&(c="",o=gr(w[0],!1),s.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=gr(w[0],!1),c+=iN[w[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=gr(w[0],!1),c+=iN[w[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(d,w.index);break}else d=w.index+w[0].length;break;case"named-range":i=gr(w[0],!1),Y=Ww(i["cell-range-address"]);var ke={Name:i.name,Ref:Y[0]+"!"+Y[1]};ae&&(ke.Sheet=y.length),W.Names.push(ke);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(w[1]==="/"&&(!E||!E["string-value"])){var Oe=Eee(n.slice(_,w.index));k=(k.length>0?k+`
`:"")+Oe[0]}else gr(w[0],!1),_=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{Y=Ww(gr(w[0])["target-range-address"]),m[Y[0]]["!autofilter"]={ref:Y[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(B=gr(w[0],!1),!B.href)break;B.Target=Kr(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(Y=Ww(B.Target.slice(1)),B.Target="#"+Y[0]+"!"+Y[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(w)}}var ge={Sheets:m,SheetNames:y,Workbook:W};return r.bookSheets&&delete ge.Sheets,ge}function oN(e,t){t=t||{},io(e,"META-INF/manifest.xml")&&eG(bs(e,"META-INF/manifest.xml"),t);var r=Mi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=WF(pn(r),t);return io(e,"meta.xml")&&(n.Props=Pj(bs(e,"meta.xml"))),n}function lN(e,t){return WF(e,t)}var Nee=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+up({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ms+t}})(),cN=(function(){var e=function(a){return un(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+un(i.SheetNames[o])+`" table:style-name="ta1">
`);var d=0,f=0,p=Si(a["!ref"]||"A1"),m=a["!merges"]||[],y=0,v=Array.isArray(a);if(a["!cols"])for(f=0;f<=p.e.c;++f)c.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var w="",S=a["!rows"]||[];for(d=0;d<p.s.r;++d)w=S[d]?' table:style-name="ro'+S[d].ods+'"':"",c.push("        <table:table-row"+w+`></table:table-row>
`);for(;d<=p.e.r;++d){for(w=S[d]?' table:style-name="ro'+S[d].ods+'"':"",c.push("        <table:table-row"+w+`>
`),f=0;f<p.s.c;++f)c.push(t);for(;f<=p.e.c;++f){var E=!1,k={},_="";for(y=0;y!=m.length;++y)if(!(m[y].s.c>f)&&!(m[y].s.r>d)&&!(m[y].e.c<f)&&!(m[y].e.r<d)){(m[y].s.c!=f||m[y].s.r!=d)&&(E=!0),k["table:number-columns-spanned"]=m[y].e.c-m[y].s.c+1,k["table:number-rows-spanned"]=m[y].e.r-m[y].s.r+1;break}if(E){c.push(r);continue}var N=fr({r:d,c:f}),F=v?(a[d]||[])[f]:a[N];if(F&&F.f&&(k["table:formula"]=un(qY(F.f)),F.F&&F.F.slice(0,N.length)==N)){var A=Si(F.F);k["table:number-matrix-columns-spanned"]=A.e.c-A.s.c+1,k["table:number-matrix-rows-spanned"]=A.e.r-A.s.r+1}if(!F){c.push(t);continue}switch(F.t){case"b":_=F.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=F.v?"true":"false";break;case"n":_=F.w||String(F.v||0),k["office:value-type"]="float",k["office:value"]=F.v||0;break;case"s":case"str":_=F.v==null?"":F.v,k["office:value-type"]="string";break;case"d":_=F.w||Fn(F.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Fn(F.v).toISOString(),k["table:style-name"]="ce1";break;default:c.push(t);continue}var R=e(_);if(F.l&&F.l.Target){var T=F.l.Target;T=T.charAt(0)=="#"?"#"+XY(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),R=Pt("text:a",R,{"xlink:href":T.replace(/&/g,"&amp;")})}c.push("          "+Pt("table:table-cell",Pt("text:p",R,{}),k)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var f=0;f<d["!cols"].length;++f)if(d["!cols"][f]){var p=d["!cols"][f];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Mu(p),p.ods=o;var m=d["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var f=0;f<d["!rows"].length;++f)if(d["!rows"][f]){d["!rows"][f].ods=c;var p=d["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[ms],d=up({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=up({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+d+f+`>
`),c.push(Fj().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var p=0;p!=i.SheetNames.length;++p)c.push(n(i.Sheets[i.SheetNames[p]],i,p));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function zF(e,t){if(t.bookType=="fods")return cN(e,t);var r=oS(),n="",s=[],a=[];return n="mimetype",Cr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Cr(r,n,cN(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Cr(r,n,Nee(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Cr(r,n,ms+Fj()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Cr(r,n,nG(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Cr(r,n,tG(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function mf(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function d2(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):pn(Vu(e))}function Aee(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ii(_l(e))}function jee(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ou(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function uN(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Fee(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Pee(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function yp(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function on(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function es(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Yr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=yp(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=yp(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var d={data:o,type:a};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function da(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(on(n*8+s.type)),s.type==2&&t.push(on(s.data.length)),t.push(s.data))})}),Ou(t)}function RS(e,t){return e?.map(function(r){return t(r.data)})||[]}function no(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=yp(e,n),a=Yr(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:es(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=Yr(o.data),d=es(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=a[3])!=null&&t[0]&&(i.merge=es(a[3][0].data)>>>0>0),r.push(i)}return r}function Ch(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:on(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:on(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:on(i.data.length)}],n[2].push({data:da(i.meta),type:2})});var a=da(n);t.push(on(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Ou(t)}function Dee(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=yp(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,d=0;if(a==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Ou(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var f=Ou(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function so(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Dee(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ou(t)}function Th(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=on(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Ou(t)}function Ree(e,t,r,n){var s=mf(e),a=s.getUint32(4,!0),i=(n>1?12:8)+uN(a&(n>1?3470:398))*4,o=-1,c=-1,d=NaN,f=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=uN(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(d=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(c>-1)p={t:"s",v:t[c]};else if(!isNaN(d))p={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function Iee(e,t,r){var n=mf(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,d=NaN,f=new Date(2001,0,1);s&1&&(c=Fee(e,a),a+=16),s&2&&(d=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(i>-1)p={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return p}function Hw(e,t){var r=new Uint8Array(32),n=mf(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,Pee(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Gw(e,t){var r=new Uint8Array(32),n=mf(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Mee(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Ree(e,t,r,e[0]);case 5:return Iee(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Na(e){var t=Yr(e);return yp(t[1][0].data)}function dN(e,t){var r=Yr(t.data),n=es(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Yr(i.data),c=es(o[1][0].data)>>>0;switch(n){case 1:a[c]=d2(o[3][0].data);break;case 8:{var d=e[Na(o[9][0].data)][0],f=Yr(d.data),p=e[Na(f[1][0].data)][0],m=es(p.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var y=Yr(p.data);a[c]=y[3].map(function(v){return d2(v.data)}).join("")}break}}),a}function Lee(e,t){var r,n,s,a,i,o,c,d,f,p,m,y,v,w,S=Yr(e),E=es(S[1][0].data)>>>0,k=es(S[2][0].data)>>>0,_=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&es(S[8][0].data)>0||!1,N,F;if((a=(s=S[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(o=(i=S[7])==null?void 0:i[0])==null?void 0:o.data,F=(d=(c=S[6])==null?void 0:c[0])==null?void 0:d.data;else if((p=(f=S[4])==null?void 0:f[0])!=null&&p.data&&t!=1)N=(y=(m=S[4])==null?void 0:m[0])==null?void 0:y.data,F=(w=(v=S[3])==null?void 0:v[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var A=_?4:1,R=mf(N),T=[],D=0;D<N.length/2;++D){var L=R.getUint16(D*2,!0);L<65535&&T.push([D,L])}if(T.length!=k)throw"Expected ".concat(k," cells, found ").concat(T.length);var O=[];for(D=0;D<T.length-1;++D)O[T[D][0]]=F.subarray(T[D][1]*A,T[D+1][1]*A);return T.length>=1&&(O[T[T.length-1][0]]=F.subarray(T[T.length-1][1]*A)),{R:E,cells:O}}function Oee(e,t){var r,n=Yr(t.data),s=(r=n?.[7])!=null&&r[0]?es(n[7][0].data)>>>0>0?1:0:-1,a=RS(n[5],function(i){return Lee(i,s)});return{nrows:es(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,d){if(i[o.R][d])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(d));i[o.R][d]=c}),i},[])}}function Bee(e,t,r){var n,s=Yr(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(es(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(es(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=kr(a);var i=Yr(s[4][0].data),o=dN(e,e[Na(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?dN(e,e[Na(i[17][0].data)][0]):[],d=Yr(i[3][0].data),f=0;d[1].forEach(function(p){var m=Yr(p.data),y=e[Na(m[2][0].data)][0],v=es(y.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var w=Oee(e,y);w.data.forEach(function(S,E){S.forEach(function(k,_){var N=fr({r:f+E,c:_}),F=Mee(k,o,c);F&&(r[N]=F)})}),f+=w.nrows})}function Uee(e,t){var r=Yr(t.data),n={"!ref":"A1"},s=e[Na(r[2][0].data)],a=es(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Bee(e,s[0],n),n}function $ee(e,t){var r,n=Yr(t.data),s={name:(r=n[1])!=null&&r[0]?d2(n[1][0].data):"",sheets:[]},a=RS(n[2],Na);return a.forEach(function(i){e[i].forEach(function(o){var c=es(o.meta[1][0].data);c==6e3&&s.sheets.push(Uee(e,o))})}),s}function Wee(e,t){var r=BS(),n=Yr(t.data),s=RS(n[1],Na);if(s.forEach(function(a){e[a].forEach(function(i){var o=es(i.meta[1][0].data);if(o==2){var c=$ee(e,i);c.sheets.forEach(function(d,f){US(r,d,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Vw(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=so(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var f;try{f=no(d)}catch(p){return console.log("## "+(p.message||p))}f.forEach(function(p){a[p.id]=p.messages,i.push(p.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&es(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(d){var f=es(d.meta[1][0].data)>>>0;if(f==1)if(!o)o=d;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Wee(a,o)}function zee(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&es(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,d=mf(e[7][0].data),f=0,p=[],m=mf(e[4][0].data),y=0,v=[],w=0;w<t.length;++w){if(t[w]==null){d.setUint16(w*2,65535,!0),m.setUint16(w*2,65535);continue}d.setUint16(w*2,f,!0),m.setUint16(w*2,y,!0);var S,E;switch(typeof t[w]){case"string":S=Hw({t:"s",v:t[w]},r),E=Gw({t:"s",v:t[w]},r);break;case"number":S=Hw({t:"n",v:t[w]},r),E=Gw({t:"n",v:t[w]},r);break;case"boolean":S=Hw({t:"b",v:t[w]},r),E=Gw({t:"b",v:t[w]},r);break;default:throw new Error("Unsupported value "+t[w])}p.push(S),f+=S.length,v.push(E),y+=E.length,++c}for(e[2][0].data=on(c);w<e[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),m.setUint16(w*2,65535,!0);return e[6][0].data=Ou(p),e[3][0].data=Ou(v),c}function Hee(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Si(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(kr(n)));var a=wy(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(X){return X.forEach(function(se){typeof se=="string"&&i.push(se)})});var o={},c=[],d=ir.read(t.numbers,{type:"base64"});d.FileIndex.map(function(X,se){return[X,d.FullPaths[se]]}).forEach(function(X){var se=X[0],ie=X[1];if(se.type==2&&se.name.match(/\.iwa/)){var ae=se.content,Q=so(ae),le=no(Q);le.forEach(function(_e){c.push(_e.id),o[_e.id]={deps:[],location:ie,type:es(_e.messages[0].meta[1][0].data)}})}}),c.sort(function(X,se){return X-se});var f=c.filter(function(X){return X>1}).map(function(X){return[X,on(X)]});d.FileIndex.map(function(X,se){return[X,d.FullPaths[se]]}).forEach(function(X){var se=X[0];if(X[1],!!se.name.match(/\.iwa/)){var ie=no(so(se.content));ie.forEach(function(ae){ae.messages.forEach(function(Q){f.forEach(function(le){ae.messages.some(function(_e){return es(_e.meta[1][0].data)!=11006&&jee(_e.data,le[1])})&&o[le[0]].deps.push(ae.id)})})})}});for(var p=ir.find(d,o[1].location),m=no(so(p.content)),y,v=0;v<m.length;++v){var w=m[v];w.id==1&&(y=w)}var S=Na(Yr(y.messages[0].data)[1][0].data);for(p=ir.find(d,o[S].location),m=no(so(p.content)),v=0;v<m.length;++v)w=m[v],w.id==S&&(y=w);for(S=Na(Yr(y.messages[0].data)[2][0].data),p=ir.find(d,o[S].location),m=no(so(p.content)),v=0;v<m.length;++v)w=m[v],w.id==S&&(y=w);for(S=Na(Yr(y.messages[0].data)[2][0].data),p=ir.find(d,o[S].location),m=no(so(p.content)),v=0;v<m.length;++v)w=m[v],w.id==S&&(y=w);var E=Yr(y.messages[0].data);{E[6][0].data=on(n.e.r+1),E[7][0].data=on(n.e.c+1);var k=Na(E[46][0].data),_=ir.find(d,o[k].location),N=no(so(_.content));{for(var F=0;F<N.length&&N[F].id!=k;++F);if(N[F].id!=k)throw"Bad ColumnRowUIDMapArchive";var A=Yr(N[F].messages[0].data);A[1]=[],A[2]=[],A[3]=[];for(var R=0;R<=n.e.c;++R){var T=[];T[1]=T[2]=[{type:0,data:on(R+420690)}],A[1].push({type:2,data:da(T)}),A[2].push({type:0,data:on(R)}),A[3].push({type:0,data:on(R)})}A[4]=[],A[5]=[],A[6]=[];for(var D=0;D<=n.e.r;++D)T=[],T[1]=T[2]=[{type:0,data:on(D+726270)}],A[4].push({type:2,data:da(T)}),A[5].push({type:0,data:on(D)}),A[6].push({type:0,data:on(D)});N[F].messages[0].data=da(A)}_.content=Th(Ch(N)),_.size=_.content.length,delete E[46];var L=Yr(E[4][0].data);{L[7][0].data=on(n.e.r+1);var O=Yr(L[1][0].data),G=Na(O[2][0].data);_=ir.find(d,o[G].location),N=no(so(_.content));{if(N[0].id!=G)throw"Bad HeaderStorageBucket";var K=Yr(N[0].messages[0].data);for(D=0;D<a.length;++D){var te=Yr(K[2][0].data);te[1][0].data=on(D),te[4][0].data=on(a[D].length),K[2][D]={type:K[2][0].type,data:da(te)}}N[0].messages[0].data=da(K)}_.content=Th(Ch(N)),_.size=_.content.length;var Z=Na(L[2][0].data);_=ir.find(d,o[Z].location),N=no(so(_.content));{if(N[0].id!=Z)throw"Bad HeaderStorageBucket";for(K=Yr(N[0].messages[0].data),R=0;R<=n.e.c;++R)te=Yr(K[2][0].data),te[1][0].data=on(R),te[4][0].data=on(n.e.r+1),K[2][R]={type:K[2][0].type,data:da(te)};N[0].messages[0].data=da(K)}_.content=Th(Ch(N)),_.size=_.content.length;var J=Na(L[4][0].data);(function(){for(var X=ir.find(d,o[J].location),se=no(so(X.content)),ie,ae=0;ae<se.length;++ae){var Q=se[ae];Q.id==J&&(ie=Q)}var le=Yr(ie.messages[0].data);{le[3]=[];var _e=[];i.forEach(function(ge,ye){_e[1]=[{type:0,data:on(ye)}],_e[2]=[{type:0,data:on(1)}],_e[3]=[{type:2,data:Aee(ge)}],le[3].push({type:2,data:da(_e)})})}ie.messages[0].data=da(le);var ke=Ch(se),Oe=Th(ke);X.content=Oe,X.size=X.content.length})();var I=Yr(L[3][0].data);{var W=I[1][0];delete I[2];var B=Yr(W.data);{var Y=Na(B[2][0].data);(function(){for(var X=ir.find(d,o[Y].location),se=no(so(X.content)),ie,ae=0;ae<se.length;++ae){var Q=se[ae];Q.id==Y&&(ie=Q)}var le=Yr(ie.messages[0].data);{delete le[6],delete I[7];var _e=new Uint8Array(le[5][0].data);le[5]=[];for(var ke=0,Oe=0;Oe<=n.e.r;++Oe){var ge=Yr(_e);ke+=zee(ge,a[Oe],i),ge[1][0].data=on(Oe),le[5].push({data:da(ge),type:2})}le[1]=[{type:0,data:on(n.e.c+1)}],le[2]=[{type:0,data:on(n.e.r+1)}],le[3]=[{type:0,data:on(ke)}],le[4]=[{type:0,data:on(n.e.r+1)}]}ie.messages[0].data=da(le);var ye=Ch(se),Ke=Th(ye);X.content=Ke,X.size=X.content.length})()}W.data=da(B)}L[3][0].data=da(I)}E[4][0].data=da(L)}y.messages[0].data=da(E);var V=Ch(m),H=Th(V);return p.content=H,p.size=p.content.length,d}function HF(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function IS(e){HF([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function MS(e){HF([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Gee(e){return Ir.WS.indexOf(e)>-1?"sheet":e==Ir.CS?"chart":e==Ir.DS?"dialog":e==Ir.MS?"macro":e&&e.length?e:"sheet"}function Vee(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Gee(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Kee(e,t,r,n,s,a,i,o,c,d,f,p){try{a[n]=Lm(Mi(e,r,!0),t);var m=bs(e,t),y;switch(o){case"sheet":y=mZ(m,t,s,c,a[n],d,f,p);break;case"chart":if(y=pZ(m,t,s,c,a[n],d,f,p),!y||!y["!drawel"])break;var v=Sm(y["!drawel"].Target,t),w=fp(v),S=rX(Mi(e,v,!0),Lm(Mi(e,w,!0),v)),E=Sm(S,v),k=fp(E);y=zQ(Mi(e,E,!0),E,c,Lm(Mi(e,k,!0),E),d,y);break;case"macro":y=xZ(m,t,s,c,a[n],d,f,p);break;case"dialog":y=yZ(m,t,s,c,a[n],d,f,p);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=y;var _=[];a&&a[n]&&ts(a[n]).forEach(function(N){var F="";if(a[n][N].Type==Ir.CMNT){F=Sm(a[n][N].Target,t);var A=bZ(bs(e,F,!0),F,c);if(!A||!A.length)return;Y3(y,A,!1)}a[n][N].Type==Ir.TCMNT&&(F=Sm(a[n][N].Target,t),_=_.concat(sX(bs(e,F,!0),c)))}),_&&_.length&&Y3(y,_,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function to(e){return e.charAt(0)=="/"?e.slice(1):e}function qee(e,t){if(A0(),t=t||{},IS(t),io(e,"META-INF/manifest.xml")||io(e,"objectdata.xml"))return oN(e,t);if(io(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Vw<"u"){if(e.FileIndex)return Vw(e);var r=ir.utils.cfb_new();return x3(e).forEach(function(te){Cr(r,te,aH(e,te))}),Vw(r)}throw new Error("Unsupported NUMBERS file")}if(!io(e,"[Content_Types].xml"))throw io(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):io(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=x3(e),s=QH(Mi(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",bs(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!bs(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(Om=[],s.sst)try{Om=_Z(bs(e,to(s.sst)),s.sst,t)}catch(te){if(t.WTF)throw te}t.cellStyles&&s.themes.length&&(c=wZ(Mi(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=vZ(bs(e,to(s.style)),s.style,c,t))}s.links.map(function(te){try{var Z=Lm(Mi(e,fp(to(te))),te);return kZ(bs(e,to(te)),Z,te,t)}catch{}});var f=gZ(bs(e,to(s.workbooks[0])),s.workbooks[0],t),p={},m="";s.coreprops.length&&(m=bs(e,to(s.coreprops[0]),!0),m&&(p=Pj(m)),s.extprops.length!==0&&(m=bs(e,to(s.extprops[0]),!0),m&&aG(m,p,t)));var y={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(m=Mi(e,to(s.custprops[0]),!0),m&&(y=oG(m,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(Z){return Z.name}):p.Worksheets&&p.SheetNames.length>0&&(i=p.SheetNames),t.bookProps&&(v.Props=p,v.Custprops=y),t.bookSheets&&typeof i<"u"&&(v.SheetNames=i),t.bookSheets?v.SheetNames:t.bookProps))return v;i={};var w={};t.bookDeps&&s.calcchain&&(w=SZ(bs(e,to(s.calcchain)),s.calcchain));var S=0,E={},k,_;{var N=f.Sheets;p.Worksheets=N.length,p.SheetNames=[];for(var F=0;F!=N.length;++F)p.SheetNames[F]=N[F].name}var A=a?"bin":"xml",R=s.workbooks[0].lastIndexOf("/"),T=(s.workbooks[0].slice(0,R+1)+"_rels/"+s.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");io(e,T)||(T="xl/_rels/workbook."+A+".rels");var D=Lm(Mi(e,T,!0),T.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=CZ(bs(e,to(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=iX(bs(e,to(s.people[0])),t)),D&&(D=Vee(D,f.Sheets));var L=bs(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=p.Worksheets;++S){var O="sheet";if(D&&D[S]?(k="xl/"+D[S][1].replace(/[\/]?xl\//,""),io(e,k)||(k=D[S][1]),io(e,k)||(k=T.replace(/_rels\/.*$/,"")+D[S][1]),O=D[S][2]):(k="xl/worksheets/sheet"+(S+1-L)+"."+A,k=k.replace(/sheet0\./,"sheet.")),_=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(p.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var G=!1,K=0;K!=t.sheets.length;++K)typeof t.sheets[K]=="number"&&t.sheets[K]==S&&(G=1),typeof t.sheets[K]=="string"&&t.sheets[K].toLowerCase()==p.SheetNames[S].toLowerCase()&&(G=1);if(!G)continue e}}Kee(e,k,_,p.SheetNames[S],S,E,i,O,t,f,c,d)}return v={Directory:s,Workbook:f,Props:p,Custprops:y,Deps:w,Sheets:i,SheetNames:p.SheetNames,Strings:Om,Styles:d,Themes:c,SSF:Pn(ur)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(te,Z){te=te.replace(/^Root Entry[\/]/,""),v.keys.push(te),v.files[te]=e.FileIndex[Z]}))),t&&t.bookVBA&&(s.vba.length>0?v.vbaraw=bs(e,to(s.vba[0]),!0):s.defaults&&s.defaults.bin===gX&&(v.vbaraw=bs(e,"xl/vbaProject.bin",!0))),v}function Xee(e,t){var r=t||{},n="Workbook",s=ir.find(e,n);try{if(n="/!DataSpaces/Version",s=ir.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(CK(s.content),n="/!DataSpaces/DataSpaceMap",s=ir.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=EK(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=ir.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=NK(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=ir.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);jK(s.content)}catch{}if(n="/EncryptionInfo",s=ir.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=FK(s.content);if(n="/EncryptedPackage",s=ir.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Yee(e,t){return t.bookType=="ods"?zF(e,t):t.bookType=="numbers"?Hee(e,t):t.bookType=="xlsb"?Jee(e,t):Qee(e,t)}function Jee(e,t){$h=1024,e&&!e.SSF&&(e.SSF=Pn(ur)),e&&e.SSF&&(A0(),Xy(e.SSF),t.revssf=Jy(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Bm?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=xF.indexOf(t.bookType)>-1,s=_S();MS(t=t||{});var a=oS(),i="",o=0;if(t.cellXfs=[],qu(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Cr(a,i,Dj(e.Props,t)),s.coreprops.push(i),cn(t.rels,2,i,Ir.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Cr(a,i,Mj(e.Props)),s.extprops.push(i),cn(t.rels,3,i,Ir.EXT_PROPS),e.Custprops!==e.Props&&ts(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Cr(a,i,Lj(e.Custprops)),s.custprops.push(i),cn(t.rels,4,i,Ir.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Cr(a,i,EZ(o-1,i,t,e,f)),s.sheets.push(i),cn(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ir.WS[0])}if(p){var y=p["!comments"],v=!1,w="";y&&y.length>0&&(w="xl/comments"+o+"."+r,Cr(a,w,jZ(y,w)),s.comments.push(w),cn(f,-1,"../comments"+o+"."+r,Ir.CMNT),v=!0),p["!legacy"]&&v&&Cr(a,"xl/drawings/vmlDrawing"+o+".vml",mF(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Cr(a,fp(i),Yh(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Cr(a,i,AZ(t.Strings,i,t)),s.strs.push(i),cn(t.wbrels,-1,"sharedStrings."+r,Ir.SST)),i="xl/workbook."+r,Cr(a,i,TZ(e,i)),s.workbooks.push(i),cn(t.rels,1,i,Ir.WB),i="xl/theme/theme1.xml",Cr(a,i,ES(e.Themes,t)),s.themes.push(i),cn(t.wbrels,-1,"theme/theme1.xml",Ir.THEME),i="xl/styles."+r,Cr(a,i,NZ(e,i,t)),s.styles.push(i),cn(t.wbrels,-1,"styles."+r,Ir.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Cr(a,i,e.vbaraw),s.vba.push(i),cn(t.wbrels,-1,"vbaProject.bin",Ir.VBA)),i="xl/metadata."+r,Cr(a,i,FZ(i)),s.metadata.push(i),cn(t.wbrels,-1,"metadata."+r,Ir.XLMETA),Cr(a,"[Content_Types].xml",jj(s,t)),Cr(a,"_rels/.rels",Yh(t.rels)),Cr(a,"xl/_rels/workbook."+r+".rels",Yh(t.wbrels)),delete t.revssf,delete t.ssf,a}function Qee(e,t){$h=1024,e&&!e.SSF&&(e.SSF=Pn(ur)),e&&e.SSF&&(A0(),Xy(e.SSF),t.revssf=Jy(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Bm?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=xF.indexOf(t.bookType)>-1,s=_S();MS(t=t||{});var a=oS(),i="",o=0;if(t.cellXfs=[],qu(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Cr(a,i,Dj(e.Props,t)),s.coreprops.push(i),cn(t.rels,2,i,Ir.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Cr(a,i,Mj(e.Props)),s.extprops.push(i),cn(t.rels,3,i,Ir.EXT_PROPS),e.Custprops!==e.Props&&ts(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Cr(a,i,Lj(e.Custprops)),s.custprops.push(i),cn(t.rels,4,i,Ir.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var p={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],y=(m||{})["!type"]||"sheet";switch(y){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Cr(a,i,NF(o-1,t,e,p)),s.sheets.push(i),cn(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ir.WS[0])}if(m){var v=m["!comments"],w=!1,S="";if(v&&v.length>0){var E=!1;v.forEach(function(k){k[1].forEach(function(_){_.T==!0&&(E=!0)})}),E&&(S="xl/threadedComments/threadedComment"+o+"."+r,Cr(a,S,aX(v,f,t)),s.threadedcomments.push(S),cn(p,-1,"../threadedComments/threadedComment"+o+"."+r,Ir.TCMNT)),S="xl/comments"+o+"."+r,Cr(a,S,pF(v)),s.comments.push(S),cn(p,-1,"../comments"+o+"."+r,Ir.CMNT),w=!0}m["!legacy"]&&w&&Cr(a,"xl/drawings/vmlDrawing"+o+".vml",mF(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&Cr(a,fp(i),Yh(p))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Cr(a,i,nF(t.Strings,t)),s.strs.push(i),cn(t.wbrels,-1,"sharedStrings."+r,Ir.SST)),i="xl/workbook."+r,Cr(a,i,DF(e)),s.workbooks.push(i),cn(t.rels,1,i,Ir.WB),i="xl/theme/theme1.xml",Cr(a,i,ES(e.Themes,t)),s.themes.push(i),cn(t.wbrels,-1,"theme/theme1.xml",Ir.THEME),i="xl/styles."+r,Cr(a,i,dF(e,t)),s.styles.push(i),cn(t.wbrels,-1,"styles."+r,Ir.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Cr(a,i,e.vbaraw),s.vba.push(i),cn(t.wbrels,-1,"vbaProject.bin",Ir.VBA)),i="xl/metadata."+r,Cr(a,i,gF()),s.metadata.push(i),cn(t.wbrels,-1,"metadata."+r,Ir.XLMETA),f.length>1&&(i="xl/persons/person.xml",Cr(a,i,oX(f)),s.people.push(i),cn(t.wbrels,-1,"persons/person.xml",Ir.PEOPLE)),Cr(a,"[Content_Types].xml",jj(s,t)),Cr(a,"_rels/.rels",Yh(t.rels)),Cr(a,"xl/_rels/workbook."+r+".rels",Yh(t.wbrels)),delete t.revssf,delete t.ssf,a}function LS(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Oi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Zee(e,t){return ir.find(e,"EncryptedPackage")?Xee(e,t):LF(e,t)}function ete(e,t){var r,n=e,s=t||{};return s.type||(s.type=Ar&&Buffer.isBuffer(e)?"buffer":"base64"),r=aj(n,s),qee(r,s)}function GF(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return c2(e.slice(r),t);default:break e}return u0.to_workbook(e,t)}function tte(e,t){var r="",n=LS(e,t);switch(t.type){case"base64":r=Oi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=df(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=pn(r)),t.type="binary",GF(r,t)}function rte(e,t){var r=e;return t.type=="base64"&&(r=Oi(r)),r=ip.utils.decode(1200,r.slice(2),"str"),t.type="binary",GF(r,t)}function nte(e){return e.match(/[^\x00-\x7F]/)?_l(e):e}function Kw(e,t,r,n){return n?(r.type="string",u0.to_workbook(e,r)):u0.to_workbook(t,r)}function f2(e,t){rS();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return f2(new Uint8Array(e),(r=Pn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Qh={},r.dateNF&&(Qh.dateNF=r.dateNF),r.type||(r.type=Ar&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ar?"buffer":"binary",n=Jz(e),typeof Uint8Array<"u"&&!Ar&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=nte(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Pn(r),r.type="array",f2(nS(n),r)}switch((s=LS(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Zee(ir.read(n,r),r);break;case 9:if(s[1]<=8)return LF(n,r);break;case 60:return c2(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return lK(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return tF.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?ete(n,r):Kw(e,n,r,a);case 239:return s[3]===60?c2(n,r):Kw(e,n,r,a);case 255:if(s[1]===254)return rte(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Kd.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Kd.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return l2.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return lF.to_workbook(n,r);break;case 10:case 13:case 32:return tte(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return oK.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?l2.to_workbook(n,r):Kw(e,n,r,a)}function VF(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Wp(t.file,ir.write(e,{type:Ar?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ir.write(e,t)}function ste(e,t){var r=Pn(t||{}),n=Yee(e,r);return ate(n,r)}function ate(e,t){var r={},n=Ar?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?ir.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(qy(s))}return t.password&&typeof encrypt_agile<"u"?VF(encrypt_agile(s,t.password),t):t.type==="file"?Wp(t.file,s):t.type=="string"?pn(s):s}function ite(e,t){var r=t||{},n=nee(e,r);return VF(n,r)}function pl(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return op(_l(n));case"binary":return _l(n);case"string":return e;case"file":return Wp(t.file,n,"utf8");case"buffer":return Ar?Nc(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):pl(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ote(e,t){switch(t.type){case"base64":return op(e);case"binary":return e;case"string":return e;case"file":return Wp(t.file,e,"binary");case"buffer":return Ar?Nc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function S1(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?op(r):t.type=="string"?pn(r):r;case"file":return Wp(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function KF(e,t){rS(),ZQ(e);var r=Pn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=KF(e,r);return r.type="array",qy(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return pl(YZ(e,r),r);case"slk":case"sylk":return pl(eF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return pl(BF(e.Sheets[e.SheetNames[s]],r),r);case"txt":return ote(qF(e.Sheets[e.SheetNames[s]],r),r);case"csv":return pl(OS(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return pl(tF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return S1(l2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return pl(u0.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return pl(lF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return pl(rF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return pl(zF(e,r),r);case"wk1":return S1(Kd.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return S1(Kd.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),S1(OF(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ite(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return ste(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function lte(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function cte(e,t,r){var n={};return n.type="file",n.file=t,lte(n),KF(e,n)}function ute(e,t,r,n,s,a,i,o){var c=hs(r),d=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||e[r])for(var y=t.s.c;y<=t.e.c;++y){var v=i?e[r][y]:e[n[y]+c];if(v===void 0||v.t===void 0){if(d===void 0)continue;a[y]!=null&&(m[a[y]]=d);continue}var w=v.v;switch(v.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[y]!=null){if(w==null)if(v.t=="e"&&w===null)m[a[y]]=null;else if(d!==void 0)m[a[y]]=d;else if(f&&w===null)m[a[y]]=null;else continue;else m[a[y]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?w:Cc(v,w,o);w!=null&&(p=!1)}}return{row:m,isempty:p}}function wy(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof f){case"string":c=qr(f);break;case"number":c=qr(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(s=0);var p=hs(c.s.r),m=[],y=[],v=0,w=0,S=Array.isArray(e),E=c.s.r,k=0,_={};S&&!e[E]&&(e[E]=[]);var N=d.skipHidden&&e["!cols"]||[],F=d.skipHidden&&e["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(N[k]||{}).hidden)switch(m[k]=Wn(k),r=S?e[E][k]:e[m[k]+p],n){case 1:a[k]=k-c.s.c;break;case 2:a[k]=m[k];break;case 3:a[k]=d.header[k-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Cc(r,null,d),w=_[i]||0,!w)_[i]=1;else{do o=i+"_"+w++;while(_[o]);_[i]=w,_[o]=1}a[k]=o}for(E=c.s.r+s;E<=c.e.r;++E)if(!(F[E]||{}).hidden){var A=ute(e,c,E,m,n,a,S,d);(A.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(y[v++]=A.row)}return y.length=v,y}var fN=/"/g;function dte(e,t,r,n,s,a,i,o){for(var c=!0,d=[],f="",p=hs(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var y=o.dense?(e[r]||[])[m]:e[n[m]+p];if(y==null)f="";else if(y.v!=null){c=!1,f=""+(o.rawNumbers&&y.t=="n"?y.v:Cc(y,null,o));for(var v=0,w=0;v!==f.length;++v)if((w=f.charCodeAt(v))===s||w===a||w===34||o.forceQuotes){f='"'+f.replace(fN,'""')+'"';break}f=="ID"&&(f='"ID"')}else y.f!=null&&!y.F?(c=!1,f="="+y.f,f.indexOf(",")>=0&&(f='"'+f.replace(fN,'""')+'"')):f="";d.push(f)}return o.blankrows===!1&&c?null:d.join(i)}function OS(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=qr(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),d=new RegExp((a=="|"?"\\|":a)+"+$"),f="",p=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(m[v]||{}).hidden||(p[v]=Wn(v));for(var w=0,S=s.s.r;S<=s.e.r;++S)(y[S]||{}).hidden||(f=dte(e,s,S,p,i,c,a,n),f!=null&&(n.strip&&(f=f.replace(d,"")),(f||n.blankrows!==!1)&&r.push((w++?o:"")+f)));return delete n.dense,r.join("")}function qF(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=OS(e,t);return r}function fte(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=qr(e["!ref"]),a="",i=[],o,c=[],d=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Wn(o);for(var f=s.s.r;f<=s.e.r;++f)for(a=hs(f),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=d?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function XF(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?zn(n.origin):n.origin;i=c.r,o=c.c}var d,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var p=qr(a["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),i==-1&&(i=p.e.r+1,f.e.r=i+t.length-1+s)}else i==-1&&(i=0,f.e.r=t.length-1+s);var m=n.header||[],y=0;t.forEach(function(w,S){ts(w).forEach(function(E){(y=m.indexOf(E))==-1&&(m[y=m.length]=E);var k=w[E],_="z",N="",F=fr({c:o+y,r:i+S+s});d=vp(a,F),k&&typeof k=="object"&&!(k instanceof Date)?a[F]=k:(typeof k=="number"?_="n":typeof k=="boolean"?_="b":typeof k=="string"?_="s":k instanceof Date?(_="d",n.cellDates||(_="n",k=Os(k)),N=n.dateNF||ur[14]):k===null&&n.nullError&&(_="e",k=0),d?(d.t=_,d.v=k,delete d.w,delete d.R,N&&(d.z=N)):a[F]=d={t:_,v:k},N&&(d.z=N))})}),f.e.c=Math.max(f.e.c,o+m.length-1);var v=hs(i);if(s)for(y=0;y<m.length;++y)a[Wn(y+o)+v]={t:"s",v:m[y]};return a["!ref"]=kr(f),a}function hte(e,t){return XF(null,e,t)}function vp(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=zn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?vp(e,fr(t)):vp(e,fr({r:t,c:r||0}))}function gte(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function BS(){return{SheetNames:[],Sheets:{}}}function US(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(PF(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function mte(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=gte(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function pte(e,t){return e.z=t,e}function YF(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function xte(e,t,r){return YF(e,"#"+t,r)}function yte(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function vte(e,t,r,n){for(var s=typeof t!="string"?t:qr(t),a=typeof t=="string"?t:kr(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=vp(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var D1={encode_col:Wn,encode_row:hs,encode_cell:fr,encode_range:kr,decode_col:mS,decode_row:gS,split_cell:AH,decode_cell:zn,decode_range:Si,format_cell:Cc,sheet_add_aoa:Sj,sheet_add_json:XF,sheet_add_dom:UF,aoa_to_sheet:j0,json_to_sheet:hte,table_to_sheet:$F,table_to_book:Cee,sheet_to_csv:OS,sheet_to_txt:qF,sheet_to_json:wy,sheet_to_html:BF,sheet_to_formulae:fte,sheet_to_row_object_array:wy,sheet_get_cell:vp,book_new:BS,book_append_sheet:US,book_set_sheet_visibility:mte,cell_set_number_format:pte,cell_set_hyperlink:YF,cell_set_internal_link:xte,cell_add_comment:yte,sheet_set_array_formula:vte,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const JF=({onBackToCabinet:e,selectedGrade:t,selectedClass:r,openRetestModal:n})=>{Bi(),Sy();const{user:s,isAuthenticated:a}=Gn(),{showNotification:i}=Oa(),o=C.useCallback(oe=>{let me=null;if(typeof oe?.percentage=="number"&&!Number.isNaN(oe.percentage))return me=Math.round(oe.percentage),console.debug("[TeacherResults] Using provided percentage",{percentage:oe.percentage,rounded:me,result:oe}),me;const re=oe?.retest_best_score??oe?.score,ne=oe?.retest_best_max_score??oe?.max_score,fe=Number(re??0),de=Number(ne??0);return de>0&&(me=Math.round(fe/de*100)),console.debug("[TeacherResults] Computed percentage",{score:oe?.score,max_score:oe?.max_score,retest_best_score:oe?.retest_best_score,retest_best_max_score:oe?.retest_best_max_score,derived:me,result:oe}),me},[]);C.useCallback(oe=>{const me=o(oe);return me===null?"bg-gray-100 text-gray-800":me<50?"bg-red-100 text-red-700":me<70?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"},[o]),C.useCallback(oe=>{const me=o(oe);return me!==null&&me<50},[o]);const[c,d]=C.useState(null),[f,p]=C.useState(!0),[m,y]=C.useState(""),[v,w]=C.useState([]),[S,E]=C.useState(null),[k,_]=C.useState(!1),[N,F]=C.useState([]),[A,R]=C.useState([]),[T,D]=C.useState([1,2]),[L,O]=C.useState(null),[G,K]=C.useState(null),[te,Z]=C.useState(null),[J,I]=C.useState("main"),[W,B]=C.useState(null),[Y,V]=C.useState(null),H=W||t,X=Y||r,[se,ie]=C.useState(null),[ae,Q]=C.useState({}),[le,_e]=C.useState(!1),[ke,Oe]=C.useState(new Set),[ge,ye]=C.useState(!1),[Ke,Xe]=C.useState(!1),lt=C.useRef(null),[Ye,We]=C.useState(null),[Me,je]=C.useState(!1),[De,Ge]=C.useState(null),[ct,at]=C.useState(""),[wt,Ft]=C.useState(""),[Kt,bt]=C.useState(!1),[At,gt]=C.useState(!1),[kt,Gt]=C.useState(new Set),[$t,Be]=C.useState({}),[it,ut]=C.useState(!1),St=C.useRef(new Set),Mt=C.useRef({}),Ot=C.useRef(null);C.useEffect(()=>{console.log("🎯 editingColumns state changed:",Array.from(kt)),St.current=kt},[kt]),C.useEffect(()=>{console.log("🎯 columnScores state changed:",$t),Mt.current=$t},[$t]);const Te=C.useCallback(oe=>{console.log("🔄 Toggling test collapse for:",oe),Oe(me=>{const re=new Set(me);return re.has(oe)?(re.delete(oe),console.log("📤 Expanding test:",oe)):(re.add(oe),console.log("📥 Collapsing test:",oe)),console.log("📋 New collapsed tests:",Array.from(re)),re})},[]),ve=C.useCallback(()=>{if(lt.current){const{scrollLeft:oe,scrollWidth:me,clientWidth:re}=lt.current;ye(oe>0),Xe(oe<me-re-1)}},[]);C.useEffect(()=>{dt()},[]),C.useEffect(()=>{L&&lt.current&&setTimeout(ve,100)},[L,ve]),C.useEffect(()=>{console.log("📋 Current collapsed tests state:",Array.from(ke))},[ke]);const Ne=C.useCallback(async(oe,me,re)=>{console.log("👨‍🏫 Loading class results for:",oe,me,re),_e(!0);try{const ne=`${oe}/${me}`;console.log("👨‍🏫 Formatted class name:",ne);let fe=c;fe||(console.log("👨‍🏫 Teacher data not loaded, loading now..."),fe=await mn.getTeacherData(),d(fe));const de=s?.teacher_id;let Pe=null,Ve=G;if(Ve||(console.log("👨‍🏫 Academic year data not loaded, loading now..."),Ve=await nr()),Ve&&Array.isArray(Ve)&&Ve.length>0){const Ue=parseInt(re);console.log("👨‍🏫 Looking for semester",Ue,"in current academic year");const ze=new Date,pt=Ve.find(Lr=>{const yr=new Date(Lr.start_date),Tr=new Date(Lr.end_date);return ze>=yr&&ze<=Tr}),Bt=pt?pt.academic_year:Ve[0].academic_year;console.log("👨‍🏫 Current academic year:",Bt);const sr=Ve.filter(Lr=>Lr.academic_year===Bt);console.log("👨‍🏫 Current year periods:",sr);const rr=sr.filter(Lr=>parseInt(Lr.semester)===1),Gr=sr.filter(Lr=>parseInt(Lr.semester)===2);if(console.log("👨‍🏫 Semester 1 periods:",rr),console.log("👨‍🏫 Semester 2 periods:",Gr),Ue===1?(Pe=rr[0]?.id,console.log("👨‍🏫 Using semester 1 period:",rr[0])):Ue===2&&(Pe=Gr[0]?.id,console.log("👨‍🏫 Using semester 2 period:",Gr[0])),!Pe)throw new Error(`No ${Ue===1?"Semester 1":"Semester 2"} data available for academic year ${Bt}`)}if(!de||!Pe)throw console.error("👨‍🏫 Missing data:",{teacherId:de,academicPeriodId:Pe,academicYear:G}),new Error("Missing teacher ID or academic period ID");const Ae=await IW.getTeacherStudentResults(de,oe,ne,re,Pe);if(console.log("👨‍🏫 Class results response:",Ae),Ae.success){console.log("👨‍🏫 API Response details:",{results:Ae.results,students:Ae.students,count:Ae.count,student_count:Ae.student_count});const Ue=[],ze=new Set,pt=new Set;Ae.results&&Ae.results.length>0&&Ae.results.forEach(rr=>{rr.test_name&&!ze.has(rr.test_name)&&(ze.add(rr.test_name),Ue.push({test_name:rr.test_name,test_type:rr.test_type,subject:rr.subject})),rr.subject&&pt.add(rr.subject)});const Bt=(Ae.students||[]).map(rr=>{const Gr={};return(Ae.results||[]).filter(yr=>yr.student_id===rr.student_id).forEach(yr=>{yr.test_name&&(Gr[yr.test_name]={id:yr.id,test_type:yr.test_type,test_id:yr.test_id,subject_id:yr.subject_id,score:yr.score,max_score:yr.max_score,retest_offered:yr.retest_offered,caught_cheating:yr.caught_cheating,visibility_change_times:yr.visibility_change_times,answers:yr.answers,name:yr.name,surname:yr.surname,test_name:yr.test_name})}),{...rr,...Gr}}),sr={results:Ae.results||[],students:Bt,class:Bt,unique_tests:Ue,subjects:Array.from(pt),count:Ae.count||0,student_count:Ae.student_count||0};console.log("👨‍🏫 Processed results data:",{uniqueTests:Ue.length,subjects:Array.from(pt),resultsCount:Ae.results?.length||0,studentsWithScores:Bt.length,sampleStudent:Bt[0]}),O(sr),Q(sr),Z(new Date),Ae.students&&Ae.students.length>0?(console.log("👨‍🏫 Student list loaded:",Ae.students.length,"students"),console.log("👨‍🏫 Sample student:",Ae.students[0])):console.log("👨‍🏫 No students found for this class")}else console.log("👨‍🏫 API call failed for this class"),O(null),Q(null)}catch(ne){console.error("👨‍🏫 Error loading class results:",ne),i("Error loading class results","error"),O(null),Q(null)}finally{_e(!1)}},[c,s,G,i]),Fe=C.useCallback(async(oe,me)=>{console.log("👨‍🏫 Determining current semester for:",oe,me);try{if(G&&G.length>0){const re=new Date;let ne=1,fe=null;for(const de of G){const Pe=new Date(de.start_date),Ve=new Date(de.end_date);if(console.log("👨‍🏫 Checking period:",{period:de,semester:de.semester,semesterType:typeof de.semester,startDate:Pe,endDate:Ve,currentDate:re,isInRange:re>=Pe&&re<=Ve}),re>=Pe&&re<=Ve){fe=de,ne=de.semester,console.log("👨‍🏫 Found matching period:",{period:de,semester:de.semester,semesterType:typeof de.semester});break}}if(fe){console.log("👨‍🏫 Current academic period found:",fe),console.log("👨‍🏫 Current semester:",ne);const de=ne&&!isNaN(ne)?ne:1;console.log("👨‍🏫 Using semester:",de),E(de),await Ne(oe,me,de)}else console.log("👨‍🏫 No current academic period found, using default semester 1"),E(1),await Ne(oe,me,1)}else console.log("👨‍🏫 No academic year data, using default semester 1"),E(1),await Ne(oe,me,1)}catch(re){console.error("👨‍🏫 Error determining current semester:",re),E(1),await Ne(oe,me,1)}},[G,Ne]);C.useEffect(()=>{t&&r&&(console.log("👨‍🏫 Props detected:",{grade:t,class:r}),Fe(t,r))},[t,r,Fe]);const dt=C.useCallback(async()=>{console.log("👨‍🏫 Initializing teacher results...");try{if(p(!0),y(""),!a||!s){console.log("👨‍🏫 User not authenticated"),y("User not authenticated");return}if(s.role!==ei.TEACHER){console.error("👨‍🏫 Invalid user role for teacher results:",s.role),y("Access denied. Teacher role required.");return}console.log("👨‍🏫 Loading teacher assignments..."),await Wt(),console.log("👨‍🏫 Loading academic year data..."),await Et(),console.log("👨‍🏫 Teacher results initialization complete!")}catch(oe){console.error("👨‍🏫 Error initializing teacher results:",oe),y("Failed to initialize teacher results")}finally{p(!1)}},[a,s]),Wt=C.useCallback(async()=>{console.log("👨‍🏫 Loading teacher assignments...");try{const oe=`teacher_data_${s?.teacher_id||s?.id||""}`;let me=Mn(oe);me?console.log("👨‍🏫 Cache HIT! Using cached teacher data"):(console.log("👨‍🏫 Cache MISS! Fetching teacher data from API"),me=await mn.getTeacherData(),console.log("👨‍🏫 Teacher data loaded:",me),kn(oe,me,Nn.teacher_subjects)),d(me);const re=[];me&&me.subjects&&me.subjects.forEach(Pe=>{Pe.classes&&Pe.classes.forEach(Ve=>{Ve.grade&&Ve.class&&re.push({grade:Ve.grade,class:Ve.class,subject:Pe.name})})}),R(re),console.log("👨‍🏫 Available classes from teacher data:",re);const ne=`teacher_tests_${s?.teacher_id||s?.id||""}`;let fe=Mn(ne);fe?console.log("👨‍🏫 Cache HIT! Using cached teacher tests"):(console.log("👨‍🏫 Cache MISS! Fetching teacher tests from API"),fe=await Jr.getTeacherTests(),console.log("👨‍🏫 Teacher tests loaded:",fe),kn(ne,fe,Nn.teacher_tests));const de=fe.flatMap(Pe=>Pe.assignments||[]);w(de),console.log("👨‍🏫 Raw assignments data:",de),console.log("👨‍🏫 Teacher assignments loaded:",de.length)}catch(oe){console.error("👨‍🏫 Error loading teacher assignments:",oe),i("Failed to load teacher assignments","error")}},[i]),Et=C.useCallback(async()=>{console.log("👨‍🏫 Loading academic year data...");try{const oe="admin_academic_years_";let me=Mn(oe);me?console.log("👨‍🏫 Cache HIT! Using cached academic year data"):(console.log("👨‍🏫 Cache MISS! Fetching academic year from API"),me=await mn.getAcademicYear(),console.log("👨‍🏫 Academic year response:",me),kn(oe,me,Nn.admin_academic_years)),console.log("👨‍🏫 First academic year record:",me?.[0]||me?.academic_years?.[0]),me&&Array.isArray(me)?(K(me),console.log("👨‍🏫 Academic year data loaded:",me.length),console.log("👨‍🏫 Sample record fields:",Object.keys(me[0]||{}))):me&&me.academic_years?(K(me.academic_years),console.log("👨‍🏫 Academic year data loaded:",me.academic_years.length),console.log("👨‍🏫 Sample record fields:",Object.keys(me.academic_years[0]||{}))):console.warn("👨‍🏫 Failed to load academic year data:",me?.error||"No data received")}catch(oe){console.error("👨‍🏫 Error loading academic year data:",oe)}},[]),nr=C.useCallback(async()=>{console.log("👨‍🏫 Loading academic year data (direct return)...");try{const oe="admin_academic_years_";let me=Mn(oe);return me?console.log("👨‍🏫 Cache HIT! Using cached academic year data"):(console.log("👨‍🏫 Cache MISS! Fetching academic year from API"),me=await mn.getAcademicYear(),console.log("👨‍🏫 Academic year response:",me),kn(oe,me,Nn.admin_academic_years)),me&&Array.isArray(me)?(console.log("👨‍🏫 Returning academic year data:",me.length),me):me&&me.academic_years?(console.log("👨‍🏫 Returning academic year data:",me.academic_years.length),me.academic_years):(console.warn("👨‍🏫 Failed to load academic year data:",me?.error||"No data received"),null)}catch(oe){return console.error("👨‍🏫 Error loading academic year data:",oe),null}},[]),Qt=C.useCallback(async(oe,me)=>{console.log("👨‍🏫 Showing classes for grade:",oe,"class:",me),B(oe),V(me),E(null),O(null),oe&&me&&await Fe(oe,me)},[Fe]);C.useCallback((oe,me)=>{console.log("👨‍🏫 Showing semesters for class:",oe,me),E(null),O(null),Fe(oe,me)},[]),C.useCallback((oe,me)=>{console.log("👨‍🏫 Class clicked:",oe,me),_(!0),Fe(oe,me)},[]);const Zt=C.useCallback(async oe=>{!H||!X||(console.log("👨‍🏫 Loading results for semester:",oe),E(oe),await Ne(H,X,oe))},[H,X,Ne]);C.useCallback(()=>{let oe=1;if(G&&G.length>0){const me=new Date;for(const re of G){const ne=new Date(re.start_date),fe=new Date(re.end_date);if(me>=ne&&me<=fe){oe=re.semester;break}}}return l.jsx("div",{className:"flex space-x-4 mb-6",children:[1,2].map(me=>l.jsxs(Qe.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${S===me?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>Zt(me),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",me,me===oe&&l.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},me))})},[S,Zt,G]),C.useCallback(oe=>oe.reduce((me,re)=>(me[re.student_id]||(me[re.student_id]=[]),me[re.student_id].push(re),me),{}),[]),C.useCallback(oe=>{if(oe.length===0)return 0;const me=oe.reduce((re,ne)=>re+(ne.percentage||0),0);return Math.round(me/oe.length)},[]),C.useCallback(oe=>{oe.score<oe.passing_score&&window.confirm("Give another try?")&&Nr(oe.student_id,oe.test_id)},[]);const Nr=C.useCallback(async(oe,me)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:oe,testId:me})})).ok&&(X&&Zt(S),i("Test made accessible to student","success"))}catch(re){console.error("Error resetting test attempt:",re),i("Failed to reset test attempt","error")}},[X,S,Zt,i]),Mr=C.useCallback((oe,me)=>{if(oe===null||me===null)return"";const re=Math.round(oe/me*100);return re>=80?"text-green-600 bg-green-50":re>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),cr=C.useCallback(oe=>{We(oe),je(!0)},[]);C.useCallback((oe,me,re)=>{Ge({resultId:oe,score:me,maxScore:re}),at(me?.toString()||""),Ft(re?.toString()||""),gt(!0)},[]),C.useCallback(oe=>{at(oe)},[]),C.useCallback(oe=>{Ft(oe)},[]),C.useCallback(async()=>{if(De){bt(!0);try{const oe={resultId:De.resultId,score:parseInt(ct)||0,maxScore:parseInt(wt)||1};(await fetch(QE.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)})).ok?(i("Score updated successfully","success"),X&&Zt(S),Ge(null),at(""),Ft(""),gt(!1)):i("Failed to update score","error")}catch(oe){console.error("Error updating score:",oe),i("Failed to update score","error")}finally{bt(!1)}}},[De,ct,wt,X,S,Zt,i]),C.useCallback(()=>{Ge(null),at(""),Ft(""),gt(!1)},[]);const Fr=(oe,me)=>{if(console.log("🎯 Starting column editing for drawing test:",oe),console.log("🎯 Current editingColumns before update:",Array.from(kt)),console.log("🎯 Results data passed to function:",me),Gt(re=>{const ne=new Set(re).add(oe);return console.log("🎯 Updated editingColumns:",Array.from(ne)),ne}),console.log("🎯 Initializing column scores for test:",oe),console.log("🎯 Results data:",me),console.log("🎯 Results.class:",me?me.class:"null"),me&&me.class){const re={};console.log("🎯 Processing",me.class.length,"students"),me.class.forEach((ne,fe)=>{console.log(`🎯 Student ${fe}:`,ne.student_id,"Keys:",Object.keys(ne));const de=ne[oe];console.log(`🎯 Student ${ne.student_id} test result for ${oe}:`,de),console.log("🎯 Test result keys:",de?Object.keys(de):"null"),console.log("🎯 Test result id:",de?de.id:"null"),de&&de.test_type==="drawing"&&(re[ne.student_id]={score:(de.score||0).toString(),maxScore:(de.max_score||100).toString(),resultId:de.id})}),console.log("🎯 Initial scores for column:",re),Be(ne=>({...ne,[oe]:re}))}else console.log("🎯 No results or class data available")},Pr=C.useCallback(oe=>{Gt(me=>{const re=new Set(me);return re.delete(oe),re}),Be(me=>{const re={...me};return delete re[oe],re})},[]),Cn=C.useCallback((oe,me,re,ne)=>{const fe=ne.toString();Mt.current[oe]||(Mt.current[oe]={}),Mt.current[oe][me]||(Mt.current[oe][me]={}),Mt.current[oe][me][re]=fe;const de=parseInt(ne)||0;Be(Pe=>({...Pe,[oe]:{...Pe[oe],[me]:{...Pe[oe]?.[me],[re]:de}}}))},[]),ce=C.useCallback(async oe=>{if(Mt.current[oe]){ut(!0);try{const me=Object.entries(Mt.current[oe]).map(([de,Pe])=>({resultId:Pe.resultId,score:parseInt(Pe.score)||0,maxScore:parseInt(Pe.maxScore)||100}));console.log("🎯 Saving column scores for",oe,":",me);const re=me.map(de=>(console.log("🎯 Sending update:",de),fetch(QE.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(de)})));(await Promise.all(re)).every(de=>de.ok)?(i(`Scores updated successfully for ${oe}`,"success"),X&&Zt(S),Pr(oe)):i("Failed to update some scores","error")}catch(me){console.error("Error updating column scores:",me),i("Failed to update scores","error")}finally{ut(!1)}}},[$t,X,S,Zt,i,Pr]),be=C.useCallback((oe,me,re)=>!me||me.length===0?l.jsx(Qe.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsxs(Qe.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[ge&&l.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-500 text-white rounded-full p-2 shadow-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),Ke&&l.jsx("div",{className:"absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-500 text-white rounded-full p-2 shadow-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),l.jsxs(Qe.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[l.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:ne=>{lt.current&&(lt.current.scrollLeft=ne.target.scrollLeft)},children:l.jsx("div",{className:"min-w-full h-1",children:l.jsx("div",{className:"h-1",style:{width:`${(re.length+5)*120}px`}})})}),l.jsx("div",{ref:lt,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:ne=>{ve(ne);const fe=ne.target.previousElementSibling;fe&&(fe.scrollLeft=ne.target.scrollLeft)},children:l.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[l.jsx("thead",{children:l.jsxs(Qe.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[120px]",children:"Name"}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[120px]",children:"Surname"}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),re.map((ne,fe)=>{const de=ke.has(ne.test_name),Pe=ne.test_type==="drawing",Ve=St.current.has(ne.test_name);return console.log(`🎯 Rendering test ${ne.test_name}:`,{isDrawingTest:Pe,isEditingColumn:Ve,editingColumns:Array.from(St.current),test_type:ne.test_type}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${de?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:Ae=>{Ae.preventDefault(),Ae.stopPropagation(),console.log("🖱️ Clicked on test header:",ne.test_name),Te(ne.test_name)},children:de?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex flex-col space-y-2",children:[Pe&&l.jsx("div",{className:"flex justify-center",children:Ve?l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:Ae=>{Ae.preventDefault(),Ae.stopPropagation(),ce(ne.test_name)},disabled:it,className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",children:it?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):"Save"}),l.jsx("button",{onClick:Ae=>{Ae.preventDefault(),Ae.stopPropagation(),Pr(ne.test_name)},disabled:it,className:"px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):l.jsx("button",{onClick:Ae=>{Ae.preventDefault(),Ae.stopPropagation(),console.log("🎯 Edit Column button clicked for drawing test:",ne.test_name),console.log("🎯 Results state at button click:",L),console.log("🎯 Current results ref:",Ot.current),Fr(ne.test_name,Ot.current)},className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit Column"})}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:ne.test_name,children:ne.test_name.length>8?ne.test_name.substring(0,8)+"...":ne.test_name}),l.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})},fe)})]})}),l.jsx("tbody",{children:l.jsx(yi,{children:me.map((ne,fe)=>l.jsxs(Qe.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${fe%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+fe*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[l.jsx(Qe.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:ne.student_id}),l.jsx(Qe.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:ne.name}),l.jsx(Qe.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:ne.surname}),l.jsx(Qe.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:ne.number??fe+1}),l.jsx(Qe.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:ne.nickname||"-"}),re.map((de,Pe)=>{const Ve=ke.has(de.test_name),Ae=ne[de.test_name];return Ve?(console.log("📥 Rendering collapsed column for test:",de.test_name),l.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Ue=>{Ue.preventDefault(),Ue.stopPropagation(),console.log("🖱️ Clicked on collapsed arrow for:",de.test_name),Te(de.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Pe)):l.jsx(Qe.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},onClick:Ue=>{if(console.debug("[TeacherResults] Main table TD clicked",{testResult:Ae,student:ne.student_id}),Ae?.retest_offered){i("Retest is already offered","info");return}const ze=o(Ae);ze!==null&&ze<50&&(console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:ne.student_id,test:de}),n({failedStudentIds:[ne.student_id],test_type:de.test_type,original_test_id:Ae?.test_id||de.test_id,subject_id:Ae?.subject_id||de.subject_id}))},children:Ae&&Ae.test_type==="drawing"?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("button",{onClick:()=>cr(Ae),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const Ue=St.current.has(de.test_name);return console.log(`🎯 Score cell for ${de.test_name}:`,{isEditing:Ue,editingColumns:Array.from(St.current),test_name:de.test_name}),Ue})()?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Ae.max_score||100,value:Mt.current[de.test_name]?.[ne.student_id]?.score||Ae.score||"",onChange:Ue=>Cn(de.test_name,ne.student_id,"score",Ue.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:Mt.current[de.test_name]?.[ne.student_id]?.maxScore||Ae.max_score||100,onChange:Ue=>Cn(de.test_name,ne.student_id,"maxScore",Ue.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):l.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors",onDoubleClick:()=>{console.log("🎯 Double-clicked on drawing test score:",de.test_name),console.log("🎯 Results state at double-click:",L),console.log("🎯 Current results ref:",Ot.current),Fr(de.test_name,Ot.current)},title:"Double-click to edit column",children:[Ae.score||0,"/",Ae.max_score||100]}),Ae.caught_cheating&&Ae.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Ae.visibility_change_times,")"]})]}):Ae&&Ae.score!==null&&Ae.score!==void 0?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[(()=>{const Ue=o(Ae),ze=Ue!==null&&Ue<50,pt=Ue!==null&&Ue>=50&&Ue<70,Bt=Ue!==null&&Ue>=70;console.debug("[TeacherResults] Main table pill",{studentId:ne.student_id,pct:Ue,isRed:ze,isYellow:pt,isGreen:Bt,testResult:Ae});const sr=Ue===null?"text-gray-600":ze?"text-red-600 font-semibold":pt?"text-yellow-600":"text-green-600",rr=Ae?.retest_offered===!0;return l.jsxs(Qe.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${sr} ${ze?"cursor-pointer hover:opacity-90":""} ${rr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:ze?{color:"#b91c1c"}:void 0,whileHover:{scale:ze?1.1:1.05},transition:{duration:.2},onClick:Gr=>{if(Gr.preventDefault(),Gr.stopPropagation(),Ae?.retest_offered){i("Retest is already offered","info");return}ze&&(console.debug("[TeacherResults] Main table pill clicked -> opening retest modal",{studentId:ne.student_id,test:de}),n({failedStudentIds:[ne.student_id],test_type:de.test_type,original_test_id:Ae?.test_id||de.test_id,subject_id:Ae?.subject_id||de.subject_id}))},title:rr?"Retest offered":ze?"Offer retest":"",children:[(()=>{const Gr=Ae.retest_best_score??Ae.score,Lr=Ae.retest_best_max_score??Ae.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:ze?"text-red-700":"",children:Gr}),"/",l.jsx("span",{children:Lr})]})})(),Ae.caught_cheating&&l.jsx("span",{className:"ml-1",children:"⚠️"})]})})(),Ae.caught_cheating&&Ae.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Ae.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},Pe)})]},fe))})})]})})]})]}),[Mr,ke,Te]),pe=C.useCallback((oe,me,re)=>!me||me.length===0?l.jsx(Qe.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsx(Qe.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:l.jsx(Qe.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:l.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:l.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[l.jsx("thead",{children:l.jsxs(Qe.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",children:"Name"}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",children:"Surname"}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),re.map((ne,fe)=>{const de=ne.test_type==="drawing",Pe=St.current.has(ne.test_name);return l.jsx(Qe.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+fe*.05},children:l.jsxs("div",{className:"flex flex-col space-y-1",children:[de&&l.jsx("div",{className:"flex justify-center",children:Pe?l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:Ve=>{Ve.preventDefault(),Ve.stopPropagation(),ce(ne.test_name)},disabled:it,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:it?"Saving...":"Save"}),l.jsx("button",{onClick:Ve=>{Ve.preventDefault(),Ve.stopPropagation(),Pr(ne.test_name)},disabled:it,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):l.jsx("button",{onClick:Ve=>{Ve.preventDefault(),Ve.stopPropagation(),Fr(ne.test_name)},className:"px-1 py-0.5 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit"})}),l.jsx("span",{className:"text-xs",children:ne.test_name.length>10?ne.test_name.substring(0,10)+"...":ne.test_name})]})},fe)})]})}),l.jsx("tbody",{children:l.jsx(yi,{children:me.map((ne,fe)=>l.jsxs(Qe.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${fe%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+fe*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[l.jsx(Qe.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:ne.student_id}),l.jsx(Qe.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:ne.name}),l.jsx(Qe.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:ne.surname}),l.jsx(Qe.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:ne.number??fe+1}),l.jsx(Qe.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:ne.nickname||"-"}),re.map((de,Pe)=>{const Ve=ke.has(de.test_name),Ae=ne[de.test_name];return Ve?l.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Ue=>{Ue.preventDefault(),Ue.stopPropagation(),Te(de.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Pe):l.jsx(Qe.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},onClick:Ue=>{console.debug("[TeacherResults] TD clicked",{testResult:Ae,student:ne.student_id});const ze=o(Ae);if(ze!==null&&ze<50){if(Ae?.retest_offered){i("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:ne.student_id}),n({failedStudentIds:[ne.student_id]})}},children:Ae&&Ae.score!==null&&Ae.score!==void 0?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[Ae.test_type==="drawing"?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>cr(Ae),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),St.current.has(de.test_name)?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Ae.max_score||100,value:Mt.current[de.test_name]?.[ne.student_id]?.score||Ae.score||"",onChange:Ue=>Cn(de.test_name,ne.student_id,"score",Ue.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:Mt.current[de.test_name]?.[ne.student_id]?.maxScore||Ae.max_score||100,onChange:Ue=>Cn(de.test_name,ne.student_id,"maxScore",Ue.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):l.jsxs(Qe.div,{className:`px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors ${Ae.caught_cheating?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800"}`,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>Fr(de.test_name),title:"Double-click to edit column",children:[Ae.score,"/",Ae.max_score,Ae.caught_cheating&&l.jsx("span",{className:"ml-1",children:"⚠️"})]})]}):(()=>{const Ue=o(Ae),ze=Ue!==null&&Ue<50,pt=Ue!==null&&Ue>=50&&Ue<70,Bt=Ue!==null&&Ue>=70;console.debug("[TeacherResults] Render pill",{studentId:ne.student_id,pct:Ue,isRed:ze,isYellow:pt,isGreen:Bt,score:Ae.score,max:Ae.max_score,percentageField:Ae.percentage});const rr=`px-1 py-0.5 rounded text-xs font-medium ${Ue===null?"text-gray-600":ze?"text-red-600 font-semibold":pt?"text-yellow-600":"text-green-600"} ${ze?"cursor-pointer hover:opacity-90 pointer-events-auto":""}`;return console.debug("[TeacherResults] Pill classes",{classNameStr:rr,pct:Ue,isRed:ze,isYellow:pt,isGreen:Bt}),l.jsxs(Qe.div,{className:rr,style:ze?{color:"#b91c1c"}:void 0,whileHover:{scale:ze?1.05:1},transition:{duration:.15},onClick:ze?Gr=>{Gr.preventDefault(),Gr.stopPropagation();const Lr=window.getComputedStyle(Gr.currentTarget).color;console.debug("[TeacherResults] Red pill clicked -> opening retest modal",{studentId:ne.student_id,className:rr,computedColor:Lr}),n({failedStudentIds:[ne.student_id]})}:void 0,title:ze?"Offer retest":"",children:[l.jsx("span",{className:ze?"text-red-700":"",children:Ae.score}),"/",l.jsx("span",{children:Ae.max_score}),Ae.caught_cheating&&l.jsx("span",{className:"ml-1",children:"⚠️"})]})})(),Ae.caught_cheating&&Ae.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Ae.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},Pe)})]},fe))})})]})})})}),[Mr,ke,Te]),we=C.useCallback(()=>{if(!L)return null;console.log("🔍 renderResults - results:",L),console.log("🔍 renderResults - results.class:",L.class),console.log("🔍 renderResults - results.unique_tests:",L.unique_tests);const oe=L.class&&Array.isArray(L.class)&&L.class.length>0;if(console.log("🔍 renderResults - hasStudentData:",oe),!oe)return console.log("🔍 renderResults - No student data, showing no students message"),l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const me=L.unique_tests||[];return console.log("🔍 renderResults - uniqueTests:",me),Ot.current=L,l.jsxs("div",{className:"space-y-6",children:[l.jsxs(Qe.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[l.jsxs(Qe.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",H,", Class ",H,"/",X,", Semester ",S]}),l.jsxs(Qe.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",L.subjects?.length||0," subject(s)"]}),l.jsxs(Qe.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[l.jsx("button",{onClick:()=>{const re=L.unique_tests?.map(ne=>ne.test_name)||[];Oe(new Set(re))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),l.jsx("button",{onClick:()=>Oe(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),l.jsxs(Qe.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[l.jsx(Qe.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),l.jsx("div",{className:"hidden md:block",children:be("All Subjects",L.class,me)}),l.jsx("div",{className:"md:hidden",children:pe("All Subjects",L.class,me)})]})]})},[L,be,H,X,S]),Ce=C.useCallback(()=>{if(!L||!L.class||!L.unique_tests)return;const oe=["Student ID","Name","Surname","No.","Nickname",...L.unique_tests.map(Pe=>Pe.test_name)],me=L.class.map((Pe,Ve)=>{const Ae=[];return Ae.push(Pe.student_id),Ae.push(Pe.name),Ae.push(Pe.surname),Ae.push(Pe.number??Ve+1),Ae.push(Pe.nickname||"-"),L.unique_tests.forEach(Ue=>{const ze=Pe[Ue.test_name];ze&&ze.score!==null&&ze.score!==void 0?Ae.push(`${ze.score}/${ze.max_score}`):Ae.push("-")}),Ae}),re=D1.aoa_to_sheet([oe,...me]),ne=D1.book_new(),fe=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...L.unique_tests.map(()=>({wch:15}))];re["!cols"]=fe,D1.book_append_sheet(ne,re,"Class Results");const de=`class-results-${H}-${X}-semester-${S}.xlsx`;cte(ne,de),i("Excel file exported successfully!","success")},[L,H,X,S,i]);return f?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Sr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):m?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:m}),l.jsx(tt,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex justify-between items-center py-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",te?te.toLocaleString():"Never"]})]})})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),A.length>0?l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:A.map((oe,me)=>l.jsxs(tt,{variant:H===oe.grade&&X===oe.class?"primary":"outline",onClick:()=>Qt(oe.grade,oe.class),className:"w-full",children:[oe.grade,"/",oe.class]},`${oe.grade}-${oe.class}-${me}`))}):l.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),X&&l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Select Semester for ",H,"/",X]}),l.jsx("div",{className:"flex space-x-4",children:[1,2].map(oe=>{let me=1;if(G&&G.length>0){const re=new Date;for(const ne of G){const fe=new Date(ne.start_date),de=new Date(ne.end_date);if(re>=fe&&re<=de){me=ne.semester;break}}}return l.jsxs(Qe.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${S===oe?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>Zt(oe),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",oe,oe===me&&l.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},oe)})})]}),X&&L&&l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[H," ",X," - Test Results (Semester ",S,")"]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:Ce,children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),l.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),we()]}),X&&!L&&l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No test results available for this class and semester."})})})]})}),Ye&&l.jsx(U8,{drawing:Ye,isOpen:Me,onClose:()=>je(!1),isTeacherView:!0})]})},hN=({onBackToLogin:e})=>{const t=Bi(),{user:r,isAuthenticated:n,logout:s,getCurrentTeacherUsername:a}=Gn(),{teacherData:i,loadTeacherData:o}=Ky(),{activeTests:c,loadActiveTests:d}=$p(),{showNotification:f,notifications:p}=Oa(),[m,y]=C.useState(!0),[v,w]=C.useState(""),[S,E]=C.useState("main"),[k,_]=C.useState([]),[N,F]=C.useState([]),[A,R]=C.useState(null),[T,D]=C.useState(null),[L,O]=C.useState(null),[G,K]=C.useState(!1),[te,Z]=C.useState(!1),[J,I]=C.useState(null),[W,B]=C.useState(!1),[Y,V]=C.useState(null),[H,X]=C.useState(!1),[se,ie]=C.useState(null),[ae,Q]=C.useState(null),[le,_e]=C.useState([]),[ke,Oe]=C.useState(!1),[ge,ye]=C.useState(null),[Ke,Xe]=C.useState({}),[lt,Ye]=C.useState(!1),[We,Me]=C.useState(!1),[je,De]=C.useState(0),[Ge,ct]=C.useState(!1),[at,wt]=C.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[Ft,Kt]=C.useState([]),[bt,At]=C.useState([]),[gt,kt]=C.useState(!1),[Gt,$t]=C.useState(null),[Be,it]=C.useState([]),[ut,St]=C.useState(!1),[Mt,Ot]=C.useState("subject");C.useEffect(()=>{nr()},[]),C.useEffect(()=>{const Se=Ze=>{lt&&!Ze.target.closest(".relative")&&Ye(!1),We&&!Ze.target.closest(".relative")&&Me(!1)};return document.addEventListener("mousedown",Se),()=>{document.removeEventListener("mousedown",Se)}},[lt,We]);const Te=C.useCallback(()=>{console.log("🔧 showChangePasswordTab called"),ct(!0),Ye(!1),Me(!1)},[]),ve=C.useCallback(()=>{console.log("🔧 hideChangePasswordTab called"),ct(!1),wt({currentPassword:"",newPassword:"",confirmPassword:""})},[]),Ne=C.useCallback(async()=>{if(!r)return;const{currentPassword:Se,newPassword:Ze,confirmPassword:st}=at;if(!Se||!Ze||!st){f("Please fill in all fields","error");return}if(Ze!==st){f("New passwords do not match","error");return}if(Ze.length<6){f("New password must be at least 6 characters long","error");return}const zt=/[a-zA-Z]/.test(Ze),Er=/[0-9]/.test(Ze);if(!zt||!Er){f("New password must contain both letters and numbers","error");return}try{const vr=await mn.changePassword({username:r.username,currentPassword:Se,newPassword:Ze});vr.success?(f("Password changed successfully!","success"),ve()):f(vr.message||"Failed to change password","error")}catch(vr){console.error("Password change error:",vr),f("Failed to change password. Please try again.","error")}},[r,at,f]),Fe=C.useCallback(Se=>{const{name:Ze,value:st}=Se.target;wt(zt=>({...zt,[Ze]:st}))},[]),dt=C.useCallback(async()=>{console.log("👨‍🏫 Loading teacher data...");try{const Se=await mn.getTeacherData();return console.log("👨‍🏫 Teacher data loaded:",Se),Q(new Date),Se}catch(Se){throw console.error("👨‍🏫 Error loading teacher data:",Se),Se}},[]),Wt=C.useCallback(async()=>{console.log("👨‍🏫 Loading teacher subjects...");try{const Se=`teacher_subjects_${r?.teacher_id||r?.id||""}`,Ze=Mn(Se);if(Ze)return console.log("👨‍🏫 Using cached teacher subjects"),_(Ze),Ze;const st=await mn.getTeacherData();console.log("👨‍🏫 Raw teacher data:",st);const zt=mn.getTeacherSubjects(st.subjects);return console.log("👨‍🏫 Teacher subjects loaded:",zt),_(zt),kn(Se,zt,Nn.teacher_subjects),console.log("📊 Available classes for performance chart:",zt[0]?.classes||[]),console.log("📊 Performance chart will load when user clicks on a class"),zt}catch(Se){throw console.error("👨‍🏫 Error loading teacher subjects:",Se),Se}},[r?.teacher_id,r?.id]),Et=C.useCallback(async()=>{console.log("👨‍🏫 Loading teacher active tests...");try{const Se=`teacher_tests_${r?.teacher_id||r?.id||""}`,Ze=Mn(Se);if(Ze)return console.log("👨‍🏫 Using cached teacher tests"),F(Ze),Ze;const st=await Jr.getTeacherTests();return console.log("👨‍🏫 Teacher tests loaded:",st),F(st),kn(Se,st,Nn.teacher_tests),st}catch(Se){throw console.error("👨‍🏫 Error loading teacher tests:",Se),Se}},[r?.teacher_id,r?.id]),nr=C.useCallback(async()=>{console.log("👨‍🏫 Initializing Teacher Cabinet...");try{if(y(!0),w(""),!n||!r){console.log("👨‍🏫 User not authenticated"),w("User not authenticated");return}if(r.role!==ei.TEACHER){console.error("👨‍🏫 Invalid user role for teacher cabinet:",r.role),w("Access denied. Teacher role required.");return}console.log("👨‍🏫 Loading teacher data..."),await dt(),console.log("👨‍🏫 Loading teacher subjects..."),await Wt(),console.log("👨‍🏫 Loading active tests..."),await Et(),console.log("👨‍🏫 Teacher Cabinet initialization complete!")}catch(Se){console.error("👨‍🏫 Error initializing teacher cabinet:",Se),w("Failed to initialize teacher cabinet")}finally{y(!1)}},[n,r,dt,Wt,Et]),Qt=C.useCallback(()=>{console.log("👨‍🏫 Showing subject selection prompt..."),K(!0),Zt(),Ot("subject")},[]),Zt=C.useCallback(async()=>{console.log("👨‍🏫 Loading available subjects..."),kt(!0);try{const Se=await mn.getSubjectsForSelection();Kt(Se),console.log("👨‍🏫 Available subjects loaded:",Se)}catch(Se){console.error("👨‍🏫 Error loading available subjects:",Se),f("Failed to load subjects","error")}finally{kt(!1)}},[]),Nr=C.useCallback(Se=>{if(!Se){$t(null);return}const Ze=Ft.find(st=>st.subject_id==Se);Ze&&($t(Ze),it([]),Ot("classes"))},[Ft]),Mr=C.useCallback((Se,Ze)=>{it(st=>st.some(zt=>zt.grade===Se&&zt.class===Ze)?st.filter(zt=>!(zt.grade===Se&&zt.class===Ze)):[...st,{grade:Se,class:Ze}])},[]),cr=C.useCallback(()=>{if(!Gt||Be.length===0){f("Please select at least one class","warning");return}const Se={subject_id:parseInt(Gt.subject_id),subject_name:Gt.subject,classes:Be};At(Ze=>[...Ze,Se]),$t(null),it([]),Ot("subject"),f(`Added ${Gt.subject} with ${Be.length} classes`,"success")},[Gt,Be]),Fr=C.useCallback(Se=>{At(Ze=>Ze.filter((st,zt)=>zt!==Se))},[]),Pr=C.useCallback(async(Se,Ze,st)=>{console.log("👨‍🏫 Deleting teacher subject:",{subjectId:Se,grade:Ze,classNumber:st});try{const zt={subjectId:Se,grade:Ze,class:st};console.log("👨‍🏫 Sending delete request with data:",zt);const Er=await mn.deleteTeacherSubject(zt);if(Er.success)f("Subject assignment deleted successfully!","success"),await Wt();else throw new Error(Er.error||"Failed to delete subject assignment")}catch(zt){console.error("👨‍🏫 Error deleting subject assignment:",zt),f("Error deleting subject assignment. Please try again.","error")}},[Wt,f]),Cn=C.useCallback((Se,Ze,st,zt)=>{ie({subjectId:Se,subjectName:Ze,grade:st,classNumber:zt}),X(!0)},[]),ce=C.useCallback(async()=>{se&&(await Pr(se.subjectId,se.grade,se.classNumber),X(!1),ie(null))},[se,Pr]),be=C.useCallback(()=>{X(!1),ie(null)},[]),pe=C.useCallback(async()=>{if(bt.length===0){f("Please select at least one subject","warning");return}try{const Se=await mn.saveTeacherSubjects(bt);if(Se.success)f("Subjects saved successfully!","success"),K(!1),At([]),Ot("subject"),await Wt();else throw new Error(Se.error||"Failed to save subjects")}catch(Se){console.error("👨‍🏫 Error saving teacher subjects:",Se),f("Failed to save subjects","error")}},[bt,Wt]);C.useCallback(async Se=>{console.log("👨‍🏫 Saving teacher subjects:",Se);try{const Ze=await mn.saveTeacherSubjects(Se);if(Ze.success)f("Subjects saved successfully!","success"),await Wt(),K(!1);else throw new Error(Ze.error||"Failed to save subjects")}catch(Ze){console.error("👨‍🏫 Error saving teacher subjects:",Ze),f("Failed to save subjects","error")}},[Wt]);const we=C.useCallback(()=>{console.log("👨‍🏫 Showing active tests..."),E("tests")},[]),Ce=C.useCallback(Se=>{console.log("👨‍🏫 Showing test details:",Se),I(Se),Z(!0)},[]);C.useCallback(async(Se,Ze,st)=>{console.log("👨‍🏫 Removing class assignment:",Se,Ze,st);try{const zt=await Jr.removeClassAssignment(Se,Ze,st);if(zt.success)f("Assignment removed successfully!","success"),await Et();else throw new Error(zt.error||"Failed to remove assignment")}catch(zt){console.error("👨‍🏫 Error removing class assignment:",zt),f("Failed to remove assignment","error")}},[Et]);const oe=C.useCallback(async(Se,Ze)=>{console.log("👨‍🏫 Marking test as completed:",Se,Ze);try{const st=await Jr.markTestCompleted(Se,Ze);if(st.success){f("Test marked as completed!","success");const zt=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(zt),console.log("👨‍🏫 Cleared teacher tests cache"),await Et()}else throw new Error(st.error||"Failed to mark test as completed")}catch(st){console.error("👨‍🏫 Error marking test as completed:",st),f("Failed to mark test as completed","error")}},[Et,f,r?.teacher_id,r?.id]),me=C.useCallback(async()=>{console.log("👨‍🏫 Refreshing active tests data...");try{await Et(),f("Tests refreshed successfully!","success")}catch(Se){console.error("👨‍🏫 Error refreshing tests:",Se),f("Failed to refresh tests","error")}},[Et]),[re,ne]=C.useState(!1),fe=C.useCallback(async Se=>{console.log("📊 Loading performance data for class:",Se),console.log("📊 Current selectedClassForChart:",ge);try{ne(!0);const[Ze,st]=Se.split("/"),zt=Ze.startsWith("M")?Ze:`M${Ze}`,Er=`class_summary_${r.teacher_id}_${zt}_${st}_${xi.CURRENT_ACADEMIC_YEAR}_${xi.CURRENT_SEMESTER}`,vr=Mn(Er);if((vr?Date.now()-vr.timestamp:1/0)>36e5)try{await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/refresh-class-summary-semester")}catch(Dn){console.warn("Materialized view refresh failed (continuing):",Dn.message)}const Fl=await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary-semester?teacher_id=${r.teacher_id}&grade=${zt}&class=${st}&semester=${xi.CURRENT_SEMESTER}&academic_year=${xi.CURRENT_ACADEMIC_YEAR}`);console.log("📊 API response status:",Fl.status);const Bs=await Fl.json();if(console.log("📊 Performance API response:",Bs),console.log("📊 API success:",Bs.success),console.log("📊 API summary:",Bs.summary),Bs.success&&Bs.summary){console.log("📊 Processing semester performance data:",Bs.summary);const Dn=Bs.summary;console.log("📊 Semester summary:",{total_students:Dn.total_students,total_tests:Dn.total_tests,completed_tests:Dn.completed_tests,average_class_score:Dn.average_class_score,pass_rate:Dn.pass_rate,cheating_incidents:Dn.cheating_incidents});const Us={summary:Dn,semester:xi.CURRENT_SEMESTER,academicYear:xi.CURRENT_ACADEMIC_YEAR,overallAverage:Dn.average_class_score||0,totalTests:Dn.total_tests||0,completedTests:Dn.completed_tests||0,passRate:Dn.pass_rate||0,cheatingIncidents:Dn.cheating_incidents||0,lastTestDate:Dn.last_test_date,semesterProgress:de(Dn)};console.log("📊 Semester performance data:",Us),Xe(Pl=>({...Pl,[Se]:Us}))}else console.log("📊 No performance data available for class:",Se),Xe(Dn=>({...Dn,[Se]:{tests:[],overallAverage:0}}))}catch(Ze){console.error("📊 Error loading performance data:",Ze),console.error("📊 Error details:",Ze.message),Xe(st=>({...st,[Se]:{tests:[],overallAverage:0}}))}finally{ne(!1)}},[r]),de=C.useCallback(Se=>{if(!Se.last_test_date)return 0;const Ze=new Date("2025-05-01"),st=new Date("2025-09-30"),zt=new Date,Er=st-Ze,vr=Math.min(zt-Ze,Er);return Math.round(vr/Er*100)},[]);C.useCallback((Se,Ze)=>{console.log("👨‍🏫 Showing class results:",Se,Ze),console.log("👨‍🏫 Class click - grade:",Se,"className:",Ze),D(Se),O(Ze),E("results");const st=`${Se}/${Ze}`;console.log("📊 Loading performance data for clicked class:",st),ye(st),fe(st)},[fe]);const[Pe,Ve]=C.useState([]),[Ae,Ue]=C.useState([]),ze=C.useCallback(async()=>{try{const Ze=await(await $d(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestAssignments(r.teacher_id);Ve(Ze)}catch(Se){console.warn("Failed to load retests",Se)}},[r]);C.useCallback(async Se=>{try{const st=await(await $d(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestTargets(Se);Ue(st)}catch(Ze){console.warn("Failed to load retest targets",Ze)}},[]);const[pt,Bt]=C.useState(!1);C.useEffect(()=>{console.debug("[TeacherCabinet] showRetestModal state changed:",pt)},[pt]);const[sr,rr]=C.useState({test_type:"",original_test_id:"",subject_id:"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:[]}),Gr=C.useCallback(async Se=>{console.debug("[TeacherCabinet] openRetestModal called with:",Se);const{test_type:Ze,original_test_id:st,subject_id:zt,failedStudentIds:Er=[]}=Se||{};rr({test_type:Ze||"multiple_choice",original_test_id:st||"",subject_id:zt||"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:Er}),console.debug("[TeacherCabinet] Setting showRetestModal to true"),Bt(!0)},[]),Lr=C.useCallback(async()=>{try{const Se=await $d(()=>import("./retestService-C6b0YDiD.js"),[]),Ze=new Date,st=new Date(Ze.getTime()+sr.window_days*24*60*60*1e3),zt={...sr,grade:T,class:L,window_start:Ze.toISOString(),window_end:st.toISOString()};await Se.retestService.createRetestAssignment(zt),f("Retest created","success"),Bt(!1),ze(),De(Er=>Er+1)}catch(Se){console.error("Create retest error",Se),f(Se.message||"Failed to create retest","error")}},[sr,T,L,ze]),yr=C.useCallback(Se=>{if(!Se)return l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:"📊"}),l.jsx("p",{className:"text-gray-500",children:"Click on a class to view performance data"})]});const st=(Ke[Se]||{}).summary;return st?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[l.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[st.average_class_score?.toFixed(1)||0,"%"]}),l.jsx("div",{className:"text-sm text-blue-600",children:"Class Average"})]}),l.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[l.jsx("div",{className:"text-3xl font-bold text-green-600",children:st.total_tests||0}),l.jsx("div",{className:"text-sm text-green-600",children:"Total Tests"})]}),l.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[l.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[st.pass_rate?.toFixed(1)||0,"%"]}),l.jsx("div",{className:"text-sm text-purple-600",children:"Pass Rate"})]}),l.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[l.jsx("div",{className:"text-3xl font-bold text-red-600",children:st.cheating_incidents||0}),l.jsx("div",{className:"text-sm text-red-600",children:"Cheating Incidents"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[l.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:st.completed_tests||0}),l.jsx("div",{className:"text-sm text-yellow-600",children:"Completed Tests"})]}),l.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[l.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:st.highest_score||0}),l.jsx("div",{className:"text-sm text-indigo-600",children:"Highest Score"})]}),l.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[l.jsx("div",{className:"text-2xl font-bold text-pink-600",children:st.total_students||0}),l.jsx("div",{className:"text-sm text-pink-600",children:"Total Students"})]})]}),re&&l.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-4 w-full max-w-xs text-center",children:[l.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-gray-300 border-t-transparent rounded-full mx-auto mb-2"}),l.jsx("div",{className:"text-sm text-gray-700",children:"Loading latest class summary..."})]})})]}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:"📊"}),l.jsx("p",{className:"text-gray-500",children:"No performance data available for this class"})]})},[Ke]);if(m)return l.jsxs("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(Sr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]}),l.jsx("div",{className:"flex flex-wrap gap-2"})]});if(v)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:v}),l.jsx(tt,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs(Qe.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(Qe.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(Qe.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),l.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",a()||""]})]}),l.jsxs(Qe.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx("div",{className:"hidden md:block",children:l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>Ye(!lt),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[l.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:lt?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),lt&&l.jsxs(Qe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("button",{onClick:()=>{Ye(!1),Te()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{Ye(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})}),l.jsxs("div",{className:"md:hidden",children:[l.jsx("button",{onClick:()=>Me(!We),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),We&&l.jsxs(Qe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:a()||"Teacher"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),l.jsxs("button",{onClick:()=>{Me(!1),Te()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{Me(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})]})]})})}),l.jsx(Qe.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:l.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((Se,Ze)=>l.jsxs(Qe.button,{onClick:()=>Se.key==="tests"?we():E(Se.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 ${S===Se.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+Ze*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[l.jsx("span",{className:"sm:hidden",children:Se.shortLabel}),l.jsx("span",{className:"hidden sm:inline",children:Se.label})]},Se.key))})})}),l.jsx(Qe.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:l.jsxs(yi,{mode:"wait",children:[S==="main"&&l.jsx(Qe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Tr()},"main"),S==="subjects"&&l.jsx(Qe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Ur()},"subjects"),S==="tests"&&l.jsx(Qe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:he()},"tests"),S==="results"&&l.jsx(Qe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:l.jsx(JF,{selectedGrade:T,selectedClass:L,onBackToCabinet:()=>E("main"),openRetestModal:Gr},je)},"results")]})}),G&&l.jsx(Mo,{isOpen:G,onClose:()=>{K(!1),Ot("subject"),At([]),$t(null),it([])},title:"Select Subjects and Classes",size:"large",children:l.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[Mt==="subject"&&l.jsxs(Qe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),gt?l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):l.jsxs("select",{value:Gt?.subject_id||"",onChange:Se=>Nr(Se.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Select a subject"}),Ft.map(Se=>l.jsx("option",{value:Se.subject_id,children:Se.subject},Se.subject_id))]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(tt,{variant:"outline",onClick:()=>K(!1),children:"Cancel"}),l.jsx(tt,{variant:"primary",onClick:()=>Ot("classes"),disabled:!Gt,children:"Next: Select Classes"})]})]}),Mt==="classes"&&Gt&&l.jsxs(Qe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",Gt.subject]}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),l.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:l.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6].map(Se=>l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",Se]}),l.jsx("div",{className:"space-y-1",children:[15,16].map(Ze=>l.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[l.jsx("input",{type:"checkbox",checked:Be.some(st=>st.grade===Se.toString()&&st.class===Ze.toString()),onChange:()=>Mr(Se.toString(),Ze.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",Ze]})]},Ze))})]},Se))})})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(tt,{variant:"outline",onClick:()=>Ot("subject"),children:"Back to Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(tt,{variant:"outline",onClick:()=>K(!1),children:"Cancel"}),l.jsx(tt,{variant:"primary",onClick:cr,disabled:Be.length===0,children:"Add Subject"})]})]})]}),bt.length>0&&l.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),l.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:bt.map((Se,Ze)=>l.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:Se.subject_name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",Se.classes.map(st=>`Grade ${st.grade} Class ${st.class}`).join(", ")]})]}),l.jsx("button",{onClick:()=>Fr(Ze),className:"text-red-600 hover:text-red-800 p-1",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Ze))})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(tt,{variant:"outline",onClick:()=>Ot("subject"),children:"Add More Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(tt,{variant:"outline",onClick:()=>K(!1),children:"Cancel"}),l.jsx(tt,{variant:"primary",onClick:pe,children:"Save All Subjects"})]})]})]})]})}),pt&&l.jsxs(Mo,{isOpen:pt,onClose:()=>Bt(!1),title:"Create Retest",size:"medium",children:[l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retest Window"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:sr.window_days,onChange:Se=>rr(Ze=>({...Ze,window_days:Number(Se.target.value)})),children:[l.jsx("option",{value:1,children:"1 day"}),l.jsx("option",{value:2,children:"2 days"}),l.jsx("option",{value:3,children:"3 days"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Attempts"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:sr.max_attempts,onChange:Se=>rr(Ze=>({...Ze,max_attempts:Number(Se.target.value)})),children:[l.jsx("option",{value:1,children:"1 attempt"}),l.jsx("option",{value:2,children:"2 attempts"}),l.jsx("option",{value:3,children:"3 attempts"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students can retry immediately if they fail"})]})]})}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:()=>Bt(!1),className:"px-4 py-2 text-sm rounded border border-gray-300 hover:bg-gray-50",children:"Cancel"}),l.jsx("button",{onClick:Lr,className:"px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700",children:"Create Retest"})]})]}),te&&J&&l.jsxs(Mo,{isOpen:te,onClose:()=>Z(!1),title:"Test Details",size:"large",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:J.test_name})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),l.jsx("p",{className:"text-sm text-gray-900",children:J.subject})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Type:"}),l.jsx("p",{className:"text-sm text-gray-900",children:J.test_type})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),l.jsx("p",{className:"text-sm text-gray-900",children:new Date(J.created_at).toLocaleDateString()})]})]}),l.jsx("div",{className:"flex justify-end space-x-3 mt-6",children:l.jsx(tt,{variant:"outline",onClick:()=>Z(!1),children:"Close"})})]}),H&&se&&l.jsx(Mo,{isOpen:H,onClose:be,title:"Delete Subject Assignment",size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:l.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Subject Assignment"}),l.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the assignment for"," ",l.jsx("span",{className:"font-semibold text-gray-900",children:se.subjectName})," ","in Grade ",se.grade,", Class ",se.classNumber,"?"]}),l.jsx("p",{className:"text-xs text-red-600",children:"This action cannot be undone."})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx(tt,{variant:"outline",onClick:be,children:"Cancel"}),l.jsx(tt,{variant:"danger",onClick:ce,children:"Delete Assignment"})]})]})}),l.jsx(Qe.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:p.map(Se=>l.jsx(Qe.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:l.jsx("div",{className:`p-4 rounded-lg shadow-lg ${Se.type==="success"?"bg-green-600 text-white":Se.type==="error"?"bg-red-600 text-white":Se.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:Se.message}),l.jsx("button",{onClick:()=>setNotifications(Ze=>Ze.filter(st=>st.id!==Se.id)),className:"ml-4 text-white hover:text-gray-200",children:"×"})]})})},Se.id))}),Ge&&l.jsx(Mo,{isOpen:Ge,onClose:ve,title:"Change Password",size:"sm",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",name:"currentPassword",value:at.currentPassword,onChange:Fe,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter current password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",name:"newPassword",value:at.newPassword,onChange:Fe,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter new password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",name:"confirmPassword",value:at.confirmPassword,onChange:Fe,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Confirm new password"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(tt,{type:"button",variant:"secondary",onClick:ve,className:"flex-1",children:"Cancel"}),l.jsx(tt,{type:"button",onClick:Ne,className:"flex-1",children:"Change Password"})]})]})})]});function Tr(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsxs(mt,{children:[l.jsx(mt.Header,{children:l.jsx(mt.Title,{children:"My Subjects & Classes"})}),l.jsx(mt.Body,{children:k.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"📚"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),l.jsx(tt,{variant:"outline",onClick:()=>E("subjects"),children:"Manage Subjects"})]}):l.jsx("div",{className:"space-y-6",children:k.map((Se,Ze)=>l.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+Ze*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Se.name}),l.jsxs("span",{className:"text-sm text-gray-500",children:[Se.classes?.length||0," classes"]})]}),Se.classes&&Se.classes.length>0?l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Se.classes.map((st,zt)=>l.jsx(Qe.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+Ze*.1+zt*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:l.jsxs(tt,{variant:"outline",size:"sm",onClick:()=>{D(st.grade),O(st.class),E("results")},className:"font-medium",children:[st.grade,"/",st.class]})},zt))}):l.jsx("div",{className:"text-center py-4 text-gray-500",children:l.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},Se.id))})})]})}),l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:l.jsxs(mt,{children:[l.jsxs(mt.Header,{children:[l.jsx(mt.Title,{children:"Test Performance Overview"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Average scores across all tests by class"})]}),l.jsx(mt.Body,{children:k.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:"📊"}),l.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const Se=[];return k.forEach(Ze=>{Ze.classes&&Ze.classes.forEach(st=>{const zt=`${st.grade}/${st.class}`;Se.find(Er=>Er.key===zt)||Se.push({key:zt,grade:st.grade,class:st.class,subject:Ze.name})})}),Se})().map((Se,Ze)=>l.jsxs("button",{onClick:()=>{console.log("🎯 Class button clicked:",Se.key),ye(Se.key),fe(Se.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${ge===Se.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[Se.grade,"/",Se.class]},Se.key))}),l.jsx("div",{className:"mt-4",children:yr(ge)})]})})]})})]})}function Ur(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(mt,{children:l.jsx(mt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(mt.Title,{children:"Subject Management"}),l.jsx(tt,{variant:"primary",onClick:Qt,children:"Add Subject"})]})})})}),k.length===0?l.jsx(Qe.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(mt,{children:l.jsx(mt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(Qe.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:"📚"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),l.jsx(tt,{variant:"primary",onClick:Qt,size:"lg",children:"Add Your First Subject"})]})})})}):l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:l.jsxs(mt,{children:[l.jsx(mt.Header,{children:l.jsx(mt.Title,{children:"Your Subjects"})}),l.jsx(mt.Body,{children:l.jsx("div",{className:"space-y-4",children:k.map((Se,Ze)=>l.jsx(Qe.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+Ze*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:l.jsx("div",{className:"flex justify-between items-start",children:l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:Se.name}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Se.classes?.map((st,zt)=>l.jsxs(Qe.div,{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+Ze*.1+zt*.05,duration:.2},whileHover:{scale:1.1},children:[l.jsxs("span",{children:[st.grade," - ",st.className]}),l.jsx("button",{onClick:()=>Cn(Se.id,Se.name,st.grade,st.class),className:"ml-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete this subject assignment",children:l.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},zt))||l.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},Ze))})})]})})]})}function he(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(mt,{children:l.jsx(mt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(mt.Title,{children:"Active Tests"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(tt,{variant:"outline",onClick:me,children:"Refresh"}),l.jsx(tt,{variant:"primary",onClick:()=>t("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),N.length===0?l.jsx(Qe.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(mt,{children:l.jsx(mt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(Qe.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:"📝"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),l.jsx(tt,{variant:"primary",onClick:()=>t("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:N.map((Se,Ze)=>l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+Ze*.1,duration:.3},whileHover:{scale:1.01},children:l.jsx(mt,{children:l.jsx(mt.Body,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"flex-1 flex items-center space-x-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0",children:Se.test_name}),l.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:Se.test_type}),l.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[l.jsx("span",{className:"font-medium",children:"Assignments:"}),l.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:Se.assignments?.length||0})]}),Se.assignments&&Se.assignments.length>0&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[l.jsx("span",{className:"font-medium",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1",children:Se.assignments.map((st,zt)=>l.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[st.grade,"/",st.class]},zt))})]}),l.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(Se.created_at).toLocaleDateString()})]})]}),l.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[l.jsx("div",{className:"sm:hidden",children:l.jsx(tt,{variant:"outline",onClick:()=>Ce(Se),size:"sm",className:"text-xs",title:`Assignments: ${Se.assignments?.length||0} | Classes: ${Se.assignments?.map(st=>`${st.grade}/${st.class}`).join(", ")||"None"} | ${new Date(Se.created_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}`,children:"Details"})}),l.jsx("div",{className:"hidden sm:block",children:l.jsx(tt,{variant:"outline",onClick:()=>Ce(Se),size:"sm",children:"Details"})}),l.jsx(tt,{variant:"success",onClick:()=>oe(Se.test_type,Se.test_id),size:"sm",children:"Complete"})]})]})})})},Ze))})]})}},wte={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing",fillBlanks:"fill_blanks"},gN=()=>{const{user:e}=Gn();SW();const{notifications:t,showNotification:r,removeNotification:n}=Oa(),[s,a]=C.useState(!1),[i,o]=C.useState(!1),[c,d]=C.useState("typeSelection"),[f,p]=C.useState(!1),[m,y]=C.useState(null),[v,w]=C.useState([]),[S,E]=C.useState(!1),[k,_]=C.useState(!1),[N,F]=C.useState(!1),[A,R]=C.useState(!1),[T,D]=C.useState({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:"",isShuffled:!1}),[L,O]=C.useState([]),[G,K]=C.useState(null);C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null);const te=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log("🔍 Setting up test creation event listeners..."),V(),console.log("🔍 Test creation initialization complete")},[e,r]),Z=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log("🔍 showTestTypeSelection called - starting new test creation"),o(!1),console.log("🔍 Reset testAssignmentCompleted flag to false"),a(!0),console.log("🔍 Set isInTestCreation flag to true"),J(),d("typeSelection"),W("testTypeSelection")},[e,r]),J=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log("🔍 Disabling navigation buttons..."),p(!0)},[e]),I=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log("🔍 Enabling navigation buttons..."),p(!1)},[e]),W=C.useCallback(async re=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("🔍 🔴 saveTestCreationState called with step:",re),console.log("🔍 🔴 Call stack:",new Error().stack);const ne={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},fe={isInTestCreation:!0,currentStep:re,timestamp:Date.now(),excelState:ne};localStorage.setItem("test_creation_state",JSON.stringify(fe)),console.log("🔍 Saved test creation state:",fe);const de={};switch(re){case"testTypeSelection":break;case"multipleChoiceForm":de.testName=T.testName||"",de.numQuestions=T.numQuestions||"",de.numOptions=T.numOptions||"",de.questions=T.questions||{};break;case"trueFalseForm":de.testName=T.testName||"",de.numQuestions=T.numQuestions||"",de.questions=T.questions||{};break;case"inputForm":de.testName=T.testName||"",de.numQuestions=T.numQuestions||"",de.questions=T.questions||{};break;case"formCreation":de.testName=T.testName||"",de.numQuestions=T.numQuestions||"",de.numOptions=T.numOptions||"",de.questions=T.questions||{},de.enableTimer=!!T.enableTimer,de.timerMinutes=T.timerMinutes||"",de.isShuffled=!!T.isShuffled;break;case"assignment":case"testAssignment":de.testName=T.testName||"",de.numQuestions=T.numQuestions||"",de.numOptions=T.numOptions||"",de.questions=T.questions||{};break;default:console.log("🔍 Unknown step in saveTestCreationState:",re);break}Object.keys(de).length>0&&(localStorage.setItem(`form_data_${re}`,JSON.stringify(de)),console.log("🔍 Saved form data for step:",re,de))},[e,T]),B=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const re=[];for(let ne=0;ne<localStorage.length;ne++){const fe=localStorage.key(ne);fe&&(fe.includes("test")||fe.includes("form")||fe.includes("question"))&&re.push(fe)}re.forEach(ne=>{localStorage.removeItem(ne),console.log("🔍 Removed localStorage key:",ne)}),console.log("🔍 Cleared test creation state from localStorage")},[e]);C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log("🔍 Clearing all test form fields..."),D({testName:"",numQuestions:0,numOptions:0,questions:{}}),y(null),O([]),K(null),console.log("🔍 Cleared all test form fields")},[e]);const Y=C.useCallback(()=>{console.log("🔍 Resetting Excel upload state..."),kt({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(ne=>{const fe=document.querySelector(`.excel-upload-btn[data-test-type="${ne}"]`);fe&&(fe.style.display="none",console.log("🔍 Excel button hidden for:",ne));const de=document.querySelector(`.excel-hint[data-test-type="${ne}"]`);de&&(de.style.display="none",console.log("🔍 Excel hint hidden for:",ne));const Pe=document.querySelector(`.excel-file-input[data-test-type="${ne}"]`);Pe&&(Pe.value="",console.log("🔍 File input cleared for:",ne))}),console.log("✅ Excel upload state reset complete")},[]),V=C.useCallback(()=>{console.log("🔍 Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions","enableTimer","timerMinutes","isShuffled"].forEach(ne=>{const fe=document.getElementById(ne);fe&&fe.addEventListener("input",()=>{console.log(`🔍 Auto-save triggered for field: ${ne}`)})}),console.log("✅ Form auto-save setup complete")},[]);C.useCallback(async re=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("🔍 🔴 saveFormDataForStep called with step:",re),console.log("🔍 🔴 Call stack:",new Error().stack);const ne={};switch(re){case"testTypeSelection":break;case"multipleChoiceForm":ne.testName=T.testName||"",ne.numQuestions=T.numQuestions||"",ne.numOptions=T.numOptions||"",ne.questions=T.questions||{};break;case"trueFalseForm":ne.testName=T.testName||"",ne.numQuestions=T.numQuestions||"",ne.questions=T.questions||{};break;case"inputForm":ne.testName=T.testName||"",ne.numQuestions=T.numQuestions||"",ne.questions=T.questions||{};break;case"formCreation":ne.testName=T.testName||"",ne.numQuestions=T.numQuestions||"",ne.numOptions=T.numOptions||"",ne.questions=T.questions||{};break;default:console.log("🔍 Unknown step for form data save:",re);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:re,data:ne,timestamp:Date.now()})),console.log("🔍 Saved form data for step:",re,ne)},[e,T]);const H=C.useCallback(async re=>{console.log("🔍 Restoring form data for step:",re);try{const ne=localStorage.getItem(`form_data_${re}`);if(ne){const fe=JSON.parse(ne);console.log("🔍 Restored form data:",fe),D(de=>{const Pe={...de,...fe};return console.log("🔍 Updated formData with restored data:",Pe),console.log("🔍 Matching test data in restored data:",Pe.matchingTestData),Pe}),Object.keys(fe).forEach(de=>{const Pe=document.getElementById(de);Pe&&fe[de]!==void 0&&(Pe.value=fe[de])}),console.log("✅ Form data restored for step:",re)}else console.log("ℹ️ No saved data found for step:",re)}catch(ne){console.error("❌ Error restoring form data:",ne)}},[e]),X=C.useCallback(()=>{console.log("🔍 Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(fe=>{const de=document.getElementById(fe);de&&de.addEventListener("input",()=>{console.log(`🔍 Auto-save triggered for MC field: ${fe}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(fe=>{fe.addEventListener("input",()=>{console.log("🔍 Auto-save triggered for MC question field")})}),console.log("✅ Multiple choice form auto-save setup complete")},[]),se=C.useCallback(()=>{console.log("🔍 Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(ne=>{ne.addEventListener("input",()=>{console.log("🔍 Auto-save triggered for TF question field")})}),console.log("✅ True/false form auto-save setup complete")},[]),ie=C.useCallback(()=>{console.log("🔍 Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(ne=>{ne.addEventListener("input",()=>{console.log("🔍 Auto-save triggered for Input question field")})}),console.log("✅ Input form auto-save setup complete")},[]),ae=C.useCallback(re=>{console.log("🔍 showExcelUploadButton called with testType:",re);const ne=re==="multiple-choice"?"multipleChoice":re==="true-false"?"trueFalse":re==="input"?"input":re;kt(fe=>({...fe,[ne]:{...fe[ne],buttonVisible:!0}}))},[]),Q=C.useCallback(re=>{console.log("🔍 showExcelHint called with testType:",re);const ne=re==="multiple-choice"?"multipleChoice":re==="true-false"?"trueFalse":re==="input"?"input":re;kt(fe=>({...fe,[ne]:{...fe[ne],hintVisible:!0}}))},[]),le=C.useCallback(async(re,ne,fe)=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:re,testType:ne,testId:fe}),w(re),console.log("🔍 Test assignment options displayed for:",{testType:ne,testId:fe,classesCount:re.length})},[e]),_e=C.useCallback(async(re,ne)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",e.teacher_id);const de=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log("Teacher subjects response:",de),de.success&&de.subjects&&de.subjects.length>0?(console.log("Teacher subjects loaded:",de.subjects),w(de.subjects),le(de.subjects,re,ne)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(fe){console.error("Error loading teacher grades and classes:",fe),r("Error loading teacher grades and classes","error")}},[e,r,le]),ke=C.useCallback(async()=>{console.log("👨‍🏫 Loading available classes...");try{const re=await mn.getGradesAndClasses();if(console.log("👨‍🏫 Raw grades/classes data:",re),!re||re.length===0){w([]);return}const ne=new Map;re.forEach(de=>{const Pe=de.subject_id,Ve=de.subject||`Subject ${Pe}`;ne.has(Pe)||ne.set(Pe,{subject_id:Pe,subject:Ve,classes:[]}),ne.get(Pe).classes.push({grade:de.grade,class:de.class})});const fe=Array.from(ne.values());w(fe),console.log("👨‍🏫 Transformed available classes:",fe)}catch(re){console.error("👨‍🏫 Error loading available classes:",re),r("Failed to load available classes","error")}},[r]);C.useCallback(async(re,ne)=>{if(i){o(!1);return}if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}J(),W("testAssignment"),K(ne),y(re),d("testAssignment"),_e(re,ne),ke(),console.log("🔍 Test assignment interface shown for:",{testType:re,testId:ne})},[i,e,J,W,_e,ke]);const Oe=C.useCallback(async re=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log("🔍 Displaying teacher active tests:",re),re.length===0){Ye([]);return}Ye(re),console.log("🔍 Active tests displayed:",re.length,"tests")},[e]);C.useCallback(async(re,ne)=>{try{console.log("🔍 Loading test questions for:",{testType:re,testId:ne});const fe=await Jr.getTestQuestions(ne,re);return console.log("🔍 Test questions loaded:",fe),fe}catch(fe){throw console.error("Error loading test questions:",fe),fe}},[]),C.useCallback((re,ne,fe,de)=>{console.log("🔍 Showing teacher test details modal:",{testType:re,testId:ne,testName:fe,questionsCount:de.length}),console.log("Test Details:",{testType:re,testId:ne,testName:fe,questions:de.map(Pe=>({id:Pe.question_id,question:Pe.question,correctAnswer:Pe.correct_answer}))}),r(`Test details for "${fe}" loaded successfully.`,"success")},[r]);const ge=C.useCallback(async()=>{console.log("🔧 DEBUG: loadTeacherActiveTests called");try{console.log("🔧 DEBUG: Fetching teacher active tests using JWT authentication...");const re=await Jr.getTeacherTests();console.log("🔧 DEBUG: Tests loaded:",re),re&&re.length>0?(console.log("🔧 DEBUG: Success! Displaying",re.length,"tests"),Oe(re)):(console.log("🔧 DEBUG: No tests found"),Ye([]))}catch(re){console.error("🔧 DEBUG: Error loading active tests:",re),r("Error loading active tests.","error")}},[r,Oe]),ye=C.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}}),O([]),o(!1),a(!1),B()},[r,B]),Ke=C.useCallback(async(re,ne)=>{if(console.log("🔍 === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log("🔍 Test Type:",re),console.log("🔍 Test ID:",ne),console.log("🔍 Current formData:",T),console.log("🔍 Selected Classes:",L),console.log("🔍 User:",e),!e||!e.teacher_id){console.error("❌ No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}if(console.log("✅ Teacher ID:",e.teacher_id),L.length===0){console.warn("⚠️ No classes selected"),r("Please select at least one class.","warning");return}try{console.log("📤 Preparing test + assignment request...");const fe=L.map(Ae=>{const Ue={grade:parseInt(Ae.grade),class:parseInt(Ae.class),subject_id:parseInt(Ae.subject_id),academic_period_id:8,due_date:null};return console.log("🔍 Created assignment:",Ue),Ue});if(console.log("📋 Final assignments array:",fe),re==="matching"){console.log("🎯 Processing matching test..."),console.log("🔄 Setting isAssigningTest to true for matching test..."),R(!0),console.log("🔄 isAssigningTest set to true, overlay should show"),await new Promise(Bt=>setTimeout(Bt,100));const Ae=T.matchingTestData;if(console.log("🔍 Matching test data from formData:",Ae),!Ae){console.error("❌ Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log("✅ Matching test data found, processing...");let Ue;Ae.processedQuestions?(console.log("🔍 Using pre-processed questions from MatchingTestCreator"),Ue=Ae.processedQuestions):(console.log("🔍 Converting blocks to questions (fallback)..."),console.log("🔍 Blocks:",Ae.blocks),console.log("🔍 Words:",Ae.words),console.log("🔍 Arrows:",Ae.arrows),Ue=Ae.blocks.map((Bt,sr)=>{const rr=Ae.words.find(Tr=>Tr.blockId===Bt.id)?.word||`Word ${sr+1}`,Gr=Ae.arrows.some(Tr=>Tr.startBlock===Bt.id),Lr=Ae.arrows.find(Tr=>Tr.startBlock===Bt.id)||null,yr={question_id:sr+1,word:rr,block_coordinates:{x:Bt.x,y:Bt.y,width:Bt.width,height:Bt.height},has_arrow:Gr,arrow:Lr?{startX:Lr.startX,startY:Lr.startY,endX:Lr.endX,endY:Lr.endY,style:Lr.style||{}}:null};return console.log(`🔍 Question ${sr+1}:`,yr),yr})),console.log("📋 Final questions array:",Ue);const ze={teacher_id:e.teacher_id,test_name:T.testName,image_url:Ae.imageUrl,num_blocks:Ae.blocks.length,questions:Ue,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,assignments:fe};console.log("📤 Final matching test data payload:",ze),console.log("🚀 Calling testService.saveMatchingTest...");const pt=await Jr.saveMatchingTest(ze);console.log("📥 API Response:",pt),pt.success?(console.log("✅ Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),o(!0),Xe()):(console.error("❌ Failed to create matching test:",pt.message),r("Error creating and assigning matching test: "+pt.message,"error")),R(!1);return}if(re==="wordMatching"){console.log("🎯 Processing word matching test..."),console.log("🔄 Setting isAssigningTest to true for word matching test..."),R(!0),console.log("🔄 isAssigningTest set to true, overlay should show"),await new Promise(Bt=>setTimeout(Bt,100));const Ae=T.wordMatchingData;if(console.log("🔍 Word matching test data from formData:",Ae),!Ae){console.error("❌ Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log("✅ Word matching test data found, processing...");const Ue=Ae.wordPairs.map((Bt,sr)=>({question_id:sr+1,left_word:Bt.leftWord,right_word:Bt.rightWord}));console.log("📋 Final word matching questions array:",Ue);const ze={teacher_id:e.teacher_id,test_type:"word_matching",test_name:T.testName,num_questions:Ae.wordPairs.length,interaction_type:Ae.interactionType||"drag",questions:Ue,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,assignments:fe};console.log("📤 Final word matching test data payload:",ze),console.log("🚀 Calling testService.assignTestToClasses for word matching...");const pt=await Jr.assignTestToClasses(ze);console.log("📥 API Response:",pt),pt.success?(console.log("✅ Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),o(!0),Xe()):(console.error("❌ Failed to create word matching test:",pt.message),r("Error creating and assigning word matching test: "+pt.message,"error")),R(!1);return}if(re==="drawing"){console.log("🎯 Processing drawing test..."),console.log("🔄 Setting isAssigningTest to true for drawing test..."),R(!0),console.log("🔄 isAssigningTest set to true, overlay should show"),await new Promise(Bt=>setTimeout(Bt,100));const Ae=T.drawingData;if(console.log("🔍 Drawing test data from formData:",Ae),!Ae){console.error("❌ Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log("✅ Drawing test data found, processing...");const Ue=Ae.questions||[];console.log("📋 Drawing questions array:",Ue);const ze={teacher_id:e.teacher_id,test_type:"drawing",test_name:T.testName,num_questions:Ae.num_questions,passing_score:Ae.passing_score,questions:Ue,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,assignments:fe};console.log("📤 Final drawing test data payload:",ze),console.log("🚀 Calling testService.assignTestToClasses...");const pt=await Jr.assignTestToClasses(ze);console.log("📥 API Response:",pt),pt.success?(console.log("✅ Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),o(!0),Xe()):(console.error("❌ Failed to create drawing test:",pt.message),r("Error creating and assigning drawing test: "+pt.message,"error")),R(!1);return}if(re==="fillBlanks"){console.log("🎯 Processing fill blanks test..."),console.log("🔄 Setting isAssigningTest to true for fill blanks test..."),R(!0),console.log("🔄 isAssigningTest set to true, overlay should show"),await new Promise(Bt=>setTimeout(Bt,100));const Ae=T.fillBlanksData;if(console.log("🔍 Fill blanks test data from formData:",Ae),!Ae){console.error("❌ Fill blanks test data not found in formData"),r("Fill blanks test data not found. Please recreate the test.","error");return}console.log("✅ Fill blanks test data found, processing...");const Ue=Ae.blanks||[];console.log("📋 Fill blanks questions array:",Ue);const ze={teacher_id:e.teacher_id,test_type:"fill_blanks",test_name:T.testName,test_text:Ae.test_text,num_questions:Ae.num_questions,num_blanks:Ae.num_blanks,separate_type:Ae.separate_type,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,questions:Ue,assignments:fe};console.log("📤 Final fill blanks test data payload:",ze),console.log("🚀 Calling testService.assignTestToClasses...");const pt=await Jr.assignTestToClasses(ze);console.log("📥 API Response:",pt),pt.success?(console.log("✅ Fill blanks test created and assigned successfully!"),r("Fill blanks test created and assigned successfully!","success"),o(!0),Xe()):(console.error("❌ Failed to create fill blanks test:",pt.message),r("Error creating and assigning fill blanks test: "+pt.message,"error")),R(!1);return}console.log("🔍 Processing non-matching test..."),console.log("🔍 Form data questions:",T.questions);const de=Object.keys(T.questions).map(Ae=>{const Ue=T.questions[Ae];console.log(`🔍 Processing question ${Ae}:`,Ue);let ze;re==="input"?ze={correct_answers:Ue.correct_answers||[Ue.correctAnswer||""]}:ze={correct_answer:Ue.correctAnswer||Ue.correct_answers?.[0]||""};const pt={question_id:parseInt(Ae),question:Ue.question,...ze,options:Ue.options||[]};return console.log(`🔍 Question ${Ae} correct_answers:`,Ue.correct_answers),console.log(`🔍 Question ${Ae} correctAnswer:`,Ue.correctAnswer),console.log(`🔍 Converted question ${Ae}:`,pt),pt});console.log("📋 Final questions array:",de);const Pe={teacher_id:e.teacher_id,test_type:wte[re],test_name:T.testName,num_questions:T.numQuestions,num_options:T.numOptions,questions:de,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,is_shuffled:!!T.isShuffled,assignments:fe};console.log("📤 Final test data payload:",Pe),console.log("🔄 Setting isAssigningTest to true..."),R(!0),console.log("🔄 isAssigningTest set to true, overlay should show"),await new Promise(Ae=>setTimeout(Ae,100)),console.log("🚀 Calling testService.assignTestToClasses...");const Ve=await Jr.assignTestToClasses(Pe);console.log("📥 API Response:",Ve),Ve.success?(console.log("✅ Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),o(!0),Xe()):(console.error("❌ Failed to create and assign test:",Ve.message),r("Error creating and assigning test: "+Ve.message,"error"))}catch(fe){console.error("💥 Exception in assignTestToClasses:",fe),console.error("Error creating and assigning test:",fe),r("Error creating and assigning test. Please try again.","error")}finally{R(!1)}console.log("🔍 === ASSIGN TEST TO CLASSES DEBUG END ===")},[e,L,T,r,ye]),Xe=C.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),o(!1),d("typeSelection"),y(null),K(null),O([]),I(),B(),ye(),console.log("🔍 Returned to main cabinet")}catch(re){console.error("Error returning to main cabinet:",re)}},[I,B,ye]),[lt,Ye]=C.useState([]),[We,Me]=C.useState(!1);C.useCallback(async()=>{console.log("🔍 Refreshing active tests data...");try{await ge(),r("Active tests data refreshed.","success")}catch(re){console.error("Error refreshing active tests data:",re),r("Error refreshing data.","error")}},[ge,r]);const[je,De]=C.useState([]),[Ge,ct]=C.useState([]),[at,wt]=C.useState(!1),[Ft,Kt]=C.useState(!1),bt=C.useCallback(async re=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",re),De(re),console.log("🔍 Existing subjects displayed in selection:",re.length,"subjects")},[e]);C.useCallback(async()=>{try{console.log("Loading existing subjects...");const re=await mn.getTeacherSubjects();console.log("Existing subjects loaded:",re),re&&re.length>0?bt(re):(console.log("No existing subjects found"),De([]))}catch(re){console.error("Error loading existing subjects:",re),r("Error loading subjects.","error")}},[r,bt]);const At=C.useCallback(re=>{console.log("Checking for outside click...");const ne=document.getElementById("dropdownMenu"),fe=document.querySelector("[data-menu-button]");ne&&!ne.contains(re.target)&&!fe?.contains(re.target)&&(console.log("Outside click detected, closing menu"),ne.classList.remove("show"),document.removeEventListener("click",At))},[]),[gt,kt]=C.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),Gt=C.useCallback((re,ne)=>{const fe=re.target.files[0];if(!fe)return;if(!fe.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),re.target.value="";return}if(fe.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),re.target.value="";return}F(!0);const de=new FileReader;de.onload=function(Pe){try{console.log("🔍 File loaded, processing data...");const Ve=new Uint8Array(Pe.target.result),Ae=f2(Ve,{type:"array"}),Ue=Ae.SheetNames[0],ze=Ae.Sheets[Ue],pt=D1.sheet_to_json(ze,{header:1});console.log("🔍 Parsed Excel data:",pt),Be(pt,ne),F(!1)}catch(Ve){console.error("Error processing Excel file:",Ve),r("Error reading Excel file: "+Ve.message,"error"),re.target.value="",F(!1)}},de.onerror=function(){r("Failed to read file","error"),re.target.value="",F(!1)},de.readAsArrayBuffer(fe)},[r]),$t=C.useCallback(()=>{console.log("🔍 Initializing Excel upload for all test types...");const re=document.querySelectorAll(".excel-upload-btn");console.log(`🔍 Found ${re.length} Excel upload buttons`),re.forEach((ne,fe)=>{const de=ne.dataset.testType,Pe=document.querySelector(`.excel-file-input[data-test-type="${de}"]`);console.log(`🔍 Processing button ${fe+1}: testType=${de}, fileInput=${Pe?"found":"not found"}`),Pe?(ne._excelClickHandler&&ne.removeEventListener("click",ne._excelClickHandler),Pe._excelChangeHandler&&Pe.removeEventListener("change",Pe._excelChangeHandler),ne._excelClickHandler=()=>{console.log(`🔍 Excel upload button clicked for test type: ${de}`),Pe.click()},Pe._excelChangeHandler=Ve=>{console.log(`🔍 File input changed for test type: ${de}`),Gt(Ve,de)},ne.addEventListener("click",ne._excelClickHandler),Pe.addEventListener("change",Pe._excelChangeHandler),console.log(`✅ Excel upload initialized for test type: ${de}`)):console.warn(`⚠️ File input not found for test type: ${de}`)}),console.log("✅ Excel upload initialization complete")},[Gt]),Be=C.useCallback((re,ne)=>{const fe=re.filter(ze=>Array.isArray(ze)&&ze.length>0&&ze.some(pt=>pt&&pt.toString().trim()!==""));console.log("🔍 Original Excel data rows:",re.length),console.log("🔍 Filtered Excel data rows:",fe.length);const Pe=it(fe,ne).dataRows;if(Pe.length===0){const ze="No data rows found after header processing. Please check your Excel file.";r(ze,"error"),alert(ze),Ne(ne);return}console.log(`🔍 Processing Excel data for test type: ${ne}`),console.log("🔍 Data rows after header processing:",Pe);const Ve=Mt(Pe,ne);if(console.log("🔍 Recognition result:",Ve),!Ve.recognized){console.log(`❌ Excel data recognition failed for test type: ${ne}`);const ze="Excel data recognition failed. Please check your file format.";r(ze,"error"),alert(ze),Ne(ne);return}console.log(`✅ Excel data recognition successful for test type: ${ne}`);const Ae=Pe.length,Ue=ve(ne);if(Ue===0)console.log(`🔍 No question count specified, using CSV count: ${Ae}`),D(ze=>({...ze,numQuestions:Ae}));else if(Ae!==Ue){const ze=`Your CSV file has ${Ae} data rows, but you specified ${Ue} questions.

Please either:
1. Change your question count to ${Ae}, or
2. Fix your CSV file to have exactly ${Ue} data rows

Then try uploading again.`;r(ze,"error"),Ne(ne);return}Fe(Pe,ne)},[r]),it=C.useCallback((re,ne)=>{if(re.length===0)return{hasHeaders:!1,headerRow:null,dataRows:re};const fe=re[0],de=ut(ne);if(St(fe,de).isLikelyHeader){const Ve=`The first row of your Excel file looks like it contains headers:

"${fe.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(Ve))return{hasHeaders:!0,headerRow:fe,dataRows:re.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:re}},[]),ut=C.useCallback(re=>{switch(re){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),St=C.useCallback((re,ne)=>{if(!re||re.length===0)return{isLikelyHeader:!1};if(re.length<ne.expectedColumns)return{isLikelyHeader:!1};const fe=re.join(" ").toLowerCase(),de=ne.keywords.filter(Ve=>fe.includes(Ve.toLowerCase()));return{isLikelyHeader:de.length>ne.keywords.length/2,keywordMatches:de}},[]),Mt=C.useCallback((re,ne)=>{if(re.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(`🔍 Checking data pattern for test type: ${ne}`),console.log("🔍 Excel data to validate:",re);const fe=Ot(re,ne);if(console.log("🔍 Recognition result:",fe),!fe.matches){const de=`Your Excel file doesn't match the expected format.

Required format:
${Te(ne)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log("❌ Data pattern validation failed:",de),console.log("🔍 Calling showNotification with message:",de),r(de,"error"),console.log("🔍 showNotification called"),alert(de),{recognized:!1,data:[]}}return console.log(`✅ Data pattern validation passed for test type: ${ne}`),{recognized:!0,data:re}},[r]),Ot=C.useCallback((re,ne)=>{if(ne==="multipleChoice")for(let fe=0;fe<re.length;fe++){const de=re[fe];if(de.length<4)return{matches:!1,issue:`Row ${fe+1} has ${de.length} columns but needs at least 4`};if(!de[0]||de[0].toString().trim()==="")return{matches:!1,issue:`Row ${fe+1} has no question in column 1`};if(!de[1]||de[1].toString().trim()==="")return{matches:!1,issue:`Row ${fe+1} has no correct answer in column 2`}}else if(ne==="trueFalse")for(let fe=0;fe<re.length;fe++){const de=re[fe];if(de.length<2)return{matches:!1,issue:`Row ${fe+1} has ${de.length} columns but needs at least 2`};if(!de[0]||de[0].toString().trim()==="")return{matches:!1,issue:`Row ${fe+1} has no question in column 1`};const Pe=de[1]?.toString().trim().toLowerCase();if(!Pe||!["true","false","t","f"].includes(Pe))return{matches:!1,issue:`Row ${fe+1} has invalid correct answer in column 2 (must be True/False)`}}else if(ne==="input")for(let fe=0;fe<re.length;fe++){const de=re[fe];if(de.length<2)return{matches:!1,issue:`Row ${fe+1} has ${de.length} columns but needs at least 2`};if(!de[0]||de[0].toString().trim()==="")return{matches:!1,issue:`Row ${fe+1} has no question in column 1`};if(!de[1]||de[1].toString().trim()==="")return{matches:!1,issue:`Row ${fe+1} has no correct answer in column 2`}}return{matches:!0}},[]),Te=C.useCallback(re=>{switch(re){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),ve=C.useCallback(re=>T.numQuestions||0,[T.numQuestions]),Ne=C.useCallback(re=>{console.log(`🔍 Clearing file input for test type: ${re}`)},[]),Fe=C.useCallback((re,ne)=>{switch(console.log(`🔍 populateFromExcelForTestType called with testType: ${ne}`),ne){case"multipleChoice":case"multiple-choice":dt(re);break;case"trueFalse":case"true-false":Wt(re);break;case"input":Et(re);break;default:console.log(`❌ Unknown test type: ${ne}`)}},[]),dt=C.useCallback(re=>{console.log("🔍 populateMultipleChoiceFromExcel called with:",re);const ne=Math.max(...re.map(Pe=>Pe.length-2)),fe=Math.min(ne,6);console.log(`🔍 Excel data has ${ne} option columns, using ${fe} options`),D(Pe=>({...Pe,numOptions:fe}));const de={};re.forEach((Pe,Ve)=>{const Ae=Ve+1;console.log(`🔍 Row ${Ve+1} data:`,Pe);const Ue={question:(Pe[0]||"").toString().trim(),options:[],correctAnswer:(Pe[1]||"").toString().trim().toUpperCase()};console.log(`🔍 Question ${Ae} correctAnswer:`,Ue.correctAnswer),["A","B","C","D","E","F"].slice(0,fe).forEach((Bt,sr)=>{const rr=(Pe[sr+2]||"").toString().trim();console.log(`🔍 Option ${sr} (${Bt}):`,rr),Ue.options.push(rr)}),de[Ae]=Ue}),D(Pe=>{const Ve={...Pe,questions:de};return console.log("🔍 Updating form data with:",Ve),Ve}),console.log("🔍 Populated multiple choice questions from Excel:",de),r(`Successfully loaded ${re.length} questions from CSV file!`,"success"),X(),nr("multiple-choice")},[T.numOptions,X,r]),Wt=C.useCallback(re=>{console.log("🔍 populateTrueFalseFromExcel called with:",re);const ne={};re.forEach((fe,de)=>{const Pe=de+1,Ve={question:(fe[0]||"").toString().trim(),correctAnswer:fe[1]?.toString().trim().toLowerCase()==="true"?"true":"false"};ne[Pe]=Ve}),D(fe=>({...fe,questions:ne})),console.log("🔍 Populated true/false questions from Excel:",ne),r(`Successfully loaded ${re.length} questions from CSV file!`,"success"),se(),nr("true-false")},[se,r]),Et=C.useCallback(re=>{console.log("🔍 populateInputFromExcel called with:",re);const ne={};re.forEach((fe,de)=>{const Pe=de+1,Ve=[];for(let Ue=1;Ue<fe.length;Ue++){const ze=(fe[Ue]||"").toString().trim();ze&&Ve.push(ze)}const Ae={question:(fe[0]||"").toString().trim(),correctAnswer:Ve[0]||"",correct_answers:Ve};console.log(`🔍 Excel question ${Pe} data:`,Ae),ne[Pe]=Ae}),D(fe=>({...fe,questions:ne})),console.log("🔍 Populated input questions from Excel:",ne),r(`Successfully loaded ${re.length} questions from Excel file!`,"success"),ie(),nr("input")},[ie,r]),nr=C.useCallback(re=>{switch(console.log(`🔍 Reattaching form event listeners for test type: ${re}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(fe=>{fe.removeEventListener("input",()=>{}),fe.removeAttribute("data-listener-attached")}),re){case"multiple-choice":X();break;case"true-false":se();break;case"input":ie();break;default:console.warn("Unknown test type for event listener reattachment:",re)}console.log(`✅ Form event listeners reattached for test type: ${re}`)},[X,se,ie]),Qt=C.useCallback(()=>{const re=localStorage.getItem("test_creation_state");if(!re)return console.log("🔍 No test creation state found in localStorage"),!1;try{const ne=JSON.parse(re);console.log("🔍 Found test creation state:",ne);const fe=Date.now()-ne.timestamp,de=1800*1e3;if(fe>de)return console.log("🔍 Test creation state is too old, clearing it"),B(),!1;switch(a(!0),console.log("🔍 Restored isInTestCreation flag to true"),J(),ne.excelState&&Y(),ne.currentStep){case"testTypeSelection":console.log("🔍 Restoring test type selection step"),d("typeSelection");break;case"multipleChoiceForm":console.log("🔍 Restoring multiple choice form step"),y("multipleChoice"),d("formCreation");break;case"trueFalseForm":console.log("🔍 Restoring true/false form step"),y("trueFalse"),d("formCreation");break;case"inputForm":console.log("🔍 Restoring input form step"),y("input"),d("formCreation");break;case"testAssignment":case"assignment":console.log("🔍 Restoring test assignment step"),console.log("🔍 Cannot restore test assignment step without test data, going back to type selection"),d("typeSelection");break;default:console.log("🔍 Unknown step in state, defaulting to type selection"),d("typeSelection")}return H(ne.currentStep),!0}catch(ne){return console.error("🔍 Error restoring test creation state:",ne),B(),!1}},[B,J,Y,H]);C.useEffect(()=>{console.log("👨‍🏫 Initializing Teacher Tests..."),te(),Qt(),ke(),$t()},[te,Qt,ke,$t]),C.useEffect(()=>{T.numQuestions>0&&m&&m!=="matching"&&m!=="drawing"&&m!=="fillBlanks"&&(console.log("🔍 Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{$t()},100))},[T.numQuestions,m,$t]);const Zt=re=>{console.log("👨‍🏫 Test type selected:",re),console.log("👨‍🏫 Setting testType to:",re),y(re),d("formCreation"),D({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:""}),W("formCreation"),setTimeout(()=>{$t()},100)},Nr=(re,ne)=>{D(fe=>({...fe,[re]:ne}))},Mr=(re,ne,fe)=>{D(de=>({...de,questions:{...de.questions,[re]:{...de.questions[re],[ne]:fe}}}))},cr=(re,ne,fe,de=0)=>{const Pe={};for(let Ve=1;Ve<=fe;Ve++)re==="multipleChoice"?Pe[Ve]={question:"",options:Array.from({length:de},()=>""),correctAnswer:""}:re==="trueFalse"?Pe[Ve]={question:"",correctAnswer:""}:re==="input"&&(Pe[Ve]={question:"",correct_answers:[""]});D(Ve=>({...Ve,questions:Pe})),re==="multipleChoice"?(ae("multiple-choice"),Q("multiple-choice")):re==="trueFalse"?(ae("true-false"),Q("true-false")):re==="input"&&(ae("input"),Q("input"))},Fr=async()=>{if(!m||!T.testName||!T.numQuestions){r("Please fill in all required fields","error");return}console.log("👨‍🏫 Test form completed, proceeding to assignment step"),W("testAssignment",T),d("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},Pr=(re,ne,fe,de,Pe)=>{O(fe?Ve=>[...Ve,{grade:re,class:ne,subject_id:de,subject:Pe}]:Ve=>Ve.filter(Ae=>!(Ae.grade===re&&Ae.class===ne&&Ae.subject_id===de)))},Cn=C.useCallback(async re=>{console.log("🎯 [DEBUG] handleMatchingTestSave called"),console.log("🎯 [DEBUG] Received testData:",re),console.log("🎯 [DEBUG] Current formData:",T),console.log("🎯 [DEBUG] Current testType:",m),console.log("🎯 [DEBUG] Current user:",e),console.log("🎯 [DEBUG] Current currentStep:",c),_(!0);try{const ne=re.blocks.map((Pe,Ve)=>{const Ae=re.words.find(pt=>pt.blockId===Pe.id)?.word||`Word ${Ve+1}`,Ue=re.arrows.some(pt=>pt.startBlock===Pe.id),ze=re.arrows.find(pt=>pt.startBlock===Pe.id)||null;return{question_id:Ve+1,word:Ae,block_coordinates:{x:Pe.x,y:Pe.y,width:Pe.width,height:Pe.height},has_arrow:Ue,arrow:ze?{startX:ze.startX,startY:ze.startY,endX:ze.endX,endY:ze.endY,style:ze.style||{}}:null}}),fe={teacher_id:e.teacher_id,test_name:T.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:re.imageUrl,num_blocks:re.blocks.length,questions:ne,assignments:[]};console.log("📦 Sending matching test payload:",fe);const de={...T,testName:fe.test_name,numQuestions:fe.num_blocks,numOptions:0,questions:ne.reduce((Pe,Ve,Ae)=>(Pe[Ae+1]={question:Ve.word,correctAnswer:Ve.word,options:[]},Pe),{}),matchingTestData:re};console.log("📦 Assignment form data:",de),D(de),W("testAssignment",de),console.log("📦 Setting current step to testAssignment"),d("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(ne){console.error("❌ Error saving matching test:",ne),r("Failed to save matching test: "+ne.message,"error")}finally{_(!1)}},[e,T,m,r,W]),ce=C.useCallback(()=>{console.log("❌ Cancelling matching test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),be=C.useCallback(async re=>{console.log("🎯 [DEBUG] handleWordMatchingTestSave called"),console.log("🎯 [DEBUG] Received testData:",re),_(!0);try{D(ne=>({...ne,wordMatchingData:re,numQuestions:re.numQuestions||re.wordPairs?.length||0})),d("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(ne){console.error("Error saving word matching test:",ne),r("Failed to save word matching test: "+ne.message,"error")}finally{_(!1)}},[r]),pe=C.useCallback(()=>{console.log("❌ Cancelling word matching test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),we=C.useCallback(async re=>{console.log("🎯 [DEBUG] handleDrawingTestSave called"),console.log("🎯 [DEBUG] Received testData:",re),_(!0);try{D(ne=>({...ne,drawingData:re,numQuestions:re.num_questions||re.questions?.length||0})),d("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(ne){console.error("❌ Error saving drawing test:",ne),r("Error saving drawing test","error")}finally{_(!1)}},[r]),Ce=C.useCallback(()=>{console.log("❌ Cancelling drawing test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),oe=C.useCallback(()=>{console.log("❌ Cancelling fill blanks test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),me=C.useCallback(async re=>{console.log("🎯 [DEBUG] handleFillBlanksTestSave called"),console.log("🎯 [DEBUG] Received testData:",re),_(!0);try{D(ne=>({...ne,fillBlanksData:re,numQuestions:re.num_questions||re.blanks?.length||0})),d("testAssignment"),r("Fill blanks test created! Now assign it to classes.","success")}catch(ne){console.error("❌ Error saving fill blanks test:",ne),r("Error saving fill blanks test","error")}finally{_(!1)}},[r]);return l.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[l.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs(yi,{mode:"wait",children:[c==="typeSelection"&&l.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs(tt,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsx("div",{className:"flex-1"})]}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),l.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Picture Matching",description:"Labeling pictures",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Matching word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"},{type:"fillBlanks",title:"Fill Blanks",description:"Text with multiple choice blanks",icon:"/pics/fill-blanks.png"}].map(({type:re,title:ne,description:fe,icon:de})=>l.jsx(Qe.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>Zt(re),children:l.jsxs(mt,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[l.jsx("div",{className:"mb-3 flex justify-center",children:l.jsx("img",{src:de,alt:ne,className:"w-12 h-12 object-contain"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:ne}),l.jsx("p",{className:"text-sm text-gray-600",children:fe})]})},re))})]}),c==="formCreation"&&l.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"flex space-x-2",children:l.jsx(tt,{variant:"outline",onClick:Z,children:"← Back to Test Types"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",m==="multipleChoice"?"Multiple Choice":m==="trueFalse"?"True/False":m==="input"?"Input":m==="drawing"?"Drawing":m==="fillBlanks"?"Fill Blanks":m==="wordMatching"?"Word Matching":"Picture Matching"," Test"]}),l.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),l.jsx(mt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),l.jsx("input",{type:"text",value:T.testName,onChange:re=>Nr("testName",re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),m!=="matching"&&m!=="wordMatching"&&m!=="drawing"&&m!=="fillBlanks"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),l.jsx("input",{type:"number",min:"1",max:"50",value:T.numQuestions,onChange:re=>{const ne=parseInt(re.target.value)||0;Nr("numQuestions",ne),ne>0&&cr(m,T.testName,ne,T.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),m==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),l.jsx("input",{type:"number",min:"2",max:"6",value:T.numOptions,onChange:re=>{const ne=parseInt(re.target.value)||0;Nr("numOptions",ne),ne>0&&ne<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),T.numQuestions>0&&cr(m,T.testName,T.numQuestions,ne)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("label",{className:"inline-flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:!!T.enableTimer,onChange:re=>Nr("enableTimer",re.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Enable timer for this test"})]}),T.enableTimer&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"Time (minutes):"}),l.jsx("input",{type:"number",min:"1",max:"1440",value:T.timerMinutes,onChange:re=>Nr("timerMinutes",re.target.value.replace(/[^0-9]/g,"")),className:"w-28 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 30"})]}),m!=="drawing"&&m!=="matching"&&m!=="fillBlanks"&&l.jsxs("label",{className:"inline-flex items-center space-x-2 ml-6",children:[l.jsx("input",{type:"checkbox",checked:!!T.isShuffled,onChange:re=>Nr("isShuffled",re.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Shuffle questions during test"})]})]})]})}),m==="matching"&&l.jsx(mt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Picture Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),l.jsx(bO,{testName:T.testName,onTestSaved:Cn,onCancel:ce,onBackToCabinet:Xe,isSaving:k,validationErrors:{}})]})}),m==="wordMatching"&&l.jsx(mt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),l.jsx(bW,{testName:T.testName,onTestSaved:be,onCancel:pe,onBackToCabinet:Xe,isSaving:k,validationErrors:{}})]})}),m==="drawing"&&l.jsxs("div",{className:"drawing-test-section",children:[console.log("🎨 Rendering DrawingTestCreator, testType:",m),l.jsx(hW,{testName:T.testName,onTestSaved:we,onCancel:Ce,onBackToCabinet:Xe,isSaving:k,validationErrors:{}})]}),m==="fillBlanks"&&l.jsxs("div",{className:"fill-blanks-test-section",children:[console.log("📝 Rendering FillBlanksTestCreator, testType:",m),l.jsx(xW,{testName:T.testName,allowedTime:T.enableTimer&&parseInt(T.timerMinutes)||null,onTestSaved:me,onCancel:oe,onBackToCabinet:Xe,isSaving:k,validationErrors:{}})]}),m!=="matching"&&m!=="drawing"&&m!=="fillBlanks"&&T.numQuestions>0&&l.jsx(mt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),l.jsxs("div",{className:"space-y-6",children:[m==="multipleChoice"&&gt.multipleChoice?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Sr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Multiple Choice Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),l.jsx("div",{children:"Column 3: Option A text"}),l.jsx("div",{children:"Column 4: Option B text"}),l.jsx("div",{children:"Column 5: Option C text"}),l.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),m==="trueFalse"&&gt.trueFalse?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Sr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-xs text-blue-800",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),m==="input"&&gt.input?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Sr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Input Test Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Answer 1"}),l.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),m!=="matching"&&m!=="drawing"&&m!=="fillBlanks"&&T.numQuestions>0&&l.jsx(mt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),T.numQuestions>0&&l.jsx(mt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),l.jsx("div",{className:"space-y-6",children:Object.keys(T.questions).map(re=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",re]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),l.jsx("textarea",{value:T.questions[re]?.question||"",onChange:ne=>Mr(re,"question",ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text"})]}),m==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),l.jsx("div",{className:"space-y-2",children:T.questions[re]?.options?.map((ne,fe)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+fe),":"]}),l.jsx("input",{type:"text",value:ne,onChange:de=>{const Pe=[...T.questions[re].options];Pe[fe]=de.target.value,Mr(re,"options",Pe)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+fe)}`})]},fe))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),m==="multipleChoice"?l.jsx("div",{children:l.jsxs("select",{value:T.questions[re]?.correctAnswer||"",onChange:ne=>Mr(re,"correctAnswer",ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),T.questions[re]?.options?.map((ne,fe)=>l.jsx("option",{value:String.fromCharCode(65+fe),children:String.fromCharCode(65+fe)},fe))]})}):m==="trueFalse"?l.jsxs("select",{value:T.questions[re]?.correctAnswer||"",onChange:ne=>Mr(re,"correctAnswer",ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"true",children:"True"}),l.jsx("option",{value:"false",children:"False"})]}):l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("input",{type:"text",value:T.questions[re]?.correct_answers?.[0]||"",onChange:ne=>{const de=[...T.questions[re]?.correct_answers||[""]];de[0]=ne.target.value,Mr(re,"correct_answers",de)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer"}),T.questions[re]?.correct_answers?.slice(1).map((ne,fe)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"text",value:ne,onChange:de=>{const Pe=[...T.questions[re]?.correct_answers||[]];Pe[fe+1]=de.target.value,Mr(re,"correct_answers",Pe)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${fe+2}`}),l.jsx("button",{type:"button",onClick:()=>{const de=[...T.questions[re]?.correct_answers||[]];de.splice(fe+1,1),Mr(re,"correct_answers",de)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},fe))||[],l.jsx("button",{type:"button",onClick:()=>{const fe=[...T.questions[re]?.correct_answers||[""],""];Mr(re,"correct_answers",fe)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},re))})]})}),T.testName&&T.numQuestions>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(tt,{onClick:Fr,disabled:k,className:"px-8",children:k?l.jsxs(l.Fragment,{children:[l.jsx(Sr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),c==="testAssignment"&&l.jsxs(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs(tt,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),l.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),l.jsx(tt,{variant:"outline",onClick:()=>d("formCreation"),children:"← Back to Test Form"})]}),l.jsx(mt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),v.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-6xl mb-4",children:"📚"}),l.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),l.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),l.jsx("div",{className:"mt-4",children:l.jsx(tt,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):l.jsx("div",{className:"space-y-6",children:v.map(re=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:re.subject}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:re.classes.map(ne=>l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:L.some(fe=>fe.grade===ne.grade&&fe.class===ne.class&&fe.subject_id===re.subject_id),onChange:fe=>Pr(ne.grade,ne.class,fe.target.checked,re.subject_id,re.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-sm text-gray-700",children:[ne.grade,"/",ne.class]})]},`${ne.grade}-${ne.class}-${re.subject_id}`))})]},re.subject_id))})]})}),L.length>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(tt,{onClick:()=>Ke(m,null),disabled:S,className:"px-8",children:S?l.jsxs(l.Fragment,{children:[l.jsx(Sr,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${L.length} Class${L.length>1?"es":""}`})})]})]})}),console.log("🔍 Checking isAssigningTest:",A),A&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),k&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:t.map(re=>l.jsx(Wo,{type:re.type,message:re.message,duration:re.duration,onClose:()=>n(re.id)},re.id))})]})},_te=({onDataLoaded:e,onError:t})=>{const r=Bi(),{user:n,isAuthenticated:s}=Gn(),{teacherData:a,loadTeacherData:i}=Ky(),[o,c]=C.useState(!0),[d,f]=C.useState(""),[p,m]=C.useState([]),[y,v]=C.useState(null),[w,S]=C.useState([]),[E,k]=C.useState([]),[_,N]=C.useState([]),[F,A]=C.useState(null),[R,T]=C.useState(0);C.useEffect(()=>{te()},[]),C.useCallback(async J=>{console.log("👨‍🏫 Teacher login attempt...");try{const I=await mn.teacherLogin(J);if(I.success)return K("Login successful!","success"),await D(),I;throw new Error(I.error||"Login failed")}catch(I){throw console.error("👨‍🏫 Teacher login error:",I),K("Login failed. Please check your credentials.","error"),I}},[]);const D=C.useCallback(async()=>{console.log("👨‍🏫 Loading teacher data...");try{if(c(!0),f(""),!s||!n){console.log("👨‍🏫 User not authenticated"),f("User not authenticated");return}if(n.role!==ei.TEACHER){console.error("👨‍🏫 Invalid user role for teacher data:",n.role),f("Access denied. Teacher role required.");return}console.log("👨‍🏫 Fetching teacher data from service...");const J=await mn.getTeacherData();if(J&&J.success)console.log("👨‍🏫 Teacher data loaded successfully:",J),v(J.teacher||n),J.subjects&&(S(J.subjects),console.log("👨‍🏫 Teacher subjects loaded:",J.subjects.length)),J.grades&&k(J.grades),J.classes&&N(J.classes),A(new Date),T(I=>I+1),e&&e(J),K("Teacher data loaded successfully!","success");else throw new Error(J?.error||"Failed to load teacher data")}catch(J){console.error("👨‍🏫 Error loading teacher data:",J);const I=J.message||"Failed to load teacher data";f(I),t&&t(J),K(I,"error")}finally{c(!1)}},[s,n,e,t]),L=C.useCallback(()=>{console.log("👨‍🏫 Returning to main cabinet..."),r("/teacher/cabinet")},[r]);C.useCallback(J=>{console.log("👨‍🏫 Showing main cabinet with subjects:",J),J&&S(J),r("/teacher/cabinet")},[r]);const O=C.useCallback(()=>(console.log("👨‍🏫 Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(I=>({id:I,name:`Grade ${I}`,classes:G(I)}))),[]),G=C.useCallback(J=>Array.from({length:10},(W,B)=>B+1).map(W=>({id:`${J}-${W}`,name:`Class ${W}`,grade:J,classNumber:W})),[]),K=C.useCallback((J,I)=>{const W={id:Date.now(),message:J,type:I,timestamp:new Date};m(B=>[...B,W]),setTimeout(()=>{m(B=>B.filter(Y=>Y.id!==W.id))},xi.NOTIFICATION_DURATION)},[]),te=C.useCallback(async()=>{console.log("👨‍🏫 Initializing teacher data..."),await D()},[D]),Z=C.useCallback(async()=>{console.log("👨‍🏫 Refreshing teacher data..."),await D()},[D]);return C.useCallback(async J=>{console.log("👨‍🏫 Updating teacher profile:",J);try{const I=await mn.updateUserProfile(J);if(I.success)return v(W=>({...W,...J})),K("Profile updated successfully!","success"),I;throw new Error(I.error||"Failed to update profile")}catch(I){throw console.error("👨‍🏫 Error updating teacher profile:",I),K("Failed to update profile","error"),I}},[]),C.useCallback(async J=>{console.log("👨‍🏫 Changing teacher password...");try{const I=await mn.changePassword(J);if(I.success)return K("Password changed successfully!","success"),I;throw new Error(I.error||"Failed to change password")}catch(I){throw console.error("👨‍🏫 Error changing teacher password:",I),K("Failed to change password","error"),I}},[]),o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Sr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):d?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:d}),l.jsxs("div",{className:"flex space-x-3 justify-center",children:[l.jsx(tt,{variant:"primary",onClick:Z,children:"Retry"}),l.jsx(tt,{variant:"outline",onClick:L,children:"Go Back"})]})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",F?F.toLocaleString():"Never"," | Version: ",R]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(tt,{variant:"outline",onClick:Z,children:"Refresh Data"}),l.jsx(tt,{variant:"outline",onClick:L,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),y?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:y.name||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),l.jsx("p",{className:"text-sm text-gray-900",children:y.username||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),l.jsx("p",{className:"text-sm text-gray-900",children:y.email||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),l.jsx("p",{className:"text-sm text-gray-900",children:y.role||"N/A"})]})]}):l.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",w.length,")"]}),w.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map((J,I)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:J.name}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:J.description||"No description"}),J.classes&&J.classes.length>0&&l.jsxs("div",{className:"mt-2",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:J.classes.map((W,B)=>l.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[W.grade," - ",W.className]},B))})]})]},I))}):l.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:O().map(J=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:J.name}),l.jsx("div",{className:"grid grid-cols-5 gap-1",children:J.classes.map(I=>l.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",I),children:I.classNumber},I.id))})]},J.id))})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:w.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-green-600",children:E.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:_.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:R}),l.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:p.map(J=>l.jsx(Wo,{type:J.type,message:J.message,onClose:()=>m(I=>I.filter(W=>W.id!==J.id))},J.id))})]})},bte=({onBackToCabinet:e})=>{const t=Bi(),{user:r,isAuthenticated:n}=Gn(),{teacherData:s}=Ky(),[a,i]=C.useState(!0),[o,c]=C.useState(""),[d,f]=C.useState([]),[p,m]=C.useState([]),[y,v]=C.useState([]),[w,S]=C.useState([]),[E,k]=C.useState(null),[_,N]=C.useState([]),[F,A]=C.useState(!1),[R,T]=C.useState(!1),[D,L]=C.useState(!1),[O,G]=C.useState(!1),[K,te]=C.useState(null),[Z,J]=C.useState(!0),[I,W]=C.useState(null);C.useEffect(()=>{Ye()},[]),C.useCallback(Me=>{console.log("👨‍🏫 Rendering existing subjects:",Me),m(Me)},[]);const B=C.useCallback(()=>{console.log("👨‍🏫 Showing subject selection prompt..."),A(!0),J(!1),Y()},[]),Y=C.useCallback(async()=>{console.log("👨‍🏫 Loading existing subjects...");try{const Me=await mn.getTeacherSubjects();Me.success&&Me.subjects&&Me.subjects.length>0?(console.log("👨‍🏫 Existing subjects found:",Me.subjects),V(Me.subjects)):(console.log("👨‍🏫 No existing subjects found"),S([]))}catch(Me){console.error("👨‍🏫 Error loading existing subjects:",Me),lt("Failed to load existing subjects","error")}},[]),V=C.useCallback(Me=>{console.log("👨‍🏫 Rendering subject selection:",Me);const je=[];Me.forEach(De=>{De.classes&&Array.isArray(De.classes)&&De.classes.forEach(Ge=>{je.push({id:`${De.subject_id}-${Ge.grade}-${Ge.class}`,subjectId:De.subject_id,subjectName:De.subject,grade:Ge.grade,class:Ge.class,displayText:`${De.subject} - ${Ge.grade}/${Ge.class}`})})}),S(je),console.log("👨‍🏫 Processed subjects for selection:",je)},[]),H=C.useCallback(async Me=>{if(console.log("👨‍🏫 Saving teacher subjects:",Me),!Me||Me.length===0){lt("Please select at least one subject and class combination.","warning");return}try{const je=Me.reduce((Ge,ct)=>{const at=Ge.find(wt=>wt.subject_id===ct.subjectId);return at?at.classes.push({grade:ct.grade,class:ct.class}):Ge.push({subject_id:ct.subjectId,classes:[{grade:ct.grade,class:ct.class}]}),Ge},[]);console.log("👨‍🏫 Transformed data for backend:",je);const De=await mn.saveTeacherSubjects(je);if(De.success)lt("Subjects saved successfully!","success"),A(!1),J(!0),W(new Date),await Y();else throw new Error(De.error||"Failed to save subjects")}catch(je){console.error("👨‍🏫 Error saving subjects:",je),lt("Error saving subjects. Please try again.","error")}},[]),X=C.useCallback(()=>{console.log("👨‍🏫 Toggling subject dropdown..."),T(Me=>!Me),L(!1)},[]),se=C.useCallback(async()=>{console.log("👨‍🏫 Loading subjects for dropdown...");try{const Me=await mn.getAllSubjects();if(Me.success)v(Me.subjects||[]),console.log("👨‍🏫 Available subjects loaded:",Me.subjects?.length||0);else throw new Error(Me.error||"Failed to load subjects")}catch(Me){console.error("👨‍🏫 Error loading subjects for dropdown:",Me),lt("Failed to load subjects","error")}},[]),ie=C.useCallback(Me=>{console.log("👨‍🏫 Subject selected:",Me);const je=y.find(De=>De.subject_id===parseInt(Me));je&&(k(je),L(!0),T(!1),ae())},[y]),ae=C.useCallback(()=>{console.log("👨‍🏫 Loading grades and classes...")},[]),Q=C.useCallback((Me,je)=>{console.log("👨‍🏫 Saving classes for subject:",Me,je);const De={id:`${Me.subject_id}-${Date.now()}`,subjectId:Me.subject_id,subjectName:Me.subject,grade:je.grade,class:je.class,displayText:`${Me.subject} - ${je.grade}/${je.class}`};S(Ge=>[...Ge,De]),k(null),N([]),L(!1),_e(`Added ${Me.subject} for ${je.grade}/${je.class}`)},[]),le=C.useCallback(()=>{console.log("👨‍🏫 Resetting subject selection..."),k(null),N([]),T(!1),L(!1)},[]),_e=C.useCallback(Me=>{console.log("👨‍🏫 Showing message:",Me),lt(Me,"success")},[]),ke=C.useCallback(Me=>{console.log("👨‍🏫 Showing confirmation modal:",Me),te(Me),G(!0)},[]),Oe=C.useCallback(()=>{console.log("👨‍🏫 Hiding confirmation modal..."),G(!1),te(null)},[]),ge=C.useCallback(()=>{console.log("👨‍🏫 Confirming save subjects..."),Oe(),H(w)},[w,H,Oe]),ye=C.useCallback(()=>{console.log("👨‍🏫 Cancelling save subjects..."),Oe()},[Oe]),Ke=C.useCallback(Me=>{console.log("👨‍🏫 Removing subject:",Me),S(je=>je.filter(De=>De.id!==Me)),lt("Subject removed","info")},[]);C.useCallback(()=>{console.log("👨‍🏫 Showing edit subjects button..."),J(!0)},[]),C.useCallback(()=>{console.log("👨‍🏫 Hiding edit subjects button..."),J(!1)},[]);const Xe=C.useCallback(Me=>{console.log("👨‍🏫 Generating class buttons for grade:",Me);let je;return Me===1||Me===2?je=["15","16"]:Me===3?je=["15","16"]:Me===4?je=["13","14"]:Me===5||Me===6?je=["13","14"]:je=[],je.map(De=>({id:`${Me}-${De}`,grade:Me,class:De,displayText:`${Me}/${De}`}))},[]);C.useCallback((Me,je)=>{console.log("👨‍🏫 Showing class results:",Me,je),t("/teacher/results")},[t]);const lt=C.useCallback((Me,je)=>{const De={id:Date.now(),message:Me,type:je,timestamp:new Date};f(Ge=>[...Ge,De]),setTimeout(()=>{f(Ge=>Ge.filter(ct=>ct.id!==De.id))},xi.NOTIFICATION_DURATION)},[]),Ye=C.useCallback(async()=>{console.log("👨‍🏫 Initializing teacher subjects...");try{if(i(!0),c(""),!n||!r){console.log("👨‍🏫 User not authenticated"),c("User not authenticated");return}if(r.role!==ei.TEACHER){console.error("👨‍🏫 Invalid user role for teacher subjects:",r.role),c("Access denied. Teacher role required.");return}await Y(),await se(),console.log("👨‍🏫 Teacher subjects initialization complete!")}catch(Me){console.error("👨‍🏫 Error initializing teacher subjects:",Me),c("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,Y,se]),We=C.useCallback(()=>{e?e():t("/teacher/cabinet")},[e,t]);return a?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Sr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:o}),l.jsx(tt,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",I?I.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[Z&&l.jsx(tt,{variant:"primary",onClick:B,children:"Edit Subjects"}),l.jsx(tt,{variant:"outline",onClick:We,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[!F&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs(tt,{variant:"primary",onClick:B,className:"px-6 py-2",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),p.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map((Me,je)=>l.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:Me.subject}),Me.classes&&Me.classes.length>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Me.classes.map((De,Ge)=>l.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",De.grade," - Class ",De.class]},Ge))})]})]}),l.jsx("div",{className:"ml-4",children:l.jsx(tt,{variant:"outline",size:"sm",onClick:()=>Ke(Me.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},je))}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:l.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),l.jsxs(tt,{variant:"primary",onClick:B,className:"px-6 py-3",children:[l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),F&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs(tt,{variant:"outline",onClick:X,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[l.jsx("span",{className:"text-gray-900 font-medium",children:E?E.subject:"Select a subject"}),l.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),R&&l.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:y.map(Me=>l.jsx("button",{onClick:()=>ie(Me.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:l.jsx("span",{className:"text-gray-900 font-medium",children:Me.subject})},Me.subject_id))})]})]}),D&&E&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-6",children:[l.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",E.subject]}),l.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(Me=>l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:l.jsx("span",{className:"text-white font-bold text-xs",children:Me})}),l.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",Me]})]}),l.jsx("div",{className:"space-y-3",children:Xe(Me).map(je=>l.jsx(tt,{variant:"outline",size:"sm",onClick:()=>Q(E,je),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:je.displayText},je.id))})]},Me))})]}),w.length>0&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map(Me=>l.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"flex-1",children:l.jsx("span",{className:"text-sm font-semibold text-purple-900",children:Me.displayText})}),l.jsx(tt,{variant:"outline",size:"sm",onClick:()=>Ke(Me.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Me.id))})]}),l.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[l.jsx("div",{className:"text-sm text-gray-500",children:w.length>0?`${w.length} subject${w.length>1?"s":""} selected`:"No subjects selected"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs(tt,{variant:"outline",onClick:()=>{A(!1),J(!0),le()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),l.jsxs(tt,{variant:"primary",onClick:()=>ke({type:"save",data:w}),disabled:w.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),D?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),O&&l.jsx(Mo,{isOpen:O,onClose:Oe,title:"Confirm Save",variant:"confirmation",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",K?.data?.length||0," subject assignments?"]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(tt,{variant:"outline",onClick:ye,children:"Cancel"}),l.jsx(tt,{variant:"primary",onClick:ge,children:"Save"})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(Me=>l.jsx(Wo,{type:Me.type,message:Me.message,onClose:()=>f(je=>je.filter(De=>De.id!==Me.id))},Me.id))})]})},Ste=()=>{const{user:e,role:t,isAuthenticated:r,isLoading:n}=Gn(),[s,a]=C.useState("cabinet");return!r||t!=="teacher"?l.jsx(Zh,{to:"/login",replace:!0}):n?l.jsxs("div",{className:"teacher-app-loading",children:[l.jsx(Sr,{}),l.jsx("p",{children:"Loading teacher interface..."})]}):l.jsx("div",{className:"teacher-app",children:l.jsxs(x2,{children:[l.jsx(fs,{path:"/",element:l.jsx(hN,{})}),l.jsx(fs,{path:"/cabinet",element:l.jsx(hN,{})}),l.jsx(fs,{path:"/tests",element:l.jsx(gN,{})}),l.jsx(fs,{path:"/tests/create",element:l.jsx(gN,{})}),l.jsx(fs,{path:"/data",element:l.jsx(_te,{})}),l.jsx(fs,{path:"/subjects",element:l.jsx(bte,{})}),l.jsx(fs,{path:"/results",element:l.jsx(JF,{})}),l.jsx(fs,{path:"*",element:l.jsx(Zh,{to:"/teacher",replace:!0})})]})})},Re={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},kte=()=>{const{user:e,isAdmin:t,logout:r}=Gn(),{get:n,post:s}=Ho(),a=C.useCallback(async()=>{try{m({type:"info",message:"Refreshing class summary view..."});const he=await s("/.netlify/functions/refresh-class-summary-semester",{});he&&(he.success||he.message)?m({type:"success",message:"Class summary view refreshed."}):m({type:"error",message:he?.error||"Failed to refresh view"})}catch(he){m({type:"error",message:"Failed to refresh view"}),console.error("Refresh class summary error:",he)}},[s]),i=C.useCallback(async()=>{try{m({type:"info",message:"Checking for overdue assignments..."});const he=await s("/.netlify/functions/check-overdue-assignments",{});if(he&&he.success){const Se=he.overdue_count||0;Se>0?m({type:"success",message:`Found and marked ${Se} overdue assignments as inactive.`}):m({type:"info",message:"No overdue assignments found."})}else m({type:"error",message:he?.error||"Failed to check assignments"})}catch(he){m({type:"error",message:"Failed to check assignments"}),console.error("Check overdue assignments error:",he)}},[s]),[o,c]=C.useState(!1),[d,f]=C.useState(null),[p,m]=C.useState(null),[y,v]=C.useState(!1),[w,S]=C.useState(!1),[E,k]=C.useState(!1),[_,N]=C.useState(!1),[F,A]=C.useState(""),[R,T]=C.useState(null),[D,L]=C.useState({}),[O,G]=C.useState(null),[K,te]=C.useState({}),[Z,J]=C.useState(null),[I,W]=C.useState({}),[B,Y]=C.useState([]),[V,H]=C.useState(""),[X,se]=C.useState(""),[ie,ae]=C.useState(""),[Q,le]=C.useState(!0),[_e,ke]=C.useState(!1),[Oe,ge]=C.useState([]),[ye,Ke]=C.useState(""),[Xe,lt]=C.useState(""),[Ye,We]=C.useState(""),[Me,je]=C.useState(!1),[De,Ge]=C.useState(!1),[ct,at]=C.useState([]),[wt,Ft]=C.useState([]),[Kt,bt]=C.useState([]),[At,gt]=C.useState([]),[kt,Gt]=C.useState(!1),[$t,Be]=C.useState(!1),[it,ut]=C.useState(!1),[St,Mt]=C.useState(!1),[Ot,Te]=C.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[ve,Ne]=C.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[Fe,dt]=C.useState({subject_id:"",subject:"",description:"",is_active:!0}),[Wt,Et]=C.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});C.useEffect(()=>{console.log("🔄 AdminCabinet component mounted - initializing..."),nr()},[]),C.useEffect(()=>{const he=Se=>{Me&&!Se.target.closest(".admin-menu")&&je(!1)};return document.addEventListener("mousedown",he),()=>{document.removeEventListener("mousedown",he)}},[Me]);const nr=C.useCallback(async()=>{try{c(!0),await Mr(),console.log("Admin app initialized")}catch(he){f("Failed to initialize admin app"),console.error("Admin app initialization error:",he)}finally{c(!1)}},[]),Qt=C.useCallback(()=>{je(he=>!he)},[]),Zt=C.useCallback(()=>{Ge(!0),je(!1)},[]),Nr=C.useCallback(()=>{Ge(!1)},[]),Mr=C.useCallback(async()=>{try{await Promise.all([cr(),Fr(),Pr(),Cn()])}catch(he){console.error("Error loading admin data:",he),f("Failed to load admin data")}},[]),cr=C.useCallback(async()=>{try{const he="admin_users_",Se=Mn(he);if(Se){console.log("📊 Using cached users data"),at(Se);return}const Ze=await n("/.netlify/functions/get-all-users");console.log("📊 Users response:",Ze);const st=Ze.users||[];at(st),kn(he,st,Nn.admin_users),console.log("👥 Users set to state:",st)}catch(he){console.error("Error loading users:",he)}},[n]),Fr=C.useCallback(async()=>{try{const he="admin_teachers_",Se=Mn(he);if(Se){console.log("📊 Using cached teachers data"),Ft(Se);return}const Ze=await n("/.netlify/functions/get-all-teachers");console.log("📊 Teachers response:",Ze);const st=Ze.teachers||[];Ft(st),kn(he,st,Nn.admin_teachers),console.log("👨‍🏫 Teachers set to state:",st)}catch(he){console.error("Error loading teachers:",he)}},[n]),Pr=C.useCallback(async()=>{try{const he="admin_subjects_",Se=Mn(he);if(Se){console.log("📊 Using cached subjects data"),bt(Se);return}const Ze=await n("/.netlify/functions/get-all-subjects");console.log("📊 Subjects response:",Ze);const st=Ze.subjects||[];bt(st),kn(he,st,Nn.admin_subjects),console.log("📚 Subjects set to state:",st)}catch(he){console.error("Error loading subjects:",he)}},[n]),Cn=C.useCallback(async()=>{try{const he="admin_academic_years_",Se=Mn(he);if(Se){console.log("📊 Using cached academic years data"),gt(Se);return}const st=(await n("/.netlify/functions/get-academic-year")).academic_years||[];gt(st),kn(he,st,Nn.admin_academic_years)}catch(he){console.error("Error loading academic year:",he)}},[n]),ce=C.useCallback(async()=>{try{if(N(!_),!_){const[he,Se]=await Promise.all([n("/.netlify/functions/get-all-tests"),n("/.netlify/functions/get-test-assignments")]);console.log("📊 Active tests response:",he),console.log("📊 Assignments response:",Se);const Ze=he.tests||[],zt=(Se.assignments||[]).reduce((vr,va)=>{const Ui=`${va.test_type}-${va.test_id}`;return vr[Ui]||(vr[Ui]=[]),vr[Ui].push(va),vr},{}),Er=Ze.map(vr=>{const va=`${vr.test_type}-${vr.test_id}`,Ui=zt[va]||[],Fl=Ui.some(Bs=>Bs.is_active);return{...vr,is_active:Fl,assignments:Ui}});Y(Er),console.log("🧪 All tests with status set to state:",Er)}}catch(he){console.error("Error loading tests:",he),m({type:"error",message:"Failed to load tests"})}},[n,_]),be=C.useCallback((he,Se)=>{Te(Ze=>({...Ze,[he]:Se}))},[]),pe=C.useCallback((he,Se)=>{Ne(Ze=>({...Ze,[he]:Se}))},[]),we=C.useCallback((he,Se)=>{dt(Ze=>({...Ze,[he]:Se}))},[]);C.useCallback(()=>{console.log("🧪 Testing local storage...");try{const he={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(he));const Se=JSON.parse(localStorage.getItem("test"));console.log("✅ Local storage test successful:",Se),m({type:"success",message:"Local storage test successful"})}catch(he){console.error("❌ Local storage test failed:",he),m({type:"error",message:"Local storage test failed"})}},[]),C.useCallback(()=>{console.log("🧹 Clearing local storage...");try{localStorage.clear(),console.log("✅ Local storage cleared"),m({type:"success",message:"Local storage cleared"})}catch(he){console.error("❌ Error clearing local storage:",he),m({type:"error",message:"Error clearing local storage"})}},[]),C.useCallback(async()=>{console.log("👨‍🏫 Checking teacher subjects...");try{const Se=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log("📊 Teachers data:",Se),m({type:"success",message:`Found ${Se.length} teachers`})}catch(he){console.error("❌ Error checking teacher subjects:",he),m({type:"error",message:"Error checking teacher subjects"})}},[n]);const Ce=C.useCallback(async he=>{he.preventDefault();try{console.log("👤 Submitting user:",Ot);const Se=await s("/.netlify/functions/add-user",Ot);Se.success?(m({type:"success",message:"User added successfully"}),Gt(!1),Te({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),cr()):m({type:"error",message:Se.message||"Failed to add user"})}catch(Se){console.error("❌ Error adding user:",Se),m({type:"error",message:"Error adding user"})}},[Ot,s,cr]),oe=C.useCallback(async he=>{he.preventDefault();try{console.log("👨‍🏫 Submitting teacher:",ve);const Se=await s("/.netlify/functions/add-teacher",ve);Se.success?(m({type:"success",message:"Teacher added successfully"}),Be(!1),Ne({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),Fr()):m({type:"error",message:Se.message||"Failed to add teacher"})}catch(Se){console.error("❌ Error adding teacher:",Se),m({type:"error",message:"Error adding teacher"})}},[ve,s,Fr]),me=C.useCallback(async he=>{he.preventDefault();try{console.log("📚 Submitting subject:",Fe);const Se=await s("/.netlify/functions/add-subject",Fe);Se.success?(m({type:"success",message:"Subject added successfully"}),ut(!1),dt({subject_id:"",subject:"",description:"",is_active:!0}),Pr()):m({type:"error",message:Se.message||"Failed to add subject"})}catch(Se){console.error("❌ Error adding subject:",Se),m({type:"error",message:"Error adding subject"})}},[Fe,s,Pr]),re=C.useCallback(he=>{T(he),L({name:he.name||"",surname:he.surname||"",grade:he.grade||"",class:he.class||"",student_id:he.student_id||"",nickname:he.nickname||"",password:he.password||"",is_active:he.is_active!==void 0?he.is_active:!0})},[]),ne=C.useCallback(async()=>{try{const he=[];Object.keys(D).forEach(Se=>{Se!=="student_id"&&D[Se]!==R[Se]&&he.push({fieldName:Se,newValue:D[Se]})});for(const Se of he)await s("/.netlify/functions/update-user",{userId:R.student_id,fieldName:Se.fieldName,newValue:Se.newValue});m({type:"success",message:"User updated successfully!"}),T(null),L({}),cr()}catch{m({type:"error",message:"Failed to update user"})}},[D,R,s,cr]),fe=C.useCallback(async he=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:he})).success&&(m({type:"success",message:"User deleted successfully!"}),cr())}catch{m({type:"error",message:"Failed to delete user"})}},[s,cr]),de=C.useCallback(he=>{G(he),te({teacher_id:he.teacher_id||"",username:he.username||"",password:he.password||"",first_name:he.first_name||"",last_name:he.last_name||"",is_active:he.is_active!==void 0?he.is_active:!0})},[]),Pe=C.useCallback(async()=>{try{const he=[];Object.keys(K).forEach(Se=>{Se!=="teacher_id"&&K[Se]!==O[Se]&&he.push({fieldName:Se,newValue:K[Se]})});for(const Se of he)await s("/.netlify/functions/update-teacher",{teacherId:O.teacher_id,fieldName:Se.fieldName,newValue:Se.newValue});m({type:"success",message:"Teacher updated successfully!"}),G(null),te({}),Fr()}catch{m({type:"error",message:"Failed to update teacher"})}},[K,O,s,Fr]),Ve=C.useCallback(async he=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:he})).success&&(m({type:"success",message:"Teacher deleted successfully!"}),Fr())}catch{m({type:"error",message:"Failed to delete teacher"})}},[s,Fr]),Ae=C.useCallback(he=>{J(he),W({subject_id:he.subject_id||"",subject:he.subject||""})},[]),Ue=C.useCallback(async()=>{try{const he=[];Object.keys(I).forEach(Se=>{Se!=="subject_id"&&I[Se]!==Z[Se]&&he.push({fieldName:Se,newValue:I[Se]})});for(const Se of he)await s("/.netlify/functions/update-subject",{subjectId:Z.subject_id,fieldName:Se.fieldName,newValue:Se.newValue});m({type:"success",message:"Subject updated successfully!"}),J(null),W({}),Pr()}catch{m({type:"error",message:"Failed to update subject"})}},[I,Z,s,Pr]),ze=C.useCallback(async he=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const Se=await s("/.netlify/functions/delete-subject",{subjectId:he});Se.success?(m({type:"success",message:"Subject deleted successfully!"}),Pr()):m({type:"error",message:Se.message||"Failed to delete subject"})}catch{m({type:"error",message:"Failed to delete subject"})}},[s,Pr]),pt=C.useCallback((he,Se)=>{Et(Ze=>({...Ze,[he]:Se}))},[]),Bt=C.useCallback(async he=>{if(he.preventDefault(),!Wt.startDate||!Wt.endDate||!Wt.teacherId){m({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const Se=await s("/.netlify/functions/delete-test-data",Wt);Se.success?(m({type:"success",message:`Successfully deleted ${Se.deletedCount} test records!`}),Mt(!1),Et({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):m({type:"error",message:Se.message||"Failed to delete test data"})}catch{m({type:"error",message:"Failed to delete test data"})}},[Wt,s]),sr=C.useCallback(async(he,Se,Ze)=>{try{const st=await n("/.netlify/functions/get-test-assignments");if(st.success&&st.assignments){const zt=st.assignments.filter(Er=>Er.test_id===parseInt(he)&&Er.test_type===Se);if(zt.length===0){m({type:"error",message:"No assignments found for this test"});return}for(const Er of zt){const vr=await s("/.netlify/functions/remove-assignment",{teacher_id:Ze,assignment_id:Er.assignment_id,test_type:Se,test_id:he});if(!vr.success){m({type:"error",message:`Failed to complete test: ${vr.message}`});return}}m({type:"success",message:"Test marked as complete successfully!"}),await ce()}else m({type:"error",message:"Failed to get test assignments"})}catch(st){console.error("Error completing test:",st),m({type:"error",message:"Failed to complete test"})}},[s,n,ce]),rr=C.useCallback(async(he,Se,Ze)=>{try{const st=await n("/.netlify/functions/get-test-assignments");if(st.success&&st.assignments){const zt=st.assignments.filter(Er=>Er.test_id===parseInt(he)&&Er.test_type===Se);if(zt.length===0){m({type:"error",message:"No assignments found for this test"});return}for(const Er of zt){const vr=await s("/.netlify/functions/remove-assignment",{teacher_id:Ze,assignment_id:Er.assignment_id,test_type:Se,test_id:he,mark_active:!0});if(!vr.success){m({type:"error",message:`Failed to reactivate test: ${vr.message}`});return}}m({type:"success",message:"Test marked as active successfully!"}),await ce()}else m({type:"error",message:"Failed to get test assignments"})}catch(st){console.error("Error reactivating test:",st),m({type:"error",message:"Failed to reactivate test"})}},[s,n,ce]),Gr=C.useCallback(async()=>{try{if(ke(!_e),!_e){const he=await n("/.netlify/functions/get-all-tests");console.log("📊 Actual tests response:",he),ge(he.tests||[]),console.log("🧪 Actual tests set to state:",he.tests||[])}}catch(he){console.error("Error loading actual tests:",he),m({type:"error",message:"Failed to load tests"})}},[n,_e]),Lr=C.useCallback(async(he,Se,Ze)=>{try{const st=await s("/.netlify/functions/delete-test",{test_id:he,test_type:Se,teacher_id:Ze});st.success?(m({type:"success",message:"Test deleted successfully!"}),await Gr()):m({type:"error",message:`Failed to delete test: ${st.message}`})}catch(st){console.error("Error deleting test:",st),m({type:"error",message:"Failed to delete test"})}},[s,Gr]),yr=F?ct.filter(he=>he.grade.toString()===F):ct,Tr=B.filter(he=>{const Se=!V||he.teacher_id===V,Ze=!X||new Date(he.created_at)>=new Date(X),st=!ie||new Date(he.created_at)<=new Date(ie+"T23:59:59"),zt=Q?he.is_active:!he.is_active;return Se&&Ze&&st&&zt}),Ur=Oe.filter(he=>{const Se=!ye||he.teacher_id===ye,Ze=!Xe||new Date(he.created_at)>=new Date(Xe),st=!Ye||new Date(he.created_at)<=new Date(Ye+"T23:59:59");return Se&&Ze&&st});return l.jsxs(Qe.div,{id:"admin-cabinet-main",className:Re.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(Qe.div,{className:Re.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:Re.headerContent,children:l.jsxs("div",{className:Re.headerFlex,children:[l.jsxs(Qe.div,{className:Re.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(Qe.div,{className:Re.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:e?.username?.charAt(0)||"A"})})}),l.jsxs("div",{children:[l.jsx("h1",{className:Re.adminText,children:e?.username||"Administrator"}),l.jsx("p",{className:Re.adminSubtext,children:"Administrator Dashboard"})]})]}),l.jsxs(Qe.div,{className:Re.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:Qt,className:Re.menuButton,style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(Qe.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:Me?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(yi,{children:Me&&l.jsx(Qe.div,{className:Re.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(Qe.button,{onClick:Zt,className:Re.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(Qe.button,{onClick:()=>{Qt(),r()},className:Re.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),o&&l.jsx(Sr,{text:"Loading..."}),d&&l.jsx(Wo,{type:"error",message:d,onClose:()=>f(null)}),p&&l.jsx(Wo,{type:p.type,message:p.message,onClose:()=>m(null)}),De&&l.jsx("div",{className:Re.modalOverlay,children:l.jsxs("div",{className:Re.modalContent,children:[l.jsx("h2",{className:Re.modalTitle,children:"Change Password"}),l.jsxs("form",{className:"space-y-4",children:[l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{htmlFor:"currentPassword",className:Re.formLabel,children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",className:Re.formInput})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{htmlFor:"newPassword",className:Re.formLabel,children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",className:Re.formInput})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{htmlFor:"confirmPassword",className:Re.formLabel,children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",className:Re.formInput})]}),l.jsxs("div",{className:Re.modalActions,children:[l.jsx(tt,{type:"button",variant:"secondary",onClick:Nr,className:"flex-1",children:"Cancel"}),l.jsx(tt,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),l.jsx(Qe.div,{className:Re.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:l.jsxs("div",{className:"space-y-6",children:[l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:l.jsxs(mt,{className:Re.cardContainer,children:[l.jsx(mt.Header,{className:Re.cardHeader,children:l.jsx(mt.Title,{className:Re.cardTitle,children:"User Management"})}),l.jsxs(mt.Body,{className:Re.cardBody,children:[l.jsxs("div",{className:Re.buttonGroup,children:[l.jsx(tt,{variant:"primary",onClick:()=>Gt(!0),className:Re.buttonPrimary,children:"Add User"}),l.jsx(tt,{variant:"secondary",onClick:()=>{cr(),v(!y)},className:Re.buttonSecondary,children:y?"Hide Users Table":"Get All Users ▶"})]}),l.jsx(yi,{children:kt&&l.jsxs(Qe.div,{className:Re.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),l.jsxs("form",{onSubmit:Ce,className:"space-y-4",children:[l.jsxs("div",{className:Re.formGrid,children:[l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Grade"}),l.jsx("input",{type:"text",value:Ot.grade,onChange:he=>be("grade",he.target.value),className:Re.formInput,placeholder:"Enter grade"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Class"}),l.jsx("input",{type:"text",value:Ot.class,onChange:he=>be("class",he.target.value),className:Re.formInput,placeholder:"Enter class"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Number"}),l.jsx("input",{type:"text",value:Ot.number,onChange:he=>be("number",he.target.value),className:Re.formInput,placeholder:"Enter number"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Student ID"}),l.jsx("input",{type:"text",value:Ot.student_id,onChange:he=>be("student_id",he.target.value),className:Re.formInput,placeholder:"Enter student ID"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Name"}),l.jsx("input",{type:"text",value:Ot.name,onChange:he=>be("name",he.target.value),className:Re.formInput,placeholder:"Enter name"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Surname"}),l.jsx("input",{type:"text",value:Ot.surname,onChange:he=>be("surname",he.target.value),className:Re.formInput,placeholder:"Enter surname"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Nickname"}),l.jsx("input",{type:"text",value:Ot.nickname,onChange:he=>be("nickname",he.target.value),className:Re.formInput,placeholder:"Enter nickname"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:Ot.password,onChange:he=>be("password",he.target.value),className:Re.formInput,placeholder:"Enter password"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"userActive",checked:Ot.is_active,onChange:he=>be("is_active",he.target.checked),className:Re.formCheckbox}),l.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:Re.formActions,children:[l.jsx(tt,{type:"button",variant:"secondary",onClick:()=>Gt(!1),className:Re.buttonSecondary,children:"Cancel"}),l.jsx(tt,{type:"submit",variant:"primary",className:Re.buttonPrimary,children:"Add User"})]})]})]})}),y&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",yr.length," of ",ct.length,")"]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),l.jsxs("select",{value:F,onChange:he=>A(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Grades"}),[...new Set(ct.map(he=>he.grade))].sort().map(he=>l.jsxs("option",{value:he,children:["Grade ",he]},he))]})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:l.jsxs("table",{className:Re.table,children:[l.jsx("thead",{className:Re.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Re.tableHeaderCell,children:"Name"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Grade"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Class"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Student ID"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Number"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Nickname"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Re.tableBody,children:yr.map((he,Se)=>l.jsxs("tr",{className:Re.tableRow,children:[l.jsxs("td",{className:Re.tableCell,children:[he.name," ",he.surname]}),l.jsx("td",{className:Re.tableCell,children:he.grade}),l.jsx("td",{className:Re.tableCell,children:he.class}),l.jsx("td",{className:Re.tableCell,children:he.student_id}),l.jsx("td",{className:Re.tableCell,children:he.number}),l.jsx("td",{className:Re.tableCell,children:he.nickname}),l.jsx("td",{className:Re.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>re(he),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>fe(he.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},he.id||Se))})]})})})]})]})]})}),l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(mt,{className:Re.cardContainer,children:[l.jsxs(mt.Header,{className:Re.cardHeader,children:[l.jsx(mt.Title,{className:Re.cardTitle,children:"Teacher Management"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:a,className:"px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs whitespace-nowrap",title:"Refresh materialized class summary view",children:"Refresh Class Summary View"}),l.jsx("button",{onClick:i,className:"px-3 py-1.5 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs whitespace-nowrap",title:"Check and mark overdue assignments (7+ days old) as inactive",children:"Check Overdue Assignments"}),l.jsx(tt,{variant:"primary",onClick:()=>Be(!0),className:"text-xs whitespace-nowrap",children:"Add Teacher"}),l.jsx(tt,{variant:"secondary",onClick:()=>{Fr(),S(!w)},className:"text-xs whitespace-nowrap",children:w?"Hide Teachers Table":"Get All Teachers ▶"})]})]}),l.jsxs(mt.Body,{className:Re.cardBody,children:[l.jsx(yi,{children:$t&&l.jsxs(Qe.div,{className:Re.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),l.jsxs("form",{onSubmit:oe,className:"space-y-4",children:[l.jsxs("div",{className:Re.formGrid,children:[l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Teacher ID"}),l.jsx("input",{type:"text",value:ve.teacher_id,onChange:he=>pe("teacher_id",he.target.value),className:Re.formInput,placeholder:"Enter teacher ID"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Username"}),l.jsx("input",{type:"text",value:ve.username,onChange:he=>pe("username",he.target.value),className:Re.formInput,placeholder:"Enter username"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:ve.password,onChange:he=>pe("password",he.target.value),className:Re.formInput,placeholder:"Enter password"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"First Name"}),l.jsx("input",{type:"text",value:ve.first_name,onChange:he=>pe("first_name",he.target.value),className:Re.formInput,placeholder:"Enter first name"})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Last Name"}),l.jsx("input",{type:"text",value:ve.last_name,onChange:he=>pe("last_name",he.target.value),className:Re.formInput,placeholder:"Enter last name"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacherActive",checked:ve.is_active,onChange:he=>pe("is_active",he.target.checked),className:Re.formCheckbox}),l.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:Re.formActions,children:[l.jsx(tt,{type:"button",variant:"secondary",onClick:()=>Be(!1),className:Re.buttonSecondary,children:"Cancel"}),l.jsx(tt,{type:"submit",variant:"primary",className:Re.buttonPrimary,children:"Add Teacher"})]})]})]})}),R&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),l.jsx("input",{type:"text",value:D.name,onChange:he=>L({...D,name:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),l.jsx("input",{type:"text",value:D.surname,onChange:he=>L({...D,surname:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),l.jsx("input",{type:"number",value:D.grade,onChange:he=>L({...D,grade:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("input",{type:"number",value:D.class,onChange:he=>L({...D,class:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),l.jsx("input",{type:"text",value:D.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),l.jsx("input",{type:"text",value:D.nickname,onChange:he=>L({...D,nickname:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:D.password,onChange:he=>L({...D,password:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"is_active",checked:D.is_active,onChange:he=>L({...D,is_active:he.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{T(null),L({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:ne,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),w&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",wt.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Re.table,children:[l.jsx("thead",{className:Re.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Re.tableHeaderCell,children:"Teacher ID"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Name"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Username"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Password"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Status"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Re.tableBody,children:wt.map((he,Se)=>l.jsxs("tr",{className:Re.tableRow,children:[l.jsx("td",{className:Re.tableCell,children:he.teacher_id}),l.jsxs("td",{className:Re.tableCell,children:[he.first_name," ",he.last_name]}),l.jsx("td",{className:Re.tableCell,children:he.username}),l.jsx("td",{className:Re.tableCell,children:he.password}),l.jsx("td",{className:Re.tableCell,children:l.jsx("span",{className:he.is_active?Re.statusActive:Re.statusInactive,children:he.is_active?"Active":"Inactive"})}),l.jsx("td",{className:Re.tableCell,children:new Date(he.created_at).toLocaleDateString()}),l.jsx("td",{className:Re.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>de(he),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>Ve(he.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},he.teacher_id||Se))})]})})})]})]})]})}),l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:l.jsxs(mt,{className:Re.cardContainer,children:[l.jsx(mt.Header,{className:Re.cardHeader,children:l.jsx(mt.Title,{className:Re.cardTitle,children:"Subject Management"})}),l.jsxs(mt.Body,{className:Re.cardBody,children:[l.jsxs("div",{className:Re.buttonGroup,children:[l.jsx(tt,{variant:"primary",onClick:()=>ut(!0),className:Re.buttonPrimary,children:"Add Subject"}),l.jsx(tt,{variant:"secondary",onClick:()=>{Pr(),k(!E)},className:Re.buttonSecondary,children:E?"Hide Subjects Table":"Get All Subjects ▶"})]}),l.jsx(yi,{children:it&&l.jsxs(Qe.div,{className:Re.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),l.jsxs("form",{onSubmit:me,className:"space-y-4",children:[l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Subject Name"}),l.jsx("input",{type:"text",value:Fe.subject,onChange:he=>we("subject",he.target.value),className:Re.formInput,placeholder:"Enter subject name",required:!0}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),l.jsxs("div",{className:Re.formActions,children:[l.jsx(tt,{type:"button",variant:"secondary",onClick:()=>ut(!1),className:Re.buttonSecondary,children:"Cancel"}),l.jsx(tt,{type:"submit",variant:"primary",className:Re.buttonPrimary,children:"Add Subject"})]})]})]})}),O&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),l.jsx("input",{type:"text",value:K.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),l.jsx("input",{type:"text",value:K.username,onChange:he=>te({...K,username:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:K.password,onChange:he=>te({...K,password:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),l.jsx("input",{type:"text",value:K.first_name,onChange:he=>te({...K,first_name:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),l.jsx("input",{type:"text",value:K.last_name,onChange:he=>te({...K,last_name:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:K.is_active,onChange:he=>te({...K,is_active:he.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{G(null),te({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:Pe,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),Z&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),l.jsx("input",{type:"text",value:I.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),l.jsx("input",{type:"text",value:I.subject,onChange:he=>W({...I,subject:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>J(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),l.jsx("button",{onClick:Ue,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),E&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",Kt.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Re.table,children:[l.jsx("thead",{className:Re.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Re.tableHeaderCell,children:"Subject ID"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Subject Name"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Re.tableBody,children:Kt.map((he,Se)=>l.jsxs("tr",{className:Re.tableRow,children:[l.jsx("td",{className:Re.tableCell,children:he.subject_id}),l.jsx("td",{className:Re.tableCell,children:he.subject}),l.jsx("td",{className:Re.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>Ae(he),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>ze(he.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},he.subject_id||Se))})]})})})]})]})]})}),l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(mt,{className:Re.cardContainer,children:[l.jsx(mt.Header,{className:Re.cardHeader,children:l.jsx(mt.Title,{className:Re.cardTitle,children:"Test Data Deletion"})}),l.jsxs(mt.Body,{className:Re.cardBody,children:[l.jsx("div",{className:Re.buttonGroup,children:l.jsx(tt,{variant:"danger",onClick:()=>Mt(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),l.jsx(yi,{children:St&&l.jsxs(Qe.div,{className:Re.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),l.jsxs("form",{onSubmit:Bt,className:"space-y-4",children:[l.jsxs("div",{className:Re.formGrid,children:[l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Start Date *"}),l.jsx("input",{type:"date",value:Wt.startDate,onChange:he=>pt("startDate",he.target.value),className:Re.formInput,required:!0})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"End Date *"}),l.jsx("input",{type:"date",value:Wt.endDate,onChange:he=>pt("endDate",he.target.value),className:Re.formInput,required:!0})]})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Teacher ID *"}),l.jsxs("select",{value:Wt.teacherId,onChange:he=>pt("teacherId",he.target.value),className:Re.formInput,required:!0,children:[l.jsx("option",{value:"",children:"Select a teacher"}),wt.map(he=>l.jsxs("option",{value:he.teacher_id,children:[he.teacher_id," - ",he.first_name," ",he.last_name]},he.teacher_id))]})]}),l.jsxs("div",{className:Re.formGroup,children:[l.jsx("label",{className:Re.formLabel,children:"Subject (Optional)"}),l.jsxs("select",{value:Wt.subjectId,onChange:he=>pt("subjectId",he.target.value),className:Re.formInput,children:[l.jsx("option",{value:"",children:"All subjects"}),Kt.map(he=>l.jsx("option",{value:he.subject_id,children:he.subject},he.subject_id))]})]}),l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),l.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[l.jsx("p",{children:"This will permanently delete:"}),l.jsxs("ul",{className:"list-disc list-inside mt-1",children:[l.jsx("li",{children:"All test records within the date range"}),l.jsx("li",{children:"All test questions and answers"}),l.jsx("li",{children:"All test results and submissions"}),l.jsx("li",{children:"All test assignments"}),l.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),l.jsxs("div",{className:Re.formActions,children:[l.jsx(tt,{type:"button",variant:"secondary",onClick:()=>Mt(!1),className:Re.buttonSecondary,children:"Cancel"}),l.jsx(tt,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:l.jsxs(mt,{className:Re.cardContainer,children:[l.jsx(mt.Header,{className:Re.cardHeader,children:l.jsx(mt.Title,{className:Re.cardTitle,children:"Assignments Management"})}),l.jsxs(mt.Body,{className:Re.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(tt,{variant:"primary",onClick:ce,className:Re.buttonPrimary,children:_?"Hide Assignments Table":"Get All Assignments ▶"})}),_&&l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"border-b border-gray-200",children:l.jsxs("nav",{className:"-mb-px flex space-x-8",children:[l.jsx("button",{onClick:()=>le(!0),className:`py-2 px-1 border-b-2 font-medium text-sm ${Q?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Active Assignments"}),l.jsx("button",{onClick:()=>le(!1),className:`py-2 px-1 border-b-2 font-medium text-sm ${Q?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-purple-500 text-purple-600"}`,children:"Inactive Assignments"})]})})}),_&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:[Q?"Active":"Inactive"," Assignments (",Tr.length," of ",B.filter(he=>Q?he.is_active:!he.is_active).length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:V,onChange:he=>H(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),wt.map(he=>l.jsxs("option",{value:he.teacher_id,children:[he.first_name," ",he.last_name]},he.teacher_id))]}),l.jsx("input",{type:"date",value:X,onChange:he=>se(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:ie,onChange:he=>ae(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Re.table,children:[l.jsx("thead",{className:Re.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Re.tableHeaderCell,children:"Test Name"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Type"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Teacher"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Questions"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Re.tableBody,children:Tr.map((he,Se)=>l.jsxs("tr",{className:Re.tableRow,children:[l.jsx("td",{className:Re.tableCell,children:he.test_name}),l.jsx("td",{className:Re.tableCell,children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:he.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:Re.tableCell,children:he.teacher_name}),l.jsx("td",{className:Re.tableCell,children:he.num_questions}),l.jsx("td",{className:Re.tableCell,children:new Date(he.created_at).toLocaleDateString()}),l.jsx("td",{className:Re.tableCell,children:l.jsx("div",{className:"flex space-x-2",children:Q?l.jsx("button",{onClick:()=>sr(he.test_id,he.test_type,he.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):l.jsx("button",{onClick:()=>rr(he.test_id,he.test_type,he.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",children:"Mark Active"})})})]},`${he.test_type}-${he.test_id}-${Se}`))})]})})})]})]})]})}),l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(mt,{className:Re.cardContainer,children:[l.jsx(mt.Header,{className:Re.cardHeader,children:l.jsx(mt.Title,{className:Re.cardTitle,children:"Test Management"})}),l.jsxs(mt.Body,{className:Re.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(tt,{variant:"primary",onClick:Gr,className:Re.buttonPrimary,children:_e?"Hide Tests Table":"Get All Tests ▶"})}),_e&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",Ur.length," of ",Oe.length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:ye,onChange:he=>Ke(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),wt.map(he=>l.jsxs("option",{value:he.teacher_id,children:[he.first_name," ",he.last_name]},he.teacher_id))]}),l.jsx("input",{type:"date",value:Xe,onChange:he=>lt(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:Ye,onChange:he=>We(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Re.table,children:[l.jsx("thead",{className:Re.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Re.tableHeaderCell,children:"Test Name"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Type"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Teacher"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Questions"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Re.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Re.tableBody,children:Ur.map((he,Se)=>l.jsxs("tr",{className:Re.tableRow,children:[l.jsx("td",{className:Re.tableCell,children:he.test_name}),l.jsx("td",{className:Re.tableCell,children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:he.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:Re.tableCell,children:he.teacher_name}),l.jsx("td",{className:Re.tableCell,children:he.num_questions}),l.jsx("td",{className:Re.tableCell,children:new Date(he.created_at).toLocaleDateString()}),l.jsx("td",{className:Re.tableCell,children:l.jsx("div",{className:"flex space-x-2",children:l.jsx("button",{onClick:()=>Lr(he.test_id,he.test_type,he.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete Test"})})})]},`${he.test_type}-${he.test_id}-${Se}`))})]})})})]})]})]})}),l.jsx(Qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(mt,{className:Re.cardContainer,children:[l.jsx(mt.Header,{className:Re.cardHeader,children:l.jsx(mt.Title,{className:Re.cardTitle,children:"Debug & Testing"})}),l.jsx(mt.Body,{className:Re.cardBody})]})})]})})]})},Cte=()=>{const{isAdmin:e,getCurrentAdminId:t,logout:r}=Gn(),{get:n}=Ho(),{showNotification:s}=Oa();C.useEffect(()=>{a()},[]);const a=C.useCallback(async()=>{if(console.log("👨‍💼 Initializing Admin Application..."),!e()){console.error("❌ User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await o(),c(),d(),console.log("✅ Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(f){console.error("❌ Error initializing admin app:",f),s("Failed to initialize admin dashboard","error")}},[e,t,r,s,n]),i=C.useCallback(()=>{console.log("🔧 Initializing global event listeners...");const f=p=>{p.ctrlKey&&p.key==="k"&&(p.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}},[]),o=C.useCallback(async()=>{try{console.log("📊 Loading admin data...");const[f,p,m,y]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),n("/.netlify/functions/get-academic-year")]);f.status==="fulfilled"&&f.value?.success&&console.log("✅ Users loaded:",f.value.users?.length||0),p.status==="fulfilled"&&p.value?.success&&console.log("✅ Teachers loaded:",p.value.teachers?.length||0),m.status==="fulfilled"&&m.value?.success&&console.log("✅ Subjects loaded:",m.value.subjects?.length||0),y.status==="fulfilled"&&y.value?.success&&console.log("✅ Academic years loaded:",y.value.academic_years?.length||0),console.log("✅ Admin data loading completed")}catch(f){throw console.error("❌ Error loading admin data:",f),f}},[n]),c=C.useCallback(()=>{console.log("🗑️ Initializing test deletion functionality..."),console.log("✅ Test deletion functionality initialized")},[]),d=C.useCallback(()=>{console.log("🌐 Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const p=document.getElementById("allSubjectsContainer"),m=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!p){console.error("❌ allSubjectsContainer not found");return}if(!m){console.error("❌ Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",m.textContent=y?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const p=document.getElementById("addSubjectForm");p&&(p.style.display="block")},window.hideAddSubjectForm=()=>{const p=document.getElementById("addSubjectForm"),m=document.getElementById("newSubjectForm");p&&(p.style.display="none"),m&&m.reset()},window.showAddAcademicYearForm=()=>{const p=document.getElementById("addAcademicYearForm");p&&(p.style.display="block")},window.hideAddAcademicYearForm=()=>{const p=document.getElementById("addAcademicYearForm"),m=document.getElementById("newAcademicYearForm");p&&(p.style.display="none"),m&&m.reset()},window.toggleUsersContent=()=>{const p=document.getElementById("allUsersContainer"),m=document.querySelector('button[onclick="toggleUsersContent()"]');if(!p){console.error("❌ allUsersContainer not found");return}if(!m){console.error("❌ Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",m.textContent=y?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const p=document.getElementById("addUserForm");p&&(p.style.display="block")},window.hideAddUserForm=()=>{const p=document.getElementById("addUserForm"),m=document.getElementById("newUserForm");p&&(p.style.display="none"),m&&m.reset()},window.showAddTeacherForm=()=>{const p=document.getElementById("addTeacherForm");p&&(p.style.display="block")},window.hideAddTeacherForm=()=>{const p=document.getElementById("addTeacherForm"),m=document.getElementById("newTeacherForm");p&&(p.style.display="none"),m&&m.reset()},window.toggleTeachersContent=()=>{const p=document.getElementById("allTeachersContainer"),m=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!p){console.error("❌ allTeachersContainer not found");return}if(!m){console.error("❌ Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",m.textContent=y?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const p=document.getElementById("allTestsContainer"),m=document.querySelector('button[onclick="toggleTestsContent()"]');if(!p){console.error("❌ allTestsContainer not found");return}if(!m){console.error("❌ Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",m.textContent=y?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const p=document.getElementById("allAssignmentsContainer"),m=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!p){console.error("❌ allAssignmentsContainer not found");return}if(!m){console.error("❌ Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",m.textContent=y?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const p=document.getElementById("allResultsContainer"),m=document.querySelector('button[onclick="toggleResultsContent()"]');if(!p){console.error("❌ allResultsContainer not found");return}if(!m){console.error("❌ Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",m.textContent=y?"Show Results":"Hide Results"};const f={};window.toggleSection=p=>{console.log(`🔧 toggleSection called with sectionId: ${p}`);const m=Date.now();if(f[p]&&m-f[p]<300){console.log(`🔧 Ignoring rapid successive call for ${p}`);return}f[p]=m;const y=document.getElementById(p);if(!y){console.error(`❌ Section with id '${p}' not found!`);return}const v=y.style.display!=="none";y.style.display=v?"none":"block";const w=document.querySelector(`button[onclick="toggleSection('${p}')"]`);w&&(w.textContent=v?"Show":"Hide")},window.addClickListeners=()=>{console.log("🔧 Adding click listeners to section headers...");const p=document.querySelectorAll(".section-header");console.log(`🔧 Found ${p.length} section headers`),p.forEach((m,y)=>{const v=m.textContent.trim();if(console.log(`🔧 Processing header ${y+1}:`,v),m.dataset.listenerAdded==="true"){console.log(`🔧 Skipping header ${v} - listener already added`);return}m.addEventListener("click",()=>{const w=m.dataset.sectionId;w&&window.toggleSection(w)}),m.dataset.listenerAdded="true",console.log(`🔧 Added click listener to header: ${v}`)})},window.makeFieldEditable=p=>{const m=p.textContent;p.dataset.field;const y=document.createElement("input");y.type="text",y.value=m,y.className="editable-input";const v=document.createElement("button");v.textContent="Save",v.className="btn-save",v.onclick=()=>window.saveField(p,y,v,w);const w=document.createElement("button");w.textContent="Cancel",w.className="btn-cancel",w.onclick=()=>{p.textContent=m,p.style.display="block",y.remove(),v.remove(),w.remove()},p.style.display="none",p.parentNode.insertBefore(y,p),p.parentNode.insertBefore(v,p),p.parentNode.insertBefore(w,p)},window.saveField=(p,m,y,v)=>{const w=m.value.trim(),S=p.dataset.field,E=p.dataset.recordId;if(!w){alert("Field cannot be empty");return}console.log(`Saving field ${S} for record ${E} with value: ${w}`),p.textContent=w,p.style.display="block",m.remove(),y.remove(),v.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const p=localStorage.getItem("test");return localStorage.removeItem("test"),console.log("✅ localStorage is working"),!0}catch(p){return console.error("❌ localStorage error:",p),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log("✅ localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const p={};for(let w=0;w<localStorage.length;w++){const S=localStorage.key(w);p[S]=localStorage.getItem(S)}const m=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),y=URL.createObjectURL(m),v=document.createElement("a");v.href=y,v.download="localStorage-backup.json",v.click(),URL.revokeObjectURL(y)},console.log("✅ Admin functions exposed globally")},[]);return e()?l.jsx(kte,{}):l.jsxs("div",{className:"admin-error",children:[l.jsx("h2",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access the admin dashboard."}),l.jsx("button",{onClick:r,children:"Return to Login"})]})},qw=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,role:n,isLoading:s}=Gn();return s?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?t&&!t.includes(n)?l.jsx(Zh,{to:"/unauthorized",replace:!0}):e:l.jsx(Zh,{to:"/login",replace:!0})},Tte=()=>l.jsxs("div",{className:"unauthorized-page",children:[l.jsx("h1",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access this page."})]}),Ete=()=>l.jsx(DN,{children:l.jsx(F8,{children:l.jsx(A8,{children:l.jsx(bD,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:l.jsx("div",{className:"app",children:l.jsxs(x2,{children:[l.jsx(fs,{path:"/login",element:l.jsx(NW,{})}),l.jsx(fs,{path:"/unauthorized",element:l.jsx(Tte,{})}),l.jsx(fs,{path:"/student/*",element:l.jsx(qw,{allowedRoles:["student"],children:l.jsx(yz,{})})}),l.jsx(fs,{path:"/teacher/*",element:l.jsx(qw,{allowedRoles:["teacher"],children:l.jsx(Ste,{})})}),l.jsx(fs,{path:"/admin/*",element:l.jsx(qw,{allowedRoles:["admin"],children:l.jsx(Cte,{})})}),l.jsx(fs,{path:"/",element:l.jsx(Zh,{to:"/login",replace:!0})}),l.jsx(fs,{path:"*",element:l.jsx(Zh,{to:"/login",replace:!0})})]})})})})})});class Nte{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.token),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}}const h2=new Nte;window.tokenManager=h2;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{h2.init()}):h2.init());class QF{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const t=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",t),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),t?(this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),t=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${t?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(t,r){console.log(`Function ${t} already available in main script for ${r}`),this.loadedFunctions.add(t)}setupRoleBasedUI(){let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),t=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!t&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(t){const r=`Access denied. This function requires ${t} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(t){return this.blockedFunctions.has(t)}isFunctionLoaded(t){return this.loadedFunctions.has(t)}getCurrentRole(){return this.currentRole}hasRole(t){return this.currentRole===t}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const t=window.tokenManager.getUserRole();return t?(console.log("[DEBUG] Setting role after login:",t),this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",t),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new QF;typeof R1<"u"&&R1.exports&&(R1.exports=QF);const Ate=()=>{console.log("[DEBUG] Initializing application with new structure");const e={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(e)),console.log("[DEBUG] Application initialized with enhanced features")},jte=()=>{console.log("[DEBUG] Starting main application"),Ate(),jP.createRoot(document.getElementById("root")).render(l.jsx(Cs.StrictMode,{children:l.jsx(Ete,{})}))};jte()});export default Fte();
